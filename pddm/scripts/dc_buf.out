Added 1 configs from ../config/dclaw_turn.txt
create env called
--------------------------------- 
Simulation dt:  0.1
State space dimension:  (21,)
Action space dimension:  (9,) 
-----------------------------------
Beginning to do  200  random rollouts.
Completed rollout #  40
Completed rollout #  80
Completed rollout #  140
Completed rollout #  180
Completed rollout #  100
Completed rollout #  20
Completed rollout #  60
Completed rollout #  0
Completed rollout #  120
Completed rollout #  160
Performed  200  rollouts, each with  40  steps.
Beginning to do  20  random rollouts.
Completed rollout #  2
Completed rollout #  12
Completed rollout #  6
Completed rollout #  14
Completed rollout #  4
Completed rollout #  8
Completed rollout #  16
Completed rollout #  10
Completed rollout #  18
Completed rollout #  0
Performed  20  rollouts, each with  40  steps.


######################
Done getting data....
input size:  30
action size:  9
output size:  21
dataX dims:  (7800, 1, 21)
dataY dims:  (7800, 1, 9)
dataZ dims:  (7800, 21) 
######################

Iter: 0
Num of training on policy rollouts: 0
Num of val on policy rollouts: 0

#####################################
Training the dynamics model..... iteration  0
#####################################

    amount of random data:  8000
    amount of onPol data:  0
Prob shape:  (7800,)

=== Epoch 0 ===
    train loss:  0.6825636943181356
    val rand:  0.44788384437561035
    val onPol:  0.4445819556713104

=== Epoch 10 ===
    train loss:  0.1468938539425532
    val rand:  0.18389932811260223
    val onPol:  0.18175750970840454

=== Epoch 20 ===
    train loss:  0.10074470241864522
    val rand:  0.149870365858078
    val onPol:  0.1478266417980194

=== Epoch 30 ===
    train loss:  0.08056056499481201
    val rand:  0.1392955780029297
    val onPol:  0.13627630472183228

=== Epoch 39 ===
    train loss:  0.07076959659655889
    val rand:  0.13605055212974548
    val onPol:  0.1365070343017578
Training duration: 3.01 s

#####################################
performing on-policy MPC rollouts... iter  0
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -11.828534096868575
DONE TAKING  40  STEPS.
Total reward:  -435.6609253161588
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.8529972190522
DONE TAKING  40  STEPS.
Total reward:  -813.9718405719955
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.89888808678807
DONE TAKING  40  STEPS.
Total reward:  -509.5916556923549
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.221375687111337
DONE TAKING  40  STEPS.
Total reward:  -875.6155822249975
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.147096284162306
DONE TAKING  40  STEPS.
Total reward:  -621.5247515394526
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.231436493396515
DONE TAKING  40  STEPS.
Total reward:  -922.3391959934388
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.3921720092947
DONE TAKING  40  STEPS.
Total reward:  -881.5960096187106
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.59068385375035
DONE TAKING  40  STEPS.
Total reward:  -819.4167740331604
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.845855197115668
DONE TAKING  40  STEPS.
Total reward:  -885.1971207569525
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.976253740791563
DONE TAKING  40  STEPS.
Total reward:  -594.8975295541721
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.92005217812624
DONE TAKING  40  STEPS.
Total reward:  -370.6379883655187
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -21.888157504635906
DONE TAKING  40  STEPS.
Total reward:  -633.6938449552384
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.075821309243224
DONE TAKING  40  STEPS.
Total reward:  -882.9705849206861
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.41504969180331
DONE TAKING  40  STEPS.
Total reward:  -612.5645909194362
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.121421518747486
DONE TAKING  40  STEPS.
Total reward:  -852.1182170090269
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.668609742037475
DONE TAKING  40  STEPS.
Total reward:  -711.1473063251765
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.35315884559791
DONE TAKING  40  STEPS.
Total reward:  -1071.5942930149308
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -14.911019159468024
DONE TAKING  40  STEPS.
Total reward:  -701.8282169170265
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.531417054207378
DONE TAKING  40  STEPS.
Total reward:  -977.4475950163322
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.58298212696706
DONE TAKING  40  STEPS.
Total reward:  -912.2404669293433
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -31.25267201332584
DONE TAKING  40  STEPS.
Total reward:  -1250.1068805330335
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.818963154817514
DONE TAKING  40  STEPS.
Total reward:  -912.7701426824501
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.29674180310322
DONE TAKING  40  STEPS.
Total reward:  -388.6025985026732
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.77409424919851
DONE TAKING  40  STEPS.
Total reward:  -697.8950915453157
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.28808938168248
DONE TAKING  40  STEPS.
Total reward:  -978.661474187928
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.566946081398804
DONE TAKING  40  STEPS.
Total reward:  -748.6796665200352
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -11.590453152409474
DONE TAKING  40  STEPS.
Total reward:  -399.1380314047469
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.16479173613856
DONE TAKING  40  STEPS.
Total reward:  -969.535689609245
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.229571163945437
DONE TAKING  40  STEPS.
Total reward:  -657.1816406029565
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.722627975761894
DONE TAKING  40  STEPS.
Total reward:  -427.2392869000247
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.341578740346478
DONE TAKING  40  STEPS.
Total reward:  -1128.152910275853
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -16.228586159296754
DONE TAKING  40  STEPS.
Total reward:  -393.7152174798444
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.301852813557645
DONE TAKING  40  STEPS.
Total reward:  -441.35104909486205
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.403650141991037
DONE TAKING  40  STEPS.
Total reward:  -837.9628573271445
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.251020210583555
DONE TAKING  40  STEPS.
Total reward:  -847.1549221073208
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.866688758992822
DONE TAKING  40  STEPS.
Total reward:  -785.3582148356145
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -13.45335019138237
DONE TAKING  40  STEPS.
Total reward:  -422.46599418409204
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.1221350423766
DONE TAKING  40  STEPS.
Total reward:  -875.9020978325212
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.37983893607124
DONE TAKING  40  STEPS.
Total reward:  -642.3173669022856
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -11.962573252539674
DONE TAKING  40  STEPS.
Total reward:  -474.9753604680645
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter0.ckpt
Iter: 1
Num of training on policy rollouts: 36
Num of val on policy rollouts: 4

#####################################
Training the dynamics model..... iteration  1
#####################################

    amount of random data:  8000
    amount of onPol data:  1476
Prob rand:  7995
On pol:  11520
Prob shape:  (19515,)

=== Epoch 0 ===
    train loss:  0.39492189609690714
    val rand:  0.3780403733253479
    val onPol:  0.12185359001159668

=== Epoch 10 ===
    train loss:  0.08354595872132402
    val rand:  0.1801697462797165
    val onPol:  0.10918128490447998

=== Epoch 20 ===
    train loss:  0.051959282081378136
    val rand:  0.15173956751823425
    val onPol:  0.11319052428007126

=== Epoch 30 ===
    train loss:  0.040253121503873876
    val rand:  0.1520397961139679
    val onPol:  0.11597757041454315

=== Epoch 39 ===
    train loss:  0.03370342207582373
    val rand:  0.14626190066337585
    val onPol:  0.11580916494131088
Training duration: 9.73 s

#####################################
performing on-policy MPC rollouts... iter  1
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.84519793803602
DONE TAKING  40  STEPS.
Total reward:  -382.8585448241266
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -16.896309804402467
DONE TAKING  40  STEPS.
Total reward:  -806.2046441761855
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.485999274822987
DONE TAKING  40  STEPS.
Total reward:  -558.132477767752
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.092802287264476
DONE TAKING  40  STEPS.
Total reward:  -943.4868557807093
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.87375291363615
DONE TAKING  40  STEPS.
Total reward:  -1033.2124305037592
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.435025913941267
DONE TAKING  40  STEPS.
Total reward:  -1064.4079458270473
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -16.35827089836169
DONE TAKING  40  STEPS.
Total reward:  -1005.942343590309
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.788070813250563
DONE TAKING  40  STEPS.
Total reward:  -820.4674681308481
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.275962133808093
DONE TAKING  40  STEPS.
Total reward:  -669.8693366826051
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.07554101533885
DONE TAKING  40  STEPS.
Total reward:  -1021.683575486935
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.159395874914416
DONE TAKING  40  STEPS.
Total reward:  -600.6587489295987
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.79879470715872
DONE TAKING  40  STEPS.
Total reward:  -950.0448312649912
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.856741899766075
DONE TAKING  40  STEPS.
Total reward:  -986.8587696286291
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.822034220127332
DONE TAKING  40  STEPS.
Total reward:  -1077.3869458566637
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.880546346131
DONE TAKING  40  STEPS.
Total reward:  -920.5877200973545
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.317073089342802
DONE TAKING  40  STEPS.
Total reward:  -781.0185493465102
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.53954079526558
DONE TAKING  40  STEPS.
Total reward:  -474.47822137454455
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.659718077437944
DONE TAKING  40  STEPS.
Total reward:  -899.2393246933385
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -16.729951355122715
DONE TAKING  40  STEPS.
Total reward:  -593.0751536139476
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.73315814598298
DONE TAKING  40  STEPS.
Total reward:  -978.0667902149025
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.935681278009426
DONE TAKING  40  STEPS.
Total reward:  -703.7114065176899
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.625503152620464
DONE TAKING  40  STEPS.
Total reward:  -959.5930315900715
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.934249963491823
DONE TAKING  40  STEPS.
Total reward:  -485.4602237981449
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.17143512730284
DONE TAKING  40  STEPS.
Total reward:  -764.8143732750696
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.512159533521476
DONE TAKING  40  STEPS.
Total reward:  -443.38562788613206
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.231109883999103
DONE TAKING  40  STEPS.
Total reward:  -1008.493882464583
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.583233896479417
DONE TAKING  40  STEPS.
Total reward:  -720.4267264943023
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.830887621864132
DONE TAKING  40  STEPS.
Total reward:  -1114.8919094245698
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.257223476769376
DONE TAKING  40  STEPS.
Total reward:  -1024.126694301553
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.34028561879895
DONE TAKING  40  STEPS.
Total reward:  -580.8234098626892
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.502867421953724
DONE TAKING  40  STEPS.
Total reward:  -1025.9506940343722
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -13.001284111141217
DONE TAKING  40  STEPS.
Total reward:  -343.5399819422085
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.306952443064596
DONE TAKING  40  STEPS.
Total reward:  -1004.134659041469
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.39287934240378
DONE TAKING  40  STEPS.
Total reward:  -398.0440259505752
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.434088922293363
DONE TAKING  40  STEPS.
Total reward:  -876.4287638950251
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.88385976510134
DONE TAKING  40  STEPS.
Total reward:  -791.8398198036688
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.631641593399117
DONE TAKING  40  STEPS.
Total reward:  -372.61515457059284
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.288839224545434
DONE TAKING  40  STEPS.
Total reward:  -433.4602772481827
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.960230683607207
DONE TAKING  40  STEPS.
Total reward:  -570.1489324116912
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.229281461559216
DONE TAKING  40  STEPS.
Total reward:  -549.2339451390186
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/font_manager.py:1320: UserWarning: findfont: Font family ['serif'] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter1.ckpt
Iter: 2
Num of training on policy rollouts: 72
Num of val on policy rollouts: 8

#####################################
Training the dynamics model..... iteration  2
#####################################

    amount of random data:  8000
    amount of onPol data:  2952
Prob rand:  8190
On pol:  11520
Prob shape:  (19710,)

=== Epoch 0 ===
    train loss:  0.450913573566236
    val rand:  0.3639318645000458
    val onPol:  0.23165857791900635

=== Epoch 10 ===
    train loss:  0.1109866352849885
    val rand:  0.1808551549911499
    val onPol:  0.2069266438484192

=== Epoch 20 ===
    train loss:  0.0675938610771769
    val rand:  0.15599212050437927
    val onPol:  0.22121959924697876

=== Epoch 30 ===
    train loss:  0.051849634141514174
    val rand:  0.15296213328838348
    val onPol:  0.22586575150489807

=== Epoch 39 ===
    train loss:  0.042162675312475154
    val rand:  0.1418035626411438
    val onPol:  0.23324742913246155
Training duration: 9.36 s

#####################################
performing on-policy MPC rollouts... iter  2
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.840475719099963
DONE TAKING  40  STEPS.
Total reward:  -980.6268490493776
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.944098777043553
DONE TAKING  40  STEPS.
Total reward:  -947.6220842395719
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.528260217319364
DONE TAKING  40  STEPS.
Total reward:  -685.189523499408
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.007674486120557
DONE TAKING  40  STEPS.
Total reward:  -992.0217530541902
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.41353000927208
DONE TAKING  40  STEPS.
Total reward:  -694.2136549125701
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.16100868184256
DONE TAKING  40  STEPS.
Total reward:  -769.5494313305195
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.34383895480118
DONE TAKING  40  STEPS.
Total reward:  -1101.067091078136
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.218641545268397
DONE TAKING  40  STEPS.
Total reward:  -945.3448155561377
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.501656622422455
DONE TAKING  40  STEPS.
Total reward:  -1108.4932155900672
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.597030965508193
DONE TAKING  40  STEPS.
Total reward:  -573.6848439457256
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.86783002324899
DONE TAKING  40  STEPS.
Total reward:  -931.2973758943356
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -31.235795452283384
DONE TAKING  40  STEPS.
Total reward:  -912.8048326347716
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.522878135835583
DONE TAKING  40  STEPS.
Total reward:  -717.9478168695238
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.806205605818494
DONE TAKING  40  STEPS.
Total reward:  -949.0609030476393
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.587784194734684
DONE TAKING  40  STEPS.
Total reward:  -663.8588478532987
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.508822386654934
DONE TAKING  40  STEPS.
Total reward:  -396.99979603987464
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.6954928926593
DONE TAKING  40  STEPS.
Total reward:  -603.7062246231579
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.61820851421238
DONE TAKING  40  STEPS.
Total reward:  -830.7523153135517
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.86432289571262
DONE TAKING  40  STEPS.
Total reward:  -687.409392754407
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.275705829244465
DONE TAKING  40  STEPS.
Total reward:  -813.2767201607616
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.52739543630118
DONE TAKING  40  STEPS.
Total reward:  -986.9162992681684
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.052736864574737
DONE TAKING  40  STEPS.
Total reward:  -670.5463556382473
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.892407580457935
DONE TAKING  40  STEPS.
Total reward:  -1198.6091949661138
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.150472800659422
DONE TAKING  40  STEPS.
Total reward:  -748.5719880623986
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.00167104114459
DONE TAKING  40  STEPS.
Total reward:  -844.8154266331352
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -12.620450916612263
DONE TAKING  40  STEPS.
Total reward:  -522.7105461362255
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.535077994017485
DONE TAKING  40  STEPS.
Total reward:  -752.0263907790489
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.060727382069217
DONE TAKING  40  STEPS.
Total reward:  -751.4557734732525
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.654282883194547
DONE TAKING  40  STEPS.
Total reward:  -1085.8914548768003
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.68541405758342
DONE TAKING  40  STEPS.
Total reward:  -985.3781264302879
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.53433876677438
DONE TAKING  40  STEPS.
Total reward:  -458.5772722121788
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.158318949091186
DONE TAKING  40  STEPS.
Total reward:  -967.773791918939
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.93624978434161
DONE TAKING  40  STEPS.
Total reward:  -1075.4698820665544
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.092796925240364
DONE TAKING  40  STEPS.
Total reward:  -922.8786959496116
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.56480775837075
DONE TAKING  40  STEPS.
Total reward:  -1182.5923103348302
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -31.31732242869414
DONE TAKING  40  STEPS.
Total reward:  -838.3713402929383
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.16150300717962
DONE TAKING  40  STEPS.
Total reward:  -923.8100940533596
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.865315643377542
DONE TAKING  40  STEPS.
Total reward:  -1041.0013822540702
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.02536683604715
DONE TAKING  40  STEPS.
Total reward:  -323.37835317636836
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -9.075564821538183
DONE TAKING  40  STEPS.
Total reward:  -328.92169880810184
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter2.ckpt
Iter: 3
Num of training on policy rollouts: 108
Num of val on policy rollouts: 12

#####################################
Training the dynamics model..... iteration  3
#####################################

    amount of random data:  8000
    amount of onPol data:  4428
Prob rand:  8385
On pol:  8640
Prob shape:  (17025,)

=== Epoch 0 ===
    train loss:  0.49762429974295874
    val rand:  0.3744971454143524
    val onPol:  0.31967028975486755

=== Epoch 10 ===
    train loss:  0.14332172229434503
    val rand:  0.1805795282125473
    val onPol:  0.2677045464515686

=== Epoch 20 ===
    train loss:  0.09666336937384172
    val rand:  0.15659937262535095
    val onPol:  0.2733019292354584

=== Epoch 30 ===
    train loss:  0.07307545863317721
    val rand:  0.15241724252700806
    val onPol:  0.2822171449661255

=== Epoch 39 ===
    train loss:  0.05984370139512149
    val rand:  0.15149204432964325
    val onPol:  0.29087892174720764
Training duration: 8.49 s

#####################################
performing on-policy MPC rollouts... iter  3
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -16.079567654794996
DONE TAKING  40  STEPS.
Total reward:  -651.1198004831012
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.44642479491661
DONE TAKING  40  STEPS.
Total reward:  -340.7745600644755
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -10.09845625458108
DONE TAKING  40  STEPS.
Total reward:  -369.1769062609642
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.352063633907257
DONE TAKING  40  STEPS.
Total reward:  -1114.176609492627
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.050143974839635
DONE TAKING  40  STEPS.
Total reward:  -408.1334359503291
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.429640768526284
DONE TAKING  40  STEPS.
Total reward:  -892.8941509453559
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -31.0985443430799
DONE TAKING  40  STEPS.
Total reward:  -670.4573846022973
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.60572610909779
DONE TAKING  40  STEPS.
Total reward:  -1032.266854557118
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.99337999705113
DONE TAKING  40  STEPS.
Total reward:  -733.5583024843587
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.024794857220012
DONE TAKING  40  STEPS.
Total reward:  -421.2167266500292
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.142727550604086
DONE TAKING  40  STEPS.
Total reward:  -808.659604083025
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -14.233058916350977
DONE TAKING  40  STEPS.
Total reward:  -552.5802529213781
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.856267226471267
DONE TAKING  40  STEPS.
Total reward:  -671.8166800774525
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.900310352173186
DONE TAKING  40  STEPS.
Total reward:  -518.4130501312969
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.00279378345768
DONE TAKING  40  STEPS.
Total reward:  -480.86608737051677
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -16.020890740042944
DONE TAKING  40  STEPS.
Total reward:  -352.7685487296883
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.66440538567586
DONE TAKING  40  STEPS.
Total reward:  -796.4768700468809
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.06098149499522
DONE TAKING  40  STEPS.
Total reward:  -562.3528055829196
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.381227736739223
DONE TAKING  40  STEPS.
Total reward:  -383.7249376190828
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.44536222815914
DONE TAKING  40  STEPS.
Total reward:  -822.1628801772141
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.014941334967993
DONE TAKING  40  STEPS.
Total reward:  -749.6391275013445
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.977930781526723
DONE TAKING  40  STEPS.
Total reward:  -743.9853754610939
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.175255786643802
DONE TAKING  40  STEPS.
Total reward:  -487.4917458642836
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.88744838478651
DONE TAKING  40  STEPS.
Total reward:  -748.2488702550883
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -18.17988721919088
DONE TAKING  40  STEPS.
Total reward:  -616.0018977890759
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.893411867022305
DONE TAKING  40  STEPS.
Total reward:  -914.2651306785458
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -31.06127057077332
DONE TAKING  40  STEPS.
Total reward:  -1068.2675895398872
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.59814380057656
DONE TAKING  40  STEPS.
Total reward:  -1008.981302909403
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.94852115802835
DONE TAKING  40  STEPS.
Total reward:  -622.2690267439463
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.74288061386619
DONE TAKING  40  STEPS.
Total reward:  -851.9726672341527
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -22.056906600944494
DONE TAKING  40  STEPS.
Total reward:  -812.2525624153644
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.965918925687753
DONE TAKING  40  STEPS.
Total reward:  -626.2499966500457
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -12.08213375380199
DONE TAKING  40  STEPS.
Total reward:  -167.68114799980856
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.873981208275797
DONE TAKING  40  STEPS.
Total reward:  -626.5007176992827
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -11.71607447022723
DONE TAKING  40  STEPS.
Total reward:  -377.7889931085533
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.643827097327502
DONE TAKING  40  STEPS.
Total reward:  -758.2338586529613
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.565826785044447
DONE TAKING  40  STEPS.
Total reward:  -447.1204599942594
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.559523892009416
DONE TAKING  40  STEPS.
Total reward:  -342.64546832734817
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.778560100872046
DONE TAKING  40  STEPS.
Total reward:  -642.1480316234893
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.9173816138281
DONE TAKING  40  STEPS.
Total reward:  -668.5548797957904
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter3.ckpt
Iter: 4
Num of training on policy rollouts: 144
Num of val on policy rollouts: 16

#####################################
Training the dynamics model..... iteration  4
#####################################

    amount of random data:  8000
    amount of onPol data:  5904
Prob rand:  8580
On pol:  11520
Prob shape:  (20100,)

=== Epoch 0 ===
    train loss:  0.4633124463069133
    val rand:  0.3648647665977478
    val onPol:  0.3245154619216919

=== Epoch 10 ===
    train loss:  0.1466469183946267
    val rand:  0.18492703139781952
    val onPol:  0.28635528683662415

=== Epoch 20 ===
    train loss:  0.0961965269003159
    val rand:  0.16386806964874268
    val onPol:  0.29515862464904785

=== Epoch 30 ===
    train loss:  0.07117449645048533
    val rand:  0.15933585166931152
    val onPol:  0.31493106484413147

=== Epoch 39 ===
    train loss:  0.059362293722537846
    val rand:  0.15052197873592377
    val onPol:  0.32032477855682373
Training duration: 9.69 s

#####################################
performing on-policy MPC rollouts... iter  4
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.599094966436454
DONE TAKING  40  STEPS.
Total reward:  -415.7973882263304
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.231631417166827
DONE TAKING  40  STEPS.
Total reward:  -461.6648888968178
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.643551027821516
DONE TAKING  40  STEPS.
Total reward:  -849.5790359298144
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -13.034843449666763
DONE TAKING  40  STEPS.
Total reward:  -492.93240445808556
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.494584579680236
DONE TAKING  40  STEPS.
Total reward:  -495.2477660562562
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.813887931202245
DONE TAKING  40  STEPS.
Total reward:  -585.8208797403952
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.136796378319232
DONE TAKING  40  STEPS.
Total reward:  -869.2297659415942
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.93617403593554
DONE TAKING  40  STEPS.
Total reward:  -489.204505925329
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.085343073603376
DONE TAKING  40  STEPS.
Total reward:  -634.8660197869689
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.7938495181941
DONE TAKING  40  STEPS.
Total reward:  -880.0096424767137
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -19.53212382866321
DONE TAKING  40  STEPS.
Total reward:  -588.6089565221345
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.90979986026202
DONE TAKING  40  STEPS.
Total reward:  -1000.8554664836663
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.01293279870963
DONE TAKING  40  STEPS.
Total reward:  -1058.1473821228205
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -12.86677971744573
DONE TAKING  40  STEPS.
Total reward:  -415.96931865601636
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.802444159843112
DONE TAKING  40  STEPS.
Total reward:  -835.5174672471227
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.211327350767597
DONE TAKING  40  STEPS.
Total reward:  -738.3502005549436
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.37367777499346
DONE TAKING  40  STEPS.
Total reward:  -704.9605713365613
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.6886990762115
DONE TAKING  40  STEPS.
Total reward:  -470.4872376604546
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.121548807267793
DONE TAKING  40  STEPS.
Total reward:  -794.8920050176389
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.250394967004706
DONE TAKING  40  STEPS.
Total reward:  -986.0357931369765
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.37754949974123
DONE TAKING  40  STEPS.
Total reward:  -663.1991419547224
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.69761440064974
DONE TAKING  40  STEPS.
Total reward:  -707.9045760259896
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.198764382973945
DONE TAKING  40  STEPS.
Total reward:  -571.0263785437778
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.18704151751971
DONE TAKING  40  STEPS.
Total reward:  -887.481660700788
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.836516420337944
DONE TAKING  40  STEPS.
Total reward:  -623.9521708987198
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.26094518200141
DONE TAKING  40  STEPS.
Total reward:  -341.18530707491163
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.829491978479176
DONE TAKING  40  STEPS.
Total reward:  -599.8074175684275
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.55922304750451
DONE TAKING  40  STEPS.
Total reward:  -891.0722861605338
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -15.158203119860573
DONE TAKING  40  STEPS.
Total reward:  -498.4490097617011
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -14.095188357784936
DONE TAKING  40  STEPS.
Total reward:  -365.90639597832023
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.552475884462336
DONE TAKING  40  STEPS.
Total reward:  -841.0993963296241
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -29.011637575149955
DONE TAKING  40  STEPS.
Total reward:  -1104.5902923939948
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.697834400326617
DONE TAKING  40  STEPS.
Total reward:  -1063.4172513172252
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.997936460436165
DONE TAKING  40  STEPS.
Total reward:  -318.3808153109576
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.927903133978177
DONE TAKING  40  STEPS.
Total reward:  -760.6602024833884
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.87893711799831
DONE TAKING  40  STEPS.
Total reward:  -525.9182340093204
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -29.724965246536975
DONE TAKING  40  STEPS.
Total reward:  -921.1467699233125
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -10.461603973700864
DONE TAKING  40  STEPS.
Total reward:  -163.32900124326645
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.409658536041107
DONE TAKING  40  STEPS.
Total reward:  -1008.8356446201427
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.4158765960551
DONE TAKING  40  STEPS.
Total reward:  -1115.7366826274647
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter4.ckpt
Iter: 5
Num of training on policy rollouts: 180
Num of val on policy rollouts: 20

#####################################
Training the dynamics model..... iteration  5
#####################################

    amount of random data:  8000
    amount of onPol data:  7380
Prob rand:  8775
On pol:  14400
Prob shape:  (23175,)

=== Epoch 0 ===
    train loss:  0.4594594630930159
    val rand:  0.382322758436203
    val onPol:  0.3258373737335205

=== Epoch 10 ===
    train loss:  0.15028828945424821
    val rand:  0.19121778011322021
    val onPol:  0.2921416163444519

=== Epoch 20 ===
    train loss:  0.09873430861367119
    val rand:  0.16663748025894165
    val onPol:  0.30987104773521423

=== Epoch 30 ===
    train loss:  0.07361928820610046
    val rand:  0.15986117720603943
    val onPol:  0.32148224115371704

=== Epoch 39 ===
    train loss:  0.06183094506462415
    val rand:  0.1562792807817459
    val onPol:  0.32929325103759766
Training duration: 11.63 s

#####################################
performing on-policy MPC rollouts... iter  5
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.21226788058182
DONE TAKING  40  STEPS.
Total reward:  -794.1631400088894
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.762771737751184
DONE TAKING  40  STEPS.
Total reward:  -943.1651382311453
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -10.526232852621721
DONE TAKING  40  STEPS.
Total reward:  -420.22098231942454
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -20.841845891960954
DONE TAKING  40  STEPS.
Total reward:  -629.7619741378838
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -19.750148836921866
DONE TAKING  40  STEPS.
Total reward:  -731.1671147579387
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.146930530537613
DONE TAKING  40  STEPS.
Total reward:  -695.0338479974179
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.888910811946786
DONE TAKING  40  STEPS.
Total reward:  -553.1321003419755
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.928419576817962
DONE TAKING  40  STEPS.
Total reward:  -1001.8539881172157
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.488191022979162
DONE TAKING  40  STEPS.
Total reward:  -393.14895823596447
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.022299122257333
DONE TAKING  40  STEPS.
Total reward:  -406.42082526304307
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -18.119094681390923
DONE TAKING  40  STEPS.
Total reward:  -681.0191401273781
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.268495091240965
DONE TAKING  40  STEPS.
Total reward:  -420.2065941290195
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -16.64810354768544
DONE TAKING  40  STEPS.
Total reward:  -563.3283412864724
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.69232639654875
DONE TAKING  40  STEPS.
Total reward:  -388.3225129266041
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.760117777476612
DONE TAKING  40  STEPS.
Total reward:  -651.391487355054
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.825925866098007
DONE TAKING  40  STEPS.
Total reward:  -526.5285970024524
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.980649594132288
DONE TAKING  40  STEPS.
Total reward:  -889.518426215677
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.52507002970284
DONE TAKING  40  STEPS.
Total reward:  -764.3830269176148
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.530694361434527
DONE TAKING  40  STEPS.
Total reward:  -542.5164059325732
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.51583602010783
DONE TAKING  40  STEPS.
Total reward:  -321.30963102080767
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.82228528993613
DONE TAKING  40  STEPS.
Total reward:  -635.0903713972693
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.733360142853464
DONE TAKING  40  STEPS.
Total reward:  -798.6501541980566
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.741554378786653
DONE TAKING  40  STEPS.
Total reward:  -380.9556548666585
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.218283707015553
DONE TAKING  40  STEPS.
Total reward:  -529.4810999900227
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -12.26112002514573
DONE TAKING  40  STEPS.
Total reward:  -428.0222869254799
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.151365863643427
DONE TAKING  40  STEPS.
Total reward:  -509.4421760285417
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.35639537521281
DONE TAKING  40  STEPS.
Total reward:  -430.43597535125036
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.385569322246692
DONE TAKING  40  STEPS.
Total reward:  -1005.9666845392793
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.82213970892968
DONE TAKING  40  STEPS.
Total reward:  -1087.071700459319
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.54940062918032
DONE TAKING  40  STEPS.
Total reward:  -808.206772732334
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.548681588153343
DONE TAKING  40  STEPS.
Total reward:  -507.47335103241755
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.260289642884125
DONE TAKING  40  STEPS.
Total reward:  -713.9469765328256
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.506000703709221
DONE TAKING  40  STEPS.
Total reward:  -342.4355570378852
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.92477519479758
DONE TAKING  40  STEPS.
Total reward:  -338.30908309405396
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.88787866053098
DONE TAKING  40  STEPS.
Total reward:  -791.0771759753577
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.258875413946644
DONE TAKING  40  STEPS.
Total reward:  -652.2710075471917
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.74931085720709
DONE TAKING  40  STEPS.
Total reward:  -443.0559360597518
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.54364787391121
DONE TAKING  40  STEPS.
Total reward:  -622.4991095811162
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.96294965357193
DONE TAKING  40  STEPS.
Total reward:  -792.5550105371783
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.616286034366393
DONE TAKING  40  STEPS.
Total reward:  -832.8340560197048
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter5.ckpt
Iter: 6
Num of training on policy rollouts: 216
Num of val on policy rollouts: 24

#####################################
Training the dynamics model..... iteration  6
#####################################

    amount of random data:  8000
    amount of onPol data:  8856
Prob rand:  8970
On pol:  17280
Prob shape:  (26250,)

=== Epoch 0 ===
    train loss:  0.4347258753636304
    val rand:  0.37777113914489746
    val onPol:  0.3263498544692993

=== Epoch 10 ===
    train loss:  0.1487913748212889
    val rand:  0.19356021285057068
    val onPol:  0.29191192984580994

=== Epoch 20 ===
    train loss:  0.10080253391289244
    val rand:  0.16764536499977112
    val onPol:  0.30674681067466736

=== Epoch 30 ===
    train loss:  0.07417750972158768
    val rand:  0.16362330317497253
    val onPol:  0.31539294123649597

=== Epoch 39 ===
    train loss:  0.06072284113250527
    val rand:  0.1552649438381195
    val onPol:  0.32562947273254395
Training duration: 12.72 s

#####################################
performing on-policy MPC rollouts... iter  6
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.68048864040702
DONE TAKING  40  STEPS.
Total reward:  -921.2520692396033
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.658831093727773
DONE TAKING  40  STEPS.
Total reward:  -494.51005135238097
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.951946700311076
DONE TAKING  40  STEPS.
Total reward:  -1110.1015564516044
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.473611678645952
DONE TAKING  40  STEPS.
Total reward:  -948.6950700464794
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.621958415949415
DONE TAKING  40  STEPS.
Total reward:  -665.206825109746
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -12.529842692952284
DONE TAKING  40  STEPS.
Total reward:  -288.8539736851218
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.175343543578155
DONE TAKING  40  STEPS.
Total reward:  -644.50357608197
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -14.043550522983255
DONE TAKING  40  STEPS.
Total reward:  -468.7074346000647
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.589035938577705
DONE TAKING  40  STEPS.
Total reward:  -895.1852701184048
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.95628102565611
DONE TAKING  40  STEPS.
Total reward:  -870.1825146954017
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.48933173546191
DONE TAKING  40  STEPS.
Total reward:  -796.3715385420498
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.961427317092337
DONE TAKING  40  STEPS.
Total reward:  -908.8294207059869
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.285851421754465
DONE TAKING  40  STEPS.
Total reward:  -417.17604879215105
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.817261478056732
DONE TAKING  40  STEPS.
Total reward:  -924.0172807939018
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.49829174154726
DONE TAKING  40  STEPS.
Total reward:  -911.060801704287
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.635906435561324
DONE TAKING  40  STEPS.
Total reward:  -865.7187779827728
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -31.239166945193034
DONE TAKING  40  STEPS.
Total reward:  -841.0979758317984
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.378411938642433
DONE TAKING  40  STEPS.
Total reward:  -764.3505966094223
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.72673341003777
DONE TAKING  40  STEPS.
Total reward:  -719.5810705487415
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.928754201507353
DONE TAKING  40  STEPS.
Total reward:  -837.4013335868876
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.861845458158832
DONE TAKING  40  STEPS.
Total reward:  -551.3245728876119
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.715152256468865
DONE TAKING  40  STEPS.
Total reward:  -934.4085817827229
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.193178834658077
DONE TAKING  40  STEPS.
Total reward:  -1061.9662971131754
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.775532348100313
DONE TAKING  40  STEPS.
Total reward:  -326.46214557024626
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.304342689204617
DONE TAKING  40  STEPS.
Total reward:  -609.8471081027874
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.032846866797556
DONE TAKING  40  STEPS.
Total reward:  -761.0124293733082
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -9.846567113834642
DONE TAKING  40  STEPS.
Total reward:  -218.26277451938506
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.483312171911894
DONE TAKING  40  STEPS.
Total reward:  -962.0605127770659
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.767232597354685
DONE TAKING  40  STEPS.
Total reward:  -886.6580821660998
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.61561680986792
DONE TAKING  40  STEPS.
Total reward:  -665.2112322460442
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -13.610225288351717
DONE TAKING  40  STEPS.
Total reward:  -337.69923641155776
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -13.823027530362126
DONE TAKING  40  STEPS.
Total reward:  -476.22706468093514
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.41303530658835
DONE TAKING  40  STEPS.
Total reward:  -468.61303471197175
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.144806656241386
DONE TAKING  40  STEPS.
Total reward:  -1050.5240738927619
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.598951728947483
DONE TAKING  40  STEPS.
Total reward:  -461.2432950596069
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.572581051822922
DONE TAKING  40  STEPS.
Total reward:  -1015.2937395400804
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.218466469858473
DONE TAKING  40  STEPS.
Total reward:  -464.064194477813
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.894789666903783
DONE TAKING  40  STEPS.
Total reward:  -1002.448161448116
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.408462317962012
DONE TAKING  40  STEPS.
Total reward:  -406.9730942882392
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.564884497196623
DONE TAKING  40  STEPS.
Total reward:  -343.9692525260589
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter6.ckpt
Iter: 7
Num of training on policy rollouts: 252
Num of val on policy rollouts: 28

#####################################
Training the dynamics model..... iteration  7
#####################################

    amount of random data:  8000
    amount of onPol data:  10332
Prob rand:  9165
On pol:  10080
Prob shape:  (19245,)

=== Epoch 0 ===
    train loss:  0.5200546810755858
    val rand:  0.39321160316467285
    val onPol:  0.3428920954465866

=== Epoch 10 ===
    train loss:  0.1802003319199021
    val rand:  0.19471728801727295
    val onPol:  0.29102039337158203

=== Epoch 20 ===
    train loss:  0.1333792735193227
    val rand:  0.1615915149450302
    val onPol:  0.2935449182987213

=== Epoch 30 ===
    train loss:  0.10874813613859383
    val rand:  0.15939241647720337
    val onPol:  0.30091574788093567

=== Epoch 39 ===
    train loss:  0.0914782348114091
    val rand:  0.1602584719657898
    val onPol:  0.30624090135097504
Training duration: 9.76 s

#####################################
performing on-policy MPC rollouts... iter  7
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.445904531513033
DONE TAKING  40  STEPS.
Total reward:  -731.6324663623125
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -28.61930287056056
DONE TAKING  40  STEPS.
Total reward:  -1051.529137723299
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.991923662387745
DONE TAKING  40  STEPS.
Total reward:  -889.1198864439419
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.42468596135857
DONE TAKING  40  STEPS.
Total reward:  -992.5069284418854
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -20.567496023151485
DONE TAKING  40  STEPS.
Total reward:  -292.85794211359325
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.085306314411664
DONE TAKING  40  STEPS.
Total reward:  -513.9540441033442
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -13.222140214135425
DONE TAKING  40  STEPS.
Total reward:  -358.8182701501361
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -31.119861592928455
DONE TAKING  40  STEPS.
Total reward:  -1063.6724995050065
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.62284269511389
DONE TAKING  40  STEPS.
Total reward:  -1034.1177177801276
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.223971525231708
DONE TAKING  40  STEPS.
Total reward:  -761.2066771869672
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.073849602574885
DONE TAKING  40  STEPS.
Total reward:  -770.2974677157285
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.830337010122886
DONE TAKING  40  STEPS.
Total reward:  -1141.5165504689708
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.11207415287511
DONE TAKING  40  STEPS.
Total reward:  -362.62479387765467
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.56891299033546
DONE TAKING  40  STEPS.
Total reward:  -630.2619869228138
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.13716303083798
DONE TAKING  40  STEPS.
Total reward:  -852.4882220936117
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -13.08230003595799
DONE TAKING  40  STEPS.
Total reward:  -460.2251765372466
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.211092467476348
DONE TAKING  40  STEPS.
Total reward:  -644.1412556476247
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -22.843192447546656
DONE TAKING  40  STEPS.
Total reward:  -992.5981967967383
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.502624095610805
DONE TAKING  40  STEPS.
Total reward:  -585.406993041131
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.82278091871691
DONE TAKING  40  STEPS.
Total reward:  -759.974689729777
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.264137004576522
DONE TAKING  40  STEPS.
Total reward:  -705.6991297205178
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.532126815202155
DONE TAKING  40  STEPS.
Total reward:  -812.9862918417733
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -12.455864623886796
DONE TAKING  40  STEPS.
Total reward:  -262.85359689342323
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.10506042728743
DONE TAKING  40  STEPS.
Total reward:  -827.2747370580263
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.21652130158798
DONE TAKING  40  STEPS.
Total reward:  -936.4020544012315
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.44924514564313
DONE TAKING  40  STEPS.
Total reward:  -196.52448619135174
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.364917039641764
DONE TAKING  40  STEPS.
Total reward:  -696.7745786939938
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.822892838817168
DONE TAKING  40  STEPS.
Total reward:  -720.7984446695738
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.672464905686844
DONE TAKING  40  STEPS.
Total reward:  -467.3819548756836
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.73842597710126
DONE TAKING  40  STEPS.
Total reward:  -538.5114520323756
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.36201732123588
DONE TAKING  40  STEPS.
Total reward:  -903.8269169897698
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.145431607532377
DONE TAKING  40  STEPS.
Total reward:  -0.18428285646430287
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.65012123817634
DONE TAKING  40  STEPS.
Total reward:  -396.0402481558755
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.042624600085905
DONE TAKING  40  STEPS.
Total reward:  -735.6235631995714
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -13.498638334058963
DONE TAKING  40  STEPS.
Total reward:  -424.0915821554071
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.813168812810527
DONE TAKING  40  STEPS.
Total reward:  -750.8589998602746
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -17.308844080300627
DONE TAKING  40  STEPS.
Total reward:  -590.5198370937463
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.75514657917322
DONE TAKING  40  STEPS.
Total reward:  -842.0513385753492
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.000262836835411
DONE TAKING  40  STEPS.
Total reward:  -396.20718808597314
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.921040174042965
DONE TAKING  40  STEPS.
Total reward:  -456.72096864381325
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter7.ckpt
Iter: 8
Num of training on policy rollouts: 288
Num of val on policy rollouts: 32

#####################################
Training the dynamics model..... iteration  8
#####################################

    amount of random data:  8000
    amount of onPol data:  11808
Prob rand:  9360
On pol:  11520
Prob shape:  (20880,)

=== Epoch 0 ===
    train loss:  0.5117688126862049
    val rand:  0.40750131011009216
    val onPol:  0.3503928929567337

=== Epoch 10 ===
    train loss:  0.18593344762921332
    val rand:  0.19536805152893066
    val onPol:  0.2994091212749481

=== Epoch 20 ===
    train loss:  0.13639733307063578
    val rand:  0.16695795953273773
    val onPol:  0.30028003454208374

=== Epoch 30 ===
    train loss:  0.11081666480749845
    val rand:  0.16045284271240234
    val onPol:  0.3053956478834152

=== Epoch 39 ===
    train loss:  0.09388524796813727
    val rand:  0.15780216455459595
    val onPol:  0.3122478723526001
Training duration: 10.16 s

#####################################
performing on-policy MPC rollouts... iter  8
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.755015009192142
DONE TAKING  40  STEPS.
Total reward:  -652.2034790788096
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.58234088685041
DONE TAKING  40  STEPS.
Total reward:  -820.492426156448
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.25734211431519
DONE TAKING  40  STEPS.
Total reward:  -530.7411011144369
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.045298075551266
DONE TAKING  40  STEPS.
Total reward:  -925.5286633235097
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.52684623709885
DONE TAKING  40  STEPS.
Total reward:  -760.8505476787765
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.173801128991844
DONE TAKING  40  STEPS.
Total reward:  -529.7319908335418
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -14.979771216083716
DONE TAKING  40  STEPS.
Total reward:  -533.7830239300087
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.08753172646304
DONE TAKING  40  STEPS.
Total reward:  -926.2447970742388
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.559179913968848
DONE TAKING  40  STEPS.
Total reward:  -592.019937703124
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -24.556684203160906
DONE TAKING  40  STEPS.
Total reward:  -669.4199808597743
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.931284032791805
DONE TAKING  40  STEPS.
Total reward:  -736.7723962297323
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.78793215562167
DONE TAKING  40  STEPS.
Total reward:  -1032.5367805038993
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -31.164382408024064
DONE TAKING  40  STEPS.
Total reward:  -1180.8902143916935
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.25484242963974
DONE TAKING  40  STEPS.
Total reward:  -494.0696991913961
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.864229083813683
DONE TAKING  40  STEPS.
Total reward:  -923.291043197244
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.267471006786547
DONE TAKING  40  STEPS.
Total reward:  -474.39581060281813
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.3563472783511
DONE TAKING  40  STEPS.
Total reward:  -454.7212367656345
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.132327817368296
DONE TAKING  40  STEPS.
Total reward:  -586.6645181984655
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.556340881461743
DONE TAKING  40  STEPS.
Total reward:  -959.7319451147661
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.382918923414884
DONE TAKING  40  STEPS.
Total reward:  -505.3200976210069
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.64784710224232
DONE TAKING  40  STEPS.
Total reward:  -736.0846582825558
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -12.451713022135502
DONE TAKING  40  STEPS.
Total reward:  -419.18071165687746
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.065815645317045
DONE TAKING  40  STEPS.
Total reward:  -567.0184215517313
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.010474377159138
DONE TAKING  40  STEPS.
Total reward:  -415.57219990239633
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.411020398218337
DONE TAKING  40  STEPS.
Total reward:  -730.5172178427895
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.522882920931828
DONE TAKING  40  STEPS.
Total reward:  -990.992914057497
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.610576735896633
DONE TAKING  40  STEPS.
Total reward:  -659.5597785886633
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.45633730840921
DONE TAKING  40  STEPS.
Total reward:  -683.3508838798529
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.577638042889124
DONE TAKING  40  STEPS.
Total reward:  -772.9778122198027
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -11.63815116849284
DONE TAKING  40  STEPS.
Total reward:  -471.50578402837044
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -26.357598862115594
DONE TAKING  40  STEPS.
Total reward:  -832.7804987365467
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -31.22951900753817
DONE TAKING  40  STEPS.
Total reward:  -633.6312082021876
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.438848049965284
DONE TAKING  40  STEPS.
Total reward:  -753.5162862313389
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.943188858705522
DONE TAKING  40  STEPS.
Total reward:  -477.8333956213696
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.183841247978734
DONE TAKING  40  STEPS.
Total reward:  -887.0975885809353
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.235498836071187
DONE TAKING  40  STEPS.
Total reward:  -477.74887718798385
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.606004193968726
DONE TAKING  40  STEPS.
Total reward:  -729.3014271034913
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.222277263141724
DONE TAKING  40  STEPS.
Total reward:  -263.36171639158226
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -15.97928051427206
DONE TAKING  40  STEPS.
Total reward:  -156.97479054911184
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.961737337304537
DONE TAKING  40  STEPS.
Total reward:  -861.0915557601264
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter8.ckpt
Iter: 9
Num of training on policy rollouts: 324
Num of val on policy rollouts: 36

#####################################
Training the dynamics model..... iteration  9
#####################################

    amount of random data:  8000
    amount of onPol data:  13284
Prob rand:  9555
On pol:  12960
Prob shape:  (22515,)

=== Epoch 0 ===
    train loss:  0.49909850885701734
    val rand:  0.3985685110092163
    val onPol:  0.349710151553154

=== Epoch 10 ===
    train loss:  0.18642302481241005
    val rand:  0.19564694166183472
    val onPol:  0.3032882809638977

=== Epoch 20 ===
    train loss:  0.1386444866657257
    val rand:  0.17119541764259338
    val onPol:  0.3036300390958786

=== Epoch 30 ===
    train loss:  0.11273572732542836
    val rand:  0.16463521122932434
    val onPol:  0.31087726354599

=== Epoch 39 ===
    train loss:  0.09576009508482246
    val rand:  0.16121262311935425
    val onPol:  0.31662003695964813
Training duration: 10.74 s

#####################################
performing on-policy MPC rollouts... iter  9
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -13.812166563416275
DONE TAKING  40  STEPS.
Total reward:  -503.3823984283954
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.05494814106162
DONE TAKING  40  STEPS.
Total reward:  -1097.682487586878
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.372204780172535
DONE TAKING  40  STEPS.
Total reward:  -580.9410432735049
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.18602698020085
DONE TAKING  40  STEPS.
Total reward:  -1007.6068047920386
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.12005989924169
DONE TAKING  40  STEPS.
Total reward:  -745.3821774110979
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.33879417445904
DONE TAKING  40  STEPS.
Total reward:  -775.2102947536207
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.292611535823035
DONE TAKING  40  STEPS.
Total reward:  -780.6487248735143
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.754688283006708
DONE TAKING  40  STEPS.
Total reward:  -537.0146200594132
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.79264728420236
DONE TAKING  40  STEPS.
Total reward:  -846.4522843110992
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.9016605145696
DONE TAKING  40  STEPS.
Total reward:  -649.0885031947032
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.210265726926597
DONE TAKING  40  STEPS.
Total reward:  -468.4530572067265
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.460457071242413
DONE TAKING  40  STEPS.
Total reward:  -965.9145140161004
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.812493563986614
DONE TAKING  40  STEPS.
Total reward:  -608.0609357967163
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.869371415130246
DONE TAKING  40  STEPS.
Total reward:  -637.9827923825965
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.874011900351235
DONE TAKING  40  STEPS.
Total reward:  -688.1994669303047
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.998752958002292
DONE TAKING  40  STEPS.
Total reward:  -840.7326708954367
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.13673554519743
DONE TAKING  40  STEPS.
Total reward:  -884.1238859483626
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.788844917836705
DONE TAKING  40  STEPS.
Total reward:  -319.5355879169008
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -15.103318741584232
DONE TAKING  40  STEPS.
Total reward:  -563.613850931918
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.51677199254318
DONE TAKING  40  STEPS.
Total reward:  -553.9470591322255
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.485761195200773
DONE TAKING  40  STEPS.
Total reward:  -904.1730030048715
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.270830710186807
DONE TAKING  40  STEPS.
Total reward:  -488.397711873584
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.910109967047582
DONE TAKING  40  STEPS.
Total reward:  -593.3428250064665
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.42328171003493
DONE TAKING  40  STEPS.
Total reward:  -351.11660655917757
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -9.02393622668063
DONE TAKING  40  STEPS.
Total reward:  -360.95744906722524
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.294755860149483
DONE TAKING  40  STEPS.
Total reward:  -491.0795398390422
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.734493947787136
DONE TAKING  40  STEPS.
Total reward:  -614.9954705053577
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -10.111532382682253
DONE TAKING  40  STEPS.
Total reward:  -375.3873547752974
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.52970320909536
DONE TAKING  40  STEPS.
Total reward:  -647.0123943448398
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.080028118073805
DONE TAKING  40  STEPS.
Total reward:  -730.0321942180851
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.917455409659986
DONE TAKING  40  STEPS.
Total reward:  -696.3510722137087
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.48406076239591
DONE TAKING  40  STEPS.
Total reward:  -818.2892910001251
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.860202881050082
DONE TAKING  40  STEPS.
Total reward:  -874.8378730208333
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.753690886843884
DONE TAKING  40  STEPS.
Total reward:  -595.3586757706634
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.330387309630424
DONE TAKING  40  STEPS.
Total reward:  -744.1002502961984
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.54004027032053
DONE TAKING  40  STEPS.
Total reward:  -417.56677595545267
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.01846171613598
DONE TAKING  40  STEPS.
Total reward:  -793.2466171366392
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.475808870750452
DONE TAKING  40  STEPS.
Total reward:  -527.013492001141
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.73241681560151
DONE TAKING  40  STEPS.
Total reward:  -1008.2513691861632
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.65956009619515
DONE TAKING  40  STEPS.
Total reward:  -430.4960795066441
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter9.ckpt
Iter: 10
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  10
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  9750
On pol:  14400
Prob shape:  (24150,)

=== Epoch 0 ===
    train loss:  0.4862050173130441
    val rand:  0.4050067663192749
    val onPol:  0.34614527225494385

=== Epoch 10 ===
    train loss:  0.1853855680278007
    val rand:  0.20223931968212128
    val onPol:  0.30528895060221356

=== Epoch 20 ===
    train loss:  0.13750066227735358
    val rand:  0.17228446900844574
    val onPol:  0.3078493575255076

=== Epoch 30 ===
    train loss:  0.11295723407826525
    val rand:  0.16248692572116852
    val onPol:  0.30962759256362915

=== Epoch 39 ===
    train loss:  0.09609134067246254
    val rand:  0.16676253080368042
    val onPol:  0.3222406605879466
Training duration: 12.23 s

#####################################
performing on-policy MPC rollouts... iter  10
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.969535545102396
DONE TAKING  40  STEPS.
Total reward:  -977.5015537806339
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.961214814828992
DONE TAKING  40  STEPS.
Total reward:  -389.710751745056
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.963956864057714
DONE TAKING  40  STEPS.
Total reward:  -433.12165002144604
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.344995461230052
DONE TAKING  40  STEPS.
Total reward:  -1071.3115096722804
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.975040604345075
DONE TAKING  40  STEPS.
Total reward:  -375.0523425302237
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.46200841757214
DONE TAKING  40  STEPS.
Total reward:  -733.9429842557361
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.784329799817627
DONE TAKING  40  STEPS.
Total reward:  -415.7062625862691
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -9.779341317673007
DONE TAKING  40  STEPS.
Total reward:  -311.7618233139101
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.100955020520626
DONE TAKING  40  STEPS.
Total reward:  -632.2746222186393
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.21473819552679
DONE TAKING  40  STEPS.
Total reward:  -697.6668421434938
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.996766576864594
DONE TAKING  40  STEPS.
Total reward:  -247.13709058338006
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.735762073580677
DONE TAKING  40  STEPS.
Total reward:  -651.3347774124857
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -16.609481271970758
DONE TAKING  40  STEPS.
Total reward:  -334.52263552106865
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -27.96641040613845
DONE TAKING  40  STEPS.
Total reward:  -537.7647316439375
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -15.188522833361308
DONE TAKING  40  STEPS.
Total reward:  -278.7944822621076
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.561216609841537
DONE TAKING  40  STEPS.
Total reward:  -858.9806696363291
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.03189308805573
DONE TAKING  40  STEPS.
Total reward:  -763.3156177406908
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -22.25048144838352
DONE TAKING  40  STEPS.
Total reward:  -371.13240057062023
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.00923977007831
DONE TAKING  40  STEPS.
Total reward:  -763.7897013408996
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.658170166173697
DONE TAKING  40  STEPS.
Total reward:  -302.97770756570344
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.543166812681218
DONE TAKING  40  STEPS.
Total reward:  -861.2444733701425
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.790488732710557
DONE TAKING  40  STEPS.
Total reward:  -996.5227733196755
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.420918240742992
DONE TAKING  40  STEPS.
Total reward:  -901.7903125995134
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.465590489609788
DONE TAKING  40  STEPS.
Total reward:  -668.4527032837877
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.000074341335548
DONE TAKING  40  STEPS.
Total reward:  -471.06730530151043
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.761461661194936
DONE TAKING  40  STEPS.
Total reward:  -830.2082116644357
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.531905562977435
DONE TAKING  40  STEPS.
Total reward:  -896.2745307442327
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -15.912614081555327
DONE TAKING  40  STEPS.
Total reward:  -390.2801203145956
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -10.709816919555886
DONE TAKING  40  STEPS.
Total reward:  -276.036435612792
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.886356445555343
DONE TAKING  40  STEPS.
Total reward:  -842.0775366043949
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.055503197510916
DONE TAKING  40  STEPS.
Total reward:  -716.6005922225851
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -16.60331188859682
DONE TAKING  40  STEPS.
Total reward:  -156.85416334700125
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -13.720704021031004
DONE TAKING  40  STEPS.
Total reward:  -427.5525756246686
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -10.0682813968622
DONE TAKING  40  STEPS.
Total reward:  -344.7269630058728
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -12.709600582252579
DONE TAKING  40  STEPS.
Total reward:  -288.6214372109078
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.861609249876754
DONE TAKING  40  STEPS.
Total reward:  -430.1127556955572
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.233017042656027
DONE TAKING  40  STEPS.
Total reward:  -442.98239012484834
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.886615987932128
DONE TAKING  40  STEPS.
Total reward:  -696.7874582599532
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.983231818619632
DONE TAKING  40  STEPS.
Total reward:  -365.95518305828466
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.176267572300663
DONE TAKING  40  STEPS.
Total reward:  -655.5119325081909
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter10.ckpt
Iter: 11
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  11
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  9945
On pol:  14400
Prob shape:  (24345,)

=== Epoch 0 ===
    train loss:  0.49096857803933164
    val rand:  0.40482181310653687
    val onPol:  0.3591250280539195

=== Epoch 10 ===
    train loss:  0.18690411017296163
    val rand:  0.1944030523300171
    val onPol:  0.324891338745753

=== Epoch 20 ===
    train loss:  0.14273408118714678
    val rand:  0.1747639775276184
    val onPol:  0.3309502104918162

=== Epoch 30 ===
    train loss:  0.11512456374599579
    val rand:  0.16124001145362854
    val onPol:  0.3356931110223134

=== Epoch 39 ===
    train loss:  0.09823662581595968
    val rand:  0.16282352805137634
    val onPol:  0.34149888157844543
Training duration: 11.72 s

#####################################
performing on-policy MPC rollouts... iter  11
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -14.425925759622881
DONE TAKING  40  STEPS.
Total reward:  -388.6691406644078
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.667630962733245
DONE TAKING  40  STEPS.
Total reward:  -361.9788520824108
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -11.9301874335059
DONE TAKING  40  STEPS.
Total reward:  -399.07066938921446
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -12.989186767837808
DONE TAKING  40  STEPS.
Total reward:  177.91250088964776
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -31.066153845255467
DONE TAKING  40  STEPS.
Total reward:  -869.401998600448
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.689013811180097
DONE TAKING  40  STEPS.
Total reward:  -337.66136039025747
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.77263459915044
DONE TAKING  40  STEPS.
Total reward:  -692.5392313750255
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.994983365414807
DONE TAKING  40  STEPS.
Total reward:  -580.3961337562814
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.965647008576017
DONE TAKING  40  STEPS.
Total reward:  -222.68034653222512
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -24.354590786482543
DONE TAKING  40  STEPS.
Total reward:  -707.7963217147529
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.766661110501047
DONE TAKING  40  STEPS.
Total reward:  -1048.9977404159256
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -12.58263487303948
DONE TAKING  40  STEPS.
Total reward:  -310.5347673915296
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.754765538464923
DONE TAKING  40  STEPS.
Total reward:  -1024.2195706244622
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.51875773797852
DONE TAKING  40  STEPS.
Total reward:  -764.7414775782072
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.46639348091219
DONE TAKING  40  STEPS.
Total reward:  -360.96312623927173
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.12059407308469
DONE TAKING  40  STEPS.
Total reward:  -545.4167402410208
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -21.66047517694477
DONE TAKING  40  STEPS.
Total reward:  -415.1508220059866
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.019626093272223
DONE TAKING  40  STEPS.
Total reward:  -951.207423462684
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -14.291066209020215
DONE TAKING  40  STEPS.
Total reward:  -330.8328079658864
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.943855248466896
DONE TAKING  40  STEPS.
Total reward:  -602.0867792959082
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.76140620544561
DONE TAKING  40  STEPS.
Total reward:  -836.9960285197146
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.715474383878743
DONE TAKING  40  STEPS.
Total reward:  -585.5203231280714
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.67623275057356
DONE TAKING  40  STEPS.
Total reward:  -625.3385777987809
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -19.095166320152526
DONE TAKING  40  STEPS.
Total reward:  -433.7565338026782
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.02561179263246
DONE TAKING  40  STEPS.
Total reward:  -744.9775879521296
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.292437318860188
DONE TAKING  40  STEPS.
Total reward:  -685.1205330366713
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.038480236326663
DONE TAKING  40  STEPS.
Total reward:  -920.7768324494647
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.01049252763765
DONE TAKING  40  STEPS.
Total reward:  -1048.723653912429
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.727076013438158
DONE TAKING  40  STEPS.
Total reward:  -511.1184158725738
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.77842671964627
DONE TAKING  40  STEPS.
Total reward:  -518.8402064695392
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.463119050764632
DONE TAKING  40  STEPS.
Total reward:  -370.033175919975
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.043138062247994
DONE TAKING  40  STEPS.
Total reward:  -619.1416014004255
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.204044762630726
DONE TAKING  40  STEPS.
Total reward:  -321.93933534033647
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.49495450163471
DONE TAKING  40  STEPS.
Total reward:  -498.18960999707
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.445515123891695
DONE TAKING  40  STEPS.
Total reward:  -708.900086233642
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.90960441486264
DONE TAKING  40  STEPS.
Total reward:  -640.4962223732535
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -31.06674351194315
DONE TAKING  40  STEPS.
Total reward:  -1000.9719709353162
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.09443963866417
DONE TAKING  40  STEPS.
Total reward:  -755.1719052158056
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.77796358754883
DONE TAKING  40  STEPS.
Total reward:  -944.5706962453536
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.381869644160604
DONE TAKING  40  STEPS.
Total reward:  -378.9981984468799
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter11.ckpt
Iter: 12
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  12
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  10140
On pol:  14400
Prob shape:  (24540,)

=== Epoch 0 ===
    train loss:  0.48965039278598543
    val rand:  0.42188912630081177
    val onPol:  0.35352663199106854

=== Epoch 10 ===
    train loss:  0.18596094466270285
    val rand:  0.20470742881298065
    val onPol:  0.31143441796302795

=== Epoch 20 ===
    train loss:  0.14135077437187762
    val rand:  0.1705653965473175
    val onPol:  0.3154749075571696

=== Epoch 30 ===
    train loss:  0.11414677411951918
    val rand:  0.163563072681427
    val onPol:  0.324310561021169

=== Epoch 39 ===
    train loss:  0.09921695640746583
    val rand:  0.16457277536392212
    val onPol:  0.32961281140645343
Training duration: 11.76 s

#####################################
performing on-policy MPC rollouts... iter  12
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.40536069639463
DONE TAKING  40  STEPS.
Total reward:  -438.8278855582081
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.297516008266708
DONE TAKING  40  STEPS.
Total reward:  -780.0083405441968
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.061461605807967
DONE TAKING  40  STEPS.
Total reward:  -659.8237545607661
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.602373796761732
DONE TAKING  40  STEPS.
Total reward:  -1067.117980327363
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -9.72922726110697
DONE TAKING  40  STEPS.
Total reward:  -349.52187495218715
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.234505016194916
DONE TAKING  40  STEPS.
Total reward:  -539.6884450590468
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.677709429774822
DONE TAKING  40  STEPS.
Total reward:  -808.6195272713093
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.989069582452746
DONE TAKING  40  STEPS.
Total reward:  -737.1406046704157
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.25516461135668
DONE TAKING  40  STEPS.
Total reward:  -1186.5557190265458
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.406365753596273
DONE TAKING  40  STEPS.
Total reward:  -689.7170860567578
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.316211623075084
DONE TAKING  40  STEPS.
Total reward:  -848.3505652470383
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.746592310193492
DONE TAKING  40  STEPS.
Total reward:  -553.1577812665223
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -16.84733785812412
DONE TAKING  40  STEPS.
Total reward:  -619.139174266367
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -19.958778890747613
DONE TAKING  40  STEPS.
Total reward:  -607.5876159064372
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.593523197498854
DONE TAKING  40  STEPS.
Total reward:  -561.821886332407
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.667308365426738
DONE TAKING  40  STEPS.
Total reward:  -897.2528025575834
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.83857996481063
DONE TAKING  40  STEPS.
Total reward:  -911.0163564089828
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.735078925733813
DONE TAKING  40  STEPS.
Total reward:  -900.957298377545
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.89230547851345
DONE TAKING  40  STEPS.
Total reward:  -401.1083160319491
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.962886441690085
DONE TAKING  40  STEPS.
Total reward:  -847.8351084264696
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -14.954511186109624
DONE TAKING  40  STEPS.
Total reward:  -437.69098640147376
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.635285760819706
DONE TAKING  40  STEPS.
Total reward:  -607.8326551249438
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.944764197678317
DONE TAKING  40  STEPS.
Total reward:  -488.07792042537136
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -26.5333371676536
DONE TAKING  40  STEPS.
Total reward:  -587.528013107284
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.9101854113127
DONE TAKING  40  STEPS.
Total reward:  -968.637238456152
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.450281804628517
DONE TAKING  40  STEPS.
Total reward:  -520.9197068282708
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.33284916001456
DONE TAKING  40  STEPS.
Total reward:  -634.4686421882478
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.19858817838047
DONE TAKING  40  STEPS.
Total reward:  -761.2402647578075
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.870108689235387
DONE TAKING  40  STEPS.
Total reward:  -440.9033895483506
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.873915396353127
DONE TAKING  40  STEPS.
Total reward:  -836.3392379770919
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.807407470301985
DONE TAKING  40  STEPS.
Total reward:  -646.9696824953392
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -31.24844520286235
DONE TAKING  40  STEPS.
Total reward:  -806.2100208233338
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -27.50616728852051
DONE TAKING  40  STEPS.
Total reward:  -647.9869822208767
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.59913032063301
DONE TAKING  40  STEPS.
Total reward:  -719.4822813200591
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.98773946303426
DONE TAKING  40  STEPS.
Total reward:  -623.3297883728266
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.591146209958232
DONE TAKING  40  STEPS.
Total reward:  -425.0061939854012
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.4320151644473
DONE TAKING  40  STEPS.
Total reward:  -833.806722453365
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.211617721299245
DONE TAKING  40  STEPS.
Total reward:  -487.9340862263009
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.45923529069764
DONE TAKING  40  STEPS.
Total reward:  -775.4720070861042
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.06525104880444
DONE TAKING  40  STEPS.
Total reward:  -691.400230635093
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter12.ckpt
Iter: 13
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  13
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  10335
On pol:  14400
Prob shape:  (24735,)

=== Epoch 0 ===
    train loss:  0.48955764435231686
    val rand:  0.4070584177970886
    val onPol:  0.33044740557670593

=== Epoch 10 ===
    train loss:  0.18720204352090755
    val rand:  0.20041701197624207
    val onPol:  0.29281484584013623

=== Epoch 20 ===
    train loss:  0.14249310859789452
    val rand:  0.17267285287380219
    val onPol:  0.29520584146181744

=== Epoch 30 ===
    train loss:  0.11693295851970713
    val rand:  0.16273564100265503
    val onPol:  0.30190639694531757

=== Epoch 39 ===
    train loss:  0.10064392335092028
    val rand:  0.15845635533332825
    val onPol:  0.30993226170539856
Training duration: 11.98 s

#####################################
performing on-policy MPC rollouts... iter  13
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.547877977103617
DONE TAKING  40  STEPS.
Total reward:  -961.2065811176147
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.05392152111017
DONE TAKING  40  STEPS.
Total reward:  -937.3048590507415
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.45088116730885
DONE TAKING  40  STEPS.
Total reward:  -637.1979148350821
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.846012278966235
DONE TAKING  40  STEPS.
Total reward:  -817.5971112557844
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.03878433380394
DONE TAKING  40  STEPS.
Total reward:  -770.0573666263026
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.6730470209787
DONE TAKING  40  STEPS.
Total reward:  -646.3306575749665
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.25141702521685
DONE TAKING  40  STEPS.
Total reward:  -1120.2957741729663
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.51580709107697
DONE TAKING  40  STEPS.
Total reward:  -631.919687344314
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -24.135980350705253
DONE TAKING  40  STEPS.
Total reward:  -909.658125414051
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.026600276372278
DONE TAKING  40  STEPS.
Total reward:  -817.748698865322
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.520239235893698
DONE TAKING  40  STEPS.
Total reward:  -557.2488872223394
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.965614979358833
DONE TAKING  40  STEPS.
Total reward:  -905.6382580903079
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.759472420721416
DONE TAKING  40  STEPS.
Total reward:  -637.8084563644838
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -14.840630587816229
DONE TAKING  40  STEPS.
Total reward:  -278.37289155759805
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.21490990535068
DONE TAKING  40  STEPS.
Total reward:  -767.0315080313582
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.03257056922876
DONE TAKING  40  STEPS.
Total reward:  -1033.8478012239027
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.17633810388422
DONE TAKING  40  STEPS.
Total reward:  -676.5848608275147
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.858846707993944
DONE TAKING  40  STEPS.
Total reward:  -673.0452090167555
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.999350390238924
DONE TAKING  40  STEPS.
Total reward:  -715.0276094896133
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.414810892461375
DONE TAKING  40  STEPS.
Total reward:  -537.6720150719203
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.748092480412346
DONE TAKING  40  STEPS.
Total reward:  -807.5286772836948
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.343158823070066
DONE TAKING  40  STEPS.
Total reward:  -637.4477962397056
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.0021698864009
DONE TAKING  40  STEPS.
Total reward:  -510.4422241299032
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.299593194449916
DONE TAKING  40  STEPS.
Total reward:  -567.5377921841103
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.346979699291815
DONE TAKING  40  STEPS.
Total reward:  -592.8696670205842
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.656140652557717
DONE TAKING  40  STEPS.
Total reward:  -745.722341581769
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.395369447859373
DONE TAKING  40  STEPS.
Total reward:  -928.367523562985
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.864770195876517
DONE TAKING  40  STEPS.
Total reward:  -626.6648716440802
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.149586771185643
DONE TAKING  40  STEPS.
Total reward:  -787.405404195515
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.02595459705003
DONE TAKING  40  STEPS.
Total reward:  -1027.647923385139
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.93241816344163
DONE TAKING  40  STEPS.
Total reward:  -351.4616008616054
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.09250552972875
DONE TAKING  40  STEPS.
Total reward:  -892.096329118502
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.231737066600488
DONE TAKING  40  STEPS.
Total reward:  -300.95033737645537
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.071121297416653
DONE TAKING  40  STEPS.
Total reward:  -370.5840238439762
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.48966997769523
DONE TAKING  40  STEPS.
Total reward:  -570.3071638398239
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.47518967983099
DONE TAKING  40  STEPS.
Total reward:  -617.8788261381529
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.72916406262592
DONE TAKING  40  STEPS.
Total reward:  -432.46359220737213
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.747021390330847
DONE TAKING  40  STEPS.
Total reward:  -797.3653712123912
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -9.827965206579243
DONE TAKING  40  STEPS.
Total reward:  -228.16952934381717
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -30.525047697173623
DONE TAKING  40  STEPS.
Total reward:  -851.9839543230643
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter13.ckpt
Iter: 14
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  14
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  10530
On pol:  14400
Prob shape:  (24930,)

=== Epoch 0 ===
    train loss:  0.49230254131058854
    val rand:  0.42452549934387207
    val onPol:  0.33304940660794574

=== Epoch 10 ===
    train loss:  0.18348499791075787
    val rand:  0.20877544581890106
    val onPol:  0.28872854510943097

=== Epoch 20 ===
    train loss:  0.1420011275137464
    val rand:  0.1805758774280548
    val onPol:  0.2904768983523051

=== Epoch 30 ===
    train loss:  0.1164674914131562
    val rand:  0.17195777595043182
    val onPol:  0.29983727137247723

=== Epoch 39 ===
    train loss:  0.09910251013934612
    val rand:  0.16377690434455872
    val onPol:  0.3049967388312022
Training duration: 12.49 s

#####################################
performing on-policy MPC rollouts... iter  14
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.575213787880628
DONE TAKING  40  STEPS.
Total reward:  -572.4922243554855
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.266945502421486
DONE TAKING  40  STEPS.
Total reward:  -394.3721376079734
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.331855835794553
DONE TAKING  40  STEPS.
Total reward:  -611.4110786187675
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.816028494131125
DONE TAKING  40  STEPS.
Total reward:  -908.4604917248038
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.228375868260823
DONE TAKING  40  STEPS.
Total reward:  -883.8919306999618
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.705754461344046
DONE TAKING  40  STEPS.
Total reward:  -736.3884458395836
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.689835765774774
DONE TAKING  40  STEPS.
Total reward:  -691.9662575278824
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.503850544079043
DONE TAKING  40  STEPS.
Total reward:  -599.0856781787974
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.592230401006795
DONE TAKING  40  STEPS.
Total reward:  -709.1458024484475
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.542237704324666
DONE TAKING  40  STEPS.
Total reward:  -877.6542735967931
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.13967089631699
DONE TAKING  40  STEPS.
Total reward:  -1046.5633086590574
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -20.134036280992778
DONE TAKING  40  STEPS.
Total reward:  -306.4338515023064
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -13.26605755302197
DONE TAKING  40  STEPS.
Total reward:  -356.3185503579297
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.26742413159385
DONE TAKING  40  STEPS.
Total reward:  -847.2934377278822
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.0418433847879
DONE TAKING  40  STEPS.
Total reward:  -399.81444384100985
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.914941235000533
DONE TAKING  40  STEPS.
Total reward:  -529.6488332066915
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -15.094310519187633
DONE TAKING  40  STEPS.
Total reward:  -393.6021124678592
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -8.580044062520946
DONE TAKING  40  STEPS.
Total reward:  -282.8001958163913
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.951234534817765
DONE TAKING  40  STEPS.
Total reward:  -439.96553231207474
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.7606869289244
DONE TAKING  40  STEPS.
Total reward:  -480.7462616863376
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -11.662806886586182
DONE TAKING  40  STEPS.
Total reward:  -372.8410155669156
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.338081908414328
DONE TAKING  40  STEPS.
Total reward:  -1001.1428700134419
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.92016269473048
DONE TAKING  40  STEPS.
Total reward:  -752.5513126893261
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.567906977184517
DONE TAKING  40  STEPS.
Total reward:  -334.5278246887455
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -21.597393395707265
DONE TAKING  40  STEPS.
Total reward:  -552.046184503978
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -11.792791635484484
DONE TAKING  40  STEPS.
Total reward:  -367.66024369354966
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.863380233032643
DONE TAKING  40  STEPS.
Total reward:  -990.0684528952829
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -17.71152051732531
DONE TAKING  40  STEPS.
Total reward:  -361.70467923280955
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.536560997642482
DONE TAKING  40  STEPS.
Total reward:  -524.4557243043964
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.33438742348303
DONE TAKING  40  STEPS.
Total reward:  -750.9095286164321
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.293204979966
DONE TAKING  40  STEPS.
Total reward:  -753.2554456637828
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -31.36692787343193
DONE TAKING  40  STEPS.
Total reward:  -840.8918274474187
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.49009140267921
DONE TAKING  40  STEPS.
Total reward:  -859.4711755178166
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -20.492855684538007
DONE TAKING  40  STEPS.
Total reward:  -457.36727012871694
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.081784761013935
DONE TAKING  40  STEPS.
Total reward:  -442.8926115450701
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.8865444830316
DONE TAKING  40  STEPS.
Total reward:  -754.964060755064
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -31.184723083719543
DONE TAKING  40  STEPS.
Total reward:  -1040.7803430173258
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -19.170875378299336
DONE TAKING  40  STEPS.
Total reward:  -402.4464023405205
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.76238788520951
DONE TAKING  40  STEPS.
Total reward:  -696.7054941600032
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -19.62230642180083
DONE TAKING  40  STEPS.
Total reward:  -374.81400634605603
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter14.ckpt
Iter: 15
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  15
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  10725
On pol:  14400
Prob shape:  (25125,)

=== Epoch 0 ===
    train loss:  0.4877809845671362
    val rand:  0.4054141938686371
    val onPol:  0.3175144096215566

=== Epoch 10 ===
    train loss:  0.18567930222774037
    val rand:  0.2053934931755066
    val onPol:  0.2823176185290019

=== Epoch 20 ===
    train loss:  0.13828482189956975
    val rand:  0.17828914523124695
    val onPol:  0.28627854585647583

=== Epoch 30 ===
    train loss:  0.11488062447431135
    val rand:  0.17101874947547913
    val onPol:  0.2907215754191081

=== Epoch 39 ===
    train loss:  0.0993417825321762
    val rand:  0.1636132299900055
    val onPol:  0.29707759618759155
Training duration: 11.69 s

#####################################
performing on-policy MPC rollouts... iter  15
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.865997456223408
DONE TAKING  40  STEPS.
Total reward:  -998.144553172995
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -18.15058342729152
DONE TAKING  40  STEPS.
Total reward:  -684.1456960876172
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.144181740301924
DONE TAKING  40  STEPS.
Total reward:  -965.7672696120778
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.45510422349489
DONE TAKING  40  STEPS.
Total reward:  -571.6527163059338
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.582561258830934
DONE TAKING  40  STEPS.
Total reward:  -315.5981155026119
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.544135424575337
DONE TAKING  40  STEPS.
Total reward:  -914.3274225322434
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.896920283030354
DONE TAKING  40  STEPS.
Total reward:  -918.2790393632172
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.00946534015482
DONE TAKING  40  STEPS.
Total reward:  -1019.4864089340142
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.086156308145636
DONE TAKING  40  STEPS.
Total reward:  -121.76767496256971
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -13.577270186528018
DONE TAKING  40  STEPS.
Total reward:  -377.5084941731975
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.864553426960207
DONE TAKING  40  STEPS.
Total reward:  -1028.1721285002752
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -18.936984144266624
DONE TAKING  40  STEPS.
Total reward:  -347.7973424789163
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.271203701717774
DONE TAKING  40  STEPS.
Total reward:  -522.7227734957793
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.26783701103199
DONE TAKING  40  STEPS.
Total reward:  -477.2377432269518
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.6493667099427
DONE TAKING  40  STEPS.
Total reward:  -428.06621966878214
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.784953536507892
DONE TAKING  40  STEPS.
Total reward:  -472.82394731130586
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.994028385291035
DONE TAKING  40  STEPS.
Total reward:  -618.5195314167304
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.92798501613682
DONE TAKING  40  STEPS.
Total reward:  -709.6620580612034
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.792030880154847
DONE TAKING  40  STEPS.
Total reward:  -394.4382844673684
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.40966408362231
DONE TAKING  40  STEPS.
Total reward:  -316.94606906549126
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.815282678170803
DONE TAKING  40  STEPS.
Total reward:  -857.6093812364549
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.814046702240212
DONE TAKING  40  STEPS.
Total reward:  -860.7135448382151
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.695904182734296
DONE TAKING  40  STEPS.
Total reward:  -795.6980524439169
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.136663940158865
DONE TAKING  40  STEPS.
Total reward:  -544.5004887471248
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.495065632913075
DONE TAKING  40  STEPS.
Total reward:  -640.3212842126073
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -9.680006317706344
DONE TAKING  40  STEPS.
Total reward:  -391.3814192028257
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.348341317001285
DONE TAKING  40  STEPS.
Total reward:  -409.8795281046169
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -11.560566314313652
DONE TAKING  40  STEPS.
Total reward:  -391.568125875805
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.482349800715262
DONE TAKING  40  STEPS.
Total reward:  -440.1754798783574
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.613800739026097
DONE TAKING  40  STEPS.
Total reward:  -399.62705654641064
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.440657696453616
DONE TAKING  40  STEPS.
Total reward:  -625.7338968665848
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.779528318280143
DONE TAKING  40  STEPS.
Total reward:  -359.36337967610825
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.848305401078473
DONE TAKING  40  STEPS.
Total reward:  -505.02546072556044
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.872482389077597
DONE TAKING  40  STEPS.
Total reward:  -858.6093794365892
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.204007520771256
DONE TAKING  40  STEPS.
Total reward:  -881.0165624177401
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.400963736831763
DONE TAKING  40  STEPS.
Total reward:  -885.0479355207888
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.419176196177947
DONE TAKING  40  STEPS.
Total reward:  -1047.995410015586
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.34368839354385
DONE TAKING  40  STEPS.
Total reward:  -846.5346754707422
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.593885699743563
DONE TAKING  40  STEPS.
Total reward:  -1169.4366978114213
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.97839568289157
DONE TAKING  40  STEPS.
Total reward:  -654.020215679188
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter15.ckpt
Iter: 16
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  16
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  10920
On pol:  14400
Prob shape:  (25320,)

=== Epoch 0 ===
    train loss:  0.4756545679909842
    val rand:  0.3942701816558838
    val onPol:  0.3129168649514516

=== Epoch 10 ===
    train loss:  0.1856432325985967
    val rand:  0.1985742747783661
    val onPol:  0.27785064776738483

=== Epoch 20 ===
    train loss:  0.1376341920422048
    val rand:  0.17293709516525269
    val onPol:  0.2808069388071696

=== Epoch 30 ===
    train loss:  0.11485235590715798
    val rand:  0.16295303404331207
    val onPol:  0.28775612513224286

=== Epoch 39 ===
    train loss:  0.09853713077550032
    val rand:  0.16024711728096008
    val onPol:  0.299574077129364
Training duration: 6.33 s

#####################################
performing on-policy MPC rollouts... iter  16
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.653338951172458
DONE TAKING  40  STEPS.
Total reward:  -811.7940320810453
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.81614009894865
DONE TAKING  40  STEPS.
Total reward:  -852.9594501669761
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -16.15894735085551
DONE TAKING  40  STEPS.
Total reward:  -321.107572371469
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.90868444896198
DONE TAKING  40  STEPS.
Total reward:  -247.77749640983205
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.225294168631105
DONE TAKING  40  STEPS.
Total reward:  -759.651171800588
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.36192387692575
DONE TAKING  40  STEPS.
Total reward:  -683.5767395235902
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -13.14405759178367
DONE TAKING  40  STEPS.
Total reward:  -375.13298921150596
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -12.539272867913361
DONE TAKING  40  STEPS.
Total reward:  -340.60695559624594
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.073504578853612
DONE TAKING  40  STEPS.
Total reward:  -856.6031626154671
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.432263434747217
DONE TAKING  40  STEPS.
Total reward:  -467.339093264493
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.536956023108413
DONE TAKING  40  STEPS.
Total reward:  -445.08150810265505
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.630297992999303
DONE TAKING  40  STEPS.
Total reward:  -365.62875779518765
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.04612354602991
DONE TAKING  40  STEPS.
Total reward:  -850.4677922812203
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.36684434045614
DONE TAKING  40  STEPS.
Total reward:  -832.3416894319464
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -17.79588657692265
DONE TAKING  40  STEPS.
Total reward:  -554.1284267797943
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.982202600191687
DONE TAKING  40  STEPS.
Total reward:  -545.2485397625238
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -17.068371937587386
DONE TAKING  40  STEPS.
Total reward:  -519.4930306612392
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.144659918055476
DONE TAKING  40  STEPS.
Total reward:  -363.6058656910613
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.02287949990868
DONE TAKING  40  STEPS.
Total reward:  -920.3328850947041
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.360038005271107
DONE TAKING  40  STEPS.
Total reward:  -670.2020352258224
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -15.96522599975156
DONE TAKING  40  STEPS.
Total reward:  -363.42519453174054
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.282558870183728
DONE TAKING  40  STEPS.
Total reward:  -518.0472201343434
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.90323183869716
DONE TAKING  40  STEPS.
Total reward:  -718.1766466792295
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.95768497693706
DONE TAKING  40  STEPS.
Total reward:  -694.729827503339
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.970194401682935
DONE TAKING  40  STEPS.
Total reward:  -675.0540473496799
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.78464071194398
DONE TAKING  40  STEPS.
Total reward:  -1044.983897052432
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.923781102341728
DONE TAKING  40  STEPS.
Total reward:  -683.1119747719575
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.365715840391033
DONE TAKING  40  STEPS.
Total reward:  -605.9696206419749
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.077703466220036
DONE TAKING  40  STEPS.
Total reward:  -943.1674592625203
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.615999805961565
DONE TAKING  40  STEPS.
Total reward:  -453.2362574048286
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.60463235217015
DONE TAKING  40  STEPS.
Total reward:  -381.2340915702226
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.699940870114382
DONE TAKING  40  STEPS.
Total reward:  -456.39144196795905
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.037101015758708
DONE TAKING  40  STEPS.
Total reward:  -395.0247530382759
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.807815948261545
DONE TAKING  40  STEPS.
Total reward:  -639.3869885538742
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.99252229159802
DONE TAKING  40  STEPS.
Total reward:  -383.31260844602235
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.74783566366213
DONE TAKING  40  STEPS.
Total reward:  -980.6113104983546
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.965398141130905
DONE TAKING  40  STEPS.
Total reward:  -653.0357533529625
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.447855890778158
DONE TAKING  40  STEPS.
Total reward:  -727.6413669287051
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.166049135329565
DONE TAKING  40  STEPS.
Total reward:  -486.0423665965111
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.319968549486253
DONE TAKING  40  STEPS.
Total reward:  55.945704022808656
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter16.ckpt
Iter: 17
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  17
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  11115
On pol:  14400
Prob shape:  (25515,)

=== Epoch 0 ===
    train loss:  0.48640974991175595
    val rand:  0.40453290939331055
    val onPol:  0.3108571966489156

=== Epoch 10 ===
    train loss:  0.1854166470620097
    val rand:  0.19923529028892517
    val onPol:  0.2706023504336675

=== Epoch 20 ===
    train loss:  0.14216744534823358
    val rand:  0.17084269225597382
    val onPol:  0.27285994092623395

=== Epoch 30 ===
    train loss:  0.11455538686440915
    val rand:  0.15648984909057617
    val onPol:  0.27718480428059894

=== Epoch 39 ===
    train loss:  0.10177614722324878
    val rand:  0.15982463955879211
    val onPol:  0.2844028174877167
Training duration: 7.88 s

#####################################
performing on-policy MPC rollouts... iter  17
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.00728924979202
DONE TAKING  40  STEPS.
Total reward:  -642.0460834970788
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -18.189018419944
DONE TAKING  40  STEPS.
Total reward:  -672.490373029752
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -16.599726712229625
DONE TAKING  40  STEPS.
Total reward:  -481.0918187698363
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.1990298339602
DONE TAKING  40  STEPS.
Total reward:  -816.045334798695
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.006508304259143
DONE TAKING  40  STEPS.
Total reward:  -890.7032306003621
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.78633939863267
DONE TAKING  40  STEPS.
Total reward:  -357.6542066985396
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.532334185067995
DONE TAKING  40  STEPS.
Total reward:  -785.232429969099
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.588965887761383
DONE TAKING  40  STEPS.
Total reward:  -568.4840360926215
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.084592097580774
DONE TAKING  40  STEPS.
Total reward:  -744.9873603663478
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.13784610753021
DONE TAKING  40  STEPS.
Total reward:  -201.81584441832044
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.198013735073378
DONE TAKING  40  STEPS.
Total reward:  -522.9456920766912
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.959143143613694
DONE TAKING  40  STEPS.
Total reward:  -363.39894833057207
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.34180063928156
DONE TAKING  40  STEPS.
Total reward:  -566.1212600059955
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -27.511223848873485
DONE TAKING  40  STEPS.
Total reward:  -600.8718742682372
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.83417416760524
DONE TAKING  40  STEPS.
Total reward:  -479.1462466224811
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.3836104618401
DONE TAKING  40  STEPS.
Total reward:  -750.012876807047
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.876452399070015
DONE TAKING  40  STEPS.
Total reward:  -619.8207029506289
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.590325132154
DONE TAKING  40  STEPS.
Total reward:  -833.2292237145925
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.309917431340715
DONE TAKING  40  STEPS.
Total reward:  -487.294650656379
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -19.546297325401365
DONE TAKING  40  STEPS.
Total reward:  -693.0768811498358
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.493148897839756
DONE TAKING  40  STEPS.
Total reward:  -560.7576237156827
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.496218426927623
DONE TAKING  40  STEPS.
Total reward:  -558.8444372560408
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.685762076066304
DONE TAKING  40  STEPS.
Total reward:  -339.49064922517516
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.557544143671006
DONE TAKING  40  STEPS.
Total reward:  -309.59866002522557
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.721592876694064
DONE TAKING  40  STEPS.
Total reward:  -775.3403288078515
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.68746831578307
DONE TAKING  40  STEPS.
Total reward:  -309.8493496334364
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -15.032529495780668
DONE TAKING  40  STEPS.
Total reward:  -231.60384062316376
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.553305115097547
DONE TAKING  40  STEPS.
Total reward:  -987.8532734191692
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -21.04737369225822
DONE TAKING  40  STEPS.
Total reward:  -816.6403575316061
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.833132544431745
DONE TAKING  40  STEPS.
Total reward:  -732.1190892557296
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.408766285043225
DONE TAKING  40  STEPS.
Total reward:  -569.0089206457625
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.606685929617147
DONE TAKING  40  STEPS.
Total reward:  -359.4465105500118
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.916387271908086
DONE TAKING  40  STEPS.
Total reward:  -746.5272810947816
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -18.61516420258021
DONE TAKING  40  STEPS.
Total reward:  -526.0071064294276
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.163046935364967
DONE TAKING  40  STEPS.
Total reward:  -809.3775758819477
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.018710612431974
DONE TAKING  40  STEPS.
Total reward:  -705.6806609248636
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.285768139171868
DONE TAKING  40  STEPS.
Total reward:  -578.762103925474
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.68235529630587
DONE TAKING  40  STEPS.
Total reward:  -1086.1948214829106
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.868688956627786
DONE TAKING  40  STEPS.
Total reward:  -631.6020010478916
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.91658940053081
DONE TAKING  40  STEPS.
Total reward:  -481.55716126409897
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter17.ckpt
Iter: 18
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  18
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  11310
On pol:  14400
Prob shape:  (25710,)

=== Epoch 0 ===
    train loss:  0.4858226573467255
    val rand:  0.40188413858413696
    val onPol:  0.31663938363393146

=== Epoch 10 ===
    train loss:  0.1830574256181717
    val rand:  0.1964547336101532
    val onPol:  0.2804371416568756

=== Epoch 20 ===
    train loss:  0.13855904459953308
    val rand:  0.17086350917816162
    val onPol:  0.28213466207186383

=== Epoch 30 ===
    train loss:  0.11537838742136955
    val rand:  0.16316434741020203
    val onPol:  0.2860366106033325

=== Epoch 39 ===
    train loss:  0.09930152907967567
    val rand:  0.15570661425590515
    val onPol:  0.29557321468989056
Training duration: 13.02 s

#####################################
performing on-policy MPC rollouts... iter  18
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.123658282048993
DONE TAKING  40  STEPS.
Total reward:  -623.6432362344377
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.007878652610902
DONE TAKING  40  STEPS.
Total reward:  -404.1772135009868
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.994827840911256
DONE TAKING  40  STEPS.
Total reward:  -405.2493744893665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.754049052706357
DONE TAKING  40  STEPS.
Total reward:  -719.8699688262499
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -13.075338004893878
DONE TAKING  40  STEPS.
Total reward:  -418.935467322128
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -12.608203525432188
DONE TAKING  40  STEPS.
Total reward:  219.68814537562096
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.379652034909736
DONE TAKING  40  STEPS.
Total reward:  -989.7952890582164
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.11206472106967
DONE TAKING  40  STEPS.
Total reward:  -422.9437013786922
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.08002013357749
DONE TAKING  40  STEPS.
Total reward:  -350.93973031810395
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.40763710774756
DONE TAKING  40  STEPS.
Total reward:  -575.6786742087867
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.02595943098109
DONE TAKING  40  STEPS.
Total reward:  -676.7168022627129
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.172175396834852
DONE TAKING  40  STEPS.
Total reward:  -834.6469436908358
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.470039882000844
DONE TAKING  40  STEPS.
Total reward:  -319.6870659361954
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.842516418363076
DONE TAKING  40  STEPS.
Total reward:  -510.53843220877826
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.781167914855097
DONE TAKING  40  STEPS.
Total reward:  -377.7501656965113
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.380488894672116
DONE TAKING  40  STEPS.
Total reward:  -821.6928608605998
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.48862510093547
DONE TAKING  40  STEPS.
Total reward:  -238.70678470935817
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -18.516326536445046
DONE TAKING  40  STEPS.
Total reward:  -615.2253576679176
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.089606149464412
DONE TAKING  40  STEPS.
Total reward:  -819.7798517601422
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -12.470164023534021
DONE TAKING  40  STEPS.
Total reward:  -292.8821503353209
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.742743461378453
DONE TAKING  40  STEPS.
Total reward:  -495.0762862087452
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.44510684581088
DONE TAKING  40  STEPS.
Total reward:  -496.2988709433471
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.512450498656737
DONE TAKING  40  STEPS.
Total reward:  -1042.906212937302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.8148004002621
DONE TAKING  40  STEPS.
Total reward:  -712.8848395127824
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.76825964305519
DONE TAKING  40  STEPS.
Total reward:  -952.3809218483822
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.218308503280333
DONE TAKING  40  STEPS.
Total reward:  -724.2173033982899
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.199597162611443
DONE TAKING  40  STEPS.
Total reward:  -729.6082323637615
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.484460414979857
DONE TAKING  40  STEPS.
Total reward:  -826.7468355654261
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.305471626285303
DONE TAKING  40  STEPS.
Total reward:  -326.0481722044637
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.3747579949733
DONE TAKING  40  STEPS.
Total reward:  -440.15029189590535
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.785773569116373
DONE TAKING  40  STEPS.
Total reward:  -940.5411686793576
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.260864356824396
DONE TAKING  40  STEPS.
Total reward:  -604.874772046528
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.680653465565413
DONE TAKING  40  STEPS.
Total reward:  -282.1923844017043
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.751754132986449
DONE TAKING  40  STEPS.
Total reward:  -470.7255291283437
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.956907122229516
DONE TAKING  40  STEPS.
Total reward:  -656.9345487448923
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.280380987703673
DONE TAKING  40  STEPS.
Total reward:  -871.0754324640337
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.234493842633896
DONE TAKING  40  STEPS.
Total reward:  -445.4369013692428
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.569526749728556
DONE TAKING  40  STEPS.
Total reward:  -712.4386704066765
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.37883901067442
DONE TAKING  40  STEPS.
Total reward:  -735.1187252647396
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.73225628623119
DONE TAKING  40  STEPS.
Total reward:  -783.8284261425811
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter18.ckpt
Iter: 19
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  19
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  11505
On pol:  14400
Prob shape:  (25905,)

=== Epoch 0 ===
    train loss:  0.48405091047286986
    val rand:  0.4115630090236664
    val onPol:  0.3033107916514079

=== Epoch 10 ===
    train loss:  0.18610960453748704
    val rand:  0.20190170407295227
    val onPol:  0.2644542058308919

=== Epoch 20 ===
    train loss:  0.1414459228515625
    val rand:  0.16915357112884521
    val onPol:  0.2639414072036743

=== Epoch 30 ===
    train loss:  0.11426244184374809
    val rand:  0.16283559799194336
    val onPol:  0.27119330565134686

=== Epoch 39 ===
    train loss:  0.09876439794898033
    val rand:  0.16055580973625183
    val onPol:  0.2756912310918172
Training duration: 12.48 s

#####################################
performing on-policy MPC rollouts... iter  19
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -28.540904820006453
DONE TAKING  40  STEPS.
Total reward:  -693.2737281531366
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.311015468568172
DONE TAKING  40  STEPS.
Total reward:  -935.5488198133717
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.097378284701094
DONE TAKING  40  STEPS.
Total reward:  -486.48905462820363
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.35780816165308
DONE TAKING  40  STEPS.
Total reward:  -750.1932905288928
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.11606242376287
DONE TAKING  40  STEPS.
Total reward:  -505.772672836932
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.618690157468844
DONE TAKING  40  STEPS.
Total reward:  -748.6507956940079
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.749743176592865
DONE TAKING  40  STEPS.
Total reward:  -872.1244845712155
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.607119219017807
DONE TAKING  40  STEPS.
Total reward:  -671.6592950125722
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.45329493945033
DONE TAKING  40  STEPS.
Total reward:  -1042.658189048618
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.417507822229723
DONE TAKING  40  STEPS.
Total reward:  -873.9374338009935
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.58427072271629
DONE TAKING  40  STEPS.
Total reward:  -665.814168965217
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.7177842856361
DONE TAKING  40  STEPS.
Total reward:  -835.2223850502053
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.233606720586508
DONE TAKING  40  STEPS.
Total reward:  -661.5413764032551
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.36551529348359
DONE TAKING  40  STEPS.
Total reward:  -480.84956158099493
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.479421950614906
DONE TAKING  40  STEPS.
Total reward:  -577.2193294419991
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.682709485627168
DONE TAKING  40  STEPS.
Total reward:  -383.62472612318277
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -16.886050436529786
DONE TAKING  40  STEPS.
Total reward:  -229.86243297682864
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.419871928362078
DONE TAKING  40  STEPS.
Total reward:  -938.0233174307665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.459712436516185
DONE TAKING  40  STEPS.
Total reward:  -599.2376919628497
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.21491814906308
DONE TAKING  40  STEPS.
Total reward:  -1031.463747420192
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.20464196224387
DONE TAKING  40  STEPS.
Total reward:  -608.9009529580944
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.568048902061385
DONE TAKING  40  STEPS.
Total reward:  -576.3874351067903
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.868017152492342
DONE TAKING  40  STEPS.
Total reward:  -806.7220828237622
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.555816662495587
DONE TAKING  40  STEPS.
Total reward:  -771.4412645121523
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.28486539967072
DONE TAKING  40  STEPS.
Total reward:  -647.0069196088396
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.99241908000019
DONE TAKING  40  STEPS.
Total reward:  -1057.9332029248915
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.217826581933792
DONE TAKING  40  STEPS.
Total reward:  -707.7321050355753
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -15.374148953253197
DONE TAKING  40  STEPS.
Total reward:  -430.39845303532064
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.454931105664908
DONE TAKING  40  STEPS.
Total reward:  -875.3774070744037
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.52937570202074
DONE TAKING  40  STEPS.
Total reward:  -493.1086509804591
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -31.18474030618662
DONE TAKING  40  STEPS.
Total reward:  -706.5710434209964
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.290730393814307
DONE TAKING  40  STEPS.
Total reward:  -317.4797512891547
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -29.250161945980672
DONE TAKING  40  STEPS.
Total reward:  -860.8405543884079
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.917657748317904
DONE TAKING  40  STEPS.
Total reward:  -813.0110992557485
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.82416141091205
DONE TAKING  40  STEPS.
Total reward:  -593.5558000895684
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.49308111705125
DONE TAKING  40  STEPS.
Total reward:  -742.0621496264124
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.582532134262397
DONE TAKING  40  STEPS.
Total reward:  -798.4746046723485
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.06067003406422
DONE TAKING  40  STEPS.
Total reward:  -937.3220967896859
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -16.16169502981494
DONE TAKING  40  STEPS.
Total reward:  -512.5335136973212
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.638181403425403
DONE TAKING  40  STEPS.
Total reward:  -785.4161032184298
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter19.ckpt
Iter: 20
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  20
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  11700
On pol:  14400
Prob shape:  (26100,)

=== Epoch 0 ===
    train loss:  0.4867686367034912
    val rand:  0.4014299511909485
    val onPol:  0.29718324542045593

=== Epoch 10 ===
    train loss:  0.18644485503435135
    val rand:  0.2002844512462616
    val onPol:  0.25398172934850055

=== Epoch 20 ===
    train loss:  0.13956519067287446
    val rand:  0.17015329003334045
    val onPol:  0.2527685612440109

=== Epoch 30 ===
    train loss:  0.11774500817060471
    val rand:  0.1610431969165802
    val onPol:  0.2576032876968384

=== Epoch 39 ===
    train loss:  0.10274852752685547
    val rand:  0.15807056427001953
    val onPol:  0.2614097197850545
Training duration: 13.01 s

#####################################
performing on-policy MPC rollouts... iter  20
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -13.881126123139698
DONE TAKING  40  STEPS.
Total reward:  -334.5058771665636
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -31.110745050499972
DONE TAKING  40  STEPS.
Total reward:  -735.4877330096183
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.13446834655843
DONE TAKING  40  STEPS.
Total reward:  -818.5694856879411
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.779012357028158
DONE TAKING  40  STEPS.
Total reward:  -202.0337331519821
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.669192043467994
DONE TAKING  40  STEPS.
Total reward:  -913.5319569486209
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.824819225439043
DONE TAKING  40  STEPS.
Total reward:  -657.295853836137
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.2390182498608
DONE TAKING  40  STEPS.
Total reward:  -661.7620062012427
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.85757515151668
DONE TAKING  40  STEPS.
Total reward:  -378.07019794147726
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.918249197078033
DONE TAKING  40  STEPS.
Total reward:  -747.9371046289605
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.137256105030374
DONE TAKING  40  STEPS.
Total reward:  -478.02321535523816
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.082421627620874
DONE TAKING  40  STEPS.
Total reward:  -519.7978610007184
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.975123719381124
DONE TAKING  40  STEPS.
Total reward:  -926.4389310331118
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.929280672483735
DONE TAKING  40  STEPS.
Total reward:  -994.6936972891372
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.55886347932249
DONE TAKING  40  STEPS.
Total reward:  -732.4631025489265
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -29.495707243943134
DONE TAKING  40  STEPS.
Total reward:  -736.2039723312696
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.104634342431716
DONE TAKING  40  STEPS.
Total reward:  -905.6884013143335
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.089313614626864
DONE TAKING  40  STEPS.
Total reward:  -443.10610228475446
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -31.365111817583646
DONE TAKING  40  STEPS.
Total reward:  -782.6268691111726
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.15845001608045
DONE TAKING  40  STEPS.
Total reward:  -563.7795762747809
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.663758870978306
DONE TAKING  40  STEPS.
Total reward:  -360.16760930082376
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -26.440052696774707
DONE TAKING  40  STEPS.
Total reward:  -556.6772124823937
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.20313003353405
DONE TAKING  40  STEPS.
Total reward:  -543.7635425776068
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.29217422128206
DONE TAKING  40  STEPS.
Total reward:  -743.122372691238
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.492149044765732
DONE TAKING  40  STEPS.
Total reward:  -388.84190425485605
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.588659088903274
DONE TAKING  40  STEPS.
Total reward:  -798.6162387952866
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.33000424888002
DONE TAKING  40  STEPS.
Total reward:  -698.2859610312045
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.643802168090865
DONE TAKING  40  STEPS.
Total reward:  -345.3577677913403
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.97695247785214
DONE TAKING  40  STEPS.
Total reward:  -552.2267789471362
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.777296255654946
DONE TAKING  40  STEPS.
Total reward:  -116.222001391836
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -17.28343838241642
DONE TAKING  40  STEPS.
Total reward:  -293.85737462398487
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.168409326726
DONE TAKING  40  STEPS.
Total reward:  -799.4881184662761
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.858673517333784
DONE TAKING  40  STEPS.
Total reward:  -933.4836667238175
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.01680441636276
DONE TAKING  40  STEPS.
Total reward:  -399.25884246775735
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.85919034142223
DONE TAKING  40  STEPS.
Total reward:  -901.4355408198627
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -26.158555659516793
DONE TAKING  40  STEPS.
Total reward:  -606.378104271664
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.31041149082436
DONE TAKING  40  STEPS.
Total reward:  -754.387025793846
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.659405352021583
DONE TAKING  40  STEPS.
Total reward:  -809.1753669972558
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.732034255627276
DONE TAKING  40  STEPS.
Total reward:  -662.2652777634279
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.435460086851332
DONE TAKING  40  STEPS.
Total reward:  -652.2551925668911
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.33669600258537
DONE TAKING  40  STEPS.
Total reward:  -789.0768402302382
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter20.ckpt
Iter: 21
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  21
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  11895
On pol:  14400
Prob shape:  (26295,)

=== Epoch 0 ===
    train loss:  0.4855198965353124
    val rand:  0.40448281168937683
    val onPol:  0.3042592803637187

=== Epoch 10 ===
    train loss:  0.189274972560359
    val rand:  0.1966819018125534
    val onPol:  0.2605031728744507

=== Epoch 20 ===
    train loss:  0.14272851190146277
    val rand:  0.16621756553649902
    val onPol:  0.2579408288002014

=== Epoch 30 ===
    train loss:  0.11707955467350342
    val rand:  0.1625988483428955
    val onPol:  0.2630453109741211

=== Epoch 39 ===
    train loss:  0.10122452106545954
    val rand:  0.1539447158575058
    val onPol:  0.26886577407519024
Training duration: 12.69 s

#####################################
performing on-policy MPC rollouts... iter  21
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.529720711167066
DONE TAKING  40  STEPS.
Total reward:  -972.1034329291297
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.530109841990058
DONE TAKING  40  STEPS.
Total reward:  -745.8911489275149
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.582002842470356
DONE TAKING  40  STEPS.
Total reward:  -401.17677680332804
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.00982009695936
DONE TAKING  40  STEPS.
Total reward:  -316.2277508601254
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.831747059440158
DONE TAKING  40  STEPS.
Total reward:  -899.3598024627514
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.24801017469469
DONE TAKING  40  STEPS.
Total reward:  -453.41682651654475
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.415291385149054
DONE TAKING  40  STEPS.
Total reward:  -741.9447158587384
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -20.941990853986148
DONE TAKING  40  STEPS.
Total reward:  -655.5264809368325
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.650832147320543
DONE TAKING  40  STEPS.
Total reward:  -746.0511567080655
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.559051630138576
DONE TAKING  40  STEPS.
Total reward:  -709.0384867112049
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.2128916174652
DONE TAKING  40  STEPS.
Total reward:  -269.96189841770655
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.060255886298968
DONE TAKING  40  STEPS.
Total reward:  -807.5386142237174
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.945333017479776
DONE TAKING  40  STEPS.
Total reward:  -1215.2270225403086
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.02329063004213
DONE TAKING  40  STEPS.
Total reward:  -864.4921037859756
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.436940476891138
DONE TAKING  40  STEPS.
Total reward:  -501.78262449110684
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.906178148183656
DONE TAKING  40  STEPS.
Total reward:  -359.45916398163104
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.262977690384133
DONE TAKING  40  STEPS.
Total reward:  -1011.0961143460191
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.268160047136604
DONE TAKING  40  STEPS.
Total reward:  -722.921332274673
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.617996107415124
DONE TAKING  40  STEPS.
Total reward:  -626.3073393128569
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.625302856043085
DONE TAKING  40  STEPS.
Total reward:  -620.9449111521242
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.847097734979734
DONE TAKING  40  STEPS.
Total reward:  -641.1998118648738
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.940805261949492
DONE TAKING  40  STEPS.
Total reward:  -369.2510677220942
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.044480744283003
DONE TAKING  40  STEPS.
Total reward:  -560.1953494862898
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.693956559815007
DONE TAKING  40  STEPS.
Total reward:  -912.2419200251928
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.34471708303994
DONE TAKING  40  STEPS.
Total reward:  -454.44325512846194
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.684480109546293
DONE TAKING  40  STEPS.
Total reward:  -1117.1349455765055
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.93082596531096
DONE TAKING  40  STEPS.
Total reward:  -628.0712329557368
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.326889506592245
DONE TAKING  40  STEPS.
Total reward:  -616.6737488015292
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.070567404288347
DONE TAKING  40  STEPS.
Total reward:  -706.0207866952794
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -11.768023729782996
DONE TAKING  40  STEPS.
Total reward:  -342.78024490126467
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -11.450734726993343
DONE TAKING  40  STEPS.
Total reward:  -305.29448463807125
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.649610616599915
DONE TAKING  40  STEPS.
Total reward:  -919.1449530957544
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -31.328403747804803
DONE TAKING  40  STEPS.
Total reward:  -865.8676651031788
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.236439197121737
DONE TAKING  40  STEPS.
Total reward:  -855.5051127914771
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.087103114600822
DONE TAKING  40  STEPS.
Total reward:  -567.9504937150176
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -28.107327953784775
DONE TAKING  40  STEPS.
Total reward:  -620.7459082779322
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.65306343793784
DONE TAKING  40  STEPS.
Total reward:  -302.6562796342933
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.704336000846155
DONE TAKING  40  STEPS.
Total reward:  -818.1053512281374
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.336493842724714
DONE TAKING  40  STEPS.
Total reward:  -680.6618455997411
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.463798357472385
DONE TAKING  40  STEPS.
Total reward:  -607.9978880347455
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter21.ckpt
Iter: 22
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  22
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  12090
On pol:  14400
Prob shape:  (26490,)

=== Epoch 0 ===
    train loss:  0.48168984055519104
    val rand:  0.3879231810569763
    val onPol:  0.29631344477335614

=== Epoch 10 ===
    train loss:  0.18640067881228878
    val rand:  0.18689954280853271
    val onPol:  0.25332005818684894

=== Epoch 20 ===
    train loss:  0.1408143768123552
    val rand:  0.16533198952674866
    val onPol:  0.25012320776780445

=== Epoch 30 ===
    train loss:  0.1164108612665943
    val rand:  0.15873929858207703
    val onPol:  0.25641386210918427

=== Epoch 39 ===
    train loss:  0.10151175161202748
    val rand:  0.154144749045372
    val onPol:  0.2631895939509074
Training duration: 13.34 s

#####################################
performing on-policy MPC rollouts... iter  22
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.42324498923001
DONE TAKING  40  STEPS.
Total reward:  -984.1604553144093
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.21532715481685
DONE TAKING  40  STEPS.
Total reward:  -1001.1938237202701
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -19.760882505487565
DONE TAKING  40  STEPS.
Total reward:  117.48700971858705
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -26.347474011633018
DONE TAKING  40  STEPS.
Total reward:  -1016.1817930127592
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.733518633987238
DONE TAKING  40  STEPS.
Total reward:  -536.2845430904406
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.62892855089787
DONE TAKING  40  STEPS.
Total reward:  -733.1624422776736
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.050344418409374
DONE TAKING  40  STEPS.
Total reward:  -660.957333706708
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.203293219392858
DONE TAKING  40  STEPS.
Total reward:  -590.8041754785608
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.43304228217889
DONE TAKING  40  STEPS.
Total reward:  -460.6984211074387
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -14.807948408739765
DONE TAKING  40  STEPS.
Total reward:  -466.223439328935
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.70705531710275
DONE TAKING  40  STEPS.
Total reward:  -676.962025845552
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.9126669991524
DONE TAKING  40  STEPS.
Total reward:  -780.1485243387492
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -20.326932547667734
DONE TAKING  40  STEPS.
Total reward:  -676.3800440470651
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.494403003141844
DONE TAKING  40  STEPS.
Total reward:  -579.1383641606783
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -31.009640706733453
DONE TAKING  40  STEPS.
Total reward:  -663.553288275448
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.020001832708516
DONE TAKING  40  STEPS.
Total reward:  -1019.6659898195737
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -16.262015281972154
DONE TAKING  40  STEPS.
Total reward:  -433.3395060569412
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.9145507138166
DONE TAKING  40  STEPS.
Total reward:  -661.3686592778229
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.220723704232597
DONE TAKING  40  STEPS.
Total reward:  -540.9439747384005
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.131323382334166
DONE TAKING  40  STEPS.
Total reward:  -549.6497421009035
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.401667322908967
DONE TAKING  40  STEPS.
Total reward:  -568.9404331216074
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -12.681531806398464
DONE TAKING  40  STEPS.
Total reward:  -335.0774444507702
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.612254207545735
DONE TAKING  40  STEPS.
Total reward:  -734.8823722908434
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -15.899449466727091
DONE TAKING  40  STEPS.
Total reward:  -546.350347009684
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.83353175399796
DONE TAKING  40  STEPS.
Total reward:  -587.3330915251145
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.931614457253545
DONE TAKING  40  STEPS.
Total reward:  -695.0311524581155
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -18.22599819622445
DONE TAKING  40  STEPS.
Total reward:  -436.3478319157776
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.286542766291213
DONE TAKING  40  STEPS.
Total reward:  -879.9120342930362
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.405762044822627
DONE TAKING  40  STEPS.
Total reward:  -463.85887193015276
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.26967077490053
DONE TAKING  40  STEPS.
Total reward:  -514.8581558606734
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.063481316555563
DONE TAKING  40  STEPS.
Total reward:  -430.39157739999814
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.602279919997738
DONE TAKING  40  STEPS.
Total reward:  -867.7882788317253
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.83940423599867
DONE TAKING  40  STEPS.
Total reward:  -406.6714241544314
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.375558134768287
DONE TAKING  40  STEPS.
Total reward:  -632.0334339846386
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.52477677071043
DONE TAKING  40  STEPS.
Total reward:  -555.7828754164302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -31.403749285864254
DONE TAKING  40  STEPS.
Total reward:  -881.2373265120843
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.855467790943095
DONE TAKING  40  STEPS.
Total reward:  -155.2787888811672
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.30065977833835
DONE TAKING  40  STEPS.
Total reward:  -562.5190850741911
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.141946142532646
DONE TAKING  40  STEPS.
Total reward:  -394.92464084800133
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.714424630325492
DONE TAKING  40  STEPS.
Total reward:  -894.8144240415916
Time for 1 rollout: 1.32 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter22.ckpt
Iter: 23
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  23
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  12285
On pol:  14400
Prob shape:  (26685,)

=== Epoch 0 ===
    train loss:  0.4901026372726147
    val rand:  0.39560872316360474
    val onPol:  0.3096656600634257

=== Epoch 10 ===
    train loss:  0.18737650462068045
    val rand:  0.19990843534469604
    val onPol:  0.26382185022036236

=== Epoch 20 ===
    train loss:  0.1425054523234184
    val rand:  0.16954968869686127
    val onPol:  0.26333746314048767

=== Epoch 30 ===
    train loss:  0.11601700476155831
    val rand:  0.1610381007194519
    val onPol:  0.2634487946828206

=== Epoch 39 ===
    train loss:  0.10172516408448036
    val rand:  0.16142544150352478
    val onPol:  0.2743228922287623
Training duration: 12.94 s

#####################################
performing on-policy MPC rollouts... iter  23
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.42250758529374
DONE TAKING  40  STEPS.
Total reward:  -518.8235104929317
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.067014872090162
DONE TAKING  40  STEPS.
Total reward:  -1039.4759818484129
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -31.053552505122745
DONE TAKING  40  STEPS.
Total reward:  -1055.845508197788
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.635090343409026
DONE TAKING  40  STEPS.
Total reward:  -486.1822456541791
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.347042936978
DONE TAKING  40  STEPS.
Total reward:  -684.1372928788145
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -31.22771841547301
DONE TAKING  40  STEPS.
Total reward:  -835.5366943483718
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.852541349529623
DONE TAKING  40  STEPS.
Total reward:  -749.8908115621431
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.857084293017937
DONE TAKING  40  STEPS.
Total reward:  -609.3791869974964
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.67362776406161
DONE TAKING  40  STEPS.
Total reward:  -633.4736443191732
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.79282965423407
DONE TAKING  40  STEPS.
Total reward:  -1041.749931802025
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.972613144233506
DONE TAKING  40  STEPS.
Total reward:  -841.7332743222308
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.108407385731116
DONE TAKING  40  STEPS.
Total reward:  -716.4729999100214
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.435896284612486
DONE TAKING  40  STEPS.
Total reward:  -501.97678069918743
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.14209777297409
DONE TAKING  40  STEPS.
Total reward:  -642.6946985818623
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.76569845905857
DONE TAKING  40  STEPS.
Total reward:  -920.6963001443681
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.80755847431849
DONE TAKING  40  STEPS.
Total reward:  -763.8272675941691
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.247546470541266
DONE TAKING  40  STEPS.
Total reward:  -599.164400476787
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.729696056117646
DONE TAKING  40  STEPS.
Total reward:  -1066.3139571906147
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.01983725408877
DONE TAKING  40  STEPS.
Total reward:  -731.939214872055
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.03703563444413
DONE TAKING  40  STEPS.
Total reward:  -820.8324790972467
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.747031610194814
DONE TAKING  40  STEPS.
Total reward:  -535.8303822018823
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.520623704159064
DONE TAKING  40  STEPS.
Total reward:  -517.9114757553245
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -15.71705209674089
DONE TAKING  40  STEPS.
Total reward:  -464.60345047086287
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.552296827955008
DONE TAKING  40  STEPS.
Total reward:  -833.3655592573331
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.0792163204809
DONE TAKING  40  STEPS.
Total reward:  -358.82322236236536
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.887005467223496
DONE TAKING  40  STEPS.
Total reward:  -570.5679773136675
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -24.63239400607506
DONE TAKING  40  STEPS.
Total reward:  -691.3593422777451
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.95396752978195
DONE TAKING  40  STEPS.
Total reward:  -508.0370343941497
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.27707431192956
DONE TAKING  40  STEPS.
Total reward:  -1030.3046683962193
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.221928386844198
DONE TAKING  40  STEPS.
Total reward:  -645.2188691204466
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.854782947581064
DONE TAKING  40  STEPS.
Total reward:  -638.9135054301552
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.182868081998418
DONE TAKING  40  STEPS.
Total reward:  -564.3365100087884
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.27109839420426
DONE TAKING  40  STEPS.
Total reward:  -779.2521170601581
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.0281478491743
DONE TAKING  40  STEPS.
Total reward:  -696.3657442947598
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.76835126559023
DONE TAKING  40  STEPS.
Total reward:  -408.2771543258048
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.750351818488475
DONE TAKING  40  STEPS.
Total reward:  -1032.7744221403652
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.105862988553618
DONE TAKING  40  STEPS.
Total reward:  -831.58793724736
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.871756006856995
DONE TAKING  40  STEPS.
Total reward:  -565.7134249578784
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -25.617658972728403
DONE TAKING  40  STEPS.
Total reward:  -778.5667547458764
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.99137282460244
DONE TAKING  40  STEPS.
Total reward:  -513.575682893638
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter23.ckpt
Iter: 24
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  24
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  12480
On pol:  14400
Prob shape:  (26880,)

=== Epoch 0 ===
    train loss:  0.47833961019149196
    val rand:  0.3821139335632324
    val onPol:  0.2982618014017741

=== Epoch 10 ===
    train loss:  0.18600866198539734
    val rand:  0.1958054006099701
    val onPol:  0.25361526509126026

=== Epoch 20 ===
    train loss:  0.14207204087422445
    val rand:  0.1658736616373062
    val onPol:  0.251993993918101

=== Epoch 30 ===
    train loss:  0.11644968304496545
    val rand:  0.16228151321411133
    val onPol:  0.2562564015388489

=== Epoch 39 ===
    train loss:  0.1010977250452225
    val rand:  0.16055209934711456
    val onPol:  0.2614991714557012
Training duration: 13.60 s

#####################################
performing on-policy MPC rollouts... iter  24
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -13.063647624288294
DONE TAKING  40  STEPS.
Total reward:  -420.7563749562661
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -14.051742289640565
DONE TAKING  40  STEPS.
Total reward:  -339.2208261234952
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -20.68566618163222
DONE TAKING  40  STEPS.
Total reward:  -382.8842671280296
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.534656227363726
DONE TAKING  40  STEPS.
Total reward:  -839.594239282507
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.62506865006357
DONE TAKING  40  STEPS.
Total reward:  -433.11496304816217
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.280193010238484
DONE TAKING  40  STEPS.
Total reward:  -697.1637849027979
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.045753292645326
DONE TAKING  40  STEPS.
Total reward:  -779.2364129312649
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -14.476615458862403
DONE TAKING  40  STEPS.
Total reward:  -562.4756379149177
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.33291145321006
DONE TAKING  40  STEPS.
Total reward:  -656.4406771776848
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.155765508090475
DONE TAKING  40  STEPS.
Total reward:  -707.1013343795568
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.455545042602
DONE TAKING  40  STEPS.
Total reward:  -325.30569847510264
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.909749531645396
DONE TAKING  40  STEPS.
Total reward:  -462.47086933281247
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.30894635441707
DONE TAKING  40  STEPS.
Total reward:  -577.4546428286144
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -21.217776605809124
DONE TAKING  40  STEPS.
Total reward:  -413.48075286928633
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.215599237463785
DONE TAKING  40  STEPS.
Total reward:  -724.8528285991226
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.606760249771373
DONE TAKING  40  STEPS.
Total reward:  -572.6528756394453
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -20.390093236315174
DONE TAKING  40  STEPS.
Total reward:  -497.177402071311
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.56047242231335
DONE TAKING  40  STEPS.
Total reward:  -532.0296097902508
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.400679861187292
DONE TAKING  40  STEPS.
Total reward:  -336.1528882879907
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.00744317711736
DONE TAKING  40  STEPS.
Total reward:  -873.4287683461098
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.910660943398387
DONE TAKING  40  STEPS.
Total reward:  -1097.9648911039753
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.779690789585064
DONE TAKING  40  STEPS.
Total reward:  -884.8100149702872
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.14052983390662
DONE TAKING  40  STEPS.
Total reward:  -1031.043696985159
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.814732956923166
DONE TAKING  40  STEPS.
Total reward:  -454.1095620340572
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.756359674877054
DONE TAKING  40  STEPS.
Total reward:  -740.7523831117805
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.48047904476038
DONE TAKING  40  STEPS.
Total reward:  -856.2890699037501
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -22.671310429784633
DONE TAKING  40  STEPS.
Total reward:  -693.5747741423125
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.339854286017587
DONE TAKING  40  STEPS.
Total reward:  -827.2039936056074
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.787604507299996
DONE TAKING  40  STEPS.
Total reward:  -688.9656092688215
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.165091029138328
DONE TAKING  40  STEPS.
Total reward:  -810.9144984342112
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.299149676705554
DONE TAKING  40  STEPS.
Total reward:  -825.5824939252102
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.108164793683827
DONE TAKING  40  STEPS.
Total reward:  -912.2614977602641
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.512393051862695
DONE TAKING  40  STEPS.
Total reward:  -321.56895494744754
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.49554112293154
DONE TAKING  40  STEPS.
Total reward:  -750.7533266668592
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.646889771662984
DONE TAKING  40  STEPS.
Total reward:  -491.7996553667869
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.988512334513896
DONE TAKING  40  STEPS.
Total reward:  -997.1457810697591
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -17.77776029632316
DONE TAKING  40  STEPS.
Total reward:  -691.5619709548826
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.62769836278039
DONE TAKING  40  STEPS.
Total reward:  -272.1873663395584
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -17.43787199166272
DONE TAKING  40  STEPS.
Total reward:  -649.698561861795
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -31.00891832261949
DONE TAKING  40  STEPS.
Total reward:  -759.179760982659
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter24.ckpt
Iter: 25
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  25
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  12675
On pol:  14400
Prob shape:  (27075,)

=== Epoch 0 ===
    train loss:  0.47692955801120174
    val rand:  0.38749200105667114
    val onPol:  0.2966734667619069

=== Epoch 10 ===
    train loss:  0.18548834008666185
    val rand:  0.19457873702049255
    val onPol:  0.2495784064133962

=== Epoch 20 ===
    train loss:  0.14173857982342059
    val rand:  0.17153601348400116
    val onPol:  0.2504855195681254

=== Epoch 30 ===
    train loss:  0.11735989153385162
    val rand:  0.15945610404014587
    val onPol:  0.2543550382057826

=== Epoch 39 ===
    train loss:  0.1008128201445708
    val rand:  0.1568882167339325
    val onPol:  0.26131875316301983
Training duration: 13.22 s

#####################################
performing on-policy MPC rollouts... iter  25
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.23041116293701
DONE TAKING  40  STEPS.
Total reward:  -578.3623397343878
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -13.945653440993715
DONE TAKING  40  STEPS.
Total reward:  -500.35124342834075
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -13.848026872898034
DONE TAKING  40  STEPS.
Total reward:  -412.2236640765216
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.00996455047332
DONE TAKING  40  STEPS.
Total reward:  -522.4906720232042
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.97722429712478
DONE TAKING  40  STEPS.
Total reward:  -873.8313581411015
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.236849626415033
DONE TAKING  40  STEPS.
Total reward:  -563.8923859183983
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -14.53063886631056
DONE TAKING  40  STEPS.
Total reward:  -516.6256590853786
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -14.129309471919651
DONE TAKING  40  STEPS.
Total reward:  -458.282131303582
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -11.075893377784887
DONE TAKING  40  STEPS.
Total reward:  -359.5335804888544
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -16.42241607124707
DONE TAKING  40  STEPS.
Total reward:  -301.1961546748469
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.534003062613616
DONE TAKING  40  STEPS.
Total reward:  -283.41719847721964
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.718789171956015
DONE TAKING  40  STEPS.
Total reward:  -743.8376478420012
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -16.972324270387514
DONE TAKING  40  STEPS.
Total reward:  -632.5536673793572
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.793444621297883
DONE TAKING  40  STEPS.
Total reward:  -575.0191045648442
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -10.170037628295837
DONE TAKING  40  STEPS.
Total reward:  -220.9577183645466
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.780599208425492
DONE TAKING  40  STEPS.
Total reward:  -1058.7978665801004
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.5176861004948
DONE TAKING  40  STEPS.
Total reward:  -873.2589584993161
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.195858387665247
DONE TAKING  40  STEPS.
Total reward:  -476.3641008254198
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.84423149181193
DONE TAKING  40  STEPS.
Total reward:  -627.9208545967148
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.110321535270664
DONE TAKING  40  STEPS.
Total reward:  -695.8889603859458
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.941070779773728
DONE TAKING  40  STEPS.
Total reward:  -916.9730966795686
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.00651313490658
DONE TAKING  40  STEPS.
Total reward:  -725.1272940271131
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -16.33956480413004
DONE TAKING  40  STEPS.
Total reward:  -525.485968710852
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.850042473383208
DONE TAKING  40  STEPS.
Total reward:  -468.8734439289675
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -11.107433179463957
DONE TAKING  40  STEPS.
Total reward:  -293.50317279932153
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.816119575039696
DONE TAKING  40  STEPS.
Total reward:  -893.3117743078783
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.694856337835894
DONE TAKING  40  STEPS.
Total reward:  -650.4507502056441
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.789163928159233
DONE TAKING  40  STEPS.
Total reward:  -774.3429929834728
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.32669385989956
DONE TAKING  40  STEPS.
Total reward:  -524.2584075263708
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.402791182921455
DONE TAKING  40  STEPS.
Total reward:  -697.885450184121
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.26781468265343
DONE TAKING  40  STEPS.
Total reward:  -759.1463868428559
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.950975746928812
DONE TAKING  40  STEPS.
Total reward:  -955.2194520713321
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.9649949020921
DONE TAKING  40  STEPS.
Total reward:  -659.348022004822
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.364440831495887
DONE TAKING  40  STEPS.
Total reward:  -601.9673676670174
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.01777755919652
DONE TAKING  40  STEPS.
Total reward:  -506.07598365697726
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.271521015563938
DONE TAKING  40  STEPS.
Total reward:  -322.43009065161874
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.476064559030927
DONE TAKING  40  STEPS.
Total reward:  -790.4141849206354
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -15.632330034335435
DONE TAKING  40  STEPS.
Total reward:  -521.1011252562515
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.920504994045736
DONE TAKING  40  STEPS.
Total reward:  -846.5393591386157
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.707726118042462
DONE TAKING  40  STEPS.
Total reward:  -504.39701397490285
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter25.ckpt
Iter: 26
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  26
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  12870
On pol:  14400
Prob shape:  (27270,)

=== Epoch 0 ===
    train loss:  0.4800765666196931
    val rand:  0.39494895935058594
    val onPol:  0.2944349596897761

=== Epoch 10 ===
    train loss:  0.1863311486986448
    val rand:  0.19662819802761078
    val onPol:  0.24714873234430948

=== Epoch 20 ===
    train loss:  0.13924088005749685
    val rand:  0.1695529818534851
    val onPol:  0.24801438053448996

=== Epoch 30 ===
    train loss:  0.11669977543488988
    val rand:  0.16165685653686523
    val onPol:  0.252200980981191

=== Epoch 39 ===
    train loss:  0.10200307911859369
    val rand:  0.1630818247795105
    val onPol:  0.25594785312811535
Training duration: 13.76 s

#####################################
performing on-policy MPC rollouts... iter  26
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.649447285486087
DONE TAKING  40  STEPS.
Total reward:  -577.2304399863855
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.458248840968263
DONE TAKING  40  STEPS.
Total reward:  -604.0745293065047
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -14.462650818296394
DONE TAKING  40  STEPS.
Total reward:  -486.2294878777657
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.590793322507853
DONE TAKING  40  STEPS.
Total reward:  -791.1681092184738
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.323059431643316
DONE TAKING  40  STEPS.
Total reward:  -410.7100861009985
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.38791018227164
DONE TAKING  40  STEPS.
Total reward:  -545.9061721335293
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -13.714603493245772
DONE TAKING  40  STEPS.
Total reward:  -366.0152766295096
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.1168518287781
DONE TAKING  40  STEPS.
Total reward:  -648.3990657386424
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.615204129707895
DONE TAKING  40  STEPS.
Total reward:  -1019.7340322710431
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.57025471472226
DONE TAKING  40  STEPS.
Total reward:  -314.48727218936017
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.58794310818972
DONE TAKING  40  STEPS.
Total reward:  -1050.8487291347515
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.18857613488288
DONE TAKING  40  STEPS.
Total reward:  -475.5141549040698
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -9.853932059718083
DONE TAKING  40  STEPS.
Total reward:  -289.51613730858094
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.760667606461134
DONE TAKING  40  STEPS.
Total reward:  -705.0652781009115
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.52892100070467
DONE TAKING  40  STEPS.
Total reward:  -979.7951541205464
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.666112825918844
DONE TAKING  40  STEPS.
Total reward:  -664.1818079778004
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -16.484625969213212
DONE TAKING  40  STEPS.
Total reward:  -566.3818646394466
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.992158887654206
DONE TAKING  40  STEPS.
Total reward:  -444.5155874984622
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.35373277591614
DONE TAKING  40  STEPS.
Total reward:  -423.5048972252034
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.597742487268448
DONE TAKING  40  STEPS.
Total reward:  -394.2933453632155
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.638348627702715
DONE TAKING  40  STEPS.
Total reward:  -503.20128971652275
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.129449233320514
DONE TAKING  40  STEPS.
Total reward:  -439.41866664799306
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.28877667240126
DONE TAKING  40  STEPS.
Total reward:  -648.2022760782963
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.258988061453351
DONE TAKING  40  STEPS.
Total reward:  -353.09150724227015
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.681541986197562
DONE TAKING  40  STEPS.
Total reward:  -273.6309595110336
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.989766303780957
DONE TAKING  40  STEPS.
Total reward:  -573.1238731262478
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.26319397176177
DONE TAKING  40  STEPS.
Total reward:  -736.2862590478326
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -17.008382153167375
DONE TAKING  40  STEPS.
Total reward:  -356.9378688049229
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.095580596649206
DONE TAKING  40  STEPS.
Total reward:  -733.2498818555034
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.690011229293418
DONE TAKING  40  STEPS.
Total reward:  -642.8358100949564
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.60067363480169
DONE TAKING  40  STEPS.
Total reward:  -771.564200571002
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.60119334114054
DONE TAKING  40  STEPS.
Total reward:  -477.54785107520763
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.93319995736057
DONE TAKING  40  STEPS.
Total reward:  -477.46072621137546
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.006325616986196
DONE TAKING  40  STEPS.
Total reward:  -670.3261652415714
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.35575290154802
DONE TAKING  40  STEPS.
Total reward:  -853.1382384734517
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.33857075244075
DONE TAKING  40  STEPS.
Total reward:  -708.8859870998195
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.736361707545534
DONE TAKING  40  STEPS.
Total reward:  -393.6662054786243
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.13663691919892
DONE TAKING  40  STEPS.
Total reward:  -761.5644979150105
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.77995663470847
DONE TAKING  40  STEPS.
Total reward:  -385.47039117168424
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.13410159069829
DONE TAKING  40  STEPS.
Total reward:  -758.560861749898
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter26.ckpt
Iter: 27
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  27
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  13065
On pol:  14400
Prob shape:  (27465,)

=== Epoch 0 ===
    train loss:  0.48393599323506625
    val rand:  0.39508265256881714
    val onPol:  0.2851249873638153

=== Epoch 10 ===
    train loss:  0.1868774989303553
    val rand:  0.20178765058517456
    val onPol:  0.23937982817490897

=== Epoch 20 ===
    train loss:  0.14224862518175593
    val rand:  0.16547536849975586
    val onPol:  0.23745725552241007

=== Epoch 30 ===
    train loss:  0.11804628864211857
    val rand:  0.1603863537311554
    val onPol:  0.24234998226165771

=== Epoch 39 ===
    train loss:  0.10327820001908068
    val rand:  0.15857373178005219
    val onPol:  0.2468002736568451
Training duration: 13.74 s

#####################################
performing on-policy MPC rollouts... iter  27
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.04195230420922
DONE TAKING  40  STEPS.
Total reward:  -303.649227207233
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.927780440994628
DONE TAKING  40  STEPS.
Total reward:  -1159.1280477556202
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.096019136738253
DONE TAKING  40  STEPS.
Total reward:  -433.72662760555096
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.662921326670265
DONE TAKING  40  STEPS.
Total reward:  -718.2792027586075
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.76597867452206
DONE TAKING  40  STEPS.
Total reward:  -782.8711613594974
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.731106608331512
DONE TAKING  40  STEPS.
Total reward:  -814.9597889357779
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.34879025213062
DONE TAKING  40  STEPS.
Total reward:  -454.662418412519
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.349581913849285
DONE TAKING  40  STEPS.
Total reward:  -587.3869798718446
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.855717174974878
DONE TAKING  40  STEPS.
Total reward:  -463.70171854234826
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.450931770853053
DONE TAKING  40  STEPS.
Total reward:  -430.2242212427842
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -17.156201186595347
DONE TAKING  40  STEPS.
Total reward:  -461.1587925885965
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.294939206831597
DONE TAKING  40  STEPS.
Total reward:  -909.6158276551838
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.991884392721406
DONE TAKING  40  STEPS.
Total reward:  -937.1308990655566
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.60691891951776
DONE TAKING  40  STEPS.
Total reward:  -610.5452525702922
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.86984813429561
DONE TAKING  40  STEPS.
Total reward:  -843.7158381016675
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.849561566887914
DONE TAKING  40  STEPS.
Total reward:  -840.8835053843798
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.054506235249537
DONE TAKING  40  STEPS.
Total reward:  -820.4231357667595
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -11.273548607344201
DONE TAKING  40  STEPS.
Total reward:  -462.01471299312357
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.889304657510843
DONE TAKING  40  STEPS.
Total reward:  -299.74741157229914
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.95352967806866
DONE TAKING  40  STEPS.
Total reward:  -718.3276540814605
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.135662308068216
DONE TAKING  40  STEPS.
Total reward:  -552.0567464222725
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.37422542148258
DONE TAKING  40  STEPS.
Total reward:  -681.8816771015398
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.89231793323558
DONE TAKING  40  STEPS.
Total reward:  -679.814140664917
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.776704133476986
DONE TAKING  40  STEPS.
Total reward:  -542.9344635897634
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.934591865754477
DONE TAKING  40  STEPS.
Total reward:  -450.68545996042707
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.958191647802153
DONE TAKING  40  STEPS.
Total reward:  -529.1689777150428
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.569823228600338
DONE TAKING  40  STEPS.
Total reward:  -983.4259276462569
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.239501088824117
DONE TAKING  40  STEPS.
Total reward:  -754.273650043567
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.129189620964326
DONE TAKING  40  STEPS.
Total reward:  -654.9780549582872
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.076081173263844
DONE TAKING  40  STEPS.
Total reward:  -427.92629294973005
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.456813546233985
DONE TAKING  40  STEPS.
Total reward:  -435.8654574194853
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.77018222610286
DONE TAKING  40  STEPS.
Total reward:  -648.8966439134209
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -28.8047461261327
DONE TAKING  40  STEPS.
Total reward:  -750.1733941339143
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.366692606096297
DONE TAKING  40  STEPS.
Total reward:  -677.2334780225743
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -16.21397438468556
DONE TAKING  40  STEPS.
Total reward:  -614.1406373797146
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.194855057880673
DONE TAKING  40  STEPS.
Total reward:  -349.9660285043614
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.593217531789733
DONE TAKING  40  STEPS.
Total reward:  -454.6489963795559
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -13.654511086658193
DONE TAKING  40  STEPS.
Total reward:  -519.1706691095861
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.022733907014043
DONE TAKING  40  STEPS.
Total reward:  -543.1366355948658
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.97174780138
DONE TAKING  40  STEPS.
Total reward:  -546.3040219610479
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter27.ckpt
Iter: 28
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  28
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  13260
On pol:  14400
Prob shape:  (27660,)

=== Epoch 0 ===
    train loss:  0.4900892812896658
    val rand:  0.3983597755432129
    val onPol:  0.2859491805235545

=== Epoch 10 ===
    train loss:  0.1814565454368238
    val rand:  0.196024090051651
    val onPol:  0.2394969513018926

=== Epoch 20 ===
    train loss:  0.1381202725072702
    val rand:  0.16902737319469452
    val onPol:  0.23795704046885172

=== Epoch 30 ===
    train loss:  0.11472299198309581
    val rand:  0.15987077355384827
    val onPol:  0.24097424745559692

=== Epoch 39 ===
    train loss:  0.10053021088242531
    val rand:  0.1578965038061142
    val onPol:  0.24876401821772257
Training duration: 13.45 s

#####################################
performing on-policy MPC rollouts... iter  28
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.951537492081535
DONE TAKING  40  STEPS.
Total reward:  -588.8630376961124
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.713977750426942
DONE TAKING  40  STEPS.
Total reward:  -547.197086257612
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.16227209320742
DONE TAKING  40  STEPS.
Total reward:  -877.3574764438688
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -12.98038238628286
DONE TAKING  40  STEPS.
Total reward:  -278.9643435012785
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.41628519016918
DONE TAKING  40  STEPS.
Total reward:  -1082.446060342935
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.578591651649468
DONE TAKING  40  STEPS.
Total reward:  -878.5893910628437
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -13.356328807843054
DONE TAKING  40  STEPS.
Total reward:  -331.68146836860035
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.72041476308255
DONE TAKING  40  STEPS.
Total reward:  -541.553492915885
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.801774743884653
DONE TAKING  40  STEPS.
Total reward:  -800.6170634169218
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.097642780380358
DONE TAKING  40  STEPS.
Total reward:  -799.6827455258726
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -18.23748972250909
DONE TAKING  40  STEPS.
Total reward:  -725.9517858236062
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -10.754771421132807
DONE TAKING  40  STEPS.
Total reward:  -126.04090012423937
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.87602849341773
DONE TAKING  40  STEPS.
Total reward:  -513.2378835576857
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.17478056215281
DONE TAKING  40  STEPS.
Total reward:  -729.6675516013635
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.22323501840221
DONE TAKING  40  STEPS.
Total reward:  -790.4471339365259
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.39757264157147
DONE TAKING  40  STEPS.
Total reward:  -625.9846620432529
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.695577695489483
DONE TAKING  40  STEPS.
Total reward:  -763.386746438894
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -22.808900133339883
DONE TAKING  40  STEPS.
Total reward:  -736.567971778096
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -16.989647891054112
DONE TAKING  40  STEPS.
Total reward:  -511.18522598418895
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.659798868709455
DONE TAKING  40  STEPS.
Total reward:  -573.1120457293564
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.987994921431063
DONE TAKING  40  STEPS.
Total reward:  -594.2106817101903
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.30289271911307
DONE TAKING  40  STEPS.
Total reward:  -690.2375426684958
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.23692914723732
DONE TAKING  40  STEPS.
Total reward:  -761.067394788384
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.826567298380084
DONE TAKING  40  STEPS.
Total reward:  -538.7347045314159
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.069292196848675
DONE TAKING  40  STEPS.
Total reward:  -745.1145146288677
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.621653172190676
DONE TAKING  40  STEPS.
Total reward:  -754.9831748125048
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.309577166645475
DONE TAKING  40  STEPS.
Total reward:  -859.4611360783033
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -14.060399315233072
DONE TAKING  40  STEPS.
Total reward:  -465.15720972851955
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -18.789450469150804
DONE TAKING  40  STEPS.
Total reward:  -589.7306208207103
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.186627842863988
DONE TAKING  40  STEPS.
Total reward:  -564.8130243628361
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.657044527198856
DONE TAKING  40  STEPS.
Total reward:  -656.8852774005571
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.433667090654644
DONE TAKING  40  STEPS.
Total reward:  -696.4946282440051
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -28.669794825450108
DONE TAKING  40  STEPS.
Total reward:  -706.2614206870799
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.430085686243473
DONE TAKING  40  STEPS.
Total reward:  -749.7029290596976
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.73336020775922
DONE TAKING  40  STEPS.
Total reward:  -884.1039478586193
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.66610529025361
DONE TAKING  40  STEPS.
Total reward:  -626.4637342422338
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.245627595720972
DONE TAKING  40  STEPS.
Total reward:  -381.70866368570745
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -14.018581275204998
DONE TAKING  40  STEPS.
Total reward:  -446.2238133441776
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -17.447381266776706
DONE TAKING  40  STEPS.
Total reward:  -633.9740838903809
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.868199643959635
DONE TAKING  40  STEPS.
Total reward:  -621.7876145942159
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter28.ckpt
Iter: 29
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  29
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  13455
On pol:  14400
Prob shape:  (27855,)

=== Epoch 0 ===
    train loss:  0.4801996124011499
    val rand:  0.4016992449760437
    val onPol:  0.28587017953395844

=== Epoch 10 ===
    train loss:  0.18212481284583057
    val rand:  0.20087343454360962
    val onPol:  0.24003393451372781

=== Epoch 20 ===
    train loss:  0.14047663051773002
    val rand:  0.17657434940338135
    val onPol:  0.23957039415836334

=== Epoch 30 ===
    train loss:  0.11633542690564085
    val rand:  0.165706604719162
    val onPol:  0.24309893449147543

=== Epoch 39 ===
    train loss:  0.10120962905111136
    val rand:  0.16274181008338928
    val onPol:  0.2464446872472763
Training duration: 14.07 s

#####################################
performing on-policy MPC rollouts... iter  29
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.255934201936977
DONE TAKING  40  STEPS.
Total reward:  -761.2252715396518
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.210479037972817
DONE TAKING  40  STEPS.
Total reward:  -878.2482220946507
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.756106790286115
DONE TAKING  40  STEPS.
Total reward:  -484.04103291111915
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.080398103409266
DONE TAKING  40  STEPS.
Total reward:  -713.1875782271129
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.179694466828348
DONE TAKING  40  STEPS.
Total reward:  -903.5435649753549
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -18.327463715513353
DONE TAKING  40  STEPS.
Total reward:  -628.0350844614366
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.231268536922638
DONE TAKING  40  STEPS.
Total reward:  -914.2620862389387
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -14.101810152005761
DONE TAKING  40  STEPS.
Total reward:  -274.1303346664576
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.756939089562795
DONE TAKING  40  STEPS.
Total reward:  -413.7213731946064
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -29.093507672951947
DONE TAKING  40  STEPS.
Total reward:  -906.139214386858
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -17.417701644460838
DONE TAKING  40  STEPS.
Total reward:  -456.38187011909736
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.236303024489114
DONE TAKING  40  STEPS.
Total reward:  -913.1781406080279
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.274971154815447
DONE TAKING  40  STEPS.
Total reward:  -558.7529624855778
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.63231922546052
DONE TAKING  40  STEPS.
Total reward:  -355.25876845265486
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.540202464081911
DONE TAKING  40  STEPS.
Total reward:  -341.9174904908445
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -8.423443441319167
DONE TAKING  40  STEPS.
Total reward:  -309.4437230913587
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.86159707395503
DONE TAKING  40  STEPS.
Total reward:  -426.2688534601357
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.280405295893868
DONE TAKING  40  STEPS.
Total reward:  -371.8098031733672
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.463644344706992
DONE TAKING  40  STEPS.
Total reward:  -360.3892502293567
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.940082237761224
DONE TAKING  40  STEPS.
Total reward:  -519.8990728079186
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.63949926077028
DONE TAKING  40  STEPS.
Total reward:  -1048.6195699988284
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -14.958067704538575
DONE TAKING  40  STEPS.
Total reward:  -388.89086487864586
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.768222112152177
DONE TAKING  40  STEPS.
Total reward:  -450.79471696475457
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.314483209761704
DONE TAKING  40  STEPS.
Total reward:  -534.9402712529629
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.01737778259652
DONE TAKING  40  STEPS.
Total reward:  -595.8742756730624
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.485562981649615
DONE TAKING  40  STEPS.
Total reward:  -716.0873668302804
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.79534389638645
DONE TAKING  40  STEPS.
Total reward:  -704.0939819571133
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.648529231187867
DONE TAKING  40  STEPS.
Total reward:  -447.74949645873426
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -14.991592098372802
DONE TAKING  40  STEPS.
Total reward:  -639.604680262696
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.4947391394774
DONE TAKING  40  STEPS.
Total reward:  -913.3220826224875
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.894304213799135
DONE TAKING  40  STEPS.
Total reward:  -1074.4260519009026
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.402936517565013
DONE TAKING  40  STEPS.
Total reward:  -565.0828395923381
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -21.216718051320225
DONE TAKING  40  STEPS.
Total reward:  -691.5095859967515
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.124319463392574
DONE TAKING  40  STEPS.
Total reward:  -535.8043669939098
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.722533051084042
DONE TAKING  40  STEPS.
Total reward:  -469.6648281834721
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -8.776507009199774
DONE TAKING  40  STEPS.
Total reward:  -266.21729173289555
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.25583343742058
DONE TAKING  40  STEPS.
Total reward:  -489.5410750010511
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.43391562922283
DONE TAKING  40  STEPS.
Total reward:  -378.1223240776741
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -21.10493717938233
DONE TAKING  40  STEPS.
Total reward:  -387.2285087425863
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.26762312576617
DONE TAKING  40  STEPS.
Total reward:  -355.6992363447382
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter29.ckpt
Iter: 30
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  30
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  13650
On pol:  14400
Prob shape:  (28050,)

=== Epoch 0 ===
    train loss:  0.4771174407667584
    val rand:  0.3950233459472656
    val onPol:  0.2750515639781952

=== Epoch 10 ===
    train loss:  0.18535410502442606
    val rand:  0.20170633494853973
    val onPol:  0.2296186089515686

=== Epoch 20 ===
    train loss:  0.13898257718042092
    val rand:  0.16659118235111237
    val onPol:  0.22805309295654297

=== Epoch 30 ===
    train loss:  0.11523084990956166
    val rand:  0.16157276928424835
    val onPol:  0.23208035031954447

=== Epoch 39 ===
    train loss:  0.10068945835034053
    val rand:  0.1574869155883789
    val onPol:  0.23793727159500122
Training duration: 13.48 s

#####################################
performing on-policy MPC rollouts... iter  30
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -21.109098386307203
DONE TAKING  40  STEPS.
Total reward:  -444.48440743022616
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.507337618604975
DONE TAKING  40  STEPS.
Total reward:  -857.3613976970918
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -31.201680911642278
DONE TAKING  40  STEPS.
Total reward:  -782.3874226987487
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.95396399442508
DONE TAKING  40  STEPS.
Total reward:  -591.5835002883489
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.608919511989235
DONE TAKING  40  STEPS.
Total reward:  -395.2636654433801
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.833624097705993
DONE TAKING  40  STEPS.
Total reward:  -644.4822632036335
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.824828735661676
DONE TAKING  40  STEPS.
Total reward:  -941.8513192949819
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.739151411831454
DONE TAKING  40  STEPS.
Total reward:  -657.5150706286781
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.909678607862162
DONE TAKING  40  STEPS.
Total reward:  -891.66984540129
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -15.53244341319383
DONE TAKING  40  STEPS.
Total reward:  -252.5538778392128
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.75883525748934
DONE TAKING  40  STEPS.
Total reward:  -409.1150627853434
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.482667861892473
DONE TAKING  40  STEPS.
Total reward:  -818.4890870180305
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -30.313418311610747
DONE TAKING  40  STEPS.
Total reward:  -936.0977785032419
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.081688735434916
DONE TAKING  40  STEPS.
Total reward:  -469.8272696872993
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.5313705772825
DONE TAKING  40  STEPS.
Total reward:  -601.5528386015294
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -18.116717192967617
DONE TAKING  40  STEPS.
Total reward:  -619.7518558947564
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -15.729029821508167
DONE TAKING  40  STEPS.
Total reward:  -297.2270087674648
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.344303898117584
DONE TAKING  40  STEPS.
Total reward:  -497.1051940507604
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.76884505956569
DONE TAKING  40  STEPS.
Total reward:  -806.9868263123502
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.976955349598047
DONE TAKING  40  STEPS.
Total reward:  -743.0386617569216
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -31.18538257684112
DONE TAKING  40  STEPS.
Total reward:  -762.6468686128374
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.878196387346023
DONE TAKING  40  STEPS.
Total reward:  -769.798162821064
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.732352638396236
DONE TAKING  40  STEPS.
Total reward:  -867.2665692901301
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.950493942565398
DONE TAKING  40  STEPS.
Total reward:  -730.2030838635029
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -9.222128672013783
DONE TAKING  40  STEPS.
Total reward:  -317.7682540156103
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.798120445383645
DONE TAKING  40  STEPS.
Total reward:  -853.5815742757355
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -25.19604146075975
DONE TAKING  40  STEPS.
Total reward:  -620.0325939484535
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.00122575464381
DONE TAKING  40  STEPS.
Total reward:  -682.1260590484791
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.731097401254097
DONE TAKING  40  STEPS.
Total reward:  -680.6153537692308
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.26688568340563
DONE TAKING  40  STEPS.
Total reward:  -691.4158997255236
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.515191952088845
DONE TAKING  40  STEPS.
Total reward:  -741.1373722926654
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -9.356941255994531
DONE TAKING  40  STEPS.
Total reward:  -213.67229680461867
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.074635276329182
DONE TAKING  40  STEPS.
Total reward:  -659.7437943247564
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.581221858984208
DONE TAKING  40  STEPS.
Total reward:  -816.2301296746563
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.94904593954019
DONE TAKING  40  STEPS.
Total reward:  -764.713558184006
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.516558231070196
DONE TAKING  40  STEPS.
Total reward:  -790.7276241947401
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.904251546834857
DONE TAKING  40  STEPS.
Total reward:  -437.16014110254935
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.1147500334978
DONE TAKING  40  STEPS.
Total reward:  -1001.0587470215986
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -16.61026531708028
DONE TAKING  40  STEPS.
Total reward:  -321.8265613926115
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.260678929858901
DONE TAKING  40  STEPS.
Total reward:  -455.1648463686995
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter30.ckpt
Iter: 31
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  31
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  13845
On pol:  14400
Prob shape:  (28245,)

=== Epoch 0 ===
    train loss:  0.4822493016719818
    val rand:  0.3963853716850281
    val onPol:  0.27844682335853577

=== Epoch 10 ===
    train loss:  0.18408440839160572
    val rand:  0.20059794187545776
    val onPol:  0.2382997671763102

=== Epoch 20 ===
    train loss:  0.14028160165656697
    val rand:  0.1685037612915039
    val onPol:  0.23825271427631378

=== Epoch 30 ===
    train loss:  0.1140250647609884
    val rand:  0.161086305975914
    val onPol:  0.23987860480944315

=== Epoch 39 ===
    train loss:  0.09975862828168001
    val rand:  0.1559717059135437
    val onPol:  0.24484259883562723
Training duration: 13.79 s

#####################################
performing on-policy MPC rollouts... iter  31
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.18851332506355
DONE TAKING  40  STEPS.
Total reward:  -445.38656228101553
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.185701561904278
DONE TAKING  40  STEPS.
Total reward:  -443.28789810862975
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.791934279704492
DONE TAKING  40  STEPS.
Total reward:  -785.5668854087922
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.480159430783754
DONE TAKING  40  STEPS.
Total reward:  -902.0176411996936
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.773019086652678
DONE TAKING  40  STEPS.
Total reward:  -811.5112516523378
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.4571340920936
DONE TAKING  40  STEPS.
Total reward:  -564.7533496529597
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.959175820188207
DONE TAKING  40  STEPS.
Total reward:  -684.920054791875
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.0754972438788
DONE TAKING  40  STEPS.
Total reward:  -497.42358733191963
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.223752894482512
DONE TAKING  40  STEPS.
Total reward:  -611.9884068856696
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.451128868008027
DONE TAKING  40  STEPS.
Total reward:  -605.5993577485906
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.7994634143867
DONE TAKING  40  STEPS.
Total reward:  -820.9734891046155
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.0527871184461
DONE TAKING  40  STEPS.
Total reward:  -611.3396145630098
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.628452114956403
DONE TAKING  40  STEPS.
Total reward:  -786.2054475441922
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.512431382577223
DONE TAKING  40  STEPS.
Total reward:  -512.0473982845771
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -16.643133109151762
DONE TAKING  40  STEPS.
Total reward:  -367.07347280604404
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -12.464265383236404
DONE TAKING  40  STEPS.
Total reward:  -380.0152969357807
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.162577111660067
DONE TAKING  40  STEPS.
Total reward:  -279.0038289749442
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.95735869440182
DONE TAKING  40  STEPS.
Total reward:  -706.4284227340771
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -25.214442492810484
DONE TAKING  40  STEPS.
Total reward:  -820.5866182107851
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.02812169413165
DONE TAKING  40  STEPS.
Total reward:  -479.85706382154973
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.226211822466254
DONE TAKING  40  STEPS.
Total reward:  -507.44873670862717
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.418908645485104
DONE TAKING  40  STEPS.
Total reward:  -521.5206389612247
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.69617382167715
DONE TAKING  40  STEPS.
Total reward:  -713.2763893246124
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.64989512368438
DONE TAKING  40  STEPS.
Total reward:  -845.6247950387334
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -15.218632442640414
DONE TAKING  40  STEPS.
Total reward:  -360.4772917722832
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.99740665105702
DONE TAKING  40  STEPS.
Total reward:  -794.7802635918606
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -25.65268375190196
DONE TAKING  40  STEPS.
Total reward:  -726.5151136690788
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.6331871245537
DONE TAKING  40  STEPS.
Total reward:  -696.6145003158509
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.518891876504586
DONE TAKING  40  STEPS.
Total reward:  -551.0546190168473
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.454993245488595
DONE TAKING  40  STEPS.
Total reward:  -769.2959129955783
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.261904895027133
DONE TAKING  40  STEPS.
Total reward:  -858.7200936263184
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.693894403739776
DONE TAKING  40  STEPS.
Total reward:  -645.8986715571301
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.401981659555657
DONE TAKING  40  STEPS.
Total reward:  -296.9662777065304
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.77573351659678
DONE TAKING  40  STEPS.
Total reward:  -646.2330989560503
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -19.855207207557473
DONE TAKING  40  STEPS.
Total reward:  -446.20100765876396
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.564775443931282
DONE TAKING  40  STEPS.
Total reward:  -524.7864958681889
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.970582907990053
DONE TAKING  40  STEPS.
Total reward:  -305.2954108641591
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.011485186320147
DONE TAKING  40  STEPS.
Total reward:  -978.9421659189023
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -18.94597297066737
DONE TAKING  40  STEPS.
Total reward:  -239.6230904095822
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.368396316858604
DONE TAKING  40  STEPS.
Total reward:  -644.4752571957799
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter31.ckpt
Iter: 32
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  32
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  14040
On pol:  14400
Prob shape:  (28440,)

=== Epoch 0 ===
    train loss:  0.4813126412304965
    val rand:  0.4056966006755829
    val onPol:  0.2947385907173157

=== Epoch 10 ===
    train loss:  0.18430680497126145
    val rand:  0.19738803803920746
    val onPol:  0.2554618666569392

=== Epoch 20 ===
    train loss:  0.1380891751159321
    val rand:  0.16926059126853943
    val onPol:  0.25515711307525635

=== Epoch 30 ===
    train loss:  0.11440079618584026
    val rand:  0.15864604711532593
    val onPol:  0.25634639461835224

=== Epoch 39 ===
    train loss:  0.09970435676249591
    val rand:  0.16047817468643188
    val onPol:  0.25971881051858264
Training duration: 13.77 s

#####################################
performing on-policy MPC rollouts... iter  32
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.174595408019442
DONE TAKING  40  STEPS.
Total reward:  -868.4333068564538
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.652341687389345
DONE TAKING  40  STEPS.
Total reward:  -700.1458902095885
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.387333415157244
DONE TAKING  40  STEPS.
Total reward:  -709.2254509945301
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.99419669445202
DONE TAKING  40  STEPS.
Total reward:  -979.9956069364437
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.857985461740743
DONE TAKING  40  STEPS.
Total reward:  -599.5771140698246
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -15.855591250903341
DONE TAKING  40  STEPS.
Total reward:  -309.9344341953986
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.234587703624452
DONE TAKING  40  STEPS.
Total reward:  -590.1099411292378
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.493478072605484
DONE TAKING  40  STEPS.
Total reward:  -921.5274361590251
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.045785310225813
DONE TAKING  40  STEPS.
Total reward:  -744.7744629173585
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -29.35783131762937
DONE TAKING  40  STEPS.
Total reward:  -739.2393882698259
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.1984203239441
DONE TAKING  40  STEPS.
Total reward:  -578.1685445698304
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -25.839267039361907
DONE TAKING  40  STEPS.
Total reward:  -881.3780088152681
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.849632086463505
DONE TAKING  40  STEPS.
Total reward:  -877.2316851664015
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -31.157420866181976
DONE TAKING  40  STEPS.
Total reward:  -1002.1723435964172
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.311668779817865
DONE TAKING  40  STEPS.
Total reward:  -577.2945800796261
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.18428170467811
DONE TAKING  40  STEPS.
Total reward:  -891.236313900482
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.337937604829854
DONE TAKING  40  STEPS.
Total reward:  -775.8689691716859
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.80521537949206
DONE TAKING  40  STEPS.
Total reward:  -710.6571800955578
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.170672633429135
DONE TAKING  40  STEPS.
Total reward:  -575.7603104337892
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.208326548343614
DONE TAKING  40  STEPS.
Total reward:  -454.66999518974
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.039312443874028
DONE TAKING  40  STEPS.
Total reward:  -591.4878119238878
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.836290533548876
DONE TAKING  40  STEPS.
Total reward:  -795.2375862916676
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.928109869652218
DONE TAKING  40  STEPS.
Total reward:  -385.0512170452261
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.86407385557679
DONE TAKING  40  STEPS.
Total reward:  -783.0834616748664
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.871467297149273
DONE TAKING  40  STEPS.
Total reward:  -640.7314238592286
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -22.9600990862236
DONE TAKING  40  STEPS.
Total reward:  -682.6957153828995
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.7433593010806
DONE TAKING  40  STEPS.
Total reward:  -410.00764992491025
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -11.790636605375067
DONE TAKING  40  STEPS.
Total reward:  -440.4765669537818
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.00491193523534
DONE TAKING  40  STEPS.
Total reward:  -635.5024042415025
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.835526643912043
DONE TAKING  40  STEPS.
Total reward:  -561.6007378037699
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.137575950858928
DONE TAKING  40  STEPS.
Total reward:  -692.1064428761072
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.773913853862837
DONE TAKING  40  STEPS.
Total reward:  -608.1430582138229
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.429616668672683
DONE TAKING  40  STEPS.
Total reward:  -573.5701658811689
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -29.16934283762894
DONE TAKING  40  STEPS.
Total reward:  -907.4799204444678
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.8136392268503
DONE TAKING  40  STEPS.
Total reward:  -872.5571851797306
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -11.220277386753574
DONE TAKING  40  STEPS.
Total reward:  -338.52093481511946
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.412568591251897
DONE TAKING  40  STEPS.
Total reward:  -380.7047924413656
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.516387180783006
DONE TAKING  40  STEPS.
Total reward:  -643.6880307302229
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.899400379999687
DONE TAKING  40  STEPS.
Total reward:  -776.2830819663621
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.53042801028273
DONE TAKING  40  STEPS.
Total reward:  -369.9062243448422
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter32.ckpt
Iter: 33
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  33
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  14235
On pol:  14400
Prob shape:  (28635,)

=== Epoch 0 ===
    train loss:  0.4862700440666892
    val rand:  0.38281112909317017
    val onPol:  0.30075603723526

=== Epoch 10 ===
    train loss:  0.1880805259401148
    val rand:  0.20164398849010468
    val onPol:  0.2581980874141057

=== Epoch 20 ===
    train loss:  0.14232426394115794
    val rand:  0.17148908972740173
    val onPol:  0.26134217778841656

=== Epoch 30 ===
    train loss:  0.11811189597303218
    val rand:  0.1637546569108963
    val onPol:  0.2628791232903798

=== Epoch 39 ===
    train loss:  0.10229602388360283
    val rand:  0.15712393820285797
    val onPol:  0.2683907002210617
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  33
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -21.39553962927685
DONE TAKING  40  STEPS.
Total reward:  -333.5601218659069
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -17.462553032733688
DONE TAKING  40  STEPS.
Total reward:  -460.69946624649873
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.61571067888407
DONE TAKING  40  STEPS.
Total reward:  -692.7789291003514
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -11.833705692281171
DONE TAKING  40  STEPS.
Total reward:  -283.0805192610653
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.814352582852266
DONE TAKING  40  STEPS.
Total reward:  -814.9442177305345
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.09197127990717
DONE TAKING  40  STEPS.
Total reward:  -322.1970962173249
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.051894900910156
DONE TAKING  40  STEPS.
Total reward:  -477.82217922595083
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.9885837428191
DONE TAKING  40  STEPS.
Total reward:  -780.9694536227879
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -14.675198953810224
DONE TAKING  40  STEPS.
Total reward:  -428.2912406100582
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.556884444565988
DONE TAKING  40  STEPS.
Total reward:  -971.7684946019251
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.485722443201464
DONE TAKING  40  STEPS.
Total reward:  -586.6890599411746
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -16.722804385251234
DONE TAKING  40  STEPS.
Total reward:  -537.1982566573448
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.92399930337538
DONE TAKING  40  STEPS.
Total reward:  -756.2205071409628
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.323861883948478
DONE TAKING  40  STEPS.
Total reward:  -786.3971437000718
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.340105204717354
DONE TAKING  40  STEPS.
Total reward:  -969.6942965274575
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.057317753068013
DONE TAKING  40  STEPS.
Total reward:  -441.5106364474117
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.74191254112145
DONE TAKING  40  STEPS.
Total reward:  -639.8371421065859
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.584710645534642
DONE TAKING  40  STEPS.
Total reward:  -785.7291884543696
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -16.375853209442674
DONE TAKING  40  STEPS.
Total reward:  -239.2885357091076
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.55751260569586
DONE TAKING  40  STEPS.
Total reward:  -991.5626684359764
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.659684497649067
DONE TAKING  40  STEPS.
Total reward:  -914.7686724525395
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.836826718842882
DONE TAKING  40  STEPS.
Total reward:  -488.17976521288006
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.182397992194556
DONE TAKING  40  STEPS.
Total reward:  -573.1375791917175
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -18.898585762582837
DONE TAKING  40  STEPS.
Total reward:  -300.7239965300206
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.21199058645655
DONE TAKING  40  STEPS.
Total reward:  -269.4675466745657
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.20662015384399
DONE TAKING  40  STEPS.
Total reward:  -954.5746370484329
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.218307332136916
DONE TAKING  40  STEPS.
Total reward:  -506.0405557581059
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.210963638173652
DONE TAKING  40  STEPS.
Total reward:  -508.2928143211245
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.059960356899314
DONE TAKING  40  STEPS.
Total reward:  -825.8958508941137
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.141834360072362
DONE TAKING  40  STEPS.
Total reward:  -1069.0250275406154
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.312148978425885
DONE TAKING  40  STEPS.
Total reward:  -411.3044345831298
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.674582599147307
DONE TAKING  40  STEPS.
Total reward:  -522.1538235136838
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.048824395729685
DONE TAKING  40  STEPS.
Total reward:  -396.6564685439913
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -22.94843084155964
DONE TAKING  40  STEPS.
Total reward:  -857.2880528781659
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -14.685078559772439
DONE TAKING  40  STEPS.
Total reward:  -371.50471223096554
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.73540733709219
DONE TAKING  40  STEPS.
Total reward:  -637.824996074021
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.054479314057165
DONE TAKING  40  STEPS.
Total reward:  -561.243582430193
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.192638349560035
DONE TAKING  40  STEPS.
Total reward:  -828.673445412635
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.8722472419907
DONE TAKING  40  STEPS.
Total reward:  -645.5909735963803
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.267839810882087
DONE TAKING  40  STEPS.
Total reward:  -708.1604779046979
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter33.ckpt
Iter: 34
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  34
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  14430
On pol:  28800
Prob shape:  (43230,)

=== Epoch 0 ===
    train loss:  0.3944187352345103
    val rand:  0.3782634735107422
    val onPol:  0.2791607330242793

=== Epoch 10 ===
    train loss:  0.16020228075129644
    val rand:  0.2011091411113739
    val onPol:  0.2517128735780716

=== Epoch 20 ===
    train loss:  0.11356712673746404
    val rand:  0.17346714437007904
    val onPol:  0.2609235346317291

=== Epoch 30 ===
    train loss:  0.0879444173049359
    val rand:  0.16738826036453247
    val onPol:  0.2701750000317891

=== Epoch 39 ===
    train loss:  0.07318906627950214
    val rand:  0.17057190835475922
    val onPol:  0.28323857486248016
Training duration: 21.00 s

#####################################
performing on-policy MPC rollouts... iter  34
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.565393189953625
DONE TAKING  40  STEPS.
Total reward:  -727.414107257595
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.27692688033894
DONE TAKING  40  STEPS.
Total reward:  -430.2619233921951
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.543214812204106
DONE TAKING  40  STEPS.
Total reward:  -261.16849027745826
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.41170635472146
DONE TAKING  40  STEPS.
Total reward:  -476.6993425562483
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.876825157805683
DONE TAKING  40  STEPS.
Total reward:  -538.8054259272886
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.850803611567436
DONE TAKING  40  STEPS.
Total reward:  -381.0171853898924
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.448244536530616
DONE TAKING  40  STEPS.
Total reward:  -408.31095981871607
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.533056108550255
DONE TAKING  40  STEPS.
Total reward:  -794.4407666970159
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.695477482755344
DONE TAKING  40  STEPS.
Total reward:  -777.385780609146
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.602687285024217
DONE TAKING  40  STEPS.
Total reward:  -610.7287151487244
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.994895710637227
DONE TAKING  40  STEPS.
Total reward:  -124.49856307547705
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.082634170386456
DONE TAKING  40  STEPS.
Total reward:  -952.4460314094797
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.72870915085882
DONE TAKING  40  STEPS.
Total reward:  -837.8666723213441
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -15.956782582667442
DONE TAKING  40  STEPS.
Total reward:  -458.3432175342983
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.602954208308553
DONE TAKING  40  STEPS.
Total reward:  -417.2187242028217
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.862014719103346
DONE TAKING  40  STEPS.
Total reward:  -733.3193277793677
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.864149037681173
DONE TAKING  40  STEPS.
Total reward:  -708.2566885044764
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.23507307334597
DONE TAKING  40  STEPS.
Total reward:  -504.2752236377164
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.52476862953008
DONE TAKING  40  STEPS.
Total reward:  -700.3226309621815
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.90566145276702
DONE TAKING  40  STEPS.
Total reward:  -486.65834342753965
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -10.53269932170393
DONE TAKING  40  STEPS.
Total reward:  -356.0780505919381
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.368118680059489
DONE TAKING  40  STEPS.
Total reward:  -233.63928645079585
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.162615647821745
DONE TAKING  40  STEPS.
Total reward:  -418.94763585909726
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.821468048681243
DONE TAKING  40  STEPS.
Total reward:  -470.4047306951363
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.429882394401353
DONE TAKING  40  STEPS.
Total reward:  -724.9806271626766
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.81051966897817
DONE TAKING  40  STEPS.
Total reward:  -322.43131951228673
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.701485463412446
DONE TAKING  40  STEPS.
Total reward:  -731.1022282662142
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -12.764218715411735
DONE TAKING  40  STEPS.
Total reward:  -378.892588644569
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.1088862503126
DONE TAKING  40  STEPS.
Total reward:  -735.3454300272277
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.04970716063765
DONE TAKING  40  STEPS.
Total reward:  -795.5427172428424
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.502218994171045
DONE TAKING  40  STEPS.
Total reward:  -619.709013465642
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -20.683103338328273
DONE TAKING  40  STEPS.
Total reward:  -567.7426586305427
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.30593867809014
DONE TAKING  40  STEPS.
Total reward:  -817.3893097608594
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.312155241463696
DONE TAKING  40  STEPS.
Total reward:  -559.6515463110939
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.107625771576462
DONE TAKING  40  STEPS.
Total reward:  -443.51119443038635
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -13.920657340374486
DONE TAKING  40  STEPS.
Total reward:  -278.3799934659171
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.886791876996526
DONE TAKING  40  STEPS.
Total reward:  -953.5383404157636
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.220841469292104
DONE TAKING  40  STEPS.
Total reward:  -423.7649595199786
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.810229466736118
DONE TAKING  40  STEPS.
Total reward:  -601.4207301041777
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.22479837658798
DONE TAKING  40  STEPS.
Total reward:  -551.3437861019011
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter34.ckpt
Iter: 35
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  35
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  14625
On pol:  28800
Prob shape:  (43425,)

=== Epoch 0 ===
    train loss:  0.39850450590962455
    val rand:  0.37117406725883484
    val onPol:  0.27715739607810974

=== Epoch 10 ===
    train loss:  0.16103250231771243
    val rand:  0.1908470094203949
    val onPol:  0.24418951074282327

=== Epoch 20 ===
    train loss:  0.11490212203491301
    val rand:  0.17723505198955536
    val onPol:  0.2552354335784912

=== Epoch 30 ===
    train loss:  0.08673025632188433
    val rand:  0.1685844510793686
    val onPol:  0.2646893461545308

=== Epoch 39 ===
    train loss:  0.0723807407276971
    val rand:  0.16981641948223114
    val onPol:  0.2746088206768036
Training duration: 22.20 s

#####################################
performing on-policy MPC rollouts... iter  35
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.995124886047353
DONE TAKING  40  STEPS.
Total reward:  -445.31610307265237
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -15.252080299427853
DONE TAKING  40  STEPS.
Total reward:  -410.97266569178515
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.872251468642958
DONE TAKING  40  STEPS.
Total reward:  -838.6076799430261
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.136497560060345
DONE TAKING  40  STEPS.
Total reward:  -541.0513620614277
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.639579417046754
DONE TAKING  40  STEPS.
Total reward:  -694.2374751869851
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -10.373730533451157
DONE TAKING  40  STEPS.
Total reward:  -315.4220428189582
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.226122401594385
DONE TAKING  40  STEPS.
Total reward:  -798.2601675731888
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.921195236809673
DONE TAKING  40  STEPS.
Total reward:  -487.82467061851224
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.245360749081165
DONE TAKING  40  STEPS.
Total reward:  -494.7011958243554
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -14.165176544100376
DONE TAKING  40  STEPS.
Total reward:  -549.7137990303687
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.947760764492024
DONE TAKING  40  STEPS.
Total reward:  -596.1683885933872
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.571657013972853
DONE TAKING  40  STEPS.
Total reward:  -464.8247755815905
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -31.069757576485614
DONE TAKING  40  STEPS.
Total reward:  -874.9083338054711
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.831979932731482
DONE TAKING  40  STEPS.
Total reward:  -900.3879282460953
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -9.817271202937993
DONE TAKING  40  STEPS.
Total reward:  -342.64808590972024
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.99548620004523
DONE TAKING  40  STEPS.
Total reward:  -534.6163236341547
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.00719856870582
DONE TAKING  40  STEPS.
Total reward:  -630.0417588995431
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.354809069435085
DONE TAKING  40  STEPS.
Total reward:  -482.1489702210155
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.36027461839057
DONE TAKING  40  STEPS.
Total reward:  -831.6457264068523
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -31.03816072246942
DONE TAKING  40  STEPS.
Total reward:  -888.839262921219
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.93025783287741
DONE TAKING  40  STEPS.
Total reward:  -477.65747997683144
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.837262931939172
DONE TAKING  40  STEPS.
Total reward:  -704.9474578997002
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.72961883870633
DONE TAKING  40  STEPS.
Total reward:  -638.1367891890326
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.804808846797698
DONE TAKING  40  STEPS.
Total reward:  -875.2798657398529
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.89925876484027
DONE TAKING  40  STEPS.
Total reward:  -578.4240741304124
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.228037333616577
DONE TAKING  40  STEPS.
Total reward:  -732.2931577585701
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -16.002340297544933
DONE TAKING  40  STEPS.
Total reward:  -480.502268571405
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.332736884528476
DONE TAKING  40  STEPS.
Total reward:  -550.8884496160331
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -17.690088687727258
DONE TAKING  40  STEPS.
Total reward:  -492.2261993537424
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.772490146410306
DONE TAKING  40  STEPS.
Total reward:  -794.7942702657992
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -19.31432273187206
DONE TAKING  40  STEPS.
Total reward:  -519.638451126332
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.902923795527695
DONE TAKING  40  STEPS.
Total reward:  -721.8160194969599
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.897834587246056
DONE TAKING  40  STEPS.
Total reward:  -857.4105570664746
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.93212963714195
DONE TAKING  40  STEPS.
Total reward:  -539.5160503359419
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.32164628254197
DONE TAKING  40  STEPS.
Total reward:  -380.6913804203787
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -31.121083192639087
DONE TAKING  40  STEPS.
Total reward:  -834.956319821903
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.660760007797485
DONE TAKING  40  STEPS.
Total reward:  -669.5503670997354
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -27.949239081255257
DONE TAKING  40  STEPS.
Total reward:  -819.7388488084073
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.303806408833736
DONE TAKING  40  STEPS.
Total reward:  -971.1154332430744
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.70547755887489
DONE TAKING  40  STEPS.
Total reward:  -614.1271601448211
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter35.ckpt
Iter: 36
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  36
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  14820
On pol:  28800
Prob shape:  (43620,)

=== Epoch 0 ===
    train loss:  0.4065179631990545
    val rand:  0.37107348442077637
    val onPol:  0.29211245973904926

=== Epoch 10 ===
    train loss:  0.1648980447474648
    val rand:  0.19679991900920868
    val onPol:  0.262030690908432

=== Epoch 20 ===
    train loss:  0.11490317092222326
    val rand:  0.16960707306861877
    val onPol:  0.2739214102427165

=== Epoch 30 ===
    train loss:  0.0891262461157406
    val rand:  0.17015382647514343
    val onPol:  0.28586797912915546

=== Epoch 39 ===
    train loss:  0.07344910923172446
    val rand:  0.16393819451332092
    val onPol:  0.29670998454093933
Training duration: 21.31 s

#####################################
performing on-policy MPC rollouts... iter  36
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.116247530796585
DONE TAKING  40  STEPS.
Total reward:  -590.633107935553
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -17.023514064934613
DONE TAKING  40  STEPS.
Total reward:  -450.33050774144033
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.435390558380375
DONE TAKING  40  STEPS.
Total reward:  -205.92618598478774
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.27375196086711
DONE TAKING  40  STEPS.
Total reward:  -694.084248798529
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.39120095332455
DONE TAKING  40  STEPS.
Total reward:  -852.741164300657
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.035443984716142
DONE TAKING  40  STEPS.
Total reward:  -368.68082790846995
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.68143260436964
DONE TAKING  40  STEPS.
Total reward:  -804.5310836924323
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.525525147839446
DONE TAKING  40  STEPS.
Total reward:  -582.4541024941625
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.91839096267168
DONE TAKING  40  STEPS.
Total reward:  -1024.504674618236
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.451631150267424
DONE TAKING  40  STEPS.
Total reward:  -630.5120194234246
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -13.528017054784577
DONE TAKING  40  STEPS.
Total reward:  -35.815011690853694
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.285496195970026
DONE TAKING  40  STEPS.
Total reward:  -376.3426366756384
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.315974945382393
DONE TAKING  40  STEPS.
Total reward:  -823.0088363755701
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -10.147778076056508
DONE TAKING  40  STEPS.
Total reward:  -111.0911414353623
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.455077706716207
DONE TAKING  40  STEPS.
Total reward:  -801.3073461106148
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.29992279180158
DONE TAKING  40  STEPS.
Total reward:  -1131.0378804137554
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.616715873151183
DONE TAKING  40  STEPS.
Total reward:  -978.7943399819131
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -16.695341495893544
DONE TAKING  40  STEPS.
Total reward:  -524.5113244410898
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.032419896438768
DONE TAKING  40  STEPS.
Total reward:  -857.2467747706746
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.254032486611152
DONE TAKING  40  STEPS.
Total reward:  -696.0472285132771
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.604797760117357
DONE TAKING  40  STEPS.
Total reward:  -667.2270224191928
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.580629761825477
DONE TAKING  40  STEPS.
Total reward:  -635.6279909431559
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.554175553191293
DONE TAKING  40  STEPS.
Total reward:  -1096.1562130257787
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.355344625210893
DONE TAKING  40  STEPS.
Total reward:  -515.8023374061863
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.193102254980445
DONE TAKING  40  STEPS.
Total reward:  -337.61619780907006
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.183883250388632
DONE TAKING  40  STEPS.
Total reward:  -531.2486623770519
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.588952480930836
DONE TAKING  40  STEPS.
Total reward:  -528.6546287929119
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.23762835788581
DONE TAKING  40  STEPS.
Total reward:  -564.9422104122841
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.769868040427035
DONE TAKING  40  STEPS.
Total reward:  -939.7933248978724
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.017703729766623
DONE TAKING  40  STEPS.
Total reward:  -823.6164252650792
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.740379888980222
DONE TAKING  40  STEPS.
Total reward:  -776.0294836637574
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.809658848870615
DONE TAKING  40  STEPS.
Total reward:  -583.1369059437458
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -18.298943716257895
DONE TAKING  40  STEPS.
Total reward:  -350.67919374209606
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.663275945132213
DONE TAKING  40  STEPS.
Total reward:  -707.2290360960608
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.055680718104004
DONE TAKING  40  STEPS.
Total reward:  -486.9204188443935
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.44214649840693
DONE TAKING  40  STEPS.
Total reward:  -695.0889769836092
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.004351489006485
DONE TAKING  40  STEPS.
Total reward:  -507.72665193210656
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -14.690239447659339
DONE TAKING  40  STEPS.
Total reward:  0.07547408009721224
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.025369369205
DONE TAKING  40  STEPS.
Total reward:  -719.9226747082455
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.83321462085704
DONE TAKING  40  STEPS.
Total reward:  -610.97216869866
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter36.ckpt
Iter: 37
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  37
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15015
On pol:  28800
Prob shape:  (43815,)

=== Epoch 0 ===
    train loss:  0.40494985685629004
    val rand:  0.35525962710380554
    val onPol:  0.30021315813064575

=== Epoch 10 ===
    train loss:  0.16603163463227888
    val rand:  0.19446836411952972
    val onPol:  0.27029478549957275

=== Epoch 20 ===
    train loss:  0.11622451473684872
    val rand:  0.17297211289405823
    val onPol:  0.2844703296820323

=== Epoch 30 ===
    train loss:  0.08762385818888159
    val rand:  0.16537076234817505
    val onPol:  0.2977943817774455

=== Epoch 39 ===
    train loss:  0.07294138038859647
    val rand:  0.16231979429721832
    val onPol:  0.3088741997877757
Training duration: 22.37 s

#####################################
performing on-policy MPC rollouts... iter  37
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.76722281805253
DONE TAKING  40  STEPS.
Total reward:  -631.8207686110861
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.468939921869705
DONE TAKING  40  STEPS.
Total reward:  -1096.8361273970881
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.554014721045647
DONE TAKING  40  STEPS.
Total reward:  -407.0084709161933
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.309313172849958
DONE TAKING  40  STEPS.
Total reward:  -729.1209981561082
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.55952603603367
DONE TAKING  40  STEPS.
Total reward:  -562.2091620607924
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -13.392694002480434
DONE TAKING  40  STEPS.
Total reward:  -478.3894359596892
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.347806665895433
DONE TAKING  40  STEPS.
Total reward:  -553.3129405922093
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.195048935919644
DONE TAKING  40  STEPS.
Total reward:  -447.52512066358844
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.364226913491756
DONE TAKING  40  STEPS.
Total reward:  -761.2242098041003
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.055874969958595
DONE TAKING  40  STEPS.
Total reward:  -829.6266627897111
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.715779012928387
DONE TAKING  40  STEPS.
Total reward:  -1094.1880269627407
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.029652801603067
DONE TAKING  40  STEPS.
Total reward:  115.14874105271639
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.217501300009197
DONE TAKING  40  STEPS.
Total reward:  -632.4867624526911
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -11.930642010778449
DONE TAKING  40  STEPS.
Total reward:  -389.9392917935642
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.895833370721064
DONE TAKING  40  STEPS.
Total reward:  -729.3186082712339
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.402989514387396
DONE TAKING  40  STEPS.
Total reward:  -397.4728919121273
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.321241481468785
DONE TAKING  40  STEPS.
Total reward:  -680.6251284754144
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.819592917799273
DONE TAKING  40  STEPS.
Total reward:  -995.449594820579
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.604944068732916
DONE TAKING  40  STEPS.
Total reward:  -557.6734590210853
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.15258580032619
DONE TAKING  40  STEPS.
Total reward:  -690.453307264056
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.5614071990143
DONE TAKING  40  STEPS.
Total reward:  -299.30514795469855
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -15.276554671805682
DONE TAKING  40  STEPS.
Total reward:  -431.71425341925163
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.446026372070394
DONE TAKING  40  STEPS.
Total reward:  -414.65843346404677
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.936371994402577
DONE TAKING  40  STEPS.
Total reward:  -777.3706511739917
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -31.033007311916066
DONE TAKING  40  STEPS.
Total reward:  -820.4896205590419
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.46986213890076
DONE TAKING  40  STEPS.
Total reward:  -734.3081271037448
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.07694184743607
DONE TAKING  40  STEPS.
Total reward:  -1017.1212268864699
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.675724718396307
DONE TAKING  40  STEPS.
Total reward:  -489.3545993796045
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.894699238670388
DONE TAKING  40  STEPS.
Total reward:  -671.9510035729788
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.878767365730937
DONE TAKING  40  STEPS.
Total reward:  -1068.6452922312922
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.86771247864873
DONE TAKING  40  STEPS.
Total reward:  -803.5726710641798
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -14.73298001342015
DONE TAKING  40  STEPS.
Total reward:  -282.65036787256713
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.68386252627007
DONE TAKING  40  STEPS.
Total reward:  -645.8760820887535
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.376272991636863
DONE TAKING  40  STEPS.
Total reward:  -551.9981206258901
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.835092949122735
DONE TAKING  40  STEPS.
Total reward:  -445.6210379174206
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.309334525918104
DONE TAKING  40  STEPS.
Total reward:  -499.1490709962411
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.078305541143948
DONE TAKING  40  STEPS.
Total reward:  -553.4543698746121
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.553700974597852
DONE TAKING  40  STEPS.
Total reward:  -836.7372350779574
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.567715789938017
DONE TAKING  40  STEPS.
Total reward:  -654.6284815243855
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.446634029799057
DONE TAKING  40  STEPS.
Total reward:  -677.3274193537817
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter37.ckpt
Iter: 38
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  38
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15210
On pol:  28800
Prob shape:  (44010,)

=== Epoch 0 ===
    train loss:  0.41349017655148224
    val rand:  0.35994404554367065
    val onPol:  0.31350113948186237

=== Epoch 10 ===
    train loss:  0.16985164179521448
    val rand:  0.18931135535240173
    val onPol:  0.2828878313302994

=== Epoch 20 ===
    train loss:  0.11737589459208882
    val rand:  0.16879460215568542
    val onPol:  0.29373682538668316

=== Epoch 30 ===
    train loss:  0.08939038874471888
    val rand:  0.1637450009584427
    val onPol:  0.31278863549232483

=== Epoch 39 ===
    train loss:  0.07418519863310982
    val rand:  0.15860629081726074
    val onPol:  0.3187212149302165
Training duration: 21.40 s

#####################################
performing on-policy MPC rollouts... iter  38
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.87076063701562
DONE TAKING  40  STEPS.
Total reward:  -534.7830216184152
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -16.333495563752958
DONE TAKING  40  STEPS.
Total reward:  -503.00382956818595
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.02611129461609
DONE TAKING  40  STEPS.
Total reward:  -904.5935191974374
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.199001049785917
DONE TAKING  40  STEPS.
Total reward:  -652.263942824617
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.658749309458287
DONE TAKING  40  STEPS.
Total reward:  -982.7592416273802
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.51760973634682
DONE TAKING  40  STEPS.
Total reward:  -515.6083398460115
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.799112292250506
DONE TAKING  40  STEPS.
Total reward:  -776.5397227351991
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.359028501830995
DONE TAKING  40  STEPS.
Total reward:  -754.6672431752443
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -31.1205348345063
DONE TAKING  40  STEPS.
Total reward:  -595.0956696023013
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.818931335661368
DONE TAKING  40  STEPS.
Total reward:  -759.8699494074452
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.688056436460254
DONE TAKING  40  STEPS.
Total reward:  -796.1532220239142
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.2716429867763
DONE TAKING  40  STEPS.
Total reward:  -435.3649054000027
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.102363112579653
DONE TAKING  40  STEPS.
Total reward:  -544.0086302725499
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.254475560433946
DONE TAKING  40  STEPS.
Total reward:  -947.0580630142412
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.852371535198206
DONE TAKING  40  STEPS.
Total reward:  -565.4888862553171
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -14.107711807573832
DONE TAKING  40  STEPS.
Total reward:  -424.7777420084876
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.939970304605538
DONE TAKING  40  STEPS.
Total reward:  -739.9522356228616
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.257982742351356
DONE TAKING  40  STEPS.
Total reward:  -68.83469227190771
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.31521851501671
DONE TAKING  40  STEPS.
Total reward:  -967.1028396627817
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -14.609257119334362
DONE TAKING  40  STEPS.
Total reward:  -466.9717268548551
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.705442243284445
DONE TAKING  40  STEPS.
Total reward:  -850.127456460599
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -13.957717593457188
DONE TAKING  40  STEPS.
Total reward:  -247.6634891424704
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -14.759866498490302
DONE TAKING  40  STEPS.
Total reward:  -419.1191042770866
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.03960554470879
DONE TAKING  40  STEPS.
Total reward:  -323.50377618372204
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.385169787750467
DONE TAKING  40  STEPS.
Total reward:  -863.4189258130702
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -14.50041187581695
DONE TAKING  40  STEPS.
Total reward:  -589.2748569486197
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.790647522638718
DONE TAKING  40  STEPS.
Total reward:  -907.5444951509515
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.625409723161502
DONE TAKING  40  STEPS.
Total reward:  -430.65977787442915
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.99925946865519
DONE TAKING  40  STEPS.
Total reward:  -503.0005841631741
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.4793799266997
DONE TAKING  40  STEPS.
Total reward:  -824.6622920004648
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.821136401978436
DONE TAKING  40  STEPS.
Total reward:  -624.6255705963675
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -20.403287743052463
DONE TAKING  40  STEPS.
Total reward:  -407.4632593925897
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.52791358132023
DONE TAKING  40  STEPS.
Total reward:  -353.53864012237534
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -12.614725069559185
DONE TAKING  40  STEPS.
Total reward:  -302.56379886024735
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.66436989013209
DONE TAKING  40  STEPS.
Total reward:  -684.2412906220064
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.7194381330314
DONE TAKING  40  STEPS.
Total reward:  -685.5366301063248
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.286867534611
DONE TAKING  40  STEPS.
Total reward:  -296.46310636946527
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.59909437657144
DONE TAKING  40  STEPS.
Total reward:  -932.5858064278534
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.573030134797833
DONE TAKING  40  STEPS.
Total reward:  -330.32477236745353
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -10.666498969442051
DONE TAKING  40  STEPS.
Total reward:  -257.36784784640383
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter38.ckpt
Iter: 39
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  39
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15405
On pol:  28800
Prob shape:  (44205,)

=== Epoch 0 ===
    train loss:  0.41270374731962073
    val rand:  0.35100382566452026
    val onPol:  0.31832421819369

=== Epoch 10 ===
    train loss:  0.17100312144950378
    val rand:  0.18818245828151703
    val onPol:  0.28677183389663696

=== Epoch 20 ===
    train loss:  0.11904244947918625
    val rand:  0.16866593062877655
    val onPol:  0.2983967413504918

=== Epoch 30 ===
    train loss:  0.0904815124217854
    val rand:  0.16409502923488617
    val onPol:  0.3117612500985463

=== Epoch 39 ===
    train loss:  0.07397878429917402
    val rand:  0.15976352989673615
    val onPol:  0.3260820259650548
Training duration: 22.54 s

#####################################
performing on-policy MPC rollouts... iter  39
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -17.903450818541188
DONE TAKING  40  STEPS.
Total reward:  -255.70456526484028
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.695311917655186
DONE TAKING  40  STEPS.
Total reward:  -576.764561358429
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.355765385671674
DONE TAKING  40  STEPS.
Total reward:  -618.7351140324652
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -10.99674192018649
DONE TAKING  40  STEPS.
Total reward:  -337.8857870620557
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.365257699161322
DONE TAKING  40  STEPS.
Total reward:  -576.4109111193228
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.179514525197895
DONE TAKING  40  STEPS.
Total reward:  -631.7764233529914
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.438219587906843
DONE TAKING  40  STEPS.
Total reward:  -576.9791866346579
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.71384586891568
DONE TAKING  40  STEPS.
Total reward:  -529.3426121467513
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.8662961403419
DONE TAKING  40  STEPS.
Total reward:  -560.9950574863295
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.40251112568476
DONE TAKING  40  STEPS.
Total reward:  -413.5108963345864
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.98844009427992
DONE TAKING  40  STEPS.
Total reward:  -3.0120433378502005
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.758483106236085
DONE TAKING  40  STEPS.
Total reward:  -563.4593986545585
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.359856423709193
DONE TAKING  40  STEPS.
Total reward:  -642.484000579136
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.115450127226556
DONE TAKING  40  STEPS.
Total reward:  -992.2808887137511
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.846012313761072
DONE TAKING  40  STEPS.
Total reward:  -797.8328751098102
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.254620308975124
DONE TAKING  40  STEPS.
Total reward:  -454.5238939519364
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.20905695255569
DONE TAKING  40  STEPS.
Total reward:  -529.7571237165762
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.910301825743533
DONE TAKING  40  STEPS.
Total reward:  -380.36267200508865
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.95320194651918
DONE TAKING  40  STEPS.
Total reward:  -957.8580117237917
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.98579157403764
DONE TAKING  40  STEPS.
Total reward:  -224.88938960069927
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.298325955444465
DONE TAKING  40  STEPS.
Total reward:  -578.2985756625169
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.7263791647912
DONE TAKING  40  STEPS.
Total reward:  -714.6948515634274
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.371637700965493
DONE TAKING  40  STEPS.
Total reward:  -841.5864224389882
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.975057917766325
DONE TAKING  40  STEPS.
Total reward:  -838.619872699845
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.398727826993035
DONE TAKING  40  STEPS.
Total reward:  -571.5076596557465
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.24072145494457
DONE TAKING  40  STEPS.
Total reward:  -751.8106721650519
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.93164247851383
DONE TAKING  40  STEPS.
Total reward:  -937.7085005988852
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.001678768785922
DONE TAKING  40  STEPS.
Total reward:  -780.4029042190951
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.81329511311923
DONE TAKING  40  STEPS.
Total reward:  -675.3692347654838
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.60680108978857
DONE TAKING  40  STEPS.
Total reward:  -576.6132402345621
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.070762059293475
DONE TAKING  40  STEPS.
Total reward:  -686.4860992704419
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.395098409796702
DONE TAKING  40  STEPS.
Total reward:  -787.3422734980772
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.030392304807506
DONE TAKING  40  STEPS.
Total reward:  -592.6833703528015
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.443886129467906
DONE TAKING  40  STEPS.
Total reward:  -539.7452651428806
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.429214792598778
DONE TAKING  40  STEPS.
Total reward:  -499.4016035723582
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.47374113364216
DONE TAKING  40  STEPS.
Total reward:  -613.259374662727
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -22.000058274237333
DONE TAKING  40  STEPS.
Total reward:  -677.9571545998799
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.201220801035632
DONE TAKING  40  STEPS.
Total reward:  -659.8025371598643
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.20484968010676
DONE TAKING  40  STEPS.
Total reward:  -875.5854745243412
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.196178214374573
DONE TAKING  40  STEPS.
Total reward:  -876.1604739946823
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter39.ckpt
Iter: 40
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  40
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15600
On pol:  28800
Prob shape:  (44400,)

=== Epoch 0 ===
    train loss:  0.41008910779343094
    val rand:  0.3532737195491791
    val onPol:  0.3201339741547902

=== Epoch 10 ===
    train loss:  0.17278176320846692
    val rand:  0.1936378926038742
    val onPol:  0.28869442145029706

=== Epoch 20 ===
    train loss:  0.11949480784147284
    val rand:  0.17164304852485657
    val onPol:  0.30468369523684186

=== Epoch 30 ===
    train loss:  0.08951041951429012
    val rand:  0.16124556958675385
    val onPol:  0.32012603680292767

=== Epoch 39 ===
    train loss:  0.07336455704860909
    val rand:  0.16162364184856415
    val onPol:  0.33406511942545575
Training duration: 22.63 s

#####################################
performing on-policy MPC rollouts... iter  40
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.85286219398725
DONE TAKING  40  STEPS.
Total reward:  -922.7214772882638
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.939878875422327
DONE TAKING  40  STEPS.
Total reward:  -497.64691233035666
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.831853627762204
DONE TAKING  40  STEPS.
Total reward:  -671.114739590711
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.092383067441418
DONE TAKING  40  STEPS.
Total reward:  -804.1574184972844
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.72031038017273
DONE TAKING  40  STEPS.
Total reward:  -758.8208479505341
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.22296662867881
DONE TAKING  40  STEPS.
Total reward:  -825.9787794668699
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -16.504897988560604
DONE TAKING  40  STEPS.
Total reward:  -525.9172060527112
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -20.01109943705365
DONE TAKING  40  STEPS.
Total reward:  -541.5457784656345
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.350476845816367
DONE TAKING  40  STEPS.
Total reward:  -59.251174694438035
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.706026180260107
DONE TAKING  40  STEPS.
Total reward:  -1028.9260935324266
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -29.892714958564003
DONE TAKING  40  STEPS.
Total reward:  -179.29296438958252
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -17.6454234064656
DONE TAKING  40  STEPS.
Total reward:  -503.77830310761084
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -16.057166189833588
DONE TAKING  40  STEPS.
Total reward:  -316.97370984341654
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -27.24347596838117
DONE TAKING  40  STEPS.
Total reward:  -912.5954403866785
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.12385003196493
DONE TAKING  40  STEPS.
Total reward:  -750.0391666030597
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.818236681889125
DONE TAKING  40  STEPS.
Total reward:  -726.1606936998065
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -14.677463315717887
DONE TAKING  40  STEPS.
Total reward:  -426.23973591028584
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -31.156265987471052
DONE TAKING  40  STEPS.
Total reward:  -548.9600960257217
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.834998029975882
DONE TAKING  40  STEPS.
Total reward:  -854.2604832475132
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.999201101781413
DONE TAKING  40  STEPS.
Total reward:  -625.4984997800873
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -24.487314873754883
DONE TAKING  40  STEPS.
Total reward:  -724.4628882762581
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.292515185322948
DONE TAKING  40  STEPS.
Total reward:  -600.0037453691864
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.09232475424252
DONE TAKING  40  STEPS.
Total reward:  -359.5966001046421
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.603850955296963
DONE TAKING  40  STEPS.
Total reward:  -604.7559154643379
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.204210379100225
DONE TAKING  40  STEPS.
Total reward:  -972.9112981291104
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.34710413827275
DONE TAKING  40  STEPS.
Total reward:  -318.19402706563176
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.292825438383893
DONE TAKING  40  STEPS.
Total reward:  -466.47034312416736
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.445863463213996
DONE TAKING  40  STEPS.
Total reward:  -810.0513707136435
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -12.27233840074286
DONE TAKING  40  STEPS.
Total reward:  -298.1109630570486
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -18.24971355625751
DONE TAKING  40  STEPS.
Total reward:  -662.878852112031
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -13.932309309180495
DONE TAKING  40  STEPS.
Total reward:  -548.6991068342863
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.671485217471204
DONE TAKING  40  STEPS.
Total reward:  -767.4115447067555
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.850353507369515
DONE TAKING  40  STEPS.
Total reward:  -701.1768865712836
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -31.12030157634384
DONE TAKING  40  STEPS.
Total reward:  -846.0792449218787
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.03845947485091
DONE TAKING  40  STEPS.
Total reward:  -331.5731359233166
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.042744069937076
DONE TAKING  40  STEPS.
Total reward:  -613.1199593570874
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.838572042236876
DONE TAKING  40  STEPS.
Total reward:  -961.3253174195572
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.48144116298572
DONE TAKING  40  STEPS.
Total reward:  -742.8589200402653
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.262582577233417
DONE TAKING  40  STEPS.
Total reward:  -862.5339104049759
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.829309237091298
DONE TAKING  40  STEPS.
Total reward:  -920.4243290606123
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter40.ckpt
Iter: 41
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  41
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15795
On pol:  28800
Prob shape:  (44595,)

=== Epoch 0 ===
    train loss:  0.41239745109930803
    val rand:  0.3346739411354065
    val onPol:  0.3146388034025828

=== Epoch 10 ===
    train loss:  0.17183773133946562
    val rand:  0.18214905261993408
    val onPol:  0.28494320313135785

=== Epoch 20 ===
    train loss:  0.11917050748035826
    val rand:  0.16364780068397522
    val onPol:  0.30464046200116474

=== Epoch 30 ===
    train loss:  0.0892585168282191
    val rand:  0.16630110144615173
    val onPol:  0.3195692201455434

=== Epoch 39 ===
    train loss:  0.07255417956360455
    val rand:  0.15633606910705566
    val onPol:  0.33225029706954956
Training duration: 22.62 s

#####################################
performing on-policy MPC rollouts... iter  41
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.347358572036153
DONE TAKING  40  STEPS.
Total reward:  -620.1345599858462
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -15.117906508867387
DONE TAKING  40  STEPS.
Total reward:  -321.14310338143105
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.88530275278779
DONE TAKING  40  STEPS.
Total reward:  -408.44190852554306
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.369841181891243
DONE TAKING  40  STEPS.
Total reward:  -498.22230932474423
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.574945152101982
DONE TAKING  40  STEPS.
Total reward:  -657.2511218372434
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.88328026649406
DONE TAKING  40  STEPS.
Total reward:  -772.4111169904112
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.11827225016512
DONE TAKING  40  STEPS.
Total reward:  -532.7598346176069
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.258715302864104
DONE TAKING  40  STEPS.
Total reward:  -310.67651522187333
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.322593962301294
DONE TAKING  40  STEPS.
Total reward:  -481.8828336947876
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.07823625891794
DONE TAKING  40  STEPS.
Total reward:  -215.48951313145875
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.56608314407973
DONE TAKING  40  STEPS.
Total reward:  -3.41512666583818
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -16.941952634100666
DONE TAKING  40  STEPS.
Total reward:  -451.00729788050836
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -15.244317617814511
DONE TAKING  40  STEPS.
Total reward:  -252.8721818754867
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.280987768620896
DONE TAKING  40  STEPS.
Total reward:  -745.5212774094506
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.88028800116837
DONE TAKING  40  STEPS.
Total reward:  -467.71260046380104
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -31.256667447308153
DONE TAKING  40  STEPS.
Total reward:  -979.7040141325633
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.773259215337895
DONE TAKING  40  STEPS.
Total reward:  -739.5231291330768
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.19056192154897
DONE TAKING  40  STEPS.
Total reward:  -689.3407467887585
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.53424766129174
DONE TAKING  40  STEPS.
Total reward:  -799.9031115125758
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.96901546495134
DONE TAKING  40  STEPS.
Total reward:  -1012.262570253327
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.811768340047912
DONE TAKING  40  STEPS.
Total reward:  -973.4735334465563
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.061495760490956
DONE TAKING  40  STEPS.
Total reward:  -61.0733926113006
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.215191595703466
DONE TAKING  40  STEPS.
Total reward:  -749.6949597948882
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.985855580470055
DONE TAKING  40  STEPS.
Total reward:  -758.3985163046443
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -11.126620319163942
DONE TAKING  40  STEPS.
Total reward:  -231.18922481717985
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.65359781116687
DONE TAKING  40  STEPS.
Total reward:  -603.0108118556591
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.62200906433391
DONE TAKING  40  STEPS.
Total reward:  65.01738355397455
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.7002208462944
DONE TAKING  40  STEPS.
Total reward:  -291.69818828219707
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -8.826715439223083
DONE TAKING  40  STEPS.
Total reward:  -187.8455053412425
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.82402104493697
DONE TAKING  40  STEPS.
Total reward:  -704.017275557956
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.21624853627896
DONE TAKING  40  STEPS.
Total reward:  -343.88942317988324
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.21787113015811
DONE TAKING  40  STEPS.
Total reward:  -773.7874208520639
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.815321810800093
DONE TAKING  40  STEPS.
Total reward:  -567.5691731577285
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.686605884448205
DONE TAKING  40  STEPS.
Total reward:  -766.614408026867
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.49534024544618
DONE TAKING  40  STEPS.
Total reward:  -373.13313120113247
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.93894194609442
DONE TAKING  40  STEPS.
Total reward:  -671.4119438895959
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.60030897213165
DONE TAKING  40  STEPS.
Total reward:  -797.0137762017656
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.165199962947536
DONE TAKING  40  STEPS.
Total reward:  -592.8488309197492
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.062859167454079
DONE TAKING  40  STEPS.
Total reward:  -336.8148609442453
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.405467219005445
DONE TAKING  40  STEPS.
Total reward:  -847.5849391823477
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter41.ckpt
Iter: 42
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  42
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  15990
On pol:  28800
Prob shape:  (44790,)

=== Epoch 0 ===
    train loss:  0.41225204043004704
    val rand:  0.33582091331481934
    val onPol:  0.3025209804375966

=== Epoch 10 ===
    train loss:  0.17212927033161296
    val rand:  0.18615153431892395
    val onPol:  0.27303532759348553

=== Epoch 20 ===
    train loss:  0.11859655791315539
    val rand:  0.16299954056739807
    val onPol:  0.287586510181427

=== Epoch 30 ===
    train loss:  0.08872419304546268
    val rand:  0.1623227894306183
    val onPol:  0.30576158066590625

=== Epoch 39 ===
    train loss:  0.0709292181264395
    val rand:  0.15709653496742249
    val onPol:  0.3153416762749354
Training duration: 22.99 s

#####################################
performing on-policy MPC rollouts... iter  42
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.514671786621967
DONE TAKING  40  STEPS.
Total reward:  -715.0304354704747
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.588113606509623
DONE TAKING  40  STEPS.
Total reward:  -929.6100350724952
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.950777207374934
DONE TAKING  40  STEPS.
Total reward:  -804.6562700969941
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.683139586264986
DONE TAKING  40  STEPS.
Total reward:  -859.2848912383984
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.047221549382257
DONE TAKING  40  STEPS.
Total reward:  -646.1467068494517
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.645086933260387
DONE TAKING  40  STEPS.
Total reward:  -625.5906591009427
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.22300976703139
DONE TAKING  40  STEPS.
Total reward:  -615.367023563829
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.676757128680592
DONE TAKING  40  STEPS.
Total reward:  -513.746054933686
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.916981537710036
DONE TAKING  40  STEPS.
Total reward:  -1037.122418012562
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.571340241959085
DONE TAKING  40  STEPS.
Total reward:  -908.6610397959757
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.658135417701693
DONE TAKING  40  STEPS.
Total reward:  -563.9555178565818
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.91899791083454
DONE TAKING  40  STEPS.
Total reward:  -858.0647186978357
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -13.828853453860432
DONE TAKING  40  STEPS.
Total reward:  -271.50816007626076
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.348586928970594
DONE TAKING  40  STEPS.
Total reward:  -1023.1303572019875
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.356169726927824
DONE TAKING  40  STEPS.
Total reward:  -632.1238239329134
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -18.41816874639377
DONE TAKING  40  STEPS.
Total reward:  -173.33255603965094
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -31.060246653786805
DONE TAKING  40  STEPS.
Total reward:  -716.94550508045
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.718934835283168
DONE TAKING  40  STEPS.
Total reward:  -620.6387175125637
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.467460904019244
DONE TAKING  40  STEPS.
Total reward:  -871.9598725001192
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.134583954762313
DONE TAKING  40  STEPS.
Total reward:  -454.16767847734087
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.945875369945547
DONE TAKING  40  STEPS.
Total reward:  -762.7891657778056
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.106297211494894
DONE TAKING  40  STEPS.
Total reward:  -963.901083029909
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.073883786779056
DONE TAKING  40  STEPS.
Total reward:  -633.1590712473115
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.19284331026485
DONE TAKING  40  STEPS.
Total reward:  -802.1858899155337
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.9800285970924
DONE TAKING  40  STEPS.
Total reward:  -236.7672368807989
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.665167153934608
DONE TAKING  40  STEPS.
Total reward:  -993.712805397086
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.597578528363996
DONE TAKING  40  STEPS.
Total reward:  -357.80955538897564
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.65945195140578
DONE TAKING  40  STEPS.
Total reward:  -642.0448827588172
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.902498053041807
DONE TAKING  40  STEPS.
Total reward:  -643.9457180824844
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.838963481031445
DONE TAKING  40  STEPS.
Total reward:  -688.9105021168451
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.123794415855993
DONE TAKING  40  STEPS.
Total reward:  -579.037805568074
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.136974026269144
DONE TAKING  40  STEPS.
Total reward:  -914.969339063357
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -31.00221133592527
DONE TAKING  40  STEPS.
Total reward:  -658.2498927418563
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.34690729102568
DONE TAKING  40  STEPS.
Total reward:  -515.9718050031721
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.49528355537157
DONE TAKING  40  STEPS.
Total reward:  -503.5328259663119
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -10.227101554967968
DONE TAKING  40  STEPS.
Total reward:  -324.5794903365467
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.999535709745217
DONE TAKING  40  STEPS.
Total reward:  -808.4289383684545
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.085231550489564
DONE TAKING  40  STEPS.
Total reward:  -452.4679260263811
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.996839177876133
DONE TAKING  40  STEPS.
Total reward:  -718.6400573087902
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.86257606253654
DONE TAKING  40  STEPS.
Total reward:  -473.3148205502632
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter42.ckpt
Iter: 43
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  43
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  16185
On pol:  28800
Prob shape:  (44985,)

=== Epoch 0 ===
    train loss:  0.4120153798454109
    val rand:  0.32745715975761414
    val onPol:  0.3114261031150818

=== Epoch 10 ===
    train loss:  0.17533780788553172
    val rand:  0.1812714785337448
    val onPol:  0.280253807703654

=== Epoch 20 ===
    train loss:  0.11787561832488268
    val rand:  0.16269859671592712
    val onPol:  0.3007146467765172

=== Epoch 30 ===
    train loss:  0.08754042964214566
    val rand:  0.15493306517601013
    val onPol:  0.3147350251674652

=== Epoch 39 ===
    train loss:  0.07178216650225651
    val rand:  0.1548091173171997
    val onPol:  0.32885970671971637
Training duration: 22.53 s

#####################################
performing on-policy MPC rollouts... iter  43
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.84788421573048
DONE TAKING  40  STEPS.
Total reward:  -492.1538578662641
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.67702845729709
DONE TAKING  40  STEPS.
Total reward:  -1178.6261280482793
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.50834683327826
DONE TAKING  40  STEPS.
Total reward:  -463.24077655062774
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.26015979270918
DONE TAKING  40  STEPS.
Total reward:  -347.05028131522243
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.994666627913382
DONE TAKING  40  STEPS.
Total reward:  -689.277392457849
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.37370985018461
DONE TAKING  40  STEPS.
Total reward:  -760.8370484958067
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.56763290233552
DONE TAKING  40  STEPS.
Total reward:  -349.8914092524116
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.56916843437565
DONE TAKING  40  STEPS.
Total reward:  -908.5062877350823
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -11.591695843541903
DONE TAKING  40  STEPS.
Total reward:  -389.6868803968069
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -24.307631547887496
DONE TAKING  40  STEPS.
Total reward:  -699.381786857501
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.382287879193434
DONE TAKING  40  STEPS.
Total reward:  -471.10813237224323
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.51719797337704
DONE TAKING  40  STEPS.
Total reward:  -510.97548359814743
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.003274183669166
DONE TAKING  40  STEPS.
Total reward:  -593.072170044652
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.34559872144177
DONE TAKING  40  STEPS.
Total reward:  -658.1517898452157
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.663747650718836
DONE TAKING  40  STEPS.
Total reward:  -637.52028455279
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.501804644361616
DONE TAKING  40  STEPS.
Total reward:  -521.5087796432739
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -16.381774887732124
DONE TAKING  40  STEPS.
Total reward:  -84.96936262832575
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.062827149576222
DONE TAKING  40  STEPS.
Total reward:  -483.17375999925434
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.061989485441465
DONE TAKING  40  STEPS.
Total reward:  -676.4516009189941
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.499594604187966
DONE TAKING  40  STEPS.
Total reward:  -512.1643875571245
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.50293506029234
DONE TAKING  40  STEPS.
Total reward:  -537.2036785538328
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -15.482673807254962
DONE TAKING  40  STEPS.
Total reward:  -526.7210837561657
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.968193604176946
DONE TAKING  40  STEPS.
Total reward:  -1003.2282820948371
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.253448447042622
DONE TAKING  40  STEPS.
Total reward:  -736.4677978863945
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.282544739067223
DONE TAKING  40  STEPS.
Total reward:  -974.626109272406
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.589002984061256
DONE TAKING  40  STEPS.
Total reward:  -379.89589086530924
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.791075630988583
DONE TAKING  40  STEPS.
Total reward:  -745.5397514113718
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.834495448383386
DONE TAKING  40  STEPS.
Total reward:  -627.7979512843955
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.918658764976293
DONE TAKING  40  STEPS.
Total reward:  -633.4679058310359
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.50757094605884
DONE TAKING  40  STEPS.
Total reward:  -728.2299912615712
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.555443245075978
DONE TAKING  40  STEPS.
Total reward:  -452.76341454008076
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.472896694930885
DONE TAKING  40  STEPS.
Total reward:  -606.8253993292342
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.952934060836853
DONE TAKING  40  STEPS.
Total reward:  -1064.7350321095132
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.849838572634248
DONE TAKING  40  STEPS.
Total reward:  -495.4004284323657
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.363386446736918
DONE TAKING  40  STEPS.
Total reward:  -752.1226624027621
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.900100364229985
DONE TAKING  40  STEPS.
Total reward:  -745.298807688315
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.45201906558585
DONE TAKING  40  STEPS.
Total reward:  -750.303816969622
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.414178503582086
DONE TAKING  40  STEPS.
Total reward:  -612.4349341631373
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.71444082960195
DONE TAKING  40  STEPS.
Total reward:  -473.01801530179955
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.163528062335423
DONE TAKING  40  STEPS.
Total reward:  -887.938859593907
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter43.ckpt
Iter: 44
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  44
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  16380
On pol:  28800
Prob shape:  (45180,)

=== Epoch 0 ===
    train loss:  0.41924694790081546
    val rand:  0.326308012008667
    val onPol:  0.3251396914323171

=== Epoch 10 ===
    train loss:  0.17665507170287045
    val rand:  0.17618930339813232
    val onPol:  0.2932852804660797

=== Epoch 20 ===
    train loss:  0.11921854833648964
    val rand:  0.1630294919013977
    val onPol:  0.3111071288585663

=== Epoch 30 ===
    train loss:  0.08750243400308219
    val rand:  0.15842781960964203
    val onPol:  0.3278379837671916

=== Epoch 39 ===
    train loss:  0.07175992336124182
    val rand:  0.15599095821380615
    val onPol:  0.34290241201718646
Training duration: 23.17 s

#####################################
performing on-policy MPC rollouts... iter  44
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.059103608123632
DONE TAKING  40  STEPS.
Total reward:  -647.3776026466527
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.682413889869203
DONE TAKING  40  STEPS.
Total reward:  -450.22939199916823
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.76428906791367
DONE TAKING  40  STEPS.
Total reward:  -531.0040288954232
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -19.95620475784859
DONE TAKING  40  STEPS.
Total reward:  -699.2646346971875
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.135483396236843
DONE TAKING  40  STEPS.
Total reward:  -238.43824519353456
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.50672652778868
DONE TAKING  40  STEPS.
Total reward:  -567.133656646801
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.850808635892502
DONE TAKING  40  STEPS.
Total reward:  -719.2192739241868
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -31.307547941921975
DONE TAKING  40  STEPS.
Total reward:  -863.804243903579
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.037696028785234
DONE TAKING  40  STEPS.
Total reward:  -388.9725001606429
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.4714973745248
DONE TAKING  40  STEPS.
Total reward:  -1019.4370458284025
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -18.93601385938721
DONE TAKING  40  STEPS.
Total reward:  -289.91430315879313
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.868030550141327
DONE TAKING  40  STEPS.
Total reward:  -686.7976286153188
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.77506023665207
DONE TAKING  40  STEPS.
Total reward:  -613.1240149645599
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.931808971069906
DONE TAKING  40  STEPS.
Total reward:  -644.2975924512111
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.848238954892746
DONE TAKING  40  STEPS.
Total reward:  -639.8304579944422
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.801190591194462
DONE TAKING  40  STEPS.
Total reward:  -877.145798389951
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.15290151153489
DONE TAKING  40  STEPS.
Total reward:  -603.6708616492092
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.445977677977012
DONE TAKING  40  STEPS.
Total reward:  -675.2891864268505
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.660500570715225
DONE TAKING  40  STEPS.
Total reward:  -406.1300223414596
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.13892197022661
DONE TAKING  40  STEPS.
Total reward:  -419.4994073142935
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.651806202522387
DONE TAKING  40  STEPS.
Total reward:  -1015.3606414553979
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.45270392448664
DONE TAKING  40  STEPS.
Total reward:  -368.5408687546447
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.87571379773145
DONE TAKING  40  STEPS.
Total reward:  -648.6289880659264
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.77639190114058
DONE TAKING  40  STEPS.
Total reward:  -755.22240888832
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.917545183823353
DONE TAKING  40  STEPS.
Total reward:  -479.1829873757613
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.184156215714466
DONE TAKING  40  STEPS.
Total reward:  -875.03339229984
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.818567026349207
DONE TAKING  40  STEPS.
Total reward:  -641.7988978195843
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -16.50346547520559
DONE TAKING  40  STEPS.
Total reward:  -525.7834248848427
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.503790217855805
DONE TAKING  40  STEPS.
Total reward:  -594.1159619988684
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.97941650434534
DONE TAKING  40  STEPS.
Total reward:  -899.8453987044085
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.75198901266996
DONE TAKING  40  STEPS.
Total reward:  -871.4550338162483
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.72739442640819
DONE TAKING  40  STEPS.
Total reward:  -784.8984799231438
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.665807946937676
DONE TAKING  40  STEPS.
Total reward:  -873.4526379087391
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.66204187989573
DONE TAKING  40  STEPS.
Total reward:  -410.4374719162557
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -26.436194714633068
DONE TAKING  40  STEPS.
Total reward:  -424.04736101552214
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -25.670177759504593
DONE TAKING  40  STEPS.
Total reward:  -568.441075842928
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.926120030557534
DONE TAKING  40  STEPS.
Total reward:  -952.6851559134323
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.947588295193675
DONE TAKING  40  STEPS.
Total reward:  -585.429266540897
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.283208102250075
DONE TAKING  40  STEPS.
Total reward:  -913.36927387297
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.33052699439928
DONE TAKING  40  STEPS.
Total reward:  -724.4289698035316
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter44.ckpt
Iter: 45
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  45
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  16575
On pol:  28800
Prob shape:  (45375,)

=== Epoch 0 ===
    train loss:  0.414139085533944
    val rand:  0.32578468322753906
    val onPol:  0.32295888662338257

=== Epoch 10 ===
    train loss:  0.1778433033349839
    val rand:  0.18546834588050842
    val onPol:  0.2918130358060201

=== Epoch 20 ===
    train loss:  0.12054436687718738
    val rand:  0.1611594259738922
    val onPol:  0.310105303923289

=== Epoch 30 ===
    train loss:  0.08842488276687535
    val rand:  0.15962016582489014
    val onPol:  0.3261726299921672

=== Epoch 39 ===
    train loss:  0.07262809625403448
    val rand:  0.15664803981781006
    val onPol:  0.3378051817417145
Training duration: 22.30 s

#####################################
performing on-policy MPC rollouts... iter  45
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.942225569112935
DONE TAKING  40  STEPS.
Total reward:  -494.61897887551595
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.75021736701852
DONE TAKING  40  STEPS.
Total reward:  -454.4806327846951
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.13441022704845
DONE TAKING  40  STEPS.
Total reward:  -703.1669491604381
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.95803273940607
DONE TAKING  40  STEPS.
Total reward:  -894.7460843451008
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.700537911348977
DONE TAKING  40  STEPS.
Total reward:  -579.4995932169708
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.773834797501145
DONE TAKING  40  STEPS.
Total reward:  -298.1763780634273
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.380540934526234
DONE TAKING  40  STEPS.
Total reward:  -1012.0239522243078
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -10.814125755107614
DONE TAKING  40  STEPS.
Total reward:  -444.1315280670525
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.352720356064495
DONE TAKING  40  STEPS.
Total reward:  -154.94504717724521
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.08015516652192
DONE TAKING  40  STEPS.
Total reward:  -932.2789893308186
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -31.112087270348212
DONE TAKING  40  STEPS.
Total reward:  -447.6190940436495
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.123690077081903
DONE TAKING  40  STEPS.
Total reward:  -783.6698959859964
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.944228988544722
DONE TAKING  40  STEPS.
Total reward:  -1036.7747236322084
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.81556878134422
DONE TAKING  40  STEPS.
Total reward:  -732.8855439133097
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.80528709489593
DONE TAKING  40  STEPS.
Total reward:  -326.4495417146867
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.126749641597034
DONE TAKING  40  STEPS.
Total reward:  -391.05194034271994
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.311999511084057
DONE TAKING  40  STEPS.
Total reward:  -770.0668392973587
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.879223056445475
DONE TAKING  40  STEPS.
Total reward:  -534.2279268671805
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.9543874533967
DONE TAKING  40  STEPS.
Total reward:  -1001.0501879363976
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.954915569992494
DONE TAKING  40  STEPS.
Total reward:  -560.8227068665402
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.685267506868136
DONE TAKING  40  STEPS.
Total reward:  -452.12468764558656
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.417408524257674
DONE TAKING  40  STEPS.
Total reward:  -848.9621446295043
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.53650001300636
DONE TAKING  40  STEPS.
Total reward:  -681.034967729999
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.89525361112993
DONE TAKING  40  STEPS.
Total reward:  -655.8386009296089
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.719653959376426
DONE TAKING  40  STEPS.
Total reward:  -624.7235314408267
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.50132676445365
DONE TAKING  40  STEPS.
Total reward:  -495.57390288097497
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.924306641468075
DONE TAKING  40  STEPS.
Total reward:  -865.0579579087838
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.909293730681227
DONE TAKING  40  STEPS.
Total reward:  -521.2301213495455
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.789692311417145
DONE TAKING  40  STEPS.
Total reward:  -933.9872667950846
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.60465102795084
DONE TAKING  40  STEPS.
Total reward:  -623.2467304949739
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.3036480852075
DONE TAKING  40  STEPS.
Total reward:  -832.609047390832
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.89315496178024
DONE TAKING  40  STEPS.
Total reward:  -502.2550046078438
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -13.584845617188364
DONE TAKING  40  STEPS.
Total reward:  -422.70168421716966
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.121077122266072
DONE TAKING  40  STEPS.
Total reward:  -759.9147253990773
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -9.219172053481087
DONE TAKING  40  STEPS.
Total reward:  -405.19726548578967
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.08406997686725
DONE TAKING  40  STEPS.
Total reward:  -653.8141238032406
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.712685048521834
DONE TAKING  40  STEPS.
Total reward:  -794.2366011862202
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -26.174073723451823
DONE TAKING  40  STEPS.
Total reward:  -888.6895575118851
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.280185384232958
DONE TAKING  40  STEPS.
Total reward:  -709.5667899980352
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.973498490644626
DONE TAKING  40  STEPS.
Total reward:  -602.2641662699226
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter45.ckpt
Iter: 46
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  46
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  16770
On pol:  28800
Prob shape:  (45570,)

=== Epoch 0 ===
    train loss:  0.4195051628552126
    val rand:  0.3298261761665344
    val onPol:  0.31923850377400714

=== Epoch 10 ===
    train loss:  0.18017421897207753
    val rand:  0.18151825666427612
    val onPol:  0.28056421875953674

=== Epoch 20 ===
    train loss:  0.12102446093987883
    val rand:  0.16428768634796143
    val onPol:  0.2951449453830719

=== Epoch 30 ===
    train loss:  0.08996071214421411
    val rand:  0.1519034057855606
    val onPol:  0.315443217754364

=== Epoch 39 ===
    train loss:  0.07354661906033419
    val rand:  0.15387988090515137
    val onPol:  0.32990309596061707
Training duration: 23.37 s

#####################################
performing on-policy MPC rollouts... iter  46
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.489780435446296
DONE TAKING  40  STEPS.
Total reward:  -638.6788301164854
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.270836605475328
DONE TAKING  40  STEPS.
Total reward:  -747.25122327207
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.521926092542003
DONE TAKING  40  STEPS.
Total reward:  -921.8543788211391
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.842074611165224
DONE TAKING  40  STEPS.
Total reward:  -762.812769379097
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.141326683836123
DONE TAKING  40  STEPS.
Total reward:  -688.2204470951255
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.734556348881547
DONE TAKING  40  STEPS.
Total reward:  -618.253265172575
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.3032070054466
DONE TAKING  40  STEPS.
Total reward:  -326.7260756271116
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.61453495346451
DONE TAKING  40  STEPS.
Total reward:  -363.2201887891381
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.616244760886243
DONE TAKING  40  STEPS.
Total reward:  -406.7388300624371
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.70370118023977
DONE TAKING  40  STEPS.
Total reward:  -639.704034812028
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.818733996054668
DONE TAKING  40  STEPS.
Total reward:  -962.1192338281909
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.863182827338797
DONE TAKING  40  STEPS.
Total reward:  -334.0347068983742
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -20.42151627855421
DONE TAKING  40  STEPS.
Total reward:  -395.3265238462759
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.465267369537457
DONE TAKING  40  STEPS.
Total reward:  -308.59528935207743
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.054738377107878
DONE TAKING  40  STEPS.
Total reward:  -1131.2018343628788
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -12.207732168577586
DONE TAKING  40  STEPS.
Total reward:  -327.0228452257296
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.64228209145935
DONE TAKING  40  STEPS.
Total reward:  -362.54218487587383
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.52194992160229
DONE TAKING  40  STEPS.
Total reward:  -291.50539775180755
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.369338191200335
DONE TAKING  40  STEPS.
Total reward:  -594.521088813044
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.830826207836463
DONE TAKING  40  STEPS.
Total reward:  -401.1454095555696
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.91709439568244
DONE TAKING  40  STEPS.
Total reward:  -1144.6874124839685
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.900555288529528
DONE TAKING  40  STEPS.
Total reward:  -806.8282402401601
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.166994245315134
DONE TAKING  40  STEPS.
Total reward:  -869.8687643928454
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.45458806314197
DONE TAKING  40  STEPS.
Total reward:  -616.8351556095322
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.45980739386473
DONE TAKING  40  STEPS.
Total reward:  -1041.3749772923304
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.12998061272669
DONE TAKING  40  STEPS.
Total reward:  -566.228636089877
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.318763701925903
DONE TAKING  40  STEPS.
Total reward:  -735.6993592487681
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.42207287892373
DONE TAKING  40  STEPS.
Total reward:  -436.24644331680355
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -19.022519386614086
DONE TAKING  40  STEPS.
Total reward:  -273.36274249211783
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.218081841273733
DONE TAKING  40  STEPS.
Total reward:  -726.2546944235921
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.792856962673458
DONE TAKING  40  STEPS.
Total reward:  26.19469546195781
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.235820254977966
DONE TAKING  40  STEPS.
Total reward:  -452.5730938785894
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.53453181909458
DONE TAKING  40  STEPS.
Total reward:  -1058.845691081879
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -22.61039095935294
DONE TAKING  40  STEPS.
Total reward:  -837.8822370495842
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.94287922969681
DONE TAKING  40  STEPS.
Total reward:  -608.9076969352078
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.61215167561345
DONE TAKING  40  STEPS.
Total reward:  -729.6011991932279
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.152750832429575
DONE TAKING  40  STEPS.
Total reward:  -648.9383875899771
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.619470758694295
DONE TAKING  40  STEPS.
Total reward:  -340.7044685485803
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.48457507413061
DONE TAKING  40  STEPS.
Total reward:  -694.3582309736306
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.47382590205418
DONE TAKING  40  STEPS.
Total reward:  -659.223153659971
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter46.ckpt
Iter: 47
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  47
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  16965
On pol:  28800
Prob shape:  (45765,)

=== Epoch 0 ===
    train loss:  0.41705722788746435
    val rand:  0.32852062582969666
    val onPol:  0.3149350980917613

=== Epoch 10 ===
    train loss:  0.17711430017867785
    val rand:  0.18338094651699066
    val onPol:  0.2793036500612895

=== Epoch 20 ===
    train loss:  0.12029262540045749
    val rand:  0.1643287092447281
    val onPol:  0.2925032873948415

=== Epoch 30 ===
    train loss:  0.09038679058967011
    val rand:  0.15550652146339417
    val onPol:  0.31011896332105

=== Epoch 39 ===
    train loss:  0.07333853623170532
    val rand:  0.15268194675445557
    val onPol:  0.3243071734905243
Training duration: 22.21 s

#####################################
performing on-policy MPC rollouts... iter  47
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.182463419299324
DONE TAKING  40  STEPS.
Total reward:  -728.5937829128275
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.862197060897323
DONE TAKING  40  STEPS.
Total reward:  -786.5986563061783
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.00138239297971
DONE TAKING  40  STEPS.
Total reward:  -401.110090164235
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.375742344762617
DONE TAKING  40  STEPS.
Total reward:  -762.5401779447236
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -23.488650812140545
DONE TAKING  40  STEPS.
Total reward:  -540.0260327741956
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.430530889000057
DONE TAKING  40  STEPS.
Total reward:  -902.6913801650729
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.170089717020918
DONE TAKING  40  STEPS.
Total reward:  -467.8416625841187
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.159598405606047
DONE TAKING  40  STEPS.
Total reward:  -596.9577487035347
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.458492618185005
DONE TAKING  40  STEPS.
Total reward:  -336.7942857736057
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.661792455266493
DONE TAKING  40  STEPS.
Total reward:  -570.701087774669
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.514058752500997
DONE TAKING  40  STEPS.
Total reward:  -487.8016225565472
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.68651953685296
DONE TAKING  40  STEPS.
Total reward:  -852.7134319656814
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.152544561120504
DONE TAKING  40  STEPS.
Total reward:  -684.3746952101541
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.018551803037944
DONE TAKING  40  STEPS.
Total reward:  -547.519417775671
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.860479835291972
DONE TAKING  40  STEPS.
Total reward:  -1101.7802120844121
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -11.738423245740869
DONE TAKING  40  STEPS.
Total reward:  -291.51472180795224
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.236364876265878
DONE TAKING  40  STEPS.
Total reward:  -692.5090249140295
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.09047828614562
DONE TAKING  40  STEPS.
Total reward:  -951.8148596347353
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.609656144652877
DONE TAKING  40  STEPS.
Total reward:  -474.4640474448928
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.2026402662534
DONE TAKING  40  STEPS.
Total reward:  -624.9154800166491
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.959125490884016
DONE TAKING  40  STEPS.
Total reward:  -344.80428975391334
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -16.191842822752637
DONE TAKING  40  STEPS.
Total reward:  -180.6891504435528
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -10.14056311849602
DONE TAKING  40  STEPS.
Total reward:  -293.0237044522765
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.200765540450945
DONE TAKING  40  STEPS.
Total reward:  -659.8107986322101
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.18232590025552
DONE TAKING  40  STEPS.
Total reward:  -514.7322641617226
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.030208662748507
DONE TAKING  40  STEPS.
Total reward:  -647.2942496974255
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.143093905990543
DONE TAKING  40  STEPS.
Total reward:  -636.614136290346
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -31.245544280520345
DONE TAKING  40  STEPS.
Total reward:  -1025.7055940794921
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.048157789201326
DONE TAKING  40  STEPS.
Total reward:  -868.4481669272957
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.396002906197882
DONE TAKING  40  STEPS.
Total reward:  -887.6339960669648
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.189403479994446
DONE TAKING  40  STEPS.
Total reward:  -956.1673970079645
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.18484798697984
DONE TAKING  40  STEPS.
Total reward:  -337.79329479590615
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.536763965656593
DONE TAKING  40  STEPS.
Total reward:  -332.5361519344186
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -11.828040465967044
DONE TAKING  40  STEPS.
Total reward:  -335.25345437573367
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.52040285439498
DONE TAKING  40  STEPS.
Total reward:  -562.6902844215917
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.395260030904495
DONE TAKING  40  STEPS.
Total reward:  -898.457998378777
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.57476899972081
DONE TAKING  40  STEPS.
Total reward:  -115.05764000212432
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.341681107426783
DONE TAKING  40  STEPS.
Total reward:  -650.1474819965156
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.06333638364937
DONE TAKING  40  STEPS.
Total reward:  -426.2875931608629
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.65214816389538
DONE TAKING  40  STEPS.
Total reward:  -440.51334917306013
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter47.ckpt
Iter: 48
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  48
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  17160
On pol:  28800
Prob shape:  (45960,)

=== Epoch 0 ===
    train loss:  0.4178932737768366
    val rand:  0.3274264335632324
    val onPol:  0.31260085105895996

=== Epoch 10 ===
    train loss:  0.1784059108977907
    val rand:  0.18994012475013733
    val onPol:  0.2774403691291809

=== Epoch 20 ===
    train loss:  0.11925840997294093
    val rand:  0.16479109227657318
    val onPol:  0.29365311066309613

=== Epoch 30 ===
    train loss:  0.08929208214028497
    val rand:  0.1576956808567047
    val onPol:  0.3122560977935791

=== Epoch 39 ===
    train loss:  0.07320067253005638
    val rand:  0.1565321683883667
    val onPol:  0.3219637374083201
Training duration: 23.45 s

#####################################
performing on-policy MPC rollouts... iter  48
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.25227154859415
DONE TAKING  40  STEPS.
Total reward:  -492.6447103531814
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.408563177364762
DONE TAKING  40  STEPS.
Total reward:  -673.7084792704417
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.11405528020903
DONE TAKING  40  STEPS.
Total reward:  -387.4283767584852
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.42643525916976
DONE TAKING  40  STEPS.
Total reward:  -719.6715653111984
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.545742444878556
DONE TAKING  40  STEPS.
Total reward:  -559.4637790793902
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.579945405242505
DONE TAKING  40  STEPS.
Total reward:  -1011.9935773977545
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.930028081192525
DONE TAKING  40  STEPS.
Total reward:  -1051.6315045493757
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.576098128334372
DONE TAKING  40  STEPS.
Total reward:  -655.6495004917697
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.874148609363502
DONE TAKING  40  STEPS.
Total reward:  -490.42517399221464
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.51254171880371
DONE TAKING  40  STEPS.
Total reward:  -676.2962546391852
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.87361381587151
DONE TAKING  40  STEPS.
Total reward:  -786.4147133534105
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.154665927232543
DONE TAKING  40  STEPS.
Total reward:  -25.144902719955255
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -20.744114203714066
DONE TAKING  40  STEPS.
Total reward:  -772.3013306708475
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -13.80843503377938
DONE TAKING  40  STEPS.
Total reward:  -421.44370898667216
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.78586350276288
DONE TAKING  40  STEPS.
Total reward:  -868.9237435409028
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.519888764379466
DONE TAKING  40  STEPS.
Total reward:  -657.6687972192052
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.210216074576316
DONE TAKING  40  STEPS.
Total reward:  -897.2919963566496
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.10388009518621
DONE TAKING  40  STEPS.
Total reward:  -540.0060773038958
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.597479632731343
DONE TAKING  40  STEPS.
Total reward:  -716.185244485842
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -13.451842453966831
DONE TAKING  40  STEPS.
Total reward:  -313.29246091094626
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.19226292072093
DONE TAKING  40  STEPS.
Total reward:  -462.04179976375656
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.705384093732576
DONE TAKING  40  STEPS.
Total reward:  -766.8775114745467
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.786747146518593
DONE TAKING  40  STEPS.
Total reward:  -926.1799033106689
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -13.182304082544212
DONE TAKING  40  STEPS.
Total reward:  -348.2998852885088
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.259907247253064
DONE TAKING  40  STEPS.
Total reward:  -833.7416357995357
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -16.68424739558465
DONE TAKING  40  STEPS.
Total reward:  -576.8434964726233
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.89521371106046
DONE TAKING  40  STEPS.
Total reward:  -568.8155969584857
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.442406999693887
DONE TAKING  40  STEPS.
Total reward:  -794.8631549400388
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.207067614638255
DONE TAKING  40  STEPS.
Total reward:  -659.3674693158349
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -31.072722764231155
DONE TAKING  40  STEPS.
Total reward:  -607.0053904595787
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -19.95335746160611
DONE TAKING  40  STEPS.
Total reward:  -604.5839607239858
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -18.797356181739556
DONE TAKING  40  STEPS.
Total reward:  -558.155628539451
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.872860685480052
DONE TAKING  40  STEPS.
Total reward:  -546.9173356793414
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.350131928370683
DONE TAKING  40  STEPS.
Total reward:  -615.8221283498187
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.316350327373033
DONE TAKING  40  STEPS.
Total reward:  -1083.7356032385285
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.36958803727601
DONE TAKING  40  STEPS.
Total reward:  -525.6926362971835
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -29.795818543007723
DONE TAKING  40  STEPS.
Total reward:  -773.438458868789
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.655283029752113
DONE TAKING  40  STEPS.
Total reward:  -937.2327993884459
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.284300340599724
DONE TAKING  40  STEPS.
Total reward:  -918.0939160551939
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.94863445695527
DONE TAKING  40  STEPS.
Total reward:  -813.452647963886
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter48.ckpt
Iter: 49
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  49
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  17355
On pol:  28800
Prob shape:  (46155,)

=== Epoch 0 ===
    train loss:  0.413840647538503
    val rand:  0.31504809856414795
    val onPol:  0.3203194936116536

=== Epoch 10 ===
    train loss:  0.17836250050200356
    val rand:  0.19148105382919312
    val onPol:  0.2856624523798625

=== Epoch 20 ===
    train loss:  0.11939128388961157
    val rand:  0.16096797585487366
    val onPol:  0.3043878177801768

=== Epoch 30 ===
    train loss:  0.08844165719217724
    val rand:  0.15473894774913788
    val onPol:  0.32397976517677307

=== Epoch 39 ===
    train loss:  0.07189763486385345
    val rand:  0.15078853070735931
    val onPol:  0.3350884020328522
Training duration: 22.51 s

#####################################
performing on-policy MPC rollouts... iter  49
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.573488635601933
DONE TAKING  40  STEPS.
Total reward:  -473.4668093537467
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -16.964397551691178
DONE TAKING  40  STEPS.
Total reward:  -600.9923870885272
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.458336931415758
DONE TAKING  40  STEPS.
Total reward:  -245.7443778567181
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -14.833163642900175
DONE TAKING  40  STEPS.
Total reward:  -192.83166983742998
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.042233643233907
DONE TAKING  40  STEPS.
Total reward:  -1113.3504002212635
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.67456496597334
DONE TAKING  40  STEPS.
Total reward:  -479.4342777094279
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.42481545509835
DONE TAKING  40  STEPS.
Total reward:  -543.6544463499754
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.885378674080705
DONE TAKING  40  STEPS.
Total reward:  -767.2742825187465
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -16.252541756719722
DONE TAKING  40  STEPS.
Total reward:  -563.8574948633902
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.783096169998615
DONE TAKING  40  STEPS.
Total reward:  -661.829968940263
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.901475020297333
DONE TAKING  40  STEPS.
Total reward:  -311.599674942763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.195087807374374
DONE TAKING  40  STEPS.
Total reward:  -667.4993326606068
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.618234234853315
DONE TAKING  40  STEPS.
Total reward:  -638.8692889745303
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.781394675696525
DONE TAKING  40  STEPS.
Total reward:  -286.68329796447676
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.717350001809436
DONE TAKING  40  STEPS.
Total reward:  -941.7350299820557
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.99776213340691
DONE TAKING  40  STEPS.
Total reward:  -271.9377763241426
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.401751192260576
DONE TAKING  40  STEPS.
Total reward:  -669.7015823421923
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.392789858583477
DONE TAKING  40  STEPS.
Total reward:  -271.6692951828698
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.52035299950896
DONE TAKING  40  STEPS.
Total reward:  -678.2504194049546
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.866359286971594
DONE TAKING  40  STEPS.
Total reward:  -562.9028972350592
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.062926255830565
DONE TAKING  40  STEPS.
Total reward:  -778.5819326849337
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.117291953943024
DONE TAKING  40  STEPS.
Total reward:  -318.95622385564343
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.624627822911684
DONE TAKING  40  STEPS.
Total reward:  -863.5751843110421
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -13.198604461074552
DONE TAKING  40  STEPS.
Total reward:  -282.88411943077085
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.669306541066064
DONE TAKING  40  STEPS.
Total reward:  -348.2867399941352
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -12.3740798675484
DONE TAKING  40  STEPS.
Total reward:  -367.5431920059218
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.773778518615927
DONE TAKING  40  STEPS.
Total reward:  -645.2940085499779
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.18845059548076
DONE TAKING  40  STEPS.
Total reward:  -699.4465269071195
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.60092631759689
DONE TAKING  40  STEPS.
Total reward:  -1138.8706738320236
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.568949959626735
DONE TAKING  40  STEPS.
Total reward:  -494.9407965384974
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.773196517364084
DONE TAKING  40  STEPS.
Total reward:  -913.8658178007646
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.912402143940383
DONE TAKING  40  STEPS.
Total reward:  -467.92652434717473
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.586649805588003
DONE TAKING  40  STEPS.
Total reward:  -400.01222088754497
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.675379991623913
DONE TAKING  40  STEPS.
Total reward:  -451.12646994092216
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.33482026069932
DONE TAKING  40  STEPS.
Total reward:  -1004.5856626368208
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.380019589499344
DONE TAKING  40  STEPS.
Total reward:  -843.9213118234654
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.441883944439528
DONE TAKING  40  STEPS.
Total reward:  -371.7342706852296
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.51626892826897
DONE TAKING  40  STEPS.
Total reward:  -794.9244042177418
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.25177425132739
DONE TAKING  40  STEPS.
Total reward:  -796.6259397424488
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.65763157799516
DONE TAKING  40  STEPS.
Total reward:  -870.9566889329337
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter49.ckpt
Iter: 50
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  50
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  17550
On pol:  28800
Prob shape:  (46350,)

=== Epoch 0 ===
    train loss:  0.41476563016573587
    val rand:  0.32037705183029175
    val onPol:  0.32703346014022827

=== Epoch 10 ===
    train loss:  0.17735160572661293
    val rand:  0.1864110678434372
    val onPol:  0.2875264932711919

=== Epoch 20 ===
    train loss:  0.11971592861745092
    val rand:  0.16146394610404968
    val onPol:  0.30443984270095825

=== Epoch 30 ===
    train loss:  0.08959107448657354
    val rand:  0.15548650920391083
    val onPol:  0.323294460773468

=== Epoch 39 ===
    train loss:  0.07255129607187377
    val rand:  0.15601210296154022
    val onPol:  0.33828603227933246
Training duration: 23.66 s

#####################################
performing on-policy MPC rollouts... iter  50
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.672175429047062
DONE TAKING  40  STEPS.
Total reward:  -745.8447320311482
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.357791758379875
DONE TAKING  40  STEPS.
Total reward:  -899.6519842176748
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.8996124864099
DONE TAKING  40  STEPS.
Total reward:  -1132.5370864672898
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.217007502182607
DONE TAKING  40  STEPS.
Total reward:  -740.9060328437375
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.063416874114694
DONE TAKING  40  STEPS.
Total reward:  -872.2553737539748
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.41524461356456
DONE TAKING  40  STEPS.
Total reward:  -593.1586018164975
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.16777249594816
DONE TAKING  40  STEPS.
Total reward:  -358.547342764172
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.249819458717177
DONE TAKING  40  STEPS.
Total reward:  -676.2182642948882
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.235971238682474
DONE TAKING  40  STEPS.
Total reward:  -716.6189741324367
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.474573493654354
DONE TAKING  40  STEPS.
Total reward:  -330.8587026546993
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.188809076058444
DONE TAKING  40  STEPS.
Total reward:  -760.0709649009536
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.29088576928708
DONE TAKING  40  STEPS.
Total reward:  -144.0563160844097
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.83059486186172
DONE TAKING  40  STEPS.
Total reward:  -473.3963501017077
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -15.847668366821278
DONE TAKING  40  STEPS.
Total reward:  -519.4031024973025
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -20.827869627512605
DONE TAKING  40  STEPS.
Total reward:  -643.9420474318613
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -31.284649503596317
DONE TAKING  40  STEPS.
Total reward:  -722.9962558832759
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.66675061704609
DONE TAKING  40  STEPS.
Total reward:  -726.3727637326074
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.564520909887932
DONE TAKING  40  STEPS.
Total reward:  -860.724220117467
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.387770810170046
DONE TAKING  40  STEPS.
Total reward:  -181.8993531592616
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -12.015658939800971
DONE TAKING  40  STEPS.
Total reward:  -172.0582516414701
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.97401913880498
DONE TAKING  40  STEPS.
Total reward:  -754.57566592421
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.093743352015615
DONE TAKING  40  STEPS.
Total reward:  -510.5486549217667
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.959817044967448
DONE TAKING  40  STEPS.
Total reward:  -421.86725313099583
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -13.669371200716538
DONE TAKING  40  STEPS.
Total reward:  -428.69170083100073
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.831014302318792
DONE TAKING  40  STEPS.
Total reward:  -731.0642114318617
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.94726317942827
DONE TAKING  40  STEPS.
Total reward:  -431.7715138740808
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.849829225003347
DONE TAKING  40  STEPS.
Total reward:  -891.38520440935
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.286983845708765
DONE TAKING  40  STEPS.
Total reward:  -878.361461759375
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.985201020890702
DONE TAKING  40  STEPS.
Total reward:  -518.3188694110978
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -13.844680690512954
DONE TAKING  40  STEPS.
Total reward:  10.262445548483754
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -26.60686014526072
DONE TAKING  40  STEPS.
Total reward:  -503.4510067275166
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.156274381998625
DONE TAKING  40  STEPS.
Total reward:  -426.11062556631447
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -12.247743732801435
DONE TAKING  40  STEPS.
Total reward:  -361.0124748667946
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.530598938161127
DONE TAKING  40  STEPS.
Total reward:  -1030.509013130811
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -13.331674328654461
DONE TAKING  40  STEPS.
Total reward:  -429.4800639194855
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.11608591867443
DONE TAKING  40  STEPS.
Total reward:  -319.6816283493997
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.34023576018469
DONE TAKING  40  STEPS.
Total reward:  -549.6393320850442
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -15.841759558829436
DONE TAKING  40  STEPS.
Total reward:  -425.04554172961025
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -13.953926068883169
DONE TAKING  40  STEPS.
Total reward:  -411.0717239968111
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.983252822622404
DONE TAKING  40  STEPS.
Total reward:  -373.28524562656895
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter50.ckpt
Iter: 51
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  51
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  17745
On pol:  28800
Prob shape:  (46545,)

=== Epoch 0 ===
    train loss:  0.4159147712919447
    val rand:  0.3247668147087097
    val onPol:  0.33085817098617554

=== Epoch 10 ===
    train loss:  0.1762435851825608
    val rand:  0.18581822514533997
    val onPol:  0.29241833090782166

=== Epoch 20 ===
    train loss:  0.1182452980015013
    val rand:  0.1560937464237213
    val onPol:  0.3086005548636119

=== Epoch 30 ===
    train loss:  0.08879664250546032
    val rand:  0.15149229764938354
    val onPol:  0.32645053664843243

=== Epoch 39 ===
    train loss:  0.07234610981411405
    val rand:  0.153325155377388
    val onPol:  0.34050706028938293
Training duration: 22.57 s

#####################################
performing on-policy MPC rollouts... iter  51
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.5029935789321
DONE TAKING  40  STEPS.
Total reward:  -556.6020768636623
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.177853438250505
DONE TAKING  40  STEPS.
Total reward:  -647.3511185324079
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.467574639218864
DONE TAKING  40  STEPS.
Total reward:  -682.7166714924335
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.42877552409357
DONE TAKING  40  STEPS.
Total reward:  -815.0179595250112
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.331083239527707
DONE TAKING  40  STEPS.
Total reward:  -661.2779122849446
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.509144417647093
DONE TAKING  40  STEPS.
Total reward:  -368.8734570485535
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.406121743058208
DONE TAKING  40  STEPS.
Total reward:  -478.2598257871727
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.7955115296592
DONE TAKING  40  STEPS.
Total reward:  -427.5592189979022
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.807674212619318
DONE TAKING  40  STEPS.
Total reward:  -580.9842023556524
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.50364980374452
DONE TAKING  40  STEPS.
Total reward:  -521.9777012195556
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.983586975337293
DONE TAKING  40  STEPS.
Total reward:  -900.5467215787331
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.528365772631183
DONE TAKING  40  STEPS.
Total reward:  -461.6880473162056
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.59140057316852
DONE TAKING  40  STEPS.
Total reward:  -93.47171914763139
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.87418948493444
DONE TAKING  40  STEPS.
Total reward:  -567.9747722865955
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.876237253430688
DONE TAKING  40  STEPS.
Total reward:  -477.191210993178
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.328403381395482
DONE TAKING  40  STEPS.
Total reward:  -666.5065385922013
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.817079361737663
DONE TAKING  40  STEPS.
Total reward:  -18.325141399651756
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.766897386601165
DONE TAKING  40  STEPS.
Total reward:  -427.55895056301205
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.536604458522795
DONE TAKING  40  STEPS.
Total reward:  -680.5897391053114
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -15.75713555763362
DONE TAKING  40  STEPS.
Total reward:  -465.83145526973607
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.363422100357074
DONE TAKING  40  STEPS.
Total reward:  -557.8832779803624
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -15.586359876347387
DONE TAKING  40  STEPS.
Total reward:  -337.2726905923046
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.361086277518858
DONE TAKING  40  STEPS.
Total reward:  -548.8476726088604
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.345755798537212
DONE TAKING  40  STEPS.
Total reward:  -292.68653096868593
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.68220185357389
DONE TAKING  40  STEPS.
Total reward:  -872.1904689449583
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.618385375157416
DONE TAKING  40  STEPS.
Total reward:  -800.8533687051383
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.10614003192841
DONE TAKING  40  STEPS.
Total reward:  -411.5459483849574
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.053962542938116
DONE TAKING  40  STEPS.
Total reward:  -734.6009360652747
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.249392067530366
DONE TAKING  40  STEPS.
Total reward:  -507.8774752213981
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.761321342897958
DONE TAKING  40  STEPS.
Total reward:  -734.7967680916762
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -16.60289709475107
DONE TAKING  40  STEPS.
Total reward:  -473.78182687661825
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.675729257370776
DONE TAKING  40  STEPS.
Total reward:  -945.6969145692208
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.596147099248245
DONE TAKING  40  STEPS.
Total reward:  -922.3366482735503
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.860933847805054
DONE TAKING  40  STEPS.
Total reward:  -950.5989721881419
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.59565397425555
DONE TAKING  40  STEPS.
Total reward:  -483.9941233900375
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.29305192215801
DONE TAKING  40  STEPS.
Total reward:  -900.9727497521479
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.440923986788302
DONE TAKING  40  STEPS.
Total reward:  -682.9052302164258
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.652168909923205
DONE TAKING  40  STEPS.
Total reward:  -744.1511432392235
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.86704086233868
DONE TAKING  40  STEPS.
Total reward:  -826.9794836641512
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.595677256016998
DONE TAKING  40  STEPS.
Total reward:  -965.8001834414192
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter51.ckpt
Iter: 52
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  52
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  17940
On pol:  28800
Prob shape:  (46740,)

=== Epoch 0 ===
    train loss:  0.41506634243242035
    val rand:  0.32787370681762695
    val onPol:  0.3117291331291199

=== Epoch 10 ===
    train loss:  0.17624680010172036
    val rand:  0.1846369355916977
    val onPol:  0.273846556742986

=== Epoch 20 ===
    train loss:  0.12021114906439415
    val rand:  0.16268643736839294
    val onPol:  0.28922786315282184

=== Epoch 30 ===
    train loss:  0.09107277386791103
    val rand:  0.15751641988754272
    val onPol:  0.3049786686897278

=== Epoch 39 ===
    train loss:  0.0744038632774091
    val rand:  0.1545265018939972
    val onPol:  0.3203257620334625
Training duration: 23.89 s

#####################################
performing on-policy MPC rollouts... iter  52
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.083091248651566
DONE TAKING  40  STEPS.
Total reward:  -536.7454325044015
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.645542738908514
DONE TAKING  40  STEPS.
Total reward:  -752.8210954157823
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.229264297630337
DONE TAKING  40  STEPS.
Total reward:  -136.49840499270158
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.03536077588651
DONE TAKING  40  STEPS.
Total reward:  -106.61163219848214
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.284160311884285
DONE TAKING  40  STEPS.
Total reward:  -251.08766599961552
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.390731947791064
DONE TAKING  40  STEPS.
Total reward:  -562.8978349970681
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.863824000131707
DONE TAKING  40  STEPS.
Total reward:  -897.4445771112295
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -10.773916170122494
DONE TAKING  40  STEPS.
Total reward:  -391.11019256497565
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.86339272461467
DONE TAKING  40  STEPS.
Total reward:  -754.8217542304064
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.021047503337705
DONE TAKING  40  STEPS.
Total reward:  -642.5898246588839
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.90221090343306
DONE TAKING  40  STEPS.
Total reward:  -498.5116323736399
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.047386700433904
DONE TAKING  40  STEPS.
Total reward:  -687.1526935634465
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.153521325311488
DONE TAKING  40  STEPS.
Total reward:  -676.0036901247647
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.819883256510096
DONE TAKING  40  STEPS.
Total reward:  -932.3713524907356
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.168531876172704
DONE TAKING  40  STEPS.
Total reward:  -1146.8342145405288
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.976034697590556
DONE TAKING  40  STEPS.
Total reward:  -416.69818440646077
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.175589438802543
DONE TAKING  40  STEPS.
Total reward:  -791.9534223293833
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -20.92033062906519
DONE TAKING  40  STEPS.
Total reward:  -313.44884082039846
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.977213498549652
DONE TAKING  40  STEPS.
Total reward:  -700.178448637853
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -18.47444592507656
DONE TAKING  40  STEPS.
Total reward:  -511.38751429594606
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -19.984114528388957
DONE TAKING  40  STEPS.
Total reward:  -432.7942186462367
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -16.07211308183327
DONE TAKING  40  STEPS.
Total reward:  -542.7574847162304
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -31.303932060285582
DONE TAKING  40  STEPS.
Total reward:  -649.5387142112685
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -13.40544945709097
DONE TAKING  40  STEPS.
Total reward:  -349.6302782205297
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.787299724689138
DONE TAKING  40  STEPS.
Total reward:  -815.6016557910924
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.81200700980793
DONE TAKING  40  STEPS.
Total reward:  -388.5472405310868
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.938008329495087
DONE TAKING  40  STEPS.
Total reward:  -452.2561186914725
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.61621524289002
DONE TAKING  40  STEPS.
Total reward:  -1039.7793411838184
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.328378899518984
DONE TAKING  40  STEPS.
Total reward:  -691.4770128920246
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.089793900070738
DONE TAKING  40  STEPS.
Total reward:  -1030.1587999330443
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.953387984224083
DONE TAKING  40  STEPS.
Total reward:  -600.5276275521281
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.452744818476532
DONE TAKING  40  STEPS.
Total reward:  -950.3188589287764
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.001581010954986
DONE TAKING  40  STEPS.
Total reward:  -399.66133984504296
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.95373283823101
DONE TAKING  40  STEPS.
Total reward:  -361.48695856804545
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.71761957100016
DONE TAKING  40  STEPS.
Total reward:  -389.23334585728855
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.04773938422367
DONE TAKING  40  STEPS.
Total reward:  -961.5044095491216
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.736600434377053
DONE TAKING  40  STEPS.
Total reward:  -594.5661265209245
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.51687308890368
DONE TAKING  40  STEPS.
Total reward:  -283.28217095990595
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.258420247277838
DONE TAKING  40  STEPS.
Total reward:  -406.5320898280586
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.744673364432202
DONE TAKING  40  STEPS.
Total reward:  26.803380224113464
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter52.ckpt
Iter: 53
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  53
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  18135
On pol:  28800
Prob shape:  (46935,)

=== Epoch 0 ===
    train loss:  0.41198708493630964
    val rand:  0.328153133392334
    val onPol:  0.3193679352601369

=== Epoch 10 ===
    train loss:  0.1759067971955289
    val rand:  0.17906370759010315
    val onPol:  0.2875388463338216

=== Epoch 20 ===
    train loss:  0.11833671791540397
    val rand:  0.15978756546974182
    val onPol:  0.3058465321858724

=== Epoch 30 ===
    train loss:  0.08845896257476492
    val rand:  0.15495170652866364
    val onPol:  0.31946443518002826

=== Epoch 39 ===
    train loss:  0.07242546205992227
    val rand:  0.15265703201293945
    val onPol:  0.33350608746210736
Training duration: 22.74 s

#####################################
performing on-policy MPC rollouts... iter  53
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -13.042735546987691
DONE TAKING  40  STEPS.
Total reward:  -217.9737710576378
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.602282391037487
DONE TAKING  40  STEPS.
Total reward:  -683.1307504413281
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.236282938123647
DONE TAKING  40  STEPS.
Total reward:  -290.39965178197434
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.60831710774748
DONE TAKING  40  STEPS.
Total reward:  -608.9506437325448
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.638135636258603
DONE TAKING  40  STEPS.
Total reward:  -467.38212738521895
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.348255618557605
DONE TAKING  40  STEPS.
Total reward:  -347.30802490096966
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.92440271327846
DONE TAKING  40  STEPS.
Total reward:  -731.472745509797
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.650955130438813
DONE TAKING  40  STEPS.
Total reward:  -679.0796961279709
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -15.807778488352888
DONE TAKING  40  STEPS.
Total reward:  -699.9495506411401
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.381773191903072
DONE TAKING  40  STEPS.
Total reward:  -779.993964992525
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.983826348918218
DONE TAKING  40  STEPS.
Total reward:  -907.3091716013013
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -12.645720661446164
DONE TAKING  40  STEPS.
Total reward:  -423.04647003661626
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.17645931097742
DONE TAKING  40  STEPS.
Total reward:  -106.96432537481257
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.328515984687964
DONE TAKING  40  STEPS.
Total reward:  -1022.0156669083703
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -21.76279502914705
DONE TAKING  40  STEPS.
Total reward:  -353.5671973833884
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.082362560997716
DONE TAKING  40  STEPS.
Total reward:  -946.3133948923047
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.37629510842793
DONE TAKING  40  STEPS.
Total reward:  -386.76554655985893
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -9.756974929004823
DONE TAKING  40  STEPS.
Total reward:  151.1702348122663
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.51878111433222
DONE TAKING  40  STEPS.
Total reward:  -619.7547370040604
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.84109883351237
DONE TAKING  40  STEPS.
Total reward:  -655.7940320442151
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.238700803674483
DONE TAKING  40  STEPS.
Total reward:  -584.0568392686203
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -20.47483173892254
DONE TAKING  40  STEPS.
Total reward:  -703.6683106295309
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.583656726140603
DONE TAKING  40  STEPS.
Total reward:  -792.1389993972535
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.99601442469107
DONE TAKING  40  STEPS.
Total reward:  -935.5697862206335
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.82972569425295
DONE TAKING  40  STEPS.
Total reward:  -629.5432093345358
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.86156682044504
DONE TAKING  40  STEPS.
Total reward:  -910.2800269926893
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.16804580234487
DONE TAKING  40  STEPS.
Total reward:  -911.164053554886
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.394560173466925
DONE TAKING  40  STEPS.
Total reward:  -777.2750117116684
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.7421542293731
DONE TAKING  40  STEPS.
Total reward:  -642.4424014504331
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -16.35442701673761
DONE TAKING  40  STEPS.
Total reward:  -438.7428750184669
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.555826899444245
DONE TAKING  40  STEPS.
Total reward:  -533.5939176609699
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.462680587664174
DONE TAKING  40  STEPS.
Total reward:  -338.5577707724441
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.418711366956956
DONE TAKING  40  STEPS.
Total reward:  -412.1386958180555
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.692387598602174
DONE TAKING  40  STEPS.
Total reward:  -532.3233428159838
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.12433903708314
DONE TAKING  40  STEPS.
Total reward:  -701.8058351429727
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -31.144003241177526
DONE TAKING  40  STEPS.
Total reward:  -673.9989495995827
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.28254308033254
DONE TAKING  40  STEPS.
Total reward:  -704.5610965211042
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.554735098368276
DONE TAKING  40  STEPS.
Total reward:  -778.4170525362507
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.64087904147754
DONE TAKING  40  STEPS.
Total reward:  -874.4442952994195
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.675453296036498
DONE TAKING  40  STEPS.
Total reward:  -440.35211386781884
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter53.ckpt
Iter: 54
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  54
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  18330
On pol:  28800
Prob shape:  (47130,)

=== Epoch 0 ===
    train loss:  0.4180948517244795
    val rand:  0.3235699534416199
    val onPol:  0.3238021830717723

=== Epoch 10 ===
    train loss:  0.17876512071360712
    val rand:  0.18641608953475952
    val onPol:  0.293567955493927

=== Epoch 20 ===
    train loss:  0.12090834432645985
    val rand:  0.15803183615207672
    val onPol:  0.3068649073441823

=== Epoch 30 ===
    train loss:  0.09076777797030366
    val rand:  0.1587434858083725
    val onPol:  0.3281894326210022

=== Epoch 39 ===
    train loss:  0.07452995265307634
    val rand:  0.14896000921726227
    val onPol:  0.3401668469111125
Training duration: 24.28 s

#####################################
performing on-policy MPC rollouts... iter  54
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.271526209234988
DONE TAKING  40  STEPS.
Total reward:  -661.0612916132726
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.681502093583205
DONE TAKING  40  STEPS.
Total reward:  -637.8108838102323
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -13.848560920516803
DONE TAKING  40  STEPS.
Total reward:  -325.1014708811663
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.19589199287791
DONE TAKING  40  STEPS.
Total reward:  -70.13210777999655
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.777351578494528
DONE TAKING  40  STEPS.
Total reward:  -1017.811506514928
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.447238667757404
DONE TAKING  40  STEPS.
Total reward:  -519.5401076040115
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.568899207499792
DONE TAKING  40  STEPS.
Total reward:  -373.9403217563366
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.909947258992702
DONE TAKING  40  STEPS.
Total reward:  -335.30406863945126
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.467243515568597
DONE TAKING  40  STEPS.
Total reward:  -674.5290030152456
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.596030951979195
DONE TAKING  40  STEPS.
Total reward:  -86.24466896299998
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.207048729213685
DONE TAKING  40  STEPS.
Total reward:  -480.7798514448593
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.7361918261906
DONE TAKING  40  STEPS.
Total reward:  -419.24625802166366
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.756522240666715
DONE TAKING  40  STEPS.
Total reward:  -1007.7701343782545
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.888821511339685
DONE TAKING  40  STEPS.
Total reward:  -467.13684663281856
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.39557292981399
DONE TAKING  40  STEPS.
Total reward:  -417.51324610624243
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.179139566144567
DONE TAKING  40  STEPS.
Total reward:  -460.04279288745806
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.660231145768716
DONE TAKING  40  STEPS.
Total reward:  -710.1803247943467
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.095764448939992
DONE TAKING  40  STEPS.
Total reward:  -625.673553418218
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.333654923043706
DONE TAKING  40  STEPS.
Total reward:  -400.7406581875622
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.717135712964897
DONE TAKING  40  STEPS.
Total reward:  -337.2110136184329
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.297121960849193
DONE TAKING  40  STEPS.
Total reward:  -580.574836158848
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.56337537731364
DONE TAKING  40  STEPS.
Total reward:  -395.0311771496828
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -10.51916194082918
DONE TAKING  40  STEPS.
Total reward:  89.12918015201159
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -31.095483022622858
DONE TAKING  40  STEPS.
Total reward:  -951.5731814405086
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.622701500068306
DONE TAKING  40  STEPS.
Total reward:  -686.1504045485177
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.915462801959386
DONE TAKING  40  STEPS.
Total reward:  -630.7190579847482
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -19.13737369047616
DONE TAKING  40  STEPS.
Total reward:  -359.23122274636677
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.72269402077248
DONE TAKING  40  STEPS.
Total reward:  -836.5782565548145
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.132684649024114
DONE TAKING  40  STEPS.
Total reward:  -933.4394587482501
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.307459635263143
DONE TAKING  40  STEPS.
Total reward:  -1002.5974660517221
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.475588318018037
DONE TAKING  40  STEPS.
Total reward:  -453.47983172156097
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.093529693659704
DONE TAKING  40  STEPS.
Total reward:  -409.77243562979805
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.100119590105674
DONE TAKING  40  STEPS.
Total reward:  -415.4733528645126
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -31.352032585943917
DONE TAKING  40  STEPS.
Total reward:  -947.5311628557097
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.20839648556593
DONE TAKING  40  STEPS.
Total reward:  -672.3576754252467
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.607679512480416
DONE TAKING  40  STEPS.
Total reward:  -861.9084689741276
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.790619748973945
DONE TAKING  40  STEPS.
Total reward:  -638.9862911954247
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.14418288540702
DONE TAKING  40  STEPS.
Total reward:  -918.6494890412732
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.92467930466951
DONE TAKING  40  STEPS.
Total reward:  -780.2935426663187
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -12.682127595350677
DONE TAKING  40  STEPS.
Total reward:  -367.78702557594045
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter54.ckpt
Iter: 55
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  55
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  18525
On pol:  28800
Prob shape:  (47325,)

=== Epoch 0 ===
    train loss:  0.4237111826305804
    val rand:  0.33232951164245605
    val onPol:  0.32684245705604553

=== Epoch 10 ===
    train loss:  0.17823428871191066
    val rand:  0.19086168706417084
    val onPol:  0.2930349310239156

=== Epoch 20 ===
    train loss:  0.12080424270876076
    val rand:  0.1630692481994629
    val onPol:  0.3129358987013499

=== Epoch 30 ===
    train loss:  0.09235779414682285
    val rand:  0.16011767089366913
    val onPol:  0.32722461223602295

=== Epoch 39 ===
    train loss:  0.07538462908047697
    val rand:  0.15224701166152954
    val onPol:  0.3408273160457611
Training duration: 23.01 s

#####################################
performing on-policy MPC rollouts... iter  55
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.619537503133778
DONE TAKING  40  STEPS.
Total reward:  -803.5841701190845
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.928778702916325
DONE TAKING  40  STEPS.
Total reward:  -15.034045708531654
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.711267525809095
DONE TAKING  40  STEPS.
Total reward:  -527.782418565419
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.17836678829549
DONE TAKING  40  STEPS.
Total reward:  -602.3503208207601
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.740052612944602
DONE TAKING  40  STEPS.
Total reward:  -485.8578175797355
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -14.061406974659176
DONE TAKING  40  STEPS.
Total reward:  101.49359272064768
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.06476058558221
DONE TAKING  40  STEPS.
Total reward:  -927.3672428092225
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.318061267828691
DONE TAKING  40  STEPS.
Total reward:  -531.7271711615816
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.499681867991377
DONE TAKING  40  STEPS.
Total reward:  -754.5084713353366
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.47367430158641
DONE TAKING  40  STEPS.
Total reward:  -828.4572080038926
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.559296595842245
DONE TAKING  40  STEPS.
Total reward:  -588.2027817771518
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.202702208730937
DONE TAKING  40  STEPS.
Total reward:  -359.4147391358028
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.39089606248665
DONE TAKING  40  STEPS.
Total reward:  -438.3946124791422
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.858698278235337
DONE TAKING  40  STEPS.
Total reward:  -771.085074225441
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.813570834343636
DONE TAKING  40  STEPS.
Total reward:  -1055.286159264678
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -12.547669107794192
DONE TAKING  40  STEPS.
Total reward:  -440.1956158712744
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -31.212430917077846
DONE TAKING  40  STEPS.
Total reward:  -805.9088440572979
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.73028868552509
DONE TAKING  40  STEPS.
Total reward:  -1009.4995560643576
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.833869205233725
DONE TAKING  40  STEPS.
Total reward:  -649.1474041654577
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.127778912162277
DONE TAKING  40  STEPS.
Total reward:  -996.8954954657602
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -10.41855239412509
DONE TAKING  40  STEPS.
Total reward:  -199.24882125025812
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.200391878430857
DONE TAKING  40  STEPS.
Total reward:  -859.1882876572756
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.41389426326053
DONE TAKING  40  STEPS.
Total reward:  -744.576909880573
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.137854404226115
DONE TAKING  40  STEPS.
Total reward:  33.24192704904219
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.020284008293046
DONE TAKING  40  STEPS.
Total reward:  -553.0830376304906
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.20578943671765
DONE TAKING  40  STEPS.
Total reward:  -1041.0101978090581
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.665619933757487
DONE TAKING  40  STEPS.
Total reward:  -548.7100927459649
Time for 1 rollout: 1.35 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.392928116405386
DONE TAKING  40  STEPS.
Total reward:  -1020.1400616864935
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.29746985357975
DONE TAKING  40  STEPS.
Total reward:  -625.7903652037057
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.406258633916035
DONE TAKING  40  STEPS.
Total reward:  -349.6190472251761
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.764078420331256
DONE TAKING  40  STEPS.
Total reward:  -272.5856568582181
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.653328676921003
DONE TAKING  40  STEPS.
Total reward:  -551.2027938300502
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.93505647137409
DONE TAKING  40  STEPS.
Total reward:  -491.27835292092584
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.907774220610072
DONE TAKING  40  STEPS.
Total reward:  -895.5198182853948
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.30790723056973
DONE TAKING  40  STEPS.
Total reward:  -282.51325513449683
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.47754605590966
DONE TAKING  40  STEPS.
Total reward:  -523.152283591068
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.614115930314874
DONE TAKING  40  STEPS.
Total reward:  -762.5802203467913
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.093570870191435
DONE TAKING  40  STEPS.
Total reward:  -671.1781913037719
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.55139061820708
DONE TAKING  40  STEPS.
Total reward:  -935.8914598647084
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.677692710177453
DONE TAKING  40  STEPS.
Total reward:  -403.00809521993204
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter55.ckpt
Iter: 56
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  56
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  18720
On pol:  28800
Prob shape:  (47520,)

=== Epoch 0 ===
    train loss:  0.4162753049446189
    val rand:  0.32802343368530273
    val onPol:  0.32772767543792725

=== Epoch 10 ===
    train loss:  0.178241319630457
    val rand:  0.18671566247940063
    val onPol:  0.2943168878555298

=== Epoch 20 ===
    train loss:  0.12156404384776302
    val rand:  0.1618458479642868
    val onPol:  0.31518611311912537

=== Epoch 30 ===
    train loss:  0.09153288740502752
    val rand:  0.15647104382514954
    val onPol:  0.33027831713358563

=== Epoch 39 ===
    train loss:  0.07443800568580627
    val rand:  0.15505766868591309
    val onPol:  0.3470584650834401
Training duration: 24.25 s

#####################################
performing on-policy MPC rollouts... iter  56
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.57491370122809
DONE TAKING  40  STEPS.
Total reward:  -488.736583963912
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.227429967695585
DONE TAKING  40  STEPS.
Total reward:  -854.0807875168889
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.12845479841513
DONE TAKING  40  STEPS.
Total reward:  -374.74144868330876
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.188049399184273
DONE TAKING  40  STEPS.
Total reward:  -632.76781760097
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.589073060415203
DONE TAKING  40  STEPS.
Total reward:  -423.15214517387085
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.07052548614838
DONE TAKING  40  STEPS.
Total reward:  -589.5841544607365
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.727605895319904
DONE TAKING  40  STEPS.
Total reward:  -287.9507468062102
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.51748651822758
DONE TAKING  40  STEPS.
Total reward:  -894.3308861772939
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.692872685624483
DONE TAKING  40  STEPS.
Total reward:  -640.0274543732512
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -15.463808185609079
DONE TAKING  40  STEPS.
Total reward:  -426.4077614414098
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -16.694724486542277
DONE TAKING  40  STEPS.
Total reward:  -431.96474654948526
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.34077342903333
DONE TAKING  40  STEPS.
Total reward:  -523.2765676114509
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -31.313075134484713
DONE TAKING  40  STEPS.
Total reward:  -831.7979171346191
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.04358934581514
DONE TAKING  40  STEPS.
Total reward:  -520.4524056816446
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.894459630804228
DONE TAKING  40  STEPS.
Total reward:  -700.3252467534127
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.763312504248354
DONE TAKING  40  STEPS.
Total reward:  -605.3748785106163
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.99481735540187
DONE TAKING  40  STEPS.
Total reward:  -226.42687616342351
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -12.21219171763639
DONE TAKING  40  STEPS.
Total reward:  -427.60427261157173
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.63813412736183
DONE TAKING  40  STEPS.
Total reward:  -780.6898329830477
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.743399408197373
DONE TAKING  40  STEPS.
Total reward:  -802.5419842225576
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -16.874283042692973
DONE TAKING  40  STEPS.
Total reward:  -306.8931000717746
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.862691980336223
DONE TAKING  40  STEPS.
Total reward:  -628.2403227258291
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.772677124088883
DONE TAKING  40  STEPS.
Total reward:  -453.13239041928506
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.74722546539916
DONE TAKING  40  STEPS.
Total reward:  -495.52578999648745
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -26.083968827562508
DONE TAKING  40  STEPS.
Total reward:  -609.1865668847855
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.521799194453784
DONE TAKING  40  STEPS.
Total reward:  -711.663063570442
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.85020066893234
DONE TAKING  40  STEPS.
Total reward:  -474.43557722356576
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.58602731759757
DONE TAKING  40  STEPS.
Total reward:  -779.477308288037
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.460465026757536
DONE TAKING  40  STEPS.
Total reward:  -1040.4976448549005
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.927176633091317
DONE TAKING  40  STEPS.
Total reward:  -704.0453156676551
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.773156676781053
DONE TAKING  40  STEPS.
Total reward:  -260.37533221367295
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.836378658578496
DONE TAKING  40  STEPS.
Total reward:  -815.1460961008224
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.754311385381857
DONE TAKING  40  STEPS.
Total reward:  -555.2550839742058
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -9.891154533511584
DONE TAKING  40  STEPS.
Total reward:  -373.840953437752
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.48410731248547
DONE TAKING  40  STEPS.
Total reward:  -854.7359749862101
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.336532087543254
DONE TAKING  40  STEPS.
Total reward:  -503.6993721433903
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -14.834191778970267
DONE TAKING  40  STEPS.
Total reward:  -370.69229699610867
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -15.516843339576267
DONE TAKING  40  STEPS.
Total reward:  -487.4833709695107
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -21.59160550909735
DONE TAKING  40  STEPS.
Total reward:  -478.3950269317138
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.076597167585764
DONE TAKING  40  STEPS.
Total reward:  -419.846513742626
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter56.ckpt
Iter: 57
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  57
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  18915
On pol:  28800
Prob shape:  (47715,)

=== Epoch 0 ===
    train loss:  0.42131132336073024
    val rand:  0.32458633184432983
    val onPol:  0.332640677690506

=== Epoch 10 ===
    train loss:  0.18047641313845111
    val rand:  0.1859963834285736
    val onPol:  0.29684553543726605

=== Epoch 20 ===
    train loss:  0.12224865184035352
    val rand:  0.1665942370891571
    val onPol:  0.31982845067977905

=== Epoch 30 ===
    train loss:  0.09145078391477626
    val rand:  0.15264004468917847
    val onPol:  0.3367191553115845

=== Epoch 39 ===
    train loss:  0.07494038447577467
    val rand:  0.15706680715084076
    val onPol:  0.3528101444244385
Training duration: 23.38 s

#####################################
performing on-policy MPC rollouts... iter  57
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -31.305598682241
DONE TAKING  40  STEPS.
Total reward:  -861.7525872076303
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.050382710639262
DONE TAKING  40  STEPS.
Total reward:  -689.9258041012426
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.933910808472756
DONE TAKING  40  STEPS.
Total reward:  -653.4738151627678
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -26.816483008594627
DONE TAKING  40  STEPS.
Total reward:  -428.3217165242261
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.71647138488685
DONE TAKING  40  STEPS.
Total reward:  -682.9726218095427
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.193574116421324
DONE TAKING  40  STEPS.
Total reward:  -991.9618126405451
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.60534352128859
DONE TAKING  40  STEPS.
Total reward:  -620.4376110743888
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -14.686165680009307
DONE TAKING  40  STEPS.
Total reward:  -407.7905049714009
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.01304921088171
DONE TAKING  40  STEPS.
Total reward:  -761.6366509455836
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.771476740290783
DONE TAKING  40  STEPS.
Total reward:  -320.74171243068474
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.74216347296962
DONE TAKING  40  STEPS.
Total reward:  -702.6398717873719
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.555409503410964
DONE TAKING  40  STEPS.
Total reward:  -311.5147826244517
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.72168327911022
DONE TAKING  40  STEPS.
Total reward:  -557.2426641441125
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.923125195921198
DONE TAKING  40  STEPS.
Total reward:  -765.0729794608187
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.944475886282753
DONE TAKING  40  STEPS.
Total reward:  -273.7129300871698
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.683117334367026
DONE TAKING  40  STEPS.
Total reward:  -1033.4285140817944
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -17.037487951062495
DONE TAKING  40  STEPS.
Total reward:  -567.6318331221058
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.305976235838628
DONE TAKING  40  STEPS.
Total reward:  -358.18030471224506
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.327874083494375
DONE TAKING  40  STEPS.
Total reward:  -1025.2563286077198
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -31.166530260888226
DONE TAKING  40  STEPS.
Total reward:  -644.7524852881195
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.060079005501937
DONE TAKING  40  STEPS.
Total reward:  -452.93209976986225
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.199604324560113
DONE TAKING  40  STEPS.
Total reward:  -422.9707849592887
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.976846686158522
DONE TAKING  40  STEPS.
Total reward:  -622.8966727435975
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.443594153339617
DONE TAKING  40  STEPS.
Total reward:  43.69988325304388
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.233962299657005
DONE TAKING  40  STEPS.
Total reward:  -1043.9016359739398
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.092978055129144
DONE TAKING  40  STEPS.
Total reward:  -710.8819846756369
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.02166366337358
DONE TAKING  40  STEPS.
Total reward:  -590.5570131125152
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.152958806318438
DONE TAKING  40  STEPS.
Total reward:  -598.5620703577514
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.44140003400211
DONE TAKING  40  STEPS.
Total reward:  -546.4069627546515
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -18.162283906979056
DONE TAKING  40  STEPS.
Total reward:  -578.3276079434708
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.11029577014108
DONE TAKING  40  STEPS.
Total reward:  -425.63876311722134
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.63128488060751
DONE TAKING  40  STEPS.
Total reward:  -574.742201488935
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.74793067165062
DONE TAKING  40  STEPS.
Total reward:  -583.3483192281745
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.96590237831768
DONE TAKING  40  STEPS.
Total reward:  -488.83445422668353
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.66633554045672
DONE TAKING  40  STEPS.
Total reward:  -556.4792927192229
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.172324105120904
DONE TAKING  40  STEPS.
Total reward:  -410.80004717467335
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -12.239616907446196
DONE TAKING  40  STEPS.
Total reward:  -151.23200154262477
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.468592748962323
DONE TAKING  40  STEPS.
Total reward:  -716.6463556855824
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.24750708068519
DONE TAKING  40  STEPS.
Total reward:  -768.0610991318455
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.06671536335019
DONE TAKING  40  STEPS.
Total reward:  -759.3593056207663
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter57.ckpt
Iter: 58
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  58
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  19110
On pol:  28800
Prob shape:  (47910,)

=== Epoch 0 ===
    train loss:  0.4187294139016059
    val rand:  0.3250163793563843
    val onPol:  0.3230719765027364

=== Epoch 10 ===
    train loss:  0.18094325786636722
    val rand:  0.18297871947288513
    val onPol:  0.28936562935511273

=== Epoch 20 ===
    train loss:  0.12369336187839508
    val rand:  0.166104257106781
    val onPol:  0.30697255333264667

=== Epoch 30 ===
    train loss:  0.09229892668544605
    val rand:  0.16057945787906647
    val onPol:  0.32851457595825195

=== Epoch 39 ===
    train loss:  0.07613014485887303
    val rand:  0.15931755304336548
    val onPol:  0.3430112500985463
Training duration: 24.42 s

#####################################
performing on-policy MPC rollouts... iter  58
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -14.758494311581082
DONE TAKING  40  STEPS.
Total reward:  -395.3046163566013
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.464334255463392
DONE TAKING  40  STEPS.
Total reward:  -434.05238391638926
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.066202017096668
DONE TAKING  40  STEPS.
Total reward:  -897.6021389455709
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -15.359690167042682
DONE TAKING  40  STEPS.
Total reward:  31.749801789412246
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.35244569767528
DONE TAKING  40  STEPS.
Total reward:  -272.3706038502343
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -16.86481777589465
DONE TAKING  40  STEPS.
Total reward:  -21.623387104683673
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.305339171295465
DONE TAKING  40  STEPS.
Total reward:  -435.03114406456115
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.69328161208118
DONE TAKING  40  STEPS.
Total reward:  -774.8664512106834
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.265260879363808
DONE TAKING  40  STEPS.
Total reward:  -371.06501201908543
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.61750830878216
DONE TAKING  40  STEPS.
Total reward:  -472.9167222092543
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.742957642364555
DONE TAKING  40  STEPS.
Total reward:  -922.992737019801
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.7369870429177
DONE TAKING  40  STEPS.
Total reward:  -557.5929534235988
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -17.020776503961613
DONE TAKING  40  STEPS.
Total reward:  -457.3089199593989
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -21.90144532289135
DONE TAKING  40  STEPS.
Total reward:  -510.62738778562
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -14.573661982558164
DONE TAKING  40  STEPS.
Total reward:  -301.4558484842432
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -10.445289568394202
DONE TAKING  40  STEPS.
Total reward:  -257.32830973136805
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -14.147957036526094
DONE TAKING  40  STEPS.
Total reward:  -425.7699611548282
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.196549004447277
DONE TAKING  40  STEPS.
Total reward:  -488.44851300823706
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.002910638616882
DONE TAKING  40  STEPS.
Total reward:  -321.0008740266555
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.6459967475785
DONE TAKING  40  STEPS.
Total reward:  -678.6266685242919
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.542458968630285
DONE TAKING  40  STEPS.
Total reward:  -75.59040100905231
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -11.280074312258595
DONE TAKING  40  STEPS.
Total reward:  -287.299602351817
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.95430581528452
DONE TAKING  40  STEPS.
Total reward:  -571.6192380394143
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.48850640611088
DONE TAKING  40  STEPS.
Total reward:  -452.84566789420126
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -14.68163863972746
DONE TAKING  40  STEPS.
Total reward:  -437.34668218147317
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.72648897726996
DONE TAKING  40  STEPS.
Total reward:  -598.1842082130352
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.169755358703163
DONE TAKING  40  STEPS.
Total reward:  -729.2668300003116
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.964050840957103
DONE TAKING  40  STEPS.
Total reward:  -659.244547754948
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.7667498230791
DONE TAKING  40  STEPS.
Total reward:  -789.6672206533157
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.36087246461541
DONE TAKING  40  STEPS.
Total reward:  -834.1841723396282
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -18.852374891612172
DONE TAKING  40  STEPS.
Total reward:  -680.7607660872036
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.894536578229836
DONE TAKING  40  STEPS.
Total reward:  -522.0237601789222
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.682275464575945
DONE TAKING  40  STEPS.
Total reward:  -501.5828653362485
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.45114204099306
DONE TAKING  40  STEPS.
Total reward:  -531.7282531981373
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.35702020264745
DONE TAKING  40  STEPS.
Total reward:  -555.4047882423525
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.770761661608194
DONE TAKING  40  STEPS.
Total reward:  -486.1879901622149
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -15.475398334983604
DONE TAKING  40  STEPS.
Total reward:  -553.5543095602056
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.01465689522765
DONE TAKING  40  STEPS.
Total reward:  -437.32619023340783
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.132261653630817
DONE TAKING  40  STEPS.
Total reward:  -561.0793347895824
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.387552448501935
DONE TAKING  40  STEPS.
Total reward:  -507.55661947002636
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter58.ckpt
Iter: 59
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  59
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  19305
On pol:  28800
Prob shape:  (48105,)

=== Epoch 0 ===
    train loss:  0.42197692971075734
    val rand:  0.32217922806739807
    val onPol:  0.32603535056114197

=== Epoch 10 ===
    train loss:  0.18315951061505142
    val rand:  0.18464607000350952
    val onPol:  0.29046697417895

=== Epoch 20 ===
    train loss:  0.12459574519626555
    val rand:  0.165700301527977
    val onPol:  0.30786673227945965

=== Epoch 30 ===
    train loss:  0.09432174457657722
    val rand:  0.15551933646202087
    val onPol:  0.32919775446256

=== Epoch 39 ===
    train loss:  0.07715696785398708
    val rand:  0.15089915692806244
    val onPol:  0.3418876032034556
Training duration: 23.33 s

#####################################
performing on-policy MPC rollouts... iter  59
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.890976914738605
DONE TAKING  40  STEPS.
Total reward:  -729.651124144364
Time for 1 rollout: 1.39 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.760146375316104
DONE TAKING  40  STEPS.
Total reward:  -348.2106656828324
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.906628724665406
DONE TAKING  40  STEPS.
Total reward:  -207.16043082542356
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.309268807364806
DONE TAKING  40  STEPS.
Total reward:  -965.3313110848658
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -23.119941433484627
DONE TAKING  40  STEPS.
Total reward:  -659.7772559423663
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.33365207261272
DONE TAKING  40  STEPS.
Total reward:  -325.2374938848495
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.699052894961866
DONE TAKING  40  STEPS.
Total reward:  -142.43006391903697
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.488295129530353
DONE TAKING  40  STEPS.
Total reward:  -571.1388536461677
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.818518454324753
DONE TAKING  40  STEPS.
Total reward:  -879.6152993954482
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -16.53723400702524
DONE TAKING  40  STEPS.
Total reward:  -637.3807291142346
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -19.95099169852265
DONE TAKING  40  STEPS.
Total reward:  -435.083815642299
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.749345987073397
DONE TAKING  40  STEPS.
Total reward:  -681.3045780633404
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.76896791079342
DONE TAKING  40  STEPS.
Total reward:  -760.2684584402244
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.143766867762956
DONE TAKING  40  STEPS.
Total reward:  -521.8648878433526
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.258858219163898
DONE TAKING  40  STEPS.
Total reward:  -687.7177055030247
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.34418980494529
DONE TAKING  40  STEPS.
Total reward:  -745.0237953553495
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.787184951661377
DONE TAKING  40  STEPS.
Total reward:  -620.095951151993
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.428463268786146
DONE TAKING  40  STEPS.
Total reward:  -749.2977002522094
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -10.932890308409956
DONE TAKING  40  STEPS.
Total reward:  -316.27149947716515
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.773081035740635
DONE TAKING  40  STEPS.
Total reward:  -674.4884887093028
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.181485335845984
DONE TAKING  40  STEPS.
Total reward:  -315.1300237609521
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.669071094354596
DONE TAKING  40  STEPS.
Total reward:  -599.9479753837927
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.416322484954176
DONE TAKING  40  STEPS.
Total reward:  -558.4851817654485
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.695593278191122
DONE TAKING  40  STEPS.
Total reward:  -949.3187417119915
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.46727711091423
DONE TAKING  40  STEPS.
Total reward:  -293.1159069848966
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -19.299459960784638
DONE TAKING  40  STEPS.
Total reward:  -674.6862312780099
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.236095391101
DONE TAKING  40  STEPS.
Total reward:  -907.0373332260092
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -10.469898338583278
DONE TAKING  40  STEPS.
Total reward:  -114.31058556975123
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -24.85305808524593
DONE TAKING  40  STEPS.
Total reward:  -542.8852273497382
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.095052134315416
DONE TAKING  40  STEPS.
Total reward:  -914.5562786637855
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.997866547937114
DONE TAKING  40  STEPS.
Total reward:  -684.0533104273657
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.773228197510026
DONE TAKING  40  STEPS.
Total reward:  -491.37794134309075
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -14.950563297091046
DONE TAKING  40  STEPS.
Total reward:  -277.23246576970735
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.405726340135715
DONE TAKING  40  STEPS.
Total reward:  -1049.3331012100145
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.294220286439717
DONE TAKING  40  STEPS.
Total reward:  -834.6537951143343
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.76751887504163
DONE TAKING  40  STEPS.
Total reward:  -599.4055724842651
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -15.618795099744698
DONE TAKING  40  STEPS.
Total reward:  -546.7613341292748
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.1705115193674
DONE TAKING  40  STEPS.
Total reward:  -848.6032305465714
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.689702140910972
DONE TAKING  40  STEPS.
Total reward:  -369.96265865132335
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.48756212300169
DONE TAKING  40  STEPS.
Total reward:  -641.9154331127578
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter59.ckpt
Iter: 60
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  60
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  19500
On pol:  28800
Prob shape:  (48300,)

=== Epoch 0 ===
    train loss:  0.42025525011914844
    val rand:  0.3231978416442871
    val onPol:  0.33019710580507916

=== Epoch 10 ===
    train loss:  0.1801173246287285
    val rand:  0.19090363383293152
    val onPol:  0.29311802983283997

=== Epoch 20 ===
    train loss:  0.12222068392215892
    val rand:  0.1622687578201294
    val onPol:  0.3090541164080302

=== Epoch 30 ===
    train loss:  0.09274030651183839
    val rand:  0.1528085470199585
    val onPol:  0.3314385215441386

=== Epoch 39 ===
    train loss:  0.07608437569851571
    val rand:  0.15143534541130066
    val onPol:  0.34272076686223346
Training duration: 23.72 s

#####################################
performing on-policy MPC rollouts... iter  60
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.027601067948034
DONE TAKING  40  STEPS.
Total reward:  114.4269896461644
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.85453401429535
DONE TAKING  40  STEPS.
Total reward:  -942.45805198616
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.248710803710267
DONE TAKING  40  STEPS.
Total reward:  -285.17594800471403
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.33878600150613
DONE TAKING  40  STEPS.
Total reward:  -637.06292159936
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.325060511702404
DONE TAKING  40  STEPS.
Total reward:  -1092.6302842166056
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.931883357321567
DONE TAKING  40  STEPS.
Total reward:  -768.1353022339016
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.941756679385623
DONE TAKING  40  STEPS.
Total reward:  -582.9742306549358
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.398917909299982
DONE TAKING  40  STEPS.
Total reward:  -560.976331752172
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.17248136848348
DONE TAKING  40  STEPS.
Total reward:  -708.371398711103
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.578245530640707
DONE TAKING  40  STEPS.
Total reward:  -395.0498108688175
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.43879889071798
DONE TAKING  40  STEPS.
Total reward:  -1007.099486533949
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.431997159893605
DONE TAKING  40  STEPS.
Total reward:  -1139.1682342260983
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.253070608767874
DONE TAKING  40  STEPS.
Total reward:  -690.981375085859
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.62409532967547
DONE TAKING  40  STEPS.
Total reward:  -84.98741806549862
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.534777061747647
DONE TAKING  40  STEPS.
Total reward:  -306.9078297869613
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.013168666609275
DONE TAKING  40  STEPS.
Total reward:  -1118.5557536853069
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.009572071011277
DONE TAKING  40  STEPS.
Total reward:  -382.2752449603728
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.246965689843414
DONE TAKING  40  STEPS.
Total reward:  -442.9611085148404
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.055482510941605
DONE TAKING  40  STEPS.
Total reward:  -316.76973536204804
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.184177263358553
DONE TAKING  40  STEPS.
Total reward:  -476.57928079145876
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -24.40134044378724
DONE TAKING  40  STEPS.
Total reward:  -608.4912771187091
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.70011645674748
DONE TAKING  40  STEPS.
Total reward:  -697.3586277434765
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.816461492007807
DONE TAKING  40  STEPS.
Total reward:  -911.0799005551615
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.313972820697416
DONE TAKING  40  STEPS.
Total reward:  -448.749268459933
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.464311780584648
DONE TAKING  40  STEPS.
Total reward:  238.63956777512632
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.289822406675697
DONE TAKING  40  STEPS.
Total reward:  -634.1804499134807
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.201162581109344
DONE TAKING  40  STEPS.
Total reward:  -1035.6962657521694
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.69988612720021
DONE TAKING  40  STEPS.
Total reward:  -540.6467651066998
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -14.286241518719333
DONE TAKING  40  STEPS.
Total reward:  -85.04311884654508
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -31.181746164903494
DONE TAKING  40  STEPS.
Total reward:  -929.0614575655723
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -31.243112653947406
DONE TAKING  40  STEPS.
Total reward:  169.49482335890193
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.200161834059926
DONE TAKING  40  STEPS.
Total reward:  -329.4126405743637
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.545803348401492
DONE TAKING  40  STEPS.
Total reward:  -979.2085570232911
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.19263888245487
DONE TAKING  40  STEPS.
Total reward:  -727.7485132142183
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.46157193699625
DONE TAKING  40  STEPS.
Total reward:  -959.5140986910815
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.292996578895178
DONE TAKING  40  STEPS.
Total reward:  -225.49019738163418
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -9.804035754951615
DONE TAKING  40  STEPS.
Total reward:  -282.9125982553684
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.043837785570926
DONE TAKING  40  STEPS.
Total reward:  -386.0029418004262
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -15.347424566777848
DONE TAKING  40  STEPS.
Total reward:  -398.86490584189266
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -31.373454220235743
DONE TAKING  40  STEPS.
Total reward:  -829.0718730756395
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter60.ckpt
Iter: 61
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  61
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  19695
On pol:  28800
Prob shape:  (48495,)

=== Epoch 0 ===
    train loss:  0.42815205645053944
    val rand:  0.32161420583724976
    val onPol:  0.3378337621688843

=== Epoch 10 ===
    train loss:  0.18199935444491974
    val rand:  0.1804831624031067
    val onPol:  0.297704557577769

=== Epoch 20 ===
    train loss:  0.12412750879500775
    val rand:  0.16118969023227692
    val onPol:  0.3158245086669922

=== Epoch 30 ===
    train loss:  0.09416631228746251
    val rand:  0.15175050497055054
    val onPol:  0.3378373384475708

=== Epoch 39 ===
    train loss:  0.07721347781888982
    val rand:  0.15354607999324799
    val onPol:  0.35156912604967755
Training duration: 23.59 s

#####################################
performing on-policy MPC rollouts... iter  61
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.42680686972066
DONE TAKING  40  STEPS.
Total reward:  -771.5592438264854
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.447413819227787
DONE TAKING  40  STEPS.
Total reward:  -917.3407242522292
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.935818199419543
DONE TAKING  40  STEPS.
Total reward:  -831.2480720328426
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.417911912670107
DONE TAKING  40  STEPS.
Total reward:  -362.1554226809752
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.263987510469008
DONE TAKING  40  STEPS.
Total reward:  -657.0661626366679
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -18.333582053459367
DONE TAKING  40  STEPS.
Total reward:  -426.7974269365634
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.687613385458658
DONE TAKING  40  STEPS.
Total reward:  -714.6338042563794
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.11548253596312
DONE TAKING  40  STEPS.
Total reward:  -580.0937243659874
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.924588454571456
DONE TAKING  40  STEPS.
Total reward:  -680.54769911521
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.17191102734602
DONE TAKING  40  STEPS.
Total reward:  -496.04967846080456
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.761223545720547
DONE TAKING  40  STEPS.
Total reward:  -863.6748733964753
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.715464828933612
DONE TAKING  40  STEPS.
Total reward:  -550.3429894119214
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.238270232075376
DONE TAKING  40  STEPS.
Total reward:  -418.7881704994162
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.074422646774323
DONE TAKING  40  STEPS.
Total reward:  -653.6459187518625
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.900075648672036
DONE TAKING  40  STEPS.
Total reward:  -634.6422636952186
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.009896481850703
DONE TAKING  40  STEPS.
Total reward:  -250.15693910143915
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.488274032909764
DONE TAKING  40  STEPS.
Total reward:  -1051.1014305010137
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -14.987553191139787
DONE TAKING  40  STEPS.
Total reward:  55.30332437333438
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.527527851146004
DONE TAKING  40  STEPS.
Total reward:  -428.253957273678
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.831627534968504
DONE TAKING  40  STEPS.
Total reward:  -470.7169477530921
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -22.657298814159184
DONE TAKING  40  STEPS.
Total reward:  -619.713524738092
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.945818098998426
DONE TAKING  40  STEPS.
Total reward:  -907.0370286243977
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.2975076569409
DONE TAKING  40  STEPS.
Total reward:  -534.8127558380847
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.875708939169538
DONE TAKING  40  STEPS.
Total reward:  -812.4669456143223
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -18.915829047445758
DONE TAKING  40  STEPS.
Total reward:  45.238323099662594
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.56648006689842
DONE TAKING  40  STEPS.
Total reward:  -387.95181347490285
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.554218562890497
DONE TAKING  40  STEPS.
Total reward:  -498.7024569719728
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.282509443241125
DONE TAKING  40  STEPS.
Total reward:  -936.6081398679038
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.699381099026745
DONE TAKING  40  STEPS.
Total reward:  -1018.819318200959
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.82444523776998
DONE TAKING  40  STEPS.
Total reward:  -737.2779058768289
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.90819074487624
DONE TAKING  40  STEPS.
Total reward:  -135.2636368269239
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.365499177149736
DONE TAKING  40  STEPS.
Total reward:  -837.3400015142146
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.191089910440386
DONE TAKING  40  STEPS.
Total reward:  -666.59619306915
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.479861094902287
DONE TAKING  40  STEPS.
Total reward:  -739.8924570143213
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.043657704736038
DONE TAKING  40  STEPS.
Total reward:  -678.608440016616
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.202675349781888
DONE TAKING  40  STEPS.
Total reward:  -409.97966023156766
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.09229307874722
DONE TAKING  40  STEPS.
Total reward:  -889.8973117876043
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.28593921399951
DONE TAKING  40  STEPS.
Total reward:  -1029.236307418737
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.592926679317372
DONE TAKING  40  STEPS.
Total reward:  -904.3384005588179
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -16.440039942660473
DONE TAKING  40  STEPS.
Total reward:  -330.61577776858263
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter61.ckpt
Iter: 62
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  62
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  19890
On pol:  28800
Prob shape:  (48690,)

=== Epoch 0 ===
    train loss:  0.42333081709711173
    val rand:  0.3150886297225952
    val onPol:  0.346556822458903

=== Epoch 10 ===
    train loss:  0.18230869519083123
    val rand:  0.18537840247154236
    val onPol:  0.3089105486869812

=== Epoch 20 ===
    train loss:  0.12573545818266116
    val rand:  0.1711733639240265
    val onPol:  0.33453378081321716

=== Epoch 30 ===
    train loss:  0.09375686943531036
    val rand:  0.1571987420320511
    val onPol:  0.35619571805000305

=== Epoch 39 ===
    train loss:  0.07687975874072626
    val rand:  0.15693019330501556
    val onPol:  0.3668274184068044
Training duration: 24.99 s

#####################################
performing on-policy MPC rollouts... iter  62
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.30580020030314
DONE TAKING  40  STEPS.
Total reward:  -626.1937060088634
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -13.383191521174794
DONE TAKING  40  STEPS.
Total reward:  -226.72043261004765
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -31.025283329144898
DONE TAKING  40  STEPS.
Total reward:  -651.7168692530281
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.80369578608522
DONE TAKING  40  STEPS.
Total reward:  -772.5842717191151
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.19611392497513
DONE TAKING  40  STEPS.
Total reward:  -1108.9272002081143
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.52561945089898
DONE TAKING  40  STEPS.
Total reward:  -262.06595110832393
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.591136220000337
DONE TAKING  40  STEPS.
Total reward:  -481.92435135794415
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.721952833471082
DONE TAKING  40  STEPS.
Total reward:  -302.22967881222047
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.101466674559884
DONE TAKING  40  STEPS.
Total reward:  -265.05505034746034
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.887518696458805
DONE TAKING  40  STEPS.
Total reward:  -687.3240912005099
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.119440164518064
DONE TAKING  40  STEPS.
Total reward:  137.03909763249925
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.669235834764148
DONE TAKING  40  STEPS.
Total reward:  -606.2935009349774
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.891518668233708
DONE TAKING  40  STEPS.
Total reward:  -715.7433567709797
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.3871016635128
DONE TAKING  40  STEPS.
Total reward:  -425.77842067680723
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.393137448922317
DONE TAKING  40  STEPS.
Total reward:  -851.8605595783191
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.882124732307588
DONE TAKING  40  STEPS.
Total reward:  -215.30745367034405
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.84408842128653
DONE TAKING  40  STEPS.
Total reward:  -465.8681239078467
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.632290996565438
DONE TAKING  40  STEPS.
Total reward:  -587.9605553840114
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.02592825460857
DONE TAKING  40  STEPS.
Total reward:  139.55138041065803
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.693826680212847
DONE TAKING  40  STEPS.
Total reward:  -213.0536924074966
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.720467167927527
DONE TAKING  40  STEPS.
Total reward:  -708.7787370854834
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.403593607557507
DONE TAKING  40  STEPS.
Total reward:  -776.2613875271785
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.569411853712705
DONE TAKING  40  STEPS.
Total reward:  -661.9426380348004
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.140300609283187
DONE TAKING  40  STEPS.
Total reward:  -574.9920644847995
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.97140400557494
DONE TAKING  40  STEPS.
Total reward:  -625.460632739204
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.242016576888158
DONE TAKING  40  STEPS.
Total reward:  -853.359404977525
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.73885801095286
DONE TAKING  40  STEPS.
Total reward:  -458.68419652741267
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.586370936705247
DONE TAKING  40  STEPS.
Total reward:  -650.861283780458
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.211086841807067
DONE TAKING  40  STEPS.
Total reward:  -392.153655220083
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -14.53615477113048
DONE TAKING  40  STEPS.
Total reward:  -73.91657230408617
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.69208825940212
DONE TAKING  40  STEPS.
Total reward:  -787.3237597615439
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.323713911902846
DONE TAKING  40  STEPS.
Total reward:  -479.2102341710542
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.898067797085503
DONE TAKING  40  STEPS.
Total reward:  -903.0050920218431
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -19.81443431923529
DONE TAKING  40  STEPS.
Total reward:  -521.0767689239648
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.732914491759622
DONE TAKING  40  STEPS.
Total reward:  -802.1053026302278
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -12.302248197080456
DONE TAKING  40  STEPS.
Total reward:  -432.4761963055847
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -10.57483347850992
DONE TAKING  40  STEPS.
Total reward:  -308.9709638124615
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.760033064842514
DONE TAKING  40  STEPS.
Total reward:  -923.7702685253452
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.468856842194782
DONE TAKING  40  STEPS.
Total reward:  -839.6410711100946
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.324970827797774
DONE TAKING  40  STEPS.
Total reward:  -394.47090550591776
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter62.ckpt
Iter: 63
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  63
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  20085
On pol:  28800
Prob shape:  (48885,)

=== Epoch 0 ===
    train loss:  0.42409294718190244
    val rand:  0.31681180000305176
    val onPol:  0.3225891093413035

=== Epoch 10 ===
    train loss:  0.18618950498731512
    val rand:  0.18261896073818207
    val onPol:  0.28614598512649536

=== Epoch 20 ===
    train loss:  0.12586593110310404
    val rand:  0.1568853259086609
    val onPol:  0.30447515845298767

=== Epoch 30 ===
    train loss:  0.09465134959471853
    val rand:  0.15655741095542908
    val onPol:  0.32866602142651874

=== Epoch 39 ===
    train loss:  0.07715380082004948
    val rand:  0.15114323794841766
    val onPol:  0.3396217425664266
Training duration: 23.40 s

#####################################
performing on-policy MPC rollouts... iter  63
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.854922903818927
DONE TAKING  40  STEPS.
Total reward:  -339.4425366140855
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.05027315875463
DONE TAKING  40  STEPS.
Total reward:  -816.1908920118337
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.415894640780625
DONE TAKING  40  STEPS.
Total reward:  -908.7616076930482
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.204628347256396
DONE TAKING  40  STEPS.
Total reward:  -989.3982267764848
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -15.407528400943349
DONE TAKING  40  STEPS.
Total reward:  -446.85543196520723
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -14.649717912559762
DONE TAKING  40  STEPS.
Total reward:  -364.660676861336
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.393270228911796
DONE TAKING  40  STEPS.
Total reward:  -590.05914838876
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.537587077200158
DONE TAKING  40  STEPS.
Total reward:  -693.4301230546981
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.20860540787063
DONE TAKING  40  STEPS.
Total reward:  -728.548087897585
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.38642125091922
DONE TAKING  40  STEPS.
Total reward:  -1137.267678672356
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -15.068759844063868
DONE TAKING  40  STEPS.
Total reward:  -550.3476720914896
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.046552167395596
DONE TAKING  40  STEPS.
Total reward:  -365.59650379703305
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.44377860375009
DONE TAKING  40  STEPS.
Total reward:  -575.4970098138689
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.624609359279017
DONE TAKING  40  STEPS.
Total reward:  -793.4827702182295
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.13253276407768
DONE TAKING  40  STEPS.
Total reward:  -132.05044256406916
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.9729517739075
DONE TAKING  40  STEPS.
Total reward:  -442.3472987076856
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.680538276550166
DONE TAKING  40  STEPS.
Total reward:  -876.9904859997665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.882186857426667
DONE TAKING  40  STEPS.
Total reward:  -675.7569469877823
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.765013220616968
DONE TAKING  40  STEPS.
Total reward:  153.3643427267763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -8.398168653456157
DONE TAKING  40  STEPS.
Total reward:  -267.9541008247039
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.720392489925537
DONE TAKING  40  STEPS.
Total reward:  -684.501415206683
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.403144417117268
DONE TAKING  40  STEPS.
Total reward:  -899.1122342944471
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.695664160438586
DONE TAKING  40  STEPS.
Total reward:  -681.5449143933935
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.70418704519751
DONE TAKING  40  STEPS.
Total reward:  -694.094731061401
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.432971881304585
DONE TAKING  40  STEPS.
Total reward:  -572.8514352743481
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -13.903822909762589
DONE TAKING  40  STEPS.
Total reward:  -142.80480638850443
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -31.1576179469295
DONE TAKING  40  STEPS.
Total reward:  -659.2995834243013
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.54647745415638
DONE TAKING  40  STEPS.
Total reward:  -324.6513658274661
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.889715895557003
DONE TAKING  40  STEPS.
Total reward:  -306.78008260765125
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.909817116429508
DONE TAKING  40  STEPS.
Total reward:  -400.3761489455943
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.55846044632431
DONE TAKING  40  STEPS.
Total reward:  -568.0581223046084
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.687356058671845
DONE TAKING  40  STEPS.
Total reward:  -473.7386672921197
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.132259368381737
DONE TAKING  40  STEPS.
Total reward:  -272.95299617810116
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.643794828083934
DONE TAKING  40  STEPS.
Total reward:  -202.05614140464155
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -17.78371567996177
DONE TAKING  40  STEPS.
Total reward:  -329.03696831977845
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.983940162844647
DONE TAKING  40  STEPS.
Total reward:  -494.60346647361973
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.07023355534101
DONE TAKING  40  STEPS.
Total reward:  -608.7533619608241
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -11.74748633118594
DONE TAKING  40  STEPS.
Total reward:  8.764585643174781
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.06827407798889
DONE TAKING  40  STEPS.
Total reward:  -313.05679869986295
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.614605396092148
DONE TAKING  40  STEPS.
Total reward:  -442.4177384031052
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter63.ckpt
Iter: 64
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  64
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  20280
On pol:  28800
Prob shape:  (49080,)

=== Epoch 0 ===
    train loss:  0.4201479431829954
    val rand:  0.3074682354927063
    val onPol:  0.3367662827173869

=== Epoch 10 ===
    train loss:  0.18457313399565847
    val rand:  0.18318021297454834
    val onPol:  0.3026978671550751

=== Epoch 20 ===
    train loss:  0.12416430398037559
    val rand:  0.1640310436487198
    val onPol:  0.323128620783488

=== Epoch 30 ===
    train loss:  0.09389308283203526
    val rand:  0.15489742159843445
    val onPol:  0.3463982840379079

=== Epoch 39 ===
    train loss:  0.07628210571251418
    val rand:  0.15189129114151
    val onPol:  0.35815727710723877
Training duration: 25.13 s

#####################################
performing on-policy MPC rollouts... iter  64
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.024629862678623
DONE TAKING  40  STEPS.
Total reward:  -439.58685924190314
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.848093464744565
DONE TAKING  40  STEPS.
Total reward:  -836.2982016770574
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.616757689128736
DONE TAKING  40  STEPS.
Total reward:  -989.2661069967038
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.4685104964902
DONE TAKING  40  STEPS.
Total reward:  -574.1392275538511
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.929757933157383
DONE TAKING  40  STEPS.
Total reward:  -139.32729143955152
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.152832684034998
DONE TAKING  40  STEPS.
Total reward:  -386.20295646784797
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -16.266307076471772
DONE TAKING  40  STEPS.
Total reward:  -382.05893885201857
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -9.61138455854147
DONE TAKING  40  STEPS.
Total reward:  -365.6074356617415
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.554338316275455
DONE TAKING  40  STEPS.
Total reward:  -577.3575538423858
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.95702774691141
DONE TAKING  40  STEPS.
Total reward:  -683.9734753389371
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.851297594387322
DONE TAKING  40  STEPS.
Total reward:  -795.1616550156962
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.318014102950062
DONE TAKING  40  STEPS.
Total reward:  -362.8461655662421
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -9.216459350395226
DONE TAKING  40  STEPS.
Total reward:  -265.13393929037727
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.949971173580334
DONE TAKING  40  STEPS.
Total reward:  -443.9330330215926
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.055544336057054
DONE TAKING  40  STEPS.
Total reward:  -507.19246577611904
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.473530959329207
DONE TAKING  40  STEPS.
Total reward:  -811.4852700960557
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.321288847128308
DONE TAKING  40  STEPS.
Total reward:  -491.54457504666885
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.839983880343333
DONE TAKING  40  STEPS.
Total reward:  -658.6157823143003
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.51414217429736
DONE TAKING  40  STEPS.
Total reward:  -1009.2612039184535
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.78735340898893
DONE TAKING  40  STEPS.
Total reward:  -558.6852017489875
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.042708147188563
DONE TAKING  40  STEPS.
Total reward:  -141.28466921478673
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -14.831190835780445
DONE TAKING  40  STEPS.
Total reward:  -355.7798247306106
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.90054464717531
DONE TAKING  40  STEPS.
Total reward:  -608.2266828919632
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.568575952744464
DONE TAKING  40  STEPS.
Total reward:  -287.80897091634813
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.294919099587414
DONE TAKING  40  STEPS.
Total reward:  -549.065090871862
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.564837177850745
DONE TAKING  40  STEPS.
Total reward:  -1146.7797615028821
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.06842119928814
DONE TAKING  40  STEPS.
Total reward:  -512.3825956917026
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.148180908051906
DONE TAKING  40  STEPS.
Total reward:  -83.86980335759964
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.900147863873038
DONE TAKING  40  STEPS.
Total reward:  -435.38799618858764
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.25767652572977
DONE TAKING  40  STEPS.
Total reward:  -679.5069110802704
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -15.331423931779455
DONE TAKING  40  STEPS.
Total reward:  -392.4970880301558
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.92934869922555
DONE TAKING  40  STEPS.
Total reward:  -735.5492966641997
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.076675296041337
DONE TAKING  40  STEPS.
Total reward:  -391.14343220372
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.491701524498435
DONE TAKING  40  STEPS.
Total reward:  -557.6792425678091
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.908975203292993
DONE TAKING  40  STEPS.
Total reward:  -665.9606501083329
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.98316621669027
DONE TAKING  40  STEPS.
Total reward:  -471.8426224547425
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.831813244958994
DONE TAKING  40  STEPS.
Total reward:  -385.98427410760803
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.6961542451725
DONE TAKING  40  STEPS.
Total reward:  -633.1085454239153
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -16.86052152458771
DONE TAKING  40  STEPS.
Total reward:  -402.67519757715223
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.621173490428141
DONE TAKING  40  STEPS.
Total reward:  -489.2724805660594
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter64.ckpt
Iter: 65
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  65
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  20475
On pol:  28800
Prob shape:  (49275,)

=== Epoch 0 ===
    train loss:  0.4236511265238126
    val rand:  0.30918535590171814
    val onPol:  0.34254588683446247

=== Epoch 10 ===
    train loss:  0.18355697176108757
    val rand:  0.18525511026382446
    val onPol:  0.31218258539835614

=== Epoch 20 ===
    train loss:  0.12434551546660562
    val rand:  0.1608504354953766
    val onPol:  0.330077866713206

=== Epoch 30 ===
    train loss:  0.09315889018277328
    val rand:  0.15606725215911865
    val onPol:  0.35556618372599286

=== Epoch 39 ===
    train loss:  0.0757019859738648
    val rand:  0.15486276149749756
    val onPol:  0.3721810579299927
Training duration: 23.97 s

#####################################
performing on-policy MPC rollouts... iter  65
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.09923245072774
DONE TAKING  40  STEPS.
Total reward:  -411.2974261934984
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.04311718926878
DONE TAKING  40  STEPS.
Total reward:  -547.9178839724738
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.893453945969696
DONE TAKING  40  STEPS.
Total reward:  -360.27186864000674
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.49571581951666
DONE TAKING  40  STEPS.
Total reward:  -429.6210341805475
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.59368497181274
DONE TAKING  40  STEPS.
Total reward:  -489.620839339388
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.198609973031477
DONE TAKING  40  STEPS.
Total reward:  -384.6455214487882
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -13.62341504631206
DONE TAKING  40  STEPS.
Total reward:  -465.26651852943274
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.412688782291717
DONE TAKING  40  STEPS.
Total reward:  -421.11337453680454
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.75109439867657
DONE TAKING  40  STEPS.
Total reward:  -654.582602452672
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -17.653076338589802
DONE TAKING  40  STEPS.
Total reward:  -404.01395784898324
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -13.594797592873311
DONE TAKING  40  STEPS.
Total reward:  -517.205294094192
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.857324662382347
DONE TAKING  40  STEPS.
Total reward:  -647.63332303791
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.923219549881935
DONE TAKING  40  STEPS.
Total reward:  -386.6408157830589
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.20508057450049
DONE TAKING  40  STEPS.
Total reward:  -362.6843345917466
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.06333972517664
DONE TAKING  40  STEPS.
Total reward:  -846.7095842413869
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.423531585224033
DONE TAKING  40  STEPS.
Total reward:  -370.2643553574444
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.24265893848442
DONE TAKING  40  STEPS.
Total reward:  -500.4072550213191
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.313892847347592
DONE TAKING  40  STEPS.
Total reward:  -531.4972515238968
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.06490379756062
DONE TAKING  40  STEPS.
Total reward:  -407.8337524835849
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -9.109181842011427
DONE TAKING  40  STEPS.
Total reward:  10.038498170616453
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.34788853704446
DONE TAKING  40  STEPS.
Total reward:  -155.46223955190018
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.94164132682893
DONE TAKING  40  STEPS.
Total reward:  -610.7959733778823
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.345645807728097
DONE TAKING  40  STEPS.
Total reward:  -521.5577545377157
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -13.836553360911278
DONE TAKING  40  STEPS.
Total reward:  -497.310800994623
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -26.70185985120338
DONE TAKING  40  STEPS.
Total reward:  -458.6652168712576
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.291583008809788
DONE TAKING  40  STEPS.
Total reward:  -790.610863999759
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -13.924471986951893
DONE TAKING  40  STEPS.
Total reward:  -342.2163301031332
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.01083750809768
DONE TAKING  40  STEPS.
Total reward:  -800.4683810305694
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.912556208685793
DONE TAKING  40  STEPS.
Total reward:  -462.817455334619
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.776380242435533
DONE TAKING  40  STEPS.
Total reward:  -694.7301248668833
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.554509027799966
DONE TAKING  40  STEPS.
Total reward:  -651.2500904372628
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.41112145168318
DONE TAKING  40  STEPS.
Total reward:  -593.3301152005505
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.52567011696881
DONE TAKING  40  STEPS.
Total reward:  -610.942408547063
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.312531401512278
DONE TAKING  40  STEPS.
Total reward:  -717.6734976208444
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.753817630880867
DONE TAKING  40  STEPS.
Total reward:  -848.6448159492794
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.56249874473188
DONE TAKING  40  STEPS.
Total reward:  -870.3668709353361
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.54419192350033
DONE TAKING  40  STEPS.
Total reward:  -665.4340273624177
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.51607722628888
DONE TAKING  40  STEPS.
Total reward:  -752.2697593739347
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.380572217236274
DONE TAKING  40  STEPS.
Total reward:  -841.577357667261
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.741268554120452
DONE TAKING  40  STEPS.
Total reward:  -716.0761957733994
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter65.ckpt
Iter: 66
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  66
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  20670
On pol:  28800
Prob shape:  (49470,)

=== Epoch 0 ===
    train loss:  0.4186577210202813
    val rand:  0.30299830436706543
    val onPol:  0.34027808904647827

=== Epoch 10 ===
    train loss:  0.18412227338800827
    val rand:  0.1805238574743271
    val onPol:  0.30370862285296124

=== Epoch 20 ===
    train loss:  0.12370722965958218
    val rand:  0.1590512990951538
    val onPol:  0.32523898283640545

=== Epoch 30 ===
    train loss:  0.09133278066292405
    val rand:  0.15123184025287628
    val onPol:  0.34748656551043194

=== Epoch 39 ===
    train loss:  0.07442802664202948
    val rand:  0.14553813636302948
    val onPol:  0.36198022961616516
Training duration: 25.34 s

#####################################
performing on-policy MPC rollouts... iter  66
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.191484563495152
DONE TAKING  40  STEPS.
Total reward:  -617.1314697694703
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -22.292302560851684
DONE TAKING  40  STEPS.
Total reward:  -527.0994150462551
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.659928949862973
DONE TAKING  40  STEPS.
Total reward:  -658.5585257891613
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.88997711563483
DONE TAKING  40  STEPS.
Total reward:  -699.9208434582249
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -31.34429499708488
DONE TAKING  40  STEPS.
Total reward:  -791.7844439390576
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.622296724096582
DONE TAKING  40  STEPS.
Total reward:  -489.52368572449404
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.675463585899934
DONE TAKING  40  STEPS.
Total reward:  -405.18194465488966
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -12.890092757068508
DONE TAKING  40  STEPS.
Total reward:  -511.67007678258403
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.869277301412364
DONE TAKING  40  STEPS.
Total reward:  -549.1605624614932
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.981404379948748
DONE TAKING  40  STEPS.
Total reward:  -449.12661731328524
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -12.36752290470613
DONE TAKING  40  STEPS.
Total reward:  -350.697870302003
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.944412174127017
DONE TAKING  40  STEPS.
Total reward:  -284.3792356935823
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.801300467786955
DONE TAKING  40  STEPS.
Total reward:  -671.9789080616681
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.96912288766105
DONE TAKING  40  STEPS.
Total reward:  -749.8015642165965
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.68065543206841
DONE TAKING  40  STEPS.
Total reward:  -647.6348997673898
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.292049822820832
DONE TAKING  40  STEPS.
Total reward:  -388.95476705882464
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.391571990671206
DONE TAKING  40  STEPS.
Total reward:  -652.11595463826
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.281043377757314
DONE TAKING  40  STEPS.
Total reward:  -756.9792149674349
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.723863912871685
DONE TAKING  40  STEPS.
Total reward:  -578.7376769786332
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.266039056097323
DONE TAKING  40  STEPS.
Total reward:  -823.6547916361191
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.723421031669595
DONE TAKING  40  STEPS.
Total reward:  -740.5864376158049
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.088292588246112
DONE TAKING  40  STEPS.
Total reward:  -529.9702033910339
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.540963456359954
DONE TAKING  40  STEPS.
Total reward:  -713.5754847458627
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.580906116720783
DONE TAKING  40  STEPS.
Total reward:  -784.0696653975357
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.986336360672468
DONE TAKING  40  STEPS.
Total reward:  -744.6766748629677
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -12.186407130447527
DONE TAKING  40  STEPS.
Total reward:  -263.2908689000899
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.20678485901868
DONE TAKING  40  STEPS.
Total reward:  -1131.2234658843925
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.617022576619389
DONE TAKING  40  STEPS.
Total reward:  -376.4502964828836
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.63623712297777
DONE TAKING  40  STEPS.
Total reward:  -548.1675127072272
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.72348753546011
DONE TAKING  40  STEPS.
Total reward:  -600.0243297823308
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.725542617434996
DONE TAKING  40  STEPS.
Total reward:  -657.3619769853054
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.78581638048447
DONE TAKING  40  STEPS.
Total reward:  -1043.7660705690025
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -12.575681685999221
DONE TAKING  40  STEPS.
Total reward:  -316.72261102997976
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -25.226666765874278
DONE TAKING  40  STEPS.
Total reward:  -460.47720724576425
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.034374161719747
DONE TAKING  40  STEPS.
Total reward:  -692.0325066168039
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.57156814751815
DONE TAKING  40  STEPS.
Total reward:  -15.487338616994895
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.701082837753546
DONE TAKING  40  STEPS.
Total reward:  -441.3564844668318
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -18.385002858372918
DONE TAKING  40  STEPS.
Total reward:  -630.7021918602785
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.795317768916092
DONE TAKING  40  STEPS.
Total reward:  -423.35142077489894
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.96121601660083
DONE TAKING  40  STEPS.
Total reward:  -502.7514258598443
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter66.ckpt
Iter: 67
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  67
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  20865
On pol:  28800
Prob shape:  (49665,)

=== Epoch 0 ===
    train loss:  0.4220351214261399
    val rand:  0.31857380270957947
    val onPol:  0.3374262551466624

=== Epoch 10 ===
    train loss:  0.18583967590454928
    val rand:  0.17605160176753998
    val onPol:  0.30103222529093426

=== Epoch 20 ===
    train loss:  0.12583994312384694
    val rand:  0.1613486111164093
    val onPol:  0.32687532901763916

=== Epoch 30 ===
    train loss:  0.09302506188756411
    val rand:  0.1513381004333496
    val onPol:  0.34697529673576355

=== Epoch 39 ===
    train loss:  0.07584139558765077
    val rand:  0.15580371022224426
    val onPol:  0.3617473940054576
Training duration: 24.31 s

#####################################
performing on-policy MPC rollouts... iter  67
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.237705139324152
DONE TAKING  40  STEPS.
Total reward:  -404.70858621167463
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.897850695418384
DONE TAKING  40  STEPS.
Total reward:  -475.4846718114601
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.875469187543366
DONE TAKING  40  STEPS.
Total reward:  -907.5508066054699
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.902237808173378
DONE TAKING  40  STEPS.
Total reward:  -399.6374908139668
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.22328321368072
DONE TAKING  40  STEPS.
Total reward:  -224.16229920424425
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.773835594902557
DONE TAKING  40  STEPS.
Total reward:  -483.643728551855
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.920584419590142
DONE TAKING  40  STEPS.
Total reward:  -332.7879802087027
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.004701370541863
DONE TAKING  40  STEPS.
Total reward:  -399.046384592249
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -12.04312168472589
DONE TAKING  40  STEPS.
Total reward:  -13.998131778018326
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.199383277886092
DONE TAKING  40  STEPS.
Total reward:  -991.9262284960647
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.312142583966786
DONE TAKING  40  STEPS.
Total reward:  -872.5072852983976
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.253587692641727
DONE TAKING  40  STEPS.
Total reward:  -430.77917034334314
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.55947872011067
DONE TAKING  40  STEPS.
Total reward:  -750.5640964548536
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.788817769905855
DONE TAKING  40  STEPS.
Total reward:  -303.9432722991622
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.51912505761852
DONE TAKING  40  STEPS.
Total reward:  -483.1593216935894
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.18398652785315
DONE TAKING  40  STEPS.
Total reward:  -636.8911586713272
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.4617317589248
DONE TAKING  40  STEPS.
Total reward:  -632.2939062466722
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.78328012124497
DONE TAKING  40  STEPS.
Total reward:  207.5022222116444
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.469034654967
DONE TAKING  40  STEPS.
Total reward:  -419.7874967069687
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.156989598652746
DONE TAKING  40  STEPS.
Total reward:  -492.61927802058955
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.641010840276213
DONE TAKING  40  STEPS.
Total reward:  -161.7576851212012
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.255442391902783
DONE TAKING  40  STEPS.
Total reward:  -115.95279759662388
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -14.579052727704699
DONE TAKING  40  STEPS.
Total reward:  -33.432136479844395
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.231622145866215
DONE TAKING  40  STEPS.
Total reward:  -824.8552704176172
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.40555676731232
DONE TAKING  40  STEPS.
Total reward:  -670.8013652597785
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.52765075583748
DONE TAKING  40  STEPS.
Total reward:  -767.0288701374934
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.79018222474358
DONE TAKING  40  STEPS.
Total reward:  -388.1535553816
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.7274993900916
DONE TAKING  40  STEPS.
Total reward:  -802.7970746018677
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.2513784357318
DONE TAKING  40  STEPS.
Total reward:  -818.8592655827265
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.96614662249397
DONE TAKING  40  STEPS.
Total reward:  -897.0034314336583
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.319330429442946
DONE TAKING  40  STEPS.
Total reward:  -493.876941996451
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.911939253906844
DONE TAKING  40  STEPS.
Total reward:  -648.2598987598905
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.521528907397517
DONE TAKING  40  STEPS.
Total reward:  -748.6050598713306
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.874822233668326
DONE TAKING  40  STEPS.
Total reward:  -427.3582972407301
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.726081056437835
DONE TAKING  40  STEPS.
Total reward:  -662.4280745250887
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.295076964360838
DONE TAKING  40  STEPS.
Total reward:  -598.4395904311899
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.38970325313622
DONE TAKING  40  STEPS.
Total reward:  -355.7142560845712
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.83900891860548
DONE TAKING  40  STEPS.
Total reward:  -857.8623184739165
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.08405031900711
DONE TAKING  40  STEPS.
Total reward:  98.44687203581762
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.734909659926059
DONE TAKING  40  STEPS.
Total reward:  -301.32579016232125
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter67.ckpt
Iter: 68
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  68
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  21060
On pol:  28800
Prob shape:  (49860,)

=== Epoch 0 ===
    train loss:  0.42582122290257324
    val rand:  0.3088023364543915
    val onPol:  0.3506035606066386

=== Epoch 10 ===
    train loss:  0.1843093472350504
    val rand:  0.1783849447965622
    val onPol:  0.3101198772589366

=== Epoch 20 ===
    train loss:  0.1257260846569366
    val rand:  0.1591300219297409
    val onPol:  0.33737977345784503

=== Epoch 30 ===
    train loss:  0.09353693997122578
    val rand:  0.15488147735595703
    val onPol:  0.3598262866338094

=== Epoch 39 ===
    train loss:  0.07777879463950384
    val rand:  0.14986887574195862
    val onPol:  0.3740234076976776
Training duration: 25.52 s

#####################################
performing on-policy MPC rollouts... iter  68
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -20.221853261153488
DONE TAKING  40  STEPS.
Total reward:  -259.14632442182483
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.472125780954112
DONE TAKING  40  STEPS.
Total reward:  -500.10039180617554
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.90246972578458
DONE TAKING  40  STEPS.
Total reward:  -515.2646866828051
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.494854313323174
DONE TAKING  40  STEPS.
Total reward:  -434.09048347774313
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.592952787201234
DONE TAKING  40  STEPS.
Total reward:  -978.3503351786096
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.29700168496428
DONE TAKING  40  STEPS.
Total reward:  -613.5886096493007
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.390048716612295
DONE TAKING  40  STEPS.
Total reward:  -1108.8630779035673
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.883893432650332
DONE TAKING  40  STEPS.
Total reward:  -707.4314283748512
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.38029459406215
DONE TAKING  40  STEPS.
Total reward:  -849.3568834267268
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.118083681559714
DONE TAKING  40  STEPS.
Total reward:  -596.1258686678052
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.130961316083454
DONE TAKING  40  STEPS.
Total reward:  -351.88495600286353
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.65588098003765
DONE TAKING  40  STEPS.
Total reward:  -686.5791655001739
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.557092096751518
DONE TAKING  40  STEPS.
Total reward:  -732.079580258893
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.861413271903373
DONE TAKING  40  STEPS.
Total reward:  -600.245611498605
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -16.434684706868566
DONE TAKING  40  STEPS.
Total reward:  -451.16247879997553
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.81783499785344
DONE TAKING  40  STEPS.
Total reward:  -1085.6712892895482
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.274523084653083
DONE TAKING  40  STEPS.
Total reward:  -917.668609640626
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.060738733485152
DONE TAKING  40  STEPS.
Total reward:  -172.4529023270816
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.125428372694028
DONE TAKING  40  STEPS.
Total reward:  -323.77622107703314
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.506951309330876
DONE TAKING  40  STEPS.
Total reward:  -819.4260089365938
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.067712370114062
DONE TAKING  40  STEPS.
Total reward:  -404.3008135293586
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.12592017354106
DONE TAKING  40  STEPS.
Total reward:  -450.7393728382264
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.788683872235254
DONE TAKING  40  STEPS.
Total reward:  -876.0525254027083
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -18.898667041468315
DONE TAKING  40  STEPS.
Total reward:  -512.1337760581483
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.639047887572467
DONE TAKING  40  STEPS.
Total reward:  -657.242996237444
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.96351257726581
DONE TAKING  40  STEPS.
Total reward:  -471.7412285513123
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.263537407098006
DONE TAKING  40  STEPS.
Total reward:  -346.9018125709166
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.52319756450811
DONE TAKING  40  STEPS.
Total reward:  -750.4759557277304
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.018706842774417
DONE TAKING  40  STEPS.
Total reward:  -644.703537635425
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.048465212375874
DONE TAKING  40  STEPS.
Total reward:  -494.73052594699783
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.86315028015447
DONE TAKING  40  STEPS.
Total reward:  -248.34667446784516
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.619023468929058
DONE TAKING  40  STEPS.
Total reward:  -741.4217993465505
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.03614710269142
DONE TAKING  40  STEPS.
Total reward:  -421.666590981565
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.3057124136422
DONE TAKING  40  STEPS.
Total reward:  -674.9400400700246
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.041061634356325
DONE TAKING  40  STEPS.
Total reward:  -841.4030045433143
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.79580491797378
DONE TAKING  40  STEPS.
Total reward:  -858.1830943790758
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.671716507593203
DONE TAKING  40  STEPS.
Total reward:  -818.2606870292838
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.26284853422407
DONE TAKING  40  STEPS.
Total reward:  -493.6156772091136
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.452350155895989
DONE TAKING  40  STEPS.
Total reward:  -187.25320540836276
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.00399256322226
DONE TAKING  40  STEPS.
Total reward:  -602.3116947152198
Time for 1 rollout: 1.65 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter68.ckpt
Iter: 69
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  69
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  21255
On pol:  28800
Prob shape:  (50055,)

=== Epoch 0 ===
    train loss:  0.42168243797784
    val rand:  0.3130347728729248
    val onPol:  0.3437648018201192

=== Epoch 10 ===
    train loss:  0.185088941885024
    val rand:  0.18249770998954773
    val onPol:  0.30671338240305585

=== Epoch 20 ===
    train loss:  0.12680102170435423
    val rand:  0.16217803955078125
    val onPol:  0.325982928276062

=== Epoch 30 ===
    train loss:  0.09551237922968324
    val rand:  0.15907490253448486
    val onPol:  0.3481834928194682

=== Epoch 39 ===
    train loss:  0.07789357667116775
    val rand:  0.15367886424064636
    val onPol:  0.36637521783510846
Training duration: 24.50 s

#####################################
performing on-policy MPC rollouts... iter  69
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.02890733060337
DONE TAKING  40  STEPS.
Total reward:  -765.5014631646468
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -10.686865310988198
DONE TAKING  40  STEPS.
Total reward:  -338.6775461848294
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -19.380513290800288
DONE TAKING  40  STEPS.
Total reward:  -277.0882013622957
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.845793624217237
DONE TAKING  40  STEPS.
Total reward:  -832.0014107517167
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -24.501869400193073
DONE TAKING  40  STEPS.
Total reward:  -794.056619498458
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.391756775905144
DONE TAKING  40  STEPS.
Total reward:  -927.2932619040828
Time for 1 rollout: 1.34 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.726333977377493
DONE TAKING  40  STEPS.
Total reward:  -1143.7262137972023
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.12748149541229
DONE TAKING  40  STEPS.
Total reward:  -609.4846639889118
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.443154543227923
DONE TAKING  40  STEPS.
Total reward:  -429.94063570183044
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.294946850719004
DONE TAKING  40  STEPS.
Total reward:  143.69165879042922
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.319871004163574
DONE TAKING  40  STEPS.
Total reward:  -902.0350661653978
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.50797283214447
DONE TAKING  40  STEPS.
Total reward:  -662.9972789680078
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -10.634530348151054
DONE TAKING  40  STEPS.
Total reward:  -334.5443713430715
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.47660444453713
DONE TAKING  40  STEPS.
Total reward:  -661.6595513865153
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.532641603289292
DONE TAKING  40  STEPS.
Total reward:  -428.43696495545214
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -9.847891664527475
DONE TAKING  40  STEPS.
Total reward:  -237.0360153451952
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.058087857897803
DONE TAKING  40  STEPS.
Total reward:  -680.1816004499747
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.372645746938773
DONE TAKING  40  STEPS.
Total reward:  -308.7348061992178
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.506017036496193
DONE TAKING  40  STEPS.
Total reward:  -881.6897283210316
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.126260954315576
DONE TAKING  40  STEPS.
Total reward:  -358.9551234101188
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.236394842502172
DONE TAKING  40  STEPS.
Total reward:  -813.9726223944838
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.989901922721124
DONE TAKING  40  STEPS.
Total reward:  -505.17802444756217
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.69380582306846
DONE TAKING  40  STEPS.
Total reward:  -968.9611731422016
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.204757899056116
DONE TAKING  40  STEPS.
Total reward:  -70.86579231504454
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.031421462812045
DONE TAKING  40  STEPS.
Total reward:  -405.6022764466861
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.99575761870994
DONE TAKING  40  STEPS.
Total reward:  -351.26146275817405
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.624509443308636
DONE TAKING  40  STEPS.
Total reward:  -1017.0537080577055
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.975600603237584
DONE TAKING  40  STEPS.
Total reward:  -626.8568640125108
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.419010166918834
DONE TAKING  40  STEPS.
Total reward:  -749.3776877828598
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.85540220545454
DONE TAKING  40  STEPS.
Total reward:  -684.4563042415872
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -26.489110781000818
DONE TAKING  40  STEPS.
Total reward:  -926.3819463195117
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.33973905251582
DONE TAKING  40  STEPS.
Total reward:  -906.7491725201423
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.99136789393198
DONE TAKING  40  STEPS.
Total reward:  -587.7516698077096
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.867624414630214
DONE TAKING  40  STEPS.
Total reward:  -485.8143230126914
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.882087370008154
DONE TAKING  40  STEPS.
Total reward:  -815.2862185451565
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.694625501659573
DONE TAKING  40  STEPS.
Total reward:  -289.41020242388726
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.36297423290105
DONE TAKING  40  STEPS.
Total reward:  -238.1111528330553
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.37613905337144
DONE TAKING  40  STEPS.
Total reward:  -673.1917901257639
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.332420646761488
DONE TAKING  40  STEPS.
Total reward:  -200.89485965134423
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.15077003802266
DONE TAKING  40  STEPS.
Total reward:  -586.3807185158353
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter69.ckpt
Iter: 70
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  70
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  21450
On pol:  28800
Prob shape:  (50250,)

=== Epoch 0 ===
    train loss:  0.41982583519147365
    val rand:  0.31118500232696533
    val onPol:  0.3458779652913411

=== Epoch 10 ===
    train loss:  0.18477902850326228
    val rand:  0.18142548203468323
    val onPol:  0.31115245819091797

=== Epoch 20 ===
    train loss:  0.12514018639922142
    val rand:  0.16360387206077576
    val onPol:  0.33313982685407

=== Epoch 30 ===
    train loss:  0.0940119669753678
    val rand:  0.16024494171142578
    val onPol:  0.3576768934726715

=== Epoch 39 ===
    train loss:  0.07670702306287629
    val rand:  0.15027663111686707
    val onPol:  0.37270288666089374
Training duration: 25.09 s

#####################################
performing on-policy MPC rollouts... iter  70
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.53749752474297
DONE TAKING  40  STEPS.
Total reward:  -385.9663689255795
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.75188833638327
DONE TAKING  40  STEPS.
Total reward:  -331.06789510471094
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.59049483850881
DONE TAKING  40  STEPS.
Total reward:  -12.097156107555175
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -10.635825316073742
DONE TAKING  40  STEPS.
Total reward:  -413.5332370746082
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.708758825732755
DONE TAKING  40  STEPS.
Total reward:  -529.2778385089792
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.705665226813647
DONE TAKING  40  STEPS.
Total reward:  -609.0528936972773
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -20.076964088738695
DONE TAKING  40  STEPS.
Total reward:  -739.4450946385689
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.449919731187418
DONE TAKING  40  STEPS.
Total reward:  -318.0220454581793
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.868302318415598
DONE TAKING  40  STEPS.
Total reward:  -646.4909727793186
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.192514122003494
DONE TAKING  40  STEPS.
Total reward:  -386.63331874014483
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.31432997894614
DONE TAKING  40  STEPS.
Total reward:  -713.3914655249725
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.456874151290343
DONE TAKING  40  STEPS.
Total reward:  -861.803509854749
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.279478596744635
DONE TAKING  40  STEPS.
Total reward:  -678.8727561105676
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.853896416019126
DONE TAKING  40  STEPS.
Total reward:  -588.1843454050735
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.878413863498867
DONE TAKING  40  STEPS.
Total reward:  -959.9483655061887
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.549051505459875
DONE TAKING  40  STEPS.
Total reward:  -527.1773764764013
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.097313942933187
DONE TAKING  40  STEPS.
Total reward:  -366.72842009657074
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -16.79761180869569
DONE TAKING  40  STEPS.
Total reward:  -553.7711184853625
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.58443787231329
DONE TAKING  40  STEPS.
Total reward:  -821.0680274464388
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.34742537618811
DONE TAKING  40  STEPS.
Total reward:  -989.6677251666621
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.68669235849839
DONE TAKING  40  STEPS.
Total reward:  -548.6611295173151
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.121595759508246
DONE TAKING  40  STEPS.
Total reward:  -716.6661018668842
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -12.713659901807585
DONE TAKING  40  STEPS.
Total reward:  -326.7341985617455
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.550335429801887
DONE TAKING  40  STEPS.
Total reward:  -733.3706698848132
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.91433990130338
DONE TAKING  40  STEPS.
Total reward:  -645.9038106190817
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.488405921836247
DONE TAKING  40  STEPS.
Total reward:  -746.4727993853177
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.407424516090188
DONE TAKING  40  STEPS.
Total reward:  -1027.1655602482167
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -12.09250177455927
DONE TAKING  40  STEPS.
Total reward:  -337.9902804140006
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.310350634619823
DONE TAKING  40  STEPS.
Total reward:  -437.99076161107223
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.152138951279703
DONE TAKING  40  STEPS.
Total reward:  -1057.3511905721946
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.22033730272317
DONE TAKING  40  STEPS.
Total reward:  -380.67426018262057
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -11.335944193935873
DONE TAKING  40  STEPS.
Total reward:  -360.40922447060944
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.26320968211678
DONE TAKING  40  STEPS.
Total reward:  -680.0358617143764
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.581413229296448
DONE TAKING  40  STEPS.
Total reward:  -624.2786353629499
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.35830910704295
DONE TAKING  40  STEPS.
Total reward:  -674.5480515904561
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.836950761448712
DONE TAKING  40  STEPS.
Total reward:  -620.2523769249416
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.582479801953788
DONE TAKING  40  STEPS.
Total reward:  -906.5596713796689
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.890294912088848
DONE TAKING  40  STEPS.
Total reward:  -444.0845682827192
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.96751250726842
DONE TAKING  40  STEPS.
Total reward:  -287.4110293231467
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.00646819925512
DONE TAKING  40  STEPS.
Total reward:  -504.37876377113554
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter70.ckpt
Iter: 71
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  71
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  21645
On pol:  28800
Prob shape:  (50445,)

=== Epoch 0 ===
    train loss:  0.421706318247075
    val rand:  0.31682729721069336
    val onPol:  0.34021414319674176

=== Epoch 10 ===
    train loss:  0.18288459993746817
    val rand:  0.18806588649749756
    val onPol:  0.30351222554842633

=== Epoch 20 ===
    train loss:  0.12521682094250405
    val rand:  0.1622597575187683
    val onPol:  0.3239884873231252

=== Epoch 30 ===
    train loss:  0.0947493743531558
    val rand:  0.15326255559921265
    val onPol:  0.3492209315299988

=== Epoch 39 ===
    train loss:  0.07722297698563459
    val rand:  0.15223795175552368
    val onPol:  0.36282020807266235
Training duration: 24.55 s

#####################################
performing on-policy MPC rollouts... iter  71
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.695153881627785
DONE TAKING  40  STEPS.
Total reward:  -371.0291754790585
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.499084424650896
DONE TAKING  40  STEPS.
Total reward:  -568.2872577916797
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -15.927487971649764
DONE TAKING  40  STEPS.
Total reward:  -517.6139354100011
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.004694927407584
DONE TAKING  40  STEPS.
Total reward:  -540.8224856071791
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.73251620775775
DONE TAKING  40  STEPS.
Total reward:  -671.644005572699
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.181740606729907
DONE TAKING  40  STEPS.
Total reward:  -676.1143145070723
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.595521406157005
DONE TAKING  40  STEPS.
Total reward:  -525.2457307203916
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.44469750767736
DONE TAKING  40  STEPS.
Total reward:  -780.354037448363
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -18.409014622224767
DONE TAKING  40  STEPS.
Total reward:  -507.12607865698436
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.27374525046046
DONE TAKING  40  STEPS.
Total reward:  -579.8146409179726
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.80539112025883
DONE TAKING  40  STEPS.
Total reward:  -806.7836469308421
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.65842273021909
DONE TAKING  40  STEPS.
Total reward:  -770.4914809795378
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.77560300783624
DONE TAKING  40  STEPS.
Total reward:  -683.01913929747
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.234973999742053
DONE TAKING  40  STEPS.
Total reward:  -686.9304470442828
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.258082654038336
DONE TAKING  40  STEPS.
Total reward:  -790.4118065699391
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.217794571000265
DONE TAKING  40  STEPS.
Total reward:  -306.50028836877556
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.99130394886672
DONE TAKING  40  STEPS.
Total reward:  -846.2513236962831
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.491273092001492
DONE TAKING  40  STEPS.
Total reward:  -369.6998566459122
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -17.92989846602598
DONE TAKING  40  STEPS.
Total reward:  -655.4326310362303
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.67534688906543
DONE TAKING  40  STEPS.
Total reward:  -825.5550741076357
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.295067672900522
DONE TAKING  40  STEPS.
Total reward:  -543.9799293884332
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.25332780202033
DONE TAKING  40  STEPS.
Total reward:  -307.84514012767914
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.712799232948164
DONE TAKING  40  STEPS.
Total reward:  -568.7737434479304
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.562981202085883
DONE TAKING  40  STEPS.
Total reward:  -1054.7828543722162
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.58801084023743
DONE TAKING  40  STEPS.
Total reward:  131.8635175337219
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.710931613495113
DONE TAKING  40  STEPS.
Total reward:  -873.3330071478547
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.247135743413537
DONE TAKING  40  STEPS.
Total reward:  -597.8195299860329
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.47272022257406
DONE TAKING  40  STEPS.
Total reward:  -457.041976279138
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.1876812821728
DONE TAKING  40  STEPS.
Total reward:  -482.88331789507646
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.52925855114933
DONE TAKING  40  STEPS.
Total reward:  -984.5225406338365
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.133553993250334
DONE TAKING  40  STEPS.
Total reward:  -493.006532195595
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.771899402495222
DONE TAKING  40  STEPS.
Total reward:  -350.82117163334516
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.724476623709997
DONE TAKING  40  STEPS.
Total reward:  -629.6501266015164
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.81886833406172
DONE TAKING  40  STEPS.
Total reward:  -657.0103027153715
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.897223268644034
DONE TAKING  40  STEPS.
Total reward:  -424.4503628056765
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.95025422332163
DONE TAKING  40  STEPS.
Total reward:  -715.6883749053544
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.850118427409903
DONE TAKING  40  STEPS.
Total reward:  -541.962106490603
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -13.648366716523189
DONE TAKING  40  STEPS.
Total reward:  -407.66525363551364
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.187964943043024
DONE TAKING  40  STEPS.
Total reward:  -776.6712117708998
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.956273970951017
DONE TAKING  40  STEPS.
Total reward:  -534.8827240790484
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter71.ckpt
Iter: 72
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  72
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  21840
On pol:  28800
Prob shape:  (50640,)

=== Epoch 0 ===
    train loss:  0.42176998634727636
    val rand:  0.3199625313282013
    val onPol:  0.35512714584668476

=== Epoch 10 ===
    train loss:  0.1863176541364923
    val rand:  0.18537181615829468
    val onPol:  0.31542764107386273

=== Epoch 20 ===
    train loss:  0.12681013444552616
    val rand:  0.16264599561691284
    val onPol:  0.33622173468271893

=== Epoch 30 ===
    train loss:  0.09618778701643554
    val rand:  0.15825212001800537
    val onPol:  0.35699693361918133

=== Epoch 39 ===
    train loss:  0.07876570674837852
    val rand:  0.14902716875076294
    val onPol:  0.3766726454099019
Training duration: 25.93 s

#####################################
performing on-policy MPC rollouts... iter  72
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.960653446225436
DONE TAKING  40  STEPS.
Total reward:  -459.4402470769416
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.578902935428218
DONE TAKING  40  STEPS.
Total reward:  -915.9104477418723
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.137388878086746
DONE TAKING  40  STEPS.
Total reward:  -742.1354707019697
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -15.766675198788127
DONE TAKING  40  STEPS.
Total reward:  -471.35603263296025
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -24.801947296455783
DONE TAKING  40  STEPS.
Total reward:  -850.5064507635251
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.680135004790912
DONE TAKING  40  STEPS.
Total reward:  -142.1505100209709
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -10.596952012292453
DONE TAKING  40  STEPS.
Total reward:  -372.3072525206588
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.142912325764364
DONE TAKING  40  STEPS.
Total reward:  -1083.0072122405475
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -15.007155205048036
DONE TAKING  40  STEPS.
Total reward:  -433.84837966472844
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.83694444330991
DONE TAKING  40  STEPS.
Total reward:  -1013.900258244064
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.091035349504153
DONE TAKING  40  STEPS.
Total reward:  -775.0381025600318
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.150898803237293
DONE TAKING  40  STEPS.
Total reward:  -348.7041468092272
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.88937455890658
DONE TAKING  40  STEPS.
Total reward:  -660.36540282166
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.144250180205926
DONE TAKING  40  STEPS.
Total reward:  -821.349142611472
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.75625446817727
DONE TAKING  40  STEPS.
Total reward:  -559.0119525214616
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.670908444374405
DONE TAKING  40  STEPS.
Total reward:  -281.79841095773895
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.578649502797134
DONE TAKING  40  STEPS.
Total reward:  -605.9596607502522
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.950543986123538
DONE TAKING  40  STEPS.
Total reward:  -495.4109685313466
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -9.364801501844763
DONE TAKING  40  STEPS.
Total reward:  -30.003242174586735
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.262355095707285
DONE TAKING  40  STEPS.
Total reward:  -568.4655416153786
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.4854935105537
DONE TAKING  40  STEPS.
Total reward:  -1000.1903456434467
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.985350171976766
DONE TAKING  40  STEPS.
Total reward:  -345.6246891679322
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.041195105240952
DONE TAKING  40  STEPS.
Total reward:  -528.8916508581291
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.001928134856065
DONE TAKING  40  STEPS.
Total reward:  -1081.2178309774092
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.419934139800894
DONE TAKING  40  STEPS.
Total reward:  224.76887389485637
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.880353276849007
DONE TAKING  40  STEPS.
Total reward:  -748.3696339988451
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.659517628899074
DONE TAKING  40  STEPS.
Total reward:  -660.6016274198645
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.379717151047593
DONE TAKING  40  STEPS.
Total reward:  -832.634363576561
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.395060261804048
DONE TAKING  40  STEPS.
Total reward:  -660.9549722299637
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.35149573683365
DONE TAKING  40  STEPS.
Total reward:  -584.4009714417818
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.46145729284089
DONE TAKING  40  STEPS.
Total reward:  -151.22037978779397
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.719521790210987
DONE TAKING  40  STEPS.
Total reward:  -295.1412665028511
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -18.900589791297392
DONE TAKING  40  STEPS.
Total reward:  -492.62952317321947
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.118654102775837
DONE TAKING  40  STEPS.
Total reward:  -502.8831758473198
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.496692129325194
DONE TAKING  40  STEPS.
Total reward:  -678.2075574921633
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -31.41440525418805
DONE TAKING  40  STEPS.
Total reward:  -719.4382861085342
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.02814293719114
DONE TAKING  40  STEPS.
Total reward:  -388.2563644093367
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.574600151561267
DONE TAKING  40  STEPS.
Total reward:  -570.2310709858402
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -15.98744214967982
DONE TAKING  40  STEPS.
Total reward:  -255.42367345999483
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.876843054181904
DONE TAKING  40  STEPS.
Total reward:  -1073.4020974631499
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter72.ckpt
Iter: 73
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  73
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  22035
On pol:  28800
Prob shape:  (50835,)

=== Epoch 0 ===
    train loss:  0.4159917045723308
    val rand:  0.3110044598579407
    val onPol:  0.3614057997862498

=== Epoch 10 ===
    train loss:  0.18402855113299207
    val rand:  0.17969541251659393
    val onPol:  0.3197631339232127

=== Epoch 20 ===
    train loss:  0.12349275288858799
    val rand:  0.16048088669776917
    val onPol:  0.3430347243944804

=== Epoch 30 ===
    train loss:  0.09272728265836985
    val rand:  0.15169081091880798
    val onPol:  0.3632403214772542

=== Epoch 39 ===
    train loss:  0.07650238320682988
    val rand:  0.152810737490654
    val onPol:  0.37888189156850177
Training duration: 25.09 s

#####################################
performing on-policy MPC rollouts... iter  73
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.427914558920342
DONE TAKING  40  STEPS.
Total reward:  -652.1458165454846
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -15.04799899618434
DONE TAKING  40  STEPS.
Total reward:  -246.65525165552003
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.957362860700723
DONE TAKING  40  STEPS.
Total reward:  -916.832031271967
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.89296417660454
DONE TAKING  40  STEPS.
Total reward:  -499.47842302618227
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.127072754033872
DONE TAKING  40  STEPS.
Total reward:  67.54573029893592
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -24.763378119997927
DONE TAKING  40  STEPS.
Total reward:  -735.9825775398576
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.74519907272657
DONE TAKING  40  STEPS.
Total reward:  -779.1098508335917
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.81757928264245
DONE TAKING  40  STEPS.
Total reward:  -568.7920660057174
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -31.264385889198778
DONE TAKING  40  STEPS.
Total reward:  -872.6408684921403
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.206076517278717
DONE TAKING  40  STEPS.
Total reward:  -544.3774726228381
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.856303899719038
DONE TAKING  40  STEPS.
Total reward:  -970.7820377311722
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.604942432222508
DONE TAKING  40  STEPS.
Total reward:  -934.0857912347741
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -12.191957355558184
DONE TAKING  40  STEPS.
Total reward:  -94.27263151664535
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.427462228478568
DONE TAKING  40  STEPS.
Total reward:  207.65876471269326
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.145805212354027
DONE TAKING  40  STEPS.
Total reward:  -504.4452421551334
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.055376290114665
DONE TAKING  40  STEPS.
Total reward:  -321.0709608375952
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.48444533448597
DONE TAKING  40  STEPS.
Total reward:  -865.1676910514035
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.883907309297513
DONE TAKING  40  STEPS.
Total reward:  -727.716726919717
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -22.216161302448924
DONE TAKING  40  STEPS.
Total reward:  -674.2371030629199
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.841519451216783
DONE TAKING  40  STEPS.
Total reward:  -453.1815645147058
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.35588793266013
DONE TAKING  40  STEPS.
Total reward:  -725.2299412468884
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.68840960735438
DONE TAKING  40  STEPS.
Total reward:  -800.325356168191
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.432566286082707
DONE TAKING  40  STEPS.
Total reward:  -298.43243350047976
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.637418601108454
DONE TAKING  40  STEPS.
Total reward:  -717.733021710027
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.72902852501837
DONE TAKING  40  STEPS.
Total reward:  -642.6970080838859
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.420082373102233
DONE TAKING  40  STEPS.
Total reward:  -82.17083543080604
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -19.94745614358225
DONE TAKING  40  STEPS.
Total reward:  -435.1844681396933
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.28891104934553
DONE TAKING  40  STEPS.
Total reward:  -786.2127989220616
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.869848999033838
DONE TAKING  40  STEPS.
Total reward:  -310.79582517513694
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.099047958244398
DONE TAKING  40  STEPS.
Total reward:  -932.1999647554134
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -22.097043237308085
DONE TAKING  40  STEPS.
Total reward:  -439.38161234968806
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.241594954384073
DONE TAKING  40  STEPS.
Total reward:  -430.3532871561115
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.88257041571737
DONE TAKING  40  STEPS.
Total reward:  -541.0607856286357
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.404393152698496
DONE TAKING  40  STEPS.
Total reward:  -376.53118613094904
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.107810074322202
DONE TAKING  40  STEPS.
Total reward:  -401.617175729773
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.418537338665477
DONE TAKING  40  STEPS.
Total reward:  -769.9165254294758
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.945999392621196
DONE TAKING  40  STEPS.
Total reward:  -973.7782916329116
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.277550970781256
DONE TAKING  40  STEPS.
Total reward:  -589.4154513899774
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.38250318667577
DONE TAKING  40  STEPS.
Total reward:  -836.6901061792786
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.75287600988836
DONE TAKING  40  STEPS.
Total reward:  -444.3522276219178
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter73.ckpt
Iter: 74
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  74
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  22230
On pol:  28800
Prob shape:  (51030,)

=== Epoch 0 ===
    train loss:  0.42302860726009717
    val rand:  0.32050853967666626
    val onPol:  0.3520062466462453

=== Epoch 10 ===
    train loss:  0.18404714627699417
    val rand:  0.1861509084701538
    val onPol:  0.3128301203250885

=== Epoch 20 ===
    train loss:  0.1264526941860565
    val rand:  0.1607379913330078
    val onPol:  0.33632885416348773

=== Epoch 30 ===
    train loss:  0.0946195949659203
    val rand:  0.15535703301429749
    val onPol:  0.36026450991630554

=== Epoch 39 ===
    train loss:  0.07840014557645779
    val rand:  0.15135028958320618
    val onPol:  0.37689638137817383
Training duration: 26.27 s

#####################################
performing on-policy MPC rollouts... iter  74
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.45479272201642
DONE TAKING  40  STEPS.
Total reward:  9.56063488792309
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.157971314614997
DONE TAKING  40  STEPS.
Total reward:  -375.351280922555
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.080192209508983
DONE TAKING  40  STEPS.
Total reward:  -579.0029178553484
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.826294648194125
DONE TAKING  40  STEPS.
Total reward:  -1045.9785603139267
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.630556475878958
DONE TAKING  40  STEPS.
Total reward:  -803.0873300759232
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.977280139621804
DONE TAKING  40  STEPS.
Total reward:  -384.5444965543621
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.343446753516968
DONE TAKING  40  STEPS.
Total reward:  -265.7328707363892
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.32047682297962
DONE TAKING  40  STEPS.
Total reward:  -358.0519073751117
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.58037788310874
DONE TAKING  40  STEPS.
Total reward:  -1069.8689254362744
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.132315381334262
DONE TAKING  40  STEPS.
Total reward:  -40.04641433059328
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.099164185971624
DONE TAKING  40  STEPS.
Total reward:  -117.0269081276928
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.04531452707666
DONE TAKING  40  STEPS.
Total reward:  -631.130121228447
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.176664144752017
DONE TAKING  40  STEPS.
Total reward:  -729.3089503551008
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.73014140794238
DONE TAKING  40  STEPS.
Total reward:  -452.8050921126501
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.03378125824964
DONE TAKING  40  STEPS.
Total reward:  -411.15070970561186
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.97275254780653
DONE TAKING  40  STEPS.
Total reward:  -244.07124065356805
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.564042021609264
DONE TAKING  40  STEPS.
Total reward:  -534.4023366223774
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -22.71565893999934
DONE TAKING  40  STEPS.
Total reward:  -29.467469582792646
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.608991419763925
DONE TAKING  40  STEPS.
Total reward:  -466.26000715700684
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.650301858319061
DONE TAKING  40  STEPS.
Total reward:  -176.04126450097115
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -19.32884301091285
DONE TAKING  40  STEPS.
Total reward:  -321.87902317266776
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.056475266378875
DONE TAKING  40  STEPS.
Total reward:  -453.74025257355873
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.315150654453547
DONE TAKING  40  STEPS.
Total reward:  -501.0155495850012
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.13466510321058
DONE TAKING  40  STEPS.
Total reward:  -582.3179418257647
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.231529893220245
DONE TAKING  40  STEPS.
Total reward:  -537.9985004472733
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.476050375339614
DONE TAKING  40  STEPS.
Total reward:  -230.3346347349901
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.768656177791605
DONE TAKING  40  STEPS.
Total reward:  -1142.6377564019417
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.74076766855288
DONE TAKING  40  STEPS.
Total reward:  -611.2645051448205
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.976166613626432
DONE TAKING  40  STEPS.
Total reward:  -597.2847436707348
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.994182866806415
DONE TAKING  40  STEPS.
Total reward:  -573.5151827993275
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -15.878476930081824
DONE TAKING  40  STEPS.
Total reward:  -311.71311549033663
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.89695564386263
DONE TAKING  40  STEPS.
Total reward:  -264.14010235126824
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.931124327487844
DONE TAKING  40  STEPS.
Total reward:  -849.423751350298
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.662931516962466
DONE TAKING  40  STEPS.
Total reward:  -536.8479638446128
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.431607417211858
DONE TAKING  40  STEPS.
Total reward:  -336.8540111898408
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.339831928047477
DONE TAKING  40  STEPS.
Total reward:  -354.9815785892106
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.477232930022367
DONE TAKING  40  STEPS.
Total reward:  -799.2938185844787
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.265965456545494
DONE TAKING  40  STEPS.
Total reward:  -849.123929624442
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.388628335773866
DONE TAKING  40  STEPS.
Total reward:  -648.7954744669503
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.170244820012226
DONE TAKING  40  STEPS.
Total reward:  -921.298056321602
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter74.ckpt
Iter: 75
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  75
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  22425
On pol:  28800
Prob shape:  (51225,)

=== Epoch 0 ===
    train loss:  0.41688932657241823
    val rand:  0.305453896522522
    val onPol:  0.349283367395401

=== Epoch 10 ===
    train loss:  0.18270616844296456
    val rand:  0.18371126055717468
    val onPol:  0.3108738859494527

=== Epoch 20 ===
    train loss:  0.12232723370194436
    val rand:  0.16264209151268005
    val onPol:  0.3348359266916911

=== Epoch 30 ===
    train loss:  0.09184230335056781
    val rand:  0.15556418895721436
    val onPol:  0.3571290572484334

=== Epoch 39 ===
    train loss:  0.07590418316423893
    val rand:  0.156097874045372
    val onPol:  0.37684566775957745
Training duration: 25.37 s

#####################################
performing on-policy MPC rollouts... iter  75
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.830462591030464
DONE TAKING  40  STEPS.
Total reward:  -529.7411259533764
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.76146113419331
DONE TAKING  40  STEPS.
Total reward:  -784.4428029749391
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -10.758688245818979
DONE TAKING  40  STEPS.
Total reward:  -334.834594206503
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.616357884960543
DONE TAKING  40  STEPS.
Total reward:  -958.5968949342985
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -15.22761224284061
DONE TAKING  40  STEPS.
Total reward:  -310.7730069583068
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -15.539863806744432
DONE TAKING  40  STEPS.
Total reward:  -418.7388803653605
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.231784055767704
DONE TAKING  40  STEPS.
Total reward:  -731.1650402724543
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -11.138604032319305
DONE TAKING  40  STEPS.
Total reward:  -349.937984662295
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.807239325707606
DONE TAKING  40  STEPS.
Total reward:  -580.1032800406124
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.124513867741097
DONE TAKING  40  STEPS.
Total reward:  -593.8455622783326
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.546578338502975
DONE TAKING  40  STEPS.
Total reward:  -860.8032095824615
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.447693688185957
DONE TAKING  40  STEPS.
Total reward:  -1187.4929758774665
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.967171970837395
DONE TAKING  40  STEPS.
Total reward:  -685.7187388836584
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -27.042799632875898
DONE TAKING  40  STEPS.
Total reward:  -922.242584676102
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -16.39630908651468
DONE TAKING  40  STEPS.
Total reward:  -571.1201984715165
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.834049935626247
DONE TAKING  40  STEPS.
Total reward:  -764.078420633674
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.87003387632455
DONE TAKING  40  STEPS.
Total reward:  -339.9285619884946
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.186482839520096
DONE TAKING  40  STEPS.
Total reward:  -751.0592544813148
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.96121161493005
DONE TAKING  40  STEPS.
Total reward:  -851.8930233020529
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.327530800286347
DONE TAKING  40  STEPS.
Total reward:  -316.53818816136044
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.303177357790485
DONE TAKING  40  STEPS.
Total reward:  -399.4187982368399
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.423340404964684
DONE TAKING  40  STEPS.
Total reward:  -375.5005234116693
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.024674060601818
DONE TAKING  40  STEPS.
Total reward:  -442.5547394002214
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.917236237270615
DONE TAKING  40  STEPS.
Total reward:  -893.8073319186557
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.194539405472135
DONE TAKING  40  STEPS.
Total reward:  -684.4941234648566
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.78557610466391
DONE TAKING  40  STEPS.
Total reward:  -498.63334205626603
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -15.518903043773367
DONE TAKING  40  STEPS.
Total reward:  -402.75133366859666
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -30.49059116589122
DONE TAKING  40  STEPS.
Total reward:  -784.82040812512
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -15.03563467701574
DONE TAKING  40  STEPS.
Total reward:  -410.9189229769991
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.691015040210345
DONE TAKING  40  STEPS.
Total reward:  -367.28009369019844
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.847376977492758
DONE TAKING  40  STEPS.
Total reward:  -497.8352361842016
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.75162942433755
DONE TAKING  40  STEPS.
Total reward:  -868.4294014412783
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -12.461965987801964
DONE TAKING  40  STEPS.
Total reward:  -397.2265144834118
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.59411821879764
DONE TAKING  40  STEPS.
Total reward:  -790.6270492148059
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.944233757430688
DONE TAKING  40  STEPS.
Total reward:  -707.1560981526309
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -23.91615785623909
DONE TAKING  40  STEPS.
Total reward:  -806.102788489821
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.542387598171704
DONE TAKING  40  STEPS.
Total reward:  -773.907190660014
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.386807963696988
DONE TAKING  40  STEPS.
Total reward:  -419.9889519111547
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.863458127978777
DONE TAKING  40  STEPS.
Total reward:  -602.0624340038647
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.739585007701763
DONE TAKING  40  STEPS.
Total reward:  -525.4195212902976
Time for 1 rollout: 1.09 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter75.ckpt
Iter: 76
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  76
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  22620
On pol:  28800
Prob shape:  (51420,)

=== Epoch 0 ===
    train loss:  0.42655227273702623
    val rand:  0.30902692675590515
    val onPol:  0.3619062006473541

=== Epoch 10 ===
    train loss:  0.183989996612072
    val rand:  0.18349657952785492
    val onPol:  0.32033587495485943

=== Epoch 20 ===
    train loss:  0.12788554780185224
    val rand:  0.16260762512683868
    val onPol:  0.3431392312049866

=== Epoch 30 ===
    train loss:  0.09608887620270253
    val rand:  0.15519708395004272
    val onPol:  0.36511409282684326

=== Epoch 39 ===
    train loss:  0.0793582122772932
    val rand:  0.15811054408550262
    val onPol:  0.3848987619082133
Training duration: 26.45 s

#####################################
performing on-policy MPC rollouts... iter  76
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.99651897707865
DONE TAKING  40  STEPS.
Total reward:  -343.72076790483544
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -12.123517249676311
DONE TAKING  40  STEPS.
Total reward:  -489.25709707258574
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.02854520025911
DONE TAKING  40  STEPS.
Total reward:  -817.477208035249
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -12.824172216263905
DONE TAKING  40  STEPS.
Total reward:  -415.0788663349631
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.918156485566886
DONE TAKING  40  STEPS.
Total reward:  -627.3461009890939
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.25719314305021
DONE TAKING  40  STEPS.
Total reward:  -529.6978627985749
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.00215137429243
DONE TAKING  40  STEPS.
Total reward:  -799.9644848066314
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.188351551393023
DONE TAKING  40  STEPS.
Total reward:  -663.0061067481653
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.227906409186133
DONE TAKING  40  STEPS.
Total reward:  -480.90385184982676
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -16.72896877243831
DONE TAKING  40  STEPS.
Total reward:  -354.7927155696243
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.63239688348702
DONE TAKING  40  STEPS.
Total reward:  -268.37738229965976
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -15.832892401696261
DONE TAKING  40  STEPS.
Total reward:  -640.5335114743219
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -10.736851177900755
DONE TAKING  40  STEPS.
Total reward:  -387.81403334964676
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.812709096334174
DONE TAKING  40  STEPS.
Total reward:  -534.081254254082
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -31.250514795833215
DONE TAKING  40  STEPS.
Total reward:  -492.2781939660458
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.019868076506363
DONE TAKING  40  STEPS.
Total reward:  -658.2525270580184
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.655872061366914
DONE TAKING  40  STEPS.
Total reward:  -778.8723332421672
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.626566934131112
DONE TAKING  40  STEPS.
Total reward:  -845.6612936375261
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.27967293886912
DONE TAKING  40  STEPS.
Total reward:  -413.4992291822159
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -19.664963479904646
DONE TAKING  40  STEPS.
Total reward:  -780.254579382034
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.18758790378159
DONE TAKING  40  STEPS.
Total reward:  -336.53747912496453
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.50972518902067
DONE TAKING  40  STEPS.
Total reward:  -560.5152817231827
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.865145681440605
DONE TAKING  40  STEPS.
Total reward:  -954.6173971225313
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.836406541234574
DONE TAKING  40  STEPS.
Total reward:  -962.3137260628345
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.786518644687572
DONE TAKING  40  STEPS.
Total reward:  -716.6723602504574
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.24049844364195
DONE TAKING  40  STEPS.
Total reward:  -202.67755199163108
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -10.934876863315601
DONE TAKING  40  STEPS.
Total reward:  -147.63575653495306
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.447267473330463
DONE TAKING  40  STEPS.
Total reward:  -686.8523067838984
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.836004881280676
DONE TAKING  40  STEPS.
Total reward:  -1044.5345621636077
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.108605948599067
DONE TAKING  40  STEPS.
Total reward:  -531.051286044553
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.696069993811975
DONE TAKING  40  STEPS.
Total reward:  -552.0541491223591
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.975614388315837
DONE TAKING  40  STEPS.
Total reward:  -593.0882142593382
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.263413642431793
DONE TAKING  40  STEPS.
Total reward:  -696.5887444536785
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.322688611545885
DONE TAKING  40  STEPS.
Total reward:  -637.78144894203
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.308547081283443
DONE TAKING  40  STEPS.
Total reward:  -380.3231416464321
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -13.883588283059346
DONE TAKING  40  STEPS.
Total reward:  -351.03727497772024
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.68171747978694
DONE TAKING  40  STEPS.
Total reward:  -918.8190650116057
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -14.232417261847555
DONE TAKING  40  STEPS.
Total reward:  -156.4217552336557
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.346425320027336
DONE TAKING  40  STEPS.
Total reward:  -762.2458750226677
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.0020302966591
DONE TAKING  40  STEPS.
Total reward:  -531.8757133973922
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter76.ckpt
Iter: 77
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  77
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  22815
On pol:  28800
Prob shape:  (51615,)

=== Epoch 0 ===
    train loss:  0.42699153661727907
    val rand:  0.318599671125412
    val onPol:  0.3643607497215271

=== Epoch 10 ===
    train loss:  0.18377787590026856
    val rand:  0.1806609034538269
    val onPol:  0.3225206236044566

=== Epoch 20 ===
    train loss:  0.12590637646615505
    val rand:  0.16522316634655
    val onPol:  0.3463593125343323

=== Epoch 30 ===
    train loss:  0.09565155871212483
    val rand:  0.1552715003490448
    val onPol:  0.3680869440237681

=== Epoch 39 ===
    train loss:  0.07886349827051163
    val rand:  0.1555454432964325
    val onPol:  0.38488130768140155
Training duration: 25.35 s

#####################################
performing on-policy MPC rollouts... iter  77
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.12254967585996
DONE TAKING  40  STEPS.
Total reward:  -493.70499980327645
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.43925454687635
DONE TAKING  40  STEPS.
Total reward:  -508.4009783740904
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.510385207154123
DONE TAKING  40  STEPS.
Total reward:  -551.372621682572
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.001353558310644
DONE TAKING  40  STEPS.
Total reward:  -592.7103044360451
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.186952791813304
DONE TAKING  40  STEPS.
Total reward:  5.545987314745783
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.692669520854118
DONE TAKING  40  STEPS.
Total reward:  -632.2349546984971
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.41324434821154
DONE TAKING  40  STEPS.
Total reward:  -742.6666129622367
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.746461373455887
DONE TAKING  40  STEPS.
Total reward:  -746.062939093082
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -17.80466408332762
DONE TAKING  40  STEPS.
Total reward:  -330.4316911824858
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.846212069125773
DONE TAKING  40  STEPS.
Total reward:  -675.8846812882534
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.734612506099634
DONE TAKING  40  STEPS.
Total reward:  -738.3829013183696
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.532289141985164
DONE TAKING  40  STEPS.
Total reward:  -859.1135968413466
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.032277344204488
DONE TAKING  40  STEPS.
Total reward:  -795.0404740429806
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.5579208455112
DONE TAKING  40  STEPS.
Total reward:  -339.28935351200727
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -14.269958485755428
DONE TAKING  40  STEPS.
Total reward:  -487.85994854434824
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.982866715961556
DONE TAKING  40  STEPS.
Total reward:  -769.53813192272
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.12753881134769
DONE TAKING  40  STEPS.
Total reward:  -268.8764226593043
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.940066215710626
DONE TAKING  40  STEPS.
Total reward:  -251.74343572983548
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.013516771024555
DONE TAKING  40  STEPS.
Total reward:  -528.2245838846032
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.738239225328535
DONE TAKING  40  STEPS.
Total reward:  -763.1869284685148
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.171252248347976
DONE TAKING  40  STEPS.
Total reward:  -447.1099851360433
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.869122050653605
DONE TAKING  40  STEPS.
Total reward:  -996.0379265660818
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.70688128762537
DONE TAKING  40  STEPS.
Total reward:  -717.4611590906941
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -15.687388525372496
DONE TAKING  40  STEPS.
Total reward:  -353.62918087087047
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.035957920403277
DONE TAKING  40  STEPS.
Total reward:  -369.33253986870426
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -17.464338799469754
DONE TAKING  40  STEPS.
Total reward:  -356.14043319341255
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.78990969458091
DONE TAKING  40  STEPS.
Total reward:  -184.30512935604767
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.47080968450595
DONE TAKING  40  STEPS.
Total reward:  -891.6822176753725
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -24.46591400807008
DONE TAKING  40  STEPS.
Total reward:  -406.38828276811967
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -16.67247227099795
DONE TAKING  40  STEPS.
Total reward:  -577.8577390140263
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.65965066650697
DONE TAKING  40  STEPS.
Total reward:  -677.7993497891441
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.119317309159225
DONE TAKING  40  STEPS.
Total reward:  -345.6024640037256
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.800087535228872
DONE TAKING  40  STEPS.
Total reward:  -543.5812076728912
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -31.251408168224252
DONE TAKING  40  STEPS.
Total reward:  -856.6252598493246
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.061248709673222
DONE TAKING  40  STEPS.
Total reward:  -617.1028463503785
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -17.9448843013757
DONE TAKING  40  STEPS.
Total reward:  -435.9219357166377
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.254982913328853
DONE TAKING  40  STEPS.
Total reward:  -676.3269597678694
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.957747240602547
DONE TAKING  40  STEPS.
Total reward:  -533.0521466850498
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.773228907388845
DONE TAKING  40  STEPS.
Total reward:  -214.67314575552138
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.283779365384351
DONE TAKING  40  STEPS.
Total reward:  -222.9516944632481
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter77.ckpt
Iter: 78
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  78
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23010
On pol:  28800
Prob shape:  (51810,)

=== Epoch 0 ===
    train loss:  0.42100860694847486
    val rand:  0.3129773736000061
    val onPol:  0.35354334115982056

=== Epoch 10 ===
    train loss:  0.18222577825631245
    val rand:  0.17990514636039734
    val onPol:  0.3144219716389974

=== Epoch 20 ===
    train loss:  0.12437032694273656
    val rand:  0.15876857936382294
    val onPol:  0.33745407064755756

=== Epoch 30 ===
    train loss:  0.09381334004130694
    val rand:  0.15453091263771057
    val onPol:  0.3614964783191681

=== Epoch 39 ===
    train loss:  0.0787703697339143
    val rand:  0.15339212119579315
    val onPol:  0.3772052228450775
Training duration: 26.55 s

#####################################
performing on-policy MPC rollouts... iter  78
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.63847057634697
DONE TAKING  40  STEPS.
Total reward:  -587.176703304766
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.849726653977896
DONE TAKING  40  STEPS.
Total reward:  -794.3944340800618
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.85074825178438
DONE TAKING  40  STEPS.
Total reward:  -551.806823378472
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.027582270108184
DONE TAKING  40  STEPS.
Total reward:  -975.8497560782369
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.46556736541135
DONE TAKING  40  STEPS.
Total reward:  -340.94332026747975
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.58474879053083
DONE TAKING  40  STEPS.
Total reward:  -516.2925681413411
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -12.978617699100962
DONE TAKING  40  STEPS.
Total reward:  -489.8840090972367
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.852678228867113
DONE TAKING  40  STEPS.
Total reward:  -417.49878100028616
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.19594657410293
DONE TAKING  40  STEPS.
Total reward:  -798.6859440690505
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.97264848700156
DONE TAKING  40  STEPS.
Total reward:  -648.09721052402
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.61268265277499
DONE TAKING  40  STEPS.
Total reward:  -373.9293657413003
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.202552365495496
DONE TAKING  40  STEPS.
Total reward:  -378.51084128222004
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.180511971408787
DONE TAKING  40  STEPS.
Total reward:  -341.5489891230594
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.792730877995435
DONE TAKING  40  STEPS.
Total reward:  -405.5776678005656
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.94088315523197
DONE TAKING  40  STEPS.
Total reward:  -368.1840678858558
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -12.36795726966992
DONE TAKING  40  STEPS.
Total reward:  -265.8008160304449
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.62908863907715
DONE TAKING  40  STEPS.
Total reward:  -759.1933521704796
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.197725842180843
DONE TAKING  40  STEPS.
Total reward:  -513.3287639701206
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -16.191112333264993
DONE TAKING  40  STEPS.
Total reward:  -540.7687981744297
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.830824599422304
DONE TAKING  40  STEPS.
Total reward:  -782.5333372498792
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.70767754447966
DONE TAKING  40  STEPS.
Total reward:  -521.5183910203086
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.766533963140766
DONE TAKING  40  STEPS.
Total reward:  -842.1647265232466
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.777911836297044
DONE TAKING  40  STEPS.
Total reward:  -650.992956692975
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.408620012722615
DONE TAKING  40  STEPS.
Total reward:  -269.6581675682238
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.16335667710193
DONE TAKING  40  STEPS.
Total reward:  -857.1232008701567
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -11.635149538950307
DONE TAKING  40  STEPS.
Total reward:  -383.1096658597502
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.494348668552222
DONE TAKING  40  STEPS.
Total reward:  -381.0058187552695
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -20.701894058142965
DONE TAKING  40  STEPS.
Total reward:  -401.0662453485249
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -15.833819092940754
DONE TAKING  40  STEPS.
Total reward:  -349.83256409446665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -18.169134174335056
DONE TAKING  40  STEPS.
Total reward:  -431.1807572427504
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -22.873592967430426
DONE TAKING  40  STEPS.
Total reward:  -681.779440964373
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.220346498361575
DONE TAKING  40  STEPS.
Total reward:  -525.923239449769
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.20484671452467
DONE TAKING  40  STEPS.
Total reward:  -420.43764172313945
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.422140212387713
DONE TAKING  40  STEPS.
Total reward:  -869.8766561519631
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -8.887462661778777
DONE TAKING  40  STEPS.
Total reward:  -389.0680339277965
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.410594391856243
DONE TAKING  40  STEPS.
Total reward:  -925.3523609655483
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -12.632940388652036
DONE TAKING  40  STEPS.
Total reward:  -398.46838942952667
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.806715321724997
DONE TAKING  40  STEPS.
Total reward:  -842.0693248361418
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.75482784684251
DONE TAKING  40  STEPS.
Total reward:  -798.8938057229196
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.765136741385298
DONE TAKING  40  STEPS.
Total reward:  -545.0790647291441
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter78.ckpt
Iter: 79
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  79
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23205
On pol:  28800
Prob shape:  (52005,)

=== Epoch 0 ===
    train loss:  0.4212734843834792
    val rand:  0.3155287504196167
    val onPol:  0.36464134852091473

=== Epoch 10 ===
    train loss:  0.18504679763671195
    val rand:  0.17536237835884094
    val onPol:  0.33028216163317364

=== Epoch 20 ===
    train loss:  0.12574764621434825
    val rand:  0.16511011123657227
    val onPol:  0.35265515247980755

=== Epoch 30 ===
    train loss:  0.0953418455354058
    val rand:  0.15725910663604736
    val onPol:  0.3769863148530324

=== Epoch 39 ===
    train loss:  0.08028479363068496
    val rand:  0.1542489230632782
    val onPol:  0.3933413525422414
Training duration: 25.41 s

#####################################
performing on-policy MPC rollouts... iter  79
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.387776044732686
DONE TAKING  40  STEPS.
Total reward:  -1025.3431503137251
Time for 1 rollout: 1.40 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.93090762938244
DONE TAKING  40  STEPS.
Total reward:  -686.8867732788138
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -11.574870826907816
DONE TAKING  40  STEPS.
Total reward:  -289.9075746213199
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -14.5342833117609
DONE TAKING  40  STEPS.
Total reward:  -11.674588770309306
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.539508716093593
DONE TAKING  40  STEPS.
Total reward:  -756.9251868834209
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.760328001853495
DONE TAKING  40  STEPS.
Total reward:  -82.53383241117567
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -13.395058568660192
DONE TAKING  40  STEPS.
Total reward:  -330.6041027271764
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -31.01705253305859
DONE TAKING  40  STEPS.
Total reward:  -848.2736299136897
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.71031316791275
DONE TAKING  40  STEPS.
Total reward:  -931.1291127243529
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.107369435024793
DONE TAKING  40  STEPS.
Total reward:  -584.9520540022003
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.903880889465167
DONE TAKING  40  STEPS.
Total reward:  -330.8396092896844
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.548355214556615
DONE TAKING  40  STEPS.
Total reward:  -420.5592365805143
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.99103295111695
DONE TAKING  40  STEPS.
Total reward:  -646.1446617270691
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -18.955653619950063
DONE TAKING  40  STEPS.
Total reward:  -565.5571245519376
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.571285634818114
DONE TAKING  40  STEPS.
Total reward:  -692.3965574260872
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.19689436699712
DONE TAKING  40  STEPS.
Total reward:  -592.4190989145126
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.635746311378018
DONE TAKING  40  STEPS.
Total reward:  -731.9415418292957
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.81694560255288
DONE TAKING  40  STEPS.
Total reward:  -853.3815926312914
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.253640669332334
DONE TAKING  40  STEPS.
Total reward:  -592.0881779938874
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.657290116473302
DONE TAKING  40  STEPS.
Total reward:  -849.9519698216153
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.192384465056424
DONE TAKING  40  STEPS.
Total reward:  -415.1305703020391
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.179898058223852
DONE TAKING  40  STEPS.
Total reward:  -712.9236858960398
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -15.624232005457564
DONE TAKING  40  STEPS.
Total reward:  -390.89652616625307
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.694113267591447
DONE TAKING  40  STEPS.
Total reward:  -617.883437952798
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.69055660686535
DONE TAKING  40  STEPS.
Total reward:  -711.2254896395145
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -31.41173171013684
DONE TAKING  40  STEPS.
Total reward:  -847.670522074214
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.72395287943499
DONE TAKING  40  STEPS.
Total reward:  -951.314122639804
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.28170434524813
DONE TAKING  40  STEPS.
Total reward:  -609.6129781464198
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.014531007099936
DONE TAKING  40  STEPS.
Total reward:  -492.35038979703063
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -18.313591967095068
DONE TAKING  40  STEPS.
Total reward:  -639.2430723165216
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.21942646812385
DONE TAKING  40  STEPS.
Total reward:  -905.2376762967374
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.45099323135728
DONE TAKING  40  STEPS.
Total reward:  -520.4621637072808
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.409674363432867
DONE TAKING  40  STEPS.
Total reward:  -989.7689206372349
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.466372951013177
DONE TAKING  40  STEPS.
Total reward:  -830.5829150491728
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.273529862330605
DONE TAKING  40  STEPS.
Total reward:  -581.0310865748737
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.315620123517846
DONE TAKING  40  STEPS.
Total reward:  -675.3439020829371
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -26.990825959409463
DONE TAKING  40  STEPS.
Total reward:  -601.4751310523317
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.82422335402889
DONE TAKING  40  STEPS.
Total reward:  -689.9492330086
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.340640468273698
DONE TAKING  40  STEPS.
Total reward:  -690.3037823458612
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.628495061603644
DONE TAKING  40  STEPS.
Total reward:  -662.0920811763651
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter79.ckpt
Iter: 80
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  80
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23400
On pol:  28800
Prob shape:  (52200,)

=== Epoch 0 ===
    train loss:  0.4214590870507873
    val rand:  0.3111119270324707
    val onPol:  0.3583339552084605

=== Epoch 10 ===
    train loss:  0.18452813941063267
    val rand:  0.18640010058879852
    val onPol:  0.3204833169778188

=== Epoch 20 ===
    train loss:  0.12737008929252625
    val rand:  0.1649438440799713
    val onPol:  0.3378869295120239

=== Epoch 30 ===
    train loss:  0.09752214043447287
    val rand:  0.1562749743461609
    val onPol:  0.36335010329882306

=== Epoch 39 ===
    train loss:  0.08045649978488979
    val rand:  0.15345843136310577
    val onPol:  0.3813660840193431
Training duration: 26.58 s

#####################################
performing on-policy MPC rollouts... iter  80
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.38246761504889
DONE TAKING  40  STEPS.
Total reward:  -618.0443302725304
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -31.353891454672215
DONE TAKING  40  STEPS.
Total reward:  -742.5466543530289
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -11.703280180627548
DONE TAKING  40  STEPS.
Total reward:  -391.22653261302116
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -20.718186687730498
DONE TAKING  40  STEPS.
Total reward:  -324.9616929762284
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -23.562563844147938
DONE TAKING  40  STEPS.
Total reward:  -571.3016757522151
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.864952372491008
DONE TAKING  40  STEPS.
Total reward:  -875.7375569504112
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.20065138830327
DONE TAKING  40  STEPS.
Total reward:  -1008.3630651305328
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.097349353900796
DONE TAKING  40  STEPS.
Total reward:  -941.7565247888581
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.436812130701956
DONE TAKING  40  STEPS.
Total reward:  -308.5980695614276
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.41983152822823
DONE TAKING  40  STEPS.
Total reward:  -657.705828397118
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.503527841789058
DONE TAKING  40  STEPS.
Total reward:  -869.3278631040258
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -14.72673620964704
DONE TAKING  40  STEPS.
Total reward:  -548.4836491942784
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.550795736306284
DONE TAKING  40  STEPS.
Total reward:  -444.68518371244835
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -27.68757457705376
DONE TAKING  40  STEPS.
Total reward:  -982.2312255481731
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.346950475679026
DONE TAKING  40  STEPS.
Total reward:  -572.3095139209133
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.914116397745335
DONE TAKING  40  STEPS.
Total reward:  -576.6962528472941
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -12.020482590191229
DONE TAKING  40  STEPS.
Total reward:  -481.4562874505277
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.0355494297005
DONE TAKING  40  STEPS.
Total reward:  -68.1968454627193
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.883206642536972
DONE TAKING  40  STEPS.
Total reward:  -1180.6915232427768
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.359478801789365
DONE TAKING  40  STEPS.
Total reward:  -817.5481753197604
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.061587680397828
DONE TAKING  40  STEPS.
Total reward:  -685.3204968205761
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.963894935056828
DONE TAKING  40  STEPS.
Total reward:  -566.9126697219411
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.754946378600756
DONE TAKING  40  STEPS.
Total reward:  -427.82358767685696
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.7415536913767
DONE TAKING  40  STEPS.
Total reward:  -835.7042956591986
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -14.520297233506083
DONE TAKING  40  STEPS.
Total reward:  -467.0520024078118
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.509262114505976
DONE TAKING  40  STEPS.
Total reward:  210.3353937468622
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.07339712121217
DONE TAKING  40  STEPS.
Total reward:  -617.5134249249659
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -31.112210970938904
DONE TAKING  40  STEPS.
Total reward:  -809.32979614875
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.006510351930036
DONE TAKING  40  STEPS.
Total reward:  -301.1897096897886
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -15.895018497771748
DONE TAKING  40  STEPS.
Total reward:  -355.3799761229115
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -14.120102975205906
DONE TAKING  40  STEPS.
Total reward:  -224.02429371948764
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.45297885875722
DONE TAKING  40  STEPS.
Total reward:  -816.3886981328876
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.5774283223589
DONE TAKING  40  STEPS.
Total reward:  -696.6888487560894
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.49737432685547
DONE TAKING  40  STEPS.
Total reward:  -730.520129026971
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.428097225713785
DONE TAKING  40  STEPS.
Total reward:  -670.4277362245874
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.424264048587652
DONE TAKING  40  STEPS.
Total reward:  64.15951811700302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.29038049570307
DONE TAKING  40  STEPS.
Total reward:  -402.38419760064005
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.00915447828334
DONE TAKING  40  STEPS.
Total reward:  -193.93626318566336
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.286459407888856
DONE TAKING  40  STEPS.
Total reward:  -813.4453418471034
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.283605098987433
DONE TAKING  40  STEPS.
Total reward:  -509.20571875955835
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter80.ckpt
Iter: 81
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  81
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23595
On pol:  28800
Prob shape:  (52395,)

=== Epoch 0 ===
    train loss:  0.4198948960093891
    val rand:  0.30825310945510864
    val onPol:  0.3614851435025533

=== Epoch 10 ===
    train loss:  0.18317225663100972
    val rand:  0.18464194238185883
    val onPol:  0.32550083597501117

=== Epoch 20 ===
    train loss:  0.12688277837108164
    val rand:  0.16127066314220428
    val onPol:  0.3464992145697276

=== Epoch 30 ===
    train loss:  0.09609518813736298
    val rand:  0.15705019235610962
    val onPol:  0.3681402901808421

=== Epoch 39 ===
    train loss:  0.08027722986013282
    val rand:  0.15195360779762268
    val onPol:  0.3855213026205699
Training duration: 25.55 s

#####################################
performing on-policy MPC rollouts... iter  81
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.198353447359743
DONE TAKING  40  STEPS.
Total reward:  -763.9192848304409
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.521066329453873
DONE TAKING  40  STEPS.
Total reward:  -495.79445775843436
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -26.45465183918763
DONE TAKING  40  STEPS.
Total reward:  -357.2746916510253
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.09993751747527
DONE TAKING  40  STEPS.
Total reward:  -114.38607852492478
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.707990166613314
DONE TAKING  40  STEPS.
Total reward:  -954.8066780577282
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.757547244501737
DONE TAKING  40  STEPS.
Total reward:  -177.0165332800682
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.6337943124144
DONE TAKING  40  STEPS.
Total reward:  -414.7827778021149
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.200852320847392
DONE TAKING  40  STEPS.
Total reward:  -1041.6158039683849
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.805038087940673
DONE TAKING  40  STEPS.
Total reward:  -819.1854674037197
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -24.87877247785811
DONE TAKING  40  STEPS.
Total reward:  -693.8833835186368
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -12.593855850886044
DONE TAKING  40  STEPS.
Total reward:  -301.0746035754726
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.291758823497258
DONE TAKING  40  STEPS.
Total reward:  -792.549812699154
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.994733206093066
DONE TAKING  40  STEPS.
Total reward:  -680.274454399887
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.31955392889122
DONE TAKING  40  STEPS.
Total reward:  -287.4033938794688
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.654168403560227
DONE TAKING  40  STEPS.
Total reward:  -668.5661564573272
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.485240832779837
DONE TAKING  40  STEPS.
Total reward:  -710.2365302429663
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.163865697659215
DONE TAKING  40  STEPS.
Total reward:  -738.5046955791629
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.340150807266866
DONE TAKING  40  STEPS.
Total reward:  -516.5121425438575
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.24259733286013
DONE TAKING  40  STEPS.
Total reward:  -569.1123607976833
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.461768685963104
DONE TAKING  40  STEPS.
Total reward:  -475.5989476865678
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -31.168781070645103
DONE TAKING  40  STEPS.
Total reward:  -755.5381597960708
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.521815920133797
DONE TAKING  40  STEPS.
Total reward:  -443.0022724311068
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.42892824025959
DONE TAKING  40  STEPS.
Total reward:  -964.0247009659785
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -11.321589765842234
DONE TAKING  40  STEPS.
Total reward:  -189.30125103314816
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -12.544477676330148
DONE TAKING  40  STEPS.
Total reward:  -248.41032265362284
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.927167420063967
DONE TAKING  40  STEPS.
Total reward:  113.0623334228615
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.528068609005217
DONE TAKING  40  STEPS.
Total reward:  -479.6612833216474
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -13.648261692316922
DONE TAKING  40  STEPS.
Total reward:  -202.39849974421296
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.52219385685407
DONE TAKING  40  STEPS.
Total reward:  -965.3342252906891
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.945832431098253
DONE TAKING  40  STEPS.
Total reward:  -804.0854775276302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.0241781708432
DONE TAKING  40  STEPS.
Total reward:  -828.2713422785603
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -16.74683938881727
DONE TAKING  40  STEPS.
Total reward:  -367.082229032836
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -18.2329583838627
DONE TAKING  40  STEPS.
Total reward:  -597.6983878871389
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -17.258286950633146
DONE TAKING  40  STEPS.
Total reward:  -534.572616083234
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.319250611972784
DONE TAKING  40  STEPS.
Total reward:  -854.6971128243155
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -18.912692712056693
DONE TAKING  40  STEPS.
Total reward:  -532.4454440055654
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.063661051114558
DONE TAKING  40  STEPS.
Total reward:  -553.3233298796441
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -27.327185281521604
DONE TAKING  40  STEPS.
Total reward:  -521.9048407197712
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.649106338031032
DONE TAKING  40  STEPS.
Total reward:  -618.7340226395065
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -11.388453261743392
DONE TAKING  40  STEPS.
Total reward:  -222.69715977236194
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter81.ckpt
Iter: 82
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  82
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23790
On pol:  28800
Prob shape:  (52590,)

=== Epoch 0 ===
    train loss:  0.42111991229010565
    val rand:  0.3137133717536926
    val onPol:  0.3649204572041829

=== Epoch 10 ===
    train loss:  0.1846312560579356
    val rand:  0.18527387082576752
    val onPol:  0.3298014501730601

=== Epoch 20 ===
    train loss:  0.12752040899267383
    val rand:  0.1625966578722
    val onPol:  0.35211052497227985

=== Epoch 30 ===
    train loss:  0.09715427429068323
    val rand:  0.16007624566555023
    val onPol:  0.37068965037663776

=== Epoch 39 ===
    train loss:  0.08152090487819091
    val rand:  0.15666958689689636
    val onPol:  0.3858238657315572
Training duration: 27.05 s

#####################################
performing on-policy MPC rollouts... iter  82
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.623440965850463
DONE TAKING  40  STEPS.
Total reward:  -566.2354836364939
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.430958610393198
DONE TAKING  40  STEPS.
Total reward:  -312.69983685739606
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -13.274478737141715
DONE TAKING  40  STEPS.
Total reward:  -430.97972707228496
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.670638885647605
DONE TAKING  40  STEPS.
Total reward:  -699.6482209262631
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.354773893122477
DONE TAKING  40  STEPS.
Total reward:  -267.81087770976137
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.815741905582755
DONE TAKING  40  STEPS.
Total reward:  -310.6071252989457
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -21.69900602003508
DONE TAKING  40  STEPS.
Total reward:  -147.3265561326226
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.892201246368646
DONE TAKING  40  STEPS.
Total reward:  -691.8260253320307
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.992781029951512
DONE TAKING  40  STEPS.
Total reward:  -568.3808602429395
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.724324430621376
DONE TAKING  40  STEPS.
Total reward:  -337.6387036668377
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.35064538351904
DONE TAKING  40  STEPS.
Total reward:  -797.3253559739559
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.27730629616876
DONE TAKING  40  STEPS.
Total reward:  -585.4216804684128
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -15.453110112598294
DONE TAKING  40  STEPS.
Total reward:  -374.15555330138824
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -9.892450429564875
DONE TAKING  40  STEPS.
Total reward:  -326.65927577086654
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.053945893892735
DONE TAKING  40  STEPS.
Total reward:  -690.4924109863505
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.83892481817994
DONE TAKING  40  STEPS.
Total reward:  -482.1610930072181
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.68764382081176
DONE TAKING  40  STEPS.
Total reward:  -599.8364894429677
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.559943554436366
DONE TAKING  40  STEPS.
Total reward:  -1070.785390187662
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.29334925431783
DONE TAKING  40  STEPS.
Total reward:  -853.1496542936841
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.282275615358287
DONE TAKING  40  STEPS.
Total reward:  -643.2041851116838
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.698779092662168
DONE TAKING  40  STEPS.
Total reward:  -856.6691894547187
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.71369493134259
DONE TAKING  40  STEPS.
Total reward:  -1012.3735323643631
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.32111926281955
DONE TAKING  40  STEPS.
Total reward:  -468.2390568158082
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.097300444436875
DONE TAKING  40  STEPS.
Total reward:  -1009.6536549495787
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -13.098212318931672
DONE TAKING  40  STEPS.
Total reward:  -439.83236271152936
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.270301465745792
DONE TAKING  40  STEPS.
Total reward:  -885.5206804942205
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.592909022531586
DONE TAKING  40  STEPS.
Total reward:  -378.2878038390725
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.27854606966124
DONE TAKING  40  STEPS.
Total reward:  185.72505650598507
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.896014089447895
DONE TAKING  40  STEPS.
Total reward:  -787.4830269923431
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.7109427340524
DONE TAKING  40  STEPS.
Total reward:  -561.8069915457407
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.652437587006542
DONE TAKING  40  STEPS.
Total reward:  -539.9212968502494
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.78400993038661
DONE TAKING  40  STEPS.
Total reward:  -613.5247050923209
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.288891056540372
DONE TAKING  40  STEPS.
Total reward:  -51.30226974050588
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.56862178579862
DONE TAKING  40  STEPS.
Total reward:  -1123.7153623527001
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -19.598160016414614
DONE TAKING  40  STEPS.
Total reward:  -441.8954276218006
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.045056513870556
DONE TAKING  40  STEPS.
Total reward:  -734.6511363698033
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.885557726100952
DONE TAKING  40  STEPS.
Total reward:  -349.7914113681132
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.180160937870127
DONE TAKING  40  STEPS.
Total reward:  -584.3775393124907
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.125907793433175
DONE TAKING  40  STEPS.
Total reward:  -187.30743942521747
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -16.78425864085858
DONE TAKING  40  STEPS.
Total reward:  -424.7718144438518
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter82.ckpt
Iter: 83
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  83
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  23985
On pol:  28800
Prob shape:  (52785,)

=== Epoch 0 ===
    train loss:  0.41657170335065974
    val rand:  0.3113361597061157
    val onPol:  0.3592735429604848

=== Epoch 10 ===
    train loss:  0.1815113023068141
    val rand:  0.18349051475524902
    val onPol:  0.3226456542809804

=== Epoch 20 ===
    train loss:  0.12548185414770274
    val rand:  0.16187767684459686
    val onPol:  0.34183982014656067

=== Epoch 30 ===
    train loss:  0.0942370938589272
    val rand:  0.15316157042980194
    val onPol:  0.3612414201100667

=== Epoch 39 ===
    train loss:  0.07871485096447677
    val rand:  0.14837495982646942
    val onPol:  0.37596839666366577
Training duration: 25.80 s

#####################################
performing on-policy MPC rollouts... iter  83
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.035876828411453
DONE TAKING  40  STEPS.
Total reward:  -1012.0528636198322
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.27488853506468
DONE TAKING  40  STEPS.
Total reward:  -1018.9997153045076
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.11319347798861
DONE TAKING  40  STEPS.
Total reward:  -132.7128173851691
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -29.45057783602391
DONE TAKING  40  STEPS.
Total reward:  -584.7279974490166
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -20.840927745929577
DONE TAKING  40  STEPS.
Total reward:  -434.28204246984603
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.89694145035824
DONE TAKING  40  STEPS.
Total reward:  -515.1071091816157
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -9.592315815855985
DONE TAKING  40  STEPS.
Total reward:  -339.5793590773865
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.227344519405367
DONE TAKING  40  STEPS.
Total reward:  -857.3240848999083
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.24433883527255
DONE TAKING  40  STEPS.
Total reward:  -662.9727565320637
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.422301076797442
DONE TAKING  40  STEPS.
Total reward:  -421.6805496207541
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -17.458140441977534
DONE TAKING  40  STEPS.
Total reward:  -366.2166761257269
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.02436430867209
DONE TAKING  40  STEPS.
Total reward:  -441.4591343341494
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.615122908879503
DONE TAKING  40  STEPS.
Total reward:  -430.59803071321363
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -31.178383150242812
DONE TAKING  40  STEPS.
Total reward:  -495.6349381006077
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -18.68055826926983
DONE TAKING  40  STEPS.
Total reward:  -426.9180957842032
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.428224581463688
DONE TAKING  40  STEPS.
Total reward:  -795.61819299056
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.576634414943413
DONE TAKING  40  STEPS.
Total reward:  -894.5651027736452
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.567081801350414
DONE TAKING  40  STEPS.
Total reward:  -392.09790146618576
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.903847172042518
DONE TAKING  40  STEPS.
Total reward:  -581.8820506513672
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.991773561436794
DONE TAKING  40  STEPS.
Total reward:  -883.366950028292
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.95491751911893
DONE TAKING  40  STEPS.
Total reward:  -771.8231215274865
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.852360151802046
DONE TAKING  40  STEPS.
Total reward:  -676.2037910897252
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.220123693177086
DONE TAKING  40  STEPS.
Total reward:  -186.2973296760447
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.59362435902683
DONE TAKING  40  STEPS.
Total reward:  -701.3417558103616
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -14.485945729187852
DONE TAKING  40  STEPS.
Total reward:  -369.9941741719116
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.010325658002916
DONE TAKING  40  STEPS.
Total reward:  -279.5099774793036
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.927711409077823
DONE TAKING  40  STEPS.
Total reward:  -932.9615133290065
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.646974092976897
DONE TAKING  40  STEPS.
Total reward:  -417.98392943060077
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.668253494913152
DONE TAKING  40  STEPS.
Total reward:  -683.2602148202044
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.876593823925145
DONE TAKING  40  STEPS.
Total reward:  -791.6330481529169
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.21393022184359
DONE TAKING  40  STEPS.
Total reward:  -490.81930233680777
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.46532675919527
DONE TAKING  40  STEPS.
Total reward:  -1140.2755252468974
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.53799533945927
DONE TAKING  40  STEPS.
Total reward:  -257.683850682183
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -31.37759415567256
DONE TAKING  40  STEPS.
Total reward:  -433.4062645240533
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.742899369699018
DONE TAKING  40  STEPS.
Total reward:  -747.1585174034923
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.966191636705787
DONE TAKING  40  STEPS.
Total reward:  -715.9482699273542
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -13.101849209148678
DONE TAKING  40  STEPS.
Total reward:  -54.0290533859257
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.68108810361469
DONE TAKING  40  STEPS.
Total reward:  -712.1009363415843
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.05376326465754
DONE TAKING  40  STEPS.
Total reward:  -392.3919278762179
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.827703012698514
DONE TAKING  40  STEPS.
Total reward:  -407.73360220422103
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter83.ckpt
Iter: 84
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  84
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  24180
On pol:  28800
Prob shape:  (52980,)

=== Epoch 0 ===
    train loss:  0.4278825399945083
    val rand:  0.3101963400840759
    val onPol:  0.37673776348431903

=== Epoch 10 ===
    train loss:  0.1866430190292377
    val rand:  0.18275582790374756
    val onPol:  0.33899761239687604

=== Epoch 20 ===
    train loss:  0.12946005585124193
    val rand:  0.1608443558216095
    val onPol:  0.357974648475647

=== Epoch 30 ===
    train loss:  0.0986584202901831
    val rand:  0.1585298627614975
    val onPol:  0.38272108634312946

=== Epoch 39 ===
    train loss:  0.08204120853282873
    val rand:  0.1525927037000656
    val onPol:  0.3992754916350047
Training duration: 27.14 s

#####################################
performing on-policy MPC rollouts... iter  84
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.098154210206026
DONE TAKING  40  STEPS.
Total reward:  -432.9000138154489
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.45493949151504
DONE TAKING  40  STEPS.
Total reward:  -749.2228127392
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.2328176284904
DONE TAKING  40  STEPS.
Total reward:  -441.1190283541605
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.434502890782152
DONE TAKING  40  STEPS.
Total reward:  -1030.8509373728023
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.437322481994904
DONE TAKING  40  STEPS.
Total reward:  -440.6622394860775
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.018086594552685
DONE TAKING  40  STEPS.
Total reward:  -623.2649680049406
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -15.759621364442548
DONE TAKING  40  STEPS.
Total reward:  -314.21995994778956
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.941916759214518
DONE TAKING  40  STEPS.
Total reward:  -383.85670813494283
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.455739198258527
DONE TAKING  40  STEPS.
Total reward:  -867.633263584893
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.430276136494793
DONE TAKING  40  STEPS.
Total reward:  -668.6299023017465
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.011151971316007
DONE TAKING  40  STEPS.
Total reward:  -810.6932162917866
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.488615086989796
DONE TAKING  40  STEPS.
Total reward:  -632.8975383999691
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.07571784827263
DONE TAKING  40  STEPS.
Total reward:  -574.9264785344386
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.153271383776612
DONE TAKING  40  STEPS.
Total reward:  -465.240897870565
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.592379865517096
DONE TAKING  40  STEPS.
Total reward:  -290.99545279626915
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -14.422760576528958
DONE TAKING  40  STEPS.
Total reward:  -444.9368220396389
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.426458894371088
DONE TAKING  40  STEPS.
Total reward:  -573.0257624614218
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.04054962249707
DONE TAKING  40  STEPS.
Total reward:  -816.848213604146
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.445738790839897
DONE TAKING  40  STEPS.
Total reward:  -524.1605514667168
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.38421037816904
DONE TAKING  40  STEPS.
Total reward:  -1074.185539822089
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.174349978706246
DONE TAKING  40  STEPS.
Total reward:  -79.85411141044854
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.38775096059095
DONE TAKING  40  STEPS.
Total reward:  -618.0079603501345
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.67414317691865
DONE TAKING  40  STEPS.
Total reward:  -1053.2597867880497
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.08750431107902
DONE TAKING  40  STEPS.
Total reward:  -264.7775349435099
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.654805106509567
DONE TAKING  40  STEPS.
Total reward:  -459.0261994256293
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.06747005934589
DONE TAKING  40  STEPS.
Total reward:  -897.0877694258087
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.01898277714965
DONE TAKING  40  STEPS.
Total reward:  -681.2738901341463
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.87675585942018
DONE TAKING  40  STEPS.
Total reward:  -369.3407624407904
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -13.238444499894948
DONE TAKING  40  STEPS.
Total reward:  -344.61612598028125
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.07772002292851
DONE TAKING  40  STEPS.
Total reward:  -1068.0976067280021
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.752592398317752
DONE TAKING  40  STEPS.
Total reward:  -525.3501124223448
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.681435252457167
DONE TAKING  40  STEPS.
Total reward:  -586.7294032914726
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -15.483416008716668
DONE TAKING  40  STEPS.
Total reward:  -424.7923511020266
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -15.043368037187461
DONE TAKING  40  STEPS.
Total reward:  -51.22853345397414
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.016681864521125
DONE TAKING  40  STEPS.
Total reward:  -501.65800517157254
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.296613349189574
DONE TAKING  40  STEPS.
Total reward:  -291.540936844669
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.951475801700116
DONE TAKING  40  STEPS.
Total reward:  -945.2264026207516
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.662546842054752
DONE TAKING  40  STEPS.
Total reward:  -640.801334362611
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.897718268376167
DONE TAKING  40  STEPS.
Total reward:  -438.43225704389135
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.54942756144427
DONE TAKING  40  STEPS.
Total reward:  -404.48131165859365
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter84.ckpt
Iter: 85
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  85
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  24375
On pol:  28800
Prob shape:  (53175,)

=== Epoch 0 ===
    train loss:  0.4178517426101907
    val rand:  0.31340837478637695
    val onPol:  0.3700454334417979

=== Epoch 10 ===
    train loss:  0.18317356170381158
    val rand:  0.18091905117034912
    val onPol:  0.3355347017447154

=== Epoch 20 ===
    train loss:  0.12713809868375076
    val rand:  0.15760740637779236
    val onPol:  0.35669243335723877

=== Epoch 30 ===
    train loss:  0.09731659727189147
    val rand:  0.15764036774635315
    val onPol:  0.37683914105097455

=== Epoch 39 ===
    train loss:  0.08095089816352696
    val rand:  0.15293607115745544
    val onPol:  0.3956533869107564
Training duration: 25.83 s

#####################################
performing on-policy MPC rollouts... iter  85
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.348059458174145
DONE TAKING  40  STEPS.
Total reward:  -545.4688488702344
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.402648621729092
DONE TAKING  40  STEPS.
Total reward:  -722.1710743720334
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.93490273543766
DONE TAKING  40  STEPS.
Total reward:  -702.8464203522417
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -31.148553783117087
DONE TAKING  40  STEPS.
Total reward:  -855.344850826783
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.643053364391847
DONE TAKING  40  STEPS.
Total reward:  -800.2042997014524
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.495742995925298
DONE TAKING  40  STEPS.
Total reward:  -1102.0823228660822
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.49295493174141
DONE TAKING  40  STEPS.
Total reward:  -673.685766383491
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.138014236079133
DONE TAKING  40  STEPS.
Total reward:  -545.2609530988614
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.664411996119657
DONE TAKING  40  STEPS.
Total reward:  -995.6102926922406
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.98722722761356
DONE TAKING  40  STEPS.
Total reward:  -913.5950487602586
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.783877427447724
DONE TAKING  40  STEPS.
Total reward:  -802.2558017029841
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.53956206060988
DONE TAKING  40  STEPS.
Total reward:  -497.21868138122267
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.70305892836127
DONE TAKING  40  STEPS.
Total reward:  -456.6776543681445
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.3222543133866
DONE TAKING  40  STEPS.
Total reward:  -777.5808510446803
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.901261045893953
DONE TAKING  40  STEPS.
Total reward:  -627.2898806229562
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.204262655264166
DONE TAKING  40  STEPS.
Total reward:  -398.35418423380816
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.664461739526246
DONE TAKING  40  STEPS.
Total reward:  -508.72645082693043
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.990042541350462
DONE TAKING  40  STEPS.
Total reward:  -550.9341798263468
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.753363110456167
DONE TAKING  40  STEPS.
Total reward:  -362.63585136005054
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -15.936380770844291
DONE TAKING  40  STEPS.
Total reward:  -377.65804526449443
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.286848427739855
DONE TAKING  40  STEPS.
Total reward:  -590.612005779324
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -20.147788125540572
DONE TAKING  40  STEPS.
Total reward:  -420.0170234568443
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.901872507323922
DONE TAKING  40  STEPS.
Total reward:  -651.3964027202237
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.206849521045765
DONE TAKING  40  STEPS.
Total reward:  -444.8781271514437
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.302592650692535
DONE TAKING  40  STEPS.
Total reward:  -634.8396626567015
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.627607036782067
DONE TAKING  40  STEPS.
Total reward:  -557.0833105111659
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.83112828390607
DONE TAKING  40  STEPS.
Total reward:  -792.1797888293955
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.54759710189749
DONE TAKING  40  STEPS.
Total reward:  -579.9629398688495
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.83693836377966
DONE TAKING  40  STEPS.
Total reward:  -657.640594852232
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.637114724054051
DONE TAKING  40  STEPS.
Total reward:  -447.32147340399763
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -10.859256153185655
DONE TAKING  40  STEPS.
Total reward:  -227.11435542721497
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.135050715849992
DONE TAKING  40  STEPS.
Total reward:  -481.26073870746933
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.469272949394032
DONE TAKING  40  STEPS.
Total reward:  132.30641975891024
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.7142230940412
DONE TAKING  40  STEPS.
Total reward:  -742.3615297770754
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.658916535324764
DONE TAKING  40  STEPS.
Total reward:  -554.4401105226715
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.3125331797248
DONE TAKING  40  STEPS.
Total reward:  -794.2656547432878
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.328321129465934
DONE TAKING  40  STEPS.
Total reward:  -778.4063815873358
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.164423834756764
DONE TAKING  40  STEPS.
Total reward:  -628.8248978387298
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.233290584972366
DONE TAKING  40  STEPS.
Total reward:  -750.3173131137801
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.686520341744938
DONE TAKING  40  STEPS.
Total reward:  -935.0989943875534
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter85.ckpt
Iter: 86
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  86
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  24570
On pol:  28800
Prob shape:  (53370,)

=== Epoch 0 ===
    train loss:  0.4233884619405636
    val rand:  0.3100052773952484
    val onPol:  0.3758811851342519

=== Epoch 10 ===
    train loss:  0.1858825206470031
    val rand:  0.1834276169538498
    val onPol:  0.3377661406993866

=== Epoch 20 ===
    train loss:  0.12881196132646158
    val rand:  0.16015595197677612
    val onPol:  0.3618268072605133

=== Epoch 30 ===
    train loss:  0.09878132685732383
    val rand:  0.15212920308113098
    val onPol:  0.3828643063704173

=== Epoch 39 ===
    train loss:  0.0817548965748686
    val rand:  0.14998310804367065
    val onPol:  0.3977884252866109
Training duration: 27.54 s

#####################################
performing on-policy MPC rollouts... iter  86
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.575004173208626
DONE TAKING  40  STEPS.
Total reward:  -928.679990353482
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.787132420527804
DONE TAKING  40  STEPS.
Total reward:  -493.41938207206175
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.314146685191908
DONE TAKING  40  STEPS.
Total reward:  -679.1345962172254
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.169235797681047
DONE TAKING  40  STEPS.
Total reward:  -443.1976091519037
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.717714401316375
DONE TAKING  40  STEPS.
Total reward:  -932.5790636570523
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.750796503935113
DONE TAKING  40  STEPS.
Total reward:  -450.7687355267881
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.641484854658337
DONE TAKING  40  STEPS.
Total reward:  -395.6911554870969
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.906127168818443
DONE TAKING  40  STEPS.
Total reward:  -516.7270339476418
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.84538367617732
DONE TAKING  40  STEPS.
Total reward:  -849.6223191805612
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -18.765136341703005
DONE TAKING  40  STEPS.
Total reward:  -120.37313303329931
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.40450348112284
DONE TAKING  40  STEPS.
Total reward:  -411.53483750676315
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.914181200049573
DONE TAKING  40  STEPS.
Total reward:  -170.0556442484821
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.03663627860871
DONE TAKING  40  STEPS.
Total reward:  -28.024955696324948
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.689321972584004
DONE TAKING  40  STEPS.
Total reward:  -843.4585343237729
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.999121939390765
DONE TAKING  40  STEPS.
Total reward:  -852.4555685582841
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -21.38836341894183
DONE TAKING  40  STEPS.
Total reward:  -266.5558564794134
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.413570083846453
DONE TAKING  40  STEPS.
Total reward:  -611.0935757544767
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -22.94099122634492
DONE TAKING  40  STEPS.
Total reward:  -904.0059408280356
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.0810275548017
DONE TAKING  40  STEPS.
Total reward:  -507.4857479095194
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.531313289585
DONE TAKING  40  STEPS.
Total reward:  -846.2766026309711
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.30110047923398
DONE TAKING  40  STEPS.
Total reward:  -1059.5326461960747
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.590348639377408
DONE TAKING  40  STEPS.
Total reward:  -76.90469086460621
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -20.327600181189776
DONE TAKING  40  STEPS.
Total reward:  -353.7725683601512
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.586042458796136
DONE TAKING  40  STEPS.
Total reward:  -708.6924199182533
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.72114453548044
DONE TAKING  40  STEPS.
Total reward:  -806.6366011371443
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.81268435005443
DONE TAKING  40  STEPS.
Total reward:  -161.941574297691
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.691170678636723
DONE TAKING  40  STEPS.
Total reward:  -644.9672450586551
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.148783703730164
DONE TAKING  40  STEPS.
Total reward:  -787.1823311867548
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -31.031352208805668
DONE TAKING  40  STEPS.
Total reward:  -696.7390063938368
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -17.221942975817015
DONE TAKING  40  STEPS.
Total reward:  -754.6947284418003
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.323387298450594
DONE TAKING  40  STEPS.
Total reward:  -500.9361969922928
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -18.135982035171978
DONE TAKING  40  STEPS.
Total reward:  -339.0067057441317
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -16.922286854295713
DONE TAKING  40  STEPS.
Total reward:  -478.51967227206256
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.67223363334218
DONE TAKING  40  STEPS.
Total reward:  -735.9847850330186
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.70817403225653
DONE TAKING  40  STEPS.
Total reward:  -859.2529355535071
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -31.235158121345947
DONE TAKING  40  STEPS.
Total reward:  -775.2358895628404
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.79534694734659
DONE TAKING  40  STEPS.
Total reward:  -782.2796552399055
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.20955006589049
DONE TAKING  40  STEPS.
Total reward:  -1109.8670716467986
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.316532155406456
DONE TAKING  40  STEPS.
Total reward:  -569.2214347698429
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -10.740559024001717
DONE TAKING  40  STEPS.
Total reward:  17.96321297394315
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter86.ckpt
Iter: 87
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  87
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  24765
On pol:  28800
Prob shape:  (53565,)

=== Epoch 0 ===
    train loss:  0.422718257858203
    val rand:  0.3000856935977936
    val onPol:  0.3751966953277588

=== Epoch 10 ===
    train loss:  0.18407116300211504
    val rand:  0.1784803569316864
    val onPol:  0.3385646839936574

=== Epoch 20 ===
    train loss:  0.12729725392105487
    val rand:  0.15795598924160004
    val onPol:  0.3619301915168762

=== Epoch 30 ===
    train loss:  0.09684130506446728
    val rand:  0.15763917565345764
    val onPol:  0.38086483875910443

=== Epoch 39 ===
    train loss:  0.07931832123834354
    val rand:  0.15290984511375427
    val onPol:  0.39854560295740765
Training duration: 26.55 s

#####################################
performing on-policy MPC rollouts... iter  87
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.25811758307304
DONE TAKING  40  STEPS.
Total reward:  -889.6184326494395
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.688653373103953
DONE TAKING  40  STEPS.
Total reward:  -789.3754764408104
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.076965197647061
DONE TAKING  40  STEPS.
Total reward:  -278.99573744118504
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -15.834228678021027
DONE TAKING  40  STEPS.
Total reward:  -426.82557015299676
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.67986841593447
DONE TAKING  40  STEPS.
Total reward:  -666.401699507306
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.881218998458312
DONE TAKING  40  STEPS.
Total reward:  -152.19257813088592
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.62231810932311
DONE TAKING  40  STEPS.
Total reward:  -751.4974701535432
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -19.29887868447452
DONE TAKING  40  STEPS.
Total reward:  -642.4526340062317
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -16.595406517289064
DONE TAKING  40  STEPS.
Total reward:  -534.4565650901236
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.94852546220595
DONE TAKING  40  STEPS.
Total reward:  -677.2276534135946
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -17.58733979196586
DONE TAKING  40  STEPS.
Total reward:  -311.98574967518874
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.157374718536733
DONE TAKING  40  STEPS.
Total reward:  -943.6527509445455
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.313127917914585
DONE TAKING  40  STEPS.
Total reward:  -251.85034043430755
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.99466779645944
DONE TAKING  40  STEPS.
Total reward:  -957.8134628923042
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -30.533314051629354
DONE TAKING  40  STEPS.
Total reward:  -877.5140623904476
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.17734687299921
DONE TAKING  40  STEPS.
Total reward:  -1041.7466484774277
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.024791086203592
DONE TAKING  40  STEPS.
Total reward:  -435.3885886770573
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.252027253103677
DONE TAKING  40  STEPS.
Total reward:  -629.70578587201
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.436064649222544
DONE TAKING  40  STEPS.
Total reward:  -724.4210309889195
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.09130847662849
DONE TAKING  40  STEPS.
Total reward:  -788.679800123169
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.248348202722077
DONE TAKING  40  STEPS.
Total reward:  216.0532540506992
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.269116322507475
DONE TAKING  40  STEPS.
Total reward:  -817.8934581831456
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -23.730989896349026
DONE TAKING  40  STEPS.
Total reward:  -492.99500099195495
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.194970389972354
DONE TAKING  40  STEPS.
Total reward:  -521.6144248538951
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -12.34932288351276
DONE TAKING  40  STEPS.
Total reward:  -262.96614601484487
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -11.613941690511025
DONE TAKING  40  STEPS.
Total reward:  -335.64729790265426
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.48961629800788
DONE TAKING  40  STEPS.
Total reward:  -227.41453339635993
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.42271097120103
DONE TAKING  40  STEPS.
Total reward:  -295.7940313030918
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.911273083430057
DONE TAKING  40  STEPS.
Total reward:  -1167.6898492942548
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -16.129197456852715
DONE TAKING  40  STEPS.
Total reward:  -341.18548917339035
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.075056145240996
DONE TAKING  40  STEPS.
Total reward:  -390.51670304359254
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -10.54184829198012
DONE TAKING  40  STEPS.
Total reward:  -351.2667738910266
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.490536751811284
DONE TAKING  40  STEPS.
Total reward:  -755.7697260405589
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.979329698382813
DONE TAKING  40  STEPS.
Total reward:  -317.65204273565746
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.29440140258055
DONE TAKING  40  STEPS.
Total reward:  -384.52154038615066
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.88091843001284
DONE TAKING  40  STEPS.
Total reward:  -437.43337629211146
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -14.930072756193429
DONE TAKING  40  STEPS.
Total reward:  -245.71235520454573
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.521435515211827
DONE TAKING  40  STEPS.
Total reward:  -844.4848862068962
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.989832299166643
DONE TAKING  40  STEPS.
Total reward:  -795.90371180123
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.21997068039537
DONE TAKING  40  STEPS.
Total reward:  -459.1324346839995
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter87.ckpt
Iter: 88
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  88
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  24960
On pol:  28800
Prob shape:  (53760,)

=== Epoch 0 ===
    train loss:  0.4223077915963672
    val rand:  0.3115684986114502
    val onPol:  0.35922151803970337

=== Epoch 10 ===
    train loss:  0.184140621196656
    val rand:  0.18137429654598236
    val onPol:  0.3224484821160634

=== Epoch 20 ===
    train loss:  0.1273286650578181
    val rand:  0.16319364309310913
    val onPol:  0.3431576391061147

=== Epoch 30 ===
    train loss:  0.0972737478358405
    val rand:  0.15380507707595825
    val onPol:  0.3625157872835795

=== Epoch 39 ===
    train loss:  0.08114309232859385
    val rand:  0.15367990732192993
    val onPol:  0.3817882438500722
Training duration: 27.84 s

#####################################
performing on-policy MPC rollouts... iter  88
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.75869364742223
DONE TAKING  40  STEPS.
Total reward:  -762.5081552520022
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -24.331940753111972
DONE TAKING  40  STEPS.
Total reward:  -806.0165272898001
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -31.411230769729215
DONE TAKING  40  STEPS.
Total reward:  -815.2098723031867
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.199214851005255
DONE TAKING  40  STEPS.
Total reward:  -623.4346060145722
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.674393807609768
DONE TAKING  40  STEPS.
Total reward:  -735.2124567094468
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -13.898206413719747
DONE TAKING  40  STEPS.
Total reward:  -409.6052179281449
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.76535730788936
DONE TAKING  40  STEPS.
Total reward:  -996.7531775833716
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.497360284913228
DONE TAKING  40  STEPS.
Total reward:  -353.4192337558056
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.948163610699655
DONE TAKING  40  STEPS.
Total reward:  39.73992832351398
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.590474889190475
DONE TAKING  40  STEPS.
Total reward:  -825.8273067435567
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.14642126350926
DONE TAKING  40  STEPS.
Total reward:  -469.88754634520734
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -12.084176314805292
DONE TAKING  40  STEPS.
Total reward:  -227.66933585887466
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.462945440204564
DONE TAKING  40  STEPS.
Total reward:  -211.90477780723026
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -13.909069007909366
DONE TAKING  40  STEPS.
Total reward:  -459.0781321278469
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.44359237978944
DONE TAKING  40  STEPS.
Total reward:  -945.6516120008293
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -12.550992879578516
DONE TAKING  40  STEPS.
Total reward:  -479.0842384844003
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -9.105372145071982
DONE TAKING  40  STEPS.
Total reward:  -283.0062641995553
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.139253087886743
DONE TAKING  40  STEPS.
Total reward:  -126.07064884524853
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.660595607710533
DONE TAKING  40  STEPS.
Total reward:  -797.6762400987832
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.384952398086234
DONE TAKING  40  STEPS.
Total reward:  -607.7150643062502
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.60334696684308
DONE TAKING  40  STEPS.
Total reward:  -607.2430157920795
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.712083779699796
DONE TAKING  40  STEPS.
Total reward:  -435.97763367274484
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -16.567688884021514
DONE TAKING  40  STEPS.
Total reward:  -487.56989733671287
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.700578293886537
DONE TAKING  40  STEPS.
Total reward:  -589.0429873685106
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.24977943829508
DONE TAKING  40  STEPS.
Total reward:  -236.54483782340154
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.317037906983618
DONE TAKING  40  STEPS.
Total reward:  -542.8681219912693
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.706024169321196
DONE TAKING  40  STEPS.
Total reward:  -430.71974179322854
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.07404968195377
DONE TAKING  40  STEPS.
Total reward:  -1044.4532983865954
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.13476423552246
DONE TAKING  40  STEPS.
Total reward:  -390.1199266779685
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.929092308093047
DONE TAKING  40  STEPS.
Total reward:  -584.5685354096158
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.580555346958608
DONE TAKING  40  STEPS.
Total reward:  -759.9677691585327
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.51575873372934
DONE TAKING  40  STEPS.
Total reward:  -422.2809862770354
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.723551642036668
DONE TAKING  40  STEPS.
Total reward:  -708.1469943061704
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.63379507990838
DONE TAKING  40  STEPS.
Total reward:  -259.7109454239948
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -31.37128142923302
DONE TAKING  40  STEPS.
Total reward:  -1069.1646499174165
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.895359913382926
DONE TAKING  40  STEPS.
Total reward:  -386.4524151758383
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.824056545581684
DONE TAKING  40  STEPS.
Total reward:  -862.1102343045791
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.97643216104295
DONE TAKING  40  STEPS.
Total reward:  -921.1406825571338
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -19.452225184648164
DONE TAKING  40  STEPS.
Total reward:  -434.2418573770438
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -11.7056539113462
DONE TAKING  40  STEPS.
Total reward:  -363.4271169183902
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter88.ckpt
Iter: 89
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  89
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  25155
On pol:  28800
Prob shape:  (53955,)

=== Epoch 0 ===
    train loss:  0.4227307444527036
    val rand:  0.3034338653087616
    val onPol:  0.3552027841409047

=== Epoch 10 ===
    train loss:  0.18444551740373885
    val rand:  0.17581290006637573
    val onPol:  0.31882108251253766

=== Epoch 20 ===
    train loss:  0.12742705941200255
    val rand:  0.15822497010231018
    val onPol:  0.33907360831896466

=== Epoch 30 ===
    train loss:  0.09616938261758713
    val rand:  0.15760399401187897
    val onPol:  0.360409547885259

=== Epoch 39 ===
    train loss:  0.08025897727126168
    val rand:  0.14522558450698853
    val onPol:  0.37545162439346313
Training duration: 26.89 s

#####################################
performing on-policy MPC rollouts... iter  89
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.758626366487704
DONE TAKING  40  STEPS.
Total reward:  -589.0896110740744
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -31.27839335571773
DONE TAKING  40  STEPS.
Total reward:  -761.014405739032
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.552259101268575
DONE TAKING  40  STEPS.
Total reward:  -866.4462926771276
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.949484898590335
DONE TAKING  40  STEPS.
Total reward:  -805.1470325219926
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.342369804019945
DONE TAKING  40  STEPS.
Total reward:  -828.8084845137852
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.932711029977707
DONE TAKING  40  STEPS.
Total reward:  -632.2144073015659
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.748918928922073
DONE TAKING  40  STEPS.
Total reward:  -679.538864869047
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.887059818775942
DONE TAKING  40  STEPS.
Total reward:  -538.604891224979
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.102249872872633
DONE TAKING  40  STEPS.
Total reward:  -590.7971181540777
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.56310399558576
DONE TAKING  40  STEPS.
Total reward:  -382.7669368564684
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -29.412158902500124
DONE TAKING  40  STEPS.
Total reward:  -920.8579136982108
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.147500485101336
DONE TAKING  40  STEPS.
Total reward:  -814.4693291514359
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.474654371538335
DONE TAKING  40  STEPS.
Total reward:  -471.8479155206993
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.023259999375608
DONE TAKING  40  STEPS.
Total reward:  -509.961630736681
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.167539333807436
DONE TAKING  40  STEPS.
Total reward:  -814.9302392162687
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -16.55191143827377
DONE TAKING  40  STEPS.
Total reward:  -459.60563650804846
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.576482030207444
DONE TAKING  40  STEPS.
Total reward:  -775.7784634950387
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -13.580555087976698
DONE TAKING  40  STEPS.
Total reward:  -448.89696019143105
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.967209461688803
DONE TAKING  40  STEPS.
Total reward:  -474.9846927544674
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.478528941457345
DONE TAKING  40  STEPS.
Total reward:  -494.746262122975
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.039792990733016
DONE TAKING  40  STEPS.
Total reward:  -300.38279776984837
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.593328345478994
DONE TAKING  40  STEPS.
Total reward:  -986.7743844918558
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.552178494255365
DONE TAKING  40  STEPS.
Total reward:  -45.11285433858562
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -31.317502953877877
DONE TAKING  40  STEPS.
Total reward:  -879.7270366457012
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -15.421225468899845
DONE TAKING  40  STEPS.
Total reward:  -460.6819953585473
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.92497775308656
DONE TAKING  40  STEPS.
Total reward:  -722.2595531880413
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.545269102916954
DONE TAKING  40  STEPS.
Total reward:  -463.1835462516108
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.70109515801949
DONE TAKING  40  STEPS.
Total reward:  -572.5751451466942
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.75638527936196
DONE TAKING  40  STEPS.
Total reward:  -828.1835902412854
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.784082368414403
DONE TAKING  40  STEPS.
Total reward:  -648.5449856484103
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.063979767651027
DONE TAKING  40  STEPS.
Total reward:  -583.7202102199029
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.517697171120112
DONE TAKING  40  STEPS.
Total reward:  -800.6062140602725
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.65842630171103
DONE TAKING  40  STEPS.
Total reward:  -654.5695096521696
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.620482083824186
DONE TAKING  40  STEPS.
Total reward:  -613.740209572492
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.10613313197109
DONE TAKING  40  STEPS.
Total reward:  -357.0379224908506
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.112729394204965
DONE TAKING  40  STEPS.
Total reward:  -336.02868711827733
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.08267811898428
DONE TAKING  40  STEPS.
Total reward:  -791.0961981606929
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -18.438382068812444
DONE TAKING  40  STEPS.
Total reward:  -546.2250124463907
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.59388688020899
DONE TAKING  40  STEPS.
Total reward:  -718.2592241029839
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.76678514346016
DONE TAKING  40  STEPS.
Total reward:  -1070.6056037809553
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter89.ckpt
Iter: 90
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  90
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  25350
On pol:  28800
Prob shape:  (54150,)

=== Epoch 0 ===
    train loss:  0.4237746777988616
    val rand:  0.29964932799339294
    val onPol:  0.35558344920476276

=== Epoch 10 ===
    train loss:  0.18469452971503847
    val rand:  0.1826346516609192
    val onPol:  0.3209584057331085

=== Epoch 20 ===
    train loss:  0.12860653882934933
    val rand:  0.158451646566391
    val onPol:  0.3428228994210561

=== Epoch 30 ===
    train loss:  0.09720081069639751
    val rand:  0.15720640122890472
    val onPol:  0.36349544922510785

=== Epoch 39 ===
    train loss:  0.08147076226416089
    val rand:  0.15112635493278503
    val onPol:  0.3779658277829488
Training duration: 27.61 s

#####################################
performing on-policy MPC rollouts... iter  90
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.68371525511659
DONE TAKING  40  STEPS.
Total reward:  -401.4779299520559
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -22.484685294866885
DONE TAKING  40  STEPS.
Total reward:  -527.6591954886852
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -14.015704804901748
DONE TAKING  40  STEPS.
Total reward:  -379.86573338642665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.053525247067828
DONE TAKING  40  STEPS.
Total reward:  -600.8457005855633
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.350341922360194
DONE TAKING  40  STEPS.
Total reward:  -733.4369805855428
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.34449795414746
DONE TAKING  40  STEPS.
Total reward:  -798.5912623102694
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -16.994926441380017
DONE TAKING  40  STEPS.
Total reward:  -86.98586876242884
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.950642009165716
DONE TAKING  40  STEPS.
Total reward:  -646.7074718076688
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.140986802515876
DONE TAKING  40  STEPS.
Total reward:  -742.0510910917101
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.488858136647861
DONE TAKING  40  STEPS.
Total reward:  -263.08792488540223
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.109765169250963
DONE TAKING  40  STEPS.
Total reward:  -368.9872990717451
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.302575855927973
DONE TAKING  40  STEPS.
Total reward:  -837.0492885620575
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -15.12112178304712
DONE TAKING  40  STEPS.
Total reward:  -196.54236098310756
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.365595059743903
DONE TAKING  40  STEPS.
Total reward:  -450.33937055013234
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.878709470937245
DONE TAKING  40  STEPS.
Total reward:  -525.592498225339
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.16729233862063
DONE TAKING  40  STEPS.
Total reward:  -172.68551196474613
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -16.22390934214128
DONE TAKING  40  STEPS.
Total reward:  -614.3761967261029
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -20.605981715551955
DONE TAKING  40  STEPS.
Total reward:  -352.7843013345901
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.399763882342207
DONE TAKING  40  STEPS.
Total reward:  -494.3318389954889
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.270817477965174
DONE TAKING  40  STEPS.
Total reward:  -608.7472561869436
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.226584430775954
DONE TAKING  40  STEPS.
Total reward:  -697.8074138185787
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.254500696572666
DONE TAKING  40  STEPS.
Total reward:  -725.4699648449563
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -15.611753454179027
DONE TAKING  40  STEPS.
Total reward:  -485.2631304629188
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.9426771300288
DONE TAKING  40  STEPS.
Total reward:  -802.0394743346507
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.352400667576585
DONE TAKING  40  STEPS.
Total reward:  -469.9762522394207
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -14.375298476650817
DONE TAKING  40  STEPS.
Total reward:  -233.9089617163469
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.14740601840686
DONE TAKING  40  STEPS.
Total reward:  -343.9492350358767
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.454464243085056
DONE TAKING  40  STEPS.
Total reward:  -804.5160672369338
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -20.341640079790892
DONE TAKING  40  STEPS.
Total reward:  -407.52232146288355
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.93114685753246
DONE TAKING  40  STEPS.
Total reward:  -92.14118243163573
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.30743872551264
DONE TAKING  40  STEPS.
Total reward:  -983.6146786113948
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.409697975694137
DONE TAKING  40  STEPS.
Total reward:  -743.1668652441057
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.59003946629951
DONE TAKING  40  STEPS.
Total reward:  -913.1222968619621
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.889726528247753
DONE TAKING  40  STEPS.
Total reward:  -876.5668197563739
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.451992102877774
DONE TAKING  40  STEPS.
Total reward:  -307.85242125721
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.23855555850261
DONE TAKING  40  STEPS.
Total reward:  -1022.6621971582067
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -31.415543861585952
DONE TAKING  40  STEPS.
Total reward:  -587.3625723293421
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.125014316551674
DONE TAKING  40  STEPS.
Total reward:  -359.26454810152546
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.41420721779099
DONE TAKING  40  STEPS.
Total reward:  -420.36408450660736
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.087819428510986
DONE TAKING  40  STEPS.
Total reward:  -1003.2244825990917
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter90.ckpt
Iter: 91
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  91
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  25545
On pol:  28800
Prob shape:  (54345,)

=== Epoch 0 ===
    train loss:  0.4211766944741303
    val rand:  0.30255770683288574
    val onPol:  0.3464268545309703

=== Epoch 10 ===
    train loss:  0.18465296797594935
    val rand:  0.18072625994682312
    val onPol:  0.30895904699961346

=== Epoch 20 ===
    train loss:  0.12667772890824192
    val rand:  0.16315218806266785
    val onPol:  0.333204060792923

=== Epoch 30 ===
    train loss:  0.09724365954972664
    val rand:  0.15488897264003754
    val onPol:  0.3531476656595866

=== Epoch 39 ===
    train loss:  0.08058258335826532
    val rand:  0.14955013990402222
    val onPol:  0.37025587757428485
Training duration: 27.84 s

#####################################
performing on-policy MPC rollouts... iter  91
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.07162070692415
DONE TAKING  40  STEPS.
Total reward:  -723.6293414600757
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.344503135606082
DONE TAKING  40  STEPS.
Total reward:  -820.7426137509232
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.245852126687975
DONE TAKING  40  STEPS.
Total reward:  -141.48894036679448
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.3914117082619
DONE TAKING  40  STEPS.
Total reward:  -315.4977704437815
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.681084284309232
DONE TAKING  40  STEPS.
Total reward:  -523.7511148253031
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.458533816715082
DONE TAKING  40  STEPS.
Total reward:  -858.0699758260675
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -10.475519907953643
DONE TAKING  40  STEPS.
Total reward:  -84.02218030811295
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.29640737665893
DONE TAKING  40  STEPS.
Total reward:  -719.4050595555667
Time for 1 rollout: 1.41 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.345959388081283
DONE TAKING  40  STEPS.
Total reward:  -840.7138364571297
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.165235498751212
DONE TAKING  40  STEPS.
Total reward:  -762.803977119065
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -11.914002967101208
DONE TAKING  40  STEPS.
Total reward:  -458.3962389163023
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.72863980998693
DONE TAKING  40  STEPS.
Total reward:  -770.5352475815665
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.058885271135665
DONE TAKING  40  STEPS.
Total reward:  -40.06180514818267
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.13982008705601
DONE TAKING  40  STEPS.
Total reward:  -311.7211023868356
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.05200882604255
DONE TAKING  40  STEPS.
Total reward:  -511.2070534313071
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.55925915768336
DONE TAKING  40  STEPS.
Total reward:  -392.87450998600843
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.831513163954533
DONE TAKING  40  STEPS.
Total reward:  -568.7116944316402
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.22332739081198
DONE TAKING  40  STEPS.
Total reward:  -341.74762961387717
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.948817778321743
DONE TAKING  40  STEPS.
Total reward:  -757.8528436593344
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.696652995626597
DONE TAKING  40  STEPS.
Total reward:  -911.7242468219532
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.72754910122047
DONE TAKING  40  STEPS.
Total reward:  -378.9190493095549
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.42214952147258
DONE TAKING  40  STEPS.
Total reward:  -331.1750941026584
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.455742178830857
DONE TAKING  40  STEPS.
Total reward:  -291.8464961507246
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.312289457528276
DONE TAKING  40  STEPS.
Total reward:  -905.4811570118386
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -16.122959921663018
DONE TAKING  40  STEPS.
Total reward:  -367.4032243610431
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.766206641011372
DONE TAKING  40  STEPS.
Total reward:  -221.1658060448629
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -12.02079243269042
DONE TAKING  40  STEPS.
Total reward:  -332.6197623025488
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.61888146335261
DONE TAKING  40  STEPS.
Total reward:  -414.2851029582964
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.095670126875163
DONE TAKING  40  STEPS.
Total reward:  -903.8453858109121
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.73019421468306
DONE TAKING  40  STEPS.
Total reward:  -571.4280328065294
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.03362550127526
DONE TAKING  40  STEPS.
Total reward:  -559.979392373926
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.202843193811823
DONE TAKING  40  STEPS.
Total reward:  -844.2830043870023
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -13.329450917127607
DONE TAKING  40  STEPS.
Total reward:  -348.5824336771665
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.451616563682137
DONE TAKING  40  STEPS.
Total reward:  -860.4828874110265
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.007109664102767
DONE TAKING  40  STEPS.
Total reward:  14.8967461967341
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -28.615098423532785
DONE TAKING  40  STEPS.
Total reward:  -844.6236418524988
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.288435597237402
DONE TAKING  40  STEPS.
Total reward:  -826.9829219983493
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.46641515658198
DONE TAKING  40  STEPS.
Total reward:  -750.5146941327425
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.248193873758172
DONE TAKING  40  STEPS.
Total reward:  -794.2026500399234
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.93268030204166
DONE TAKING  40  STEPS.
Total reward:  -844.8038367089094
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter91.ckpt
Iter: 92
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  92
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  25740
On pol:  28800
Prob shape:  (54540,)

=== Epoch 0 ===
    train loss:  0.42031921755592777
    val rand:  0.3097723424434662
    val onPol:  0.3419845501581828

=== Epoch 10 ===
    train loss:  0.1845328093699689
    val rand:  0.17803482711315155
    val onPol:  0.3038167357444763

=== Epoch 20 ===
    train loss:  0.12697808107115188
    val rand:  0.15983983874320984
    val onPol:  0.32761283715566

=== Epoch 30 ===
    train loss:  0.09740650457031322
    val rand:  0.15517833828926086
    val onPol:  0.3489283521970113

=== Epoch 39 ===
    train loss:  0.07977062288039136
    val rand:  0.15130338072776794
    val onPol:  0.36590827504793805
Training duration: 27.95 s

#####################################
performing on-policy MPC rollouts... iter  92
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.54638406202629
DONE TAKING  40  STEPS.
Total reward:  -455.21833472064924
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.87220594603653
DONE TAKING  40  STEPS.
Total reward:  -1080.5943842372112
Time for 1 rollout: 1.50 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.836046101825843
DONE TAKING  40  STEPS.
Total reward:  -566.0258837432531
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.964652477495594
DONE TAKING  40  STEPS.
Total reward:  -572.580168253747
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.341414159211773
DONE TAKING  40  STEPS.
Total reward:  -328.2331751672395
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.988098849138094
DONE TAKING  40  STEPS.
Total reward:  -507.6919127150563
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -31.378038487245064
DONE TAKING  40  STEPS.
Total reward:  -788.9879584439533
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.735924308225563
DONE TAKING  40  STEPS.
Total reward:  -886.8854021178661
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.402348402057967
DONE TAKING  40  STEPS.
Total reward:  -57.091432226531204
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.09247338458801
DONE TAKING  40  STEPS.
Total reward:  -903.9825993530234
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.221730094629095
DONE TAKING  40  STEPS.
Total reward:  -662.7719770421185
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.525335039909173
DONE TAKING  40  STEPS.
Total reward:  -573.404731351163
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.941614166373036
DONE TAKING  40  STEPS.
Total reward:  -864.165984530149
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.330600906039848
DONE TAKING  40  STEPS.
Total reward:  -532.8441128249021
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.385808700166738
DONE TAKING  40  STEPS.
Total reward:  -405.63439661086016
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.32649067094882
DONE TAKING  40  STEPS.
Total reward:  -1016.7361569873403
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -17.80594171552518
DONE TAKING  40  STEPS.
Total reward:  -402.72988380359516
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.49902361772451
DONE TAKING  40  STEPS.
Total reward:  -601.3862099876917
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.080704029833647
DONE TAKING  40  STEPS.
Total reward:  -353.24886456939606
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.352701528442093
DONE TAKING  40  STEPS.
Total reward:  -844.9918100494486
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -13.454104727028618
DONE TAKING  40  STEPS.
Total reward:  -423.87551101998855
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -14.145044812068097
DONE TAKING  40  STEPS.
Total reward:  -494.42220431506195
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.40531471238285
DONE TAKING  40  STEPS.
Total reward:  -392.1609703212478
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -20.496363173227607
DONE TAKING  40  STEPS.
Total reward:  -644.3354080759236
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.022447177764032
DONE TAKING  40  STEPS.
Total reward:  -836.0533243796027
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.884480958749595
DONE TAKING  40  STEPS.
Total reward:  -780.1588026763546
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -17.17432812848962
DONE TAKING  40  STEPS.
Total reward:  -382.54055177613606
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -9.496810865940624
DONE TAKING  40  STEPS.
Total reward:  -358.0423688646367
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -31.348843392027824
DONE TAKING  40  STEPS.
Total reward:  -560.1515870687216
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.358378189907008
DONE TAKING  40  STEPS.
Total reward:  -576.2561089839699
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -10.462100685732043
DONE TAKING  40  STEPS.
Total reward:  -406.55920560864814
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.171938622801104
DONE TAKING  40  STEPS.
Total reward:  -406.0941536083985
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.47922140877222
DONE TAKING  40  STEPS.
Total reward:  -846.0868650908292
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.07379654082889
DONE TAKING  40  STEPS.
Total reward:  -593.5593384796357
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.973395070862054
DONE TAKING  40  STEPS.
Total reward:  -758.2506679363128
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.829471592973373
DONE TAKING  40  STEPS.
Total reward:  -460.01857011110104
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -11.424478138315802
DONE TAKING  40  STEPS.
Total reward:  -416.3421757409388
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -15.505035934726749
DONE TAKING  40  STEPS.
Total reward:  -80.35611334059851
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.337422329569165
DONE TAKING  40  STEPS.
Total reward:  -799.6614110900575
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.200677213574963
DONE TAKING  40  STEPS.
Total reward:  -793.212586792932
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter92.ckpt
Iter: 93
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  93
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  25935
On pol:  28800
Prob shape:  (54735,)

=== Epoch 0 ===
    train loss:  0.42008425998237897
    val rand:  0.30081093311309814
    val onPol:  0.34226489067077637

=== Epoch 10 ===
    train loss:  0.18613911855895565
    val rand:  0.1792193502187729
    val onPol:  0.30787495772043866

=== Epoch 20 ===
    train loss:  0.12966605022830782
    val rand:  0.1622883677482605
    val onPol:  0.3301173349221547

=== Epoch 30 ===
    train loss:  0.09751038689096019
    val rand:  0.1568814069032669
    val onPol:  0.35311317443847656

=== Epoch 39 ===
    train loss:  0.08037005716337348
    val rand:  0.1514960378408432
    val onPol:  0.36386075615882874
Training duration: 23.24 s

#####################################
performing on-policy MPC rollouts... iter  93
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -30.549709688716682
DONE TAKING  40  STEPS.
Total reward:  -557.4769612804951
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -28.799608874095533
DONE TAKING  40  STEPS.
Total reward:  -251.19410430631348
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.424808122295236
DONE TAKING  40  STEPS.
Total reward:  -666.719817734359
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.85240813303573
DONE TAKING  40  STEPS.
Total reward:  -714.0575198572207
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.8601291283327
DONE TAKING  40  STEPS.
Total reward:  -513.7492497350589
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.643535329031366
DONE TAKING  40  STEPS.
Total reward:  -687.9327817428675
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.254606330339076
DONE TAKING  40  STEPS.
Total reward:  -594.0485944091247
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.51173874577021
DONE TAKING  40  STEPS.
Total reward:  -1003.7744268054182
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.973286002122908
DONE TAKING  40  STEPS.
Total reward:  -416.6518370007594
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -26.27228727884227
DONE TAKING  40  STEPS.
Total reward:  -517.8973865835525
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -14.372727433445064
DONE TAKING  40  STEPS.
Total reward:  -280.0817230645345
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.268905902771863
DONE TAKING  40  STEPS.
Total reward:  -941.3070939450306
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.56389385639239
DONE TAKING  40  STEPS.
Total reward:  -813.6321419669711
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.163199464084347
DONE TAKING  40  STEPS.
Total reward:  -307.5552850295408
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.457151602112926
DONE TAKING  40  STEPS.
Total reward:  -362.0772587058999
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.647254382484856
DONE TAKING  40  STEPS.
Total reward:  -685.0532195849437
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.620954738496017
DONE TAKING  40  STEPS.
Total reward:  -928.876173093391
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -18.961473146084664
DONE TAKING  40  STEPS.
Total reward:  -517.1829202036822
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.80014694215492
DONE TAKING  40  STEPS.
Total reward:  -620.862248121641
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.033976660767983
DONE TAKING  40  STEPS.
Total reward:  -695.3356684043852
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.234533935546985
DONE TAKING  40  STEPS.
Total reward:  -410.18736929048396
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.98383786029899
DONE TAKING  40  STEPS.
Total reward:  -476.4513531543776
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.733549885575403
DONE TAKING  40  STEPS.
Total reward:  -873.3768596281283
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.28193530835121
DONE TAKING  40  STEPS.
Total reward:  -693.3130880930252
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.386175001017996
DONE TAKING  40  STEPS.
Total reward:  -734.8257841287954
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.12588186315901
DONE TAKING  40  STEPS.
Total reward:  -525.217769492297
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.67082276250928
DONE TAKING  40  STEPS.
Total reward:  64.13688658805692
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.711463043881167
DONE TAKING  40  STEPS.
Total reward:  -898.8055334368316
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.935110449545107
DONE TAKING  40  STEPS.
Total reward:  168.1381837439248
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.27004990047087
DONE TAKING  40  STEPS.
Total reward:  -793.6301590802058
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.33894728740503
DONE TAKING  40  STEPS.
Total reward:  -207.1889777205201
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.56709933526815
DONE TAKING  40  STEPS.
Total reward:  178.88504480629868
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -12.900691211466606
DONE TAKING  40  STEPS.
Total reward:  -169.59292307271764
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.19619916271972
DONE TAKING  40  STEPS.
Total reward:  -688.2293443864307
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.10020884057412
DONE TAKING  40  STEPS.
Total reward:  -503.09800827544143
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.89777720728134
DONE TAKING  40  STEPS.
Total reward:  -1093.2681121204066
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.62371820319953
DONE TAKING  40  STEPS.
Total reward:  -972.0049120807582
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -14.578487632194502
DONE TAKING  40  STEPS.
Total reward:  -79.71437452379811
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.10440649818181
DONE TAKING  40  STEPS.
Total reward:  -787.7290364030854
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.7236646123962
DONE TAKING  40  STEPS.
Total reward:  -479.3998906300681
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter93.ckpt
Iter: 94
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  94
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  26130
On pol:  28800
Prob shape:  (54930,)

=== Epoch 0 ===
    train loss:  0.42048717519947304
    val rand:  0.30320000648498535
    val onPol:  0.3410814702510834

=== Epoch 10 ===
    train loss:  0.18465641377685227
    val rand:  0.1800771802663803
    val onPol:  0.30988765756289166

=== Epoch 20 ===
    train loss:  0.13002351998725784
    val rand:  0.16205820441246033
    val onPol:  0.3324842154979706

=== Epoch 30 ===
    train loss:  0.09892206151630277
    val rand:  0.15363070368766785
    val onPol:  0.3527454634507497

=== Epoch 39 ===
    train loss:  0.0819691028968196
    val rand:  0.15181398391723633
    val onPol:  0.36923158168792725
Training duration: 26.99 s

#####################################
performing on-policy MPC rollouts... iter  94
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -15.958377683713083
DONE TAKING  40  STEPS.
Total reward:  -484.42685740786027
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.778692834484048
DONE TAKING  40  STEPS.
Total reward:  -820.5848485376187
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.20703411594981
DONE TAKING  40  STEPS.
Total reward:  -587.4068383770374
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.35801852614534
DONE TAKING  40  STEPS.
Total reward:  -838.62222280162
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.5489307992844
DONE TAKING  40  STEPS.
Total reward:  -591.5112270699775
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -13.376563772513318
DONE TAKING  40  STEPS.
Total reward:  -326.0772983255254
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -14.826820152902485
DONE TAKING  40  STEPS.
Total reward:  157.42405615367534
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.59459971567784
DONE TAKING  40  STEPS.
Total reward:  -737.1064177441655
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.08824638039541
DONE TAKING  40  STEPS.
Total reward:  -748.0785080854396
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.070849138790802
DONE TAKING  40  STEPS.
Total reward:  -563.417140214086
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.60374894595507
DONE TAKING  40  STEPS.
Total reward:  -775.9767686510281
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.24963484414639
DONE TAKING  40  STEPS.
Total reward:  -579.1078617393559
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.762136117556576
DONE TAKING  40  STEPS.
Total reward:  -784.6409692747092
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.422357404575177
DONE TAKING  40  STEPS.
Total reward:  -717.3201702484104
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.79145635738834
DONE TAKING  40  STEPS.
Total reward:  -684.5931408295529
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -15.413223822550208
DONE TAKING  40  STEPS.
Total reward:  299.1812643363743
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.341067262438
DONE TAKING  40  STEPS.
Total reward:  -759.9023863494102
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.079177855462166
DONE TAKING  40  STEPS.
Total reward:  -464.3746053225946
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.546217980424885
DONE TAKING  40  STEPS.
Total reward:  -488.75343077049155
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.845741323488348
DONE TAKING  40  STEPS.
Total reward:  -773.0081491373616
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.40004706525822
DONE TAKING  40  STEPS.
Total reward:  -957.6367401204868
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.461909349260228
DONE TAKING  40  STEPS.
Total reward:  -135.27982547838954
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.73039497442344
DONE TAKING  40  STEPS.
Total reward:  -443.3871792583389
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.78884107579012
DONE TAKING  40  STEPS.
Total reward:  -692.0345902592106
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.10092578045498
DONE TAKING  40  STEPS.
Total reward:  -305.4853932217952
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.242683492303915
DONE TAKING  40  STEPS.
Total reward:  -394.7602412784844
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.357602647134414
DONE TAKING  40  STEPS.
Total reward:  -614.7904518141356
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.86652568118202
DONE TAKING  40  STEPS.
Total reward:  -456.6073701102205
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.836010813687235
DONE TAKING  40  STEPS.
Total reward:  -426.3748965577396
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.78475583024906
DONE TAKING  40  STEPS.
Total reward:  -717.170703509506
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.33043052437838
DONE TAKING  40  STEPS.
Total reward:  -929.0591000165776
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.531577462003114
DONE TAKING  40  STEPS.
Total reward:  -669.2320404583784
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.417176331114717
DONE TAKING  40  STEPS.
Total reward:  76.40964294315279
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.71313769399658
DONE TAKING  40  STEPS.
Total reward:  -666.8089937329734
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.899830074329238
DONE TAKING  40  STEPS.
Total reward:  -767.0273449423019
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.98834505327159
DONE TAKING  40  STEPS.
Total reward:  -1062.3413130584547
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -15.17528887505554
DONE TAKING  40  STEPS.
Total reward:  -242.49828182098418
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.96742254545188
DONE TAKING  40  STEPS.
Total reward:  -957.5849389548301
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.289635909163625
DONE TAKING  40  STEPS.
Total reward:  -553.2721837388247
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.216707182649387
DONE TAKING  40  STEPS.
Total reward:  -10.232170508752255
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter94.ckpt
Iter: 95
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  95
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  26325
On pol:  28800
Prob shape:  (55125,)

=== Epoch 0 ===
    train loss:  0.42479137031831476
    val rand:  0.3028508126735687
    val onPol:  0.3362206518650055

=== Epoch 10 ===
    train loss:  0.18581856355488857
    val rand:  0.17933711409568787
    val onPol:  0.30445096890131634

=== Epoch 20 ===
    train loss:  0.1286209496521504
    val rand:  0.16147823631763458
    val onPol:  0.3286538024743398

=== Epoch 30 ===
    train loss:  0.09849013597051674
    val rand:  0.15457266569137573
    val onPol:  0.3497833013534546

=== Epoch 39 ===
    train loss:  0.08188354001145497
    val rand:  0.15123145282268524
    val onPol:  0.3642025788625081
Training duration: 28.18 s

#####################################
performing on-policy MPC rollouts... iter  95
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.631470951677436
DONE TAKING  40  STEPS.
Total reward:  -348.81059027859095
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.53861040936644
DONE TAKING  40  STEPS.
Total reward:  -753.3624381321009
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.190050998105384
DONE TAKING  40  STEPS.
Total reward:  -740.3352080411937
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.707302503337182
DONE TAKING  40  STEPS.
Total reward:  -917.0858712655717
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.120192669046471
DONE TAKING  40  STEPS.
Total reward:  -339.457484383219
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.398767114771644
DONE TAKING  40  STEPS.
Total reward:  -239.08438497101062
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -16.09813632243189
DONE TAKING  40  STEPS.
Total reward:  -373.31289979010285
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.778207598058064
DONE TAKING  40  STEPS.
Total reward:  -745.0877740914772
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.030198663662603
DONE TAKING  40  STEPS.
Total reward:  -382.5481202438284
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.5780513911851
DONE TAKING  40  STEPS.
Total reward:  -797.6092923389416
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.363473012999206
DONE TAKING  40  STEPS.
Total reward:  -310.93920594881473
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.02499744467608
DONE TAKING  40  STEPS.
Total reward:  -95.86852261598396
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.353100892519002
DONE TAKING  40  STEPS.
Total reward:  -468.521852030549
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.71676719792015
DONE TAKING  40  STEPS.
Total reward:  -1039.664536355603
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.5800963812774
DONE TAKING  40  STEPS.
Total reward:  -510.91333786944494
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.458059257248024
DONE TAKING  40  STEPS.
Total reward:  -756.1772629000362
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.293007868112056
DONE TAKING  40  STEPS.
Total reward:  -643.3558162540944
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.92520275137158
DONE TAKING  40  STEPS.
Total reward:  -751.8647248602404
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.26330059365705
DONE TAKING  40  STEPS.
Total reward:  -725.9558731998472
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.40626030758279
DONE TAKING  40  STEPS.
Total reward:  225.85738246054203
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.153364178527777
DONE TAKING  40  STEPS.
Total reward:  -638.468761327729
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -31.10532427844211
DONE TAKING  40  STEPS.
Total reward:  -713.176577826864
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.588478461401778
DONE TAKING  40  STEPS.
Total reward:  -581.5886829034288
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.102701981692142
DONE TAKING  40  STEPS.
Total reward:  -391.9144895016467
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.78050010457797
DONE TAKING  40  STEPS.
Total reward:  -489.0774696244784
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.91833124491656
DONE TAKING  40  STEPS.
Total reward:  -619.107453299151
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -13.041716493655546
DONE TAKING  40  STEPS.
Total reward:  -164.23947884095028
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -17.729379485744737
DONE TAKING  40  STEPS.
Total reward:  -408.6313747165444
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.057514345660444
DONE TAKING  40  STEPS.
Total reward:  -580.1324415143819
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.07518825391627
DONE TAKING  40  STEPS.
Total reward:  -524.8967500242069
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.43195915771993
DONE TAKING  40  STEPS.
Total reward:  -475.40830618765756
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.284227271705596
DONE TAKING  40  STEPS.
Total reward:  -776.3541731241037
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.005166619648254
DONE TAKING  40  STEPS.
Total reward:  -518.5476192901045
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -20.591878903428878
DONE TAKING  40  STEPS.
Total reward:  -720.3068445086279
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.604243615370137
DONE TAKING  40  STEPS.
Total reward:  -968.3504436799595
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.13194450093247
DONE TAKING  40  STEPS.
Total reward:  -624.6001031118517
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.305832891171566
DONE TAKING  40  STEPS.
Total reward:  -1056.6626867431087
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.485658107743333
DONE TAKING  40  STEPS.
Total reward:  -182.30077623439553
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.573797158791383
DONE TAKING  40  STEPS.
Total reward:  -1058.2967313341019
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.907601898346947
DONE TAKING  40  STEPS.
Total reward:  -372.665992727325
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter95.ckpt
Iter: 96
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  96
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  26520
On pol:  28800
Prob shape:  (55320,)

=== Epoch 0 ===
    train loss:  0.42148933587250886
    val rand:  0.3080520033836365
    val onPol:  0.3467693527539571

=== Epoch 10 ===
    train loss:  0.18712288527577012
    val rand:  0.18824544548988342
    val onPol:  0.310699204603831

=== Epoch 20 ===
    train loss:  0.12955050370483487
    val rand:  0.16536837816238403
    val onPol:  0.33353906869888306

=== Epoch 30 ===
    train loss:  0.09926695597392542
    val rand:  0.15891629457473755
    val onPol:  0.3557438751061757

=== Epoch 39 ===
    train loss:  0.08238668367266655
    val rand:  0.15374597907066345
    val onPol:  0.3732246657212575
Training duration: 27.42 s

#####################################
performing on-policy MPC rollouts... iter  96
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.150903011015473
DONE TAKING  40  STEPS.
Total reward:  -955.8024495864919
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -31.037088175547186
DONE TAKING  40  STEPS.
Total reward:  -595.8861628573424
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.676383683695306
DONE TAKING  40  STEPS.
Total reward:  -614.6659359826722
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.495576951033541
DONE TAKING  40  STEPS.
Total reward:  -176.017957331453
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.56480615087102
DONE TAKING  40  STEPS.
Total reward:  -625.2015040282413
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.620333258553572
DONE TAKING  40  STEPS.
Total reward:  -604.6840393181816
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -14.020809953735156
DONE TAKING  40  STEPS.
Total reward:  -426.5021172069379
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.834919979013563
DONE TAKING  40  STEPS.
Total reward:  -801.5386012434114
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.049580937257225
DONE TAKING  40  STEPS.
Total reward:  -905.3448994881871
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.311716841227035
DONE TAKING  40  STEPS.
Total reward:  -674.0239619734589
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.315018345101034
DONE TAKING  40  STEPS.
Total reward:  -463.9783829981349
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.088275429422865
DONE TAKING  40  STEPS.
Total reward:  -377.3209307679267
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -31.13750230657224
DONE TAKING  40  STEPS.
Total reward:  -495.053521021179
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -30.383571286783667
DONE TAKING  40  STEPS.
Total reward:  -890.715928930317
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.413866665807156
DONE TAKING  40  STEPS.
Total reward:  -741.1057221658709
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.16641844543722
DONE TAKING  40  STEPS.
Total reward:  -51.8872103086335
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -8.431108631293968
DONE TAKING  40  STEPS.
Total reward:  175.58609389442947
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -8.972098827470887
DONE TAKING  40  STEPS.
Total reward:  -316.98032586940474
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -31.194218332836527
DONE TAKING  40  STEPS.
Total reward:  -1006.8505974811302
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.64459695535568
DONE TAKING  40  STEPS.
Total reward:  -622.6601365204265
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.45704959273622
DONE TAKING  40  STEPS.
Total reward:  -140.20268313271382
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -10.916140808960435
DONE TAKING  40  STEPS.
Total reward:  -99.71158787014929
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.313955132869694
DONE TAKING  40  STEPS.
Total reward:  -426.044902217583
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.478995465525998
DONE TAKING  40  STEPS.
Total reward:  -382.0400095734798
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.170260708055338
DONE TAKING  40  STEPS.
Total reward:  -1046.1953606735724
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.779953513406994
DONE TAKING  40  STEPS.
Total reward:  -744.3646503648922
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.179470742073075
DONE TAKING  40  STEPS.
Total reward:  -1026.2548526253306
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.669302247709457
DONE TAKING  40  STEPS.
Total reward:  -618.7856168069097
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.07128156892257
DONE TAKING  40  STEPS.
Total reward:  -724.7046271918141
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -10.824813975874473
DONE TAKING  40  STEPS.
Total reward:  -29.49855448544551
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.069087827866067
DONE TAKING  40  STEPS.
Total reward:  -195.34576270576986
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.459578794567047
DONE TAKING  40  STEPS.
Total reward:  -726.8586009292013
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -31.17531794427832
DONE TAKING  40  STEPS.
Total reward:  -841.4702447872598
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -11.892025166254923
DONE TAKING  40  STEPS.
Total reward:  4.660391454875342
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.50746099889981
DONE TAKING  40  STEPS.
Total reward:  -422.91519133388533
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.54649939346738
DONE TAKING  40  STEPS.
Total reward:  -615.5833198320123
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.851738781544956
DONE TAKING  40  STEPS.
Total reward:  -796.1046847370832
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.19457963381422
DONE TAKING  40  STEPS.
Total reward:  -604.3979796136988
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.3909215161301
DONE TAKING  40  STEPS.
Total reward:  -658.8689724029679
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -16.005733897065625
DONE TAKING  40  STEPS.
Total reward:  -420.14053752859735
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter96.ckpt
Iter: 97
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  97
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  26715
On pol:  28800
Prob shape:  (55515,)

=== Epoch 0 ===
    train loss:  0.42233768850564957
    val rand:  0.2914511561393738
    val onPol:  0.34414610266685486

=== Epoch 10 ===
    train loss:  0.18673013688789475
    val rand:  0.18169596791267395
    val onPol:  0.30912497639656067

=== Epoch 20 ===
    train loss:  0.12953600321930867
    val rand:  0.1638178825378418
    val onPol:  0.3321536084016164

=== Epoch 30 ===
    train loss:  0.09951421928902467
    val rand:  0.15644365549087524
    val onPol:  0.3525230884552002

=== Epoch 39 ===
    train loss:  0.08211394730541441
    val rand:  0.1510327160358429
    val onPol:  0.36821239193280536
Training duration: 27.19 s

#####################################
performing on-policy MPC rollouts... iter  97
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -31.315329383131196
DONE TAKING  40  STEPS.
Total reward:  -845.8668281605501
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.12967436672744
DONE TAKING  40  STEPS.
Total reward:  -647.396455511447
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.49333525161961
DONE TAKING  40  STEPS.
Total reward:  -686.7315443366444
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.24437966799333
DONE TAKING  40  STEPS.
Total reward:  -461.1657950917239
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.67283386316972
DONE TAKING  40  STEPS.
Total reward:  -515.173190274583
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.372279824024453
DONE TAKING  40  STEPS.
Total reward:  -781.2271252930277
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.355808159049126
DONE TAKING  40  STEPS.
Total reward:  -1115.071763233581
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.345158710593907
DONE TAKING  40  STEPS.
Total reward:  -864.9807823322814
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -20.43083077699638
DONE TAKING  40  STEPS.
Total reward:  -340.0055415563085
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.414943547541966
DONE TAKING  40  STEPS.
Total reward:  -457.251943193395
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.00223274270868
DONE TAKING  40  STEPS.
Total reward:  -677.8448266400508
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.090202640877095
DONE TAKING  40  STEPS.
Total reward:  -700.3958575046361
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.633421207369324
DONE TAKING  40  STEPS.
Total reward:  -772.354422895766
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.239430521121577
DONE TAKING  40  STEPS.
Total reward:  -341.4874759487161
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.2175047555247
DONE TAKING  40  STEPS.
Total reward:  -701.5046828901525
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.036620400185573
DONE TAKING  40  STEPS.
Total reward:  -332.9083838972194
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.034813371030296
DONE TAKING  40  STEPS.
Total reward:  -1063.5831104830836
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.915656378767068
DONE TAKING  40  STEPS.
Total reward:  -411.7502255338033
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.592377677118122
DONE TAKING  40  STEPS.
Total reward:  -555.7442567405743
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.142155897454266
DONE TAKING  40  STEPS.
Total reward:  -850.6740288094537
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.781870215877948
DONE TAKING  40  STEPS.
Total reward:  -828.0313717845451
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -12.310340168361746
DONE TAKING  40  STEPS.
Total reward:  -345.7731923358981
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.467548403488816
DONE TAKING  40  STEPS.
Total reward:  -425.9992992926876
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.783675068753958
DONE TAKING  40  STEPS.
Total reward:  -904.0345708325088
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.26720659545174
DONE TAKING  40  STEPS.
Total reward:  -571.6089906716136
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.798525145823167
DONE TAKING  40  STEPS.
Total reward:  -987.2503487515182
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.565414383734634
DONE TAKING  40  STEPS.
Total reward:  -831.0591082995447
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.032556859224176
DONE TAKING  40  STEPS.
Total reward:  -475.6563070191013
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.346599429928443
DONE TAKING  40  STEPS.
Total reward:  -444.499629128822
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.395817829209115
DONE TAKING  40  STEPS.
Total reward:  -863.1880857405171
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.610830542971804
DONE TAKING  40  STEPS.
Total reward:  -168.33088834301867
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.792197152284132
DONE TAKING  40  STEPS.
Total reward:  -574.5353488729126
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -31.2025409425126
DONE TAKING  40  STEPS.
Total reward:  -1048.839540269966
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.780747809837816
DONE TAKING  40  STEPS.
Total reward:  -730.0385489436873
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.219975126892344
DONE TAKING  40  STEPS.
Total reward:  -522.6777466825951
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.312517108687306
DONE TAKING  40  STEPS.
Total reward:  -562.9188465032852
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.305216980946106
DONE TAKING  40  STEPS.
Total reward:  -422.4755455222197
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.58180374886431
DONE TAKING  40  STEPS.
Total reward:  -348.63181610008564
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.36497294227371
DONE TAKING  40  STEPS.
Total reward:  -17.953013754032682
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.93941210544465
DONE TAKING  40  STEPS.
Total reward:  -646.4473585803042
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter97.ckpt
Iter: 98
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  98
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  26910
On pol:  28800
Prob shape:  (55710,)

=== Epoch 0 ===
    train loss:  0.4234250165798046
    val rand:  0.31023740768432617
    val onPol:  0.3495103220144908

=== Epoch 10 ===
    train loss:  0.18754739976591533
    val rand:  0.18284419178962708
    val onPol:  0.3200432260831197

=== Epoch 20 ===
    train loss:  0.12909080488262353
    val rand:  0.1591985821723938
    val onPol:  0.3444619874159495

=== Epoch 30 ===
    train loss:  0.09867178986745852
    val rand:  0.15513375401496887
    val onPol:  0.36846742033958435

=== Epoch 39 ===
    train loss:  0.08143402015169461
    val rand:  0.1557173728942871
    val onPol:  0.38535163799921673
Training duration: 27.03 s

#####################################
performing on-policy MPC rollouts... iter  98
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -10.651594874208213
DONE TAKING  40  STEPS.
Total reward:  -249.59919320097663
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.796300401824183
DONE TAKING  40  STEPS.
Total reward:  -625.3590993888561
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.078708835980212
DONE TAKING  40  STEPS.
Total reward:  -361.95375860669606
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.506706112344187
DONE TAKING  40  STEPS.
Total reward:  -591.5365650011228
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -11.785195716887337
DONE TAKING  40  STEPS.
Total reward:  -264.98658035955697
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.841060192347626
DONE TAKING  40  STEPS.
Total reward:  -905.0969293902594
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.124477692561257
DONE TAKING  40  STEPS.
Total reward:  -674.8681711340992
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.164116552214686
DONE TAKING  40  STEPS.
Total reward:  -445.9388603808939
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.99581558073403
DONE TAKING  40  STEPS.
Total reward:  -667.0452936573729
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.978202409587094
DONE TAKING  40  STEPS.
Total reward:  -708.4418230295371
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.344912925190695
DONE TAKING  40  STEPS.
Total reward:  -595.215341113158
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.441600693528876
DONE TAKING  40  STEPS.
Total reward:  -156.4076160949428
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.34644220484786
DONE TAKING  40  STEPS.
Total reward:  -754.1635945267703
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.698014933715058
DONE TAKING  40  STEPS.
Total reward:  -581.3045295593622
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.63416560688907
DONE TAKING  40  STEPS.
Total reward:  -672.1427233890888
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -31.37026867604326
DONE TAKING  40  STEPS.
Total reward:  -847.6250148894604
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.04647955930196
DONE TAKING  40  STEPS.
Total reward:  -325.9543114988057
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.102074336812215
DONE TAKING  40  STEPS.
Total reward:  -542.1117956703547
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.99272859754399
DONE TAKING  40  STEPS.
Total reward:  -466.164928693682
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.219144910996889
DONE TAKING  40  STEPS.
Total reward:  -391.6149013691903
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.48465305676922
DONE TAKING  40  STEPS.
Total reward:  -767.5019327438993
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -13.236849096393009
DONE TAKING  40  STEPS.
Total reward:  -321.8106996046444
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.260793216165695
DONE TAKING  40  STEPS.
Total reward:  -396.63729768793314
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.279448866873395
DONE TAKING  40  STEPS.
Total reward:  -271.30137793873126
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.332576915876672
DONE TAKING  40  STEPS.
Total reward:  -168.33774608539008
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.295689261179785
DONE TAKING  40  STEPS.
Total reward:  -691.7397944380205
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -12.920868192928427
DONE TAKING  40  STEPS.
Total reward:  -359.99074684521446
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.44629682133968
DONE TAKING  40  STEPS.
Total reward:  -721.5357104645062
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.134516472119515
DONE TAKING  40  STEPS.
Total reward:  -657.4327431780026
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.696854234034546
DONE TAKING  40  STEPS.
Total reward:  -572.8590654273352
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -15.620187069636003
DONE TAKING  40  STEPS.
Total reward:  -179.9433883487883
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.343544374869978
DONE TAKING  40  STEPS.
Total reward:  -638.2555873454004
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.291445913235396
DONE TAKING  40  STEPS.
Total reward:  -681.2513025225734
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.605691187018856
DONE TAKING  40  STEPS.
Total reward:  50.76028274352042
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -16.61730969068481
DONE TAKING  40  STEPS.
Total reward:  -12.835535713853332
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.209030312822048
DONE TAKING  40  STEPS.
Total reward:  -454.43619615445925
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.02230513885741
DONE TAKING  40  STEPS.
Total reward:  -803.9062758313618
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.563355435252134
DONE TAKING  40  STEPS.
Total reward:  82.06731736058589
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.65153119174707
DONE TAKING  40  STEPS.
Total reward:  -616.9785020634151
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.80382068312268
DONE TAKING  40  STEPS.
Total reward:  -627.4163019283839
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter98.ckpt
Iter: 99
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  99
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  27105
On pol:  28800
Prob shape:  (55905,)

=== Epoch 0 ===
    train loss:  0.4228307287627404
    val rand:  0.2964956760406494
    val onPol:  0.3668237527211507

=== Epoch 10 ===
    train loss:  0.18641996889486226
    val rand:  0.1846286505460739
    val onPol:  0.3248513837655385

=== Epoch 20 ===
    train loss:  0.1298907569378888
    val rand:  0.16038626432418823
    val onPol:  0.3516551156838735

=== Epoch 30 ===
    train loss:  0.098865426461631
    val rand:  0.1547478288412094
    val onPol:  0.377666433652242

=== Epoch 39 ===
    train loss:  0.0813783449590753
    val rand:  0.14825120568275452
    val onPol:  0.39542484283447266
Training duration: 28.69 s

#####################################
performing on-policy MPC rollouts... iter  99
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.293776521776252
DONE TAKING  40  STEPS.
Total reward:  -538.2692167557732
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.44910238747837
DONE TAKING  40  STEPS.
Total reward:  -872.7671261900438
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.228307705600802
DONE TAKING  40  STEPS.
Total reward:  -646.8593748407176
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.28560902073076
DONE TAKING  40  STEPS.
Total reward:  -789.2633351534412
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.27997976302224
DONE TAKING  40  STEPS.
Total reward:  -432.4613285165302
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -15.264190856815564
DONE TAKING  40  STEPS.
Total reward:  -348.157886026609
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -20.643280657158982
DONE TAKING  40  STEPS.
Total reward:  -331.3429890749879
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.35801878492323
DONE TAKING  40  STEPS.
Total reward:  -1093.8095391198099
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.562328143704406
DONE TAKING  40  STEPS.
Total reward:  -358.52875442827167
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.007010488040816
DONE TAKING  40  STEPS.
Total reward:  -31.649573661800858
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.574724163215436
DONE TAKING  40  STEPS.
Total reward:  -885.6325478659893
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.268337125986505
DONE TAKING  40  STEPS.
Total reward:  -1025.1783704776121
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.304234732726606
DONE TAKING  40  STEPS.
Total reward:  -693.658791486711
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.74760779530766
DONE TAKING  40  STEPS.
Total reward:  -788.6344204056968
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.543895148208968
DONE TAKING  40  STEPS.
Total reward:  -800.0507945642462
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -16.63253259188347
DONE TAKING  40  STEPS.
Total reward:  81.77842387894593
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -16.954583692928317
DONE TAKING  40  STEPS.
Total reward:  -489.68486809579525
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.881455316140237
DONE TAKING  40  STEPS.
Total reward:  -390.2367000089167
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.77768960255154
DONE TAKING  40  STEPS.
Total reward:  -802.0086706603195
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.515723546972755
DONE TAKING  40  STEPS.
Total reward:  -463.2482998047652
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.144837672331807
DONE TAKING  40  STEPS.
Total reward:  -835.5750828322148
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.492064832897256
DONE TAKING  40  STEPS.
Total reward:  -457.52174448402485
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.70193136545472
DONE TAKING  40  STEPS.
Total reward:  -510.49319145843515
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -12.451726026226453
DONE TAKING  40  STEPS.
Total reward:  -44.79566300851415
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.757830661432152
DONE TAKING  40  STEPS.
Total reward:  -610.4032566082736
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.927308479266404
DONE TAKING  40  STEPS.
Total reward:  -642.7699118006425
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.361957326925733
DONE TAKING  40  STEPS.
Total reward:  -741.2990156195427
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.21995163976215
DONE TAKING  40  STEPS.
Total reward:  -797.5424045597476
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.444139718958446
DONE TAKING  40  STEPS.
Total reward:  -197.13565283140267
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.282140712714916
DONE TAKING  40  STEPS.
Total reward:  -706.0241571721381
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.687983996519634
DONE TAKING  40  STEPS.
Total reward:  -583.9581385278219
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.209430771989457
DONE TAKING  40  STEPS.
Total reward:  -531.8710733455805
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -25.46035350912706
DONE TAKING  40  STEPS.
Total reward:  -672.4841171981569
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.40259348263307
DONE TAKING  40  STEPS.
Total reward:  -528.1893517458359
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.625020555418388
DONE TAKING  40  STEPS.
Total reward:  -860.8274049507679
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.164879365775374
DONE TAKING  40  STEPS.
Total reward:  -256.7842882454575
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -17.168046379910177
DONE TAKING  40  STEPS.
Total reward:  -369.5440412601259
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.836770204420345
DONE TAKING  40  STEPS.
Total reward:  -453.4999286861783
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -13.823121588916507
DONE TAKING  40  STEPS.
Total reward:  -339.1732282357834
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.162086049667813
DONE TAKING  40  STEPS.
Total reward:  -592.1454017943352
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter99.ckpt
Iter: 100
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  100
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  27300
On pol:  28800
Prob shape:  (56100,)

=== Epoch 0 ===
    train loss:  0.4247412542137531
    val rand:  0.30653226375579834
    val onPol:  0.38321205973625183

=== Epoch 10 ===
    train loss:  0.1895512376629978
    val rand:  0.1793367713689804
    val onPol:  0.35008593400319415

=== Epoch 20 ===
    train loss:  0.13094747729531123
    val rand:  0.16124007105827332
    val onPol:  0.38050604859987897

=== Epoch 30 ===
    train loss:  0.09857806583883566
    val rand:  0.1520209014415741
    val onPol:  0.4036200741926829

=== Epoch 39 ===
    train loss:  0.08261640739003452
    val rand:  0.15442880988121033
    val onPol:  0.42600645621617633
Training duration: 27.23 s

#####################################
performing on-policy MPC rollouts... iter  100
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.315192802704143
DONE TAKING  40  STEPS.
Total reward:  -853.0558892531142
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.853582960932638
DONE TAKING  40  STEPS.
Total reward:  -891.6114172064838
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.94959924260648
DONE TAKING  40  STEPS.
Total reward:  -733.2768582957092
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.365531157223398
DONE TAKING  40  STEPS.
Total reward:  -33.135658663713414
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -23.173085897997822
DONE TAKING  40  STEPS.
Total reward:  -782.3825984280966
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.76614944224089
DONE TAKING  40  STEPS.
Total reward:  -763.6114411408715
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.466901654132155
DONE TAKING  40  STEPS.
Total reward:  -340.1257390099638
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.202227690583122
DONE TAKING  40  STEPS.
Total reward:  -955.5443385134917
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -11.520736827315545
DONE TAKING  40  STEPS.
Total reward:  -85.17529089318569
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.307699500024075
DONE TAKING  40  STEPS.
Total reward:  -254.11156058585294
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.552929034866604
DONE TAKING  40  STEPS.
Total reward:  -131.47000914797013
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.41451836926304
DONE TAKING  40  STEPS.
Total reward:  -541.4746365658204
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -15.322907001718779
DONE TAKING  40  STEPS.
Total reward:  -28.798488757605856
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.84226430110747
DONE TAKING  40  STEPS.
Total reward:  -625.4103329441165
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.119189979791905
DONE TAKING  40  STEPS.
Total reward:  17.132927721140486
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.502736402852193
DONE TAKING  40  STEPS.
Total reward:  -838.6927596245196
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.006473720625102
DONE TAKING  40  STEPS.
Total reward:  -612.058943499333
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.678891833495246
DONE TAKING  40  STEPS.
Total reward:  -915.1149137166396
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.05120140318495
DONE TAKING  40  STEPS.
Total reward:  -892.5453837842927
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -16.734739560032352
DONE TAKING  40  STEPS.
Total reward:  -136.40530490087417
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.813949598477578
DONE TAKING  40  STEPS.
Total reward:  -609.7980370658304
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.01800514336998
DONE TAKING  40  STEPS.
Total reward:  -667.7180745747281
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.01908375378666
DONE TAKING  40  STEPS.
Total reward:  -820.9140549792721
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.09440390291437
DONE TAKING  40  STEPS.
Total reward:  100.84471400559849
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.126130724917125
DONE TAKING  40  STEPS.
Total reward:  -820.556901444415
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.121093999746517
DONE TAKING  40  STEPS.
Total reward:  -757.5946560690895
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.69909563128458
DONE TAKING  40  STEPS.
Total reward:  -125.24650274729177
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.00432591888709
DONE TAKING  40  STEPS.
Total reward:  -505.08456369649207
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -13.317483662493037
DONE TAKING  40  STEPS.
Total reward:  -582.5009591760305
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.05932448327649
DONE TAKING  40  STEPS.
Total reward:  -431.9187149603395
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -31.374853949671824
DONE TAKING  40  STEPS.
Total reward:  -614.7722810167406
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.244671783504504
DONE TAKING  40  STEPS.
Total reward:  -456.55935258059895
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.749197777851553
DONE TAKING  40  STEPS.
Total reward:  -546.330943443323
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.233640299442907
DONE TAKING  40  STEPS.
Total reward:  -413.3747436823426
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.338845951336715
DONE TAKING  40  STEPS.
Total reward:  -692.1529417345959
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.920846530098544
DONE TAKING  40  STEPS.
Total reward:  -823.488992203401
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -14.062091398194308
DONE TAKING  40  STEPS.
Total reward:  -462.7189233811529
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.86418603719743
DONE TAKING  40  STEPS.
Total reward:  -969.8354382495472
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.959158237103765
DONE TAKING  40  STEPS.
Total reward:  -777.5697212747225
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.414479916617683
DONE TAKING  40  STEPS.
Total reward:  -440.3551966511862
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter100.ckpt
Iter: 101
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  101
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  27495
On pol:  28800
Prob shape:  (56295,)

=== Epoch 0 ===
    train loss:  0.42748871719071624
    val rand:  0.3048463761806488
    val onPol:  0.3805234630902608

=== Epoch 10 ===
    train loss:  0.19043080795795544
    val rand:  0.1801031231880188
    val onPol:  0.34515149394671124

=== Epoch 20 ===
    train loss:  0.13155568828549954
    val rand:  0.16568729281425476
    val onPol:  0.37872885664304096

=== Epoch 30 ===
    train loss:  0.10041718895829052
    val rand:  0.16028711199760437
    val onPol:  0.402689923842748

=== Epoch 39 ===
    train loss:  0.08424258635405006
    val rand:  0.15344585478305817
    val onPol:  0.4226243793964386
Training duration: 27.90 s

#####################################
performing on-policy MPC rollouts... iter  101
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.401268587293835
DONE TAKING  40  STEPS.
Total reward:  -752.2221477475529
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.294821678884947
DONE TAKING  40  STEPS.
Total reward:  -578.7383373704319
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.336045996346698
DONE TAKING  40  STEPS.
Total reward:  -558.6886252540048
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.649522227963836
DONE TAKING  40  STEPS.
Total reward:  -346.8940163281658
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.899335759435502
DONE TAKING  40  STEPS.
Total reward:  -719.1678482738369
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.962346003213575
DONE TAKING  40  STEPS.
Total reward:  -376.3733005761919
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.977450741261848
DONE TAKING  40  STEPS.
Total reward:  -432.31440799343045
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.927245617886904
DONE TAKING  40  STEPS.
Total reward:  -738.7749239212138
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.292067356431275
DONE TAKING  40  STEPS.
Total reward:  -754.932035730446
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.98021140577927
DONE TAKING  40  STEPS.
Total reward:  -128.40670619442662
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.236635417296817
DONE TAKING  40  STEPS.
Total reward:  -357.40263907420945
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -10.273747022072524
DONE TAKING  40  STEPS.
Total reward:  -363.4186446666745
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.305459527034174
DONE TAKING  40  STEPS.
Total reward:  -772.2284843659817
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.059765332449047
DONE TAKING  40  STEPS.
Total reward:  -171.94266435603515
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.507222889477575
DONE TAKING  40  STEPS.
Total reward:  -278.6882277838973
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -14.009346210513227
DONE TAKING  40  STEPS.
Total reward:  -436.59631891216094
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.1235287529568
DONE TAKING  40  STEPS.
Total reward:  -54.3672360273782
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -10.78190532845648
DONE TAKING  40  STEPS.
Total reward:  -379.4673326015844
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -11.178151191566826
DONE TAKING  40  STEPS.
Total reward:  -394.35157190226886
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.491867913086892
DONE TAKING  40  STEPS.
Total reward:  -875.452901055832
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -12.200928143879196
DONE TAKING  40  STEPS.
Total reward:  88.10422362497502
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.303228435073464
DONE TAKING  40  STEPS.
Total reward:  -821.5017692224021
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.315825115531194
DONE TAKING  40  STEPS.
Total reward:  -841.3611764047467
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -13.963200707936075
DONE TAKING  40  STEPS.
Total reward:  -213.05633255062077
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.623499413100355
DONE TAKING  40  STEPS.
Total reward:  -396.25430128503876
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.88133024634891
DONE TAKING  40  STEPS.
Total reward:  -988.053691514467
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.06916862808042
DONE TAKING  40  STEPS.
Total reward:  -814.4203813371545
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.351908653397597
DONE TAKING  40  STEPS.
Total reward:  -621.7710117634265
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.654935676644627
DONE TAKING  40  STEPS.
Total reward:  -795.8255095875411
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.258208741482015
DONE TAKING  40  STEPS.
Total reward:  -511.8006409016647
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.335495738601345
DONE TAKING  40  STEPS.
Total reward:  -495.8378014594419
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.605588489538246
DONE TAKING  40  STEPS.
Total reward:  -781.222657331506
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -14.614501761244414
DONE TAKING  40  STEPS.
Total reward:  29.334157080908824
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.170138947442382
DONE TAKING  40  STEPS.
Total reward:  -215.83127520543354
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.553224139122342
DONE TAKING  40  STEPS.
Total reward:  -669.1103768449619
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.503930655606187
DONE TAKING  40  STEPS.
Total reward:  -363.6502006250139
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -22.42405116483973
DONE TAKING  40  STEPS.
Total reward:  -852.9980021896062
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -31.1561448002239
DONE TAKING  40  STEPS.
Total reward:  -678.041960078198
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.570332269281046
DONE TAKING  40  STEPS.
Total reward:  -427.5911529294571
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.205324867810084
DONE TAKING  40  STEPS.
Total reward:  -413.1355847892077
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter101.ckpt
Iter: 102
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  102
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  27690
On pol:  28800
Prob shape:  (56490,)

=== Epoch 0 ===
    train loss:  0.4254698249426755
    val rand:  0.30649182200431824
    val onPol:  0.3816971282164256

=== Epoch 10 ===
    train loss:  0.18830199417742816
    val rand:  0.18051549792289734
    val onPol:  0.3425910870234172

=== Epoch 20 ===
    train loss:  0.13032602044669064
    val rand:  0.16423657536506653
    val onPol:  0.3701326747735341

=== Epoch 30 ===
    train loss:  0.09936026321216063
    val rand:  0.15227583050727844
    val onPol:  0.3991386989752452

=== Epoch 39 ===
    train loss:  0.08272437243299051
    val rand:  0.1503506600856781
    val onPol:  0.4165894190470378
Training duration: 27.50 s

#####################################
performing on-policy MPC rollouts... iter  102
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.20413222462483
DONE TAKING  40  STEPS.
Total reward:  -469.48829045044727
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.305191069370117
DONE TAKING  40  STEPS.
Total reward:  -816.5061503844023
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.497017267472692
DONE TAKING  40  STEPS.
Total reward:  -165.21798386399036
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.286521988696546
DONE TAKING  40  STEPS.
Total reward:  -382.88648378854884
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.726096126888805
DONE TAKING  40  STEPS.
Total reward:  -633.347515300143
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.30720133202461
DONE TAKING  40  STEPS.
Total reward:  -633.8405524850026
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.200848736098372
DONE TAKING  40  STEPS.
Total reward:  -700.8539379644867
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.627568116489325
DONE TAKING  40  STEPS.
Total reward:  -742.596198135222
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.4273642714694
DONE TAKING  40  STEPS.
Total reward:  -285.96523075905503
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.716667450533047
DONE TAKING  40  STEPS.
Total reward:  -300.41897580632815
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.989355097840487
DONE TAKING  40  STEPS.
Total reward:  -375.0497776064574
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -12.819782522906715
DONE TAKING  40  STEPS.
Total reward:  -374.9768436868598
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.17653981503196
DONE TAKING  40  STEPS.
Total reward:  -741.2709112343321
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.53057624696701
DONE TAKING  40  STEPS.
Total reward:  -557.0834126588873
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.63417361779336
DONE TAKING  40  STEPS.
Total reward:  -654.4933288581576
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.057607253641773
DONE TAKING  40  STEPS.
Total reward:  -594.9848453140328
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.93030051908982
DONE TAKING  40  STEPS.
Total reward:  -676.74247023041
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.657176995772076
DONE TAKING  40  STEPS.
Total reward:  -77.5588540060284
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.419661349294977
DONE TAKING  40  STEPS.
Total reward:  -505.7161634837895
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.672611042941277
DONE TAKING  40  STEPS.
Total reward:  -842.7596862548901
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.35336208910653
DONE TAKING  40  STEPS.
Total reward:  -362.32097217214954
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.126857832661635
DONE TAKING  40  STEPS.
Total reward:  -1107.8296426930647
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.84434260952593
DONE TAKING  40  STEPS.
Total reward:  -933.0944328722446
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.756086348565532
DONE TAKING  40  STEPS.
Total reward:  -489.15971434851366
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -13.052654430665143
DONE TAKING  40  STEPS.
Total reward:  -238.0504041580809
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.29656850814819
DONE TAKING  40  STEPS.
Total reward:  -731.6913993405947
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.705031606889136
DONE TAKING  40  STEPS.
Total reward:  -684.5171286515024
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.433407829128758
DONE TAKING  40  STEPS.
Total reward:  -495.68376580190903
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.723359945499404
DONE TAKING  40  STEPS.
Total reward:  -1021.7741525089943
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.384889740482464
DONE TAKING  40  STEPS.
Total reward:  -600.1876860545549
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.0639013931769
DONE TAKING  40  STEPS.
Total reward:  -642.9048386549056
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.294756721464225
DONE TAKING  40  STEPS.
Total reward:  -807.1496714079641
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.359270226967585
DONE TAKING  40  STEPS.
Total reward:  -572.219316971871
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.732740835509915
DONE TAKING  40  STEPS.
Total reward:  -56.38602978667926
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.935767067768815
DONE TAKING  40  STEPS.
Total reward:  -276.0484361705771
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.97520380957136
DONE TAKING  40  STEPS.
Total reward:  -417.82302461873434
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -14.296160912602513
DONE TAKING  40  STEPS.
Total reward:  -515.1083249124456
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.83627415788943
DONE TAKING  40  STEPS.
Total reward:  -526.4658864986282
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.80762307345331
DONE TAKING  40  STEPS.
Total reward:  -128.89718123529735
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.4559296655628
DONE TAKING  40  STEPS.
Total reward:  -880.2842481971392
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter102.ckpt
Iter: 103
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  103
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  27885
On pol:  28800
Prob shape:  (56685,)

=== Epoch 0 ===
    train loss:  0.4258013364943591
    val rand:  0.30893847346305847
    val onPol:  0.38704347610473633

=== Epoch 10 ===
    train loss:  0.19008163484660062
    val rand:  0.17886941134929657
    val onPol:  0.35511871178944904

=== Epoch 20 ===
    train loss:  0.1314112130891193
    val rand:  0.1589086949825287
    val onPol:  0.37978660066922504

=== Epoch 30 ===
    train loss:  0.09968377927487547
    val rand:  0.15294837951660156
    val onPol:  0.40900014837582904

=== Epoch 39 ===
    train loss:  0.08308420648629015
    val rand:  0.14820906519889832
    val onPol:  0.42582916220029193
Training duration: 28.93 s

#####################################
performing on-policy MPC rollouts... iter  103
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.645377783284022
DONE TAKING  40  STEPS.
Total reward:  -1014.032116030023
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.117546158082416
DONE TAKING  40  STEPS.
Total reward:  -585.5843777139173
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.48098847700375
DONE TAKING  40  STEPS.
Total reward:  -552.1842080278132
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -14.269179569059729
DONE TAKING  40  STEPS.
Total reward:  -187.7867525023577
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.45458225387364
DONE TAKING  40  STEPS.
Total reward:  -588.389404548466
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.84735652766673
DONE TAKING  40  STEPS.
Total reward:  -585.3665974821363
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.97898896898974
DONE TAKING  40  STEPS.
Total reward:  -831.3546091708246
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.384970135737568
DONE TAKING  40  STEPS.
Total reward:  -1019.2143401869951
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.225630548000098
DONE TAKING  40  STEPS.
Total reward:  -485.64320029346777
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.382660007627777
DONE TAKING  40  STEPS.
Total reward:  -712.063929867223
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -17.825483196997535
DONE TAKING  40  STEPS.
Total reward:  -430.2969217095911
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.6913966848617
DONE TAKING  40  STEPS.
Total reward:  167.5923788280264
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -17.986276734891998
DONE TAKING  40  STEPS.
Total reward:  -6.036718238921842
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -13.676002316355948
DONE TAKING  40  STEPS.
Total reward:  -374.059053104963
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.57155450645221
DONE TAKING  40  STEPS.
Total reward:  -978.4783604725146
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.77480198708344
DONE TAKING  40  STEPS.
Total reward:  -798.0527339135817
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.231915311777687
DONE TAKING  40  STEPS.
Total reward:  -518.8927403928619
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.536161327881093
DONE TAKING  40  STEPS.
Total reward:  -518.8336370019524
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.05654258668933
DONE TAKING  40  STEPS.
Total reward:  -348.4937615308826
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.933349723816832
DONE TAKING  40  STEPS.
Total reward:  -866.865050449392
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.625538256869707
DONE TAKING  40  STEPS.
Total reward:  -547.3465865998362
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -20.035984017089508
DONE TAKING  40  STEPS.
Total reward:  -373.5950231514181
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.263292932739013
DONE TAKING  40  STEPS.
Total reward:  -434.20005130359124
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.991778340491564
DONE TAKING  40  STEPS.
Total reward:  -495.1035237339119
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.77272261669816
DONE TAKING  40  STEPS.
Total reward:  -728.1613987082885
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.78181910264206
DONE TAKING  40  STEPS.
Total reward:  -533.8284854673676
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -15.527636781535481
DONE TAKING  40  STEPS.
Total reward:  -441.10241656274866
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.55182942170378
DONE TAKING  40  STEPS.
Total reward:  -610.3522856701851
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -21.346346846763367
DONE TAKING  40  STEPS.
Total reward:  -695.6168497787835
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -15.638354540115305
DONE TAKING  40  STEPS.
Total reward:  -143.58215031468018
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.000082883625176
DONE TAKING  40  STEPS.
Total reward:  -674.7789666587686
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.668871806101656
DONE TAKING  40  STEPS.
Total reward:  -638.9107647660206
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.316981804402594
DONE TAKING  40  STEPS.
Total reward:  -787.7519668905763
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -31.074726424353187
DONE TAKING  40  STEPS.
Total reward:  -780.1946642912498
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.582507189891732
DONE TAKING  40  STEPS.
Total reward:  -387.912440118587
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.190382419936146
DONE TAKING  40  STEPS.
Total reward:  -994.7904287964795
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.531605945287637
DONE TAKING  40  STEPS.
Total reward:  -591.0232500358655
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.71042523653738
DONE TAKING  40  STEPS.
Total reward:  -245.45597809769552
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.537478961966233
DONE TAKING  40  STEPS.
Total reward:  -285.29550253567476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.1070284204067
DONE TAKING  40  STEPS.
Total reward:  -961.8182852414094
Time for 1 rollout: 1.37 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter103.ckpt
Iter: 104
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  104
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  28080
On pol:  28800
Prob shape:  (56880,)

=== Epoch 0 ===
    train loss:  0.4256590666534664
    val rand:  0.3052625060081482
    val onPol:  0.3841386040051778

=== Epoch 10 ===
    train loss:  0.1918603724187559
    val rand:  0.1779056042432785
    val onPol:  0.34550516804059345

=== Epoch 20 ===
    train loss:  0.13257532613771456
    val rand:  0.16359680891036987
    val onPol:  0.37824366490046185

=== Epoch 30 ===
    train loss:  0.10135913787929861
    val rand:  0.15830594301223755
    val onPol:  0.4101046522458394

=== Epoch 39 ===
    train loss:  0.08514583963263142
    val rand:  0.15040913224220276
    val onPol:  0.4220137894153595
Training duration: 27.75 s

#####################################
performing on-policy MPC rollouts... iter  104
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.564352925661467
DONE TAKING  40  STEPS.
Total reward:  -885.9346906070841
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -24.693497677660936
DONE TAKING  40  STEPS.
Total reward:  -454.6094733315498
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.21898803801809
DONE TAKING  40  STEPS.
Total reward:  -816.6515017593505
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -13.38652164211345
DONE TAKING  40  STEPS.
Total reward:  -549.7148152781883
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.801369140248877
DONE TAKING  40  STEPS.
Total reward:  -591.7342576234756
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.903488957157812
DONE TAKING  40  STEPS.
Total reward:  -270.3308839129131
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.855470339483066
DONE TAKING  40  STEPS.
Total reward:  -519.5923492787924
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -11.667257108835798
DONE TAKING  40  STEPS.
Total reward:  -325.39436309841926
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.284461133849767
DONE TAKING  40  STEPS.
Total reward:  -498.0267892629308
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.64615108618333
DONE TAKING  40  STEPS.
Total reward:  -952.5332625368608
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.376891053792665
DONE TAKING  40  STEPS.
Total reward:  -627.6555156200277
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -13.721892244442309
DONE TAKING  40  STEPS.
Total reward:  -761.4697679212878
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.242066123851842
DONE TAKING  40  STEPS.
Total reward:  -687.5763228511997
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -13.82669378712504
DONE TAKING  40  STEPS.
Total reward:  -452.7108451343366
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.299076575361582
DONE TAKING  40  STEPS.
Total reward:  -949.8849507249514
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.12829562465793
DONE TAKING  40  STEPS.
Total reward:  -623.3528252507031
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.702958981404922
DONE TAKING  40  STEPS.
Total reward:  -427.0807479516016
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -18.580109151595316
DONE TAKING  40  STEPS.
Total reward:  -526.9038450092477
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.66368652856068
DONE TAKING  40  STEPS.
Total reward:  -590.731811242402
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.965460831245846
DONE TAKING  40  STEPS.
Total reward:  -57.880740763146214
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.432571940949494
DONE TAKING  40  STEPS.
Total reward:  -597.3636181102568
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.80490314527646
DONE TAKING  40  STEPS.
Total reward:  -476.31896086441446
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -16.884384504635463
DONE TAKING  40  STEPS.
Total reward:  -530.4809109274731
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.344270868051943
DONE TAKING  40  STEPS.
Total reward:  -495.9661910965961
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.891419517855013
DONE TAKING  40  STEPS.
Total reward:  -457.66638942003976
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.384955321195463
DONE TAKING  40  STEPS.
Total reward:  -559.0007789325463
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.925621655619043
DONE TAKING  40  STEPS.
Total reward:  -518.2483040673432
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.14186083678898
DONE TAKING  40  STEPS.
Total reward:  -266.1156579328298
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.192033946977457
DONE TAKING  40  STEPS.
Total reward:  -595.4702730916915
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.387814997794102
DONE TAKING  40  STEPS.
Total reward:  -648.1881953796111
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -13.577921911436057
DONE TAKING  40  STEPS.
Total reward:  -364.61571066029603
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.248696401272937
DONE TAKING  40  STEPS.
Total reward:  -397.70571658146406
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.03875196665735
DONE TAKING  40  STEPS.
Total reward:  -1012.3615174645572
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.567939582728993
DONE TAKING  40  STEPS.
Total reward:  -804.3650773028389
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.528889584182707
DONE TAKING  40  STEPS.
Total reward:  -354.99429740668154
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.926806002988357
DONE TAKING  40  STEPS.
Total reward:  -1001.1976816729949
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -15.398741035119583
DONE TAKING  40  STEPS.
Total reward:  -328.8054601786105
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.026888298527513
DONE TAKING  40  STEPS.
Total reward:  -369.59434876149993
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -12.414530912401855
DONE TAKING  40  STEPS.
Total reward:  -546.6272274515612
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.03260560087371
DONE TAKING  40  STEPS.
Total reward:  -291.2407088210504
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter104.ckpt
Iter: 105
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  105
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  28275
On pol:  28800
Prob shape:  (57075,)

=== Epoch 0 ===
    train loss:  0.42303371805328505
    val rand:  0.31002354621887207
    val onPol:  0.3738122781117757

=== Epoch 10 ===
    train loss:  0.19194183371088527
    val rand:  0.18612836301326752
    val onPol:  0.33760882417360943

=== Epoch 20 ===
    train loss:  0.13235564086888288
    val rand:  0.16339585185050964
    val onPol:  0.36381731430689496

=== Epoch 30 ===
    train loss:  0.1008010107251975
    val rand:  0.15980222821235657
    val onPol:  0.38953744371732074

=== Epoch 39 ===
    train loss:  0.08507781522768038
    val rand:  0.15103699266910553
    val onPol:  0.40689892570177716
Training duration: 14.47 s

#####################################
performing on-policy MPC rollouts... iter  105
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.55989776823235
DONE TAKING  40  STEPS.
Total reward:  -360.6568763509711
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.15982163030858
DONE TAKING  40  STEPS.
Total reward:  -678.1532083376081
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -11.045400894375518
DONE TAKING  40  STEPS.
Total reward:  -348.03054948728453
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.212490288152814
DONE TAKING  40  STEPS.
Total reward:  -376.88553662915245
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.531247087601994
DONE TAKING  40  STEPS.
Total reward:  -846.7375825676316
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.786237084920597
DONE TAKING  40  STEPS.
Total reward:  -577.0178660383131
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.436616714347053
DONE TAKING  40  STEPS.
Total reward:  -516.5914910663674
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -20.235339338509043
DONE TAKING  40  STEPS.
Total reward:  -510.1977180666182
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.152397768597634
DONE TAKING  40  STEPS.
Total reward:  -749.7164825148626
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.938128185687432
DONE TAKING  40  STEPS.
Total reward:  -770.5421180327469
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -13.188820104178644
DONE TAKING  40  STEPS.
Total reward:  -498.3094819415973
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -20.429720960576677
DONE TAKING  40  STEPS.
Total reward:  -713.8273174513653
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.22412342811519
DONE TAKING  40  STEPS.
Total reward:  -967.8902989024881
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.511302209201354
DONE TAKING  40  STEPS.
Total reward:  -412.1119222276719
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.769765992660446
DONE TAKING  40  STEPS.
Total reward:  -716.4253479262467
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.205007437966174
DONE TAKING  40  STEPS.
Total reward:  -495.87271161819297
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.63209626248937
DONE TAKING  40  STEPS.
Total reward:  -485.6419520169632
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.24635854795922
DONE TAKING  40  STEPS.
Total reward:  -731.4887002026607
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.286411391943894
DONE TAKING  40  STEPS.
Total reward:  -430.0110900973189
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.304118862046984
DONE TAKING  40  STEPS.
Total reward:  -657.9752974350351
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.415428404538444
DONE TAKING  40  STEPS.
Total reward:  -418.2593520661069
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.484037213765788
DONE TAKING  40  STEPS.
Total reward:  -449.3724721096031
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -14.831677779386776
DONE TAKING  40  STEPS.
Total reward:  -351.5455167034365
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.97689164049002
DONE TAKING  40  STEPS.
Total reward:  -578.2765645465994
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.43880853202964
DONE TAKING  40  STEPS.
Total reward:  -846.1423091498539
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.65791156487384
DONE TAKING  40  STEPS.
Total reward:  -983.6236145260144
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -12.217666922329965
DONE TAKING  40  STEPS.
Total reward:  -288.95605006337263
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.558893396347237
DONE TAKING  40  STEPS.
Total reward:  -366.98884659889217
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.22987950868259
DONE TAKING  40  STEPS.
Total reward:  -778.3655326995979
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.88663540530328
DONE TAKING  40  STEPS.
Total reward:  -1000.8986532485907
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -12.41713539412558
DONE TAKING  40  STEPS.
Total reward:  -253.70969464168596
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.885532994736728
DONE TAKING  40  STEPS.
Total reward:  -958.883893089329
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.70824823971215
DONE TAKING  40  STEPS.
Total reward:  189.72108221510027
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.037626367664288
DONE TAKING  40  STEPS.
Total reward:  -584.447343693485
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.893161939620853
DONE TAKING  40  STEPS.
Total reward:  -422.6302029976667
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.5506264739756
DONE TAKING  40  STEPS.
Total reward:  -540.9528215270107
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.301389730581
DONE TAKING  40  STEPS.
Total reward:  -602.1583431469621
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.294822361808208
DONE TAKING  40  STEPS.
Total reward:  -904.3479896455109
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.385332847175103
DONE TAKING  40  STEPS.
Total reward:  -912.4580101919103
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -11.086097054324199
DONE TAKING  40  STEPS.
Total reward:  3.0304588448113456
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter105.ckpt
Iter: 106
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  106
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  28470
On pol:  28800
Prob shape:  (57270,)

=== Epoch 0 ===
    train loss:  0.427842801755613
    val rand:  0.299532026052475
    val onPol:  0.38043344020843506

=== Epoch 10 ===
    train loss:  0.1937497826041402
    val rand:  0.18279069662094116
    val onPol:  0.33725622296333313

=== Epoch 20 ===
    train loss:  0.1351585958052326
    val rand:  0.16332387924194336
    val onPol:  0.36862969398498535

=== Epoch 30 ===
    train loss:  0.10249631147126893
    val rand:  0.1511140912771225
    val onPol:  0.395466685295105

=== Epoch 39 ===
    train loss:  0.0855629679721755
    val rand:  0.15128716826438904
    val onPol:  0.41537617643674213
Training duration: 28.50 s

#####################################
performing on-policy MPC rollouts... iter  106
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.817946584088922
DONE TAKING  40  STEPS.
Total reward:  -584.1952910616418
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.826331516423984
DONE TAKING  40  STEPS.
Total reward:  -425.85788037029096
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.8647814833708
DONE TAKING  40  STEPS.
Total reward:  -353.7041248601922
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.577703753909292
DONE TAKING  40  STEPS.
Total reward:  -277.69068449270463
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.673096527560496
DONE TAKING  40  STEPS.
Total reward:  -966.713148674572
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.12481637276526
DONE TAKING  40  STEPS.
Total reward:  -624.9066511912768
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.63547146931986
DONE TAKING  40  STEPS.
Total reward:  -591.1177800703038
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.613243343122065
DONE TAKING  40  STEPS.
Total reward:  -236.05672189813532
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.306253212937918
DONE TAKING  40  STEPS.
Total reward:  -812.7370728003875
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -11.289256633936965
DONE TAKING  40  STEPS.
Total reward:  -280.89813385231855
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.815116257868613
DONE TAKING  40  STEPS.
Total reward:  -204.01330326671464
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.658951206819573
DONE TAKING  40  STEPS.
Total reward:  -863.5428865883217
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.589571370250376
DONE TAKING  40  STEPS.
Total reward:  -413.697943346201
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.707300485850645
DONE TAKING  40  STEPS.
Total reward:  -349.1479091257198
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.52263687887315
DONE TAKING  40  STEPS.
Total reward:  -484.75533002765707
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.06858857785227
DONE TAKING  40  STEPS.
Total reward:  -748.5345595681582
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.00929192155035
DONE TAKING  40  STEPS.
Total reward:  -722.595309315872
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.720353107840253
DONE TAKING  40  STEPS.
Total reward:  -492.16619273155845
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -11.720936106933708
DONE TAKING  40  STEPS.
Total reward:  -350.0734187277931
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.680692242616335
DONE TAKING  40  STEPS.
Total reward:  -530.9428394567934
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -18.313792744948362
DONE TAKING  40  STEPS.
Total reward:  -525.4724720848578
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.913769721013377
DONE TAKING  40  STEPS.
Total reward:  -299.1963364055395
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -13.8014634098854
DONE TAKING  40  STEPS.
Total reward:  -215.9438960063384
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -13.43406109102952
DONE TAKING  40  STEPS.
Total reward:  -441.6591903874315
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -31.00878883204868
DONE TAKING  40  STEPS.
Total reward:  -309.40411145681065
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.831345328878548
DONE TAKING  40  STEPS.
Total reward:  -323.5346795688339
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.64786242551948
DONE TAKING  40  STEPS.
Total reward:  -481.09756218334513
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.728136188689618
DONE TAKING  40  STEPS.
Total reward:  -399.8496195181132
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.144782104487078
DONE TAKING  40  STEPS.
Total reward:  -80.40771476082597
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.430240358614306
DONE TAKING  40  STEPS.
Total reward:  -929.6190296701525
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.94631750696579
DONE TAKING  40  STEPS.
Total reward:  -753.4294798548027
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -19.019977481546256
DONE TAKING  40  STEPS.
Total reward:  -440.5646873965387
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.810419804668186
DONE TAKING  40  STEPS.
Total reward:  -401.37642164136724
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.30526673260078
DONE TAKING  40  STEPS.
Total reward:  -844.3755395768967
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -10.596235060072681
DONE TAKING  40  STEPS.
Total reward:  87.47322764819016
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.169143807096603
DONE TAKING  40  STEPS.
Total reward:  -886.7821323922205
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.621989732445176
DONE TAKING  40  STEPS.
Total reward:  -263.1073548340669
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -18.894376854620145
DONE TAKING  40  STEPS.
Total reward:  -753.7105574498452
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.3706705391557
DONE TAKING  40  STEPS.
Total reward:  -838.4792480862759
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.80088908283485
DONE TAKING  40  STEPS.
Total reward:  -531.5227173766561
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter106.ckpt
Iter: 107
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  107
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  28665
On pol:  28800
Prob shape:  (57465,)

=== Epoch 0 ===
    train loss:  0.42697835713624954
    val rand:  0.2994668483734131
    val onPol:  0.384646475315094

=== Epoch 10 ===
    train loss:  0.1931835092338068
    val rand:  0.18162278831005096
    val onPol:  0.3444360891977946

=== Epoch 20 ===
    train loss:  0.1333589382203562
    val rand:  0.1592385619878769
    val onPol:  0.36852123339970905

=== Epoch 30 ===
    train loss:  0.10166252823546529
    val rand:  0.1492554396390915
    val onPol:  0.3985382616519928

=== Epoch 39 ===
    train loss:  0.0855147068255714
    val rand:  0.15385493636131287
    val onPol:  0.4200304051240285
Training duration: 29.41 s

#####################################
performing on-policy MPC rollouts... iter  107
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.441090970190984
DONE TAKING  40  STEPS.
Total reward:  -700.2669196879114
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.598275844336683
DONE TAKING  40  STEPS.
Total reward:  -397.514168586379
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.30446851616896
DONE TAKING  40  STEPS.
Total reward:  -473.9429247489515
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.93337006609093
DONE TAKING  40  STEPS.
Total reward:  -1012.7066246966133
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.053232140152886
DONE TAKING  40  STEPS.
Total reward:  -764.2992307857428
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.688552221525725
DONE TAKING  40  STEPS.
Total reward:  -579.9250432736377
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -9.807444295607732
DONE TAKING  40  STEPS.
Total reward:  -287.2598782101972
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.59494332876323
DONE TAKING  40  STEPS.
Total reward:  -623.594673423268
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.895690186597037
DONE TAKING  40  STEPS.
Total reward:  -637.6900462497028
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -31.274129203308696
DONE TAKING  40  STEPS.
Total reward:  -784.2468649831957
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -31.31060760541821
DONE TAKING  40  STEPS.
Total reward:  -935.2861070819783
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.267305259579807
DONE TAKING  40  STEPS.
Total reward:  -772.524930886351
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -12.917295332212614
DONE TAKING  40  STEPS.
Total reward:  -79.47459185332643
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -12.28535983533157
DONE TAKING  40  STEPS.
Total reward:  -292.3502053133103
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.10525737918021
DONE TAKING  40  STEPS.
Total reward:  -108.89429010922382
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.415765680664936
DONE TAKING  40  STEPS.
Total reward:  19.608286814352798
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -31.218317361032067
DONE TAKING  40  STEPS.
Total reward:  -523.0610049693155
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.300761469595226
DONE TAKING  40  STEPS.
Total reward:  -541.2557997632197
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.600585802972752
DONE TAKING  40  STEPS.
Total reward:  -271.63508240363973
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.864785322209833
DONE TAKING  40  STEPS.
Total reward:  -621.8041576972442
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.350181983324568
DONE TAKING  40  STEPS.
Total reward:  -705.7299329005094
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.840626119407492
DONE TAKING  40  STEPS.
Total reward:  -623.2786966599601
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -13.591828632529959
DONE TAKING  40  STEPS.
Total reward:  -284.6027578312069
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.189035470286612
DONE TAKING  40  STEPS.
Total reward:  -34.648331249775914
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.548070868738282
DONE TAKING  40  STEPS.
Total reward:  -166.45661630843276
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -31.12955570669371
DONE TAKING  40  STEPS.
Total reward:  -788.1837085890243
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.549600851430448
DONE TAKING  40  STEPS.
Total reward:  -790.3033608024854
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -13.893642649449085
DONE TAKING  40  STEPS.
Total reward:  -389.93149927018476
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.809749264121937
DONE TAKING  40  STEPS.
Total reward:  -660.6354677262872
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -17.80099777680303
DONE TAKING  40  STEPS.
Total reward:  -274.7480053705032
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -11.091276658085011
DONE TAKING  40  STEPS.
Total reward:  -280.6560826619024
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.216225281797943
DONE TAKING  40  STEPS.
Total reward:  -1068.3403423804425
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -14.527460702135723
DONE TAKING  40  STEPS.
Total reward:  -278.3130806830041
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.28351543315386
DONE TAKING  40  STEPS.
Total reward:  -771.8893581483217
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.390504974639292
DONE TAKING  40  STEPS.
Total reward:  -255.68408455887422
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.821203360253087
DONE TAKING  40  STEPS.
Total reward:  -457.8047074838952
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -12.764064908902808
DONE TAKING  40  STEPS.
Total reward:  -310.2632487045178
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.604956988868786
DONE TAKING  40  STEPS.
Total reward:  -680.7109991786504
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.708550902433927
DONE TAKING  40  STEPS.
Total reward:  -719.0589280240889
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -12.842955300511182
DONE TAKING  40  STEPS.
Total reward:  -243.66313422086736
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter107.ckpt
Iter: 108
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  108
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  28860
On pol:  57600
Prob shape:  (86460,)

=== Epoch 0 ===
    train loss:  0.4011595660731906
    val rand:  0.30180203914642334
    val onPol:  0.3607666989167531

=== Epoch 10 ===
    train loss:  0.14573358336374873
    val rand:  0.18789921700954437
    val onPol:  0.355771670738856

=== Epoch 20 ===
    train loss:  0.08797435737436726
    val rand:  0.1684148907661438
    val onPol:  0.3998042444388072

=== Epoch 30 ===
    train loss:  0.06430994226996388
    val rand:  0.16132324934005737
    val onPol:  0.42790935436884564

=== Epoch 39 ===
    train loss:  0.05351708201868903
    val rand:  0.15385189652442932
    val onPol:  0.4420109689235687
Training duration: 43.45 s

#####################################
performing on-policy MPC rollouts... iter  108
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -18.243351664812447
DONE TAKING  40  STEPS.
Total reward:  -653.114258795642
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -31.06685504208184
DONE TAKING  40  STEPS.
Total reward:  -646.150295630761
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -13.417660767102202
DONE TAKING  40  STEPS.
Total reward:  -388.5816935508303
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.79321003333632
DONE TAKING  40  STEPS.
Total reward:  -687.7737308391838
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.146609170471283
DONE TAKING  40  STEPS.
Total reward:  -654.9762553731731
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.22135122490743
DONE TAKING  40  STEPS.
Total reward:  -501.47362021356844
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.53896468500927
DONE TAKING  40  STEPS.
Total reward:  -479.00462958789154
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.036677264022956
DONE TAKING  40  STEPS.
Total reward:  -1120.0304423505595
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.820338951888818
DONE TAKING  40  STEPS.
Total reward:  -249.892581604428
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.40799182276668
DONE TAKING  40  STEPS.
Total reward:  -573.364134476163
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.72136774558937
DONE TAKING  40  STEPS.
Total reward:  -351.1064233142807
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.922051884024228
DONE TAKING  40  STEPS.
Total reward:  -427.40584779431043
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.43397652297584
DONE TAKING  40  STEPS.
Total reward:  -454.32837458112846
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -27.313830548363065
DONE TAKING  40  STEPS.
Total reward:  -563.7613417528481
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.185313909757046
DONE TAKING  40  STEPS.
Total reward:  -535.6311397270996
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.163578796299532
DONE TAKING  40  STEPS.
Total reward:  -499.680333871332
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.002065645371424
DONE TAKING  40  STEPS.
Total reward:  -96.59670331263581
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.796205822431855
DONE TAKING  40  STEPS.
Total reward:  -556.7796310308669
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.141759601827783
DONE TAKING  40  STEPS.
Total reward:  -468.6204336109354
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.39724952750521
DONE TAKING  40  STEPS.
Total reward:  -905.6822787648265
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.09753434137463
DONE TAKING  40  STEPS.
Total reward:  -563.7864811564466
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.511636326554335
DONE TAKING  40  STEPS.
Total reward:  -437.9506398245336
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.56383282897754
DONE TAKING  40  STEPS.
Total reward:  -317.5197479380258
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.51615699442429
DONE TAKING  40  STEPS.
Total reward:  -513.7092014514959
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.538109885830952
DONE TAKING  40  STEPS.
Total reward:  -567.3853978991073
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.442710031313048
DONE TAKING  40  STEPS.
Total reward:  -548.6608893668102
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.774543028144407
DONE TAKING  40  STEPS.
Total reward:  -1075.387324129737
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.939531002871004
DONE TAKING  40  STEPS.
Total reward:  -956.4622359353095
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.25063830859095
DONE TAKING  40  STEPS.
Total reward:  -183.49350422267628
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.28191968226134
DONE TAKING  40  STEPS.
Total reward:  -515.0789257974606
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.460384368098808
DONE TAKING  40  STEPS.
Total reward:  -648.0089753924013
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -9.973486822427013
DONE TAKING  40  STEPS.
Total reward:  -138.38546563354834
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.725543148550386
DONE TAKING  40  STEPS.
Total reward:  -402.2933163003262
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.124134772877348
DONE TAKING  40  STEPS.
Total reward:  -1041.9766937962515
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -13.922354068344266
DONE TAKING  40  STEPS.
Total reward:  -257.2262201286617
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.924100690825078
DONE TAKING  40  STEPS.
Total reward:  -447.62606455523945
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.5489836053787
DONE TAKING  40  STEPS.
Total reward:  -748.0521132779903
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.22205979699704
DONE TAKING  40  STEPS.
Total reward:  -454.38083717611073
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.50335556658936
DONE TAKING  40  STEPS.
Total reward:  -599.109317433024
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.987443155906483
DONE TAKING  40  STEPS.
Total reward:  241.90083843662046
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter108.ckpt
Iter: 109
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  109
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  29055
On pol:  57600
Prob shape:  (86655,)

=== Epoch 0 ===
    train loss:  0.3982196339136045
    val rand:  0.3034093976020813
    val onPol:  0.3697921733061473

=== Epoch 10 ===
    train loss:  0.14293275526642094
    val rand:  0.186079740524292
    val onPol:  0.367449829975764

=== Epoch 20 ===
    train loss:  0.08514014190647023
    val rand:  0.17065589129924774
    val onPol:  0.40845949451128644

=== Epoch 30 ===
    train loss:  0.06328272032579021
    val rand:  0.1608402132987976
    val onPol:  0.4317732850710551

=== Epoch 39 ===
    train loss:  0.0539340330342922
    val rand:  0.15191581845283508
    val onPol:  0.45021506150563556
Training duration: 44.75 s

#####################################
performing on-policy MPC rollouts... iter  109
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.972490721152788
DONE TAKING  40  STEPS.
Total reward:  -853.2364048281671
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.778555821137218
DONE TAKING  40  STEPS.
Total reward:  -451.87704099714387
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.16657339292157
DONE TAKING  40  STEPS.
Total reward:  -517.8356080638731
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.947331676962047
DONE TAKING  40  STEPS.
Total reward:  -540.3571244171981
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.035166360100096
DONE TAKING  40  STEPS.
Total reward:  -335.8890855246791
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.242858243053448
DONE TAKING  40  STEPS.
Total reward:  -593.7738679639739
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.572219961753646
DONE TAKING  40  STEPS.
Total reward:  -212.33269534157566
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.21413151523146
DONE TAKING  40  STEPS.
Total reward:  -588.2100298851437
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.35288098606857
DONE TAKING  40  STEPS.
Total reward:  -981.4212728327899
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.73991340674855
DONE TAKING  40  STEPS.
Total reward:  -772.2223309171728
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.175318799131826
DONE TAKING  40  STEPS.
Total reward:  -467.3637159625802
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.97474070368152
DONE TAKING  40  STEPS.
Total reward:  -614.284892470368
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.630657299967453
DONE TAKING  40  STEPS.
Total reward:  -868.5612468800463
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.484956145879508
DONE TAKING  40  STEPS.
Total reward:  219.67213400822556
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.753323407064922
DONE TAKING  40  STEPS.
Total reward:  -685.848058472441
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.572517587178535
DONE TAKING  40  STEPS.
Total reward:  -254.1668842848355
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.307571390535777
DONE TAKING  40  STEPS.
Total reward:  -196.89032721235867
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.342112172270546
DONE TAKING  40  STEPS.
Total reward:  -388.9976322853173
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.209932473282635
DONE TAKING  40  STEPS.
Total reward:  291.1020422808547
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.113128924461797
DONE TAKING  40  STEPS.
Total reward:  -611.9118633181848
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.377286418890854
DONE TAKING  40  STEPS.
Total reward:  -662.3080007714428
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.49011877823868
DONE TAKING  40  STEPS.
Total reward:  -142.380740441323
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.550846885177506
DONE TAKING  40  STEPS.
Total reward:  -576.216850101379
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.785968647439958
DONE TAKING  40  STEPS.
Total reward:  -815.4360218348609
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -12.783561216056686
DONE TAKING  40  STEPS.
Total reward:  -113.14860664205608
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.636192152464183
DONE TAKING  40  STEPS.
Total reward:  -378.9752793619086
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -14.5277360661162
DONE TAKING  40  STEPS.
Total reward:  -285.68716718745134
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.805010927575097
DONE TAKING  40  STEPS.
Total reward:  -740.3128337461486
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.527501613213623
DONE TAKING  40  STEPS.
Total reward:  -504.33591392269403
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.192722196019336
DONE TAKING  40  STEPS.
Total reward:  -830.6487501299763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.232069199406467
DONE TAKING  40  STEPS.
Total reward:  -990.5636839449769
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.859847959775628
DONE TAKING  40  STEPS.
Total reward:  -424.5087836371183
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.02995006954013
DONE TAKING  40  STEPS.
Total reward:  -128.8486202669299
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.432454938477633
DONE TAKING  40  STEPS.
Total reward:  -652.1193482561422
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.91476658012072
DONE TAKING  40  STEPS.
Total reward:  -351.0930496983479
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.076370575760045
DONE TAKING  40  STEPS.
Total reward:  -443.19988332076156
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.786278637982633
DONE TAKING  40  STEPS.
Total reward:  -358.4008456832054
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.160623075652857
DONE TAKING  40  STEPS.
Total reward:  -470.35499962289646
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -25.53729036986702
DONE TAKING  40  STEPS.
Total reward:  -939.6242153785605
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.787393129974024
DONE TAKING  40  STEPS.
Total reward:  -864.6628415454702
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter109.ckpt
Iter: 110
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  110
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  29250
On pol:  57600
Prob shape:  (86850,)

=== Epoch 0 ===
    train loss:  0.4036959467907629
    val rand:  0.31183767318725586
    val onPol:  0.368988037109375

=== Epoch 10 ===
    train loss:  0.14741812346602332
    val rand:  0.18550895154476166
    val onPol:  0.35924755533536273

=== Epoch 20 ===
    train loss:  0.08896495692828703
    val rand:  0.16347891092300415
    val onPol:  0.4003078142801921

=== Epoch 30 ===
    train loss:  0.06506516482438561
    val rand:  0.15811488032341003
    val onPol:  0.425535649061203

=== Epoch 39 ===
    train loss:  0.055303253035044526
    val rand:  0.15370634198188782
    val onPol:  0.43955052892367047
Training duration: 42.60 s

#####################################
performing on-policy MPC rollouts... iter  110
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.76035779221816
DONE TAKING  40  STEPS.
Total reward:  -566.2192694678399
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -16.867086851339966
DONE TAKING  40  STEPS.
Total reward:  -368.738551431003
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.22276770529854
DONE TAKING  40  STEPS.
Total reward:  -588.6510955150832
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.30629853050086
DONE TAKING  40  STEPS.
Total reward:  -538.9251124383455
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.075219146481743
DONE TAKING  40  STEPS.
Total reward:  -829.1691880482267
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -24.96620546097892
DONE TAKING  40  STEPS.
Total reward:  -637.0657057000575
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.112806442099114
DONE TAKING  40  STEPS.
Total reward:  -422.48453474813016
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.89241546620005
DONE TAKING  40  STEPS.
Total reward:  -176.1959613907541
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -19.74041231978507
DONE TAKING  40  STEPS.
Total reward:  -551.4559679876915
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.044539182001987
DONE TAKING  40  STEPS.
Total reward:  -1039.9040292853842
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.674232522675595
DONE TAKING  40  STEPS.
Total reward:  -410.66210437960024
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.29429922124194
DONE TAKING  40  STEPS.
Total reward:  -711.4783443251591
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -19.11917441849608
DONE TAKING  40  STEPS.
Total reward:  -67.92002647018866
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.494182121606304
DONE TAKING  40  STEPS.
Total reward:  -744.9343065409123
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.287364991680295
DONE TAKING  40  STEPS.
Total reward:  -341.08455568500057
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.75244977798569
DONE TAKING  40  STEPS.
Total reward:  -676.8940411045833
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.403160928314502
DONE TAKING  40  STEPS.
Total reward:  -552.6604808004486
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.927840103425913
DONE TAKING  40  STEPS.
Total reward:  -347.3321155696831
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.733426308054053
DONE TAKING  40  STEPS.
Total reward:  -384.7323496012545
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -19.887232227954673
DONE TAKING  40  STEPS.
Total reward:  -239.5664635465804
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.549605645912365
DONE TAKING  40  STEPS.
Total reward:  -564.7499696643038
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.415675561032245
DONE TAKING  40  STEPS.
Total reward:  -830.824629630106
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.732774967013455
DONE TAKING  40  STEPS.
Total reward:  -817.201603544035
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.537564495831163
DONE TAKING  40  STEPS.
Total reward:  -368.78204504147624
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.902915187802574
DONE TAKING  40  STEPS.
Total reward:  -417.9236193373412
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -20.649131023981756
DONE TAKING  40  STEPS.
Total reward:  -729.0439364814781
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.30964793334572
DONE TAKING  40  STEPS.
Total reward:  -969.0825344361261
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -12.28017142149254
DONE TAKING  40  STEPS.
Total reward:  -436.07637153957285
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.70142756353657
DONE TAKING  40  STEPS.
Total reward:  -689.6101638714048
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.745988856015956
DONE TAKING  40  STEPS.
Total reward:  -176.6013371416736
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.535939537410563
DONE TAKING  40  STEPS.
Total reward:  -571.9208348925622
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.360710381032124
DONE TAKING  40  STEPS.
Total reward:  -393.3844960680763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.4395082139718
DONE TAKING  40  STEPS.
Total reward:  -677.5420952028069
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -17.401200956604356
DONE TAKING  40  STEPS.
Total reward:  -326.10869212564756
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.11869945263766
DONE TAKING  40  STEPS.
Total reward:  -210.86338770108247
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.294760700785904
DONE TAKING  40  STEPS.
Total reward:  -807.1363326053302
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.56435790617659
DONE TAKING  40  STEPS.
Total reward:  -543.5471562849339
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -16.601217329197016
DONE TAKING  40  STEPS.
Total reward:  -459.829168119131
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -16.56428222540258
DONE TAKING  40  STEPS.
Total reward:  -515.2547572923963
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.986729362909564
DONE TAKING  40  STEPS.
Total reward:  -439.0296880761363
Time for 1 rollout: 1.23 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter110.ckpt
Iter: 111
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  111
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  29445
On pol:  57600
Prob shape:  (87045,)

=== Epoch 0 ===
    train loss:  0.39890642096014584
    val rand:  0.3085411787033081
    val onPol:  0.35653260350227356

=== Epoch 10 ===
    train loss:  0.14688561523661894
    val rand:  0.1883859932422638
    val onPol:  0.350373496611913

=== Epoch 20 ===
    train loss:  0.08951040256549331
    val rand:  0.1712712049484253
    val onPol:  0.3950236737728119

=== Epoch 30 ===
    train loss:  0.06612049275461365
    val rand:  0.16000254452228546
    val onPol:  0.41955500841140747

=== Epoch 39 ===
    train loss:  0.05614924807758892
    val rand:  0.15433456003665924
    val onPol:  0.4329229990641276
Training duration: 44.73 s

#####################################
performing on-policy MPC rollouts... iter  111
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.25810051218685
DONE TAKING  40  STEPS.
Total reward:  -363.0888949859854
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -12.892206929488168
DONE TAKING  40  STEPS.
Total reward:  -210.07438603163894
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.733388600461087
DONE TAKING  40  STEPS.
Total reward:  -662.8929834414198
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.238517811054862
DONE TAKING  40  STEPS.
Total reward:  -739.4986496989832
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.679659905651206
DONE TAKING  40  STEPS.
Total reward:  -321.7789016830809
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.39566551904449
DONE TAKING  40  STEPS.
Total reward:  -937.1154846682813
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.54454641377894
DONE TAKING  40  STEPS.
Total reward:  -572.9701445041188
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.827823781519676
DONE TAKING  40  STEPS.
Total reward:  -785.0737543259071
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.34413496511598
DONE TAKING  40  STEPS.
Total reward:  -83.79557597057692
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -13.44871346664219
DONE TAKING  40  STEPS.
Total reward:  -331.1462276940814
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.849986058418235
DONE TAKING  40  STEPS.
Total reward:  -334.36486794573665
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -25.562266322509014
DONE TAKING  40  STEPS.
Total reward:  -684.4572500163373
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.075724301251846
DONE TAKING  40  STEPS.
Total reward:  -564.8933668513884
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.80539667904135
DONE TAKING  40  STEPS.
Total reward:  -589.2695609005642
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.67238671670648
DONE TAKING  40  STEPS.
Total reward:  -865.8613633207422
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.81779898851379
DONE TAKING  40  STEPS.
Total reward:  -450.781528633547
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.519738116535255
DONE TAKING  40  STEPS.
Total reward:  -652.7786072452845
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -11.061934257005653
DONE TAKING  40  STEPS.
Total reward:  87.50377533915623
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.209128702641557
DONE TAKING  40  STEPS.
Total reward:  -631.5917151304772
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.04840558809715
DONE TAKING  40  STEPS.
Total reward:  -459.61424828506614
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.40003201439381
DONE TAKING  40  STEPS.
Total reward:  -388.84200728337
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.14873119842693
DONE TAKING  40  STEPS.
Total reward:  -466.97248807031923
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.53433612345939
DONE TAKING  40  STEPS.
Total reward:  -416.8991804257255
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.384478180810664
DONE TAKING  40  STEPS.
Total reward:  -633.6017961838203
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.111366331496665
DONE TAKING  40  STEPS.
Total reward:  -409.0409949953008
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -16.975576486923863
DONE TAKING  40  STEPS.
Total reward:  -415.41056061563984
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -10.116346993132632
DONE TAKING  40  STEPS.
Total reward:  -289.95086886829125
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.91288787849458
DONE TAKING  40  STEPS.
Total reward:  -712.3200388671391
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.908003667320507
DONE TAKING  40  STEPS.
Total reward:  -700.1291795151395
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -31.116892573573367
DONE TAKING  40  STEPS.
Total reward:  -80.30389668237137
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -11.455456687163508
DONE TAKING  40  STEPS.
Total reward:  -415.72339373302134
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.449170487798074
DONE TAKING  40  STEPS.
Total reward:  -585.0647999807999
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.47046766699462
DONE TAKING  40  STEPS.
Total reward:  -848.9259810109954
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.611944501499316
DONE TAKING  40  STEPS.
Total reward:  -920.1464238842223
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.953725517559771
DONE TAKING  40  STEPS.
Total reward:  -413.1181756848064
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.15787716412269
DONE TAKING  40  STEPS.
Total reward:  -501.56344769175723
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.21025292188798
DONE TAKING  40  STEPS.
Total reward:  -332.5558100146958
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.03003679553697
DONE TAKING  40  STEPS.
Total reward:  -657.5465078699209
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -12.472843412846938
DONE TAKING  40  STEPS.
Total reward:  -810.9939633872981
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -13.389462384807436
DONE TAKING  40  STEPS.
Total reward:  -454.4383896634874
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter111.ckpt
Iter: 112
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  112
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  29640
On pol:  57600
Prob shape:  (87240,)

=== Epoch 0 ===
    train loss:  0.4000028292922413
    val rand:  0.3056626319885254
    val onPol:  0.36238325635592145

=== Epoch 10 ===
    train loss:  0.14542609593447517
    val rand:  0.18785226345062256
    val onPol:  0.3544422189394633

=== Epoch 20 ===
    train loss:  0.08705554205705138
    val rand:  0.1683599054813385
    val onPol:  0.39643268783887226

=== Epoch 30 ===
    train loss:  0.06552889068775317
    val rand:  0.15657466650009155
    val onPol:  0.42098769545555115

=== Epoch 39 ===
    train loss:  0.056197844927801804
    val rand:  0.15759345889091492
    val onPol:  0.4374611477057139
Training duration: 42.73 s

#####################################
performing on-policy MPC rollouts... iter  112
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.386794619688988
DONE TAKING  40  STEPS.
Total reward:  -519.1091705855404
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.67819217285455
DONE TAKING  40  STEPS.
Total reward:  -113.9760648090531
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.545563517404332
DONE TAKING  40  STEPS.
Total reward:  -450.5688643930309
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.510583071332732
DONE TAKING  40  STEPS.
Total reward:  -957.6672025792412
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.180106192286125
DONE TAKING  40  STEPS.
Total reward:  -682.4322133228787
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.456872911632345
DONE TAKING  40  STEPS.
Total reward:  -667.0449087482264
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.969223839702984
DONE TAKING  40  STEPS.
Total reward:  -882.5031070977612
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.787765969216068
DONE TAKING  40  STEPS.
Total reward:  -561.0617373308331
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.500670112494674
DONE TAKING  40  STEPS.
Total reward:  -493.082880399733
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -12.859205369174383
DONE TAKING  40  STEPS.
Total reward:  -396.1380216392012
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.74524641501225
DONE TAKING  40  STEPS.
Total reward:  -701.747240811092
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.413569166004805
DONE TAKING  40  STEPS.
Total reward:  -468.1690805775454
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.034423497552755
DONE TAKING  40  STEPS.
Total reward:  -299.1517647082563
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.084303248579836
DONE TAKING  40  STEPS.
Total reward:  -133.49067301734684
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.29487269346849
DONE TAKING  40  STEPS.
Total reward:  -681.1427249659434
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -18.575366821011553
DONE TAKING  40  STEPS.
Total reward:  -614.2874673360104
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.030117706026832
DONE TAKING  40  STEPS.
Total reward:  -668.6471977607705
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -31.381610248148554
DONE TAKING  40  STEPS.
Total reward:  -877.2849836484917
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.485799456072904
DONE TAKING  40  STEPS.
Total reward:  -310.42037082085795
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -10.63418974056253
DONE TAKING  40  STEPS.
Total reward:  -307.6594394101476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.039469104490692
DONE TAKING  40  STEPS.
Total reward:  -592.8134714689311
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -20.76792176417949
DONE TAKING  40  STEPS.
Total reward:  -713.2003633347866
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.038486624166264
DONE TAKING  40  STEPS.
Total reward:  -684.6897567405699
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -31.35090082305453
DONE TAKING  40  STEPS.
Total reward:  -842.311911485324
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.16514751972147
DONE TAKING  40  STEPS.
Total reward:  -784.4416381130451
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.362907565530236
DONE TAKING  40  STEPS.
Total reward:  -433.3715725446025
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.986037079004053
DONE TAKING  40  STEPS.
Total reward:  -519.6813199988023
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -17.554734879862718
DONE TAKING  40  STEPS.
Total reward:  -103.79631459798817
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.690084280246474
DONE TAKING  40  STEPS.
Total reward:  -551.8252637646071
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.33469699971557
DONE TAKING  40  STEPS.
Total reward:  -558.5187138756884
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.788407782421743
DONE TAKING  40  STEPS.
Total reward:  -777.0740118423255
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.957737220022283
DONE TAKING  40  STEPS.
Total reward:  -242.76517513896206
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.995555578732905
DONE TAKING  40  STEPS.
Total reward:  -613.9552664211967
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.329594994479663
DONE TAKING  40  STEPS.
Total reward:  -987.6102215497798
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.80751545184289
DONE TAKING  40  STEPS.
Total reward:  -570.9637793451552
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.315475701854044
DONE TAKING  40  STEPS.
Total reward:  -787.8782841391031
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.608032221281974
DONE TAKING  40  STEPS.
Total reward:  -799.8958943123573
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.246206233068207
DONE TAKING  40  STEPS.
Total reward:  -416.1761570148505
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.397650167818362
DONE TAKING  40  STEPS.
Total reward:  -890.4808546839841
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.185456670202345
DONE TAKING  40  STEPS.
Total reward:  -660.7969788114808
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter112.ckpt
Iter: 113
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  113
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  29835
On pol:  57600
Prob shape:  (87435,)

=== Epoch 0 ===
    train loss:  0.4028534266878577
    val rand:  0.30312711000442505
    val onPol:  0.3576729893684387

=== Epoch 10 ===
    train loss:  0.14897804198896183
    val rand:  0.18642988801002502
    val onPol:  0.3500225941340129

=== Epoch 20 ===
    train loss:  0.089829843359835
    val rand:  0.1701442003250122
    val onPol:  0.3940127193927765

=== Epoch 30 ===
    train loss:  0.06789747257443035
    val rand:  0.15901628136634827
    val onPol:  0.4201990067958832

=== Epoch 39 ===
    train loss:  0.05685779513681636
    val rand:  0.15710249543190002
    val onPol:  0.43473894397417706
Training duration: 45.04 s

#####################################
performing on-policy MPC rollouts... iter  113
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.942913323901635
DONE TAKING  40  STEPS.
Total reward:  -233.39999280916555
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.41017796441979
DONE TAKING  40  STEPS.
Total reward:  -687.4048965108536
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.78242689636965
DONE TAKING  40  STEPS.
Total reward:  -1088.244117233329
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.731642903147055
DONE TAKING  40  STEPS.
Total reward:  -577.0134595653421
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.265315544817305
DONE TAKING  40  STEPS.
Total reward:  -768.4232452967411
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.591103795491318
DONE TAKING  40  STEPS.
Total reward:  -546.7392017079902
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.664460330451547
DONE TAKING  40  STEPS.
Total reward:  -871.0048063534314
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.769312180365233
DONE TAKING  40  STEPS.
Total reward:  -326.6677899754406
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.28070657191517
DONE TAKING  40  STEPS.
Total reward:  -964.8390828339674
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.714439663175117
DONE TAKING  40  STEPS.
Total reward:  -631.7486920761461
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.37386548066052
DONE TAKING  40  STEPS.
Total reward:  -333.35038690769863
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.463482568950916
DONE TAKING  40  STEPS.
Total reward:  -828.123650754585
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.104794743067856
DONE TAKING  40  STEPS.
Total reward:  -952.5139453708508
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.25518174145063
DONE TAKING  40  STEPS.
Total reward:  -589.8252661678098
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.55351105377276
DONE TAKING  40  STEPS.
Total reward:  -788.5012455767625
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.054596608283603
DONE TAKING  40  STEPS.
Total reward:  -926.4022046237527
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.05356995173327
DONE TAKING  40  STEPS.
Total reward:  -547.357946645376
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -10.423380920436252
DONE TAKING  40  STEPS.
Total reward:  -122.1591483517638
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.93974355694099
DONE TAKING  40  STEPS.
Total reward:  -606.5631349307686
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.135143930953703
DONE TAKING  40  STEPS.
Total reward:  -618.9084403393816
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.98894765784766
DONE TAKING  40  STEPS.
Total reward:  -227.94750953655358
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.333750424308533
DONE TAKING  40  STEPS.
Total reward:  -676.0316381358206
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.27138409896967
DONE TAKING  40  STEPS.
Total reward:  -459.4980318588428
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.02377178660338
DONE TAKING  40  STEPS.
Total reward:  -659.7039372025014
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.567099311114575
DONE TAKING  40  STEPS.
Total reward:  -223.3014569496097
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -14.628336874518723
DONE TAKING  40  STEPS.
Total reward:  -419.23295654741094
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.965660071415748
DONE TAKING  40  STEPS.
Total reward:  -847.5353826890342
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.51345343042674
DONE TAKING  40  STEPS.
Total reward:  -392.64313371614094
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.520922962802173
DONE TAKING  40  STEPS.
Total reward:  -255.77099319332905
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.68898926646778
DONE TAKING  40  STEPS.
Total reward:  -1040.5296812747295
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.33579552571236
DONE TAKING  40  STEPS.
Total reward:  -916.7725226224886
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -10.51786132974421
DONE TAKING  40  STEPS.
Total reward:  -321.1236341171398
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -27.58725138257263
DONE TAKING  40  STEPS.
Total reward:  -749.8623631625987
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.602051557534203
DONE TAKING  40  STEPS.
Total reward:  -510.5705324376926
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.250052457965886
DONE TAKING  40  STEPS.
Total reward:  -678.809666099418
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.66940135116958
DONE TAKING  40  STEPS.
Total reward:  -644.5380841013844
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.973503055594307
DONE TAKING  40  STEPS.
Total reward:  -475.3139489341024
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.734035136468915
DONE TAKING  40  STEPS.
Total reward:  -725.2861296773657
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -10.535054536920285
DONE TAKING  40  STEPS.
Total reward:  17.81957297746278
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.985164512986117
DONE TAKING  40  STEPS.
Total reward:  -528.7418172507105
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter113.ckpt
Iter: 114
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  114
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  30030
On pol:  57600
Prob shape:  (87630,)

=== Epoch 0 ===
    train loss:  0.399905609631399
    val rand:  0.30443495512008667
    val onPol:  0.36036281784375507

=== Epoch 10 ===
    train loss:  0.14504300118886937
    val rand:  0.18854592740535736
    val onPol:  0.35457589228947956

=== Epoch 20 ===
    train loss:  0.08709418860792417
    val rand:  0.1690109223127365
    val onPol:  0.3971240719159444

=== Epoch 30 ===
    train loss:  0.06606067074408307
    val rand:  0.1610356569290161
    val onPol:  0.4214353859424591

=== Epoch 39 ===
    train loss:  0.055483062212404455
    val rand:  0.15274062752723694
    val onPol:  0.43401220440864563
Training duration: 44.82 s

#####################################
performing on-policy MPC rollouts... iter  114
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.617597981107963
DONE TAKING  40  STEPS.
Total reward:  -511.1460755999426
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -14.993453970917033
DONE TAKING  40  STEPS.
Total reward:  -346.8431619718791
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.850000030292673
DONE TAKING  40  STEPS.
Total reward:  -742.5510572795605
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.190253032033215
DONE TAKING  40  STEPS.
Total reward:  -331.91325700743715
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -20.46594211383017
DONE TAKING  40  STEPS.
Total reward:  -468.4790172036486
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.163505690550263
DONE TAKING  40  STEPS.
Total reward:  -379.8758202149592
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -20.632536593251125
DONE TAKING  40  STEPS.
Total reward:  -236.37880387936033
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.29478919761197
DONE TAKING  40  STEPS.
Total reward:  -440.0970002091579
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.535317222383085
DONE TAKING  40  STEPS.
Total reward:  -583.350212391028
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.331959237036406
DONE TAKING  40  STEPS.
Total reward:  -459.98105018033004
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.162235665820848
DONE TAKING  40  STEPS.
Total reward:  -604.4163595488136
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.519006499917356
DONE TAKING  40  STEPS.
Total reward:  -269.8413449894327
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.655726295099967
DONE TAKING  40  STEPS.
Total reward:  -890.8016107330095
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.543629714366425
DONE TAKING  40  STEPS.
Total reward:  -86.12692533106434
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.039601360638535
DONE TAKING  40  STEPS.
Total reward:  -491.9352453536855
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.329634544605934
DONE TAKING  40  STEPS.
Total reward:  -856.649865917491
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.816927873505207
DONE TAKING  40  STEPS.
Total reward:  -496.70748461302935
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.45071452651222
DONE TAKING  40  STEPS.
Total reward:  -532.5096682274323
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -22.685105804439935
DONE TAKING  40  STEPS.
Total reward:  -530.582470427059
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.226337013089463
DONE TAKING  40  STEPS.
Total reward:  -563.513114409517
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.069629692730555
DONE TAKING  40  STEPS.
Total reward:  -521.9438781007731
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -14.060250583131742
DONE TAKING  40  STEPS.
Total reward:  -505.28537277559855
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.16949084498187
DONE TAKING  40  STEPS.
Total reward:  -705.6707010053437
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -11.719264675158968
DONE TAKING  40  STEPS.
Total reward:  -68.10574424226029
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -16.114289641461422
DONE TAKING  40  STEPS.
Total reward:  -379.22189332105165
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -11.38250347386835
DONE TAKING  40  STEPS.
Total reward:  -425.8741079061074
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -14.389703007370011
DONE TAKING  40  STEPS.
Total reward:  -487.51440375279475
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.98953982249686
DONE TAKING  40  STEPS.
Total reward:  -1068.5995046013725
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.936909226611153
DONE TAKING  40  STEPS.
Total reward:  -576.4315281938455
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.224215745245644
DONE TAKING  40  STEPS.
Total reward:  -827.7663765703397
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.817441708643695
DONE TAKING  40  STEPS.
Total reward:  -662.9403963304952
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -10.79040147191276
DONE TAKING  40  STEPS.
Total reward:  -415.0082440944303
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.619915237561376
DONE TAKING  40  STEPS.
Total reward:  173.21146955733872
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.200293463428956
DONE TAKING  40  STEPS.
Total reward:  -520.7746401403199
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -12.807712527433178
DONE TAKING  40  STEPS.
Total reward:  -437.16685012606206
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.66314296775498
DONE TAKING  40  STEPS.
Total reward:  -725.2889953613491
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.195636563846268
DONE TAKING  40  STEPS.
Total reward:  -466.5658301268707
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.6944061049238
DONE TAKING  40  STEPS.
Total reward:  -935.4556019024071
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.287722943827706
DONE TAKING  40  STEPS.
Total reward:  -602.8562316399773
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.3111777183042
DONE TAKING  40  STEPS.
Total reward:  -669.3960948408206
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter114.ckpt
Iter: 115
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  115
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  30225
On pol:  57600
Prob shape:  (87825,)

=== Epoch 0 ===
    train loss:  0.39969011426669115
    val rand:  0.2972739338874817
    val onPol:  0.3579686979452769

=== Epoch 10 ===
    train loss:  0.1457247335834113
    val rand:  0.18455104529857635
    val onPol:  0.35239943861961365

=== Epoch 20 ===
    train loss:  0.08755310585624293
    val rand:  0.17332866787910461
    val onPol:  0.396978239218394

=== Epoch 30 ===
    train loss:  0.06596326967428999
    val rand:  0.15464657545089722
    val onPol:  0.41803298393885296

=== Epoch 39 ===
    train loss:  0.05540286331323155
    val rand:  0.15487968921661377
    val onPol:  0.43252383669217426
Training duration: 45.53 s

#####################################
performing on-policy MPC rollouts... iter  115
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.418048394324614
DONE TAKING  40  STEPS.
Total reward:  -750.0325346136643
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.40251021474581
DONE TAKING  40  STEPS.
Total reward:  -435.55123207523815
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.539473284446945
DONE TAKING  40  STEPS.
Total reward:  -917.259434046645
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -19.55630516362038
DONE TAKING  40  STEPS.
Total reward:  -488.7092452131742
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.132110892632667
DONE TAKING  40  STEPS.
Total reward:  -680.4842230795468
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.734703161394272
DONE TAKING  40  STEPS.
Total reward:  -666.2736821018592
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.004879755918658
DONE TAKING  40  STEPS.
Total reward:  28.86980425207091
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -11.664125487840348
DONE TAKING  40  STEPS.
Total reward:  -292.9068659778284
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.036589582159515
DONE TAKING  40  STEPS.
Total reward:  -377.5076762407069
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.848570383950065
DONE TAKING  40  STEPS.
Total reward:  -607.6744316619388
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.21205334927722
DONE TAKING  40  STEPS.
Total reward:  -305.0171620024563
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.257932981858502
DONE TAKING  40  STEPS.
Total reward:  -143.45665900994356
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.568853008157227
DONE TAKING  40  STEPS.
Total reward:  -1082.4840991582976
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -21.31802567570963
DONE TAKING  40  STEPS.
Total reward:  -509.20284463272003
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.135456140597352
DONE TAKING  40  STEPS.
Total reward:  -880.5664725621167
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.305397276709144
DONE TAKING  40  STEPS.
Total reward:  -744.5312784047453
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.145134292171996
DONE TAKING  40  STEPS.
Total reward:  -745.5283579577447
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.47360646899493
DONE TAKING  40  STEPS.
Total reward:  -595.9522109799008
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.68940374375455
DONE TAKING  40  STEPS.
Total reward:  -362.4396218846738
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -14.16042122613877
DONE TAKING  40  STEPS.
Total reward:  -439.0465685930366
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.778730550242166
DONE TAKING  40  STEPS.
Total reward:  -556.292710205078
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.261233971755615
DONE TAKING  40  STEPS.
Total reward:  -827.14931506005
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.139533739265303
DONE TAKING  40  STEPS.
Total reward:  -668.0344232758964
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -15.264708282612954
DONE TAKING  40  STEPS.
Total reward:  -324.6882027405855
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.877789566616066
DONE TAKING  40  STEPS.
Total reward:  -407.9431008174244
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.322210335542124
DONE TAKING  40  STEPS.
Total reward:  -541.754974636608
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.708179836216996
DONE TAKING  40  STEPS.
Total reward:  -719.0902641681903
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.878274239752137
DONE TAKING  40  STEPS.
Total reward:  -410.79822833400794
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.06938750636334
DONE TAKING  40  STEPS.
Total reward:  -779.0729492995198
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.854427942145577
DONE TAKING  40  STEPS.
Total reward:  -338.59852076807067
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.905983104475595
DONE TAKING  40  STEPS.
Total reward:  -299.2846484423839
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.156789610958825
DONE TAKING  40  STEPS.
Total reward:  -355.5892849995961
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.66536947556015
DONE TAKING  40  STEPS.
Total reward:  -657.3164810260677
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.034364055681465
DONE TAKING  40  STEPS.
Total reward:  -723.6213415522977
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.826583423772092
DONE TAKING  40  STEPS.
Total reward:  -817.2693771814551
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -13.1439520310093
DONE TAKING  40  STEPS.
Total reward:  -319.698055981643
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.380745285312702
DONE TAKING  40  STEPS.
Total reward:  -881.8145496322022
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.55836148110743
DONE TAKING  40  STEPS.
Total reward:  -476.2168447511534
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.905762918938443
DONE TAKING  40  STEPS.
Total reward:  -147.00663955874543
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -11.671042736382525
DONE TAKING  40  STEPS.
Total reward:  -264.6549839827815
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter115.ckpt
Iter: 116
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  116
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  30420
On pol:  57600
Prob shape:  (88020,)

=== Epoch 0 ===
    train loss:  0.4013042580663112
    val rand:  0.29689764976501465
    val onPol:  0.3601568639278412

=== Epoch 10 ===
    train loss:  0.14694983316095253
    val rand:  0.18917064368724823
    val onPol:  0.34849541385968524

=== Epoch 20 ===
    train loss:  0.08961238694644114
    val rand:  0.17034147679805756
    val onPol:  0.3920447826385498

=== Epoch 30 ===
    train loss:  0.06784644367837767
    val rand:  0.1599101722240448
    val onPol:  0.4176072378953298

=== Epoch 39 ===
    train loss:  0.056688561774136725
    val rand:  0.16127707064151764
    val onPol:  0.4310167928536733
Training duration: 44.65 s

#####################################
performing on-policy MPC rollouts... iter  116
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -10.691538537899367
DONE TAKING  40  STEPS.
Total reward:  -332.57164232631123
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.353890952429254
DONE TAKING  40  STEPS.
Total reward:  -554.336355079408
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.645263386377595
DONE TAKING  40  STEPS.
Total reward:  -330.1675429930051
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -15.557042780404629
DONE TAKING  40  STEPS.
Total reward:  -515.5722859191407
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -13.26884666569776
DONE TAKING  40  STEPS.
Total reward:  -283.30472701026923
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.551732031975867
DONE TAKING  40  STEPS.
Total reward:  -204.47943928095359
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.78631864093694
DONE TAKING  40  STEPS.
Total reward:  -340.481680425973
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.91300435027496
DONE TAKING  40  STEPS.
Total reward:  -561.2320445426965
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.118983876433177
DONE TAKING  40  STEPS.
Total reward:  -402.921305254884
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -13.894480644930116
DONE TAKING  40  STEPS.
Total reward:  -468.3141669628083
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.691254561272254
DONE TAKING  40  STEPS.
Total reward:  -264.6722245962089
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.968373166546813
DONE TAKING  40  STEPS.
Total reward:  -271.28649354549157
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.64892974550008
DONE TAKING  40  STEPS.
Total reward:  -486.66191817672905
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.525782272304383
DONE TAKING  40  STEPS.
Total reward:  -394.5437727737249
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.480478802857444
DONE TAKING  40  STEPS.
Total reward:  -898.0407190041792
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.61528490619162
DONE TAKING  40  STEPS.
Total reward:  -432.7938429057455
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -11.943416075878599
DONE TAKING  40  STEPS.
Total reward:  -70.22636409492321
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.774030110023013
DONE TAKING  40  STEPS.
Total reward:  -480.23175694131885
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.61075176921291
DONE TAKING  40  STEPS.
Total reward:  -905.4724756611101
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.521682004989291
DONE TAKING  40  STEPS.
Total reward:  290.15556763716484
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.511381241329094
DONE TAKING  40  STEPS.
Total reward:  -496.63884918583506
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.71103935498151
DONE TAKING  40  STEPS.
Total reward:  -642.0899577157993
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.28965069887233
DONE TAKING  40  STEPS.
Total reward:  -811.5932242128398
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.635695675078367
DONE TAKING  40  STEPS.
Total reward:  -785.2333527305753
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.28527882778203
DONE TAKING  40  STEPS.
Total reward:  -988.2510740108626
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.259921511280687
DONE TAKING  40  STEPS.
Total reward:  92.87056345269033
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.62110814134195
DONE TAKING  40  STEPS.
Total reward:  -703.0571193470228
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.918257180911404
DONE TAKING  40  STEPS.
Total reward:  -580.9042613777899
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -18.117310900882956
DONE TAKING  40  STEPS.
Total reward:  453.4518145450966
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.263412292244443
DONE TAKING  40  STEPS.
Total reward:  -790.5263537527596
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.74512154393566
DONE TAKING  40  STEPS.
Total reward:  102.68155775851665
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.88407680064095
DONE TAKING  40  STEPS.
Total reward:  -233.3454621145432
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.938602167960696
DONE TAKING  40  STEPS.
Total reward:  -668.6305205136055
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.32260575246309
DONE TAKING  40  STEPS.
Total reward:  -140.83455039754284
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.114356498023128
DONE TAKING  40  STEPS.
Total reward:  -149.5525948084332
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.578282962798966
DONE TAKING  40  STEPS.
Total reward:  -595.9248439094248
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.96752213691355
DONE TAKING  40  STEPS.
Total reward:  -352.5200772123744
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -11.236488055672426
DONE TAKING  40  STEPS.
Total reward:  -169.5491214022549
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.591081054826713
DONE TAKING  40  STEPS.
Total reward:  -343.2461059269463
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.695005988165555
DONE TAKING  40  STEPS.
Total reward:  -590.8122339910598
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter116.ckpt
Iter: 117
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  117
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  30615
On pol:  57600
Prob shape:  (88215,)

=== Epoch 0 ===
    train loss:  0.39781768741302714
    val rand:  0.2890298068523407
    val onPol:  0.3716319004694621

=== Epoch 10 ===
    train loss:  0.1436196122924949
    val rand:  0.1866941750049591
    val onPol:  0.3619583745797475

=== Epoch 20 ===
    train loss:  0.08732727564178235
    val rand:  0.1676899641752243
    val onPol:  0.40799235304196674

=== Epoch 30 ===
    train loss:  0.06594880525196015
    val rand:  0.16142050921916962
    val onPol:  0.43460604548454285

=== Epoch 39 ===
    train loss:  0.05470531672066034
    val rand:  0.15590156614780426
    val onPol:  0.4488060077031453
Training duration: 44.44 s

#####################################
performing on-policy MPC rollouts... iter  117
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.947524873342026
DONE TAKING  40  STEPS.
Total reward:  -604.9646121623452
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.346790275481958
DONE TAKING  40  STEPS.
Total reward:  -746.5352543333983
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.78318108862902
DONE TAKING  40  STEPS.
Total reward:  -98.5575219689344
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.069589202944265
DONE TAKING  40  STEPS.
Total reward:  -868.2701253667346
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -20.916624665203535
DONE TAKING  40  STEPS.
Total reward:  -130.69871077177226
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.55160685352996
DONE TAKING  40  STEPS.
Total reward:  -657.7805469797092
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -20.286308574293543
DONE TAKING  40  STEPS.
Total reward:  -429.56038135194314
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -20.20023145424019
DONE TAKING  40  STEPS.
Total reward:  -694.1874976599069
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.731227195030577
DONE TAKING  40  STEPS.
Total reward:  -546.7575573511109
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -13.751995177285599
DONE TAKING  40  STEPS.
Total reward:  -259.595458766023
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.944578180838493
DONE TAKING  40  STEPS.
Total reward:  -44.99707662453534
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -31.25989625987849
DONE TAKING  40  STEPS.
Total reward:  -489.6309021030212
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.507489982419223
DONE TAKING  40  STEPS.
Total reward:  -615.6300512730746
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.589875521245393
DONE TAKING  40  STEPS.
Total reward:  -76.0148249514767
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.53276315932432
DONE TAKING  40  STEPS.
Total reward:  -437.5570040425946
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.05056663410978
DONE TAKING  40  STEPS.
Total reward:  -138.18963349481584
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -17.432503553090992
DONE TAKING  40  STEPS.
Total reward:  -561.9788229468944
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.919288728187407
DONE TAKING  40  STEPS.
Total reward:  -1059.571029196153
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.138939860952224
DONE TAKING  40  STEPS.
Total reward:  -641.578551581325
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.243297489859444
DONE TAKING  40  STEPS.
Total reward:  -588.50435241719
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.95754540869026
DONE TAKING  40  STEPS.
Total reward:  -433.4474113696284
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.680635287891015
DONE TAKING  40  STEPS.
Total reward:  -394.51296033647594
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -31.016132496991492
DONE TAKING  40  STEPS.
Total reward:  -831.6226820022607
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -15.088336594961229
DONE TAKING  40  STEPS.
Total reward:  -396.4994370779754
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.590814009004635
DONE TAKING  40  STEPS.
Total reward:  -798.6823780487986
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -31.357797494765517
DONE TAKING  40  STEPS.
Total reward:  -891.5521961712875
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -31.062049122254738
DONE TAKING  40  STEPS.
Total reward:  -782.454321238158
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -12.702888505711098
DONE TAKING  40  STEPS.
Total reward:  -448.7210367374662
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.299848554084015
DONE TAKING  40  STEPS.
Total reward:  -465.80997343191524
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -12.178264534644715
DONE TAKING  40  STEPS.
Total reward:  -408.0594219091082
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.472324410911035
DONE TAKING  40  STEPS.
Total reward:  -395.289352823948
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.06880249017139
DONE TAKING  40  STEPS.
Total reward:  -718.0443097321071
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.738498177319848
DONE TAKING  40  STEPS.
Total reward:  -592.8858644163568
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.421540375153057
DONE TAKING  40  STEPS.
Total reward:  -891.3533655511342
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.415798133471753
DONE TAKING  40  STEPS.
Total reward:  -142.31477052720365
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.32226033915925
DONE TAKING  40  STEPS.
Total reward:  -523.3719272139389
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.521962011877267
DONE TAKING  40  STEPS.
Total reward:  -701.1257327100259
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -10.264586011818512
DONE TAKING  40  STEPS.
Total reward:  -217.11009212473854
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.572507543481468
DONE TAKING  40  STEPS.
Total reward:  -399.6339439497346
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.360635425704512
DONE TAKING  40  STEPS.
Total reward:  -445.39460471053906
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter117.ckpt
Iter: 118
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  118
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  30810
On pol:  57600
Prob shape:  (88410,)

=== Epoch 0 ===
    train loss:  0.3947972454303919
    val rand:  0.29660844802856445
    val onPol:  0.37486488620440167

=== Epoch 10 ===
    train loss:  0.14391136351366376
    val rand:  0.18199078738689423
    val onPol:  0.37206703424453735

=== Epoch 20 ===
    train loss:  0.0862005751060192
    val rand:  0.1630430817604065
    val onPol:  0.417545090119044

=== Epoch 30 ===
    train loss:  0.0642056487024177
    val rand:  0.15519976615905762
    val onPol:  0.44118601083755493

=== Epoch 39 ===
    train loss:  0.05434779082100059
    val rand:  0.15195462107658386
    val onPol:  0.45502756039301556
Training duration: 22.26 s

#####################################
performing on-policy MPC rollouts... iter  118
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -15.34284245423192
DONE TAKING  40  STEPS.
Total reward:  -209.69453530391092
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.769225434276734
DONE TAKING  40  STEPS.
Total reward:  -601.3842289294264
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -16.141292245722635
DONE TAKING  40  STEPS.
Total reward:  -435.2019914089601
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.79485606784973
DONE TAKING  40  STEPS.
Total reward:  -495.1408473683371
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.05305315762014
DONE TAKING  40  STEPS.
Total reward:  -192.33680019041725
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.624807183168066
DONE TAKING  40  STEPS.
Total reward:  -509.4878594340388
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.898124299915764
DONE TAKING  40  STEPS.
Total reward:  -506.8998318639098
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.327292737760406
DONE TAKING  40  STEPS.
Total reward:  -363.69170519821023
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -14.775255674961942
DONE TAKING  40  STEPS.
Total reward:  -404.72748971904764
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.165071101769257
DONE TAKING  40  STEPS.
Total reward:  -411.3198853054075
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.693917990712045
DONE TAKING  40  STEPS.
Total reward:  -936.1016051667583
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -31.0565015251467
DONE TAKING  40  STEPS.
Total reward:  -739.0547062799427
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -31.001645782594125
DONE TAKING  40  STEPS.
Total reward:  -532.4507393665078
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.143895661479235
DONE TAKING  40  STEPS.
Total reward:  -104.37444101643544
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.016679637357804
DONE TAKING  40  STEPS.
Total reward:  -840.8505298547609
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.178904072330134
DONE TAKING  40  STEPS.
Total reward:  -471.3593220668508
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.941288328161413
DONE TAKING  40  STEPS.
Total reward:  -341.36541328500124
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.08440740647013
DONE TAKING  40  STEPS.
Total reward:  -1009.065553429968
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.10775270206431
DONE TAKING  40  STEPS.
Total reward:  -296.56565936670876
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -15.957155722888892
DONE TAKING  40  STEPS.
Total reward:  -396.0774667401967
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.070005419898813
DONE TAKING  40  STEPS.
Total reward:  -554.4624924683573
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.356896117703464
DONE TAKING  40  STEPS.
Total reward:  -563.9346413482015
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.812536492823234
DONE TAKING  40  STEPS.
Total reward:  -1129.2366651616246
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.07740451011906
DONE TAKING  40  STEPS.
Total reward:  -486.3066027830331
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.84215056051868
DONE TAKING  40  STEPS.
Total reward:  -402.6871657605152
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.621531422049564
DONE TAKING  40  STEPS.
Total reward:  -773.4612079179419
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -14.65820751150163
DONE TAKING  40  STEPS.
Total reward:  -368.9836435654689
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.489913032894712
DONE TAKING  40  STEPS.
Total reward:  -736.2591674616156
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.44927077810241
DONE TAKING  40  STEPS.
Total reward:  -787.5334345587652
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.0989599587298
DONE TAKING  40  STEPS.
Total reward:  -760.8487610182982
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.895704368605905
DONE TAKING  40  STEPS.
Total reward:  -696.0918232325108
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.400698125403892
DONE TAKING  40  STEPS.
Total reward:  -622.235856996067
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.26910256867214
DONE TAKING  40  STEPS.
Total reward:  -900.6764765600266
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.010783883375478
DONE TAKING  40  STEPS.
Total reward:  153.07113691376927
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.56055908762702
DONE TAKING  40  STEPS.
Total reward:  -846.5963604427144
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.386811529284142
DONE TAKING  40  STEPS.
Total reward:  -74.49785199808461
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -15.675506205977836
DONE TAKING  40  STEPS.
Total reward:  -322.0908591061972
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.004442188734995
DONE TAKING  40  STEPS.
Total reward:  -922.0555858677187
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.8755145159561
DONE TAKING  40  STEPS.
Total reward:  -1100.0642078347723
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.511542787606958
DONE TAKING  40  STEPS.
Total reward:  -327.03032197971146
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter118.ckpt
Iter: 119
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  119
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31005
On pol:  57600
Prob shape:  (88605,)

=== Epoch 0 ===
    train loss:  0.39696391348893934
    val rand:  0.2911462187767029
    val onPol:  0.37443018953005475

=== Epoch 10 ===
    train loss:  0.1425683258069044
    val rand:  0.18387427926063538
    val onPol:  0.3652738432089488

=== Epoch 20 ===
    train loss:  0.08533918560412578
    val rand:  0.16600333154201508
    val onPol:  0.41265563170115155

=== Epoch 30 ===
    train loss:  0.06441283684676093
    val rand:  0.15708957612514496
    val onPol:  0.4346888065338135

=== Epoch 39 ===
    train loss:  0.05458445002922433
    val rand:  0.15481452643871307
    val onPol:  0.44928833842277527
Training duration: 44.84 s

#####################################
performing on-policy MPC rollouts... iter  119
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.457252919463194
DONE TAKING  40  STEPS.
Total reward:  -350.9816540941509
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -18.66051928706939
DONE TAKING  40  STEPS.
Total reward:  -487.34737955584086
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.71144384013726
DONE TAKING  40  STEPS.
Total reward:  -648.8553840589028
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -13.776011086205626
DONE TAKING  40  STEPS.
Total reward:  -518.2662539177246
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.766171502617063
DONE TAKING  40  STEPS.
Total reward:  -818.5718668776191
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.369616501127794
DONE TAKING  40  STEPS.
Total reward:  -1028.4424297352452
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.481733691531897
DONE TAKING  40  STEPS.
Total reward:  -652.8219814220604
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.0596286748776
DONE TAKING  40  STEPS.
Total reward:  -275.1157909750084
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.198374126480857
DONE TAKING  40  STEPS.
Total reward:  -416.4071725085346
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.968929274866145
DONE TAKING  40  STEPS.
Total reward:  -1111.3946486478505
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -9.329088374200682
DONE TAKING  40  STEPS.
Total reward:  47.53409523215687
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.9843003874834
DONE TAKING  40  STEPS.
Total reward:  -665.3804913915538
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.23328049786608
DONE TAKING  40  STEPS.
Total reward:  -69.89942385533318
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.499802524758103
DONE TAKING  40  STEPS.
Total reward:  -432.1298011764203
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.581952223218288
DONE TAKING  40  STEPS.
Total reward:  -657.4263652334245
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.33675811577136
DONE TAKING  40  STEPS.
Total reward:  -452.68385165982545
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.41437938966287
DONE TAKING  40  STEPS.
Total reward:  -802.7180630475814
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.348002266074673
DONE TAKING  40  STEPS.
Total reward:  -593.341134214495
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.568598855248194
DONE TAKING  40  STEPS.
Total reward:  -473.0665612842898
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.563043919187635
DONE TAKING  40  STEPS.
Total reward:  -450.329937535902
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.956616474055261
DONE TAKING  40  STEPS.
Total reward:  -451.65756439379163
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.7598769634477
DONE TAKING  40  STEPS.
Total reward:  -563.6784509782931
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.74086462979927
DONE TAKING  40  STEPS.
Total reward:  -117.93054525130941
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.607014087383114
DONE TAKING  40  STEPS.
Total reward:  -721.2304069660721
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -18.701122040249373
DONE TAKING  40  STEPS.
Total reward:  -383.3309612533773
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.572560596406046
DONE TAKING  40  STEPS.
Total reward:  -1091.3791475399898
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -17.01002493472114
DONE TAKING  40  STEPS.
Total reward:  -390.06512109772285
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.8117502375002
DONE TAKING  40  STEPS.
Total reward:  -284.7201539758474
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.156208542834904
DONE TAKING  40  STEPS.
Total reward:  -226.66063546631992
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.924072879460837
DONE TAKING  40  STEPS.
Total reward:  -497.056901011042
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.09380450125743
DONE TAKING  40  STEPS.
Total reward:  -538.6595384952108
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.78853434329175
DONE TAKING  40  STEPS.
Total reward:  -814.8363624096677
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.288171214381922
DONE TAKING  40  STEPS.
Total reward:  -522.5070309951922
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.37915953938727
DONE TAKING  40  STEPS.
Total reward:  -668.6178247388494
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.20278099796376
DONE TAKING  40  STEPS.
Total reward:  -734.4556528080726
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.936618687873796
DONE TAKING  40  STEPS.
Total reward:  -547.5789206247932
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.126555885220988
DONE TAKING  40  STEPS.
Total reward:  -95.64478577759523
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -31.016875264360007
DONE TAKING  40  STEPS.
Total reward:  -713.474066816705
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -16.382935221786443
DONE TAKING  40  STEPS.
Total reward:  -327.2796288249499
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -31.265341156527235
DONE TAKING  40  STEPS.
Total reward:  -952.4259146814047
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter119.ckpt
Iter: 120
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  120
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31200
On pol:  57600
Prob shape:  (88800,)

=== Epoch 0 ===
    train loss:  0.405076201596012
    val rand:  0.29434704780578613
    val onPol:  0.38021929065386456

=== Epoch 10 ===
    train loss:  0.1499472063228574
    val rand:  0.184184730052948
    val onPol:  0.3698068857192993

=== Epoch 20 ===
    train loss:  0.09053787162710476
    val rand:  0.16815820336341858
    val onPol:  0.4150969485441844

=== Epoch 30 ===
    train loss:  0.06738867882014699
    val rand:  0.15563201904296875
    val onPol:  0.44139830271402997

=== Epoch 39 ===
    train loss:  0.05642575729702939
    val rand:  0.15091848373413086
    val onPol:  0.45515750845273334
Training duration: 45.65 s

#####################################
performing on-policy MPC rollouts... iter  120
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.288467318525367
DONE TAKING  40  STEPS.
Total reward:  -1010.5590406022061
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.15608624583194
DONE TAKING  40  STEPS.
Total reward:  -847.6365947647862
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.745976473139457
DONE TAKING  40  STEPS.
Total reward:  -310.25740981790955
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.759873371660262
DONE TAKING  40  STEPS.
Total reward:  129.04130486607858
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.403199727960633
DONE TAKING  40  STEPS.
Total reward:  -776.8109017970827
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.202536449688033
DONE TAKING  40  STEPS.
Total reward:  -288.935970481905
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.027796875637765
DONE TAKING  40  STEPS.
Total reward:  -159.67826479831947
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.627152204993678
DONE TAKING  40  STEPS.
Total reward:  -826.625872323407
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.734665503260864
DONE TAKING  40  STEPS.
Total reward:  -342.80163317152363
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.183749524321186
DONE TAKING  40  STEPS.
Total reward:  -543.252903475559
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -17.941568958599483
DONE TAKING  40  STEPS.
Total reward:  -582.0550116398701
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -16.50357455556416
DONE TAKING  40  STEPS.
Total reward:  -231.98753955792466
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.836564765138192
DONE TAKING  40  STEPS.
Total reward:  -606.3755584175273
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -14.796155391380543
DONE TAKING  40  STEPS.
Total reward:  -469.86330681685405
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.42253306925211
DONE TAKING  40  STEPS.
Total reward:  -432.80395593993967
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.983304220004893
DONE TAKING  40  STEPS.
Total reward:  -656.7587680886004
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.799461153086902
DONE TAKING  40  STEPS.
Total reward:  -875.037118003993
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.870410595965126
DONE TAKING  40  STEPS.
Total reward:  -638.7813050197661
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -14.372712384749038
DONE TAKING  40  STEPS.
Total reward:  -385.33828492044097
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.335158826756913
DONE TAKING  40  STEPS.
Total reward:  -408.80281888412554
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.71066440482955
DONE TAKING  40  STEPS.
Total reward:  -548.3813333245807
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.42402968978639
DONE TAKING  40  STEPS.
Total reward:  -263.02749015512666
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.337281466389484
DONE TAKING  40  STEPS.
Total reward:  -534.8641723221745
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.94309001692663
DONE TAKING  40  STEPS.
Total reward:  -497.0531399759931
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.669746455042926
DONE TAKING  40  STEPS.
Total reward:  -869.0357810463604
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -15.705745260509472
DONE TAKING  40  STEPS.
Total reward:  -154.64891709928816
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.587107882299
DONE TAKING  40  STEPS.
Total reward:  -761.9814861200867
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.622368980111833
DONE TAKING  40  STEPS.
Total reward:  15.105735643497123
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.38770656048217
DONE TAKING  40  STEPS.
Total reward:  -783.3284047792956
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.40287781209898
DONE TAKING  40  STEPS.
Total reward:  -816.6903955904626
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.255815682796964
DONE TAKING  40  STEPS.
Total reward:  -945.2008714576391
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.482545389251133
DONE TAKING  40  STEPS.
Total reward:  -330.5914294546225
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -19.205230167445123
DONE TAKING  40  STEPS.
Total reward:  -586.8867146940315
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.99821182614737
DONE TAKING  40  STEPS.
Total reward:  -426.60561146038106
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.186905372693246
DONE TAKING  40  STEPS.
Total reward:  -978.334583546229
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.971089983315004
DONE TAKING  40  STEPS.
Total reward:  -477.6924097889514
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -13.724632283002203
DONE TAKING  40  STEPS.
Total reward:  -266.5849913154606
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.844479989694637
DONE TAKING  40  STEPS.
Total reward:  -755.6633507067321
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.492937665504627
DONE TAKING  40  STEPS.
Total reward:  -716.581364656812
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.92903772150557
DONE TAKING  40  STEPS.
Total reward:  -468.8559949312007
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter120.ckpt
Iter: 121
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  121
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31395
On pol:  57600
Prob shape:  (88995,)

=== Epoch 0 ===
    train loss:  0.4033979758017325
    val rand:  0.3000055253505707
    val onPol:  0.38235922654469806

=== Epoch 10 ===
    train loss:  0.14815844302577091
    val rand:  0.1899830549955368
    val onPol:  0.3726017673810323

=== Epoch 20 ===
    train loss:  0.09006548694447974
    val rand:  0.16603422164916992
    val onPol:  0.4147035280863444

=== Epoch 30 ===
    train loss:  0.06754225305136229
    val rand:  0.15691912174224854
    val onPol:  0.439910093943278

=== Epoch 39 ===
    train loss:  0.05716478103244236
    val rand:  0.15634217858314514
    val onPol:  0.45557015140851337
Training duration: 43.88 s

#####################################
performing on-policy MPC rollouts... iter  121
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.95126113727683
DONE TAKING  40  STEPS.
Total reward:  -566.4237214759339
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.9649815436501
DONE TAKING  40  STEPS.
Total reward:  -813.8056610093776
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.80408924597606
DONE TAKING  40  STEPS.
Total reward:  -906.9739482344123
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.364603658231964
DONE TAKING  40  STEPS.
Total reward:  -803.0863402747118
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.951430919328644
DONE TAKING  40  STEPS.
Total reward:  -246.5406565298678
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.71589770874709
DONE TAKING  40  STEPS.
Total reward:  -715.4830782571518
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.876758128564276
DONE TAKING  40  STEPS.
Total reward:  -324.52196062924423
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -20.389791894849523
DONE TAKING  40  STEPS.
Total reward:  -403.59027671569777
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.165399997165323
DONE TAKING  40  STEPS.
Total reward:  -1115.6415221924967
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.576678398487754
DONE TAKING  40  STEPS.
Total reward:  -566.5311137938311
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.91746088470937
DONE TAKING  40  STEPS.
Total reward:  -844.5281373573395
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.33363366936381
DONE TAKING  40  STEPS.
Total reward:  -430.5929824848736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -13.075800269062317
DONE TAKING  40  STEPS.
Total reward:  -245.72219328302043
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -18.62961154904938
DONE TAKING  40  STEPS.
Total reward:  -328.08329077040736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.36099629009505
DONE TAKING  40  STEPS.
Total reward:  -834.95784008071
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -15.257210297044265
DONE TAKING  40  STEPS.
Total reward:  -459.81012429369883
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.218220468938725
DONE TAKING  40  STEPS.
Total reward:  -667.0978655081149
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.832802099184033
DONE TAKING  40  STEPS.
Total reward:  -800.6702930580834
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.125453604883656
DONE TAKING  40  STEPS.
Total reward:  -543.6100198634182
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.910104580327033
DONE TAKING  40  STEPS.
Total reward:  -902.3009580420918
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -12.639595235402554
DONE TAKING  40  STEPS.
Total reward:  21.50056813002683
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.817497665930553
DONE TAKING  40  STEPS.
Total reward:  -842.473573185518
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.951518469853788
DONE TAKING  40  STEPS.
Total reward:  -366.1586217910816
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.893964186884148
DONE TAKING  40  STEPS.
Total reward:  -998.7596469782534
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.198064599998283
DONE TAKING  40  STEPS.
Total reward:  -577.3013489811375
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.250625325260863
DONE TAKING  40  STEPS.
Total reward:  -863.5456347107732
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.36969022414081
DONE TAKING  40  STEPS.
Total reward:  -459.0903090980695
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.74944747701372
DONE TAKING  40  STEPS.
Total reward:  -942.9466215010862
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.471272941196048
DONE TAKING  40  STEPS.
Total reward:  -822.2221496025913
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.272854859634492
DONE TAKING  40  STEPS.
Total reward:  -767.202109341196
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.506930839919615
DONE TAKING  40  STEPS.
Total reward:  -701.6823110585748
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.195450180532156
DONE TAKING  40  STEPS.
Total reward:  -547.2868810886821
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.234317494006952
DONE TAKING  40  STEPS.
Total reward:  -504.1332936803491
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.72468535888738
DONE TAKING  40  STEPS.
Total reward:  -790.0569554566127
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.106624332333677
DONE TAKING  40  STEPS.
Total reward:  -465.122434010222
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.988313546265815
DONE TAKING  40  STEPS.
Total reward:  -856.9863719271918
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.45360823114607
DONE TAKING  40  STEPS.
Total reward:  -847.4769320750639
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -11.392789360552104
DONE TAKING  40  STEPS.
Total reward:  -268.20627708991117
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -31.35838987069528
DONE TAKING  40  STEPS.
Total reward:  -971.762527867178
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.166363235532224
DONE TAKING  40  STEPS.
Total reward:  -701.5663294031493
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter121.ckpt
Iter: 122
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  122
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31590
On pol:  57600
Prob shape:  (89190,)

=== Epoch 0 ===
    train loss:  0.4020730133714347
    val rand:  0.283822238445282
    val onPol:  0.39021913210550946

=== Epoch 10 ===
    train loss:  0.14458021384546127
    val rand:  0.18737050890922546
    val onPol:  0.38488928476969403

=== Epoch 20 ===
    train loss:  0.08700830292427676
    val rand:  0.1716812252998352
    val onPol:  0.42757033308347064

=== Epoch 30 ===
    train loss:  0.06555772300852442
    val rand:  0.15753808617591858
    val onPol:  0.45327454805374146

=== Epoch 39 ===
    train loss:  0.05495369425792804
    val rand:  0.15108978748321533
    val onPol:  0.47031736373901367
Training duration: 45.87 s

#####################################
performing on-policy MPC rollouts... iter  122
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.515874539280667
DONE TAKING  40  STEPS.
Total reward:  -900.8164100296909
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.353955189739533
DONE TAKING  40  STEPS.
Total reward:  -792.4352270817553
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.332859697648207
DONE TAKING  40  STEPS.
Total reward:  -494.63366099184947
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.46601492632728
DONE TAKING  40  STEPS.
Total reward:  -425.5286834102308
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.08750096902974
DONE TAKING  40  STEPS.
Total reward:  -411.3958656648789
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -9.113238915143317
DONE TAKING  40  STEPS.
Total reward:  96.4391432886301
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.298768382355583
DONE TAKING  40  STEPS.
Total reward:  -543.7200675675695
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.808630258192103
DONE TAKING  40  STEPS.
Total reward:  -382.12900786129575
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -20.374482428278174
DONE TAKING  40  STEPS.
Total reward:  -378.19059154992954
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.207994039372856
DONE TAKING  40  STEPS.
Total reward:  -633.7979625906584
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -18.416888853592646
DONE TAKING  40  STEPS.
Total reward:  -203.20650282240982
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.164370427933143
DONE TAKING  40  STEPS.
Total reward:  -673.0396160477228
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -12.332118459586653
DONE TAKING  40  STEPS.
Total reward:  148.75918525314964
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -9.938309428768635
DONE TAKING  40  STEPS.
Total reward:  -220.15895425490376
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -18.387478386055665
DONE TAKING  40  STEPS.
Total reward:  -739.7807876593525
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.872847905741686
DONE TAKING  40  STEPS.
Total reward:  -840.0408186276065
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -11.814520354833181
DONE TAKING  40  STEPS.
Total reward:  -229.4787849707209
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -13.8111379093134
DONE TAKING  40  STEPS.
Total reward:  -382.1855342613235
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.659014072078534
DONE TAKING  40  STEPS.
Total reward:  -452.30702582137826
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.05818276118221
DONE TAKING  40  STEPS.
Total reward:  -310.0699474244974
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.188213923055496
DONE TAKING  40  STEPS.
Total reward:  -468.6128778301915
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.14876628191643
DONE TAKING  40  STEPS.
Total reward:  -321.0666405005167
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.405832761420577
DONE TAKING  40  STEPS.
Total reward:  -422.40865710344656
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.407119403285698
DONE TAKING  40  STEPS.
Total reward:  -1015.180635969004
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.009421024364457
DONE TAKING  40  STEPS.
Total reward:  -526.3826400729674
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.144281104959497
DONE TAKING  40  STEPS.
Total reward:  -730.0464396511549
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.33668332038365
DONE TAKING  40  STEPS.
Total reward:  -760.2887347303755
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.179717710630797
DONE TAKING  40  STEPS.
Total reward:  -1154.1675626809845
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.457171513670886
DONE TAKING  40  STEPS.
Total reward:  160.19495327952998
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.468399491897223
DONE TAKING  40  STEPS.
Total reward:  -857.0281670443048
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -9.901368795930189
DONE TAKING  40  STEPS.
Total reward:  134.2021367733025
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -31.187362129347008
DONE TAKING  40  STEPS.
Total reward:  -851.2345221955977
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.939620779695872
DONE TAKING  40  STEPS.
Total reward:  -514.9017238183778
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.196905334326498
DONE TAKING  40  STEPS.
Total reward:  -321.5861434240443
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -31.38160256476748
DONE TAKING  40  STEPS.
Total reward:  -288.3997520637737
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -15.922628886073833
DONE TAKING  40  STEPS.
Total reward:  -564.0306184246201
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.731683348194892
DONE TAKING  40  STEPS.
Total reward:  -684.6029924818909
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.98775048588783
DONE TAKING  40  STEPS.
Total reward:  112.84929129917964
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.18211609026008
DONE TAKING  40  STEPS.
Total reward:  -702.5086572125743
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.388038331423374
DONE TAKING  40  STEPS.
Total reward:  -522.8642948462688
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter122.ckpt
Iter: 123
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  123
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31785
On pol:  57600
Prob shape:  (89385,)

=== Epoch 0 ===
    train loss:  0.4049126004008041
    val rand:  0.28775107860565186
    val onPol:  0.3993576268355052

=== Epoch 10 ===
    train loss:  0.14617667792514824
    val rand:  0.1850244104862213
    val onPol:  0.38924817244211835

=== Epoch 20 ===
    train loss:  0.08979002236463558
    val rand:  0.1671801209449768
    val onPol:  0.43472664554913837

=== Epoch 30 ===
    train loss:  0.06768093649940245
    val rand:  0.15759527683258057
    val onPol:  0.4625629186630249

=== Epoch 39 ===
    train loss:  0.05672869914821509
    val rand:  0.15313364565372467
    val onPol:  0.47688839832941693
Training duration: 36.81 s

#####################################
performing on-policy MPC rollouts... iter  123
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.930403454243535
DONE TAKING  40  STEPS.
Total reward:  -466.39089168254753
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.02482683093067
DONE TAKING  40  STEPS.
Total reward:  -131.3301981500221
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.630377208373474
DONE TAKING  40  STEPS.
Total reward:  -123.62532301906022
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.559660427166584
DONE TAKING  40  STEPS.
Total reward:  -579.4208286305034
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.04837258851773
DONE TAKING  40  STEPS.
Total reward:  -169.95306663303475
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.53629469212637
DONE TAKING  40  STEPS.
Total reward:  -365.858415587841
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.174980800052708
DONE TAKING  40  STEPS.
Total reward:  -742.145241574321
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.15627498484231
DONE TAKING  40  STEPS.
Total reward:  -389.2689978308038
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.583748445246663
DONE TAKING  40  STEPS.
Total reward:  -774.781590091269
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -14.636946561160611
DONE TAKING  40  STEPS.
Total reward:  -296.5384983011727
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.481216229185545
DONE TAKING  40  STEPS.
Total reward:  -690.381103398999
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.12953343045895
DONE TAKING  40  STEPS.
Total reward:  -416.48613322488006
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.818878268815796
DONE TAKING  40  STEPS.
Total reward:  -249.58158525623733
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.866110988305294
DONE TAKING  40  STEPS.
Total reward:  -522.5284503579687
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.385542438014014
DONE TAKING  40  STEPS.
Total reward:  -300.493214752819
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -12.447832739526454
DONE TAKING  40  STEPS.
Total reward:  -96.38395982715093
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.084196472275433
DONE TAKING  40  STEPS.
Total reward:  -425.63555771258405
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -18.59883808425658
DONE TAKING  40  STEPS.
Total reward:  -569.8264075365657
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -12.655265126951484
DONE TAKING  40  STEPS.
Total reward:  -198.93835181701786
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.27473546560404
DONE TAKING  40  STEPS.
Total reward:  29.667599868675758
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.808208659526333
DONE TAKING  40  STEPS.
Total reward:  -551.6480581883891
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.665759229605147
DONE TAKING  40  STEPS.
Total reward:  -129.04371875190162
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.563307654221305
DONE TAKING  40  STEPS.
Total reward:  -441.78268635742245
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.42078519821662
DONE TAKING  40  STEPS.
Total reward:  -359.49468110744425
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.383306843195648
DONE TAKING  40  STEPS.
Total reward:  -672.808523324153
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.241348498773977
DONE TAKING  40  STEPS.
Total reward:  -373.20128248956706
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.923228329711996
DONE TAKING  40  STEPS.
Total reward:  -412.36786915348296
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.46577024327471
DONE TAKING  40  STEPS.
Total reward:  -7.315521584961342
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.252878709196306
DONE TAKING  40  STEPS.
Total reward:  -586.2991557488509
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.716661753643685
DONE TAKING  40  STEPS.
Total reward:  -823.5679123707705
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -14.022603649023825
DONE TAKING  40  STEPS.
Total reward:  -505.76160228560127
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.101218747361294
DONE TAKING  40  STEPS.
Total reward:  -592.442279933128
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.879029284696436
DONE TAKING  40  STEPS.
Total reward:  -816.1564576534398
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.074930451370236
DONE TAKING  40  STEPS.
Total reward:  -851.683559380719
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.746678339707618
DONE TAKING  40  STEPS.
Total reward:  -572.3535952253845
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.52518649717815
DONE TAKING  40  STEPS.
Total reward:  -426.5294844738266
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -15.15819823496557
DONE TAKING  40  STEPS.
Total reward:  57.006598288285154
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.251156550376088
DONE TAKING  40  STEPS.
Total reward:  -127.16602290657178
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.4615336575144
DONE TAKING  40  STEPS.
Total reward:  -671.0831794047543
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.413654126895779
DONE TAKING  40  STEPS.
Total reward:  -113.56351853993222
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter123.ckpt
Iter: 124
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  124
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  31980
On pol:  57600
Prob shape:  (89580,)

=== Epoch 0 ===
    train loss:  0.4043987840414047
    val rand:  0.2892425060272217
    val onPol:  0.3966260651747386

=== Epoch 10 ===
    train loss:  0.14940611273050308
    val rand:  0.18955975770950317
    val onPol:  0.38454429308573407

=== Epoch 20 ===
    train loss:  0.09109987417000463
    val rand:  0.17254707217216492
    val onPol:  0.4298848708470662

=== Epoch 30 ===
    train loss:  0.0684324284779957
    val rand:  0.15873584151268005
    val onPol:  0.45505491892496747

=== Epoch 39 ===
    train loss:  0.05832848374614085
    val rand:  0.15619421005249023
    val onPol:  0.4707907934983571
Training duration: 44.13 s

#####################################
performing on-policy MPC rollouts... iter  124
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -17.86719180562269
DONE TAKING  40  STEPS.
Total reward:  -605.2787968566123
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.108973061643873
DONE TAKING  40  STEPS.
Total reward:  112.96440861001979
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.878375445035587
DONE TAKING  40  STEPS.
Total reward:  -382.5567296407315
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.250852834173223
DONE TAKING  40  STEPS.
Total reward:  -1027.8292816617645
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.398349017442555
DONE TAKING  40  STEPS.
Total reward:  -710.0730974427173
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.613882664496945
DONE TAKING  40  STEPS.
Total reward:  -197.4476104593244
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.649599873294218
DONE TAKING  40  STEPS.
Total reward:  -606.8289727397874
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.332699186526506
DONE TAKING  40  STEPS.
Total reward:  -336.3242640450598
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.21053463894399
DONE TAKING  40  STEPS.
Total reward:  -377.50437543872556
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.273778295268908
DONE TAKING  40  STEPS.
Total reward:  -956.4777010506008
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.605128461122437
DONE TAKING  40  STEPS.
Total reward:  -80.4635024596996
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -30.030290350659623
DONE TAKING  40  STEPS.
Total reward:  -724.677122329044
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.701691018403924
DONE TAKING  40  STEPS.
Total reward:  -641.9801673675404
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.463230076496743
DONE TAKING  40  STEPS.
Total reward:  -393.7576206321454
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.529059810564835
DONE TAKING  40  STEPS.
Total reward:  -857.2044516411298
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.8320051521645
DONE TAKING  40  STEPS.
Total reward:  -674.1577021920475
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.01042743983691
DONE TAKING  40  STEPS.
Total reward:  -345.90676426414973
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.829182204607804
DONE TAKING  40  STEPS.
Total reward:  -542.2340725138051
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.217671868145956
DONE TAKING  40  STEPS.
Total reward:  -677.4784485909108
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.29409440645048
DONE TAKING  40  STEPS.
Total reward:  -374.50096081657256
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.8191837200717
DONE TAKING  40  STEPS.
Total reward:  -173.22731273213924
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.90286641643511
DONE TAKING  40  STEPS.
Total reward:  -1007.2513545760909
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.286424423080703
DONE TAKING  40  STEPS.
Total reward:  -603.9281100048128
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.013305774810696
DONE TAKING  40  STEPS.
Total reward:  -637.058732187864
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.566047217895367
DONE TAKING  40  STEPS.
Total reward:  -483.2822588673721
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.105715214537156
DONE TAKING  40  STEPS.
Total reward:  -583.1621866309359
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.725773632033416
DONE TAKING  40  STEPS.
Total reward:  -669.7631240709405
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -20.64928031199393
DONE TAKING  40  STEPS.
Total reward:  -637.764550922486
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.371502688251553
DONE TAKING  40  STEPS.
Total reward:  -717.8005243022913
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.691973537097986
DONE TAKING  40  STEPS.
Total reward:  -935.355868512337
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.90222072406986
DONE TAKING  40  STEPS.
Total reward:  -798.7211445425038
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.354665426308216
DONE TAKING  40  STEPS.
Total reward:  -724.3672113355032
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.302728128277753
DONE TAKING  40  STEPS.
Total reward:  -811.7228848411141
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.697773826832943
DONE TAKING  40  STEPS.
Total reward:  -687.2073999546898
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.673961062786866
DONE TAKING  40  STEPS.
Total reward:  -568.1980341510484
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.64688560159778
DONE TAKING  40  STEPS.
Total reward:  -665.0312402660585
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -12.723996160752806
DONE TAKING  40  STEPS.
Total reward:  -370.0503492678479
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.351597143195992
DONE TAKING  40  STEPS.
Total reward:  -650.6094542431858
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -12.654328781980805
DONE TAKING  40  STEPS.
Total reward:  -446.57618321783326
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.776725398242
DONE TAKING  40  STEPS.
Total reward:  -422.9080871510116
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter124.ckpt
Iter: 125
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  125
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  32175
On pol:  57600
Prob shape:  (89775,)

=== Epoch 0 ===
    train loss:  0.40593224814959933
    val rand:  0.28542372584342957
    val onPol:  0.4022447069485982

=== Epoch 10 ===
    train loss:  0.14936775173459735
    val rand:  0.18932577967643738
    val onPol:  0.39408983786900836

=== Epoch 20 ===
    train loss:  0.09090254477092198
    val rand:  0.1656867116689682
    val onPol:  0.4426240722338359

=== Epoch 30 ===
    train loss:  0.06996094020349639
    val rand:  0.157790407538414
    val onPol:  0.46860163410504657

=== Epoch 39 ===
    train loss:  0.0590474282843726
    val rand:  0.15445078909397125
    val onPol:  0.4864834745724996
Training duration: 43.85 s

#####################################
performing on-policy MPC rollouts... iter  125
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.336389564493658
DONE TAKING  40  STEPS.
Total reward:  -100.25444154404003
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.036741315312877
DONE TAKING  40  STEPS.
Total reward:  -336.9367712785896
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -30.2048724252369
DONE TAKING  40  STEPS.
Total reward:  -1040.9607158128815
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.04444866504128
DONE TAKING  40  STEPS.
Total reward:  -356.9760987516639
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.390875633302496
DONE TAKING  40  STEPS.
Total reward:  -354.9759483928961
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.35139394426637
DONE TAKING  40  STEPS.
Total reward:  -150.5930187896364
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -31.238083734672234
DONE TAKING  40  STEPS.
Total reward:  -785.7498913726657
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -26.79584688088282
DONE TAKING  40  STEPS.
Total reward:  -766.5138935716712
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.957979242503153
DONE TAKING  40  STEPS.
Total reward:  -609.8357313020095
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.471872447190336
DONE TAKING  40  STEPS.
Total reward:  -1024.0920250605818
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.78204575082296
DONE TAKING  40  STEPS.
Total reward:  -493.15562123400014
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.588942800960197
DONE TAKING  40  STEPS.
Total reward:  -576.7040766591965
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.301055925650882
DONE TAKING  40  STEPS.
Total reward:  -666.5851745042019
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.355666750863293
DONE TAKING  40  STEPS.
Total reward:  -137.34191744399484
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.045361837542366
DONE TAKING  40  STEPS.
Total reward:  -620.3730277136134
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.671894367310845
DONE TAKING  40  STEPS.
Total reward:  -976.7866400932813
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.051200993031777
DONE TAKING  40  STEPS.
Total reward:  -761.1317551230491
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.501334086214758
DONE TAKING  40  STEPS.
Total reward:  -276.3985760982194
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.843769111737885
DONE TAKING  40  STEPS.
Total reward:  -786.3548678754406
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -16.60373924605079
DONE TAKING  40  STEPS.
Total reward:  -606.5951144765979
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.96481996333567
DONE TAKING  40  STEPS.
Total reward:  -188.24065413970817
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -12.44675783606721
DONE TAKING  40  STEPS.
Total reward:  -117.01135891052391
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.658179825382064
DONE TAKING  40  STEPS.
Total reward:  -674.5073557771483
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.76816187623738
DONE TAKING  40  STEPS.
Total reward:  -712.8426847416197
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.94624878539357
DONE TAKING  40  STEPS.
Total reward:  22.2921423945648
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.30524040511787
DONE TAKING  40  STEPS.
Total reward:  -588.2171585265529
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -20.390847079969944
DONE TAKING  40  STEPS.
Total reward:  -234.0187623952663
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.887512033359307
DONE TAKING  40  STEPS.
Total reward:  -478.4774326600238
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.72471763073171
DONE TAKING  40  STEPS.
Total reward:  -693.2911958825343
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.385499080004415
DONE TAKING  40  STEPS.
Total reward:  -532.2229095699155
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.66642581356694
DONE TAKING  40  STEPS.
Total reward:  -713.4756823078
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.113318744528392
DONE TAKING  40  STEPS.
Total reward:  -279.34579162050983
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.91787032048312
DONE TAKING  40  STEPS.
Total reward:  86.34769372556885
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.59978296753592
DONE TAKING  40  STEPS.
Total reward:  -552.3475614154065
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -13.826198169299758
DONE TAKING  40  STEPS.
Total reward:  -520.2267567900263
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -12.053083463955023
DONE TAKING  40  STEPS.
Total reward:  -506.0858660462938
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.837782810877982
DONE TAKING  40  STEPS.
Total reward:  -367.4752086533505
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.70548287374858
DONE TAKING  40  STEPS.
Total reward:  -929.5812578237643
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.41118321177681
DONE TAKING  40  STEPS.
Total reward:  -404.02131473046484
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.161025849837344
DONE TAKING  40  STEPS.
Total reward:  -200.29652820448376
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter125.ckpt
Iter: 126
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  126
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  32370
On pol:  57600
Prob shape:  (89970,)

=== Epoch 0 ===
    train loss:  0.4058386022703988
    val rand:  0.29170510172843933
    val onPol:  0.3954776922861735

=== Epoch 10 ===
    train loss:  0.15060889056750706
    val rand:  0.18524780869483948
    val onPol:  0.3828882972399394

=== Epoch 20 ===
    train loss:  0.09120479779584068
    val rand:  0.16810724139213562
    val onPol:  0.4268139700094859

=== Epoch 30 ===
    train loss:  0.06865597388574056
    val rand:  0.16287915408611298
    val onPol:  0.45377235611279804

=== Epoch 39 ===
    train loss:  0.058290633388928
    val rand:  0.15782223641872406
    val onPol:  0.46852366129557294
Training duration: 46.09 s

#####################################
performing on-policy MPC rollouts... iter  126
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.73648074845186
DONE TAKING  40  STEPS.
Total reward:  -269.2282476285564
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.625850294912674
DONE TAKING  40  STEPS.
Total reward:  -935.8880139252417
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.181672323429467
DONE TAKING  40  STEPS.
Total reward:  -774.69817496104
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.745809101639313
DONE TAKING  40  STEPS.
Total reward:  -702.5959866569857
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.038282068548245
DONE TAKING  40  STEPS.
Total reward:  -888.087401753667
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.6076039604868
DONE TAKING  40  STEPS.
Total reward:  -975.6812448572641
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.8936330203528
DONE TAKING  40  STEPS.
Total reward:  -825.4115939100117
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.632478469331218
DONE TAKING  40  STEPS.
Total reward:  -352.1153666047859
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.17045506889399
DONE TAKING  40  STEPS.
Total reward:  -929.5524532107088
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.555508542142764
DONE TAKING  40  STEPS.
Total reward:  -414.8737338377802
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.06521357081914
DONE TAKING  40  STEPS.
Total reward:  -721.1019008614987
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.285006561411954
DONE TAKING  40  STEPS.
Total reward:  -428.8186009544708
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.05109119321068
DONE TAKING  40  STEPS.
Total reward:  -367.12016771208215
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.83639540361747
DONE TAKING  40  STEPS.
Total reward:  -487.7961596038862
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.881061277760264
DONE TAKING  40  STEPS.
Total reward:  -555.0340144517187
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.007059708717772
DONE TAKING  40  STEPS.
Total reward:  -543.3954836672552
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -17.839447658733828
DONE TAKING  40  STEPS.
Total reward:  -353.1921582275516
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.151078783895542
DONE TAKING  40  STEPS.
Total reward:  -382.64366200566644
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.33551055060282
DONE TAKING  40  STEPS.
Total reward:  -439.08509518524454
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -11.651673268654088
DONE TAKING  40  STEPS.
Total reward:  -412.0721989959785
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.67681910161207
DONE TAKING  40  STEPS.
Total reward:  -764.9644279091592
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.398947080231146
DONE TAKING  40  STEPS.
Total reward:  -595.60862903425
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.90161729289354
DONE TAKING  40  STEPS.
Total reward:  -849.7493434909359
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -15.111939253026542
DONE TAKING  40  STEPS.
Total reward:  -514.3178864709031
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.65794174638513
DONE TAKING  40  STEPS.
Total reward:  -847.3866556232499
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.456678413195888
DONE TAKING  40  STEPS.
Total reward:  -354.75443047257454
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.922856794706963
DONE TAKING  40  STEPS.
Total reward:  -988.1881225216322
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.567606111892324
DONE TAKING  40  STEPS.
Total reward:  -399.5324649232302
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.00267341897838
DONE TAKING  40  STEPS.
Total reward:  -1005.4196521283883
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.76787198503455
DONE TAKING  40  STEPS.
Total reward:  -500.5322446874805
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.88161981157657
DONE TAKING  40  STEPS.
Total reward:  -391.86262438989206
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -16.877568548209382
DONE TAKING  40  STEPS.
Total reward:  -584.1434562185407
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.87668649026636
DONE TAKING  40  STEPS.
Total reward:  -500.32421212887726
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.86443369881418
DONE TAKING  40  STEPS.
Total reward:  -488.23286762473293
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.22982722354989
DONE TAKING  40  STEPS.
Total reward:  -749.1531493016746
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.823596214160148
DONE TAKING  40  STEPS.
Total reward:  -101.70108979982578
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.504454984253464
DONE TAKING  40  STEPS.
Total reward:  -614.6012894605599
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.452229649504318
DONE TAKING  40  STEPS.
Total reward:  -746.6150881032947
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.7239399508312
DONE TAKING  40  STEPS.
Total reward:  -580.5652215913495
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.968487187189375
DONE TAKING  40  STEPS.
Total reward:  -346.16834259603434
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter126.ckpt
Iter: 127
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  127
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  32565
On pol:  57600
Prob shape:  (90165,)

=== Epoch 0 ===
    train loss:  0.4027865466407754
    val rand:  0.284051775932312
    val onPol:  0.3871042827765147

=== Epoch 10 ===
    train loss:  0.14671449253166263
    val rand:  0.18788179755210876
    val onPol:  0.38246434926986694

=== Epoch 20 ===
    train loss:  0.0895955456759442
    val rand:  0.16173793375492096
    val onPol:  0.42778000235557556

=== Epoch 30 ===
    train loss:  0.0677893684795973
    val rand:  0.15868455171585083
    val onPol:  0.4556766053040822

=== Epoch 39 ===
    train loss:  0.05634935130365193
    val rand:  0.15450426936149597
    val onPol:  0.46774179736773175
Training duration: 44.11 s

#####################################
performing on-policy MPC rollouts... iter  127
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.336866196211787
DONE TAKING  40  STEPS.
Total reward:  -1031.5013073494094
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.45022112508282
DONE TAKING  40  STEPS.
Total reward:  -629.752562444654
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.25975903603693
DONE TAKING  40  STEPS.
Total reward:  -809.1594270348176
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.50572388525615
DONE TAKING  40  STEPS.
Total reward:  -620.9095966111161
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.979705971173086
DONE TAKING  40  STEPS.
Total reward:  -613.0749701046885
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.01873628290084
DONE TAKING  40  STEPS.
Total reward:  -399.8128651731947
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.3053938969816
DONE TAKING  40  STEPS.
Total reward:  -632.4496351023612
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -17.54694812300799
DONE TAKING  40  STEPS.
Total reward:  -209.74455685497225
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -19.23906209666712
DONE TAKING  40  STEPS.
Total reward:  -240.65419123767464
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.166720479618625
DONE TAKING  40  STEPS.
Total reward:  -455.01789434177607
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.760175409926092
DONE TAKING  40  STEPS.
Total reward:  -450.0513838655686
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.113664843227845
DONE TAKING  40  STEPS.
Total reward:  -843.685320771534
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.87845827665857
DONE TAKING  40  STEPS.
Total reward:  -712.1965552516399
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.49634299874392
DONE TAKING  40  STEPS.
Total reward:  -287.3968836398957
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.5701250821471
DONE TAKING  40  STEPS.
Total reward:  -1037.031327486108
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -31.38837289097995
DONE TAKING  40  STEPS.
Total reward:  -690.2270833249513
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -16.408925186138738
DONE TAKING  40  STEPS.
Total reward:  -390.0527295987159
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.623616244538102
DONE TAKING  40  STEPS.
Total reward:  -913.9355600879919
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -15.568065725476025
DONE TAKING  40  STEPS.
Total reward:  -211.86413189720076
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -15.643193514764754
DONE TAKING  40  STEPS.
Total reward:  -203.8161818461458
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.372894228507803
DONE TAKING  40  STEPS.
Total reward:  -586.7040149454381
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.243761122223273
DONE TAKING  40  STEPS.
Total reward:  -323.98195432240965
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.044162331935205
DONE TAKING  40  STEPS.
Total reward:  -366.0258152217856
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.10127096695979
DONE TAKING  40  STEPS.
Total reward:  130.69478577037515
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.79634194367124
DONE TAKING  40  STEPS.
Total reward:  -497.1889390451169
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.291139260123952
DONE TAKING  40  STEPS.
Total reward:  -763.4367764586939
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.08062284606651
DONE TAKING  40  STEPS.
Total reward:  -623.6535175341887
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.123515715777025
DONE TAKING  40  STEPS.
Total reward:  -584.6616747964432
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.602960633099272
DONE TAKING  40  STEPS.
Total reward:  -500.9007819039486
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -30.875035827787357
DONE TAKING  40  STEPS.
Total reward:  -807.7891716160317
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.1464459306561
DONE TAKING  40  STEPS.
Total reward:  -514.1192030270727
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.088920577540925
DONE TAKING  40  STEPS.
Total reward:  -448.187531525631
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.67679767003445
DONE TAKING  40  STEPS.
Total reward:  -1008.745453808175
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.040161934312955
DONE TAKING  40  STEPS.
Total reward:  -586.2123754121204
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.152798597129177
DONE TAKING  40  STEPS.
Total reward:  -597.4199360612647
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.01455352708925
DONE TAKING  40  STEPS.
Total reward:  -380.0901989432101
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.64302526497921
DONE TAKING  40  STEPS.
Total reward:  -1046.9366947905962
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.44680504752828
DONE TAKING  40  STEPS.
Total reward:  -504.1250372059369
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.13955075753581
DONE TAKING  40  STEPS.
Total reward:  -358.4402049823958
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.992927999995263
DONE TAKING  40  STEPS.
Total reward:  -332.2944528087584
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter127.ckpt
Iter: 128
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  128
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  32760
On pol:  57600
Prob shape:  (90360,)

=== Epoch 0 ===
    train loss:  0.4048859424550425
    val rand:  0.301460862159729
    val onPol:  0.3890097637971242

=== Epoch 10 ===
    train loss:  0.14709226524626667
    val rand:  0.18941442668437958
    val onPol:  0.38552754124005634

=== Epoch 20 ===
    train loss:  0.08983241199431094
    val rand:  0.16842399537563324
    val onPol:  0.43290574351946515

=== Epoch 30 ===
    train loss:  0.06729038392024284
    val rand:  0.15941143035888672
    val onPol:  0.4611742893854777

=== Epoch 39 ===
    train loss:  0.05802506034855138
    val rand:  0.1556098759174347
    val onPol:  0.479009211063385
Training duration: 46.13 s

#####################################
performing on-policy MPC rollouts... iter  128
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.393167496215288
DONE TAKING  40  STEPS.
Total reward:  -755.3887501786519
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.115767478334718
DONE TAKING  40  STEPS.
Total reward:  -790.2094142933744
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.801790899469964
DONE TAKING  40  STEPS.
Total reward:  -444.90522904142426
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.282062023608162
DONE TAKING  40  STEPS.
Total reward:  -693.9859882125969
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.845732620183433
DONE TAKING  40  STEPS.
Total reward:  -331.35772015112843
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.759117458399093
DONE TAKING  40  STEPS.
Total reward:  -983.5095065130467
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.181612291498407
DONE TAKING  40  STEPS.
Total reward:  -833.4248582396383
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.174558658562756
DONE TAKING  40  STEPS.
Total reward:  -373.1602980382572
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -12.44665932735055
DONE TAKING  40  STEPS.
Total reward:  -327.19693651341703
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.651028468077506
DONE TAKING  40  STEPS.
Total reward:  -598.6023487359716
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.69307190772458
DONE TAKING  40  STEPS.
Total reward:  -661.5368900917135
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.487314749448387
DONE TAKING  40  STEPS.
Total reward:  -808.4250724103622
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.402865813896582
DONE TAKING  40  STEPS.
Total reward:  -554.8644586442942
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.692310747647653
DONE TAKING  40  STEPS.
Total reward:  -466.4098622107866
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -30.766351350173412
DONE TAKING  40  STEPS.
Total reward:  -927.3634014226282
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.555362225826812
DONE TAKING  40  STEPS.
Total reward:  -521.3503760832095
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.776940977795746
DONE TAKING  40  STEPS.
Total reward:  -692.1634735851924
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.52528153804504
DONE TAKING  40  STEPS.
Total reward:  -531.7137940451527
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.86146215030059
DONE TAKING  40  STEPS.
Total reward:  -864.6141276461028
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -18.324112573057935
DONE TAKING  40  STEPS.
Total reward:  -633.7107442090792
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.95155069941279
DONE TAKING  40  STEPS.
Total reward:  -775.3681713700964
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.782365526121808
DONE TAKING  40  STEPS.
Total reward:  -661.7607811237283
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.762689242289913
DONE TAKING  40  STEPS.
Total reward:  -1054.9777434841521
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.3523276498985
DONE TAKING  40  STEPS.
Total reward:  -849.9178687019692
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -17.794604625366507
DONE TAKING  40  STEPS.
Total reward:  -434.73776094861825
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.427264996853314
DONE TAKING  40  STEPS.
Total reward:  -750.650810385532
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.939952005657545
DONE TAKING  40  STEPS.
Total reward:  -632.6914227158254
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.743834487079134
DONE TAKING  40  STEPS.
Total reward:  -554.9334596386187
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -26.80877784849553
DONE TAKING  40  STEPS.
Total reward:  -1032.9343124792135
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.137110169577756
DONE TAKING  40  STEPS.
Total reward:  -220.13334136832432
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.300350547033773
DONE TAKING  40  STEPS.
Total reward:  -652.7016539097995
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.2985188140535
DONE TAKING  40  STEPS.
Total reward:  -545.803875335665
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.049893153899728
DONE TAKING  40  STEPS.
Total reward:  -198.670718103828
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.99489038395285
DONE TAKING  40  STEPS.
Total reward:  -485.58132725912446
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.722718661677185
DONE TAKING  40  STEPS.
Total reward:  -796.6995192443525
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -14.169564891517263
DONE TAKING  40  STEPS.
Total reward:  -245.9199283203076
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.220013320191605
DONE TAKING  40  STEPS.
Total reward:  -1115.9310745236796
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.687977028468175
DONE TAKING  40  STEPS.
Total reward:  -770.9080658290359
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -16.022081975083427
DONE TAKING  40  STEPS.
Total reward:  -483.7223860574221
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.740818856526754
DONE TAKING  40  STEPS.
Total reward:  -414.2249010915379
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter128.ckpt
Iter: 129
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  129
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  32955
On pol:  57600
Prob shape:  (90555,)

=== Epoch 0 ===
    train loss:  0.40143961730328476
    val rand:  0.2858991324901581
    val onPol:  0.3948672115802765

=== Epoch 10 ===
    train loss:  0.14750514949925922
    val rand:  0.1838361918926239
    val onPol:  0.3943850298722585

=== Epoch 20 ===
    train loss:  0.08993181463500316
    val rand:  0.16366742551326752
    val onPol:  0.43879324197769165

=== Epoch 30 ===
    train loss:  0.06775529352440075
    val rand:  0.15576009452342987
    val onPol:  0.4641430576642354

=== Epoch 39 ===
    train loss:  0.056690293554724616
    val rand:  0.1530984491109848
    val onPol:  0.48005138834317523
Training duration: 44.56 s

#####################################
performing on-policy MPC rollouts... iter  129
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.530778952940828
DONE TAKING  40  STEPS.
Total reward:  -204.78271075087454
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.469058060728077
DONE TAKING  40  STEPS.
Total reward:  -84.2354865051739
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -30.84885694011892
DONE TAKING  40  STEPS.
Total reward:  -732.7440677992286
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -31.257584606130948
DONE TAKING  40  STEPS.
Total reward:  -762.3452036850141
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.283653337245354
DONE TAKING  40  STEPS.
Total reward:  -880.3564397786218
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.034914497939834
DONE TAKING  40  STEPS.
Total reward:  -530.7939254853849
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.5770283992409
DONE TAKING  40  STEPS.
Total reward:  -782.2689981574189
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -17.71746706487795
DONE TAKING  40  STEPS.
Total reward:  -231.19654457906378
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.120185690322423
DONE TAKING  40  STEPS.
Total reward:  -197.9219855852774
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -16.733877478161702
DONE TAKING  40  STEPS.
Total reward:  -414.3820520484635
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.82153256175539
DONE TAKING  40  STEPS.
Total reward:  -681.3551890446939
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -12.369589635692137
DONE TAKING  40  STEPS.
Total reward:  91.91311562822787
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.474431330220185
DONE TAKING  40  STEPS.
Total reward:  -683.7408388471448
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.458297635497726
DONE TAKING  40  STEPS.
Total reward:  -505.0196035445461
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.028884634335597
DONE TAKING  40  STEPS.
Total reward:  -412.4677730537377
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.8506307361877
DONE TAKING  40  STEPS.
Total reward:  -644.0726523305817
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.51413765304534
DONE TAKING  40  STEPS.
Total reward:  -807.7472008849838
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.543067904219477
DONE TAKING  40  STEPS.
Total reward:  -622.7340779551747
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.338809259860312
DONE TAKING  40  STEPS.
Total reward:  -1043.0085623800878
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.971202977558
DONE TAKING  40  STEPS.
Total reward:  -994.979285853494
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.517944187639827
DONE TAKING  40  STEPS.
Total reward:  -362.91579324589907
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -16.636356860991818
DONE TAKING  40  STEPS.
Total reward:  -449.6382065659312
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.218801079013566
DONE TAKING  40  STEPS.
Total reward:  -169.0080293724652
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.66921397989727
DONE TAKING  40  STEPS.
Total reward:  -550.3457512553332
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.83045063972976
DONE TAKING  40  STEPS.
Total reward:  -353.5955492638369
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.473628795566214
DONE TAKING  40  STEPS.
Total reward:  -502.51104153226464
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -12.740953035702503
DONE TAKING  40  STEPS.
Total reward:  -416.48488179138326
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.658717033210287
DONE TAKING  40  STEPS.
Total reward:  -580.1150427701747
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.677997679167433
DONE TAKING  40  STEPS.
Total reward:  -277.2813940110008
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.641723014077968
DONE TAKING  40  STEPS.
Total reward:  -491.7986427285537
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -13.60323954947354
DONE TAKING  40  STEPS.
Total reward:  71.11126833876497
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -12.411577556812578
DONE TAKING  40  STEPS.
Total reward:  -81.98105829470516
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.13004503167346
DONE TAKING  40  STEPS.
Total reward:  -837.7421279813354
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.924334626444015
DONE TAKING  40  STEPS.
Total reward:  -651.7875094660251
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -12.309598542643892
DONE TAKING  40  STEPS.
Total reward:  -33.23241552842113
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -31.284691276732033
DONE TAKING  40  STEPS.
Total reward:  -699.0064933013969
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.4862790985569
DONE TAKING  40  STEPS.
Total reward:  73.80104120142656
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -14.387976156357267
DONE TAKING  40  STEPS.
Total reward:  -863.4568330430579
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.628289100987722
DONE TAKING  40  STEPS.
Total reward:  -927.1522919792128
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.17254280863203
DONE TAKING  40  STEPS.
Total reward:  -117.31246964047942
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter129.ckpt
Iter: 130
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  130
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  33150
On pol:  57600
Prob shape:  (90750,)

=== Epoch 0 ===
    train loss:  0.40014889465886994
    val rand:  0.2933417558670044
    val onPol:  0.39405224720637005

=== Epoch 10 ===
    train loss:  0.14796637613221078
    val rand:  0.185658797621727
    val onPol:  0.39033331473668414

=== Epoch 20 ===
    train loss:  0.09096723416094053
    val rand:  0.16495081782341003
    val onPol:  0.43513352672259015

=== Epoch 30 ===
    train loss:  0.0686697132759175
    val rand:  0.15836364030838013
    val onPol:  0.4605108896891276

=== Epoch 39 ===
    train loss:  0.05825772692086333
    val rand:  0.1544221043586731
    val onPol:  0.47716527183850604
Training duration: 47.04 s

#####################################
performing on-policy MPC rollouts... iter  130
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.734326746078143
DONE TAKING  40  STEPS.
Total reward:  -202.2780354063168
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.079520665508824
DONE TAKING  40  STEPS.
Total reward:  -539.3883531362742
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.328309333774513
DONE TAKING  40  STEPS.
Total reward:  -1108.6930274496538
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.939582713341196
DONE TAKING  40  STEPS.
Total reward:  -665.3597783873176
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.805014197779887
DONE TAKING  40  STEPS.
Total reward:  -520.8941091489429
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.04665458011705
DONE TAKING  40  STEPS.
Total reward:  -417.68407198765374
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.071629898328794
DONE TAKING  40  STEPS.
Total reward:  -632.0007278377893
Time for 1 rollout: 1.37 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -15.70192807351566
DONE TAKING  40  STEPS.
Total reward:  -306.3044912953461
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.121054301351073
DONE TAKING  40  STEPS.
Total reward:  -384.29088770090544
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.115790839856924
DONE TAKING  40  STEPS.
Total reward:  -414.9820203727014
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.3757231776541
DONE TAKING  40  STEPS.
Total reward:  -1011.8246088170351
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.2278863991017
DONE TAKING  40  STEPS.
Total reward:  -470.79495251593846
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -27.77593079316211
DONE TAKING  40  STEPS.
Total reward:  -1016.940079018104
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.99896700325131
DONE TAKING  40  STEPS.
Total reward:  -417.78893458488886
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.88879217028927
DONE TAKING  40  STEPS.
Total reward:  -718.7765039523786
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.709840353928477
DONE TAKING  40  STEPS.
Total reward:  -742.5256833780372
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.18443053609441
DONE TAKING  40  STEPS.
Total reward:  -553.8430515831947
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -20.697740568348895
DONE TAKING  40  STEPS.
Total reward:  -753.4664275293275
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.781300092222658
DONE TAKING  40  STEPS.
Total reward:  -643.9814972406056
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -31.114604981460808
DONE TAKING  40  STEPS.
Total reward:  -809.2345510878479
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.203581599505416
DONE TAKING  40  STEPS.
Total reward:  -425.7254095458369
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.940436005520453
DONE TAKING  40  STEPS.
Total reward:  -438.488416746701
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -19.142785458197295
DONE TAKING  40  STEPS.
Total reward:  -330.8520563821189
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -18.407387810405062
DONE TAKING  40  STEPS.
Total reward:  -619.7629427057796
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.940484670124807
DONE TAKING  40  STEPS.
Total reward:  -665.8201728941448
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.583039787809586
DONE TAKING  40  STEPS.
Total reward:  -452.46019942636525
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.299430786523946
DONE TAKING  40  STEPS.
Total reward:  -1101.031076280548
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.779711047510897
DONE TAKING  40  STEPS.
Total reward:  -322.63058432048405
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.773362690649087
DONE TAKING  40  STEPS.
Total reward:  -602.4889501740947
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.67115474855772
DONE TAKING  40  STEPS.
Total reward:  -659.6845242348705
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.73046636212322
DONE TAKING  40  STEPS.
Total reward:  -714.7741356835329
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -16.388660922205446
DONE TAKING  40  STEPS.
Total reward:  -484.88877818205555
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.027606922232835
DONE TAKING  40  STEPS.
Total reward:  -456.097941611028
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.928073526985017
DONE TAKING  40  STEPS.
Total reward:  -785.9523947179841
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.462581086289603
DONE TAKING  40  STEPS.
Total reward:  -216.26756779059212
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -9.41441120632736
DONE TAKING  40  STEPS.
Total reward:  -349.9166087148255
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.595467444808136
DONE TAKING  40  STEPS.
Total reward:  -839.8937605230226
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.02283635923376
DONE TAKING  40  STEPS.
Total reward:  -967.1896136946557
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.406755096324504
DONE TAKING  40  STEPS.
Total reward:  -523.4541188454834
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.165328340577116
DONE TAKING  40  STEPS.
Total reward:  -1121.5606640198962
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter130.ckpt
Iter: 131
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  131
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  33345
On pol:  57600
Prob shape:  (90945,)

=== Epoch 0 ===
    train loss:  0.40187923096667577
    val rand:  0.29289722442626953
    val onPol:  0.39622918764750165

=== Epoch 10 ===
    train loss:  0.15000600910792916
    val rand:  0.18609857559204102
    val onPol:  0.3909055292606354

=== Epoch 20 ===
    train loss:  0.09203124572496629
    val rand:  0.16691038012504578
    val onPol:  0.4410710533459981

=== Epoch 30 ===
    train loss:  0.06915043976347325
    val rand:  0.15836751461029053
    val onPol:  0.4712863663832347

=== Epoch 39 ===
    train loss:  0.05877964141762863
    val rand:  0.1551220566034317
    val onPol:  0.4872804880142212
Training duration: 44.55 s

#####################################
performing on-policy MPC rollouts... iter  131
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -16.933897247993816
DONE TAKING  40  STEPS.
Total reward:  -427.49835525021456
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.84270898353475
DONE TAKING  40  STEPS.
Total reward:  -247.70515023569277
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.923569511195844
DONE TAKING  40  STEPS.
Total reward:  -324.9446602172396
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -31.098671491979083
DONE TAKING  40  STEPS.
Total reward:  -518.7236502545487
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.695990746243062
DONE TAKING  40  STEPS.
Total reward:  -537.8751921433408
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.1489665481018
DONE TAKING  40  STEPS.
Total reward:  -687.5362783344823
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.222933665404305
DONE TAKING  40  STEPS.
Total reward:  -475.3637352279785
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.857090852260708
DONE TAKING  40  STEPS.
Total reward:  -706.456979041191
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.577064686982176
DONE TAKING  40  STEPS.
Total reward:  -439.18246653706086
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.184029691345117
DONE TAKING  40  STEPS.
Total reward:  -1006.5059717388281
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.94252689869048
DONE TAKING  40  STEPS.
Total reward:  -760.9214722027536
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.325074674920387
DONE TAKING  40  STEPS.
Total reward:  -926.059778225651
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.661263470999682
DONE TAKING  40  STEPS.
Total reward:  -458.8265554571879
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.368506760019045
DONE TAKING  40  STEPS.
Total reward:  -423.3772926277141
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.061392664196077
DONE TAKING  40  STEPS.
Total reward:  -709.4161681754033
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.38259931383502
DONE TAKING  40  STEPS.
Total reward:  -553.4442592206275
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.15849414879252
DONE TAKING  40  STEPS.
Total reward:  -715.9690856916989
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.36684481284282
DONE TAKING  40  STEPS.
Total reward:  -631.9180939544306
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.614931408421437
DONE TAKING  40  STEPS.
Total reward:  -387.9449947456262
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.971958936191225
DONE TAKING  40  STEPS.
Total reward:  -256.088969014205
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.432513355628004
DONE TAKING  40  STEPS.
Total reward:  -278.4265287418878
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.252104572081386
DONE TAKING  40  STEPS.
Total reward:  -579.253923478993
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.967814479648954
DONE TAKING  40  STEPS.
Total reward:  -686.2106190836828
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.017648030313353
DONE TAKING  40  STEPS.
Total reward:  -862.2104841680865
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.742483577230512
DONE TAKING  40  STEPS.
Total reward:  -788.4947270109633
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.08971184346729
DONE TAKING  40  STEPS.
Total reward:  -487.31323139860893
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -12.817029390941418
DONE TAKING  40  STEPS.
Total reward:  -455.92826460785705
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.519193485020125
DONE TAKING  40  STEPS.
Total reward:  -606.1918555968668
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -11.02930777054011
DONE TAKING  40  STEPS.
Total reward:  -125.63911979883869
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.818559731549378
DONE TAKING  40  STEPS.
Total reward:  -482.1475201359616
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.799063380613557
DONE TAKING  40  STEPS.
Total reward:  -698.3425057808169
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.11187124294517
DONE TAKING  40  STEPS.
Total reward:  -221.55400258209156
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.237388075230133
DONE TAKING  40  STEPS.
Total reward:  -878.6436306384119
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.174171613020338
DONE TAKING  40  STEPS.
Total reward:  -667.6123999636127
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.076728624778237
DONE TAKING  40  STEPS.
Total reward:  -961.1146473202602
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.048678006601875
DONE TAKING  40  STEPS.
Total reward:  -1018.2220623353928
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.254164300122675
DONE TAKING  40  STEPS.
Total reward:  -546.5887390648709
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.393961591465903
DONE TAKING  40  STEPS.
Total reward:  -450.9952886535319
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -31.26218590138031
DONE TAKING  40  STEPS.
Total reward:  -660.8188781372569
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.39131327481317
DONE TAKING  40  STEPS.
Total reward:  -548.3822314503092
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter131.ckpt
Iter: 132
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  132
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  33540
On pol:  57600
Prob shape:  (91140,)

=== Epoch 0 ===
    train loss:  0.39876490881603754
    val rand:  0.28916752338409424
    val onPol:  0.39001700282096863

=== Epoch 10 ===
    train loss:  0.1496032358387883
    val rand:  0.18429593741893768
    val onPol:  0.3865660031636556

=== Epoch 20 ===
    train loss:  0.09121330572145708
    val rand:  0.17110267281532288
    val onPol:  0.4326904813448588

=== Epoch 30 ===
    train loss:  0.06915388861147875
    val rand:  0.16153189539909363
    val onPol:  0.45840126276016235

=== Epoch 39 ===
    train loss:  0.05846267513763369
    val rand:  0.16002939641475677
    val onPol:  0.4727258582909902
Training duration: 45.59 s

#####################################
performing on-policy MPC rollouts... iter  132
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -10.6143366497703
DONE TAKING  40  STEPS.
Total reward:  -338.04525897053577
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -17.999674903679445
DONE TAKING  40  STEPS.
Total reward:  -483.8742916525488
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -15.365723814030755
DONE TAKING  40  STEPS.
Total reward:  -862.0020309112025
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.39210463465797
DONE TAKING  40  STEPS.
Total reward:  -6.057339877961201
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.188259769826722
DONE TAKING  40  STEPS.
Total reward:  -662.7398367502948
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -15.701364305490106
DONE TAKING  40  STEPS.
Total reward:  -324.3159229194789
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.349931717837123
DONE TAKING  40  STEPS.
Total reward:  -711.1820224949421
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.056089941614527
DONE TAKING  40  STEPS.
Total reward:  -465.2007834890061
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -25.171156503423386
DONE TAKING  40  STEPS.
Total reward:  -733.9756347441614
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.057492039367899
DONE TAKING  40  STEPS.
Total reward:  -363.39683199597744
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.215719569447693
DONE TAKING  40  STEPS.
Total reward:  -743.4272231761488
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.35262760788231
DONE TAKING  40  STEPS.
Total reward:  -476.24297243668286
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.358802058975645
DONE TAKING  40  STEPS.
Total reward:  -347.5811970847006
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.130397961788468
DONE TAKING  40  STEPS.
Total reward:  -729.2538417551681
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.160140074180653
DONE TAKING  40  STEPS.
Total reward:  -206.90234305314618
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.245283145906072
DONE TAKING  40  STEPS.
Total reward:  -474.84417074359317
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -14.6548055059198
DONE TAKING  40  STEPS.
Total reward:  -542.4557678791543
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.70729487598892
DONE TAKING  40  STEPS.
Total reward:  -830.2050708410839
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.37743253368238
DONE TAKING  40  STEPS.
Total reward:  -509.8276167061057
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -10.752469635493952
DONE TAKING  40  STEPS.
Total reward:  -325.4717542896016
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -20.017775452051055
DONE TAKING  40  STEPS.
Total reward:  -975.5233960261058
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.90126684815187
DONE TAKING  40  STEPS.
Total reward:  -350.61742199767247
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.321477582898577
DONE TAKING  40  STEPS.
Total reward:  -883.85451491043
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.5550701992089
DONE TAKING  40  STEPS.
Total reward:  -644.0331367721284
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.503809402456664
DONE TAKING  40  STEPS.
Total reward:  -393.87046768461045
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.161163252949443
DONE TAKING  40  STEPS.
Total reward:  -942.1557630075272
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.451422135253605
DONE TAKING  40  STEPS.
Total reward:  -70.3388884392813
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.497521965647053
DONE TAKING  40  STEPS.
Total reward:  -688.8620834675154
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.899259233009317
DONE TAKING  40  STEPS.
Total reward:  -429.2282852599908
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.08668774906515
DONE TAKING  40  STEPS.
Total reward:  -812.6121885010713
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.93989278071215
DONE TAKING  40  STEPS.
Total reward:  -401.1888566090471
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.54039153232071
DONE TAKING  40  STEPS.
Total reward:  -462.86681831674923
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.66753177839598
DONE TAKING  40  STEPS.
Total reward:  -707.3880269833069
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -18.918287322151308
DONE TAKING  40  STEPS.
Total reward:  -223.7700215659093
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.845138980690034
DONE TAKING  40  STEPS.
Total reward:  -805.4684896466416
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.872634691915238
DONE TAKING  40  STEPS.
Total reward:  -157.7930034916037
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.296028895278763
DONE TAKING  40  STEPS.
Total reward:  -544.3971433723758
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.11154166710112
DONE TAKING  40  STEPS.
Total reward:  -558.4434506032411
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.606869565390436
DONE TAKING  40  STEPS.
Total reward:  -727.6200015087952
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.803516610487122
DONE TAKING  40  STEPS.
Total reward:  -410.9533969419144
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter132.ckpt
Iter: 133
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  133
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  33735
On pol:  57600
Prob shape:  (91335,)

=== Epoch 0 ===
    train loss:  0.40334664636783385
    val rand:  0.29793357849121094
    val onPol:  0.40237391988436383

=== Epoch 10 ===
    train loss:  0.15151843947640967
    val rand:  0.20120440423488617
    val onPol:  0.39945559700330097

=== Epoch 20 ===
    train loss:  0.09245159104466438
    val rand:  0.1747833788394928
    val onPol:  0.44724686940511066

=== Epoch 30 ===
    train loss:  0.07013978020110156
    val rand:  0.16040858626365662
    val onPol:  0.4734560549259186

=== Epoch 39 ===
    train loss:  0.059252151528771
    val rand:  0.15836144983768463
    val onPol:  0.49039238691329956
Training duration: 47.14 s

#####################################
performing on-policy MPC rollouts... iter  133
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.52764031025795
DONE TAKING  40  STEPS.
Total reward:  -84.30539804660557
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.345280950325897
DONE TAKING  40  STEPS.
Total reward:  -475.65685606513824
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -31.01887686168086
DONE TAKING  40  STEPS.
Total reward:  -809.7020983434136
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.523144212047242
DONE TAKING  40  STEPS.
Total reward:  -335.10930069489416
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.706680198693658
DONE TAKING  40  STEPS.
Total reward:  -386.83766671904533
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.620671201457178
DONE TAKING  40  STEPS.
Total reward:  -406.1823800467582
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.30021162310801
DONE TAKING  40  STEPS.
Total reward:  -1008.3720857771164
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -18.331074812564363
DONE TAKING  40  STEPS.
Total reward:  -466.5805334319738
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -13.50739990448069
DONE TAKING  40  STEPS.
Total reward:  -391.9088427862639
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.717330942777288
DONE TAKING  40  STEPS.
Total reward:  -795.5383377641604
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.068918977107902
DONE TAKING  40  STEPS.
Total reward:  -605.7728858573038
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.974293015342276
DONE TAKING  40  STEPS.
Total reward:  -298.9944267597806
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.482039730482246
DONE TAKING  40  STEPS.
Total reward:  -1108.18696755027
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.409844949788834
DONE TAKING  40  STEPS.
Total reward:  -894.3211744690395
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.670630984787607
DONE TAKING  40  STEPS.
Total reward:  -408.99991989928327
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.662501755476075
DONE TAKING  40  STEPS.
Total reward:  -591.7615524651825
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -21.311740244041495
DONE TAKING  40  STEPS.
Total reward:  -536.0141211502586
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.81494705602026
DONE TAKING  40  STEPS.
Total reward:  -283.72241675066346
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.85175507093153
DONE TAKING  40  STEPS.
Total reward:  -547.1646055348358
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.942072718052295
DONE TAKING  40  STEPS.
Total reward:  -188.83991930697232
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.307826609779095
DONE TAKING  40  STEPS.
Total reward:  -433.40259312867397
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.148357192842894
DONE TAKING  40  STEPS.
Total reward:  -617.9849395681895
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.48419405023221
DONE TAKING  40  STEPS.
Total reward:  -57.57775333647528
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -19.788447655221024
DONE TAKING  40  STEPS.
Total reward:  -813.6302508550973
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.12218572192924
DONE TAKING  40  STEPS.
Total reward:  -662.8228558321437
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.408472200860945
DONE TAKING  40  STEPS.
Total reward:  -840.1655862437418
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.617435518688495
DONE TAKING  40  STEPS.
Total reward:  -818.772261219532
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -22.898299944049356
DONE TAKING  40  STEPS.
Total reward:  -60.999723880566165
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -16.000642569533365
DONE TAKING  40  STEPS.
Total reward:  -410.62393132696343
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.073002985371815
DONE TAKING  40  STEPS.
Total reward:  -361.5172388312404
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.180689911182533
DONE TAKING  40  STEPS.
Total reward:  -556.784058064256
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.896082503904196
DONE TAKING  40  STEPS.
Total reward:  -642.9298183682877
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.647556678688982
DONE TAKING  40  STEPS.
Total reward:  97.64567581704686
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.13939565191053
DONE TAKING  40  STEPS.
Total reward:  -690.0724478609576
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.91859693225379
DONE TAKING  40  STEPS.
Total reward:  -956.0008454131074
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.02605648743908
DONE TAKING  40  STEPS.
Total reward:  -1025.558861688088
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.261643448572915
DONE TAKING  40  STEPS.
Total reward:  -377.26221254660203
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.6929845222559
DONE TAKING  40  STEPS.
Total reward:  -691.9754416179686
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.496265993695093
DONE TAKING  40  STEPS.
Total reward:  59.588266822319646
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.719389188385712
DONE TAKING  40  STEPS.
Total reward:  -582.1760198051504
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter133.ckpt
Iter: 134
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  134
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  33930
On pol:  57600
Prob shape:  (91530,)

=== Epoch 0 ===
    train loss:  0.39799461739786557
    val rand:  0.2908315658569336
    val onPol:  0.38891271750132245

=== Epoch 10 ===
    train loss:  0.14981855862261204
    val rand:  0.18544518947601318
    val onPol:  0.3817134002844493

=== Epoch 20 ===
    train loss:  0.09287002825000312
    val rand:  0.17016083002090454
    val onPol:  0.42697567741076153

=== Epoch 30 ===
    train loss:  0.07002028475484151
    val rand:  0.160237118601799
    val onPol:  0.453115979830424

=== Epoch 39 ===
    train loss:  0.059519826110159414
    val rand:  0.1564168781042099
    val onPol:  0.4678025245666504
Training duration: 44.86 s

#####################################
performing on-policy MPC rollouts... iter  134
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.100471687895723
DONE TAKING  40  STEPS.
Total reward:  -851.0855040271454
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.89210942225251
DONE TAKING  40  STEPS.
Total reward:  -204.67295378478767
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.16148229361605
DONE TAKING  40  STEPS.
Total reward:  -127.30778435662431
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.528345456314135
DONE TAKING  40  STEPS.
Total reward:  -185.0204164871913
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.330655511906158
DONE TAKING  40  STEPS.
Total reward:  57.36212511611219
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.885083265507802
DONE TAKING  40  STEPS.
Total reward:  -750.8351090722182
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.314619038961148
DONE TAKING  40  STEPS.
Total reward:  -232.53850091552448
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.800856425063095
DONE TAKING  40  STEPS.
Total reward:  -798.6901087155469
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.096588487132742
DONE TAKING  40  STEPS.
Total reward:  -977.1325492574538
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.79144340061428
DONE TAKING  40  STEPS.
Total reward:  -607.0592677422522
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.27822864412949
DONE TAKING  40  STEPS.
Total reward:  240.19313632043566
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.556867865319514
DONE TAKING  40  STEPS.
Total reward:  -137.19024119340742
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.214329675797142
DONE TAKING  40  STEPS.
Total reward:  -364.958706718125
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.87125659735753
DONE TAKING  40  STEPS.
Total reward:  -385.4257600162607
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -14.919329848594538
DONE TAKING  40  STEPS.
Total reward:  -620.0904401368374
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -21.999853292616397
DONE TAKING  40  STEPS.
Total reward:  -525.9092812478576
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.708623394040618
DONE TAKING  40  STEPS.
Total reward:  -520.277270199142
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.63489983408921
DONE TAKING  40  STEPS.
Total reward:  -502.7378652496197
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.415607949504803
DONE TAKING  40  STEPS.
Total reward:  -314.3054392353957
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.097462710628097
DONE TAKING  40  STEPS.
Total reward:  -617.304843052894
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.79883759701515
DONE TAKING  40  STEPS.
Total reward:  -252.762146893775
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -15.807701559380833
DONE TAKING  40  STEPS.
Total reward:  -486.7657179062472
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.998316668813768
DONE TAKING  40  STEPS.
Total reward:  -125.80483047138192
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.39429817621689
DONE TAKING  40  STEPS.
Total reward:  -510.9649292990088
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.790324109020062
DONE TAKING  40  STEPS.
Total reward:  -566.6326603621393
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.009678625083666
DONE TAKING  40  STEPS.
Total reward:  -340.31859884489273
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.98199853098245
DONE TAKING  40  STEPS.
Total reward:  63.3192922086599
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.5045416551346
DONE TAKING  40  STEPS.
Total reward:  -831.8030462836829
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.25385805175381
DONE TAKING  40  STEPS.
Total reward:  -457.680772364831
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.94356269169126
DONE TAKING  40  STEPS.
Total reward:  -1016.5612087605017
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.561290500346672
DONE TAKING  40  STEPS.
Total reward:  -684.1720759923883
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.578829466258227
DONE TAKING  40  STEPS.
Total reward:  -635.4907740330761
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.971296502888787
DONE TAKING  40  STEPS.
Total reward:  -798.0200972126901
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.082153227513956
DONE TAKING  40  STEPS.
Total reward:  -1019.0786269787317
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.889028529115745
DONE TAKING  40  STEPS.
Total reward:  -760.8545348776394
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -25.53925256510449
DONE TAKING  40  STEPS.
Total reward:  -414.6527861084303
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.40582180215656
DONE TAKING  40  STEPS.
Total reward:  -242.1416568037058
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.938371796875092
DONE TAKING  40  STEPS.
Total reward:  -1079.8328015319946
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.2863777092387
DONE TAKING  40  STEPS.
Total reward:  -868.412647789076
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.089020053672169
DONE TAKING  40  STEPS.
Total reward:  -363.1523461649414
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter134.ckpt
Iter: 135
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  135
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  34125
On pol:  57600
Prob shape:  (91725,)

=== Epoch 0 ===
    train loss:  0.40431420263631385
    val rand:  0.3029107451438904
    val onPol:  0.3934873441855113

=== Epoch 10 ===
    train loss:  0.149989967988856
    val rand:  0.18866753578186035
    val onPol:  0.387757142384847

=== Epoch 20 ===
    train loss:  0.09273401414715378
    val rand:  0.1724216192960739
    val onPol:  0.4360338548819224

=== Epoch 30 ===
    train loss:  0.07023519015345493
    val rand:  0.1601969450712204
    val onPol:  0.4623977740605672

=== Epoch 39 ===
    train loss:  0.05902879635215472
    val rand:  0.15660783648490906
    val onPol:  0.4744977355003357
Training duration: 47.30 s

#####################################
performing on-policy MPC rollouts... iter  135
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.056265374102146
DONE TAKING  40  STEPS.
Total reward:  -78.01076616179
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.56648400840486
DONE TAKING  40  STEPS.
Total reward:  -380.7200828837006
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.63933791259042
DONE TAKING  40  STEPS.
Total reward:  -593.3309179080528
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.167640610579568
DONE TAKING  40  STEPS.
Total reward:  -701.9471524961999
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.922524016177373
DONE TAKING  40  STEPS.
Total reward:  -451.4409594684398
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.3956162725022
DONE TAKING  40  STEPS.
Total reward:  -435.2721107376332
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.556385198445213
DONE TAKING  40  STEPS.
Total reward:  -317.0639529676519
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.01776811885438
DONE TAKING  40  STEPS.
Total reward:  -559.6040936918232
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.66250506697596
DONE TAKING  40  STEPS.
Total reward:  -429.2211213501851
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.57522423264505
DONE TAKING  40  STEPS.
Total reward:  -494.0631199361472
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.767831017455507
DONE TAKING  40  STEPS.
Total reward:  -389.8759411287978
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -13.655527677518432
DONE TAKING  40  STEPS.
Total reward:  -356.8150383687993
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.454778702277185
DONE TAKING  40  STEPS.
Total reward:  -845.5070738676319
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.586664576463978
DONE TAKING  40  STEPS.
Total reward:  -458.06428011651013
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.07600948749142
DONE TAKING  40  STEPS.
Total reward:  -472.4455774665713
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.847271184320125
DONE TAKING  40  STEPS.
Total reward:  -329.8188392353736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.112559448187323
DONE TAKING  40  STEPS.
Total reward:  -831.4697463257008
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.55919502104662
DONE TAKING  40  STEPS.
Total reward:  -663.7817488855519
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.773913522288844
DONE TAKING  40  STEPS.
Total reward:  -742.9546041374884
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.01381723857236
DONE TAKING  40  STEPS.
Total reward:  -303.74875814864157
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.351466537640643
DONE TAKING  40  STEPS.
Total reward:  -377.5538173867777
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.42094873118434
DONE TAKING  40  STEPS.
Total reward:  -831.1204960103847
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.290123789258814
DONE TAKING  40  STEPS.
Total reward:  -399.96844967571815
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.268557668773774
DONE TAKING  40  STEPS.
Total reward:  -904.7734562023463
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.933590896206614
DONE TAKING  40  STEPS.
Total reward:  -543.1509416360107
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.571862449293747
DONE TAKING  40  STEPS.
Total reward:  -561.9580934113627
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.028474290698746
DONE TAKING  40  STEPS.
Total reward:  -402.60053629651657
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.574467133613915
DONE TAKING  40  STEPS.
Total reward:  -567.9771185107328
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.554533844693616
DONE TAKING  40  STEPS.
Total reward:  -902.4079772426667
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.877953355765207
DONE TAKING  40  STEPS.
Total reward:  -405.6426779962742
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.695111013651164
DONE TAKING  40  STEPS.
Total reward:  -1000.0037376102928
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.36978383782499
DONE TAKING  40  STEPS.
Total reward:  -275.65249500708677
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.98843486051849
DONE TAKING  40  STEPS.
Total reward:  -743.933280589039
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -17.782077666981106
DONE TAKING  40  STEPS.
Total reward:  -304.7687497081269
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -13.727381880503696
DONE TAKING  40  STEPS.
Total reward:  194.75674613262612
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -12.140155610513276
DONE TAKING  40  STEPS.
Total reward:  -232.68714265080467
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.809269217861235
DONE TAKING  40  STEPS.
Total reward:  -620.3726533323372
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.739683896055702
DONE TAKING  40  STEPS.
Total reward:  -614.4765945040466
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -18.919880717176255
DONE TAKING  40  STEPS.
Total reward:  -558.8291993151614
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.798814494134735
DONE TAKING  40  STEPS.
Total reward:  51.00949908019167
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter135.ckpt
Iter: 136
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  136
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  34320
On pol:  57600
Prob shape:  (91920,)

=== Epoch 0 ===
    train loss:  0.40265513232300404
    val rand:  0.3017374873161316
    val onPol:  0.39130399624506634

=== Epoch 10 ===
    train loss:  0.15112987735084982
    val rand:  0.18618139624595642
    val onPol:  0.38286592562993366

=== Epoch 20 ===
    train loss:  0.09214261419779761
    val rand:  0.16539810597896576
    val onPol:  0.42724768320719403

=== Epoch 30 ===
    train loss:  0.07028651139672908
    val rand:  0.15811687707901
    val onPol:  0.4543781777222951

=== Epoch 39 ===
    train loss:  0.05947723916039786
    val rand:  0.1579189896583557
    val onPol:  0.4717220366001129
Training duration: 44.85 s

#####################################
performing on-policy MPC rollouts... iter  136
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.111806010286866
DONE TAKING  40  STEPS.
Total reward:  -305.8028650490317
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.69526085092661
DONE TAKING  40  STEPS.
Total reward:  -631.3372929813348
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.179908884450718
DONE TAKING  40  STEPS.
Total reward:  -661.6013874356773
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.874397037368325
DONE TAKING  40  STEPS.
Total reward:  -569.5616861207916
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.351903704966855
DONE TAKING  40  STEPS.
Total reward:  -374.79028736358237
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.790069809481757
DONE TAKING  40  STEPS.
Total reward:  -829.2404164335999
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.262885949675038
DONE TAKING  40  STEPS.
Total reward:  -852.4914930636202
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.849165201607896
DONE TAKING  40  STEPS.
Total reward:  -814.427407068344
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.641320482166368
DONE TAKING  40  STEPS.
Total reward:  -779.6550933562975
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.19672047847628
DONE TAKING  40  STEPS.
Total reward:  -850.8289188280205
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.954021098461595
DONE TAKING  40  STEPS.
Total reward:  -280.62711624878403
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.034320225598606
DONE TAKING  40  STEPS.
Total reward:  -869.5934139466324
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.294679451186298
DONE TAKING  40  STEPS.
Total reward:  -380.3868592859674
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.925037051161397
DONE TAKING  40  STEPS.
Total reward:  -695.3098122624027
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.759297786155619
DONE TAKING  40  STEPS.
Total reward:  -427.73807732572965
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.269757502615317
DONE TAKING  40  STEPS.
Total reward:  -695.2831222560249
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.628284825420515
DONE TAKING  40  STEPS.
Total reward:  -140.9272203495437
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.864774142593994
DONE TAKING  40  STEPS.
Total reward:  -1017.0642761465349
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.4270359436077
DONE TAKING  40  STEPS.
Total reward:  -675.7760724343399
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.27085523257164
DONE TAKING  40  STEPS.
Total reward:  -880.2534430289811
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -14.089459166515898
DONE TAKING  40  STEPS.
Total reward:  -368.2180994055806
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.387202895885583
DONE TAKING  40  STEPS.
Total reward:  -549.183821538986
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.246764212963306
DONE TAKING  40  STEPS.
Total reward:  -525.5719157772369
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.18402303936295
DONE TAKING  40  STEPS.
Total reward:  -327.30089489727703
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.572223060412057
DONE TAKING  40  STEPS.
Total reward:  -555.5853560397088
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.119809199695155
DONE TAKING  40  STEPS.
Total reward:  -518.6763838030765
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -13.381482796387667
DONE TAKING  40  STEPS.
Total reward:  -41.31094762682767
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.804735002033414
DONE TAKING  40  STEPS.
Total reward:  -549.9957908928519
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.339725393104388
DONE TAKING  40  STEPS.
Total reward:  -421.03928445988663
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.819703254222603
DONE TAKING  40  STEPS.
Total reward:  -368.32538647551553
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.537558561869787
DONE TAKING  40  STEPS.
Total reward:  -626.67808730521
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -19.300309657397122
DONE TAKING  40  STEPS.
Total reward:  -300.63060089276865
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.277938987629305
DONE TAKING  40  STEPS.
Total reward:  -936.5936311986771
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.652956013685365
DONE TAKING  40  STEPS.
Total reward:  -585.3139426409316
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.16313015196414
DONE TAKING  40  STEPS.
Total reward:  -314.07227252641053
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.503882249357833
DONE TAKING  40  STEPS.
Total reward:  -325.75494348087227
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.922245510747924
DONE TAKING  40  STEPS.
Total reward:  -386.58222753718894
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.879470605171296
DONE TAKING  40  STEPS.
Total reward:  3.2053699644367493
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.326849573925745
DONE TAKING  40  STEPS.
Total reward:  -709.6751637305429
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -9.986737384895466
DONE TAKING  40  STEPS.
Total reward:  -241.55676926073232
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter136.ckpt
Iter: 137
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  137
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  34515
On pol:  57600
Prob shape:  (92115,)

=== Epoch 0 ===
    train loss:  0.4046583400425298
    val rand:  0.2907857596874237
    val onPol:  0.3990310529867808

=== Epoch 10 ===
    train loss:  0.15392373735345274
    val rand:  0.1888982504606247
    val onPol:  0.38919251163800556

=== Epoch 20 ===
    train loss:  0.0947869197366624
    val rand:  0.16689389944076538
    val onPol:  0.43193408846855164

=== Epoch 30 ===
    train loss:  0.07193919246256684
    val rand:  0.1651764065027237
    val onPol:  0.45782386263211566

=== Epoch 39 ===
    train loss:  0.06060027909678454
    val rand:  0.15492933988571167
    val onPol:  0.47628700733184814
Training duration: 47.15 s

#####################################
performing on-policy MPC rollouts... iter  137
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.174341906461194
DONE TAKING  40  STEPS.
Total reward:  -156.82234771288137
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -10.20994379073553
DONE TAKING  40  STEPS.
Total reward:  -346.3397774744525
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.129187372611582
DONE TAKING  40  STEPS.
Total reward:  -594.6365016112753
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.296878527293515
DONE TAKING  40  STEPS.
Total reward:  -793.6229726281049
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.238141035805356
DONE TAKING  40  STEPS.
Total reward:  -535.7729941752239
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.62573641259169
DONE TAKING  40  STEPS.
Total reward:  -116.36168277229741
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.253090781045948
DONE TAKING  40  STEPS.
Total reward:  -478.9453257174554
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.097460383826984
DONE TAKING  40  STEPS.
Total reward:  -690.982104772363
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.823575028623452
DONE TAKING  40  STEPS.
Total reward:  -617.0123181631541
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.612065467461463
DONE TAKING  40  STEPS.
Total reward:  -802.3437519387575
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.86818032275278
DONE TAKING  40  STEPS.
Total reward:  -511.0528429860575
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.039182431347072
DONE TAKING  40  STEPS.
Total reward:  -610.7161382109736
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.90083651843162
DONE TAKING  40  STEPS.
Total reward:  -718.3644082555497
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.1711763910634
DONE TAKING  40  STEPS.
Total reward:  -88.9612230815737
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.771703659407013
DONE TAKING  40  STEPS.
Total reward:  -640.0646149780073
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.78777078680743
DONE TAKING  40  STEPS.
Total reward:  -931.9782051572719
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.180900111246036
DONE TAKING  40  STEPS.
Total reward:  -593.7061068801012
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.65520788399257
DONE TAKING  40  STEPS.
Total reward:  -414.98687874307797
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.811408760766042
DONE TAKING  40  STEPS.
Total reward:  -574.9201072064485
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.99901947840487
DONE TAKING  40  STEPS.
Total reward:  -924.3254626327563
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.194318970485366
DONE TAKING  40  STEPS.
Total reward:  -28.87910298154167
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.51415729559805
DONE TAKING  40  STEPS.
Total reward:  -579.2363062886483
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.595666338596985
DONE TAKING  40  STEPS.
Total reward:  -605.5845481247361
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.820221836610541
DONE TAKING  40  STEPS.
Total reward:  -345.5355414691106
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.238642968690357
DONE TAKING  40  STEPS.
Total reward:  -932.380499936224
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.71943322552864
DONE TAKING  40  STEPS.
Total reward:  -600.2074689863322
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.824328204052208
DONE TAKING  40  STEPS.
Total reward:  -502.51424720235303
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.221411148941705
DONE TAKING  40  STEPS.
Total reward:  -751.3841571863863
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -19.186241307997733
DONE TAKING  40  STEPS.
Total reward:  -331.6815279129322
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.833669020715412
DONE TAKING  40  STEPS.
Total reward:  -525.1887513853951
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.72999509055548
DONE TAKING  40  STEPS.
Total reward:  -939.1716335308269
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.099295824549415
DONE TAKING  40  STEPS.
Total reward:  -722.1747433353371
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -13.791751358635072
DONE TAKING  40  STEPS.
Total reward:  -389.7482093873299
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.632056401502414
DONE TAKING  40  STEPS.
Total reward:  -535.4610145236268
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.149209035732355
DONE TAKING  40  STEPS.
Total reward:  -482.13440843538484
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -13.574925154069867
DONE TAKING  40  STEPS.
Total reward:  -405.4807889005712
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.652406821478863
DONE TAKING  40  STEPS.
Total reward:  -491.03182977695184
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.29537381041952
DONE TAKING  40  STEPS.
Total reward:  -700.2501105640305
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.994155445119446
DONE TAKING  40  STEPS.
Total reward:  -932.5812762260585
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.863212248621757
DONE TAKING  40  STEPS.
Total reward:  -972.9537005907616
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter137.ckpt
Iter: 138
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  138
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  34710
On pol:  57600
Prob shape:  (92310,)

=== Epoch 0 ===
    train loss:  0.39954723053508334
    val rand:  0.2863491177558899
    val onPol:  0.3897852102915446

=== Epoch 10 ===
    train loss:  0.1522718071937561
    val rand:  0.18423819541931152
    val onPol:  0.3874645431836446

=== Epoch 20 ===
    train loss:  0.09345421973201963
    val rand:  0.16851483285427094
    val onPol:  0.43307029207547504

=== Epoch 30 ===
    train loss:  0.07061046107361714
    val rand:  0.15898925065994263
    val onPol:  0.45805557568868

=== Epoch 39 ===
    train loss:  0.05998966203381618
    val rand:  0.15694555640220642
    val onPol:  0.47236143549283344
Training duration: 23.64 s

#####################################
performing on-policy MPC rollouts... iter  138
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.068159263700682
DONE TAKING  40  STEPS.
Total reward:  -319.13366130305326
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -13.081862945410869
DONE TAKING  40  STEPS.
Total reward:  -419.4750847989187
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.29512971975568
DONE TAKING  40  STEPS.
Total reward:  -518.826053769677
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.909188215554217
DONE TAKING  40  STEPS.
Total reward:  -152.61309033740014
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.7997284903442
DONE TAKING  40  STEPS.
Total reward:  -1220.254976818285
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.375131608560242
DONE TAKING  40  STEPS.
Total reward:  -404.8150355483486
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.909968460264803
DONE TAKING  40  STEPS.
Total reward:  -657.171485562495
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -13.462345004923934
DONE TAKING  40  STEPS.
Total reward:  -395.2310066870156
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.69513369785099
DONE TAKING  40  STEPS.
Total reward:  -900.6852026493326
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.75475545110194
DONE TAKING  40  STEPS.
Total reward:  -425.4580439066707
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.69163734955733
DONE TAKING  40  STEPS.
Total reward:  -788.1593407258638
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.158805285300808
DONE TAKING  40  STEPS.
Total reward:  -959.8327635686854
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.667563454906833
DONE TAKING  40  STEPS.
Total reward:  -921.6376235678684
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.155769222414232
DONE TAKING  40  STEPS.
Total reward:  -326.2541865618126
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.671925427722915
DONE TAKING  40  STEPS.
Total reward:  -418.2063222497663
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.33214375546668
DONE TAKING  40  STEPS.
Total reward:  -630.456705304164
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.277467426557138
DONE TAKING  40  STEPS.
Total reward:  -628.7132162457285
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.55879587942421
DONE TAKING  40  STEPS.
Total reward:  -711.333393367782
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.87810575517593
DONE TAKING  40  STEPS.
Total reward:  -321.66144850952026
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.55841709232552
DONE TAKING  40  STEPS.
Total reward:  -619.6078138819072
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.10681508289141
DONE TAKING  40  STEPS.
Total reward:  -300.49332299344843
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.63421474128265
DONE TAKING  40  STEPS.
Total reward:  -77.95861877663914
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -16.114166370670997
DONE TAKING  40  STEPS.
Total reward:  -405.48343041719176
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.10961819470461
DONE TAKING  40  STEPS.
Total reward:  -730.8937929638957
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.09693195704903
DONE TAKING  40  STEPS.
Total reward:  -427.86036890598297
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.465141987963015
DONE TAKING  40  STEPS.
Total reward:  -463.24411717700696
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.32745999321822
DONE TAKING  40  STEPS.
Total reward:  -748.182128895344
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -15.380318609490857
DONE TAKING  40  STEPS.
Total reward:  -316.97095536911615
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.046498460962795
DONE TAKING  40  STEPS.
Total reward:  -583.4327883334175
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.38855294012469
DONE TAKING  40  STEPS.
Total reward:  -497.46361385239317
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.657867983772327
DONE TAKING  40  STEPS.
Total reward:  -417.34440383480313
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.530471276619288
DONE TAKING  40  STEPS.
Total reward:  -172.17046099682523
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.33037753865768
DONE TAKING  40  STEPS.
Total reward:  -426.7504684867702
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -29.543607642223108
DONE TAKING  40  STEPS.
Total reward:  -709.9440204340765
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.231184560720273
DONE TAKING  40  STEPS.
Total reward:  -1053.0137187490018
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.39660587037823
DONE TAKING  40  STEPS.
Total reward:  -257.97714387680975
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -14.609948395462329
DONE TAKING  40  STEPS.
Total reward:  -385.89639240068396
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.00901279205431
DONE TAKING  40  STEPS.
Total reward:  -319.56987098682356
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.33614096075018
DONE TAKING  40  STEPS.
Total reward:  -571.9572434483191
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -31.169259423971244
DONE TAKING  40  STEPS.
Total reward:  -578.3222352471206
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter138.ckpt
Iter: 139
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  139
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  34905
On pol:  57600
Prob shape:  (92505,)

=== Epoch 0 ===
    train loss:  0.40333163870705496
    val rand:  0.2950073778629303
    val onPol:  0.3872106075286865

=== Epoch 10 ===
    train loss:  0.15271625849935744
    val rand:  0.188992440700531
    val onPol:  0.37696877121925354

=== Epoch 20 ===
    train loss:  0.09437370022965802
    val rand:  0.16378431022167206
    val onPol:  0.4234172503153483

=== Epoch 30 ===
    train loss:  0.07210431239671178
    val rand:  0.15961530804634094
    val onPol:  0.44762226939201355

=== Epoch 39 ===
    train loss:  0.06097023830645614
    val rand:  0.15570050477981567
    val onPol:  0.46535271406173706
Training duration: 47.36 s

#####################################
performing on-policy MPC rollouts... iter  139
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -12.199895859618163
DONE TAKING  40  STEPS.
Total reward:  -452.7733690291222
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.398537501788024
DONE TAKING  40  STEPS.
Total reward:  -574.8587103601997
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.947226419716674
DONE TAKING  40  STEPS.
Total reward:  -1040.4982405953228
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.72555096874605
DONE TAKING  40  STEPS.
Total reward:  -855.564572466028
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.278064704145052
DONE TAKING  40  STEPS.
Total reward:  -567.0810091687346
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.516024055706023
DONE TAKING  40  STEPS.
Total reward:  -509.7491021591025
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.037147596614517
DONE TAKING  40  STEPS.
Total reward:  -654.9063431142757
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.13847701518315
DONE TAKING  40  STEPS.
Total reward:  -853.3198188571932
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.458419081106275
DONE TAKING  40  STEPS.
Total reward:  -617.8326270474352
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.863581706355045
DONE TAKING  40  STEPS.
Total reward:  -683.2164401351251
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -14.64789290963547
DONE TAKING  40  STEPS.
Total reward:  -28.096137357793822
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.047591745345787
DONE TAKING  40  STEPS.
Total reward:  -431.1151157873377
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -8.854318924593295
DONE TAKING  40  STEPS.
Total reward:  257.2462407814952
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.903374505563672
DONE TAKING  40  STEPS.
Total reward:  -426.27251333147495
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -10.80677536853088
DONE TAKING  40  STEPS.
Total reward:  111.23400089849272
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.292749942482217
DONE TAKING  40  STEPS.
Total reward:  -925.0000429631342
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.906484179044256
DONE TAKING  40  STEPS.
Total reward:  -856.5849764628979
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.70851728298249
DONE TAKING  40  STEPS.
Total reward:  -725.528694530604
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.574872249761082
DONE TAKING  40  STEPS.
Total reward:  -788.3830029304085
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.54946786460477
DONE TAKING  40  STEPS.
Total reward:  -775.5335945890936
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.29105784612815
DONE TAKING  40  STEPS.
Total reward:  -253.5140832462844
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.934034858857956
DONE TAKING  40  STEPS.
Total reward:  -608.134370449931
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.23175189729716
DONE TAKING  40  STEPS.
Total reward:  -719.1841041673094
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.129687332242572
DONE TAKING  40  STEPS.
Total reward:  -259.0450192143927
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.289676175866816
DONE TAKING  40  STEPS.
Total reward:  -644.4434311770866
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.021373106286823
DONE TAKING  40  STEPS.
Total reward:  -505.02062136783195
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.86070404017687
DONE TAKING  40  STEPS.
Total reward:  -432.69886290647264
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.562219111579278
DONE TAKING  40  STEPS.
Total reward:  67.8719766183037
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.991282615453546
DONE TAKING  40  STEPS.
Total reward:  -438.7306783746555
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.886927145340422
DONE TAKING  40  STEPS.
Total reward:  -852.9148375102142
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.034524706287506
DONE TAKING  40  STEPS.
Total reward:  -918.5857895539172
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.71161550070707
DONE TAKING  40  STEPS.
Total reward:  -863.5067795523889
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.969457438371236
DONE TAKING  40  STEPS.
Total reward:  -733.024909512462
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.88140439184067
DONE TAKING  40  STEPS.
Total reward:  -1.6536151429816215
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.93980896961662
DONE TAKING  40  STEPS.
Total reward:  -578.5748529800435
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -25.179578892707006
DONE TAKING  40  STEPS.
Total reward:  -350.03151648014085
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.600877999201664
DONE TAKING  40  STEPS.
Total reward:  -1121.2669351643829
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.30474728740898
DONE TAKING  40  STEPS.
Total reward:  -656.6797039628168
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.52350332974291
DONE TAKING  40  STEPS.
Total reward:  -757.2335375629691
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.486432974876813
DONE TAKING  40  STEPS.
Total reward:  -793.3781703256517
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter139.ckpt
Iter: 140
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  140
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  35100
On pol:  57600
Prob shape:  (92700,)

=== Epoch 0 ===
    train loss:  0.39999439209205667
    val rand:  0.29216131567955017
    val onPol:  0.3777867257595062

=== Epoch 10 ===
    train loss:  0.1524040505537012
    val rand:  0.191043421626091
    val onPol:  0.35984734694163006

=== Epoch 20 ===
    train loss:  0.09459483166590579
    val rand:  0.1693783849477768
    val onPol:  0.40694459279378253

=== Epoch 30 ===
    train loss:  0.07238513070740094
    val rand:  0.16533443331718445
    val onPol:  0.43125508228937787

=== Epoch 39 ===
    train loss:  0.060715934745349934
    val rand:  0.15724556148052216
    val onPol:  0.4451078474521637
Training duration: 47.83 s

#####################################
performing on-policy MPC rollouts... iter  140
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.488986652318008
DONE TAKING  40  STEPS.
Total reward:  -918.9868670942848
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.99844178171914
DONE TAKING  40  STEPS.
Total reward:  -489.96775747055824
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.15670191374797
DONE TAKING  40  STEPS.
Total reward:  -702.9219956154715
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.60741643980389
DONE TAKING  40  STEPS.
Total reward:  -759.7162069873256
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.63042604377692
DONE TAKING  40  STEPS.
Total reward:  -346.1889786322167
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.10598042583249
DONE TAKING  40  STEPS.
Total reward:  -582.1319728452071
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.532615081687624
DONE TAKING  40  STEPS.
Total reward:  -511.38228834140165
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.51591390712504
DONE TAKING  40  STEPS.
Total reward:  -673.9368225310341
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -13.265749168468625
DONE TAKING  40  STEPS.
Total reward:  14.014603833474817
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.753637264061275
DONE TAKING  40  STEPS.
Total reward:  -471.61825827207235
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.969194437711437
DONE TAKING  40  STEPS.
Total reward:  -774.5906520144143
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.97668240651643
DONE TAKING  40  STEPS.
Total reward:  -753.4066252935054
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -8.448396968048627
DONE TAKING  40  STEPS.
Total reward:  -296.02159053789194
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.627673451978698
DONE TAKING  40  STEPS.
Total reward:  -720.644622850044
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -14.050942657775838
DONE TAKING  40  STEPS.
Total reward:  -168.51873969893649
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.116363551044948
DONE TAKING  40  STEPS.
Total reward:  21.991533564426945
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.24907900286895
DONE TAKING  40  STEPS.
Total reward:  -972.5126292857982
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -12.256407836995542
DONE TAKING  40  STEPS.
Total reward:  -367.5755977580193
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.093671079883794
DONE TAKING  40  STEPS.
Total reward:  -438.45627695019425
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.883171976318433
DONE TAKING  40  STEPS.
Total reward:  -530.1322609231026
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.679285129356654
DONE TAKING  40  STEPS.
Total reward:  -534.4850524411817
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.781976965148306
DONE TAKING  40  STEPS.
Total reward:  -745.3648065946877
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.521847819120552
DONE TAKING  40  STEPS.
Total reward:  -725.4930441724871
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.886908348746324
DONE TAKING  40  STEPS.
Total reward:  -524.014966973713
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.793271276123996
DONE TAKING  40  STEPS.
Total reward:  -597.0354969444528
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.273239898552923
DONE TAKING  40  STEPS.
Total reward:  -402.479734411178
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -16.488194389392767
DONE TAKING  40  STEPS.
Total reward:  -457.30235585689474
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.9591971231384
DONE TAKING  40  STEPS.
Total reward:  -504.5102148511858
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.8721504664041
DONE TAKING  40  STEPS.
Total reward:  -790.4506595329786
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.4048395041549
DONE TAKING  40  STEPS.
Total reward:  -705.6373940540523
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.806504457518752
DONE TAKING  40  STEPS.
Total reward:  -535.593438793202
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.364776908523606
DONE TAKING  40  STEPS.
Total reward:  -996.9796244143732
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.582222772594765
DONE TAKING  40  STEPS.
Total reward:  -194.21249804886844
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.094259743011122
DONE TAKING  40  STEPS.
Total reward:  -508.02505155525853
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.36762984042354
DONE TAKING  40  STEPS.
Total reward:  -795.7821516927395
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.912898528859117
DONE TAKING  40  STEPS.
Total reward:  -770.1305693625382
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.932487316965465
DONE TAKING  40  STEPS.
Total reward:  -439.7945760114241
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.806790063120662
DONE TAKING  40  STEPS.
Total reward:  -566.2093880902916
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.9606641102721
DONE TAKING  40  STEPS.
Total reward:  -632.1676893098276
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.153881372058734
DONE TAKING  40  STEPS.
Total reward:  -635.1524317704561
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter140.ckpt
Iter: 141
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  141
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  35295
On pol:  57600
Prob shape:  (92895,)

=== Epoch 0 ===
    train loss:  0.39867803635518195
    val rand:  0.2948862314224243
    val onPol:  0.38201627135276794

=== Epoch 10 ===
    train loss:  0.15116189263802207
    val rand:  0.19162891805171967
    val onPol:  0.37274450063705444

=== Epoch 20 ===
    train loss:  0.09408309841682898
    val rand:  0.1705201119184494
    val onPol:  0.41907331347465515

=== Epoch 30 ===
    train loss:  0.07173157479222966
    val rand:  0.16197949647903442
    val onPol:  0.4465801914532979

=== Epoch 39 ===
    train loss:  0.059923755612162594
    val rand:  0.15400254726409912
    val onPol:  0.46423035860061646
Training duration: 47.75 s

#####################################
performing on-policy MPC rollouts... iter  141
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -21.94805194017969
DONE TAKING  40  STEPS.
Total reward:  -222.69184469721242
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.097971603936138
DONE TAKING  40  STEPS.
Total reward:  -763.1374453042615
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -26.170901704630033
DONE TAKING  40  STEPS.
Total reward:  -598.1217850352539
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.86937080960898
DONE TAKING  40  STEPS.
Total reward:  75.46806227534333
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.383315446091995
DONE TAKING  40  STEPS.
Total reward:  -731.5836752909439
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.470968393647492
DONE TAKING  40  STEPS.
Total reward:  -1139.1153298229558
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.993130408139137
DONE TAKING  40  STEPS.
Total reward:  -562.450448874519
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.543415987582108
DONE TAKING  40  STEPS.
Total reward:  -263.53290455470926
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.3433463756664
DONE TAKING  40  STEPS.
Total reward:  -154.89069355801522
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.813336684931937
DONE TAKING  40  STEPS.
Total reward:  -656.8179787700708
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.288550254587975
DONE TAKING  40  STEPS.
Total reward:  -698.0941298375278
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -11.34747270724765
DONE TAKING  40  STEPS.
Total reward:  82.47374843473257
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.709204394246342
DONE TAKING  40  STEPS.
Total reward:  -850.1868245545526
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.811678876920404
DONE TAKING  40  STEPS.
Total reward:  -191.20835394628395
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.137435569536144
DONE TAKING  40  STEPS.
Total reward:  117.44484613606579
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.583435407921076
DONE TAKING  40  STEPS.
Total reward:  -789.5841871988864
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.58587796869388
DONE TAKING  40  STEPS.
Total reward:  -652.3158246566776
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.35570324765159
DONE TAKING  40  STEPS.
Total reward:  -577.5655036552175
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.311150250808598
DONE TAKING  40  STEPS.
Total reward:  -241.94568584950375
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.448692542218353
DONE TAKING  40  STEPS.
Total reward:  -562.1176013650738
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.375609570059602
DONE TAKING  40  STEPS.
Total reward:  -562.47946206259
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.402252730311332
DONE TAKING  40  STEPS.
Total reward:  -195.74533200016657
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -31.326219090454252
DONE TAKING  40  STEPS.
Total reward:  -743.0691643039161
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.872079261839957
DONE TAKING  40  STEPS.
Total reward:  -422.739348260094
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.357230329849422
DONE TAKING  40  STEPS.
Total reward:  -660.7553296080472
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.968096928920538
DONE TAKING  40  STEPS.
Total reward:  -868.395129511386
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.778478238895573
DONE TAKING  40  STEPS.
Total reward:  -1002.2070183954115
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.098929541272884
DONE TAKING  40  STEPS.
Total reward:  -222.54145395308865
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.84426820024555
DONE TAKING  40  STEPS.
Total reward:  -638.1908011610066
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.279601616405586
DONE TAKING  40  STEPS.
Total reward:  -338.6769640249338
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.14973280173052
DONE TAKING  40  STEPS.
Total reward:  100.66682254676427
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.632179562330272
DONE TAKING  40  STEPS.
Total reward:  -711.8729601789436
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.675833606907158
DONE TAKING  40  STEPS.
Total reward:  -401.8292072365447
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.032623563762698
DONE TAKING  40  STEPS.
Total reward:  -644.3180947632841
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.87864894151573
DONE TAKING  40  STEPS.
Total reward:  -260.64035990029805
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.295134299650034
DONE TAKING  40  STEPS.
Total reward:  -452.2954058567818
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.251739175404808
DONE TAKING  40  STEPS.
Total reward:  -599.2088498873914
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.298991575918443
DONE TAKING  40  STEPS.
Total reward:  -525.2851666174666
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.680630924907703
DONE TAKING  40  STEPS.
Total reward:  -605.6919951049448
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -25.869805906125734
DONE TAKING  40  STEPS.
Total reward:  -319.6675586235701
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter141.ckpt
Iter: 142
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  142
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  35490
On pol:  57600
Prob shape:  (93090,)

=== Epoch 0 ===
    train loss:  0.3987963349450359
    val rand:  0.28599295020103455
    val onPol:  0.3771470884482066

=== Epoch 10 ===
    train loss:  0.15323903810912073
    val rand:  0.1897628903388977
    val onPol:  0.3667600353558858

=== Epoch 20 ===
    train loss:  0.09522461821196487
    val rand:  0.1662449836730957
    val onPol:  0.4080430865287781

=== Epoch 30 ===
    train loss:  0.0723154419693499
    val rand:  0.15841172635555267
    val onPol:  0.439040740331014

=== Epoch 39 ===
    train loss:  0.06152667343945793
    val rand:  0.15562894940376282
    val onPol:  0.4469504952430725
Training duration: 47.64 s

#####################################
performing on-policy MPC rollouts... iter  142
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -11.962651177557566
DONE TAKING  40  STEPS.
Total reward:  -453.93320333939806
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.95790818246035
DONE TAKING  40  STEPS.
Total reward:  -886.7669285572443
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.58517027886687
DONE TAKING  40  STEPS.
Total reward:  -236.47899140540318
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.469607693416968
DONE TAKING  40  STEPS.
Total reward:  -414.12606261719026
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.371671140787022
DONE TAKING  40  STEPS.
Total reward:  -626.3984602904766
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.677462150701444
DONE TAKING  40  STEPS.
Total reward:  -198.8593602802893
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.805674648522498
DONE TAKING  40  STEPS.
Total reward:  -125.61090869266124
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.211487413030547
DONE TAKING  40  STEPS.
Total reward:  -838.826392607818
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -25.116965111768774
DONE TAKING  40  STEPS.
Total reward:  -669.3263586186815
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.46717121373664
DONE TAKING  40  STEPS.
Total reward:  -762.4557574143713
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.956591357310216
DONE TAKING  40  STEPS.
Total reward:  -860.0300224401445
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -12.266315005328305
DONE TAKING  40  STEPS.
Total reward:  -189.53374860361643
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -13.952311361038321
DONE TAKING  40  STEPS.
Total reward:  -280.24211389215753
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.724787628079376
DONE TAKING  40  STEPS.
Total reward:  -1026.117897357605
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.75415822074102
DONE TAKING  40  STEPS.
Total reward:  -990.8961814992047
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.65744997562777
DONE TAKING  40  STEPS.
Total reward:  -303.791396901936
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.26905308751661
DONE TAKING  40  STEPS.
Total reward:  -608.9188060862164
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.525243594802248
DONE TAKING  40  STEPS.
Total reward:  -1027.102649881991
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.57213237857953
DONE TAKING  40  STEPS.
Total reward:  -564.3468862092521
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.938802570537845
DONE TAKING  40  STEPS.
Total reward:  -534.3356563149639
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.03838910819954
DONE TAKING  40  STEPS.
Total reward:  -1073.341878816815
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.29187660478465
DONE TAKING  40  STEPS.
Total reward:  -766.7745441351954
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.45075449285999
DONE TAKING  40  STEPS.
Total reward:  -21.27329753043343
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.780704455444962
DONE TAKING  40  STEPS.
Total reward:  -496.7638511547392
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.569651676960476
DONE TAKING  40  STEPS.
Total reward:  -606.8437838538626
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.07129433841314
DONE TAKING  40  STEPS.
Total reward:  -980.3747552436178
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.618318779429952
DONE TAKING  40  STEPS.
Total reward:  156.60250977008673
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -17.24846867855903
DONE TAKING  40  STEPS.
Total reward:  -577.1541411764626
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.820967981040166
DONE TAKING  40  STEPS.
Total reward:  -620.9182032037069
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.85416051437548
DONE TAKING  40  STEPS.
Total reward:  -988.3252136751536
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.117372155042776
DONE TAKING  40  STEPS.
Total reward:  -616.1214902815921
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.38039181670231
DONE TAKING  40  STEPS.
Total reward:  -297.6195095598821
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.580928619629127
DONE TAKING  40  STEPS.
Total reward:  -481.33358433056344
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.901210971723827
DONE TAKING  40  STEPS.
Total reward:  -671.6845401660282
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.44098354927179
DONE TAKING  40  STEPS.
Total reward:  -653.9187131786049
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.189838447054164
DONE TAKING  40  STEPS.
Total reward:  -828.546777351463
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.193080975094293
DONE TAKING  40  STEPS.
Total reward:  -401.6098738197934
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -17.340268882250975
DONE TAKING  40  STEPS.
Total reward:  -566.313931672549
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.492720572522515
DONE TAKING  40  STEPS.
Total reward:  -648.684562446341
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.81979658230996
DONE TAKING  40  STEPS.
Total reward:  -292.445686537357
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter142.ckpt
Iter: 143
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  143
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  35685
On pol:  57600
Prob shape:  (93285,)

=== Epoch 0 ===
    train loss:  0.3942757925161949
    val rand:  0.29189300537109375
    val onPol:  0.3800962766011556

=== Epoch 10 ===
    train loss:  0.15056711427130542
    val rand:  0.19089387357234955
    val onPol:  0.3638412853082021

=== Epoch 20 ===
    train loss:  0.09436110783736784
    val rand:  0.16902172565460205
    val onPol:  0.41027823090553284

=== Epoch 30 ===
    train loss:  0.07192813224353634
    val rand:  0.1609751582145691
    val onPol:  0.43897626797358197

=== Epoch 39 ===
    train loss:  0.06160812188390192
    val rand:  0.15647324919700623
    val onPol:  0.4509725073973338
Training duration: 47.99 s

#####################################
performing on-policy MPC rollouts... iter  143
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.697028634225536
DONE TAKING  40  STEPS.
Total reward:  246.0023947892038
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.471900062651006
DONE TAKING  40  STEPS.
Total reward:  -756.67821961852
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.88838265211268
DONE TAKING  40  STEPS.
Total reward:  -563.284512426517
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.815567054117732
DONE TAKING  40  STEPS.
Total reward:  -475.41309769923436
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.393448889409616
DONE TAKING  40  STEPS.
Total reward:  -585.9364508723004
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.021204068108794
DONE TAKING  40  STEPS.
Total reward:  -741.0335561605694
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.345415715315376
DONE TAKING  40  STEPS.
Total reward:  -381.9480148066378
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.343502548764498
DONE TAKING  40  STEPS.
Total reward:  -395.105706879641
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.53466737163128
DONE TAKING  40  STEPS.
Total reward:  -665.6473648537059
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.93557407338661
DONE TAKING  40  STEPS.
Total reward:  -745.6282807460959
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -11.497118346777391
DONE TAKING  40  STEPS.
Total reward:  -333.16719508130416
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -15.280198674643673
DONE TAKING  40  STEPS.
Total reward:  -17.903292264314995
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.59066127190297
DONE TAKING  40  STEPS.
Total reward:  -876.0700544249679
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -15.386263509048643
DONE TAKING  40  STEPS.
Total reward:  -474.61466935351547
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.427992834444265
DONE TAKING  40  STEPS.
Total reward:  -613.5544403885782
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.677289157959674
DONE TAKING  40  STEPS.
Total reward:  -374.16491559172397
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.48931658717719
DONE TAKING  40  STEPS.
Total reward:  -354.9924982069903
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.533868507517077
DONE TAKING  40  STEPS.
Total reward:  -549.2877892505988
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.564285274825338
DONE TAKING  40  STEPS.
Total reward:  -501.4691063030007
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.633866394937694
DONE TAKING  40  STEPS.
Total reward:  -429.0378719286629
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.467043061218604
DONE TAKING  40  STEPS.
Total reward:  -543.4032334343802
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.93805801199704
DONE TAKING  40  STEPS.
Total reward:  -1024.3067715148293
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.101878965818674
DONE TAKING  40  STEPS.
Total reward:  -477.98815861314216
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.921599313881117
DONE TAKING  40  STEPS.
Total reward:  -655.3774286961827
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -11.224671393479138
DONE TAKING  40  STEPS.
Total reward:  -392.79143467630945
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.758012274415712
DONE TAKING  40  STEPS.
Total reward:  -493.7974299998583
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.777535338988876
DONE TAKING  40  STEPS.
Total reward:  -475.6490329844168
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -17.43672976551284
DONE TAKING  40  STEPS.
Total reward:  -519.6427036647297
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.118489935656186
DONE TAKING  40  STEPS.
Total reward:  -534.4441288853486
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.017824150027053
DONE TAKING  40  STEPS.
Total reward:  -514.8329378410366
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -31.22659588919886
DONE TAKING  40  STEPS.
Total reward:  -539.3866901944099
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.466129655870407
DONE TAKING  40  STEPS.
Total reward:  -434.01045334550946
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.861605755253176
DONE TAKING  40  STEPS.
Total reward:  -787.6915516980215
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -13.349043558735092
DONE TAKING  40  STEPS.
Total reward:  -68.71133035812947
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.874561657032316
DONE TAKING  40  STEPS.
Total reward:  -476.8949248883594
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.660255326774948
DONE TAKING  40  STEPS.
Total reward:  -693.527495948449
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.58009486606512
DONE TAKING  40  STEPS.
Total reward:  -844.4226390812805
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.641695027655377
DONE TAKING  40  STEPS.
Total reward:  -382.10123428037497
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.100848967834345
DONE TAKING  40  STEPS.
Total reward:  -833.7268625901846
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.745379432359925
DONE TAKING  40  STEPS.
Total reward:  -750.6418107913406
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter143.ckpt
Iter: 144
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  144
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  35880
On pol:  57600
Prob shape:  (93480,)

=== Epoch 0 ===
    train loss:  0.39413711919889344
    val rand:  0.28861331939697266
    val onPol:  0.38166671991348267

=== Epoch 10 ===
    train loss:  0.14928802102804184
    val rand:  0.18771180510520935
    val onPol:  0.368748406569163

=== Epoch 20 ===
    train loss:  0.09193559216110261
    val rand:  0.16459186375141144
    val onPol:  0.40878428022066754

=== Epoch 30 ===
    train loss:  0.06961528821797161
    val rand:  0.15660759806632996
    val onPol:  0.4354487458864848

=== Epoch 39 ===
    train loss:  0.05937175180476446
    val rand:  0.1547306776046753
    val onPol:  0.44959067304929096
Training duration: 47.96 s

#####################################
performing on-policy MPC rollouts... iter  144
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.113092471265013
DONE TAKING  40  STEPS.
Total reward:  -788.5546222338262
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.231047217070213
DONE TAKING  40  STEPS.
Total reward:  -580.9186827685451
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -20.571485404934677
DONE TAKING  40  STEPS.
Total reward:  -326.12448482575286
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.901171642725583
DONE TAKING  40  STEPS.
Total reward:  -302.5931429600533
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.99721743211493
DONE TAKING  40  STEPS.
Total reward:  -799.6733326855181
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -30.65280325331325
DONE TAKING  40  STEPS.
Total reward:  -283.8179170222749
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.755238997644053
DONE TAKING  40  STEPS.
Total reward:  -653.0344494665942
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -18.561007223353137
DONE TAKING  40  STEPS.
Total reward:  -350.5398552445995
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.40100722204209
DONE TAKING  40  STEPS.
Total reward:  -576.9264382353641
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.930828960314667
DONE TAKING  40  STEPS.
Total reward:  -824.7706962003373
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.83105660769349
DONE TAKING  40  STEPS.
Total reward:  -516.6907160379725
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.495431806880525
DONE TAKING  40  STEPS.
Total reward:  -528.654092854131
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.959589488629735
DONE TAKING  40  STEPS.
Total reward:  -608.8385361252601
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.81019300232078
DONE TAKING  40  STEPS.
Total reward:  -1009.6925768006303
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.20559652945986
DONE TAKING  40  STEPS.
Total reward:  -865.3669075243106
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.445442155733925
DONE TAKING  40  STEPS.
Total reward:  118.37143914941964
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -11.888168467456275
DONE TAKING  40  STEPS.
Total reward:  -348.287766202329
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.20632135322997
DONE TAKING  40  STEPS.
Total reward:  -718.985184176616
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.07346104474863
DONE TAKING  40  STEPS.
Total reward:  -325.76314899201145
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -31.17393617946683
DONE TAKING  40  STEPS.
Total reward:  -709.6274079967435
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.80201051175647
DONE TAKING  40  STEPS.
Total reward:  -466.21379787107446
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.87754753958129
DONE TAKING  40  STEPS.
Total reward:  -827.6466532840709
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.6701701869449
DONE TAKING  40  STEPS.
Total reward:  -405.7644522146788
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.5455111233044
DONE TAKING  40  STEPS.
Total reward:  -433.2638650344015
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.750294956157816
DONE TAKING  40  STEPS.
Total reward:  -488.82054595056013
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.50903876263872
DONE TAKING  40  STEPS.
Total reward:  -730.206558703691
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.961947708658073
DONE TAKING  40  STEPS.
Total reward:  -952.0431765565252
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.64676725170989
DONE TAKING  40  STEPS.
Total reward:  -809.9309896834006
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -16.477561458413746
DONE TAKING  40  STEPS.
Total reward:  -445.5728313116395
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -17.19109597971903
DONE TAKING  40  STEPS.
Total reward:  220.88128864341667
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.721804433175706
DONE TAKING  40  STEPS.
Total reward:  -648.5927818320006
Time for 1 rollout: 1.43 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.112401105837417
DONE TAKING  40  STEPS.
Total reward:  -430.7445898197225
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.580968507853882
DONE TAKING  40  STEPS.
Total reward:  -428.21440593701817
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.947813049982926
DONE TAKING  40  STEPS.
Total reward:  -539.2259941200382
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.66049467699368
DONE TAKING  40  STEPS.
Total reward:  -246.83017662333114
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.206574705935637
DONE TAKING  40  STEPS.
Total reward:  -443.3101257625433
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.52736172934533
DONE TAKING  40  STEPS.
Total reward:  -508.3664632891255
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.94520275152969
DONE TAKING  40  STEPS.
Total reward:  -588.7323851129247
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.17954587489428
DONE TAKING  40  STEPS.
Total reward:  -674.5074901183308
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -16.827009484106785
DONE TAKING  40  STEPS.
Total reward:  56.11436210007178
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter144.ckpt
Iter: 145
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  145
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  36075
On pol:  57600
Prob shape:  (93675,)

=== Epoch 0 ===
    train loss:  0.3962817953510599
    val rand:  0.2942557632923126
    val onPol:  0.3681532144546509

=== Epoch 10 ===
    train loss:  0.1501260140276217
    val rand:  0.189597487449646
    val onPol:  0.3505837619304657

=== Epoch 20 ===
    train loss:  0.0936151606614118
    val rand:  0.1658603996038437
    val onPol:  0.3912855088710785

=== Epoch 30 ===
    train loss:  0.07109042257070541
    val rand:  0.1588606834411621
    val onPol:  0.4173729121685028

=== Epoch 39 ===
    train loss:  0.06109074546167484
    val rand:  0.15464526414871216
    val onPol:  0.43200498819351196
Training duration: 47.85 s

#####################################
performing on-policy MPC rollouts... iter  145
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.810920229993314
DONE TAKING  40  STEPS.
Total reward:  -718.1722919743507
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.68516300255494
DONE TAKING  40  STEPS.
Total reward:  -744.8542499939475
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -9.119063950569785
DONE TAKING  40  STEPS.
Total reward:  -212.12995980189564
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.707352295842657
DONE TAKING  40  STEPS.
Total reward:  -737.2569298297199
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.171591526037034
DONE TAKING  40  STEPS.
Total reward:  -317.39504001637187
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.594653484933186
DONE TAKING  40  STEPS.
Total reward:  -503.4430415679117
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.72453473023347
DONE TAKING  40  STEPS.
Total reward:  -665.4180656242427
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.81748414413808
DONE TAKING  40  STEPS.
Total reward:  -597.1229327061258
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -20.060797443433348
DONE TAKING  40  STEPS.
Total reward:  -523.2563609111786
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -14.565534767252828
DONE TAKING  40  STEPS.
Total reward:  -38.2894254227179
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.511068435154797
DONE TAKING  40  STEPS.
Total reward:  -651.5102759551958
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.998237983991622
DONE TAKING  40  STEPS.
Total reward:  -849.1706855146032
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -15.844607333124504
DONE TAKING  40  STEPS.
Total reward:  -380.815837684493
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.93450418749397
DONE TAKING  40  STEPS.
Total reward:  -495.98867896566463
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.831961650055657
DONE TAKING  40  STEPS.
Total reward:  -427.5851312746968
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -15.501423385382008
DONE TAKING  40  STEPS.
Total reward:  -363.47802079535387
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -28.627037228636443
DONE TAKING  40  STEPS.
Total reward:  -1026.07331280713
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.485820644803898
DONE TAKING  40  STEPS.
Total reward:  -642.897787896682
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.482366394915168
DONE TAKING  40  STEPS.
Total reward:  -336.55887476377166
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.643024655906455
DONE TAKING  40  STEPS.
Total reward:  -822.3851145413728
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.21122900839587
DONE TAKING  40  STEPS.
Total reward:  -862.8610075534658
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.54655284810331
DONE TAKING  40  STEPS.
Total reward:  -734.2337955286108
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.594055840643488
DONE TAKING  40  STEPS.
Total reward:  -333.3750805289956
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.188742130400424
DONE TAKING  40  STEPS.
Total reward:  -819.3227498545067
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.910629970433583
DONE TAKING  40  STEPS.
Total reward:  -464.5583011920637
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -17.43994857614036
DONE TAKING  40  STEPS.
Total reward:  -222.7569390528937
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -17.96663465976084
DONE TAKING  40  STEPS.
Total reward:  -304.0557051536814
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.965598229941005
DONE TAKING  40  STEPS.
Total reward:  -310.7499724559115
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.174832832881393
DONE TAKING  40  STEPS.
Total reward:  -673.3471569722809
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.5353112337636
DONE TAKING  40  STEPS.
Total reward:  -741.7432465797768
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.367677429723507
DONE TAKING  40  STEPS.
Total reward:  -641.9155676589941
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.919107487082144
DONE TAKING  40  STEPS.
Total reward:  -903.917656290103
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.404594950652577
DONE TAKING  40  STEPS.
Total reward:  -1014.2448554776627
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.58536070630179
DONE TAKING  40  STEPS.
Total reward:  -837.7991261537085
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.981052907658338
DONE TAKING  40  STEPS.
Total reward:  -747.2487203061356
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -31.274586513972096
DONE TAKING  40  STEPS.
Total reward:  -723.7339841417881
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -15.539518290460542
DONE TAKING  40  STEPS.
Total reward:  -499.0773405819357
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.539283105050746
DONE TAKING  40  STEPS.
Total reward:  -257.5618601943808
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.161052795436923
DONE TAKING  40  STEPS.
Total reward:  -633.2440591422294
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.34827366510063
DONE TAKING  40  STEPS.
Total reward:  -1058.0699847872838
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter145.ckpt
Iter: 146
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  146
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  36270
On pol:  57600
Prob shape:  (93870,)

=== Epoch 0 ===
    train loss:  0.3909356498001703
    val rand:  0.297712504863739
    val onPol:  0.37000784277915955

=== Epoch 10 ===
    train loss:  0.15019249403085866
    val rand:  0.19067983329296112
    val onPol:  0.3571180800596873

=== Epoch 20 ===
    train loss:  0.09261880969740655
    val rand:  0.17613863945007324
    val onPol:  0.3965941369533539

=== Epoch 30 ===
    train loss:  0.07144657221159649
    val rand:  0.16139298677444458
    val onPol:  0.42092032233874005

=== Epoch 39 ===
    train loss:  0.06033398119396851
    val rand:  0.1565762609243393
    val onPol:  0.4342662493387858
Training duration: 48.28 s

#####################################
performing on-policy MPC rollouts... iter  146
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -28.775570083992605
DONE TAKING  40  STEPS.
Total reward:  -670.0747513186365
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.489934584944244
DONE TAKING  40  STEPS.
Total reward:  -725.3198124087206
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.906275112938403
DONE TAKING  40  STEPS.
Total reward:  -144.21636375839753
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.81868773810092
DONE TAKING  40  STEPS.
Total reward:  -1020.3482261509579
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.276364222830054
DONE TAKING  40  STEPS.
Total reward:  -928.9192696731416
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -15.39298202705892
DONE TAKING  40  STEPS.
Total reward:  -536.0127708271051
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.457756286203647
DONE TAKING  40  STEPS.
Total reward:  -605.820974572385
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.05476254912616
DONE TAKING  40  STEPS.
Total reward:  -821.8830202248757
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.26311389211484
DONE TAKING  40  STEPS.
Total reward:  -870.840681625586
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.909579200368526
DONE TAKING  40  STEPS.
Total reward:  -492.9445884819852
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.818076860670576
DONE TAKING  40  STEPS.
Total reward:  -608.7194585087925
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.582747997442393
DONE TAKING  40  STEPS.
Total reward:  -287.4280201706522
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.87015385015205
DONE TAKING  40  STEPS.
Total reward:  -683.5110205325205
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -13.363451411035909
DONE TAKING  40  STEPS.
Total reward:  -330.08409759899945
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.563035201866285
DONE TAKING  40  STEPS.
Total reward:  -802.1897906039009
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.447149437146027
DONE TAKING  40  STEPS.
Total reward:  -585.5682879084251
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.554164492238897
DONE TAKING  40  STEPS.
Total reward:  -500.6759844155101
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.891777334836107
DONE TAKING  40  STEPS.
Total reward:  -933.375366970248
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.983460535817244
DONE TAKING  40  STEPS.
Total reward:  -398.748590153273
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.91282416999806
DONE TAKING  40  STEPS.
Total reward:  -746.5758844227203
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.431504621948893
DONE TAKING  40  STEPS.
Total reward:  -631.0927510989947
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.285495019104516
DONE TAKING  40  STEPS.
Total reward:  -415.6714463158855
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.453713524689967
DONE TAKING  40  STEPS.
Total reward:  -598.3183050906177
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -12.31450547311364
DONE TAKING  40  STEPS.
Total reward:  -364.0900775194358
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.899864242545657
DONE TAKING  40  STEPS.
Total reward:  -920.9595398069702
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -16.33504214231159
DONE TAKING  40  STEPS.
Total reward:  -2.9929912386055664
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -22.727698746562908
DONE TAKING  40  STEPS.
Total reward:  -485.9725154515546
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.293318895200926
DONE TAKING  40  STEPS.
Total reward:  -362.7236793739502
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.160322747784665
DONE TAKING  40  STEPS.
Total reward:  -424.4253411589528
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.496604683512867
DONE TAKING  40  STEPS.
Total reward:  -1051.4439775233184
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.603523899093776
DONE TAKING  40  STEPS.
Total reward:  -962.2955398200444
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.36550022736204
DONE TAKING  40  STEPS.
Total reward:  -471.8201372452581
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.181876687139138
DONE TAKING  40  STEPS.
Total reward:  -208.8088594657707
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.055261962653006
DONE TAKING  40  STEPS.
Total reward:  -297.4797243017741
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.663261584045634
DONE TAKING  40  STEPS.
Total reward:  -517.6913679982575
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.631662836985907
DONE TAKING  40  STEPS.
Total reward:  -1053.463121691005
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.548551378781802
DONE TAKING  40  STEPS.
Total reward:  -296.70162204680304
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.968626648031645
DONE TAKING  40  STEPS.
Total reward:  -600.0648593517247
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.099411897680042
DONE TAKING  40  STEPS.
Total reward:  -691.6954616870466
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.430693622556646
DONE TAKING  40  STEPS.
Total reward:  -420.91812180783444
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter146.ckpt
Iter: 147
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  147
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  36465
On pol:  57600
Prob shape:  (94065,)

=== Epoch 0 ===
    train loss:  0.39366968619367465
    val rand:  0.29615598917007446
    val onPol:  0.3736535310745239

=== Epoch 10 ===
    train loss:  0.15137538753572058
    val rand:  0.19012777507305145
    val onPol:  0.3606361349423726

=== Epoch 20 ===
    train loss:  0.09417009398422606
    val rand:  0.16989576816558838
    val onPol:  0.4036714533964793

=== Epoch 30 ===
    train loss:  0.0719854095594479
    val rand:  0.15809260308742523
    val onPol:  0.43126078446706134

=== Epoch 39 ===
    train loss:  0.06165398508717453
    val rand:  0.15658745169639587
    val onPol:  0.4429644048213959
Training duration: 48.23 s

#####################################
performing on-policy MPC rollouts... iter  147
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.37052931155295
DONE TAKING  40  STEPS.
Total reward:  -531.4489563765447
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.12440025973028
DONE TAKING  40  STEPS.
Total reward:  -644.9851771488319
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.60269390960072
DONE TAKING  40  STEPS.
Total reward:  -817.0472722661572
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -13.132148319381633
DONE TAKING  40  STEPS.
Total reward:  -333.2481670586917
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.242333086862125
DONE TAKING  40  STEPS.
Total reward:  -399.6648411032804
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -15.744052855430365
DONE TAKING  40  STEPS.
Total reward:  -467.4479409617775
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -18.57252353280317
DONE TAKING  40  STEPS.
Total reward:  -9.751731495134592
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.391040263283262
DONE TAKING  40  STEPS.
Total reward:  -983.087395233964
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.33800959919836
DONE TAKING  40  STEPS.
Total reward:  -926.3209784563829
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.88842637116592
DONE TAKING  40  STEPS.
Total reward:  -714.2007206416229
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.505236633179855
DONE TAKING  40  STEPS.
Total reward:  -513.6642570922968
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.270543622995888
DONE TAKING  40  STEPS.
Total reward:  -63.913361737550645
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.320443155597957
DONE TAKING  40  STEPS.
Total reward:  -595.3998976442067
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -9.240946468125232
DONE TAKING  40  STEPS.
Total reward:  -316.03795815878846
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.10443861358707
DONE TAKING  40  STEPS.
Total reward:  -704.8228538750305
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.466021531512602
DONE TAKING  40  STEPS.
Total reward:  -470.3483546185778
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.26799952007507
DONE TAKING  40  STEPS.
Total reward:  -320.7232230902329
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -18.11375792911422
DONE TAKING  40  STEPS.
Total reward:  -274.5288533585871
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.428063921337657
DONE TAKING  40  STEPS.
Total reward:  -1039.0645277909898
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.71255181867187
DONE TAKING  40  STEPS.
Total reward:  -262.31996789237377
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.402592006460097
DONE TAKING  40  STEPS.
Total reward:  81.12590883488927
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.87025295275791
DONE TAKING  40  STEPS.
Total reward:  -694.9773571030305
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.794502342396015
DONE TAKING  40  STEPS.
Total reward:  -232.39267608474825
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.421491510462566
DONE TAKING  40  STEPS.
Total reward:  -938.6726432368527
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.189444082171615
DONE TAKING  40  STEPS.
Total reward:  -389.1071715460751
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.105298080532833
DONE TAKING  40  STEPS.
Total reward:  -615.5249389806238
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -16.844550328303406
DONE TAKING  40  STEPS.
Total reward:  -253.39449199451988
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.082929047352916
DONE TAKING  40  STEPS.
Total reward:  -1117.4757716467611
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.933266810715963
DONE TAKING  40  STEPS.
Total reward:  250.19726444895645
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -15.033932570364797
DONE TAKING  40  STEPS.
Total reward:  -329.7610933367222
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.13976463956799
DONE TAKING  40  STEPS.
Total reward:  -45.5210742372892
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -20.045751190801067
DONE TAKING  40  STEPS.
Total reward:  94.46087733010374
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.147251519660408
DONE TAKING  40  STEPS.
Total reward:  -495.83489944691746
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -17.380030675671673
DONE TAKING  40  STEPS.
Total reward:  -423.53727853479904
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.437911325241828
DONE TAKING  40  STEPS.
Total reward:  -659.2449874235235
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -31.168550142230394
DONE TAKING  40  STEPS.
Total reward:  -872.8769045754145
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.254352322148975
DONE TAKING  40  STEPS.
Total reward:  -694.8074901284725
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -16.22936036526542
DONE TAKING  40  STEPS.
Total reward:  -381.9392544889902
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.189152047502034
DONE TAKING  40  STEPS.
Total reward:  -597.3911737242943
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.663547252408947
DONE TAKING  40  STEPS.
Total reward:  -559.4288800708711
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter147.ckpt
Iter: 148
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  148
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  36660
On pol:  57600
Prob shape:  (94260,)

=== Epoch 0 ===
    train loss:  0.3912540152668953
    val rand:  0.28579890727996826
    val onPol:  0.3711857696374257

=== Epoch 10 ===
    train loss:  0.1472653226683969
    val rand:  0.18614070117473602
    val onPol:  0.35965198278427124

=== Epoch 20 ===
    train loss:  0.0924189722408419
    val rand:  0.1684868335723877
    val onPol:  0.40650726358095807

=== Epoch 30 ===
    train loss:  0.06984091728277829
    val rand:  0.1608465164899826
    val onPol:  0.4299558202425639

=== Epoch 39 ===
    train loss:  0.06074608651840169
    val rand:  0.15401186048984528
    val onPol:  0.44298598170280457
Training duration: 48.61 s

#####################################
performing on-policy MPC rollouts... iter  148
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.494503377121205
DONE TAKING  40  STEPS.
Total reward:  -827.5255397171748
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.723049547146385
DONE TAKING  40  STEPS.
Total reward:  -573.4338509354332
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -30.26842650926247
DONE TAKING  40  STEPS.
Total reward:  -1072.099625188487
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.879382027734522
DONE TAKING  40  STEPS.
Total reward:  -381.88495825525024
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.791870347629452
DONE TAKING  40  STEPS.
Total reward:  -512.3933567846693
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.58021733687665
DONE TAKING  40  STEPS.
Total reward:  -747.1840521462159
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.89939566029773
DONE TAKING  40  STEPS.
Total reward:  -438.74518952662316
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.59197030071995
DONE TAKING  40  STEPS.
Total reward:  -652.9406316061039
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.082519641724186
DONE TAKING  40  STEPS.
Total reward:  -853.4073308114868
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.494981884926165
DONE TAKING  40  STEPS.
Total reward:  -492.88718377650065
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.384229425787193
DONE TAKING  40  STEPS.
Total reward:  -666.8730260219027
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.760270373318
DONE TAKING  40  STEPS.
Total reward:  -528.8761492904945
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.582499389679974
DONE TAKING  40  STEPS.
Total reward:  -654.4949967866615
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -12.578488815688607
DONE TAKING  40  STEPS.
Total reward:  -291.11372672664623
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.945393772556686
DONE TAKING  40  STEPS.
Total reward:  -143.08517319116487
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.476298043078405
DONE TAKING  40  STEPS.
Total reward:  -40.390587389913364
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.452287638855807
DONE TAKING  40  STEPS.
Total reward:  -560.6623650970024
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.539202618777054
DONE TAKING  40  STEPS.
Total reward:  -589.7311999337091
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.29270569655738
DONE TAKING  40  STEPS.
Total reward:  -1030.5838640236295
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.839260124349774
DONE TAKING  40  STEPS.
Total reward:  -715.8913540165687
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.967588916661931
DONE TAKING  40  STEPS.
Total reward:  -433.8016633552647
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.825154265816984
DONE TAKING  40  STEPS.
Total reward:  -213.42420114285758
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.46871830928903
DONE TAKING  40  STEPS.
Total reward:  -455.92870917540483
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.995008482674073
DONE TAKING  40  STEPS.
Total reward:  -816.4841353564532
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.93381618111117
DONE TAKING  40  STEPS.
Total reward:  -586.0666733808708
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -31.414784438350303
DONE TAKING  40  STEPS.
Total reward:  -914.2323441854438
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.80360566206586
DONE TAKING  40  STEPS.
Total reward:  -742.5725148431761
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.075326564189453
DONE TAKING  40  STEPS.
Total reward:  -510.5694313425063
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.681241493652667
DONE TAKING  40  STEPS.
Total reward:  -452.3757597539967
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.63495855000447
DONE TAKING  40  STEPS.
Total reward:  -498.872839182991
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.341721324167644
DONE TAKING  40  STEPS.
Total reward:  -476.0308403638415
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.63390855370341
DONE TAKING  40  STEPS.
Total reward:  -498.8239651264921
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.13037430518002
DONE TAKING  40  STEPS.
Total reward:  -661.8905250455131
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.014837567710465
DONE TAKING  40  STEPS.
Total reward:  -17.744536560537444
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.31200403469471
DONE TAKING  40  STEPS.
Total reward:  -597.4260559665538
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.99979142439091
DONE TAKING  40  STEPS.
Total reward:  -448.180750720439
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -11.360782443710939
DONE TAKING  40  STEPS.
Total reward:  -395.2898984202052
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.690681576447503
DONE TAKING  40  STEPS.
Total reward:  -637.3964272436274
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.39910739575734
DONE TAKING  40  STEPS.
Total reward:  -828.012342318562
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.395468346935413
DONE TAKING  40  STEPS.
Total reward:  -730.7083914707518
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter148.ckpt
Iter: 149
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40

#####################################
Training the dynamics model..... iteration  149
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  36855
On pol:  57600
Prob shape:  (94455,)

=== Epoch 0 ===
    train loss:  0.38989633321762085
    val rand:  0.2891312837600708
    val onPol:  0.36373603343963623

=== Epoch 10 ===
    train loss:  0.1477946444698002
    val rand:  0.19139955937862396
    val onPol:  0.3492077787717183

=== Epoch 20 ===
    train loss:  0.09249006859634233
    val rand:  0.17145967483520508
    val onPol:  0.38800567388534546

=== Epoch 30 ===
    train loss:  0.07073154830900223
    val rand:  0.15704034268856049
    val onPol:  0.41080110271771747

=== Epoch 39 ===
    train loss:  0.060275038400583944
    val rand:  0.15655705332756042
    val onPol:  0.4265661835670471
Training duration: 48.60 s

#####################################
performing on-policy MPC rollouts... iter  149
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.54598652667983
DONE TAKING  40  STEPS.
Total reward:  -396.21194600079644
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -10.170422456184358
DONE TAKING  40  STEPS.
Total reward:  -224.92912609026152
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.901687727220505
DONE TAKING  40  STEPS.
Total reward:  -300.01614199084946
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.639078293599844
DONE TAKING  40  STEPS.
Total reward:  -1024.5207823071673
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.768904105087984
DONE TAKING  40  STEPS.
Total reward:  -563.451840407923
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -14.377823918183331
DONE TAKING  40  STEPS.
Total reward:  -185.9536213361034
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.488072841513237
DONE TAKING  40  STEPS.
Total reward:  -428.7379181025763
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.83425517999623
DONE TAKING  40  STEPS.
Total reward:  -544.8351513167796
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.169236356893833
DONE TAKING  40  STEPS.
Total reward:  -731.8656667622768
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -23.988841338354394
DONE TAKING  40  STEPS.
Total reward:  -666.5314840211263
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.35824086102821
DONE TAKING  40  STEPS.
Total reward:  -376.5563941747901
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.31126232634559
DONE TAKING  40  STEPS.
Total reward:  -302.7659303004109
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.68326831665823
DONE TAKING  40  STEPS.
Total reward:  -291.20063089360866
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.029404513762877
DONE TAKING  40  STEPS.
Total reward:  -705.5331054110574
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -31.406682773423327
DONE TAKING  40  STEPS.
Total reward:  -794.075279959815
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.03178874216534
DONE TAKING  40  STEPS.
Total reward:  -390.81828710379614
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.26140053118548
DONE TAKING  40  STEPS.
Total reward:  -547.4503094450423
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.94337070197342
DONE TAKING  40  STEPS.
Total reward:  -470.3369732423943
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.486805885015823
DONE TAKING  40  STEPS.
Total reward:  -180.84117772056211
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.60865637633988
DONE TAKING  40  STEPS.
Total reward:  -393.72049370707157
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.23136363954006
DONE TAKING  40  STEPS.
Total reward:  -515.5847727307502
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.92520190842327
DONE TAKING  40  STEPS.
Total reward:  -727.6863580254254
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.724222002230512
DONE TAKING  40  STEPS.
Total reward:  -366.209786231545
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.307152208108594
DONE TAKING  40  STEPS.
Total reward:  -616.466443651825
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.64055096825613
DONE TAKING  40  STEPS.
Total reward:  -530.1189110867585
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.613835514507926
DONE TAKING  40  STEPS.
Total reward:  -610.470999272532
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.127620850716845
DONE TAKING  40  STEPS.
Total reward:  -728.1186574237246
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.219450620408605
DONE TAKING  40  STEPS.
Total reward:  -834.6533905065426
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -24.151764037121225
DONE TAKING  40  STEPS.
Total reward:  -392.98350630765475
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.723111557370036
DONE TAKING  40  STEPS.
Total reward:  -437.0182655556353
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.794159179387044
DONE TAKING  40  STEPS.
Total reward:  -607.0133882130431
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.118514722064752
DONE TAKING  40  STEPS.
Total reward:  -729.6252071016348
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.305393137771663
DONE TAKING  40  STEPS.
Total reward:  -665.5399966825025
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.476213386667094
DONE TAKING  40  STEPS.
Total reward:  -709.365415927502
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.912150959291042
DONE TAKING  40  STEPS.
Total reward:  -387.27371600217896
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.637243045282332
DONE TAKING  40  STEPS.
Total reward:  -712.2228231908284
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.456684071098707
DONE TAKING  40  STEPS.
Total reward:  106.86862114631745
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.364146279114177
DONE TAKING  40  STEPS.
Total reward:  -447.564688842288
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.40690550380404
DONE TAKING  40  STEPS.
Total reward:  -678.8821382238494
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.876864557386435
DONE TAKING  40  STEPS.
Total reward:  -498.28357583867654
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/eb/dclaw_turn/models/model_aggIter149.ckpt
