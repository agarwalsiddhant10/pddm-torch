Added 1 configs from ../config/dclaw_turn.txt
create env called
--------------------------------- 
Simulation dt:  0.1
State space dimension:  (21,)
Action space dimension:  (9,) 
-----------------------------------
Beginning to do  200  random rollouts.
Completed rollout #  0
Completed rollout #  160
Completed rollout #  20
Completed rollout #  40
Completed rollout #  80
Completed rollout #  120
Completed rollout #  140
Completed rollout #  180
Completed rollout #  60
Completed rollout #  100
Performed  200  rollouts, each with  40  steps.
Beginning to do  20  random rollouts.
Completed rollout #  4
Completed rollout #  8
Completed rollout #  2
Completed rollout #  14
Completed rollout #  6
Completed rollout #  10
Completed rollout #  18
Completed rollout #  0
Completed rollout #  16
Completed rollout #  12
Performed  20  rollouts, each with  40  steps.


######################
Done getting data....
input size:  30
action size:  9
output size:  21
dataX dims:  (7800, 1, 21)
dataY dims:  (7800, 1, 9)
dataZ dims:  (7800, 21) 
######################


#####################################
Training the dynamics model..... iteration  0
#####################################

    amount of random data:  8000
    amount of onPol data:  0
Prob shape:  (7800,)

=== Epoch 0 ===
    train loss:  0.6979784448941548
    val rand:  0.4744148850440979
    val onPol:  0.4690351188182831

=== Epoch 10 ===
    train loss:  0.14282064139842987
    val rand:  0.17600278556346893
    val onPol:  0.17144742608070374

=== Epoch 20 ===
    train loss:  0.09599390029907226
    val rand:  0.1420162171125412
    val onPol:  0.13560831546783447

=== Epoch 30 ===
    train loss:  0.07808365821838378
    val rand:  0.13493728637695312
    val onPol:  0.12958389520645142

=== Epoch 39 ===
    train loss:  0.06817551900943121
    val rand:  0.133910670876503
    val onPol:  0.12636655569076538
Training duration: 3.86 s

#####################################
performing on-policy MPC rollouts... iter  0
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.27548734924884
DONE TAKING  40  STEPS.
Total reward:  -416.03202487035134
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.13852638059059
DONE TAKING  40  STEPS.
Total reward:  -615.3398355216069
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.02126840750592
DONE TAKING  40  STEPS.
Total reward:  -1012.2712566296756
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.77073218908143
DONE TAKING  40  STEPS.
Total reward:  -913.9498197456135
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.76362125347191
DONE TAKING  40  STEPS.
Total reward:  -805.2804851766739
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.55692902761286
DONE TAKING  40  STEPS.
Total reward:  -812.2849027297073
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.862556467114302
DONE TAKING  40  STEPS.
Total reward:  -874.5022586845712
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.840576338692475
DONE TAKING  40  STEPS.
Total reward:  -1028.243708764766
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.66860581869951
DONE TAKING  40  STEPS.
Total reward:  -1146.7442327479794
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.21552137970164
DONE TAKING  40  STEPS.
Total reward:  -1169.0321344019678
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.63910691615152
DONE TAKING  40  STEPS.
Total reward:  -905.56427664606
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -17.26590482602973
DONE TAKING  40  STEPS.
Total reward:  -690.6361930411897
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.108110956385996
DONE TAKING  40  STEPS.
Total reward:  -618.407043147302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -13.509419695999497
DONE TAKING  40  STEPS.
Total reward:  -377.188726472053
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -16.67649807274173
DONE TAKING  40  STEPS.
Total reward:  -499.21501753584636
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.1093254504594
DONE TAKING  40  STEPS.
Total reward:  -681.8174619564356
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.97131174007461
DONE TAKING  40  STEPS.
Total reward:  -946.0137955509723
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.524025191636394
DONE TAKING  40  STEPS.
Total reward:  -804.0383904395022
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -15.730636243752485
DONE TAKING  40  STEPS.
Total reward:  -629.2254497500999
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.623738708572745
DONE TAKING  40  STEPS.
Total reward:  -591.9696557092101
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.63121842400718
DONE TAKING  40  STEPS.
Total reward:  -611.5301882435472
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.54784832890256
DONE TAKING  40  STEPS.
Total reward:  -694.1960281292163
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.423798230188698
DONE TAKING  40  STEPS.
Total reward:  -956.2289579857353
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.11921906788773
DONE TAKING  40  STEPS.
Total reward:  -803.9882888397923
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.937473254748937
DONE TAKING  40  STEPS.
Total reward:  -1022.3444209330419
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.557840686828275
DONE TAKING  40  STEPS.
Total reward:  -914.404372925928
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -20.834851678434774
DONE TAKING  40  STEPS.
Total reward:  -580.6865804509121
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.78023461032926
DONE TAKING  40  STEPS.
Total reward:  -335.48069486206754
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.859580091649654
DONE TAKING  40  STEPS.
Total reward:  -955.7847218127636
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -14.600303075935877
DONE TAKING  40  STEPS.
Total reward:  -467.12953951488146
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.62450819114308
DONE TAKING  40  STEPS.
Total reward:  -619.9421737346945
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.983155247131087
DONE TAKING  40  STEPS.
Total reward:  -910.6508933496914
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.504880046445773
DONE TAKING  40  STEPS.
Total reward:  -827.6985522490886
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -19.778805996124976
DONE TAKING  40  STEPS.
Total reward:  -701.3620607446032
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -15.632809727972354
DONE TAKING  40  STEPS.
Total reward:  -537.1836337699343
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.20389598603388
DONE TAKING  40  STEPS.
Total reward:  -974.3461186529786
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.292212658338933
DONE TAKING  40  STEPS.
Total reward:  -887.338261117332
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.79146425442066
DONE TAKING  40  STEPS.
Total reward:  -695.4422557414721
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.674526332161303
DONE TAKING  40  STEPS.
Total reward:  -1190.407547568855
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.1478294267155
DONE TAKING  40  STEPS.
Total reward:  -1055.3486842044042
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter0.ckpt

#####################################
Training the dynamics model..... iteration  1
#####################################

    amount of random data:  8000
    amount of onPol data:  1476
Prob rand:  7995
On pol:  11520
Prob shape:  (19515,)

=== Epoch 0 ===
    train loss:  0.3655883195368867
    val rand:  0.3787318170070648
    val onPol:  0.14624211192131042

=== Epoch 10 ===
    train loss:  0.08274967948857107
    val rand:  0.17688867449760437
    val onPol:  0.12641416490077972

=== Epoch 20 ===
    train loss:  0.055192908370181135
    val rand:  0.1552066057920456
    val onPol:  0.1374393254518509

=== Epoch 30 ===
    train loss:  0.04438066570774505
    val rand:  0.15045994520187378
    val onPol:  0.14866840839385986

=== Epoch 39 ===
    train loss:  0.03872507300816084
    val rand:  0.14897817373275757
    val onPol:  0.15133780241012573
Training duration: 9.42 s

#####################################
performing on-policy MPC rollouts... iter  1
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.04272340145088
DONE TAKING  40  STEPS.
Total reward:  -698.9729435251575
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.924692770208363
DONE TAKING  40  STEPS.
Total reward:  -612.2438573885593
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.871962447384714
DONE TAKING  40  STEPS.
Total reward:  -418.75516582067644
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.041097357567903
DONE TAKING  40  STEPS.
Total reward:  -850.6882912859007
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -19.691086404418755
DONE TAKING  40  STEPS.
Total reward:  -879.3538975610153
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.680048331333328
DONE TAKING  40  STEPS.
Total reward:  -809.3629829116743
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.557037736243828
DONE TAKING  40  STEPS.
Total reward:  -892.5937482872014
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.583453153807334
DONE TAKING  40  STEPS.
Total reward:  -929.6189645550394
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.166056924321754
DONE TAKING  40  STEPS.
Total reward:  -792.855026483373
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.704274735441338
DONE TAKING  40  STEPS.
Total reward:  -775.4552760245402
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.490325077529178
DONE TAKING  40  STEPS.
Total reward:  -1119.2107422901095
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.56811186261666
DONE TAKING  40  STEPS.
Total reward:  -1247.9810921486578
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -18.72634158427567
DONE TAKING  40  STEPS.
Total reward:  -749.0536633710268
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.691105045217242
DONE TAKING  40  STEPS.
Total reward:  -545.0594188074612
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.15916714702609
DONE TAKING  40  STEPS.
Total reward:  -646.3527181758798
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.217441707363072
DONE TAKING  40  STEPS.
Total reward:  -938.3353756371549
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.488600292819406
DONE TAKING  40  STEPS.
Total reward:  -892.1428229033909
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.360917082606676
DONE TAKING  40  STEPS.
Total reward:  -626.0306874622675
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.130097448109506
DONE TAKING  40  STEPS.
Total reward:  -1102.001346696544
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.355604202745724
DONE TAKING  40  STEPS.
Total reward:  -616.7383342157809
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.491721199768293
DONE TAKING  40  STEPS.
Total reward:  -1195.4493795068036
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.720714075189445
DONE TAKING  40  STEPS.
Total reward:  -936.756792832091
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.253748265424022
DONE TAKING  40  STEPS.
Total reward:  -882.8675042802926
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -12.595403475192146
DONE TAKING  40  STEPS.
Total reward:  -29.540874908765943
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.790048732979294
DONE TAKING  40  STEPS.
Total reward:  -769.207244580122
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -22.785175334300583
DONE TAKING  40  STEPS.
Total reward:  -890.3941081610233
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -16.67612998086992
DONE TAKING  40  STEPS.
Total reward:  -640.4900368739496
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.75321353424325
DONE TAKING  40  STEPS.
Total reward:  -930.0723953725949
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.069238870198888
DONE TAKING  40  STEPS.
Total reward:  -690.2055269523718
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.86704342874364
DONE TAKING  40  STEPS.
Total reward:  -717.3330166381218
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.845062127980423
DONE TAKING  40  STEPS.
Total reward:  -744.7320780541994
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.566021270224773
DONE TAKING  40  STEPS.
Total reward:  -748.3796914232264
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.178253970154824
DONE TAKING  40  STEPS.
Total reward:  -959.9306179377072
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.829932247590335
DONE TAKING  40  STEPS.
Total reward:  -741.7753928790484
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.60676818773964
DONE TAKING  40  STEPS.
Total reward:  -1056.9610200474744
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.6756870652263
DONE TAKING  40  STEPS.
Total reward:  -868.1535202451856
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -22.38037861961276
DONE TAKING  40  STEPS.
Total reward:  -895.2151447845107
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.974700599470435
DONE TAKING  40  STEPS.
Total reward:  -962.818454041865
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.269074688435266
DONE TAKING  40  STEPS.
Total reward:  -633.8112525411292
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.792531018061368
DONE TAKING  40  STEPS.
Total reward:  -351.80391026162204
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/font_manager.py:1320: UserWarning: findfont: Font family ['serif'] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter1.ckpt

#####################################
Training the dynamics model..... iteration  2
#####################################

    amount of random data:  8000
    amount of onPol data:  2952
Prob rand:  8190
On pol:  11520
Prob shape:  (19710,)

=== Epoch 0 ===
    train loss:  0.4328036786694276
    val rand:  0.37020862102508545
    val onPol:  0.14556190371513367

=== Epoch 10 ===
    train loss:  0.10118103360659197
    val rand:  0.17544755339622498
    val onPol:  0.12462934106588364

=== Epoch 20 ===
    train loss:  0.06658322638586948
    val rand:  0.15314394235610962
    val onPol:  0.13468734920024872

=== Epoch 30 ===
    train loss:  0.05358785312426718
    val rand:  0.14140485227108002
    val onPol:  0.13884280622005463

=== Epoch 39 ===
    train loss:  0.04651826365213645
    val rand:  0.14436286687850952
    val onPol:  0.14023353159427643
Training duration: 9.61 s

#####################################
performing on-policy MPC rollouts... iter  2
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.970859975292626
DONE TAKING  40  STEPS.
Total reward:  -661.2464125240552
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -13.953031946930192
DONE TAKING  40  STEPS.
Total reward:  -416.9464497814252
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.525793321463944
DONE TAKING  40  STEPS.
Total reward:  -502.2265844304534
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -15.265571854165758
DONE TAKING  40  STEPS.
Total reward:  -945.5037310068453
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.38091263062345
DONE TAKING  40  STEPS.
Total reward:  -866.6439593370094
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.61330824150548
DONE TAKING  40  STEPS.
Total reward:  -444.0593019229397
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.77074609198189
DONE TAKING  40  STEPS.
Total reward:  -833.4038219318031
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.2633958722123
DONE TAKING  40  STEPS.
Total reward:  -397.69237213042095
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.932600965672822
DONE TAKING  40  STEPS.
Total reward:  -450.3420790251178
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.787484778731773
DONE TAKING  40  STEPS.
Total reward:  -990.5574715263058
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.420228572641435
DONE TAKING  40  STEPS.
Total reward:  -618.1786973051204
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -13.393705870400067
DONE TAKING  40  STEPS.
Total reward:  -426.0061230814128
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.082275984164696
DONE TAKING  40  STEPS.
Total reward:  -964.1270364587223
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -13.389370681586696
DONE TAKING  40  STEPS.
Total reward:  -488.04836371668443
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.505163983895358
DONE TAKING  40  STEPS.
Total reward:  -714.6871100145662
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -18.172823568212795
DONE TAKING  40  STEPS.
Total reward:  -455.89474362857453
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.993686377849635
DONE TAKING  40  STEPS.
Total reward:  -611.1401581231443
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.000123886471346
DONE TAKING  40  STEPS.
Total reward:  -393.6442048376785
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.704395547797596
DONE TAKING  40  STEPS.
Total reward:  -1006.1345334013283
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.428914349883588
DONE TAKING  40  STEPS.
Total reward:  -845.3024711227952
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -14.992696170464711
DONE TAKING  40  STEPS.
Total reward:  -501.0147182622011
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.165282275422303
DONE TAKING  40  STEPS.
Total reward:  -645.3443706897224
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.13962349263177
DONE TAKING  40  STEPS.
Total reward:  -902.9296735660746
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.282732024866533
DONE TAKING  40  STEPS.
Total reward:  -904.2683333192142
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.04466216538951
DONE TAKING  40  STEPS.
Total reward:  -735.54277210151
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.348227018720298
DONE TAKING  40  STEPS.
Total reward:  -577.3286363122187
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.405976355359996
DONE TAKING  40  STEPS.
Total reward:  -1177.5130448292737
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.734134490247378
DONE TAKING  40  STEPS.
Total reward:  -872.0654397350885
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.12226915467624
DONE TAKING  40  STEPS.
Total reward:  -832.1632860518431
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.089398000385106
DONE TAKING  40  STEPS.
Total reward:  -691.6044657715287
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.08128240988115
DONE TAKING  40  STEPS.
Total reward:  -596.4056422094999
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -16.665574723603672
DONE TAKING  40  STEPS.
Total reward:  -444.06874682851355
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.280128832756407
DONE TAKING  40  STEPS.
Total reward:  -928.6811502881038
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.766314904570493
DONE TAKING  40  STEPS.
Total reward:  -673.6588262552214
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.81630576071039
DONE TAKING  40  STEPS.
Total reward:  -751.3725205073532
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.718600679262448
DONE TAKING  40  STEPS.
Total reward:  -643.627238259064
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.023945332124207
DONE TAKING  40  STEPS.
Total reward:  -870.3912434901495
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.322187752760097
DONE TAKING  40  STEPS.
Total reward:  -769.7176078627424
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.016659533978512
DONE TAKING  40  STEPS.
Total reward:  -989.8314945079088
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.687897387982424
DONE TAKING  40  STEPS.
Total reward:  -548.6668069684346
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter2.ckpt

#####################################
Training the dynamics model..... iteration  3
#####################################

    amount of random data:  8000
    amount of onPol data:  4428
Prob rand:  8385
On pol:  8640
Prob shape:  (17025,)

=== Epoch 0 ===
    train loss:  0.4873318816676284
    val rand:  0.37590593099594116
    val onPol:  0.2486305683851242

=== Epoch 10 ===
    train loss:  0.1351086420543266
    val rand:  0.17605555057525635
    val onPol:  0.2174071967601776

=== Epoch 20 ===
    train loss:  0.08972185714678331
    val rand:  0.15206368267536163
    val onPol:  0.22890225052833557

=== Epoch 30 ===
    train loss:  0.07030624986597986
    val rand:  0.14989902079105377
    val onPol:  0.23664848506450653

=== Epoch 39 ===
    train loss:  0.06078779923193382
    val rand:  0.14588110148906708
    val onPol:  0.24046140909194946
Training duration: 8.08 s

#####################################
performing on-policy MPC rollouts... iter  3
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.841656502256395
DONE TAKING  40  STEPS.
Total reward:  -1002.2010172265115
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.495801497856995
DONE TAKING  40  STEPS.
Total reward:  -561.6653212729697
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.185975258705977
DONE TAKING  40  STEPS.
Total reward:  -1084.819756431856
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.621839053208994
DONE TAKING  40  STEPS.
Total reward:  -925.7992865812956
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.89158592602412
DONE TAKING  40  STEPS.
Total reward:  -538.9020073407943
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.45062551572896
DONE TAKING  40  STEPS.
Total reward:  -484.0149814448828
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.44160639225239
DONE TAKING  40  STEPS.
Total reward:  -759.8503231236066
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.932119221463058
DONE TAKING  40  STEPS.
Total reward:  -1054.1116974421814
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.666804115859332
DONE TAKING  40  STEPS.
Total reward:  -904.3328795131968
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -14.455953512128211
DONE TAKING  40  STEPS.
Total reward:  -413.6379866973958
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -15.489467120806246
DONE TAKING  40  STEPS.
Total reward:  -580.4121384965193
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.821109457646052
DONE TAKING  40  STEPS.
Total reward:  -742.6647618411824
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.747165311815056
DONE TAKING  40  STEPS.
Total reward:  -942.3272800840823
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -20.322314128743926
DONE TAKING  40  STEPS.
Total reward:  -658.2376246739422
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -19.70203883413276
DONE TAKING  40  STEPS.
Total reward:  -749.841722798308
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.102808773316852
DONE TAKING  40  STEPS.
Total reward:  -786.8621153092082
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.899936281988065
DONE TAKING  40  STEPS.
Total reward:  -889.9079930722177
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.8199581551295
DONE TAKING  40  STEPS.
Total reward:  -1022.3437346968715
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.817386490978986
DONE TAKING  40  STEPS.
Total reward:  -1040.28264208653
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.48644751640387
DONE TAKING  40  STEPS.
Total reward:  -739.4579006561542
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.646439207111627
DONE TAKING  40  STEPS.
Total reward:  -930.6353914161283
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -10.94335003051889
DONE TAKING  40  STEPS.
Total reward:  -550.9628118877871
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -18.430968067304974
DONE TAKING  40  STEPS.
Total reward:  -405.69492886700135
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.53514578211854
DONE TAKING  40  STEPS.
Total reward:  -164.5505505065535
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.391811489759764
DONE TAKING  40  STEPS.
Total reward:  -571.7848156408008
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.53959933084815
DONE TAKING  40  STEPS.
Total reward:  -648.0509017711182
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -18.780363045503606
DONE TAKING  40  STEPS.
Total reward:  -541.2084684748734
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.787775276556413
DONE TAKING  40  STEPS.
Total reward:  -678.4969156254651
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.93485984082591
DONE TAKING  40  STEPS.
Total reward:  -501.6921617266364
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.354740964552143
DONE TAKING  40  STEPS.
Total reward:  -934.1896385820849
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.814867551213492
DONE TAKING  40  STEPS.
Total reward:  -1112.2668121986915
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.12967239067784
DONE TAKING  40  STEPS.
Total reward:  -925.186895627113
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.217943558293555
DONE TAKING  40  STEPS.
Total reward:  -1030.1973839685136
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.07409865147558
DONE TAKING  40  STEPS.
Total reward:  -479.39182405516397
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.790264936261607
DONE TAKING  40  STEPS.
Total reward:  -720.1253697345426
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -12.166325345876423
DONE TAKING  40  STEPS.
Total reward:  -434.0237163721542
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.084707118920704
DONE TAKING  40  STEPS.
Total reward:  -745.7667851751535
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -10.39389432828961
DONE TAKING  40  STEPS.
Total reward:  -351.06926655829284
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -22.58923563957133
DONE TAKING  40  STEPS.
Total reward:  -351.95442192092935
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -13.178586190062159
DONE TAKING  40  STEPS.
Total reward:  -496.2229563059978
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter3.ckpt

#####################################
Training the dynamics model..... iteration  4
#####################################

    amount of random data:  8000
    amount of onPol data:  5904
Prob rand:  8580
On pol:  11520
Prob shape:  (20100,)

=== Epoch 0 ===
    train loss:  0.46937966423156935
    val rand:  0.37092941999435425
    val onPol:  0.26291215419769287

=== Epoch 10 ===
    train loss:  0.1394132062410697
    val rand:  0.1729722023010254
    val onPol:  0.23518311977386475

=== Epoch 20 ===
    train loss:  0.09478078610621966
    val rand:  0.15281462669372559
    val onPol:  0.250727117061615

=== Epoch 30 ===
    train loss:  0.07107482793239447
    val rand:  0.15070289373397827
    val onPol:  0.2598574161529541

=== Epoch 39 ===
    train loss:  0.0585859596538238
    val rand:  0.14803113043308258
    val onPol:  0.268545925617218
Training duration: 9.94 s

#####################################
performing on-policy MPC rollouts... iter  4
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.161761633563106
DONE TAKING  40  STEPS.
Total reward:  -518.781617535926
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.176970981546987
DONE TAKING  40  STEPS.
Total reward:  -680.3665730874833
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.247707015746933
DONE TAKING  40  STEPS.
Total reward:  -617.5298297801326
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.541991730923026
DONE TAKING  40  STEPS.
Total reward:  -952.6943594600668
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.145817742258064
DONE TAKING  40  STEPS.
Total reward:  -698.4429285953933
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.668059611490175
DONE TAKING  40  STEPS.
Total reward:  -599.9410026172692
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.64301597564568
DONE TAKING  40  STEPS.
Total reward:  -1164.348479630571
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.962366597126245
DONE TAKING  40  STEPS.
Total reward:  -471.0904351029994
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.86558247995773
DONE TAKING  40  STEPS.
Total reward:  -676.3083213509298
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.750156261253863
DONE TAKING  40  STEPS.
Total reward:  -809.4455394706026
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.924015440798364
DONE TAKING  40  STEPS.
Total reward:  -798.0650313907536
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -13.180738306540496
DONE TAKING  40  STEPS.
Total reward:  -262.2391517965934
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.636767554691865
DONE TAKING  40  STEPS.
Total reward:  -753.4536470835208
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.83159356060338
DONE TAKING  40  STEPS.
Total reward:  -1055.9450285155222
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -12.546570882005577
DONE TAKING  40  STEPS.
Total reward:  -326.40917948290615
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.962549725681285
DONE TAKING  40  STEPS.
Total reward:  -940.1398008329555
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.721292778603488
DONE TAKING  40  STEPS.
Total reward:  -870.5111244498905
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.840171840675083
DONE TAKING  40  STEPS.
Total reward:  -504.8401149048823
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -31.16545273858831
DONE TAKING  40  STEPS.
Total reward:  -762.7548345874591
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.42048005630752
DONE TAKING  40  STEPS.
Total reward:  -789.1151033806672
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.30922963867819
DONE TAKING  40  STEPS.
Total reward:  -857.1159966094186
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.247967559186243
DONE TAKING  40  STEPS.
Total reward:  -649.2064909086445
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.070591578275405
DONE TAKING  40  STEPS.
Total reward:  -550.6224944401183
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.286829702302313
DONE TAKING  40  STEPS.
Total reward:  -1170.9870000511078
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.274034095716864
DONE TAKING  40  STEPS.
Total reward:  -589.2728019011879
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -17.265538361450947
DONE TAKING  40  STEPS.
Total reward:  -436.1039473420655
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.597902677474597
DONE TAKING  40  STEPS.
Total reward:  -713.7084135472369
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.48568333318951
DONE TAKING  40  STEPS.
Total reward:  -907.8854441737219
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -12.820566590964527
DONE TAKING  40  STEPS.
Total reward:  -387.8528510845065
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -17.341346763715293
DONE TAKING  40  STEPS.
Total reward:  -421.85499845858874
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.97070200839605
DONE TAKING  40  STEPS.
Total reward:  -889.6929804296262
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.455259878863433
DONE TAKING  40  STEPS.
Total reward:  -726.5126443783129
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.540691321883266
DONE TAKING  40  STEPS.
Total reward:  -376.9266884397733
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.04467025333674
DONE TAKING  40  STEPS.
Total reward:  -898.9368440226209
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.641926396218064
DONE TAKING  40  STEPS.
Total reward:  -596.3188727238747
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.356706562939685
DONE TAKING  40  STEPS.
Total reward:  -803.954787526816
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -12.677010029786109
DONE TAKING  40  STEPS.
Total reward:  -310.4815577726158
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.639613484599025
DONE TAKING  40  STEPS.
Total reward:  -608.2942925740253
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.027354634234605
DONE TAKING  40  STEPS.
Total reward:  -706.5878015144715
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.683913472726715
DONE TAKING  40  STEPS.
Total reward:  -659.3858928285994
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter4.ckpt

#####################################
Training the dynamics model..... iteration  5
#####################################

    amount of random data:  8000
    amount of onPol data:  7380
Prob rand:  8775
On pol:  14400
Prob shape:  (23175,)

=== Epoch 0 ===
    train loss:  0.4580535279379951
    val rand:  0.3678837716579437
    val onPol:  0.25132912397384644

=== Epoch 10 ===
    train loss:  0.14688171976142458
    val rand:  0.17838411033153534
    val onPol:  0.22452150285243988

=== Epoch 20 ===
    train loss:  0.09751846657858955
    val rand:  0.15702934563159943
    val onPol:  0.23578205704689026

=== Epoch 30 ===
    train loss:  0.07301986383067237
    val rand:  0.15292030572891235
    val onPol:  0.2459179013967514

=== Epoch 39 ===
    train loss:  0.05977439184983571
    val rand:  0.15153884887695312
    val onPol:  0.253572940826416
Training duration: 11.21 s

#####################################
performing on-policy MPC rollouts... iter  5
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -16.753838869710627
DONE TAKING  40  STEPS.
Total reward:  -547.9950217315068
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.164045179458686
DONE TAKING  40  STEPS.
Total reward:  -598.5521403301939
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.181391135275028
DONE TAKING  40  STEPS.
Total reward:  -1003.8851868823587
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.786363335583996
DONE TAKING  40  STEPS.
Total reward:  -893.4463843902892
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.144479365995213
DONE TAKING  40  STEPS.
Total reward:  -429.49119171408927
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.94196224508002
DONE TAKING  40  STEPS.
Total reward:  -651.7781784773824
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.868347636833157
DONE TAKING  40  STEPS.
Total reward:  -408.12038595639183
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.48805727464688
DONE TAKING  40  STEPS.
Total reward:  -978.7909627459204
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.793385514678814
DONE TAKING  40  STEPS.
Total reward:  -655.7454032510061
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.74109105632049
DONE TAKING  40  STEPS.
Total reward:  -531.0443076128105
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.37023552136928
DONE TAKING  40  STEPS.
Total reward:  -619.6400586205943
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.39545442978513
DONE TAKING  40  STEPS.
Total reward:  -761.7873969083014
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -15.333629707474785
DONE TAKING  40  STEPS.
Total reward:  -508.4830653056852
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -27.74870649656471
DONE TAKING  40  STEPS.
Total reward:  -972.5547860158349
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.43327918718958
DONE TAKING  40  STEPS.
Total reward:  -233.76925480777675
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.113860062117197
DONE TAKING  40  STEPS.
Total reward:  -965.8985679462891
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -9.530059373199842
DONE TAKING  40  STEPS.
Total reward:  -158.77535321245855
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.231395661704184
DONE TAKING  40  STEPS.
Total reward:  -795.8633648925819
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.610296650647904
DONE TAKING  40  STEPS.
Total reward:  -590.5210112043309
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.947484607524718
DONE TAKING  40  STEPS.
Total reward:  -788.4607749123045
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.742342559267907
DONE TAKING  40  STEPS.
Total reward:  -595.166461169829
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.554637075230254
DONE TAKING  40  STEPS.
Total reward:  -450.2542427403631
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.595878091953068
DONE TAKING  40  STEPS.
Total reward:  -874.2327347098686
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -12.976419989512515
DONE TAKING  40  STEPS.
Total reward:  -415.8556045822702
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -11.593425289106957
DONE TAKING  40  STEPS.
Total reward:  -436.3588141905052
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.60581912648918
DONE TAKING  40  STEPS.
Total reward:  -466.41507587795786
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.82754158445265
DONE TAKING  40  STEPS.
Total reward:  -741.5492482181996
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -12.22665126035167
DONE TAKING  40  STEPS.
Total reward:  -478.38368392728864
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -11.278247221715903
DONE TAKING  40  STEPS.
Total reward:  -378.7824017095825
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -12.928055274844546
DONE TAKING  40  STEPS.
Total reward:  -312.78052969246363
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.272909973368385
DONE TAKING  40  STEPS.
Total reward:  -634.8477716942853
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.052915289727878
DONE TAKING  40  STEPS.
Total reward:  -465.5470114561719
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.628802269744906
DONE TAKING  40  STEPS.
Total reward:  -492.26296416214444
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.870829395509777
DONE TAKING  40  STEPS.
Total reward:  -440.5590385101276
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.861382409568485
DONE TAKING  40  STEPS.
Total reward:  -928.0473475782326
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.37781429115148
DONE TAKING  40  STEPS.
Total reward:  -886.4486072608519
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.783434984137756
DONE TAKING  40  STEPS.
Total reward:  -740.2903262546535
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.421665969056033
DONE TAKING  40  STEPS.
Total reward:  -600.7769619507811
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.731552098394088
DONE TAKING  40  STEPS.
Total reward:  -499.0338925432254
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.372609201221437
DONE TAKING  40  STEPS.
Total reward:  -600.8589814615544
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter5.ckpt

#####################################
Training the dynamics model..... iteration  6
#####################################

    amount of random data:  8000
    amount of onPol data:  8856
Prob rand:  8970
On pol:  17280
Prob shape:  (26250,)

=== Epoch 0 ===
    train loss:  0.4359310286886552
    val rand:  0.3731268048286438
    val onPol:  0.244161456823349

=== Epoch 10 ===
    train loss:  0.1502105710553188
    val rand:  0.177338644862175
    val onPol:  0.22417782247066498

=== Epoch 20 ===
    train loss:  0.10003194475875181
    val rand:  0.15392713248729706
    val onPol:  0.23299169540405273

=== Epoch 30 ===
    train loss:  0.07294485382005281
    val rand:  0.1491406261920929
    val onPol:  0.24451535940170288

=== Epoch 39 ===
    train loss:  0.05894268019234433
    val rand:  0.14922909438610077
    val onPol:  0.2545861601829529
Training duration: 13.07 s

#####################################
performing on-policy MPC rollouts... iter  6
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.67997105065564
DONE TAKING  40  STEPS.
Total reward:  -1089.9043432589244
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.119056536386537
DONE TAKING  40  STEPS.
Total reward:  -712.2645660522204
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -15.13122414220655
DONE TAKING  40  STEPS.
Total reward:  -457.20855107490866
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -31.017152671685608
DONE TAKING  40  STEPS.
Total reward:  -901.2132515474789
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.207904765657375
DONE TAKING  40  STEPS.
Total reward:  -934.19295169513
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.012101850203386
DONE TAKING  40  STEPS.
Total reward:  -666.4887497022016
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.30319232393052
DONE TAKING  40  STEPS.
Total reward:  -479.52958194802693
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.514906059525487
DONE TAKING  40  STEPS.
Total reward:  -444.07130679727254
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.914456024497557
DONE TAKING  40  STEPS.
Total reward:  -691.5115522124584
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.43873215477118
DONE TAKING  40  STEPS.
Total reward:  -623.7610580944157
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -31.220372568595526
DONE TAKING  40  STEPS.
Total reward:  -984.8109752791124
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -18.541828684295645
DONE TAKING  40  STEPS.
Total reward:  -654.9379145556621
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -9.459752846310439
DONE TAKING  40  STEPS.
Total reward:  -345.46930449612347
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.702966012870135
DONE TAKING  40  STEPS.
Total reward:  -980.9415078791068
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.194266015018023
DONE TAKING  40  STEPS.
Total reward:  -284.02807465857467
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.668641600575985
DONE TAKING  40  STEPS.
Total reward:  -480.9507451993167
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.100896575635765
DONE TAKING  40  STEPS.
Total reward:  -423.1296174115275
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.914489776579245
DONE TAKING  40  STEPS.
Total reward:  -446.25470405675986
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.580452018434478
DONE TAKING  40  STEPS.
Total reward:  -787.9896970416506
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.117204501826777
DONE TAKING  40  STEPS.
Total reward:  -601.823431192465
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.45895717648967
DONE TAKING  40  STEPS.
Total reward:  -980.0314064444268
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.689739252778466
DONE TAKING  40  STEPS.
Total reward:  -573.2876071099786
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.923279755892956
DONE TAKING  40  STEPS.
Total reward:  -1166.1156136090729
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.414462646770346
DONE TAKING  40  STEPS.
Total reward:  -1063.1758630357706
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.522398655403926
DONE TAKING  40  STEPS.
Total reward:  -618.7550122782428
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.373662940350087
DONE TAKING  40  STEPS.
Total reward:  -997.9156680809622
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.941267352694812
DONE TAKING  40  STEPS.
Total reward:  -555.8952084018725
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.741617105560962
DONE TAKING  40  STEPS.
Total reward:  -764.2593764029938
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.467421334971608
DONE TAKING  40  STEPS.
Total reward:  -403.6215441378167
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.379355754705326
DONE TAKING  40  STEPS.
Total reward:  -942.521014219168
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -14.270682886025117
DONE TAKING  40  STEPS.
Total reward:  -382.457063005536
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -14.495587405993128
DONE TAKING  40  STEPS.
Total reward:  -195.9323863569819
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.281897479158737
DONE TAKING  40  STEPS.
Total reward:  -708.2839794197423
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.626939570410187
DONE TAKING  40  STEPS.
Total reward:  -969.0593416398376
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.750468886229072
DONE TAKING  40  STEPS.
Total reward:  -754.7167541931077
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.94629907715131
DONE TAKING  40  STEPS.
Total reward:  -1042.3189486157492
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.56411440106268
DONE TAKING  40  STEPS.
Total reward:  -594.8686266088762
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -20.505895735072723
DONE TAKING  40  STEPS.
Total reward:  -586.3527280210623
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.285017895666783
DONE TAKING  40  STEPS.
Total reward:  -1012.2601630119239
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.49165550941306
DONE TAKING  40  STEPS.
Total reward:  -902.9954849078451
Time for 1 rollout: 1.09 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter6.ckpt

#####################################
Training the dynamics model..... iteration  7
#####################################

    amount of random data:  8000
    amount of onPol data:  10332
Prob rand:  9165
On pol:  10080
Prob shape:  (19245,)

=== Epoch 0 ===
    train loss:  0.5157645844124459
    val rand:  0.3782220780849457
    val onPol:  0.32821282744407654

=== Epoch 10 ===
    train loss:  0.18073548497380437
    val rand:  0.17166708409786224
    val onPol:  0.2799178212881088

=== Epoch 20 ===
    train loss:  0.1345077829586493
    val rand:  0.14777427911758423
    val onPol:  0.28352994471788406

=== Epoch 30 ===
    train loss:  0.10585924358786764
    val rand:  0.13846705853939056
    val onPol:  0.28809911012649536

=== Epoch 39 ===
    train loss:  0.09096102859522845
    val rand:  0.14569535851478577
    val onPol:  0.2939399927854538
Training duration: 10.58 s

#####################################
performing on-policy MPC rollouts... iter  7
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -27.7460221320256
DONE TAKING  40  STEPS.
Total reward:  -1067.4162656751864
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -9.119929466453327
DONE TAKING  40  STEPS.
Total reward:  -347.0402898125175
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.511386576336951
DONE TAKING  40  STEPS.
Total reward:  -449.68395230666994
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.326483153856245
DONE TAKING  40  STEPS.
Total reward:  -746.2382475345908
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.230109517204568
DONE TAKING  40  STEPS.
Total reward:  -729.7772097318779
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.57099568186748
DONE TAKING  40  STEPS.
Total reward:  -324.1664481579792
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.607381454860807
DONE TAKING  40  STEPS.
Total reward:  -477.56325500343684
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.55292983484959
DONE TAKING  40  STEPS.
Total reward:  -399.4819621146916
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -31.269638722040668
DONE TAKING  40  STEPS.
Total reward:  -947.8920184528107
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.02875448366528
DONE TAKING  40  STEPS.
Total reward:  -839.5557266704208
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.269417912814006
DONE TAKING  40  STEPS.
Total reward:  -538.4566468965135
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.569291666120655
DONE TAKING  40  STEPS.
Total reward:  27.60784636539385
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.506567673786797
DONE TAKING  40  STEPS.
Total reward:  -1039.896871244405
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.265402881252587
DONE TAKING  40  STEPS.
Total reward:  -525.47307964275
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.33772239786056
DONE TAKING  40  STEPS.
Total reward:  -569.5928404239625
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -15.949376705273234
DONE TAKING  40  STEPS.
Total reward:  -434.8143281555565
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.70354181373232
DONE TAKING  40  STEPS.
Total reward:  -544.6897371883002
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.46793930347325
DONE TAKING  40  STEPS.
Total reward:  -389.53560456749926
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.130061208844175
DONE TAKING  40  STEPS.
Total reward:  -465.32381777087835
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.004711052064113
DONE TAKING  40  STEPS.
Total reward:  -584.8762781235054
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.075314755568684
DONE TAKING  40  STEPS.
Total reward:  -339.1594971379169
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.107548218625983
DONE TAKING  40  STEPS.
Total reward:  -1174.7789465997405
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.75571462864901
DONE TAKING  40  STEPS.
Total reward:  176.55725576557057
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -13.360646173157114
DONE TAKING  40  STEPS.
Total reward:  -444.8710653860576
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.87920744895762
DONE TAKING  40  STEPS.
Total reward:  -902.6789669660124
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.63126465808368
DONE TAKING  40  STEPS.
Total reward:  59.81216079518289
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -18.575608810160492
DONE TAKING  40  STEPS.
Total reward:  -537.5788453801817
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -11.704581157202458
DONE TAKING  40  STEPS.
Total reward:  -378.7283313051437
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.36887989580276
DONE TAKING  40  STEPS.
Total reward:  -1063.7138767675226
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -12.163926108251674
DONE TAKING  40  STEPS.
Total reward:  -432.46581960018267
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -18.65540760943953
DONE TAKING  40  STEPS.
Total reward:  -674.1740833367364
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.087973031565106
DONE TAKING  40  STEPS.
Total reward:  -425.17498114647526
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.717313824824515
DONE TAKING  40  STEPS.
Total reward:  -741.1009532952583
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.527187027799844
DONE TAKING  40  STEPS.
Total reward:  -507.2516365952319
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.61473255170911
DONE TAKING  40  STEPS.
Total reward:  -933.267744588711
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.634885403968713
DONE TAKING  40  STEPS.
Total reward:  -590.6139013618931
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.198833637781604
DONE TAKING  40  STEPS.
Total reward:  -798.3635501319758
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -11.92567783072323
DONE TAKING  40  STEPS.
Total reward:  -305.5513295306292
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.75569658098969
DONE TAKING  40  STEPS.
Total reward:  148.2016408621679
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.874893724122714
DONE TAKING  40  STEPS.
Total reward:  -590.5529488524228
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter7.ckpt

#####################################
Training the dynamics model..... iteration  8
#####################################

    amount of random data:  8000
    amount of onPol data:  11808
Prob rand:  9360
On pol:  11520
Prob shape:  (20880,)

=== Epoch 0 ===
    train loss:  0.5035722427070141
    val rand:  0.39948388934135437
    val onPol:  0.33239778876304626

=== Epoch 10 ===
    train loss:  0.1803689856082201
    val rand:  0.18116649985313416
    val onPol:  0.2844751328229904

=== Epoch 20 ===
    train loss:  0.13595804814249277
    val rand:  0.1542324721813202
    val onPol:  0.2825721725821495

=== Epoch 30 ===
    train loss:  0.10932252556085587
    val rand:  0.14728021621704102
    val onPol:  0.2903868108987808

=== Epoch 39 ===
    train loss:  0.09306362345814705
    val rand:  0.15139168500900269
    val onPol:  0.2982682138681412
Training duration: 9.99 s

#####################################
performing on-policy MPC rollouts... iter  8
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.424530981518334
DONE TAKING  40  STEPS.
Total reward:  -834.4322394088872
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -14.84408909185258
DONE TAKING  40  STEPS.
Total reward:  -539.5184436400016
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.17333638521007
DONE TAKING  40  STEPS.
Total reward:  -875.3692703382212
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.49908635115663
DONE TAKING  40  STEPS.
Total reward:  -571.616395327729
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.498286737749112
DONE TAKING  40  STEPS.
Total reward:  -677.5489950423492
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.737424233855492
DONE TAKING  40  STEPS.
Total reward:  -996.063294161445
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.599914912649954
DONE TAKING  40  STEPS.
Total reward:  -853.9969468579088
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.8822357618004
DONE TAKING  40  STEPS.
Total reward:  -705.5252908859592
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.729293001480613
DONE TAKING  40  STEPS.
Total reward:  -750.5338094918463
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.203891422295563
DONE TAKING  40  STEPS.
Total reward:  -997.2354363253025
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.569953089917842
DONE TAKING  40  STEPS.
Total reward:  -461.1245680853203
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -16.54619652192909
DONE TAKING  40  STEPS.
Total reward:  -579.1644380233859
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.589365654422814
DONE TAKING  40  STEPS.
Total reward:  -495.2540054772798
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.622450468419927
DONE TAKING  40  STEPS.
Total reward:  -818.3212138853771
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.558339220041464
DONE TAKING  40  STEPS.
Total reward:  -437.01744292192035
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -27.007382893069686
DONE TAKING  40  STEPS.
Total reward:  -1041.277034179172
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.52072604420286
DONE TAKING  40  STEPS.
Total reward:  -823.1364601528885
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -15.145794877516224
DONE TAKING  40  STEPS.
Total reward:  -374.606300301247
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.788416939379836
DONE TAKING  40  STEPS.
Total reward:  -515.9421222826132
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -15.633907444333058
DONE TAKING  40  STEPS.
Total reward:  -425.84608712703795
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.237902648567367
DONE TAKING  40  STEPS.
Total reward:  -448.88045417547215
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.856670642771032
DONE TAKING  40  STEPS.
Total reward:  -776.3188243959689
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -23.361671155713495
DONE TAKING  40  STEPS.
Total reward:  -730.6729569062817
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.94209017954123
DONE TAKING  40  STEPS.
Total reward:  -1086.9384236018811
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.52146189456104
DONE TAKING  40  STEPS.
Total reward:  -320.2140172662516
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.23717702021213
DONE TAKING  40  STEPS.
Total reward:  -654.072941354793
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.09099201723099
DONE TAKING  40  STEPS.
Total reward:  -671.1027125246378
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.161129458578642
DONE TAKING  40  STEPS.
Total reward:  -1052.268596417304
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.28762655412332
DONE TAKING  40  STEPS.
Total reward:  -949.865786754526
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -17.975002475232973
DONE TAKING  40  STEPS.
Total reward:  -616.8765768662844
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.768416493774964
DONE TAKING  40  STEPS.
Total reward:  -921.724771871501
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -13.37984635590207
DONE TAKING  40  STEPS.
Total reward:  -471.6275345920762
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.78782544873029
DONE TAKING  40  STEPS.
Total reward:  -791.958047434297
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.18451334807267
DONE TAKING  40  STEPS.
Total reward:  -836.665926914043
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.82333695307551
DONE TAKING  40  STEPS.
Total reward:  -650.2317357076818
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.401734747887126
DONE TAKING  40  STEPS.
Total reward:  -1008.6813734778473
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.114245094151098
DONE TAKING  40  STEPS.
Total reward:  -315.91993871147173
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.920295417042244
DONE TAKING  40  STEPS.
Total reward:  -665.2870743520267
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -10.34312836944431
DONE TAKING  40  STEPS.
Total reward:  -264.6125804017499
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.33955229463222
DONE TAKING  40  STEPS.
Total reward:  -431.3012733123372
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter8.ckpt

#####################################
Training the dynamics model..... iteration  9
#####################################

    amount of random data:  8000
    amount of onPol data:  13284
Prob rand:  9555
On pol:  12960
Prob shape:  (22515,)

=== Epoch 0 ===
    train loss:  0.49429609886435577
    val rand:  0.38485944271087646
    val onPol:  0.3408246636390686

=== Epoch 10 ===
    train loss:  0.1824258929768274
    val rand:  0.17872236669063568
    val onPol:  0.2930174916982651

=== Epoch 20 ===
    train loss:  0.13808262712040612
    val rand:  0.1540297120809555
    val onPol:  0.2924024313688278

=== Epoch 30 ===
    train loss:  0.10849542517301648
    val rand:  0.15043048560619354
    val onPol:  0.29609306156635284

=== Epoch 39 ===
    train loss:  0.0940602440820184
    val rand:  0.1484132707118988
    val onPol:  0.3014845922589302
Training duration: 10.72 s

#####################################
performing on-policy MPC rollouts... iter  9
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.602251712739562
DONE TAKING  40  STEPS.
Total reward:  -730.7169487048326
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.4878971535846
DONE TAKING  40  STEPS.
Total reward:  -320.0953076951307
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.583019694402864
DONE TAKING  40  STEPS.
Total reward:  -726.3050684228236
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -12.573480078380936
DONE TAKING  40  STEPS.
Total reward:  -116.16924614956196
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.047733164281503
DONE TAKING  40  STEPS.
Total reward:  -558.074326223311
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.25472635564384
DONE TAKING  40  STEPS.
Total reward:  -826.5897441708177
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.217183414684236
DONE TAKING  40  STEPS.
Total reward:  -586.4275380761482
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -10.444286914376132
DONE TAKING  40  STEPS.
Total reward:  -323.5718136603052
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -19.266252277739532
DONE TAKING  40  STEPS.
Total reward:  -458.09521583868866
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.1709039256191
DONE TAKING  40  STEPS.
Total reward:  -667.5334936405092
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.235292026325702
DONE TAKING  40  STEPS.
Total reward:  -470.0202831928509
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.972661949989337
DONE TAKING  40  STEPS.
Total reward:  -764.3743032579114
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.634954185483195
DONE TAKING  40  STEPS.
Total reward:  -700.2960480604291
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -30.73699423995915
DONE TAKING  40  STEPS.
Total reward:  -970.75379950826
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.66704196745806
DONE TAKING  40  STEPS.
Total reward:  -700.7813703295318
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -14.171238153628245
DONE TAKING  40  STEPS.
Total reward:  -257.1697061709257
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.903769361076833
DONE TAKING  40  STEPS.
Total reward:  -686.3475498599213
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.817187177307204
DONE TAKING  40  STEPS.
Total reward:  -312.01248987861044
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -15.434484141565008
DONE TAKING  40  STEPS.
Total reward:  -515.9546559143263
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.407848045135264
DONE TAKING  40  STEPS.
Total reward:  -487.4379617503707
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.627141242150337
DONE TAKING  40  STEPS.
Total reward:  -595.40164828852
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.401634487080756
DONE TAKING  40  STEPS.
Total reward:  -348.22462466517356
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.814162544799863
DONE TAKING  40  STEPS.
Total reward:  -769.061072880887
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.68912889839442
DONE TAKING  40  STEPS.
Total reward:  -952.1175134776718
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -12.94983080257107
DONE TAKING  40  STEPS.
Total reward:  -491.400816363047
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.849045536835824
DONE TAKING  40  STEPS.
Total reward:  -435.2543852309965
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.467173980945024
DONE TAKING  40  STEPS.
Total reward:  -1060.4672208935733
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.58133404092368
DONE TAKING  40  STEPS.
Total reward:  -573.2475093893909
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.603715822227347
DONE TAKING  40  STEPS.
Total reward:  -1100.0691601222159
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.091663587187835
DONE TAKING  40  STEPS.
Total reward:  -715.3167433447067
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.835064515833402
DONE TAKING  40  STEPS.
Total reward:  -763.5545342430121
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.746358962841775
DONE TAKING  40  STEPS.
Total reward:  -684.561828605364
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.479576778779155
DONE TAKING  40  STEPS.
Total reward:  -699.380838601185
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.897811302659772
DONE TAKING  40  STEPS.
Total reward:  -748.2348787760219
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -9.41371195879564
DONE TAKING  40  STEPS.
Total reward:  -324.7208322691397
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.491867678435298
DONE TAKING  40  STEPS.
Total reward:  -664.8933696520573
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -19.343908540392007
DONE TAKING  40  STEPS.
Total reward:  -534.4577960336536
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.867829090122683
DONE TAKING  40  STEPS.
Total reward:  -777.4485862754694
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -17.751244400753983
DONE TAKING  40  STEPS.
Total reward:  -377.3809039538053
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -17.33002021626167
DONE TAKING  40  STEPS.
Total reward:  -465.5746475542702
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter9.ckpt

#####################################
Training the dynamics model..... iteration  10
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  9750
On pol:  14400
Prob shape:  (24150,)

=== Epoch 0 ===
    train loss:  0.474440409782085
    val rand:  0.39607128500938416
    val onPol:  0.3240506152311961

=== Epoch 10 ===
    train loss:  0.18121751920974
    val rand:  0.17924252152442932
    val onPol:  0.2776879320542018

=== Epoch 20 ===
    train loss:  0.136684960507332
    val rand:  0.1517026126384735
    val onPol:  0.2748652348915736

=== Epoch 30 ===
    train loss:  0.11066922656399139
    val rand:  0.14950665831565857
    val onPol:  0.2827931046485901

=== Epoch 39 ===
    train loss:  0.09349884869570428
    val rand:  0.15231649577617645
    val onPol:  0.2909481922785441
Training duration: 11.76 s

#####################################
performing on-policy MPC rollouts... iter  10
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -27.870051189949912
DONE TAKING  40  STEPS.
Total reward:  -586.9250664891013
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -13.69804220840079
DONE TAKING  40  STEPS.
Total reward:  -340.3316729605286
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.19548581010052
DONE TAKING  40  STEPS.
Total reward:  -825.1534337690111
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.24528882280814
DONE TAKING  40  STEPS.
Total reward:  -565.534199170901
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.448696419303925
DONE TAKING  40  STEPS.
Total reward:  -805.9591891550672
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.850347349522284
DONE TAKING  40  STEPS.
Total reward:  -680.2485281373338
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.93369345609415
DONE TAKING  40  STEPS.
Total reward:  -630.4488929336352
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.25310387051238
DONE TAKING  40  STEPS.
Total reward:  -708.9785686518584
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.726924811617682
DONE TAKING  40  STEPS.
Total reward:  -307.50037989474674
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -18.13256640329049
DONE TAKING  40  STEPS.
Total reward:  -517.7767858588186
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.255862158950805
DONE TAKING  40  STEPS.
Total reward:  -809.0601638769793
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.14914718360207
DONE TAKING  40  STEPS.
Total reward:  -899.7372526322447
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.219401082452734
DONE TAKING  40  STEPS.
Total reward:  -894.4057447695561
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.216870759393707
DONE TAKING  40  STEPS.
Total reward:  -489.8920332208793
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -21.658502433227792
DONE TAKING  40  STEPS.
Total reward:  -704.6711948938926
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.05263794917987
DONE TAKING  40  STEPS.
Total reward:  -539.0864093168171
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -14.205128652721548
DONE TAKING  40  STEPS.
Total reward:  -395.9620359704467
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.57583025844675
DONE TAKING  40  STEPS.
Total reward:  -308.69547382635875
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.05113239968362
DONE TAKING  40  STEPS.
Total reward:  -789.2686943296065
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.304888403550585
DONE TAKING  40  STEPS.
Total reward:  -708.0048000659227
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.36912886419692
DONE TAKING  40  STEPS.
Total reward:  -838.8170159244531
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -16.610345150047053
DONE TAKING  40  STEPS.
Total reward:  -470.1646367276217
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.93507068643659
DONE TAKING  40  STEPS.
Total reward:  -830.3133019300991
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.210283687910724
DONE TAKING  40  STEPS.
Total reward:  -810.245581109801
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.565621239780732
DONE TAKING  40  STEPS.
Total reward:  -730.626540220975
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.38252185434426
DONE TAKING  40  STEPS.
Total reward:  -1041.1634437931157
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.16892689655169
DONE TAKING  40  STEPS.
Total reward:  -624.2069650408037
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.734214160195943
DONE TAKING  40  STEPS.
Total reward:  -387.7098464759777
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.213721285969875
DONE TAKING  40  STEPS.
Total reward:  -506.29383374090145
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.05320571288467
DONE TAKING  40  STEPS.
Total reward:  -765.6247642790331
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.448817930171014
DONE TAKING  40  STEPS.
Total reward:  -506.19710227285447
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.28162344806308
DONE TAKING  40  STEPS.
Total reward:  -926.6499311448171
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.75656051290297
DONE TAKING  40  STEPS.
Total reward:  -511.3786763386824
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.839294574398053
DONE TAKING  40  STEPS.
Total reward:  -435.5660247138854
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.074330610315428
DONE TAKING  40  STEPS.
Total reward:  -500.6864886254566
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.435859300674345
DONE TAKING  40  STEPS.
Total reward:  -540.1523558616194
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.98445287432405
DONE TAKING  40  STEPS.
Total reward:  -249.92466937997244
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.834122080929284
DONE TAKING  40  STEPS.
Total reward:  -394.5975349816359
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.81766829436667
DONE TAKING  40  STEPS.
Total reward:  -881.7144809126311
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.43179066395313
DONE TAKING  40  STEPS.
Total reward:  -588.1023368745796
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter10.ckpt

#####################################
Training the dynamics model..... iteration  11
#####################################

    amount of random data:  8000
    amount of onPol data:  16236
Prob rand:  9945
On pol:  15840
Prob shape:  (25785,)

=== Epoch 0 ===
    train loss:  0.480094718337059
    val rand:  0.3847223222255707
    val onPol:  0.3212135334809621

=== Epoch 10 ===
    train loss:  0.1847175693511963
    val rand:  0.18521903455257416
    val onPol:  0.2763322095076243

=== Epoch 20 ===
    train loss:  0.14078763842582703
    val rand:  0.15919315814971924
    val onPol:  0.2786887635787328

=== Epoch 30 ===
    train loss:  0.11471169590950012
    val rand:  0.1503162980079651
    val onPol:  0.2828299204508464

=== Epoch 39 ===
    train loss:  0.0972994638979435
    val rand:  0.1505504548549652
    val onPol:  0.28789662818113965
Training duration: 12.87 s

#####################################
performing on-policy MPC rollouts... iter  11
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -13.174721969194096
DONE TAKING  40  STEPS.
Total reward:  -424.87634967530784
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.417033037838024
DONE TAKING  40  STEPS.
Total reward:  -863.377827147993
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.126883809129566
DONE TAKING  40  STEPS.
Total reward:  -852.3509821210117
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.471282463219815
DONE TAKING  40  STEPS.
Total reward:  -739.6070158831126
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.419544257029347
DONE TAKING  40  STEPS.
Total reward:  -664.664816635016
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -28.078023238491948
DONE TAKING  40  STEPS.
Total reward:  -687.0069201090781
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -10.409024643284571
DONE TAKING  40  STEPS.
Total reward:  84.73085321799417
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.59575393947492
DONE TAKING  40  STEPS.
Total reward:  -620.2752942015745
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -31.310646964515854
DONE TAKING  40  STEPS.
Total reward:  -783.7421620561885
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.794087024830176
DONE TAKING  40  STEPS.
Total reward:  -400.7855362209981
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.58628271632964
DONE TAKING  40  STEPS.
Total reward:  -541.8398687660261
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.29854026991978
DONE TAKING  40  STEPS.
Total reward:  -409.4842622579554
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -16.254708025698086
DONE TAKING  40  STEPS.
Total reward:  -366.2816759316625
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.38608380888595
DONE TAKING  40  STEPS.
Total reward:  -786.7036115302753
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.75393347214894
DONE TAKING  40  STEPS.
Total reward:  -602.0163883567869
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.343939260546257
DONE TAKING  40  STEPS.
Total reward:  -619.6103679072255
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.881313232305574
DONE TAKING  40  STEPS.
Total reward:  -396.21779489565915
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.044023930540618
DONE TAKING  40  STEPS.
Total reward:  -781.2724197038739
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.453538099785582
DONE TAKING  40  STEPS.
Total reward:  -270.8013111150707
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.479277928166333
DONE TAKING  40  STEPS.
Total reward:  -948.4829909275991
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -18.53405831985379
DONE TAKING  40  STEPS.
Total reward:  -670.7756266102565
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.682164974803626
DONE TAKING  40  STEPS.
Total reward:  -736.5542941841779
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.78564146850522
DONE TAKING  40  STEPS.
Total reward:  -585.1851429924099
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.317300562160344
DONE TAKING  40  STEPS.
Total reward:  -463.81530594696994
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.007838957798697
DONE TAKING  40  STEPS.
Total reward:  -650.7174779168798
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -31.10413484020439
DONE TAKING  40  STEPS.
Total reward:  -997.6268980231021
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.221484752910055
DONE TAKING  40  STEPS.
Total reward:  -853.5424383271626
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.612784630024773
DONE TAKING  40  STEPS.
Total reward:  -628.6659988054138
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -31.39532228255569
DONE TAKING  40  STEPS.
Total reward:  -749.6508959686405
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.561510514848
DONE TAKING  40  STEPS.
Total reward:  -817.8982376166459
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.526371753969322
DONE TAKING  40  STEPS.
Total reward:  -853.4707668797765
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -17.693292561773276
DONE TAKING  40  STEPS.
Total reward:  -280.1659637808307
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.52700545027797
DONE TAKING  40  STEPS.
Total reward:  -509.3885111906258
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.574767415566097
DONE TAKING  40  STEPS.
Total reward:  -752.1709252068912
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.868265292525255
DONE TAKING  40  STEPS.
Total reward:  -505.89869837282566
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.39149686345932
DONE TAKING  40  STEPS.
Total reward:  -479.53991004106166
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.088645016916388
DONE TAKING  40  STEPS.
Total reward:  -677.5791829763442
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.295708128697584
DONE TAKING  40  STEPS.
Total reward:  -978.1368797697529
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -12.97494403854438
DONE TAKING  40  STEPS.
Total reward:  -465.84122413451547
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.709113286641855
DONE TAKING  40  STEPS.
Total reward:  -492.9209180802804
Time for 1 rollout: 1.05 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter11.ckpt

#####################################
Training the dynamics model..... iteration  12
#####################################

    amount of random data:  8000
    amount of onPol data:  17712
Prob rand:  10140
On pol:  17280
Prob shape:  (27420,)

=== Epoch 0 ===
    train loss:  0.46565240171720396
    val rand:  0.3935537338256836
    val onPol:  0.31811944643656415

=== Epoch 10 ===
    train loss:  0.18499886595977927
    val rand:  0.18420416116714478
    val onPol:  0.27031564712524414

=== Epoch 20 ===
    train loss:  0.1388923208106239
    val rand:  0.1551624983549118
    val onPol:  0.273199920852979

=== Epoch 30 ===
    train loss:  0.11426930663720616
    val rand:  0.15416288375854492
    val onPol:  0.277058482170105

=== Epoch 39 ===
    train loss:  0.09725321969895992
    val rand:  0.151211678981781
    val onPol:  0.28396834433078766
Training duration: 13.58 s

#####################################
performing on-policy MPC rollouts... iter  12
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -13.266655592129803
DONE TAKING  40  STEPS.
Total reward:  -414.40692537471733
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.09887714320519
DONE TAKING  40  STEPS.
Total reward:  -939.778906566736
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.561571507440036
DONE TAKING  40  STEPS.
Total reward:  -722.0221770830116
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.780921076541567
DONE TAKING  40  STEPS.
Total reward:  -688.7520612484071
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.73276857532856
DONE TAKING  40  STEPS.
Total reward:  -560.4956011293335
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -12.993873420593893
DONE TAKING  40  STEPS.
Total reward:  -423.7878643926623
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.806053650824136
DONE TAKING  40  STEPS.
Total reward:  -717.6382657866991
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.498542922326436
DONE TAKING  40  STEPS.
Total reward:  -690.8942509667091
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.267975684114234
DONE TAKING  40  STEPS.
Total reward:  -1037.1689613799826
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.158940116992486
DONE TAKING  40  STEPS.
Total reward:  -958.8089798210843
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.465008734228814
DONE TAKING  40  STEPS.
Total reward:  -752.2514867003739
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.38470946824789
DONE TAKING  40  STEPS.
Total reward:  -692.4673214584142
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.99422045823063
DONE TAKING  40  STEPS.
Total reward:  -917.9574348435946
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.545806926105733
DONE TAKING  40  STEPS.
Total reward:  -636.8099383213013
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.001887343769905
DONE TAKING  40  STEPS.
Total reward:  -426.05005838083275
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.908534653246562
DONE TAKING  40  STEPS.
Total reward:  -412.9226535273968
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -28.36687156600157
DONE TAKING  40  STEPS.
Total reward:  -642.3480871349196
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -11.835236172759558
DONE TAKING  40  STEPS.
Total reward:  -366.0508787971839
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.599682933483525
DONE TAKING  40  STEPS.
Total reward:  -812.6741526420836
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.608108565806756
DONE TAKING  40  STEPS.
Total reward:  -730.5739940358615
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.07917154446612
DONE TAKING  40  STEPS.
Total reward:  -138.61306006612142
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.737467234396487
DONE TAKING  40  STEPS.
Total reward:  -549.4566594322044
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.44551424942191
DONE TAKING  40  STEPS.
Total reward:  -684.7197107758309
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.628033886089867
DONE TAKING  40  STEPS.
Total reward:  -489.4804715093155
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -31.214801138963644
DONE TAKING  40  STEPS.
Total reward:  -739.6100494391596
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -18.834555118581967
DONE TAKING  40  STEPS.
Total reward:  -550.3758377190331
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.18254626082227
DONE TAKING  40  STEPS.
Total reward:  -552.1590342626411
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -14.82101022501574
DONE TAKING  40  STEPS.
Total reward:  -418.0398304253937
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.551134107188656
DONE TAKING  40  STEPS.
Total reward:  -376.4762357009415
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.798985476115337
DONE TAKING  40  STEPS.
Total reward:  -819.9844850905595
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.902889499663438
DONE TAKING  40  STEPS.
Total reward:  -518.8619153062548
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.62871994447935
DONE TAKING  40  STEPS.
Total reward:  -516.9719954860304
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.22396668365858
DONE TAKING  40  STEPS.
Total reward:  -612.4884518075122
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.3026430662571
DONE TAKING  40  STEPS.
Total reward:  -513.6394354238379
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.131316302725946
DONE TAKING  40  STEPS.
Total reward:  -619.6664180148413
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.493363116520783
DONE TAKING  40  STEPS.
Total reward:  -93.3221060058137
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.757964324329386
DONE TAKING  40  STEPS.
Total reward:  -872.6348793062236
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.438304986450408
DONE TAKING  40  STEPS.
Total reward:  -647.8105122849736
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.684592982739213
DONE TAKING  40  STEPS.
Total reward:  -520.5577242457633
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.955127626246746
DONE TAKING  40  STEPS.
Total reward:  -512.860055724911
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter12.ckpt

#####################################
Training the dynamics model..... iteration  13
#####################################

    amount of random data:  8000
    amount of onPol data:  19188
Prob rand:  10335
On pol:  18720
Prob shape:  (29055,)

=== Epoch 0 ===
    train loss:  0.46536502508180483
    val rand:  0.40475648641586304
    val onPol:  0.30585048347711563

=== Epoch 10 ===
    train loss:  0.18719042837619781
    val rand:  0.18613383173942566
    val onPol:  0.26227160915732384

=== Epoch 20 ===
    train loss:  0.14350168566618646
    val rand:  0.1605108380317688
    val onPol:  0.26025406643748283

=== Epoch 30 ===
    train loss:  0.11754790520561594
    val rand:  0.15388663113117218
    val onPol:  0.26445218175649643

=== Epoch 39 ===
    train loss:  0.09940567253423589
    val rand:  0.1539437621831894
    val onPol:  0.27012651041150093
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  13
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.71998338821274
DONE TAKING  40  STEPS.
Total reward:  -375.84145330558954
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.27262431145367
DONE TAKING  40  STEPS.
Total reward:  -229.3015376849914
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.47461594550381
DONE TAKING  40  STEPS.
Total reward:  -643.8881565350265
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -19.297750395869937
DONE TAKING  40  STEPS.
Total reward:  -623.8044474337416
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.120597658422998
DONE TAKING  40  STEPS.
Total reward:  -365.10898216643466
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.072785113630168
DONE TAKING  40  STEPS.
Total reward:  179.76932747119426
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.33753619903335
DONE TAKING  40  STEPS.
Total reward:  -916.186498287823
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.230821590142675
DONE TAKING  40  STEPS.
Total reward:  -478.43673526892445
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.98613373123178
DONE TAKING  40  STEPS.
Total reward:  -1053.09166199683
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.088970800409363
DONE TAKING  40  STEPS.
Total reward:  -730.800425959388
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.451391458014346
DONE TAKING  40  STEPS.
Total reward:  -1013.8058656044366
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.182853420587758
DONE TAKING  40  STEPS.
Total reward:  -839.059702016267
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.176998737484938
DONE TAKING  40  STEPS.
Total reward:  -343.6713357949505
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.340610730981908
DONE TAKING  40  STEPS.
Total reward:  -673.5732005368192
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.060011125639647
DONE TAKING  40  STEPS.
Total reward:  -382.72216240046663
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.756952819134494
DONE TAKING  40  STEPS.
Total reward:  -852.843739052346
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -15.963707554647515
DONE TAKING  40  STEPS.
Total reward:  -428.5480966933025
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.55946819878619
DONE TAKING  40  STEPS.
Total reward:  -711.8691143772984
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.313524994947738
DONE TAKING  40  STEPS.
Total reward:  -705.5693022002918
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.1538546376056
DONE TAKING  40  STEPS.
Total reward:  -747.4120530899348
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.299292161104
DONE TAKING  40  STEPS.
Total reward:  -634.1128170393879
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.69847682950994
DONE TAKING  40  STEPS.
Total reward:  -379.49315611489413
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.991629845032534
DONE TAKING  40  STEPS.
Total reward:  -776.8884319938743
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.924375847051948
DONE TAKING  40  STEPS.
Total reward:  -717.9484106265248
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.053860677310944
DONE TAKING  40  STEPS.
Total reward:  -715.5397371565302
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.206564147922375
DONE TAKING  40  STEPS.
Total reward:  -381.6878330524096
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.654113361489127
DONE TAKING  40  STEPS.
Total reward:  -721.2970305138011
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.92733784343136
DONE TAKING  40  STEPS.
Total reward:  -484.69081837055813
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -18.91606400738366
DONE TAKING  40  STEPS.
Total reward:  -453.5363705516648
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -11.237284742264714
DONE TAKING  40  STEPS.
Total reward:  -308.8589561941309
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.12688889463493
DONE TAKING  40  STEPS.
Total reward:  -616.957276213559
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.919765285965173
DONE TAKING  40  STEPS.
Total reward:  -946.3022580173047
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.87578504257572
DONE TAKING  40  STEPS.
Total reward:  -594.037460321636
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -29.876493282241366
DONE TAKING  40  STEPS.
Total reward:  -681.6540011451723
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.469715851209827
DONE TAKING  40  STEPS.
Total reward:  -229.01248700471672
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.096539428380275
DONE TAKING  40  STEPS.
Total reward:  -459.11824472777795
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -14.194919127714265
DONE TAKING  40  STEPS.
Total reward:  -589.4157658338844
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.83933977449287
DONE TAKING  40  STEPS.
Total reward:  -631.7371308293664
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -21.34883203820032
DONE TAKING  40  STEPS.
Total reward:  -721.7930057636067
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.655253765929697
DONE TAKING  40  STEPS.
Total reward:  -887.4105145635746
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter13.ckpt

#####################################
Training the dynamics model..... iteration  14
#####################################

    amount of random data:  8000
    amount of onPol data:  20664
Prob rand:  10530
On pol:  20160
Prob shape:  (30690,)

=== Epoch 0 ===
    train loss:  0.46164133286072034
    val rand:  0.39458712935447693
    val onPol:  0.2970239520072937

=== Epoch 10 ===
    train loss:  0.19183894537262997
    val rand:  0.18890461325645447
    val onPol:  0.2583145201206207

=== Epoch 20 ===
    train loss:  0.14487605403035375
    val rand:  0.16179466247558594
    val onPol:  0.2557365372776985

=== Epoch 30 ===
    train loss:  0.11774744371236381
    val rand:  0.1554803103208542
    val onPol:  0.25943562760949135

=== Epoch 39 ===
    train loss:  0.10233235750663078
    val rand:  0.15771090984344482
    val onPol:  0.26556675136089325
Training duration: 15.31 s

#####################################
performing on-policy MPC rollouts... iter  14
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -31.117078568967283
DONE TAKING  40  STEPS.
Total reward:  -699.0430642919089
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.86122671300835
DONE TAKING  40  STEPS.
Total reward:  -423.79110657713005
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.03356150331154
DONE TAKING  40  STEPS.
Total reward:  -524.118119072289
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -15.589943420406856
DONE TAKING  40  STEPS.
Total reward:  -439.1864277794491
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.586652979478814
DONE TAKING  40  STEPS.
Total reward:  -674.0987541792853
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.59181589108758
DONE TAKING  40  STEPS.
Total reward:  -606.085607838735
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.488332013207305
DONE TAKING  40  STEPS.
Total reward:  -706.6914887777158
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.852513921657252
DONE TAKING  40  STEPS.
Total reward:  -487.347893097495
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.83124725830095
DONE TAKING  40  STEPS.
Total reward:  -900.3949956353276
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.726308757782114
DONE TAKING  40  STEPS.
Total reward:  -592.7390628799202
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.117008511872044
DONE TAKING  40  STEPS.
Total reward:  -723.9973220561684
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.209148614207006
DONE TAKING  40  STEPS.
Total reward:  -879.0228066249384
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.220056306760387
DONE TAKING  40  STEPS.
Total reward:  -815.8327639689747
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.324195206981827
DONE TAKING  40  STEPS.
Total reward:  -579.1368135668329
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.726572185101507
DONE TAKING  40  STEPS.
Total reward:  -295.3963015565799
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.745324868287735
DONE TAKING  40  STEPS.
Total reward:  -615.3052477042958
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.573546527788515
DONE TAKING  40  STEPS.
Total reward:  -840.6255783932812
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.36097321102273
DONE TAKING  40  STEPS.
Total reward:  -670.5662335279313
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.92680797017107
DONE TAKING  40  STEPS.
Total reward:  -777.543216016792
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -18.287762634107526
DONE TAKING  40  STEPS.
Total reward:  -400.895939467646
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.545025972035667
DONE TAKING  40  STEPS.
Total reward:  -608.8400625874647
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.491646054111335
DONE TAKING  40  STEPS.
Total reward:  -975.4559729515319
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.748970168483325
DONE TAKING  40  STEPS.
Total reward:  -527.6413456744604
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -20.500242342190003
DONE TAKING  40  STEPS.
Total reward:  -578.8141904506269
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -26.490595028411636
DONE TAKING  40  STEPS.
Total reward:  -656.6547418483635
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.274866003102403
DONE TAKING  40  STEPS.
Total reward:  -882.448335286102
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.268703506022913
DONE TAKING  40  STEPS.
Total reward:  -619.8601298310763
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.494518673084343
DONE TAKING  40  STEPS.
Total reward:  -327.31398405357487
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.330388007326626
DONE TAKING  40  STEPS.
Total reward:  -1047.9142265083674
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.021855476750325
DONE TAKING  40  STEPS.
Total reward:  -408.8237322278136
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.611346505924768
DONE TAKING  40  STEPS.
Total reward:  -726.4340896587394
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.197809194825814
DONE TAKING  40  STEPS.
Total reward:  -367.6785754048843
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -10.739423346333181
DONE TAKING  40  STEPS.
Total reward:  -269.51220693606746
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -18.906653523802
DONE TAKING  40  STEPS.
Total reward:  -558.7517922321882
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.40891949614801
DONE TAKING  40  STEPS.
Total reward:  -630.9623834286944
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.05669638355457
DONE TAKING  40  STEPS.
Total reward:  -560.4838968471882
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.856294706685453
DONE TAKING  40  STEPS.
Total reward:  -643.8530456028029
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.34657163440793
DONE TAKING  40  STEPS.
Total reward:  -564.8567817926823
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.862851835947854
DONE TAKING  40  STEPS.
Total reward:  -514.1115966527746
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -19.286397725891664
DONE TAKING  40  STEPS.
Total reward:  -435.4847858734928
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter14.ckpt

#####################################
Training the dynamics model..... iteration  15
#####################################

    amount of random data:  8000
    amount of onPol data:  22140
Prob rand:  10725
On pol:  21600
Prob shape:  (32325,)

=== Epoch 0 ===
    train loss:  0.45061510233652025
    val rand:  0.3893190324306488
    val onPol:  0.30009762942790985

=== Epoch 10 ===
    train loss:  0.1887145813495394
    val rand:  0.18179677426815033
    val onPol:  0.2568139135837555

=== Epoch 20 ===
    train loss:  0.14394610363339622
    val rand:  0.15839962661266327
    val onPol:  0.2545038089156151

=== Epoch 30 ===
    train loss:  0.11677624155131597
    val rand:  0.1574326455593109
    val onPol:  0.25962063297629356

=== Epoch 39 ===
    train loss:  0.0996260628813789
    val rand:  0.15365946292877197
    val onPol:  0.2683265097439289
Training duration: 16.12 s

#####################################
performing on-policy MPC rollouts... iter  15
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.72125525259785
DONE TAKING  40  STEPS.
Total reward:  6.56569647624524
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.43362669922926
DONE TAKING  40  STEPS.
Total reward:  -665.0724784942194
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.75049372258096
DONE TAKING  40  STEPS.
Total reward:  -413.5661320040144
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.549737287712436
DONE TAKING  40  STEPS.
Total reward:  -361.0754220323913
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -19.676333820061704
DONE TAKING  40  STEPS.
Total reward:  -546.489632916676
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.273768102318568
DONE TAKING  40  STEPS.
Total reward:  104.8359172976434
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.22588883875501
DONE TAKING  40  STEPS.
Total reward:  -945.1061799523
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -18.100598594127106
DONE TAKING  40  STEPS.
Total reward:  -474.9127895223845
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -30.35093084770442
DONE TAKING  40  STEPS.
Total reward:  -931.598192925261
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -23.914291510979368
DONE TAKING  40  STEPS.
Total reward:  -407.7878271813495
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.530352359903823
DONE TAKING  40  STEPS.
Total reward:  -683.3256798068678
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.58113394618534
DONE TAKING  40  STEPS.
Total reward:  -736.597464251842
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.68590226680174
DONE TAKING  40  STEPS.
Total reward:  -210.5727148377215
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.26970750706521
DONE TAKING  40  STEPS.
Total reward:  -375.5092255472679
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.132909898332542
DONE TAKING  40  STEPS.
Total reward:  -565.1260831155344
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.170145375678217
DONE TAKING  40  STEPS.
Total reward:  -366.8012659437529
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.157519730150852
DONE TAKING  40  STEPS.
Total reward:  -704.5419259422458
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -15.654420814912786
DONE TAKING  40  STEPS.
Total reward:  -534.623794019235
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.536738834666597
DONE TAKING  40  STEPS.
Total reward:  -932.162638618012
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -14.584481961500481
DONE TAKING  40  STEPS.
Total reward:  -531.3337400366232
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.07659571489269
DONE TAKING  40  STEPS.
Total reward:  -724.1760861016064
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.71270281871386
DONE TAKING  40  STEPS.
Total reward:  -631.6532390880699
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -13.24420981546885
DONE TAKING  40  STEPS.
Total reward:  -325.0987466577743
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.444894898898294
DONE TAKING  40  STEPS.
Total reward:  -846.0859547355888
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.49456271010482
DONE TAKING  40  STEPS.
Total reward:  -684.2774162774618
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.745891372623593
DONE TAKING  40  STEPS.
Total reward:  -748.6627752260002
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.126290912926862
DONE TAKING  40  STEPS.
Total reward:  -1022.0561812117265
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -14.916623476139495
DONE TAKING  40  STEPS.
Total reward:  -435.64005847755186
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.791442908631062
DONE TAKING  40  STEPS.
Total reward:  -904.0963078249439
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.70438886688021
DONE TAKING  40  STEPS.
Total reward:  -860.8466837090857
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.07279047619097
DONE TAKING  40  STEPS.
Total reward:  -558.8767228562317
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.17757774842158
DONE TAKING  40  STEPS.
Total reward:  -506.36185346232804
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.0271480353015
DONE TAKING  40  STEPS.
Total reward:  -737.1134360469521
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.8098783872067
DONE TAKING  40  STEPS.
Total reward:  -639.1793291865097
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -12.971594462428943
DONE TAKING  40  STEPS.
Total reward:  -455.06004171250703
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.35039266205513
DONE TAKING  40  STEPS.
Total reward:  -860.3458001858186
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.789105139885464
DONE TAKING  40  STEPS.
Total reward:  -856.1050147866969
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.776885590012704
DONE TAKING  40  STEPS.
Total reward:  -213.05268218070682
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.751846831765597
DONE TAKING  40  STEPS.
Total reward:  -643.9641704451305
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.58939755310145
DONE TAKING  40  STEPS.
Total reward:  -407.36939578765526
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter15.ckpt

#####################################
Training the dynamics model..... iteration  16
#####################################

    amount of random data:  8000
    amount of onPol data:  23616
Prob rand:  10920
On pol:  23040
Prob shape:  (33960,)

=== Epoch 0 ===
    train loss:  0.43750019958524994
    val rand:  0.387877881526947
    val onPol:  0.3016083061695099

=== Epoch 10 ===
    train loss:  0.18774424493312836
    val rand:  0.19743072986602783
    val onPol:  0.257095730304718

=== Epoch 20 ===
    train loss:  0.14285179453365732
    val rand:  0.15991321206092834
    val onPol:  0.255139148235321

=== Epoch 30 ===
    train loss:  0.11813326225136266
    val rand:  0.1563698798418045
    val onPol:  0.26247555017471313

=== Epoch 39 ===
    train loss:  0.09985275544000394
    val rand:  0.1515997052192688
    val onPol:  0.2699671030044556
Training duration: 16.93 s

#####################################
performing on-policy MPC rollouts... iter  16
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.88003791751313
DONE TAKING  40  STEPS.
Total reward:  -833.0310093939217
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -28.96684370760969
DONE TAKING  40  STEPS.
Total reward:  -694.544841425028
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.304806207633348
DONE TAKING  40  STEPS.
Total reward:  -596.7164423797744
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -11.11762763748641
DONE TAKING  40  STEPS.
Total reward:  -292.37797104338426
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.49190122432415
DONE TAKING  40  STEPS.
Total reward:  -82.72007353429821
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.07956642906913
DONE TAKING  40  STEPS.
Total reward:  -114.02248813051149
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.280428444818597
DONE TAKING  40  STEPS.
Total reward:  -356.2189519926476
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -31.326883114017928
DONE TAKING  40  STEPS.
Total reward:  -1095.041366756809
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.245652118861617
DONE TAKING  40  STEPS.
Total reward:  -878.9221468632845
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.19446701250009
DONE TAKING  40  STEPS.
Total reward:  -277.0310340950253
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.516072946032427
DONE TAKING  40  STEPS.
Total reward:  -483.3408944241724
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.223412168541703
DONE TAKING  40  STEPS.
Total reward:  -457.2632848977946
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -20.092373963538975
DONE TAKING  40  STEPS.
Total reward:  -694.4168801638418
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.39244666043127
DONE TAKING  40  STEPS.
Total reward:  -478.96515739724197
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.574010304487906
DONE TAKING  40  STEPS.
Total reward:  -474.25920450618804
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.33753646819827
DONE TAKING  40  STEPS.
Total reward:  -838.8205826475703
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.374737808522703
DONE TAKING  40  STEPS.
Total reward:  -806.0818615378879
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.820890986771545
DONE TAKING  40  STEPS.
Total reward:  -946.3276683108933
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -11.591000044290322
DONE TAKING  40  STEPS.
Total reward:  -344.1079266165856
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.492734619695213
DONE TAKING  40  STEPS.
Total reward:  -533.5828333752421
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -31.389208826611675
DONE TAKING  40  STEPS.
Total reward:  -908.2113029443232
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.322186928061182
DONE TAKING  40  STEPS.
Total reward:  -497.6084838527329
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -16.76526067837147
DONE TAKING  40  STEPS.
Total reward:  -559.5055730647417
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.036715770246367
DONE TAKING  40  STEPS.
Total reward:  -594.5801360417038
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -13.556342776620845
DONE TAKING  40  STEPS.
Total reward:  -299.2123766783697
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -13.967095493825388
DONE TAKING  40  STEPS.
Total reward:  -406.71753924769433
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.110707973270692
DONE TAKING  40  STEPS.
Total reward:  -881.2619092047809
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.74516426410296
DONE TAKING  40  STEPS.
Total reward:  -371.34001664955264
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -21.06892532936607
DONE TAKING  40  STEPS.
Total reward:  -645.0218366949717
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -18.768924128099286
DONE TAKING  40  STEPS.
Total reward:  -560.1002074963324
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.82247570929108
DONE TAKING  40  STEPS.
Total reward:  -621.9058821120366
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.773913692949428
DONE TAKING  40  STEPS.
Total reward:  -690.8462184843993
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.492058269142895
DONE TAKING  40  STEPS.
Total reward:  -418.28331537964306
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.33803048005384
DONE TAKING  40  STEPS.
Total reward:  -559.7304216411125
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.48612260608506
DONE TAKING  40  STEPS.
Total reward:  -411.68634310137725
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.110160459831143
DONE TAKING  40  STEPS.
Total reward:  -962.0158450119225
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -26.15127324796677
DONE TAKING  40  STEPS.
Total reward:  -445.8742434797048
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.008459349051385
DONE TAKING  40  STEPS.
Total reward:  -713.8912430191432
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -12.349805132298076
DONE TAKING  40  STEPS.
Total reward:  -409.5507999348687
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.847567459700535
DONE TAKING  40  STEPS.
Total reward:  -869.3253243908628
Time for 1 rollout: 1.04 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter16.ckpt

#####################################
Training the dynamics model..... iteration  17
#####################################

    amount of random data:  8000
    amount of onPol data:  25092
Prob rand:  11115
On pol:  24480
Prob shape:  (35595,)

=== Epoch 0 ===
    train loss:  0.4425300109213677
    val rand:  0.3902280330657959
    val onPol:  0.3031399965286255

=== Epoch 10 ===
    train loss:  0.19297090237555298
    val rand:  0.190460205078125
    val onPol:  0.25977843403816225

=== Epoch 20 ===
    train loss:  0.1478579193353653
    val rand:  0.1607166975736618
    val onPol:  0.2547487676143646

=== Epoch 30 ===
    train loss:  0.12200020588394525
    val rand:  0.16011914610862732
    val onPol:  0.2628661274909973

=== Epoch 39 ===
    train loss:  0.10400451762952666
    val rand:  0.15754792094230652
    val onPol:  0.26837956309318545
Training duration: 20.99 s

#####################################
performing on-policy MPC rollouts... iter  17
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.763058319555604
DONE TAKING  40  STEPS.
Total reward:  -753.2747071867807
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -12.509393377588475
DONE TAKING  40  STEPS.
Total reward:  -334.1084208788644
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -13.696069849771838
DONE TAKING  40  STEPS.
Total reward:  -387.8366586316861
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -19.15157749439143
DONE TAKING  40  STEPS.
Total reward:  -414.86512917436823
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.26176470591797
DONE TAKING  40  STEPS.
Total reward:  -617.3593534969284
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.18083036512754
DONE TAKING  40  STEPS.
Total reward:  -433.86441547721654
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.197284136019743
DONE TAKING  40  STEPS.
Total reward:  -631.548267164705
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.725089304929874
DONE TAKING  40  STEPS.
Total reward:  -699.3118883864958
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -13.759493272024251
DONE TAKING  40  STEPS.
Total reward:  -446.79476819829387
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -12.424163683148597
DONE TAKING  40  STEPS.
Total reward:  -267.97155202459027
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.69426592320474
DONE TAKING  40  STEPS.
Total reward:  -303.6334923530145
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.395791680107546
DONE TAKING  40  STEPS.
Total reward:  -340.47783415791923
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.736752479639218
DONE TAKING  40  STEPS.
Total reward:  -337.4808727967098
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.654475038443348
DONE TAKING  40  STEPS.
Total reward:  -620.8217623424239
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -19.087220400817305
DONE TAKING  40  STEPS.
Total reward:  -484.0201034464427
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.5485755323418
DONE TAKING  40  STEPS.
Total reward:  -367.8684639069725
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -13.44080876890182
DONE TAKING  40  STEPS.
Total reward:  -378.7024472191637
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -18.418376545592903
DONE TAKING  40  STEPS.
Total reward:  -28.555041327245675
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.810885893689107
DONE TAKING  40  STEPS.
Total reward:  -881.1191144552696
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.724958319490927
DONE TAKING  40  STEPS.
Total reward:  -982.0712740618893
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.597141725717577
DONE TAKING  40  STEPS.
Total reward:  -264.2594634121352
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.296405798647505
DONE TAKING  40  STEPS.
Total reward:  -347.2502734385894
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.149658733410128
DONE TAKING  40  STEPS.
Total reward:  -692.1349720678687
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.966883401587591
DONE TAKING  40  STEPS.
Total reward:  -433.79381861973667
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.699132853150683
DONE TAKING  40  STEPS.
Total reward:  -581.8932943911337
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.304393535058296
DONE TAKING  40  STEPS.
Total reward:  -543.6474308543637
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.272315922652894
DONE TAKING  40  STEPS.
Total reward:  -330.5400194196716
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.527246805711492
DONE TAKING  40  STEPS.
Total reward:  -215.6824365012615
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.315627996096058
DONE TAKING  40  STEPS.
Total reward:  -443.76336154408546
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.198317010213916
DONE TAKING  40  STEPS.
Total reward:  -353.04987093767033
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.18266999073679
DONE TAKING  40  STEPS.
Total reward:  -934.0352887544072
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -20.099725956217746
DONE TAKING  40  STEPS.
Total reward:  -642.7011283826345
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.19208456759026
DONE TAKING  40  STEPS.
Total reward:  -414.71081204856125
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.70187693467417
DONE TAKING  40  STEPS.
Total reward:  -781.7842542327003
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.963369818522374
DONE TAKING  40  STEPS.
Total reward:  -598.9543755691699
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -15.279646052141448
DONE TAKING  40  STEPS.
Total reward:  -458.03182177173966
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.187750463849987
DONE TAKING  40  STEPS.
Total reward:  -330.3396073226567
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.64609382501932
DONE TAKING  40  STEPS.
Total reward:  -344.76277862781546
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.364679781832976
DONE TAKING  40  STEPS.
Total reward:  -838.5278374170701
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.595250565020095
DONE TAKING  40  STEPS.
Total reward:  -403.6064046122951
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter17.ckpt

#####################################
Training the dynamics model..... iteration  18
#####################################

    amount of random data:  8000
    amount of onPol data:  26568
Prob rand:  11310
On pol:  25920
Prob shape:  (37230,)

=== Epoch 0 ===
    train loss:  0.4378426666888926
    val rand:  0.38663503527641296
    val onPol:  0.300333970785141

=== Epoch 10 ===
    train loss:  0.1892826236370537
    val rand:  0.18516764044761658
    val onPol:  0.2549055814743042

=== Epoch 20 ===
    train loss:  0.14810691339274248
    val rand:  0.15787939727306366
    val onPol:  0.2521975636482239

=== Epoch 30 ===
    train loss:  0.12253420758578512
    val rand:  0.15913048386573792
    val onPol:  0.2616858512163162

=== Epoch 39 ===
    train loss:  0.10491996941467126
    val rand:  0.15965205430984497
    val onPol:  0.2704010993242264
Training duration: 18.39 s

#####################################
performing on-policy MPC rollouts... iter  18
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.050948801530055
DONE TAKING  40  STEPS.
Total reward:  -683.908592956719
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.64549816696972
DONE TAKING  40  STEPS.
Total reward:  -557.5058688741904
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.635856969212497
DONE TAKING  40  STEPS.
Total reward:  -1048.4761623382474
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.76116017295156
DONE TAKING  40  STEPS.
Total reward:  61.011078965933024
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.184138433933175
DONE TAKING  40  STEPS.
Total reward:  -844.999829904084
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -31.18035356082347
DONE TAKING  40  STEPS.
Total reward:  -619.0278145460763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.91435317131924
DONE TAKING  40  STEPS.
Total reward:  -903.8955420967326
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.58212406586255
DONE TAKING  40  STEPS.
Total reward:  -560.122247464811
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.553698933319943
DONE TAKING  40  STEPS.
Total reward:  -563.5525700846428
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -26.80754849711125
DONE TAKING  40  STEPS.
Total reward:  -676.0800240681306
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.367048983509658
DONE TAKING  40  STEPS.
Total reward:  -685.514552649785
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.72777559585666
DONE TAKING  40  STEPS.
Total reward:  -208.53595259019912
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.935092760598934
DONE TAKING  40  STEPS.
Total reward:  269.62462816087805
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -15.290931056880572
DONE TAKING  40  STEPS.
Total reward:  -540.0819101326728
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.507946998350054
DONE TAKING  40  STEPS.
Total reward:  -384.40704287701897
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -31.098174975029146
DONE TAKING  40  STEPS.
Total reward:  -934.7223148231539
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.422024925458977
DONE TAKING  40  STEPS.
Total reward:  -414.4926260077583
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.270305208267622
DONE TAKING  40  STEPS.
Total reward:  -360.5605564214341
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.525056116418746
DONE TAKING  40  STEPS.
Total reward:  -807.5418643850327
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.633394175580968
DONE TAKING  40  STEPS.
Total reward:  -791.7784468333973
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.811807902499783
DONE TAKING  40  STEPS.
Total reward:  -896.036877665371
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.05993562383265
DONE TAKING  40  STEPS.
Total reward:  -777.1013119936594
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.43282002861558
DONE TAKING  40  STEPS.
Total reward:  -348.2368520063095
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.723349649782776
DONE TAKING  40  STEPS.
Total reward:  -688.5461971818454
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.263640119839252
DONE TAKING  40  STEPS.
Total reward:  -527.4950183974394
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.814661553343132
DONE TAKING  40  STEPS.
Total reward:  -78.99358956333997
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.43973733796375
DONE TAKING  40  STEPS.
Total reward:  -797.6624112595073
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.250239830484862
DONE TAKING  40  STEPS.
Total reward:  -929.5631408440511
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.50090830086522
DONE TAKING  40  STEPS.
Total reward:  -364.6375221100916
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.528817904744376
DONE TAKING  40  STEPS.
Total reward:  -43.714098111643736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -14.505410293532965
DONE TAKING  40  STEPS.
Total reward:  -495.0045073606427
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.851501028413814
DONE TAKING  40  STEPS.
Total reward:  -732.8676758843491
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.559627841456965
DONE TAKING  40  STEPS.
Total reward:  -400.3012359229908
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.661198704751534
DONE TAKING  40  STEPS.
Total reward:  -1088.8325606247756
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.768292008893066
DONE TAKING  40  STEPS.
Total reward:  -523.3937415348979
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.343931763398192
DONE TAKING  40  STEPS.
Total reward:  -794.4662684742375
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.891614302790973
DONE TAKING  40  STEPS.
Total reward:  -666.8666826133046
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -20.200994338385616
DONE TAKING  40  STEPS.
Total reward:  -574.5067640218977
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -16.686871807885915
DONE TAKING  40  STEPS.
Total reward:  -270.58245570204843
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.88980357822289
DONE TAKING  40  STEPS.
Total reward:  -365.431570491308
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter18.ckpt

#####################################
Training the dynamics model..... iteration  19
#####################################

    amount of random data:  8000
    amount of onPol data:  28044
Prob rand:  11505
On pol:  27360
Prob shape:  (38865,)

=== Epoch 0 ===
    train loss:  0.4415832738081614
    val rand:  0.4075394868850708
    val onPol:  0.29641217887401583

=== Epoch 10 ===
    train loss:  0.19573492785294852
    val rand:  0.19031426310539246
    val onPol:  0.25203742980957033

=== Epoch 20 ===
    train loss:  0.15170376737912497
    val rand:  0.16100582480430603
    val onPol:  0.25108811259269714

=== Epoch 30 ===
    train loss:  0.1256391700108846
    val rand:  0.1526796668767929
    val onPol:  0.256312757730484

=== Epoch 39 ===
    train loss:  0.10659813821315765
    val rand:  0.15127456188201904
    val onPol:  0.26216728091239927
Training duration: 19.23 s

#####################################
performing on-policy MPC rollouts... iter  19
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.550203932326866
DONE TAKING  40  STEPS.
Total reward:  -482.79853506373075
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.134346579547838
DONE TAKING  40  STEPS.
Total reward:  -849.1829128858005
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.095402449571154
DONE TAKING  40  STEPS.
Total reward:  314.0494524137015
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.877083404212307
DONE TAKING  40  STEPS.
Total reward:  -771.5497591599158
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.796783582582396
DONE TAKING  40  STEPS.
Total reward:  -1068.8356232161884
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.467721581809126
DONE TAKING  40  STEPS.
Total reward:  -308.83140746352166
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.191924096163284
DONE TAKING  40  STEPS.
Total reward:  -547.9888732919077
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -19.480146145340456
DONE TAKING  40  STEPS.
Total reward:  -636.8000821259587
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -11.77986146478299
DONE TAKING  40  STEPS.
Total reward:  -385.45472323523944
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.406608451903324
DONE TAKING  40  STEPS.
Total reward:  -443.9281550302034
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.66479563635856
DONE TAKING  40  STEPS.
Total reward:  -355.49032773549794
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.36833677289342
DONE TAKING  40  STEPS.
Total reward:  -359.09007048063467
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.260011383635018
DONE TAKING  40  STEPS.
Total reward:  -975.4867161563363
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.918356317922136
DONE TAKING  40  STEPS.
Total reward:  -671.4885903327101
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -13.776340362606073
DONE TAKING  40  STEPS.
Total reward:  -357.1716774125347
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.095111686105657
DONE TAKING  40  STEPS.
Total reward:  -705.1213928270614
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.832228260899065
DONE TAKING  40  STEPS.
Total reward:  -147.38984952657444
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.642423544802444
DONE TAKING  40  STEPS.
Total reward:  -7.905161798546562
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.481232618778854
DONE TAKING  40  STEPS.
Total reward:  -634.7423884763701
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.72077392801326
DONE TAKING  40  STEPS.
Total reward:  -806.9908522565046
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.27207028707541
DONE TAKING  40  STEPS.
Total reward:  -502.34724966440837
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -31.064110313952508
DONE TAKING  40  STEPS.
Total reward:  -672.5974175057862
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.873259061571673
DONE TAKING  40  STEPS.
Total reward:  145.28637137897627
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -31.323907895058916
DONE TAKING  40  STEPS.
Total reward:  -1052.512764808346
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -15.519329011685219
DONE TAKING  40  STEPS.
Total reward:  -415.380290851589
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.719904789944685
DONE TAKING  40  STEPS.
Total reward:  -347.2832675339989
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.42986809556104
DONE TAKING  40  STEPS.
Total reward:  -351.8537129592679
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.93134074330917
DONE TAKING  40  STEPS.
Total reward:  -886.6807903332734
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.88203902732621
DONE TAKING  40  STEPS.
Total reward:  -867.6043343841164
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.8203917119881
DONE TAKING  40  STEPS.
Total reward:  -412.3948071610204
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.936754176694006
DONE TAKING  40  STEPS.
Total reward:  -907.3933941347241
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.788660687293387
DONE TAKING  40  STEPS.
Total reward:  -790.3850527435371
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -28.12184094898643
DONE TAKING  40  STEPS.
Total reward:  -600.73846065669
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.748976746412616
DONE TAKING  40  STEPS.
Total reward:  -321.2233874059127
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.122787376843327
DONE TAKING  40  STEPS.
Total reward:  -349.28830820130605
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -9.603858589566412
DONE TAKING  40  STEPS.
Total reward:  -215.53274439652742
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.379904338668332
DONE TAKING  40  STEPS.
Total reward:  -586.5552077224138
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.180461918318485
DONE TAKING  40  STEPS.
Total reward:  -541.646649076043
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.62539690758077
DONE TAKING  40  STEPS.
Total reward:  -911.5437463617297
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.334911584757315
DONE TAKING  40  STEPS.
Total reward:  -284.71974368470626
Time for 1 rollout: 1.09 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter19.ckpt

#####################################
Training the dynamics model..... iteration  20
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  11700
On pol:  28800
Prob shape:  (40500,)

=== Epoch 0 ===
    train loss:  0.4326400036298776
    val rand:  0.4035798907279968
    val onPol:  0.3023572613795598

=== Epoch 10 ===
    train loss:  0.19591908175734024
    val rand:  0.18953470885753632
    val onPol:  0.2525960976878802

=== Epoch 20 ===
    train loss:  0.15269827465467814
    val rand:  0.16664740443229675
    val onPol:  0.2506796295444171

=== Epoch 30 ===
    train loss:  0.1270675291366215
    val rand:  0.15915793180465698
    val onPol:  0.2583180492122968

=== Epoch 39 ===
    train loss:  0.10785672417547129
    val rand:  0.1617833971977234
    val onPol:  0.26652072618405026
Training duration: 20.28 s

#####################################
performing on-policy MPC rollouts... iter  20
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.121248348096874
DONE TAKING  40  STEPS.
Total reward:  -1082.9929454637622
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.85738447767527
DONE TAKING  40  STEPS.
Total reward:  -533.5935410677012
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.213124905311318
DONE TAKING  40  STEPS.
Total reward:  -114.6777117324493
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.204591239956432
DONE TAKING  40  STEPS.
Total reward:  -392.72761141407784
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -22.21677445624521
DONE TAKING  40  STEPS.
Total reward:  -364.2036826128113
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -31.02772945910357
DONE TAKING  40  STEPS.
Total reward:  -695.8844530969052
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.300134370769268
DONE TAKING  40  STEPS.
Total reward:  -991.1452733627751
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -11.62257832464698
DONE TAKING  40  STEPS.
Total reward:  -324.59433110019194
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -15.714229514313587
DONE TAKING  40  STEPS.
Total reward:  -440.0260342813601
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.549813584395316
DONE TAKING  40  STEPS.
Total reward:  -980.2782620946997
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.53636275131264
DONE TAKING  40  STEPS.
Total reward:  -765.9447905501481
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.665508913997023
DONE TAKING  40  STEPS.
Total reward:  239.77644255151392
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.469180726714157
DONE TAKING  40  STEPS.
Total reward:  -1090.170410857498
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.000275923407067
DONE TAKING  40  STEPS.
Total reward:  -583.5061657994121
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.782302241665597
DONE TAKING  40  STEPS.
Total reward:  -699.4931218708515
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.268051602794703
DONE TAKING  40  STEPS.
Total reward:  -1047.0828142403968
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -16.82389333761234
DONE TAKING  40  STEPS.
Total reward:  -396.2875434029455
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -16.792814385066062
DONE TAKING  40  STEPS.
Total reward:  -196.60569610810066
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.671454380193758
DONE TAKING  40  STEPS.
Total reward:  347.3688704508691
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.190258637840465
DONE TAKING  40  STEPS.
Total reward:  -854.513957763936
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.428506274474937
DONE TAKING  40  STEPS.
Total reward:  -444.3697311044815
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.74984295837848
DONE TAKING  40  STEPS.
Total reward:  -587.6704206431075
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.42394672084558
DONE TAKING  40  STEPS.
Total reward:  -402.7794587803978
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.69312529375321
DONE TAKING  40  STEPS.
Total reward:  -661.2266877977808
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.266558590543294
DONE TAKING  40  STEPS.
Total reward:  -1039.4247405277747
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.781982213099432
DONE TAKING  40  STEPS.
Total reward:  -1017.0543726116449
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.40743002351038
DONE TAKING  40  STEPS.
Total reward:  -663.6440849396705
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.3974793821449
DONE TAKING  40  STEPS.
Total reward:  -640.696922325446
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.700837083193534
DONE TAKING  40  STEPS.
Total reward:  -856.880665548761
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.466129741246483
DONE TAKING  40  STEPS.
Total reward:  -593.3104592674571
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.105100536327818
DONE TAKING  40  STEPS.
Total reward:  -525.2640725277761
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -31.213705665182093
DONE TAKING  40  STEPS.
Total reward:  -747.3514171378076
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.65626328710165
DONE TAKING  40  STEPS.
Total reward:  -471.32377169263634
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.662431991234058
DONE TAKING  40  STEPS.
Total reward:  -491.3742585899695
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.510633170737655
DONE TAKING  40  STEPS.
Total reward:  -604.8468908350842
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -16.614946822929912
DONE TAKING  40  STEPS.
Total reward:  -408.9077135870571
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.667174940025934
DONE TAKING  40  STEPS.
Total reward:  -786.2899426234994
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.260556919077782
DONE TAKING  40  STEPS.
Total reward:  -216.32732228691432
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.74722460263593
DONE TAKING  40  STEPS.
Total reward:  -772.205592152567
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -13.69970017668788
DONE TAKING  40  STEPS.
Total reward:  -86.62538016819235
Time for 1 rollout: 1.04 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter20.ckpt

#####################################
Training the dynamics model..... iteration  21
#####################################

    amount of random data:  8000
    amount of onPol data:  30996
Prob rand:  11895
On pol:  30240
Prob shape:  (42135,)

=== Epoch 0 ===
    train loss:  0.43583365293537696
    val rand:  0.3902146518230438
    val onPol:  0.2972625618179639

=== Epoch 10 ===
    train loss:  0.19955978306328379
    val rand:  0.19169002771377563
    val onPol:  0.2530014291405678

=== Epoch 20 ===
    train loss:  0.15417127238541115
    val rand:  0.16250517964363098
    val onPol:  0.2512877359986305

=== Epoch 30 ===
    train loss:  0.12684571534031774
    val rand:  0.15769195556640625
    val onPol:  0.25741882373889285

=== Epoch 39 ===
    train loss:  0.1096504701346886
    val rand:  0.15545694530010223
    val onPol:  0.2654874424139659
Training duration: 20.99 s

#####################################
performing on-policy MPC rollouts... iter  21
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.575621365165492
DONE TAKING  40  STEPS.
Total reward:  -623.5803936620407
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.038539762784836
DONE TAKING  40  STEPS.
Total reward:  -516.6600829537423
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.059432440484436
DONE TAKING  40  STEPS.
Total reward:  -952.6734912781318
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.078583685882514
DONE TAKING  40  STEPS.
Total reward:  -1016.6055839290535
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -14.26847575667015
DONE TAKING  40  STEPS.
Total reward:  -428.8055249900326
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.540247917774185
DONE TAKING  40  STEPS.
Total reward:  -720.1744992479196
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -13.346349463641696
DONE TAKING  40  STEPS.
Total reward:  -98.37404042295617
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.818633695907415
DONE TAKING  40  STEPS.
Total reward:  -741.3577148224913
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.02591222522603
DONE TAKING  40  STEPS.
Total reward:  -619.1936043982156
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.100387070290967
DONE TAKING  40  STEPS.
Total reward:  -566.989494378494
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.525847321050104
DONE TAKING  40  STEPS.
Total reward:  -570.9340283051686
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.671705422632186
DONE TAKING  40  STEPS.
Total reward:  -522.9735493301235
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.185612379151205
DONE TAKING  40  STEPS.
Total reward:  -666.1434849338082
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -19.14798631811431
DONE TAKING  40  STEPS.
Total reward:  -553.1351956807708
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.816150645119002
DONE TAKING  40  STEPS.
Total reward:  -562.274206771917
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -14.200706306374027
DONE TAKING  40  STEPS.
Total reward:  -491.6479294160654
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.26921390315157
DONE TAKING  40  STEPS.
Total reward:  -492.112115291999
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.03456818763047
DONE TAKING  40  STEPS.
Total reward:  -825.1102981549969
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.919255919940284
DONE TAKING  40  STEPS.
Total reward:  -329.06687699088025
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.039306627127385
DONE TAKING  40  STEPS.
Total reward:  -690.2014775258987
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.203832748848583
DONE TAKING  40  STEPS.
Total reward:  -635.4016600708355
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.44299917466831
DONE TAKING  40  STEPS.
Total reward:  -879.9287236434394
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.924061597490983
DONE TAKING  40  STEPS.
Total reward:  -501.537052399628
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.48077493814899
DONE TAKING  40  STEPS.
Total reward:  -497.81286199201554
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.254816990971534
DONE TAKING  40  STEPS.
Total reward:  -939.9245021794051
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.774161721410394
DONE TAKING  40  STEPS.
Total reward:  -334.9041165088581
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -11.425075396766369
DONE TAKING  40  STEPS.
Total reward:  -237.67604382933723
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -16.254014970611582
DONE TAKING  40  STEPS.
Total reward:  316.0036253623227
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.788993921979095
DONE TAKING  40  STEPS.
Total reward:  -422.15358862016916
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.351728772712164
DONE TAKING  40  STEPS.
Total reward:  -613.9054927580207
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -8.677645138464786
DONE TAKING  40  STEPS.
Total reward:  -267.7543903434926
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.19458149968268
DONE TAKING  40  STEPS.
Total reward:  -446.43386058388256
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -15.955392866403677
DONE TAKING  40  STEPS.
Total reward:  -342.2384153897957
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.230102548370066
DONE TAKING  40  STEPS.
Total reward:  -466.44491358140067
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.74794881142065
DONE TAKING  40  STEPS.
Total reward:  -690.3071397112711
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.39672259670058
DONE TAKING  40  STEPS.
Total reward:  -701.1211275061311
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -15.192040399430482
DONE TAKING  40  STEPS.
Total reward:  348.6451426376657
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.66040283385872
DONE TAKING  40  STEPS.
Total reward:  -504.9167873429676
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.306655493327316
DONE TAKING  40  STEPS.
Total reward:  -697.4000686130281
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.146333999594376
DONE TAKING  40  STEPS.
Total reward:  -828.9227363226855
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter21.ckpt

#####################################
Training the dynamics model..... iteration  22
#####################################

    amount of random data:  8000
    amount of onPol data:  32472
Prob rand:  12090
On pol:  31680
Prob shape:  (43770,)

=== Epoch 0 ===
    train loss:  0.4301828896298128
    val rand:  0.392470121383667
    val onPol:  0.2981000940004985

=== Epoch 10 ===
    train loss:  0.19854975360281327
    val rand:  0.1956409066915512
    val onPol:  0.24901710947354636

=== Epoch 20 ===
    train loss:  0.1543578060234294
    val rand:  0.16297367215156555
    val onPol:  0.24714539448420206

=== Epoch 30 ===
    train loss:  0.128378586295773
    val rand:  0.159715935587883
    val onPol:  0.2545950412750244

=== Epoch 39 ===
    train loss:  0.10997709666981417
    val rand:  0.1590435802936554
    val onPol:  0.26510819296042126
Training duration: 13.73 s

#####################################
performing on-policy MPC rollouts... iter  22
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.857030764508103
DONE TAKING  40  STEPS.
Total reward:  -552.1759237534536
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.1191302175107
DONE TAKING  40  STEPS.
Total reward:  -910.7913799870088
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.24212777071702
DONE TAKING  40  STEPS.
Total reward:  -506.4225854560659
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.27423484723851
DONE TAKING  40  STEPS.
Total reward:  -787.3612659938437
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.650924991446693
DONE TAKING  40  STEPS.
Total reward:  -377.3833588452231
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.84076918186107
DONE TAKING  40  STEPS.
Total reward:  -710.281642601929
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.363360468714347
DONE TAKING  40  STEPS.
Total reward:  -721.1941416245129
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.282914023525247
DONE TAKING  40  STEPS.
Total reward:  -742.5707235524079
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -15.798497685616672
DONE TAKING  40  STEPS.
Total reward:  -353.11591437030535
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.891480624345068
DONE TAKING  40  STEPS.
Total reward:  -356.74073194022736
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.85457643672853
DONE TAKING  40  STEPS.
Total reward:  -478.27290239650307
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.596113206561164
DONE TAKING  40  STEPS.
Total reward:  -132.34627721135956
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.025100834235698
DONE TAKING  40  STEPS.
Total reward:  -481.55381418697675
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.19343006875537
DONE TAKING  40  STEPS.
Total reward:  -696.6986849399365
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.707126728691797
DONE TAKING  40  STEPS.
Total reward:  -539.4112897513952
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.356714338587473
DONE TAKING  40  STEPS.
Total reward:  -608.7567097659546
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.237346445795488
DONE TAKING  40  STEPS.
Total reward:  -360.51145750902873
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.33218012466247
DONE TAKING  40  STEPS.
Total reward:  -354.41995133292465
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.899755179676028
DONE TAKING  40  STEPS.
Total reward:  -528.6588260769083
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.5953623363581
DONE TAKING  40  STEPS.
Total reward:  -227.56915242527083
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.347778473492443
DONE TAKING  40  STEPS.
Total reward:  -612.8155417593663
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.40399307623673
DONE TAKING  40  STEPS.
Total reward:  -935.4174571110563
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.59884110321957
DONE TAKING  40  STEPS.
Total reward:  57.535689284266965
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -11.06636686121766
DONE TAKING  40  STEPS.
Total reward:  -217.35221409448124
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.54207335840801
DONE TAKING  40  STEPS.
Total reward:  -34.99220298077916
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.487266975807398
DONE TAKING  40  STEPS.
Total reward:  -396.93543843819634
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.730287881591355
DONE TAKING  40  STEPS.
Total reward:  -871.5548341477818
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -22.308094852348276
DONE TAKING  40  STEPS.
Total reward:  -235.42452224283676
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.24697101238546
DONE TAKING  40  STEPS.
Total reward:  -360.2670564030252
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.446839775652265
DONE TAKING  40  STEPS.
Total reward:  -81.33505530678096
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.830849838110485
DONE TAKING  40  STEPS.
Total reward:  -342.0239996974063
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.498103560752412
DONE TAKING  40  STEPS.
Total reward:  -704.3874239839489
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.930786983426056
DONE TAKING  40  STEPS.
Total reward:  -394.56702884263126
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.22603821013867
DONE TAKING  40  STEPS.
Total reward:  -475.9730885961677
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.825926456473823
DONE TAKING  40  STEPS.
Total reward:  -1038.5859401177306
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -31.302453070793636
DONE TAKING  40  STEPS.
Total reward:  -869.2096448540208
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -26.623259909135403
DONE TAKING  40  STEPS.
Total reward:  -995.2624898191293
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.923163556350893
DONE TAKING  40  STEPS.
Total reward:  -290.4157726361006
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -13.337060201542531
DONE TAKING  40  STEPS.
Total reward:  -338.87126783932194
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.542385191760115
DONE TAKING  40  STEPS.
Total reward:  120.48169549787454
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter22.ckpt

#####################################
Training the dynamics model..... iteration  23
#####################################

    amount of random data:  8000
    amount of onPol data:  33948
Prob rand:  12285
On pol:  33120
Prob shape:  (45405,)

=== Epoch 0 ===
    train loss:  0.43358564986424014
    val rand:  0.4022672176361084
    val onPol:  0.3061692076069968

=== Epoch 10 ===
    train loss:  0.2012951233508912
    val rand:  0.1956915706396103
    val onPol:  0.2567650101014546

=== Epoch 20 ===
    train loss:  0.15705201351507145
    val rand:  0.16657617688179016
    val onPol:  0.255361659186227

=== Epoch 30 ===
    train loss:  0.13228181741115722
    val rand:  0.15982933342456818
    val onPol:  0.26263171434402466

=== Epoch 39 ===
    train loss:  0.11420611664652824
    val rand:  0.1627671867609024
    val onPol:  0.2722600932632174
Training duration: 22.25 s

#####################################
performing on-policy MPC rollouts... iter  23
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.35594085723448
DONE TAKING  40  STEPS.
Total reward:  -293.34525572559124
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.979970364411006
DONE TAKING  40  STEPS.
Total reward:  -921.2877219367575
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.93620165737058
DONE TAKING  40  STEPS.
Total reward:  -801.4787550131185
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.5841897890101
DONE TAKING  40  STEPS.
Total reward:  -33.83963854371807
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.291120008040195
DONE TAKING  40  STEPS.
Total reward:  -29.198390195355124
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.549350169591786
DONE TAKING  40  STEPS.
Total reward:  -578.1144972026187
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.296401710972617
DONE TAKING  40  STEPS.
Total reward:  -445.7313894865373
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.42420457227996
DONE TAKING  40  STEPS.
Total reward:  -849.2675201542969
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.142636886712456
DONE TAKING  40  STEPS.
Total reward:  64.02756061829368
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.322743847739112
DONE TAKING  40  STEPS.
Total reward:  -586.7753363619386
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.59619875408387
DONE TAKING  40  STEPS.
Total reward:  -737.3268530331075
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.861774616590388
DONE TAKING  40  STEPS.
Total reward:  -418.6084456343789
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.902433871172555
DONE TAKING  40  STEPS.
Total reward:  -745.0797878028104
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.918740282043167
DONE TAKING  40  STEPS.
Total reward:  -365.7051784906331
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -16.47102905391442
DONE TAKING  40  STEPS.
Total reward:  -365.1391838612924
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.912146727442725
DONE TAKING  40  STEPS.
Total reward:  -608.1705607128787
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.421400478665326
DONE TAKING  40  STEPS.
Total reward:  -639.8720274561376
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.930574621675667
DONE TAKING  40  STEPS.
Total reward:  -408.4393919680676
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.06497798968801
DONE TAKING  40  STEPS.
Total reward:  -203.13133623315224
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.416000036252054
DONE TAKING  40  STEPS.
Total reward:  -814.9010324485445
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.936442615110707
DONE TAKING  40  STEPS.
Total reward:  -699.1316387062026
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.96609802457008
DONE TAKING  40  STEPS.
Total reward:  -623.8333001162391
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.541258977648333
DONE TAKING  40  STEPS.
Total reward:  -447.60096730407173
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.893117917296646
DONE TAKING  40  STEPS.
Total reward:  -792.2269482783487
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -11.094528229912298
DONE TAKING  40  STEPS.
Total reward:  -269.9968971996781
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.30847802651354
DONE TAKING  40  STEPS.
Total reward:  -450.1416099819622
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.155422983378436
DONE TAKING  40  STEPS.
Total reward:  -686.176596443468
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.301672677425927
DONE TAKING  40  STEPS.
Total reward:  -55.58129705020408
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.16769452940713
DONE TAKING  40  STEPS.
Total reward:  -930.984120708839
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.385993293575417
DONE TAKING  40  STEPS.
Total reward:  -934.7814015246497
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.1900184405807
DONE TAKING  40  STEPS.
Total reward:  -725.0471087371491
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.48087955111773
DONE TAKING  40  STEPS.
Total reward:  -123.6936660702844
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.477622838587628
DONE TAKING  40  STEPS.
Total reward:  -21.527502935593816
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.130330397623432
DONE TAKING  40  STEPS.
Total reward:  -797.4569401232296
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -12.383190965069113
DONE TAKING  40  STEPS.
Total reward:  -107.4679498532125
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.273714746753186
DONE TAKING  40  STEPS.
Total reward:  -322.16936515958685
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.907809631901284
DONE TAKING  40  STEPS.
Total reward:  -341.38939335850887
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.502505823832017
DONE TAKING  40  STEPS.
Total reward:  -862.0043604879469
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.370369184505623
DONE TAKING  40  STEPS.
Total reward:  -561.0871707718194
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.25160755564911
DONE TAKING  40  STEPS.
Total reward:  -493.1481952132939
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter23.ckpt

#####################################
Training the dynamics model..... iteration  24
#####################################

    amount of random data:  8000
    amount of onPol data:  35424
Prob rand:  12480
On pol:  34560
Prob shape:  (47040,)

=== Epoch 0 ===
    train loss:  0.42275695158885074
    val rand:  0.3902575373649597
    val onPol:  0.3017415063721793

=== Epoch 10 ===
    train loss:  0.19975592900108505
    val rand:  0.19031155109405518
    val onPol:  0.25092655420303345

=== Epoch 20 ===
    train loss:  0.15629834018565797
    val rand:  0.1660439372062683
    val onPol:  0.2531762293406895

=== Epoch 30 ===
    train loss:  0.13085216210111156
    val rand:  0.160232275724411
    val onPol:  0.26058916321822573

=== Epoch 39 ===
    train loss:  0.11186422808812214
    val rand:  0.15731069445610046
    val onPol:  0.26804798202855246
Training duration: 22.89 s

#####################################
performing on-policy MPC rollouts... iter  24
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.065711971533965
DONE TAKING  40  STEPS.
Total reward:  -743.3252700111645
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -15.219024717531013
DONE TAKING  40  STEPS.
Total reward:  -485.56316875822205
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.881930998917717
DONE TAKING  40  STEPS.
Total reward:  -469.95298543861577
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -12.679200805868794
DONE TAKING  40  STEPS.
Total reward:  -282.94628949823027
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -15.752732797504176
DONE TAKING  40  STEPS.
Total reward:  -306.29566610849184
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -15.59959577144689
DONE TAKING  40  STEPS.
Total reward:  -46.45563597014789
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.38901998463738
DONE TAKING  40  STEPS.
Total reward:  -430.29370831795757
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.97599451987063
DONE TAKING  40  STEPS.
Total reward:  -837.8311322410534
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.099485386750708
DONE TAKING  40  STEPS.
Total reward:  258.402898229884
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.054964340151514
DONE TAKING  40  STEPS.
Total reward:  -395.68727742731807
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -29.97374218613945
DONE TAKING  40  STEPS.
Total reward:  -1066.9517228492973
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.317151255096682
DONE TAKING  40  STEPS.
Total reward:  -427.26520904467435
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.188482553075957
DONE TAKING  40  STEPS.
Total reward:  -765.9103426437036
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.559298238843894
DONE TAKING  40  STEPS.
Total reward:  -854.4036716942077
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.58860323564113
DONE TAKING  40  STEPS.
Total reward:  -901.9923211540876
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.743522403643002
DONE TAKING  40  STEPS.
Total reward:  -11.888916210311937
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.354683390527736
DONE TAKING  40  STEPS.
Total reward:  -902.3873409213925
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.102087275096014
DONE TAKING  40  STEPS.
Total reward:  -551.861437569616
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.172585279673083
DONE TAKING  40  STEPS.
Total reward:  -358.5568082911549
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.496038486981668
DONE TAKING  40  STEPS.
Total reward:  -130.48758822811598
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -10.747469177516734
DONE TAKING  40  STEPS.
Total reward:  -269.8473005762038
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.874506540356776
DONE TAKING  40  STEPS.
Total reward:  -334.7785217418723
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.86651403720953
DONE TAKING  40  STEPS.
Total reward:  -524.192409211278
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.266901440181556
DONE TAKING  40  STEPS.
Total reward:  -529.2501791669607
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -9.974535378793632
DONE TAKING  40  STEPS.
Total reward:  -287.8383446331054
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.37645641349261
DONE TAKING  40  STEPS.
Total reward:  -952.7192725797244
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.716822716118273
DONE TAKING  40  STEPS.
Total reward:  -47.05985463173765
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.071569037528608
DONE TAKING  40  STEPS.
Total reward:  -946.7336833834959
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.286354476178488
DONE TAKING  40  STEPS.
Total reward:  -514.0672343242805
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.569470693047283
DONE TAKING  40  STEPS.
Total reward:  -586.4791912837159
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.07664689888769
DONE TAKING  40  STEPS.
Total reward:  -565.0096977138422
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.697201559216012
DONE TAKING  40  STEPS.
Total reward:  -312.13299447470627
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.17978804359066
DONE TAKING  40  STEPS.
Total reward:  -503.5394672796979
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.572272094064513
DONE TAKING  40  STEPS.
Total reward:  -590.5811944427032
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.086612104592593
DONE TAKING  40  STEPS.
Total reward:  -725.7809581940102
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.14588055717058
DONE TAKING  40  STEPS.
Total reward:  -159.72663040199367
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.732806306412794
DONE TAKING  40  STEPS.
Total reward:  -427.8465579341961
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.841861062291763
DONE TAKING  40  STEPS.
Total reward:  -514.6217603096215
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.274557054787977
DONE TAKING  40  STEPS.
Total reward:  -405.60148611487836
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.272224609455552
DONE TAKING  40  STEPS.
Total reward:  83.109352784815
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter24.ckpt

#####################################
Training the dynamics model..... iteration  25
#####################################

    amount of random data:  8000
    amount of onPol data:  36900
Prob rand:  12675
On pol:  36000
Prob shape:  (48675,)

=== Epoch 0 ===
    train loss:  0.42021052021729316
    val rand:  0.4003288149833679
    val onPol:  0.29594482481479645

=== Epoch 10 ===
    train loss:  0.2018708564733204
    val rand:  0.19299006462097168
    val onPol:  0.2485241230045046

=== Epoch 20 ===
    train loss:  0.15887392351501867
    val rand:  0.16279670596122742
    val onPol:  0.2486901240689414

=== Epoch 30 ===
    train loss:  0.131770978554299
    val rand:  0.1565704643726349
    val onPol:  0.25842955921377453

=== Epoch 39 ===
    train loss:  0.11408279679323498
    val rand:  0.15397316217422485
    val onPol:  0.26375209433691843
Training duration: 24.45 s

#####################################
performing on-policy MPC rollouts... iter  25
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.568203372822087
DONE TAKING  40  STEPS.
Total reward:  -569.4819403845363
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.63736739376828
DONE TAKING  40  STEPS.
Total reward:  -861.5264571237665
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.695330127223283
DONE TAKING  40  STEPS.
Total reward:  -749.1188035568094
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.511824346245398
DONE TAKING  40  STEPS.
Total reward:  -617.3576309629042
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.437651231081546
DONE TAKING  40  STEPS.
Total reward:  -764.4674671663362
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.28015529562878
DONE TAKING  40  STEPS.
Total reward:  -598.6546128800017
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.35594343220647
DONE TAKING  40  STEPS.
Total reward:  126.0911192054135
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.117141900257927
DONE TAKING  40  STEPS.
Total reward:  -351.8590592869993
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.523423089181883
DONE TAKING  40  STEPS.
Total reward:  -180.33238000901616
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.135425844051465
DONE TAKING  40  STEPS.
Total reward:  -448.14449974035915
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.405476008506533
DONE TAKING  40  STEPS.
Total reward:  -351.3058182847726
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.092013966790514
DONE TAKING  40  STEPS.
Total reward:  -412.11038521330806
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -12.914122099388553
DONE TAKING  40  STEPS.
Total reward:  376.0639828154699
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.40944562755025
DONE TAKING  40  STEPS.
Total reward:  -311.01720131412833
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.238662275328604
DONE TAKING  40  STEPS.
Total reward:  -419.7476691058283
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.651724732485672
DONE TAKING  40  STEPS.
Total reward:  -449.4685508338467
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -21.643952787776662
DONE TAKING  40  STEPS.
Total reward:  -491.86924944515096
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.339045262302307
DONE TAKING  40  STEPS.
Total reward:  -598.1113934521082
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.756982174698223
DONE TAKING  40  STEPS.
Total reward:  -303.2080458233938
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.462965988680654
DONE TAKING  40  STEPS.
Total reward:  -336.7765725486038
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.580773906245945
DONE TAKING  40  STEPS.
Total reward:  -1032.4827074049122
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.57781402979692
DONE TAKING  40  STEPS.
Total reward:  -770.1956275852946
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.190744028364243
DONE TAKING  40  STEPS.
Total reward:  -596.2576081008133
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.713403901303653
DONE TAKING  40  STEPS.
Total reward:  -682.354677128036
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.23081949270547
DONE TAKING  40  STEPS.
Total reward:  -595.8561285028799
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.390938258321633
DONE TAKING  40  STEPS.
Total reward:  -693.3027581458311
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.038747428222855
DONE TAKING  40  STEPS.
Total reward:  -645.642591745824
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -14.244681519522333
DONE TAKING  40  STEPS.
Total reward:  -361.9377329835648
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.926563638384835
DONE TAKING  40  STEPS.
Total reward:  -652.1505644422064
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.203503553590135
DONE TAKING  40  STEPS.
Total reward:  -968.403016671939
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.880376049270552
DONE TAKING  40  STEPS.
Total reward:  -353.9797177303628
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.300100525774877
DONE TAKING  40  STEPS.
Total reward:  -567.2392671508386
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.31074573210173
DONE TAKING  40  STEPS.
Total reward:  -420.2749953200503
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.93550602543144
DONE TAKING  40  STEPS.
Total reward:  -637.115090592636
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.44040267805294
DONE TAKING  40  STEPS.
Total reward:  -427.52232670145827
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -18.700527742908754
DONE TAKING  40  STEPS.
Total reward:  -409.75766796033975
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.059964327645428
DONE TAKING  40  STEPS.
Total reward:  -642.5104562902882
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.718166040914255
DONE TAKING  40  STEPS.
Total reward:  -689.1420584027891
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.546620097499044
DONE TAKING  40  STEPS.
Total reward:  -353.26575340710116
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.14592210034145
DONE TAKING  40  STEPS.
Total reward:  -529.6152274493387
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter25.ckpt

#####################################
Training the dynamics model..... iteration  26
#####################################

    amount of random data:  8000
    amount of onPol data:  38376
Prob rand:  12870
On pol:  37440
Prob shape:  (50310,)

=== Epoch 0 ===
    train loss:  0.4243359550529597
    val rand:  0.3928256630897522
    val onPol:  0.3090692311525345

=== Epoch 10 ===
    train loss:  0.20612790283499932
    val rand:  0.19860216975212097
    val onPol:  0.2593568805605173

=== Epoch 20 ===
    train loss:  0.16259632730970577
    val rand:  0.16403809189796448
    val onPol:  0.26108008809387684

=== Epoch 30 ===
    train loss:  0.13286259101361644
    val rand:  0.1563742458820343
    val onPol:  0.2688324451446533

=== Epoch 39 ===
    train loss:  0.11679106540217692
    val rand:  0.15832319855690002
    val onPol:  0.27872979640960693
Training duration: 24.75 s

#####################################
performing on-policy MPC rollouts... iter  26
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.78622295100186
DONE TAKING  40  STEPS.
Total reward:  -257.87690771186374
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.83618816769909
DONE TAKING  40  STEPS.
Total reward:  -611.1446397681982
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.666367689811707
DONE TAKING  40  STEPS.
Total reward:  -704.9581974815718
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.975010709984073
DONE TAKING  40  STEPS.
Total reward:  -690.6579039959811
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.30828623114975
DONE TAKING  40  STEPS.
Total reward:  -448.24760309882373
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.913050986729964
DONE TAKING  40  STEPS.
Total reward:  29.18822242295625
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.118806518694072
DONE TAKING  40  STEPS.
Total reward:  -727.0782873434865
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -17.288390751520133
DONE TAKING  40  STEPS.
Total reward:  -461.5307104788075
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -17.331849819932255
DONE TAKING  40  STEPS.
Total reward:  -582.647578757344
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.58114060067423
DONE TAKING  40  STEPS.
Total reward:  136.7393199315536
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.616590167998538
DONE TAKING  40  STEPS.
Total reward:  -620.1795788416633
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.34939858589939
DONE TAKING  40  STEPS.
Total reward:  -208.10318619508894
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.86115692076358
DONE TAKING  40  STEPS.
Total reward:  -470.2133849688814
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.34966766678231
DONE TAKING  40  STEPS.
Total reward:  -720.18774991434
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -12.923336719494316
DONE TAKING  40  STEPS.
Total reward:  -394.5770866306111
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.59968238762203
DONE TAKING  40  STEPS.
Total reward:  -520.1227231610009
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -10.94095334823692
DONE TAKING  40  STEPS.
Total reward:  -273.6843994403812
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -22.03242366220919
DONE TAKING  40  STEPS.
Total reward:  -424.4625821413468
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.465199510916364
DONE TAKING  40  STEPS.
Total reward:  -468.74112286912987
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.50913928334858
DONE TAKING  40  STEPS.
Total reward:  -717.3291340302147
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.235183552339
DONE TAKING  40  STEPS.
Total reward:  -453.4711507292592
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -17.71333186607126
DONE TAKING  40  STEPS.
Total reward:  -511.2583342585787
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -19.752982668456944
DONE TAKING  40  STEPS.
Total reward:  -653.6993867953902
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.1929210991051
DONE TAKING  40  STEPS.
Total reward:  -808.7108137000904
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -21.916674201718884
DONE TAKING  40  STEPS.
Total reward:  -689.9760425815507
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.92378217411547
DONE TAKING  40  STEPS.
Total reward:  -785.3033976629487
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -17.59219881337669
DONE TAKING  40  STEPS.
Total reward:  -416.77066871891367
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.282098896561163
DONE TAKING  40  STEPS.
Total reward:  -346.86311217447394
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.794484092573462
DONE TAKING  40  STEPS.
Total reward:  -825.9048720208475
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.474296812643022
DONE TAKING  40  STEPS.
Total reward:  -94.8712676381281
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.023507779040912
DONE TAKING  40  STEPS.
Total reward:  -742.4617689639039
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.367938699839634
DONE TAKING  40  STEPS.
Total reward:  -800.6506084198111
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.133551297133973
DONE TAKING  40  STEPS.
Total reward:  -711.2775807616122
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -12.397127829470245
DONE TAKING  40  STEPS.
Total reward:  -204.7244762893352
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.640509664630578
DONE TAKING  40  STEPS.
Total reward:  -544.8405049851491
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.926592594670065
DONE TAKING  40  STEPS.
Total reward:  -84.99186528750073
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.196524622061922
DONE TAKING  40  STEPS.
Total reward:  -483.9333164170999
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.999441073397122
DONE TAKING  40  STEPS.
Total reward:  -918.7880508788138
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.575717413294903
DONE TAKING  40  STEPS.
Total reward:  172.03042210826283
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.145129177655605
DONE TAKING  40  STEPS.
Total reward:  -644.8927122906179
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter26.ckpt

#####################################
Training the dynamics model..... iteration  27
#####################################

    amount of random data:  8000
    amount of onPol data:  39852
Prob rand:  13065
On pol:  38880
Prob shape:  (51945,)

=== Epoch 0 ===
    train loss:  0.41811352555114445
    val rand:  0.3964245915412903
    val onPol:  0.3068847768008709

=== Epoch 10 ===
    train loss:  0.20388437955096217
    val rand:  0.19675174355506897
    val onPol:  0.25604362040758133

=== Epoch 20 ===
    train loss:  0.1606566306978169
    val rand:  0.16655239462852478
    val onPol:  0.25848048739135265

=== Epoch 30 ===
    train loss:  0.13509761888792018
    val rand:  0.15768668055534363
    val onPol:  0.2671328969299793

=== Epoch 39 ===
    train loss:  0.11512435323531085
    val rand:  0.16077910363674164
    val onPol:  0.27472085505723953
Training duration: 25.59 s

#####################################
performing on-policy MPC rollouts... iter  27
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -17.43433397371898
DONE TAKING  40  STEPS.
Total reward:  -580.5519670652427
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.470650388128114
DONE TAKING  40  STEPS.
Total reward:  -937.5355451479365
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.10135521593981
DONE TAKING  40  STEPS.
Total reward:  -922.5730972164247
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.73775230046017
DONE TAKING  40  STEPS.
Total reward:  -786.6294724513161
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.1492179049691
DONE TAKING  40  STEPS.
Total reward:  -712.4260385769101
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -14.579972868457158
DONE TAKING  40  STEPS.
Total reward:  -322.88968998494454
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.29468731818504
DONE TAKING  40  STEPS.
Total reward:  -846.6667859981875
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.09643123127239
DONE TAKING  40  STEPS.
Total reward:  -576.0844869665132
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.084503127031567
DONE TAKING  40  STEPS.
Total reward:  -612.7838445706577
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.572128245014092
DONE TAKING  40  STEPS.
Total reward:  -765.3347086931292
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.4587056917659
DONE TAKING  40  STEPS.
Total reward:  -814.0654091070538
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -8.841905273406988
DONE TAKING  40  STEPS.
Total reward:  -18.25134720610773
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.494105410037704
DONE TAKING  40  STEPS.
Total reward:  -599.3689938101445
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -27.264937498067464
DONE TAKING  40  STEPS.
Total reward:  -594.8953526435648
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.393589827615372
DONE TAKING  40  STEPS.
Total reward:  -389.07702727559115
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.511927003811135
DONE TAKING  40  STEPS.
Total reward:  -915.5347011585276
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.141666371139873
DONE TAKING  40  STEPS.
Total reward:  -615.2881597699585
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.15934247811718
DONE TAKING  40  STEPS.
Total reward:  -805.4684617279657
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.116057240258566
DONE TAKING  40  STEPS.
Total reward:  -1058.7109871118228
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.850059039389826
DONE TAKING  40  STEPS.
Total reward:  -654.5993640446286
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.686258411406
DONE TAKING  40  STEPS.
Total reward:  -574.8093354429126
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.150203883443538
DONE TAKING  40  STEPS.
Total reward:  -107.34394082021763
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.063600359491375
DONE TAKING  40  STEPS.
Total reward:  -247.18078568150935
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.02327594280798
DONE TAKING  40  STEPS.
Total reward:  -736.2626310181922
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.436854608479017
DONE TAKING  40  STEPS.
Total reward:  -380.7915158647431
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.297036646788897
DONE TAKING  40  STEPS.
Total reward:  -959.394787276467
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.88344547347613
DONE TAKING  40  STEPS.
Total reward:  -581.6517114891749
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.135226718716893
DONE TAKING  40  STEPS.
Total reward:  -809.2279809303482
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -17.00217012513611
DONE TAKING  40  STEPS.
Total reward:  -581.6039745064237
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.0510014695435
DONE TAKING  40  STEPS.
Total reward:  -93.85453749271606
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -22.25149154660411
DONE TAKING  40  STEPS.
Total reward:  -6.231459287418446
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.728556400816174
DONE TAKING  40  STEPS.
Total reward:  -201.4493574692538
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.702504353604624
DONE TAKING  40  STEPS.
Total reward:  -685.2291244332513
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.42753343085878
DONE TAKING  40  STEPS.
Total reward:  -497.6542690016109
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.226328290817385
DONE TAKING  40  STEPS.
Total reward:  -604.9408988015039
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.96757565348414
DONE TAKING  40  STEPS.
Total reward:  -156.4761180615344
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -10.096922001024213
DONE TAKING  40  STEPS.
Total reward:  -294.68120361896547
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.537415194305304
DONE TAKING  40  STEPS.
Total reward:  -332.6257587415202
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.327499251762873
DONE TAKING  40  STEPS.
Total reward:  -490.61636018998263
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.572021031903084
DONE TAKING  40  STEPS.
Total reward:  -511.297068754602
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter27.ckpt

#####################################
Training the dynamics model..... iteration  28
#####################################

    amount of random data:  8000
    amount of onPol data:  41328
Prob rand:  13260
On pol:  40320
Prob shape:  (53580,)

=== Epoch 0 ===
    train loss:  0.41865286947442937
    val rand:  0.39932847023010254
    val onPol:  0.310044476762414

=== Epoch 10 ===
    train loss:  0.2043611347102202
    val rand:  0.19695495069026947
    val onPol:  0.2571092825382948

=== Epoch 20 ===
    train loss:  0.16218379111244127
    val rand:  0.1667305827140808
    val onPol:  0.25846177339553833

=== Epoch 30 ===
    train loss:  0.13582732779188797
    val rand:  0.16214346885681152
    val onPol:  0.26582472026348114

=== Epoch 39 ===
    train loss:  0.11779078669272937
    val rand:  0.1576547473669052
    val onPol:  0.2751238141208887
Training duration: 27.01 s

#####################################
performing on-policy MPC rollouts... iter  28
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.5033305073009
DONE TAKING  40  STEPS.
Total reward:  -633.2731475089724
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.601912834863796
DONE TAKING  40  STEPS.
Total reward:  -948.0371282151237
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.778108622591844
DONE TAKING  40  STEPS.
Total reward:  -585.3377950975589
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.099284050351184
DONE TAKING  40  STEPS.
Total reward:  -835.4223165225671
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.307928711126536
DONE TAKING  40  STEPS.
Total reward:  -704.6044198920433
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -11.089442547129744
DONE TAKING  40  STEPS.
Total reward:  -395.2577473028273
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -11.150721807195353
DONE TAKING  40  STEPS.
Total reward:  -386.47709559880064
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.573877164515274
DONE TAKING  40  STEPS.
Total reward:  -382.06562741365326
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.837702459467728
DONE TAKING  40  STEPS.
Total reward:  -846.4369598629479
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.287029896029212
DONE TAKING  40  STEPS.
Total reward:  -110.95926057499857
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -13.942842511182107
DONE TAKING  40  STEPS.
Total reward:  -412.20996298057213
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.458392022027507
DONE TAKING  40  STEPS.
Total reward:  -866.8066928097214
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.425258043270205
DONE TAKING  40  STEPS.
Total reward:  -462.2020781493227
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.31510020098544
DONE TAKING  40  STEPS.
Total reward:  -420.32560635685724
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.95336309782887
DONE TAKING  40  STEPS.
Total reward:  -427.5002006434689
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.826923475945126
DONE TAKING  40  STEPS.
Total reward:  -378.5862501125215
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -28.81014121498527
DONE TAKING  40  STEPS.
Total reward:  -907.2139797899525
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.488401174280195
DONE TAKING  40  STEPS.
Total reward:  313.16118139278484
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.983155859283364
DONE TAKING  40  STEPS.
Total reward:  -813.9722720309767
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.919293893492302
DONE TAKING  40  STEPS.
Total reward:  -392.0906006030875
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -26.869026002577968
DONE TAKING  40  STEPS.
Total reward:  -746.5693736504033
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.353279851827132
DONE TAKING  40  STEPS.
Total reward:  -847.7396197754287
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.574687638538485
DONE TAKING  40  STEPS.
Total reward:  -536.1790581168775
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.8921879474967
DONE TAKING  40  STEPS.
Total reward:  -478.11196589697545
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.162611652439068
DONE TAKING  40  STEPS.
Total reward:  -559.5099342909118
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.227397712382448
DONE TAKING  40  STEPS.
Total reward:  -430.28528265895176
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -24.087567687058122
DONE TAKING  40  STEPS.
Total reward:  -426.6537998285411
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.136895954136868
DONE TAKING  40  STEPS.
Total reward:  -401.85985642901625
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.601329780780954
DONE TAKING  40  STEPS.
Total reward:  -545.4912973678913
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.767971750950753
DONE TAKING  40  STEPS.
Total reward:  -606.5671581233764
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -12.190781013303953
DONE TAKING  40  STEPS.
Total reward:  -126.38688747233127
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -29.022153377793547
DONE TAKING  40  STEPS.
Total reward:  42.141475548513675
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.29034094577586
DONE TAKING  40  STEPS.
Total reward:  -1071.2688157372625
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.48920767225862
DONE TAKING  40  STEPS.
Total reward:  -261.8134820192721
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.38712340979497
DONE TAKING  40  STEPS.
Total reward:  -567.4975658333608
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.465939312863284
DONE TAKING  40  STEPS.
Total reward:  -787.3422008917984
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.740278475003006
DONE TAKING  40  STEPS.
Total reward:  -411.18299374418785
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.446317452861535
DONE TAKING  40  STEPS.
Total reward:  -695.1706350898875
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.20537704310967
DONE TAKING  40  STEPS.
Total reward:  -471.5099664571609
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.712447506561976
DONE TAKING  40  STEPS.
Total reward:  -757.4552405049319
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter28.ckpt

#####################################
Training the dynamics model..... iteration  29
#####################################

    amount of random data:  8000
    amount of onPol data:  42804
Prob rand:  13455
On pol:  41760
Prob shape:  (55215,)

=== Epoch 0 ===
    train loss:  0.42419974854059306
    val rand:  0.39321622252464294
    val onPol:  0.31464648577902055

=== Epoch 10 ===
    train loss:  0.2036708562730629
    val rand:  0.201119065284729
    val onPol:  0.2666482809517119

=== Epoch 20 ===
    train loss:  0.16320264436931253
    val rand:  0.1673632562160492
    val onPol:  0.26548975871668923

=== Epoch 30 ===
    train loss:  0.136150766059617
    val rand:  0.16055189073085785
    val onPol:  0.2752266095744239

=== Epoch 39 ===
    train loss:  0.11984164748236398
    val rand:  0.15934136509895325
    val onPol:  0.28405782249238754
Training duration: 26.99 s

#####################################
performing on-policy MPC rollouts... iter  29
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.66331985889011
DONE TAKING  40  STEPS.
Total reward:  -789.0232530655251
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -13.192501801555178
DONE TAKING  40  STEPS.
Total reward:  -73.59711010035659
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.419986608437537
DONE TAKING  40  STEPS.
Total reward:  -832.7934824380969
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.46193058991136
DONE TAKING  40  STEPS.
Total reward:  -585.2645266163612
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.201631987238446
DONE TAKING  40  STEPS.
Total reward:  -499.4900147575042
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.962177322221887
DONE TAKING  40  STEPS.
Total reward:  -427.323916432971
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.666965393348246
DONE TAKING  40  STEPS.
Total reward:  -443.7251101540033
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.796646737368757
DONE TAKING  40  STEPS.
Total reward:  -541.4432624819117
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.819787405810704
DONE TAKING  40  STEPS.
Total reward:  -822.9820709523102
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.18942978702355
DONE TAKING  40  STEPS.
Total reward:  -804.9923533015291
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.809797134444512
DONE TAKING  40  STEPS.
Total reward:  -607.8085271771861
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.009310174613546
DONE TAKING  40  STEPS.
Total reward:  -17.7171225852655
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -27.83476121336786
DONE TAKING  40  STEPS.
Total reward:  -837.7767267220177
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.996871688667667
DONE TAKING  40  STEPS.
Total reward:  -702.2303190867676
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.22705547262759
DONE TAKING  40  STEPS.
Total reward:  -481.0491461048854
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.73640026285166
DONE TAKING  40  STEPS.
Total reward:  -556.5519502051964
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.095818192943394
DONE TAKING  40  STEPS.
Total reward:  -640.2019505404398
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.833321404574
DONE TAKING  40  STEPS.
Total reward:  114.46369295365734
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.14776075345961
DONE TAKING  40  STEPS.
Total reward:  -417.74369111854116
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.850441294427732
DONE TAKING  40  STEPS.
Total reward:  -685.6031823563459
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.54003283501507
DONE TAKING  40  STEPS.
Total reward:  -833.702863439338
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -20.95102563404098
DONE TAKING  40  STEPS.
Total reward:  -495.91439657071084
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.159421275449727
DONE TAKING  40  STEPS.
Total reward:  -333.2985725565183
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.047157199911624
DONE TAKING  40  STEPS.
Total reward:  -612.1105705883123
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.23183710525847
DONE TAKING  40  STEPS.
Total reward:  -708.7151023488256
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -19.799377283902494
DONE TAKING  40  STEPS.
Total reward:  36.33686150444787
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.103322466189194
DONE TAKING  40  STEPS.
Total reward:  -719.5838858271795
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.002843097588897
DONE TAKING  40  STEPS.
Total reward:  -596.6795311431895
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.63748612007229
DONE TAKING  40  STEPS.
Total reward:  -480.6776441224137
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.685624008180017
DONE TAKING  40  STEPS.
Total reward:  130.65599697993483
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.85663715486766
DONE TAKING  40  STEPS.
Total reward:  -236.31327113964758
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.675872642707922
DONE TAKING  40  STEPS.
Total reward:  -855.2907259227837
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.031743731542342
DONE TAKING  40  STEPS.
Total reward:  -335.83939834075875
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -19.948420164113045
DONE TAKING  40  STEPS.
Total reward:  -273.924062455658
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.116571661766454
DONE TAKING  40  STEPS.
Total reward:  -330.38588009913985
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.548270882332968
DONE TAKING  40  STEPS.
Total reward:  -396.933908079956
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.45376570016179
DONE TAKING  40  STEPS.
Total reward:  -596.8263340078128
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.80104697603317
DONE TAKING  40  STEPS.
Total reward:  -941.4039776936397
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.1389082196429
DONE TAKING  40  STEPS.
Total reward:  -526.7346993944219
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -31.119516454580033
DONE TAKING  40  STEPS.
Total reward:  -175.06034043905083
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter29.ckpt

#####################################
Training the dynamics model..... iteration  30
#####################################

    amount of random data:  8000
    amount of onPol data:  44280
Prob rand:  13650
On pol:  43200
Prob shape:  (56850,)

=== Epoch 0 ===
    train loss:  0.41663694999239465
    val rand:  0.4020032286643982
    val onPol:  0.3151330169704225

=== Epoch 10 ===
    train loss:  0.2057004937449017
    val rand:  0.1943260133266449
    val onPol:  0.2616705182525847

=== Epoch 20 ===
    train loss:  0.16251033866727674
    val rand:  0.1669752448797226
    val onPol:  0.2650219135814243

=== Epoch 30 ===
    train loss:  0.13608950436920733
    val rand:  0.164119690656662
    val onPol:  0.27422289550304413

=== Epoch 39 ===
    train loss:  0.11981402559054864
    val rand:  0.16047391295433044
    val onPol:  0.2850278897417916
Training duration: 27.91 s

#####################################
performing on-policy MPC rollouts... iter  30
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -28.91287070912837
DONE TAKING  40  STEPS.
Total reward:  -662.7931057187791
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.054493647864767
DONE TAKING  40  STEPS.
Total reward:  -308.57667432250184
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -11.871055090540825
DONE TAKING  40  STEPS.
Total reward:  -275.62803203486595
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -15.782760382355523
DONE TAKING  40  STEPS.
Total reward:  87.24645609549262
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.657294695233336
DONE TAKING  40  STEPS.
Total reward:  -926.997196942711
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.812381190266823
DONE TAKING  40  STEPS.
Total reward:  -561.3296771177891
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -21.843996455416246
DONE TAKING  40  STEPS.
Total reward:  -341.9374848885384
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.12426187379659
DONE TAKING  40  STEPS.
Total reward:  -560.8329516346755
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.148187274319532
DONE TAKING  40  STEPS.
Total reward:  -748.3123596194337
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.866073511361908
DONE TAKING  40  STEPS.
Total reward:  167.8915519502877
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -31.27300674541185
DONE TAKING  40  STEPS.
Total reward:  -701.6656490475318
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.877379129340948
DONE TAKING  40  STEPS.
Total reward:  -973.5139307793524
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -10.635087590857975
DONE TAKING  40  STEPS.
Total reward:  -270.9751575569246
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.48282386569476
DONE TAKING  40  STEPS.
Total reward:  -240.5439296590447
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.746750120511187
DONE TAKING  40  STEPS.
Total reward:  -714.9822760998511
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.215917607438183
DONE TAKING  40  STEPS.
Total reward:  -68.99855522259215
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.255461641549699
DONE TAKING  40  STEPS.
Total reward:  -340.37983139866947
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.326461700121637
DONE TAKING  40  STEPS.
Total reward:  -422.8894180801348
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -25.894966212762927
DONE TAKING  40  STEPS.
Total reward:  -539.3443329915029
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.163262714487637
DONE TAKING  40  STEPS.
Total reward:  -250.99709579878194
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -24.485130185650664
DONE TAKING  40  STEPS.
Total reward:  -465.7780428740556
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -10.75179181716599
DONE TAKING  40  STEPS.
Total reward:  -226.28847099417985
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -11.819271055791344
DONE TAKING  40  STEPS.
Total reward:  -194.32693223144364
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.936323793966736
DONE TAKING  40  STEPS.
Total reward:  273.3581776735921
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.53437623626072
DONE TAKING  40  STEPS.
Total reward:  -714.0728850714579
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.240269098182175
DONE TAKING  40  STEPS.
Total reward:  -902.0614631967766
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.30807468595803
DONE TAKING  40  STEPS.
Total reward:  -658.569247852049
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.278590978369643
DONE TAKING  40  STEPS.
Total reward:  -360.38051712110666
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.424662805058738
DONE TAKING  40  STEPS.
Total reward:  -457.66262365301617
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -17.770132550148595
DONE TAKING  40  STEPS.
Total reward:  -342.36924940788504
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.202970043123234
DONE TAKING  40  STEPS.
Total reward:  -314.8976913771769
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.952733058752955
DONE TAKING  40  STEPS.
Total reward:  -18.670610899116475
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -25.510668584735335
DONE TAKING  40  STEPS.
Total reward:  -508.1101790322579
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.049664234111994
DONE TAKING  40  STEPS.
Total reward:  -763.6036102596692
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.47671568912329
DONE TAKING  40  STEPS.
Total reward:  -655.0531056532017
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.20462085036921
DONE TAKING  40  STEPS.
Total reward:  -375.4622615308564
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.590875048518956
DONE TAKING  40  STEPS.
Total reward:  -547.6102405660431
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.31489412387474
DONE TAKING  40  STEPS.
Total reward:  -303.6073268856159
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.563314183745998
DONE TAKING  40  STEPS.
Total reward:  -345.5295417835255
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.167139124821393
DONE TAKING  40  STEPS.
Total reward:  -696.4545844227623
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter30.ckpt

#####################################
Training the dynamics model..... iteration  31
#####################################

    amount of random data:  8000
    amount of onPol data:  45756
Prob rand:  13845
On pol:  44640
Prob shape:  (58485,)

=== Epoch 0 ===
    train loss:  0.41890566207860647
    val rand:  0.39828237891197205
    val onPol:  0.3119718101289537

=== Epoch 10 ===
    train loss:  0.20737664584527937
    val rand:  0.19573555886745453
    val onPol:  0.25877554217974347

=== Epoch 20 ===
    train loss:  0.1654238817200326
    val rand:  0.16735562682151794
    val onPol:  0.2601712793111801

=== Epoch 30 ===
    train loss:  0.13985927585969893
    val rand:  0.16067488491535187
    val onPol:  0.2703825798299577

=== Epoch 39 ===
    train loss:  0.12361291175087293
    val rand:  0.15772168338298798
    val onPol:  0.28020060227976906
Training duration: 28.77 s

#####################################
performing on-policy MPC rollouts... iter  31
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.028644847388964
DONE TAKING  40  STEPS.
Total reward:  -414.1922440294404
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.18110202677391
DONE TAKING  40  STEPS.
Total reward:  -465.3184723999011
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.307332115082644
DONE TAKING  40  STEPS.
Total reward:  -451.3725169013447
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -13.235617354743978
DONE TAKING  40  STEPS.
Total reward:  -91.23038958367181
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.38195517432945
DONE TAKING  40  STEPS.
Total reward:  -731.443774915222
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.453784219009965
DONE TAKING  40  STEPS.
Total reward:  -695.2992875673472
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.807163501466334
DONE TAKING  40  STEPS.
Total reward:  61.63178345876359
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.758006984713024
DONE TAKING  40  STEPS.
Total reward:  -157.31969303334085
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.15527410777569
DONE TAKING  40  STEPS.
Total reward:  -647.810889681513
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -18.611023457498774
DONE TAKING  40  STEPS.
Total reward:  -240.50726936678402
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -18.086288232196004
DONE TAKING  40  STEPS.
Total reward:  -557.1404596859578
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -17.338562384057845
DONE TAKING  40  STEPS.
Total reward:  141.69363395151615
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -17.61436130008751
DONE TAKING  40  STEPS.
Total reward:  -515.3021867138447
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -14.907330694283011
DONE TAKING  40  STEPS.
Total reward:  -390.57994317018
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.604483133855183
DONE TAKING  40  STEPS.
Total reward:  -727.6710779681287
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.878645338512147
DONE TAKING  40  STEPS.
Total reward:  -591.4788871299418
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.315504982223437
DONE TAKING  40  STEPS.
Total reward:  -581.358069518419
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.64034852521805
DONE TAKING  40  STEPS.
Total reward:  59.710882532879964
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.790418288156808
DONE TAKING  40  STEPS.
Total reward:  -722.5712808728274
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.246259984142668
DONE TAKING  40  STEPS.
Total reward:  -892.1179714841536
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -15.628083539376432
DONE TAKING  40  STEPS.
Total reward:  -144.06358359122117
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.3583627657342
DONE TAKING  40  STEPS.
Total reward:  -486.9894812830391
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -18.19501531056275
DONE TAKING  40  STEPS.
Total reward:  -568.7527414843212
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.40031261719582
DONE TAKING  40  STEPS.
Total reward:  -700.2076452496464
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.355014435944753
DONE TAKING  40  STEPS.
Total reward:  264.12961820047957
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -11.253782924005872
DONE TAKING  40  STEPS.
Total reward:  -325.89710467137826
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.627259654051187
DONE TAKING  40  STEPS.
Total reward:  -258.08149150852665
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.266320382984546
DONE TAKING  40  STEPS.
Total reward:  -607.122185711284
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -20.5687020197361
DONE TAKING  40  STEPS.
Total reward:  139.8932148628497
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -31.03317627863081
DONE TAKING  40  STEPS.
Total reward:  -1130.5686551745962
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.76864614290106
DONE TAKING  40  STEPS.
Total reward:  -798.7894882866939
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -14.913946535957818
DONE TAKING  40  STEPS.
Total reward:  -159.64860743036894
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.2028792912432
DONE TAKING  40  STEPS.
Total reward:  -571.81648350534
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.568042747268924
DONE TAKING  40  STEPS.
Total reward:  -410.3842099672593
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.715730102204393
DONE TAKING  40  STEPS.
Total reward:  -609.925832924052
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.437014575100484
DONE TAKING  40  STEPS.
Total reward:  -772.8037141730711
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.898106692084408
DONE TAKING  40  STEPS.
Total reward:  -552.7436007843345
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.04845741845371
DONE TAKING  40  STEPS.
Total reward:  -771.9622684942415
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.72278755749425
DONE TAKING  40  STEPS.
Total reward:  -628.4386284596164
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.203145044304375
DONE TAKING  40  STEPS.
Total reward:  -611.3870778523043
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter31.ckpt

#####################################
Training the dynamics model..... iteration  32
#####################################

    amount of random data:  8000
    amount of onPol data:  47232
Prob rand:  14040
On pol:  46080
Prob shape:  (60120,)

=== Epoch 0 ===
    train loss:  0.41648968213643783
    val rand:  0.4055543839931488
    val onPol:  0.30637803971767424

=== Epoch 10 ===
    train loss:  0.20699591705432305
    val rand:  0.19874510169029236
    val onPol:  0.25704763531684877

=== Epoch 20 ===
    train loss:  0.1675821522362212
    val rand:  0.16883134841918945
    val onPol:  0.2609773501753807

=== Epoch 30 ===
    train loss:  0.14055614173412323
    val rand:  0.16070769727230072
    val onPol:  0.26864023953676225

=== Epoch 39 ===
    train loss:  0.12322631943174917
    val rand:  0.15867698192596436
    val onPol:  0.27736031711101533
Training duration: 29.44 s

#####################################
performing on-policy MPC rollouts... iter  32
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.182826563857436
DONE TAKING  40  STEPS.
Total reward:  -436.0125449525177
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.101627217241347
DONE TAKING  40  STEPS.
Total reward:  -517.3545876569328
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -31.14365074300645
DONE TAKING  40  STEPS.
Total reward:  -965.9600569540497
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.42205477251624
DONE TAKING  40  STEPS.
Total reward:  -473.2714600504423
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -12.22446557490954
DONE TAKING  40  STEPS.
Total reward:  -333.070648760659
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.599898092654776
DONE TAKING  40  STEPS.
Total reward:  -28.002150922264526
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -31.309834536981317
DONE TAKING  40  STEPS.
Total reward:  -1099.1645955772
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.603973591699752
DONE TAKING  40  STEPS.
Total reward:  -672.1370961815744
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.719821995718206
DONE TAKING  40  STEPS.
Total reward:  145.80537641822752
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.614379247750385
DONE TAKING  40  STEPS.
Total reward:  -565.8591179920473
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.517933641760726
DONE TAKING  40  STEPS.
Total reward:  447.8222633603538
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.308615472806515
DONE TAKING  40  STEPS.
Total reward:  -680.2437983323185
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.08382940063051
DONE TAKING  40  STEPS.
Total reward:  -391.2081271480417
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -19.27112421114486
DONE TAKING  40  STEPS.
Total reward:  -306.14659866218807
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.139176969724787
DONE TAKING  40  STEPS.
Total reward:  -545.2536756324885
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.515299805861556
DONE TAKING  40  STEPS.
Total reward:  -585.3704961364285
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.47322598035087
DONE TAKING  40  STEPS.
Total reward:  -136.92271661974485
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.533365001592113
DONE TAKING  40  STEPS.
Total reward:  -180.35530487165812
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.938985668278193
DONE TAKING  40  STEPS.
Total reward:  -782.4111061396078
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.674266794419765
DONE TAKING  40  STEPS.
Total reward:  -443.9678796997663
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.662711036208385
DONE TAKING  40  STEPS.
Total reward:  -288.1346007533285
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.056705557608652
DONE TAKING  40  STEPS.
Total reward:  82.34206754555981
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -14.964772227859303
DONE TAKING  40  STEPS.
Total reward:  -369.34137236207965
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.892815333184217
DONE TAKING  40  STEPS.
Total reward:  -474.0436279753751
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.170177096356145
DONE TAKING  40  STEPS.
Total reward:  -216.6006253981425
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.446231291983683
DONE TAKING  40  STEPS.
Total reward:  -89.6582390666168
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.715322691738766
DONE TAKING  40  STEPS.
Total reward:  -1096.2276569005444
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.890757428939878
DONE TAKING  40  STEPS.
Total reward:  -253.23029125957174
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.32135053981491
DONE TAKING  40  STEPS.
Total reward:  -536.7518825632387
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.999661563261043
DONE TAKING  40  STEPS.
Total reward:  -708.3395412099603
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.3095317759131
DONE TAKING  40  STEPS.
Total reward:  -33.44480211053318
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.47709636210751
DONE TAKING  40  STEPS.
Total reward:  -737.1085255772701
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.46913276280459
DONE TAKING  40  STEPS.
Total reward:  -1062.2612682602928
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -11.366373044176228
DONE TAKING  40  STEPS.
Total reward:  272.37310010026465
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.094122938682105
DONE TAKING  40  STEPS.
Total reward:  -57.687140826229424
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.04895947033477
DONE TAKING  40  STEPS.
Total reward:  -597.7849916570228
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.83406856182934
DONE TAKING  40  STEPS.
Total reward:  -511.21705458559603
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.256096766058818
DONE TAKING  40  STEPS.
Total reward:  -110.5133138372707
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.43946761409552
DONE TAKING  40  STEPS.
Total reward:  -411.5932311556256
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.345749426515365
DONE TAKING  40  STEPS.
Total reward:  -465.6698489522758
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter32.ckpt

#####################################
Training the dynamics model..... iteration  33
#####################################

    amount of random data:  8000
    amount of onPol data:  48708
Prob rand:  14235
On pol:  47520
Prob shape:  (61755,)

=== Epoch 0 ===
    train loss:  0.4126284723480543
    val rand:  0.4031621813774109
    val onPol:  0.30571137815713884

=== Epoch 10 ===
    train loss:  0.2076122077802817
    val rand:  0.20087730884552002
    val onPol:  0.25624617487192153

=== Epoch 20 ===
    train loss:  0.1671697348356247
    val rand:  0.17244669795036316
    val onPol:  0.2579392001032829

=== Epoch 30 ===
    train loss:  0.14076673140128454
    val rand:  0.1641397774219513
    val onPol:  0.2663646936416626

=== Epoch 39 ===
    train loss:  0.12333993682016929
    val rand:  0.1604653298854828
    val onPol:  0.27466394305229186
Training duration: 31.09 s

#####################################
performing on-policy MPC rollouts... iter  33
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.194955297530583
DONE TAKING  40  STEPS.
Total reward:  -577.5113585855728
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.481400382317684
DONE TAKING  40  STEPS.
Total reward:  -648.3718604373283
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.719089687838064
DONE TAKING  40  STEPS.
Total reward:  67.19118654022922
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.722670778779566
DONE TAKING  40  STEPS.
Total reward:  -871.2634600093883
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.332226975585073
DONE TAKING  40  STEPS.
Total reward:  -471.60994866944793
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -18.11707603338246
DONE TAKING  40  STEPS.
Total reward:  -252.76405564652424
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.370587121890534
DONE TAKING  40  STEPS.
Total reward:  -487.6434951435805
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.371667772591124
DONE TAKING  40  STEPS.
Total reward:  -577.4199561439286
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.833970178870068
DONE TAKING  40  STEPS.
Total reward:  -375.7774469038877
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.51854312569853
DONE TAKING  40  STEPS.
Total reward:  -383.008921247945
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -12.791285395776391
DONE TAKING  40  STEPS.
Total reward:  -483.865806803393
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.300512367573234
DONE TAKING  40  STEPS.
Total reward:  -397.5461040667213
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -31.067119407155495
DONE TAKING  40  STEPS.
Total reward:  -158.77826981132333
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.130272575704485
DONE TAKING  40  STEPS.
Total reward:  -312.1964898614446
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.66635342217545
DONE TAKING  40  STEPS.
Total reward:  -632.6859777961574
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.35062318099104
DONE TAKING  40  STEPS.
Total reward:  137.18571010250255
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.393958802113026
DONE TAKING  40  STEPS.
Total reward:  -544.705442845804
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.985043090445867
DONE TAKING  40  STEPS.
Total reward:  -1006.4701583424858
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.412802906069235
DONE TAKING  40  STEPS.
Total reward:  -324.5090464993359
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.98445538651978
DONE TAKING  40  STEPS.
Total reward:  -463.8915173669858
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.297625792734728
DONE TAKING  40  STEPS.
Total reward:  -561.5047699481399
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.55259742499034
DONE TAKING  40  STEPS.
Total reward:  -447.2751626330251
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.043275379680452
DONE TAKING  40  STEPS.
Total reward:  -956.92964242255
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.27253182289661
DONE TAKING  40  STEPS.
Total reward:  -989.3835541013614
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.719806199572773
DONE TAKING  40  STEPS.
Total reward:  -728.7450986990419
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.8090439889079
DONE TAKING  40  STEPS.
Total reward:  -167.86673610407917
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.575776903568084
DONE TAKING  40  STEPS.
Total reward:  -971.7464078597225
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.783003267435294
DONE TAKING  40  STEPS.
Total reward:  -319.4675974487289
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -14.33077430187138
DONE TAKING  40  STEPS.
Total reward:  -406.6234673334931
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.57963990134556
DONE TAKING  40  STEPS.
Total reward:  -469.3562559372615
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.293830486992057
DONE TAKING  40  STEPS.
Total reward:  -909.1078737178033
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.73015376687195
DONE TAKING  40  STEPS.
Total reward:  -879.7872260470949
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.204347880613362
DONE TAKING  40  STEPS.
Total reward:  -200.7789442784121
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -20.116175430286578
DONE TAKING  40  STEPS.
Total reward:  -587.1196946762014
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.15875269015674
DONE TAKING  40  STEPS.
Total reward:  -836.6664811748485
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.48824484706897
DONE TAKING  40  STEPS.
Total reward:  -45.64858782004475
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.352075064036125
DONE TAKING  40  STEPS.
Total reward:  -178.9616879181857
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.49179659522927
DONE TAKING  40  STEPS.
Total reward:  -508.5713008804771
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -22.293158552439095
DONE TAKING  40  STEPS.
Total reward:  -720.3565968721518
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.11682008134142
DONE TAKING  40  STEPS.
Total reward:  -696.992650455923
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter33.ckpt

#####################################
Training the dynamics model..... iteration  34
#####################################

    amount of random data:  8000
    amount of onPol data:  50184
Prob rand:  14430
On pol:  48960
Prob shape:  (63390,)

=== Epoch 0 ===
    train loss:  0.4150679673605818
    val rand:  0.4119166135787964
    val onPol:  0.3064092367887497

=== Epoch 10 ===
    train loss:  0.20803862991856364
    val rand:  0.20639988780021667
    val onPol:  0.256057408452034

=== Epoch 20 ===
    train loss:  0.1678046809463966
    val rand:  0.1673092097043991
    val onPol:  0.25645702034235

=== Epoch 30 ===
    train loss:  0.14298035325558206
    val rand:  0.16250641644001007
    val onPol:  0.26531574577093125

=== Epoch 39 ===
    train loss:  0.124623744407805
    val rand:  0.16364429891109467
    val onPol:  0.27455134242773055
Training duration: 31.90 s

#####################################
performing on-policy MPC rollouts... iter  34
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.28934335234606
DONE TAKING  40  STEPS.
Total reward:  -118.30997167416035
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.54089752233432
DONE TAKING  40  STEPS.
Total reward:  -100.17372595409287
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.521329057856805
DONE TAKING  40  STEPS.
Total reward:  -464.8193911843115
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -18.28524753646072
DONE TAKING  40  STEPS.
Total reward:  -318.8287702674601
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.90307122164932
DONE TAKING  40  STEPS.
Total reward:  -855.7350841595935
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.86951758445123
DONE TAKING  40  STEPS.
Total reward:  -480.40334409288045
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.27444861428063
DONE TAKING  40  STEPS.
Total reward:  -507.64903786042066
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.2299431219414
DONE TAKING  40  STEPS.
Total reward:  -573.4339800054735
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.235420166835357
DONE TAKING  40  STEPS.
Total reward:  -918.1508952660297
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.31877661199566
DONE TAKING  40  STEPS.
Total reward:  -229.62763131135665
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.847339790443034
DONE TAKING  40  STEPS.
Total reward:  -886.7496172342362
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.35765085460052
DONE TAKING  40  STEPS.
Total reward:  -449.16074082819244
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.917480797150013
DONE TAKING  40  STEPS.
Total reward:  -307.67027081287534
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.494802903741792
DONE TAKING  40  STEPS.
Total reward:  -298.9508817265327
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.6886065802143
DONE TAKING  40  STEPS.
Total reward:  -535.7069662659849
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.197299582914443
DONE TAKING  40  STEPS.
Total reward:  -637.0930122390388
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.14103515903805
DONE TAKING  40  STEPS.
Total reward:  -491.0349356584561
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.51888918397973
DONE TAKING  40  STEPS.
Total reward:  -716.7685189307444
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.94318510410185
DONE TAKING  40  STEPS.
Total reward:  -89.64831158131963
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.604040889563286
DONE TAKING  40  STEPS.
Total reward:  -683.038643175863
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.49863258692645
DONE TAKING  40  STEPS.
Total reward:  -793.9842525292257
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.227715650316945
DONE TAKING  40  STEPS.
Total reward:  -882.3159867597569
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.010899093507938
DONE TAKING  40  STEPS.
Total reward:  -616.2661802343797
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -31.349609646033
DONE TAKING  40  STEPS.
Total reward:  -935.5970823835869
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.95587176493279
DONE TAKING  40  STEPS.
Total reward:  -304.0333116657319
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.349530051600098
DONE TAKING  40  STEPS.
Total reward:  -595.8858530702074
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.390489644708538
DONE TAKING  40  STEPS.
Total reward:  -941.0986101540375
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.765435323022093
DONE TAKING  40  STEPS.
Total reward:  -721.531177401031
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -19.712445359696098
DONE TAKING  40  STEPS.
Total reward:  -546.9667674368064
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.481337766578143
DONE TAKING  40  STEPS.
Total reward:  205.92186050490608
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.562929666427628
DONE TAKING  40  STEPS.
Total reward:  -981.5633335208545
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.263605841671627
DONE TAKING  40  STEPS.
Total reward:  411.5360817261507
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.35329201590691
DONE TAKING  40  STEPS.
Total reward:  -829.4108270073931
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.75875777150982
DONE TAKING  40  STEPS.
Total reward:  -767.9201312187264
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.533004706948976
DONE TAKING  40  STEPS.
Total reward:  -411.17187150999956
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -17.06612778505294
DONE TAKING  40  STEPS.
Total reward:  -255.1985092975464
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.715643684134946
DONE TAKING  40  STEPS.
Total reward:  -626.4187058607216
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -14.833774843043773
DONE TAKING  40  STEPS.
Total reward:  -473.3797122999885
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.25923431196474
DONE TAKING  40  STEPS.
Total reward:  -813.6332091971167
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.34050721227002
DONE TAKING  40  STEPS.
Total reward:  45.685778933016564
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter34.ckpt

#####################################
Training the dynamics model..... iteration  35
#####################################

    amount of random data:  8000
    amount of onPol data:  51660
Prob rand:  14625
On pol:  50400
Prob shape:  (65025,)

=== Epoch 0 ===
    train loss:  0.4086911042374889
    val rand:  0.39970946311950684
    val onPol:  0.305311119556427

=== Epoch 10 ===
    train loss:  0.20610769679696542
    val rand:  0.19850841164588928
    val onPol:  0.25435869246721265

=== Epoch 20 ===
    train loss:  0.16718876901574023
    val rand:  0.16952010989189148
    val onPol:  0.2555414080619812

=== Epoch 30 ===
    train loss:  0.14224233613239498
    val rand:  0.16581571102142334
    val onPol:  0.2669861987233162

=== Epoch 39 ===
    train loss:  0.12316885960149014
    val rand:  0.1599797010421753
    val onPol:  0.27571236789226533
Training duration: 32.15 s

#####################################
performing on-policy MPC rollouts... iter  35
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -11.470715556576982
DONE TAKING  40  STEPS.
Total reward:  26.095016984950604
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.47991723354945
DONE TAKING  40  STEPS.
Total reward:  -680.5974667478274
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.885860943051483
DONE TAKING  40  STEPS.
Total reward:  -846.2398499525883
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.00642394529887
DONE TAKING  40  STEPS.
Total reward:  -915.0183146738344
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -31.341563650024465
DONE TAKING  40  STEPS.
Total reward:  -874.3098399257246
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -12.67462937490135
DONE TAKING  40  STEPS.
Total reward:  -428.28101701851915
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.194147953844556
DONE TAKING  40  STEPS.
Total reward:  -557.3813397611301
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.93067721151037
DONE TAKING  40  STEPS.
Total reward:  -486.9782552038545
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -9.57970302208624
DONE TAKING  40  STEPS.
Total reward:  -97.44134342610053
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.45693366504016
DONE TAKING  40  STEPS.
Total reward:  -667.8014831674343
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.083746438836798
DONE TAKING  40  STEPS.
Total reward:  -499.2174077473481
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.382055977860585
DONE TAKING  40  STEPS.
Total reward:  220.30915500344523
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.69307690872925
DONE TAKING  40  STEPS.
Total reward:  -1023.7832651831561
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.561277766077147
DONE TAKING  40  STEPS.
Total reward:  -943.7670006184201
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -12.693178880515196
DONE TAKING  40  STEPS.
Total reward:  -401.9146627473034
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.79540944170271
DONE TAKING  40  STEPS.
Total reward:  -81.9683281281596
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -15.912130445056752
DONE TAKING  40  STEPS.
Total reward:  -360.4036802565691
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.11113678868213
DONE TAKING  40  STEPS.
Total reward:  -262.51529740700386
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -14.114146278925443
DONE TAKING  40  STEPS.
Total reward:  -292.6204587814076
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.614687020605267
DONE TAKING  40  STEPS.
Total reward:  57.805283860150716
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.25117288672505
DONE TAKING  40  STEPS.
Total reward:  -584.6953013224586
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.66934440556125
DONE TAKING  40  STEPS.
Total reward:  -697.9677118392378
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.749466881143263
DONE TAKING  40  STEPS.
Total reward:  -767.4801369282707
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.663689686038055
DONE TAKING  40  STEPS.
Total reward:  -305.12629081959545
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -10.978512392900676
DONE TAKING  40  STEPS.
Total reward:  -159.3590882933666
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -17.04440755207948
DONE TAKING  40  STEPS.
Total reward:  -94.65028522684268
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.06736165035965
DONE TAKING  40  STEPS.
Total reward:  -414.86294800270895
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.95692623787397
DONE TAKING  40  STEPS.
Total reward:  -314.06743301738027
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.23663365730991
DONE TAKING  40  STEPS.
Total reward:  39.36127323275608
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -18.024531232093274
DONE TAKING  40  STEPS.
Total reward:  -105.00700533178816
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.510753699808127
DONE TAKING  40  STEPS.
Total reward:  -411.424518021628
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -14.062660783967353
DONE TAKING  40  STEPS.
Total reward:  -294.6986453600158
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.27146483060579
DONE TAKING  40  STEPS.
Total reward:  -278.0349680016983
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.541182274933583
DONE TAKING  40  STEPS.
Total reward:  -596.7895050101373
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.05617723566824
DONE TAKING  40  STEPS.
Total reward:  -298.9189289242154
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.651641286089195
DONE TAKING  40  STEPS.
Total reward:  -748.1708541868347
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.865380319691656
DONE TAKING  40  STEPS.
Total reward:  -326.4702092117796
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.917580216353812
DONE TAKING  40  STEPS.
Total reward:  -233.87341118691015
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.886259667832647
DONE TAKING  40  STEPS.
Total reward:  -897.1942393224887
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.290489827231564
DONE TAKING  40  STEPS.
Total reward:  -635.0552182557876
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter35.ckpt

#####################################
Training the dynamics model..... iteration  36
#####################################

    amount of random data:  8000
    amount of onPol data:  53136
Prob rand:  14820
On pol:  51840
Prob shape:  (66660,)

=== Epoch 0 ===
    train loss:  0.4148664203973917
    val rand:  0.4042574167251587
    val onPol:  0.29957885362885217

=== Epoch 10 ===
    train loss:  0.21192823682840053
    val rand:  0.20741474628448486
    val onPol:  0.2496133351867849

=== Epoch 20 ===
    train loss:  0.17280191618662613
    val rand:  0.17326514422893524
    val onPol:  0.2530673227526925

=== Epoch 30 ===
    train loss:  0.14626999703737406
    val rand:  0.16265442967414856
    val onPol:  0.2594654004682194

=== Epoch 39 ===
    train loss:  0.1288487602884953
    val rand:  0.164939746260643
    val onPol:  0.2681372097947381
Training duration: 32.78 s

#####################################
performing on-policy MPC rollouts... iter  36
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.684627491277443
DONE TAKING  40  STEPS.
Total reward:  -523.3819111147917
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.701583040874475
DONE TAKING  40  STEPS.
Total reward:  -718.5602300114298
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.92938555423317
DONE TAKING  40  STEPS.
Total reward:  -569.6287277025299
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -10.949214240352356
DONE TAKING  40  STEPS.
Total reward:  -279.1023844104228
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.793778701101655
DONE TAKING  40  STEPS.
Total reward:  -385.3911520505987
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -11.649881196766856
DONE TAKING  40  STEPS.
Total reward:  75.557356252567
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.933324846427517
DONE TAKING  40  STEPS.
Total reward:  -794.3801041242538
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.57192875499901
DONE TAKING  40  STEPS.
Total reward:  -871.6256210182871
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.758485359017865
DONE TAKING  40  STEPS.
Total reward:  -915.2602672354013
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.559830347655407
DONE TAKING  40  STEPS.
Total reward:  -130.29960588980853
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -31.328822673392732
DONE TAKING  40  STEPS.
Total reward:  -387.0774723548966
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.50824607993891
DONE TAKING  40  STEPS.
Total reward:  -392.1869849251331
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.3128365336027
DONE TAKING  40  STEPS.
Total reward:  -1025.4418611703798
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.249969217834362
DONE TAKING  40  STEPS.
Total reward:  -428.16529409048877
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.35378525609465
DONE TAKING  40  STEPS.
Total reward:  -128.18509836233275
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.514319489598254
DONE TAKING  40  STEPS.
Total reward:  -453.9356507519871
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.779576838811778
DONE TAKING  40  STEPS.
Total reward:  -226.96811634547302
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.702134570634378
DONE TAKING  40  STEPS.
Total reward:  -814.8407080805566
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.456371529202194
DONE TAKING  40  STEPS.
Total reward:  25.697333638702553
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.760830596483196
DONE TAKING  40  STEPS.
Total reward:  -1023.9776087723785
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.640722287078805
DONE TAKING  40  STEPS.
Total reward:  -291.7767604473191
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -17.471214118472385
DONE TAKING  40  STEPS.
Total reward:  -458.6083960286558
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.60656379984074
DONE TAKING  40  STEPS.
Total reward:  -479.89004741113797
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.533911853144144
DONE TAKING  40  STEPS.
Total reward:  -406.7456753103727
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.369977399203947
DONE TAKING  40  STEPS.
Total reward:  -545.9620482429821
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.390487793916275
DONE TAKING  40  STEPS.
Total reward:  251.07493702419632
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.390205013321733
DONE TAKING  40  STEPS.
Total reward:  -475.2121533145047
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -31.157321853828268
DONE TAKING  40  STEPS.
Total reward:  -468.6878268562952
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.258810240103482
DONE TAKING  40  STEPS.
Total reward:  -535.273875900399
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.34716050392279
DONE TAKING  40  STEPS.
Total reward:  -613.4686892258283
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.0474186649353
DONE TAKING  40  STEPS.
Total reward:  -607.5046150645089
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -15.948586053447372
DONE TAKING  40  STEPS.
Total reward:  -249.69015109201814
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.853437837403405
DONE TAKING  40  STEPS.
Total reward:  -830.8072354788006
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.304687547610214
DONE TAKING  40  STEPS.
Total reward:  -342.47938517663385
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.839760127590612
DONE TAKING  40  STEPS.
Total reward:  -721.1044351911696
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.808161331202047
DONE TAKING  40  STEPS.
Total reward:  -628.6135112888338
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.125947759952325
DONE TAKING  40  STEPS.
Total reward:  -484.46199285702824
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.721416868254774
DONE TAKING  40  STEPS.
Total reward:  -547.6106441768891
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.541730299389357
DONE TAKING  40  STEPS.
Total reward:  -292.0982073581133
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.897989563052207
DONE TAKING  40  STEPS.
Total reward:  -560.2724710815618
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter36.ckpt

#####################################
Training the dynamics model..... iteration  37
#####################################

    amount of random data:  8000
    amount of onPol data:  54612
Prob rand:  15015
On pol:  53280
Prob shape:  (68295,)

=== Epoch 0 ===
    train loss:  0.4071156236910282
    val rand:  0.4115823209285736
    val onPol:  0.3009841266003522

=== Epoch 10 ===
    train loss:  0.2102476542157338
    val rand:  0.2041367143392563
    val onPol:  0.24843786521391434

=== Epoch 20 ===
    train loss:  0.17085280308597967
    val rand:  0.17026333510875702
    val onPol:  0.25040357492186804

=== Epoch 30 ===
    train loss:  0.1452694268603074
    val rand:  0.16269628703594208
    val onPol:  0.2596374614672227

=== Epoch 39 ===
    train loss:  0.12827927361529573
    val rand:  0.16458387672901154
    val onPol:  0.2685412195595828
Training duration: 33.56 s

#####################################
performing on-policy MPC rollouts... iter  37
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.008587824123776
DONE TAKING  40  STEPS.
Total reward:  -374.2781686767251
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.223818618844867
DONE TAKING  40  STEPS.
Total reward:  -799.6431214941038
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.221272341588815
DONE TAKING  40  STEPS.
Total reward:  -631.9111270739445
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.216174985606486
DONE TAKING  40  STEPS.
Total reward:  -468.4103925317202
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.139377179729706
DONE TAKING  40  STEPS.
Total reward:  -311.70951265794235
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.17878280623882
DONE TAKING  40  STEPS.
Total reward:  -636.713405084695
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.709393231050253
DONE TAKING  40  STEPS.
Total reward:  -417.52639050241305
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.145512035806803
DONE TAKING  40  STEPS.
Total reward:  -831.7901420234211
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.435062619020943
DONE TAKING  40  STEPS.
Total reward:  -571.6021994152727
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.88815404586971
DONE TAKING  40  STEPS.
Total reward:  -517.1846010941938
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.995220913854848
DONE TAKING  40  STEPS.
Total reward:  -714.306236594158
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.72232808550408
DONE TAKING  40  STEPS.
Total reward:  -775.2286652101839
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.096804721432964
DONE TAKING  40  STEPS.
Total reward:  -513.9443133584632
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.139446873905037
DONE TAKING  40  STEPS.
Total reward:  -319.72228267601054
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.878245379159544
DONE TAKING  40  STEPS.
Total reward:  -535.2944739455554
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.802101673816694
DONE TAKING  40  STEPS.
Total reward:  -662.045971907122
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.26185914045855
DONE TAKING  40  STEPS.
Total reward:  -391.88880523263083
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.453074331173283
DONE TAKING  40  STEPS.
Total reward:  -407.73689978571514
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.296761111307834
DONE TAKING  40  STEPS.
Total reward:  -772.7646663272395
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.979443688711914
DONE TAKING  40  STEPS.
Total reward:  -273.20604981989175
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.45824985498553
DONE TAKING  40  STEPS.
Total reward:  -472.2628446620852
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.228743809367476
DONE TAKING  40  STEPS.
Total reward:  -143.64036018000527
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.800467732175488
DONE TAKING  40  STEPS.
Total reward:  -469.1965657327011
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.598882870306443
DONE TAKING  40  STEPS.
Total reward:  -282.5092378212285
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.4708114024364
DONE TAKING  40  STEPS.
Total reward:  -27.048421836473473
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.065762464222242
DONE TAKING  40  STEPS.
Total reward:  -301.0742366119246
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.366295701386637
DONE TAKING  40  STEPS.
Total reward:  180.97497425757825
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -15.61121395552707
DONE TAKING  40  STEPS.
Total reward:  0.9791514364385279
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.847457221957313
DONE TAKING  40  STEPS.
Total reward:  -904.522263724733
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -13.579066035790596
DONE TAKING  40  STEPS.
Total reward:  -354.1924647581309
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.777965809342298
DONE TAKING  40  STEPS.
Total reward:  -40.595152561377574
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -12.140659566593971
DONE TAKING  40  STEPS.
Total reward:  -283.5541823312828
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.42673284068064
DONE TAKING  40  STEPS.
Total reward:  -292.58673528368047
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.007309406650997
DONE TAKING  40  STEPS.
Total reward:  -477.18773539383625
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.14271135695396
DONE TAKING  40  STEPS.
Total reward:  -527.5591487875234
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.082201861988942
DONE TAKING  40  STEPS.
Total reward:  -632.2740245678085
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.43215689432028
DONE TAKING  40  STEPS.
Total reward:  -470.66677772194873
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.339783601051895
DONE TAKING  40  STEPS.
Total reward:  -414.3119761178779
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.876400379050708
DONE TAKING  40  STEPS.
Total reward:  -480.64843390827707
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.468422528906316
DONE TAKING  40  STEPS.
Total reward:  -619.7261951181329
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter37.ckpt

#####################################
Training the dynamics model..... iteration  38
#####################################

    amount of random data:  8000
    amount of onPol data:  56088
Prob rand:  15210
On pol:  54720
Prob shape:  (69930,)

=== Epoch 0 ===
    train loss:  0.4088712880278335
    val rand:  0.404009073972702
    val onPol:  0.30191920562223956

=== Epoch 10 ===
    train loss:  0.21117596919922269
    val rand:  0.20754733681678772
    val onPol:  0.24869418821551584

=== Epoch 20 ===
    train loss:  0.17138546705245972
    val rand:  0.17345449328422546
    val onPol:  0.2521122937852686

=== Epoch 30 ===
    train loss:  0.146179287968313
    val rand:  0.16574236750602722
    val onPol:  0.2589764202182943

=== Epoch 39 ===
    train loss:  0.12919238302856684
    val rand:  0.1676025241613388
    val onPol:  0.2679318121888421
Training duration: 35.33 s

#####################################
performing on-policy MPC rollouts... iter  38
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.6326398047376
DONE TAKING  40  STEPS.
Total reward:  -827.2733715313921
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.060139872626422
DONE TAKING  40  STEPS.
Total reward:  -664.9859962670316
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -14.826845342762752
DONE TAKING  40  STEPS.
Total reward:  -497.92691288499293
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -13.202517383547143
DONE TAKING  40  STEPS.
Total reward:  -251.43424395849735
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -15.567140269470833
DONE TAKING  40  STEPS.
Total reward:  -367.7583431083797
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.16415447430422
DONE TAKING  40  STEPS.
Total reward:  -589.5859276980981
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.458070668515266
DONE TAKING  40  STEPS.
Total reward:  -54.5332914863319
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.94419532317691
DONE TAKING  40  STEPS.
Total reward:  -918.558636261276
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.48018560964664
DONE TAKING  40  STEPS.
Total reward:  -790.0306183021884
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.151574762448952
DONE TAKING  40  STEPS.
Total reward:  -775.7777064937662
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -17.450094537896796
DONE TAKING  40  STEPS.
Total reward:  -370.9941817378712
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.89773035981254
DONE TAKING  40  STEPS.
Total reward:  -1071.0480881978515
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -13.372064209804053
DONE TAKING  40  STEPS.
Total reward:  -333.8205177735119
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.899021876788805
DONE TAKING  40  STEPS.
Total reward:  -528.0136938995265
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.366902947771903
DONE TAKING  40  STEPS.
Total reward:  -329.3127168257043
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.201751814999607
DONE TAKING  40  STEPS.
Total reward:  -590.5873390885437
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.066317028745374
DONE TAKING  40  STEPS.
Total reward:  -141.64626157796897
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.27442352786064
DONE TAKING  40  STEPS.
Total reward:  277.9856690118733
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.555360837090753
DONE TAKING  40  STEPS.
Total reward:  -504.90317323251605
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.899421764205579
DONE TAKING  40  STEPS.
Total reward:  23.595924003669253
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.905231925291748
DONE TAKING  40  STEPS.
Total reward:  -528.6964482222519
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.504998192410135
DONE TAKING  40  STEPS.
Total reward:  -239.18533459603137
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.83953036245097
DONE TAKING  40  STEPS.
Total reward:  -338.09988998014336
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -12.995274943101851
DONE TAKING  40  STEPS.
Total reward:  123.56490714555558
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -11.95697428732273
DONE TAKING  40  STEPS.
Total reward:  369.86738377601006
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.279205376430525
DONE TAKING  40  STEPS.
Total reward:  300.7950348596277
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.419144109341246
DONE TAKING  40  STEPS.
Total reward:  -231.76771784269658
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.357991375365565
DONE TAKING  40  STEPS.
Total reward:  307.35933953741744
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -20.7922597910012
DONE TAKING  40  STEPS.
Total reward:  -261.7640161316401
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.126623968292357
DONE TAKING  40  STEPS.
Total reward:  -774.1702060021858
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.582429055060306
DONE TAKING  40  STEPS.
Total reward:  -512.7891150639371
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.081308014776788
DONE TAKING  40  STEPS.
Total reward:  -220.4102550726725
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -16.103977799108353
DONE TAKING  40  STEPS.
Total reward:  245.2634391356708
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -14.56968040432936
DONE TAKING  40  STEPS.
Total reward:  -177.52990555311277
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.045282060580572
DONE TAKING  40  STEPS.
Total reward:  -108.67166845851835
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.142014382623838
DONE TAKING  40  STEPS.
Total reward:  -596.7228044313007
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.13647890584037
DONE TAKING  40  STEPS.
Total reward:  -363.74338508812474
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -13.791055343460172
DONE TAKING  40  STEPS.
Total reward:  324.32320114537725
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.856596442420496
DONE TAKING  40  STEPS.
Total reward:  -612.0853558794595
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.411131050995397
DONE TAKING  40  STEPS.
Total reward:  -354.4507645219193
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter38.ckpt

#####################################
Training the dynamics model..... iteration  39
#####################################

    amount of random data:  8000
    amount of onPol data:  57564
Prob rand:  15405
On pol:  56160
Prob shape:  (71565,)

=== Epoch 0 ===
    train loss:  0.4109222687405648
    val rand:  0.4093230664730072
    val onPol:  0.305213646342357

=== Epoch 10 ===
    train loss:  0.2129815340899735
    val rand:  0.20627140998840332
    val onPol:  0.25168653825918835

=== Epoch 20 ===
    train loss:  0.17245663584565088
    val rand:  0.1769317090511322
    val onPol:  0.2541650248070558

=== Epoch 30 ===
    train loss:  0.14811158898494226
    val rand:  0.16852903366088867
    val onPol:  0.2608599153657754

=== Epoch 39 ===
    train loss:  0.13223122810717108
    val rand:  0.17019931972026825
    val onPol:  0.26938245569666225
Training duration: 43.99 s

#####################################
performing on-policy MPC rollouts... iter  39
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.881407199908708
DONE TAKING  40  STEPS.
Total reward:  -862.0607727132442
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.436113706433833
DONE TAKING  40  STEPS.
Total reward:  -672.7837182731839
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -14.629835395786495
DONE TAKING  40  STEPS.
Total reward:  -497.8365334376693
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.7878687762529
DONE TAKING  40  STEPS.
Total reward:  -314.1960255440828
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.708786193815016
DONE TAKING  40  STEPS.
Total reward:  -878.8157442233352
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.795361724828602
DONE TAKING  40  STEPS.
Total reward:  -467.56903067383035
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -18.882590236044983
DONE TAKING  40  STEPS.
Total reward:  -415.1395713949815
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.211882034723793
DONE TAKING  40  STEPS.
Total reward:  -569.6997573219612
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.269944308645623
DONE TAKING  40  STEPS.
Total reward:  -892.0836908992442
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.980147515696594
DONE TAKING  40  STEPS.
Total reward:  -925.0212956277993
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.924324271422712
DONE TAKING  40  STEPS.
Total reward:  -666.0016912961115
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.893626071920643
DONE TAKING  40  STEPS.
Total reward:  -943.8989043233273
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.488135971897016
DONE TAKING  40  STEPS.
Total reward:  -975.6462303344031
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.39525148194653
DONE TAKING  40  STEPS.
Total reward:  -557.3815812608336
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.598427948680516
DONE TAKING  40  STEPS.
Total reward:  -232.4430995851701
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -13.953211805669298
DONE TAKING  40  STEPS.
Total reward:  -154.98571254329138
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.893873950085514
DONE TAKING  40  STEPS.
Total reward:  -455.30285536246635
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.57619657555038
DONE TAKING  40  STEPS.
Total reward:  -843.1543034768897
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.696992286329536
DONE TAKING  40  STEPS.
Total reward:  -681.6466379808733
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.987889390573216
DONE TAKING  40  STEPS.
Total reward:  -843.4206111550891
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.45681476232349
DONE TAKING  40  STEPS.
Total reward:  -771.3323749306132
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.141307837780587
DONE TAKING  40  STEPS.
Total reward:  -581.698590508431
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.80074897053003
DONE TAKING  40  STEPS.
Total reward:  -584.6313166814683
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.946014888246125
DONE TAKING  40  STEPS.
Total reward:  -647.1736079765138
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.66559231544966
DONE TAKING  40  STEPS.
Total reward:  -271.3554506040153
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.188387442705427
DONE TAKING  40  STEPS.
Total reward:  -662.0314158471982
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.29215944768518
DONE TAKING  40  STEPS.
Total reward:  179.0571387430378
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.197517533250164
DONE TAKING  40  STEPS.
Total reward:  -785.1042009058883
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -15.357602728671036
DONE TAKING  40  STEPS.
Total reward:  -419.41661225229177
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.91164598997461
DONE TAKING  40  STEPS.
Total reward:  -255.0485489521006
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.056877031964298
DONE TAKING  40  STEPS.
Total reward:  -794.9349132049532
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.130225004644775
DONE TAKING  40  STEPS.
Total reward:  -498.66672159958404
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.577856385878952
DONE TAKING  40  STEPS.
Total reward:  -424.5766239519458
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -31.3044299727953
DONE TAKING  40  STEPS.
Total reward:  -811.745503280231
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.65209835008053
DONE TAKING  40  STEPS.
Total reward:  255.86445928539442
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.502387272438764
DONE TAKING  40  STEPS.
Total reward:  -1.5355750071230645
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.090695729579714
DONE TAKING  40  STEPS.
Total reward:  -411.3327144587871
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.702790841427863
DONE TAKING  40  STEPS.
Total reward:  -476.7587162588321
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.685686214695213
DONE TAKING  40  STEPS.
Total reward:  -514.7636728687511
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.48384453056058
DONE TAKING  40  STEPS.
Total reward:  -700.6273441405823
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter39.ckpt

#####################################
Training the dynamics model..... iteration  40
#####################################

    amount of random data:  8000
    amount of onPol data:  59040
Prob rand:  15600
On pol:  57600
Prob shape:  (73200,)

=== Epoch 0 ===
    train loss:  0.40638567864055364
    val rand:  0.40971094369888306
    val onPol:  0.30586769928534824

=== Epoch 10 ===
    train loss:  0.212137264265141
    val rand:  0.20938679575920105
    val onPol:  0.2534777745604515

=== Epoch 20 ===
    train loss:  0.17289685311032013
    val rand:  0.17403757572174072
    val onPol:  0.2562662623822689

=== Epoch 30 ===
    train loss:  0.14719775466012283
    val rand:  0.16452038288116455
    val onPol:  0.26419974242647487

=== Epoch 39 ===
    train loss:  0.13023191428100558
    val rand:  0.16158214211463928
    val onPol:  0.2710060141980648
Training duration: 36.87 s

#####################################
performing on-policy MPC rollouts... iter  40
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.712763785772598
DONE TAKING  40  STEPS.
Total reward:  -465.158602478836
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -14.091039110481349
DONE TAKING  40  STEPS.
Total reward:  -367.42988997748085
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.490625448790546
DONE TAKING  40  STEPS.
Total reward:  -683.8570365498647
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.210690104931466
DONE TAKING  40  STEPS.
Total reward:  -436.0026985811567
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.07845925770459
DONE TAKING  40  STEPS.
Total reward:  -180.41568568665727
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -9.53392031590931
DONE TAKING  40  STEPS.
Total reward:  -310.60336949504676
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.36557867087263
DONE TAKING  40  STEPS.
Total reward:  -374.88820350643294
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.188775560710113
DONE TAKING  40  STEPS.
Total reward:  -638.1639599239076
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.699316960263467
DONE TAKING  40  STEPS.
Total reward:  -376.24763886593473
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.954489086190172
DONE TAKING  40  STEPS.
Total reward:  87.63720221063272
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.54407331171887
DONE TAKING  40  STEPS.
Total reward:  -166.53591261508325
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.81667134633374
DONE TAKING  40  STEPS.
Total reward:  -64.19894720158422
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.37481862458906
DONE TAKING  40  STEPS.
Total reward:  -652.7008546402461
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -12.703531259581364
DONE TAKING  40  STEPS.
Total reward:  141.40155830891572
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.60796671408859
DONE TAKING  40  STEPS.
Total reward:  -704.0360442422144
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.070945847298404
DONE TAKING  40  STEPS.
Total reward:  -602.5648218645695
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.803119422574536
DONE TAKING  40  STEPS.
Total reward:  -400.1595243949133
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.992782731096018
DONE TAKING  40  STEPS.
Total reward:  -1072.7070742780925
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.803045297608698
DONE TAKING  40  STEPS.
Total reward:  -596.3167540480243
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.929635634471895
DONE TAKING  40  STEPS.
Total reward:  -348.8317356382343
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.456049979491972
DONE TAKING  40  STEPS.
Total reward:  -588.3455901277288
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.866469080112516
DONE TAKING  40  STEPS.
Total reward:  -358.3165965687274
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.507132868541575
DONE TAKING  40  STEPS.
Total reward:  -71.57527621940721
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.144192902775735
DONE TAKING  40  STEPS.
Total reward:  -491.72238990598987
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.650875552179226
DONE TAKING  40  STEPS.
Total reward:  -738.2655223713057
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.28061049526146
DONE TAKING  40  STEPS.
Total reward:  -1009.3219085834452
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.690508155139717
DONE TAKING  40  STEPS.
Total reward:  -193.59962884503318
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.25666166264431
DONE TAKING  40  STEPS.
Total reward:  -657.4532241220239
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -15.934102304930924
DONE TAKING  40  STEPS.
Total reward:  -378.6565799022786
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.59706668731628
DONE TAKING  40  STEPS.
Total reward:  -183.80552230194306
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.57308189399201
DONE TAKING  40  STEPS.
Total reward:  -1101.967353011275
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.34147845887847
DONE TAKING  40  STEPS.
Total reward:  -559.635898983763
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -31.14934663137864
DONE TAKING  40  STEPS.
Total reward:  -735.8445526815855
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -17.689644325620108
DONE TAKING  40  STEPS.
Total reward:  -51.50259849976929
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.985366022581104
DONE TAKING  40  STEPS.
Total reward:  -44.272229168144605
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.24229242600863
DONE TAKING  40  STEPS.
Total reward:  -286.4258161576095
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.93868299813288
DONE TAKING  40  STEPS.
Total reward:  -197.0074393029091
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.990318111275748
DONE TAKING  40  STEPS.
Total reward:  -873.1228783292128
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.451767325194368
DONE TAKING  40  STEPS.
Total reward:  -469.7396395362869
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.8754097720622
DONE TAKING  40  STEPS.
Total reward:  -322.6949623822188
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter40.ckpt

#####################################
Training the dynamics model..... iteration  41
#####################################

    amount of random data:  8000
    amount of onPol data:  60516
Prob rand:  15795
On pol:  59040
Prob shape:  (74835,)

=== Epoch 0 ===
    train loss:  0.40161773501193687
    val rand:  0.41965049505233765
    val onPol:  0.3011630065739155

=== Epoch 10 ===
    train loss:  0.2119081300007154
    val rand:  0.20560681819915771
    val onPol:  0.2509877644479275

=== Epoch 20 ===
    train loss:  0.17325397642099694
    val rand:  0.17647850513458252
    val onPol:  0.25317822272578877

=== Epoch 30 ===
    train loss:  0.14593247262990638
    val rand:  0.16950473189353943
    val onPol:  0.2612988104422887

=== Epoch 39 ===
    train loss:  0.12875551235390037
    val rand:  0.1670842468738556
    val onPol:  0.2697386567791303
Training duration: 37.90 s

#####################################
performing on-policy MPC rollouts... iter  41
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.93662021865323
DONE TAKING  40  STEPS.
Total reward:  -863.0788396003853
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.274866550454867
DONE TAKING  40  STEPS.
Total reward:  -388.5949694507414
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.42974440400362
DONE TAKING  40  STEPS.
Total reward:  -827.169198207406
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.270074242952237
DONE TAKING  40  STEPS.
Total reward:  -666.1712073699638
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.40315947982058
DONE TAKING  40  STEPS.
Total reward:  -515.844374840524
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.38660382876969
DONE TAKING  40  STEPS.
Total reward:  -254.76216876508568
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.14904616278235
DONE TAKING  40  STEPS.
Total reward:  -578.6269496215691
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.553922843058523
DONE TAKING  40  STEPS.
Total reward:  -776.5046324807533
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -11.138537781052314
DONE TAKING  40  STEPS.
Total reward:  96.26405795303495
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.86894890060175
DONE TAKING  40  STEPS.
Total reward:  -794.9674800480495
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.872549822466418
DONE TAKING  40  STEPS.
Total reward:  -538.9603191933797
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.370067433819152
DONE TAKING  40  STEPS.
Total reward:  -721.5663941092445
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.98617674164492
DONE TAKING  40  STEPS.
Total reward:  -244.9924974205207
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.009114660939073
DONE TAKING  40  STEPS.
Total reward:  -410.4414798379832
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.264818738180825
DONE TAKING  40  STEPS.
Total reward:  -15.06934923804938
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.280685796983793
DONE TAKING  40  STEPS.
Total reward:  -563.3459390853103
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.13906803994631
DONE TAKING  40  STEPS.
Total reward:  -603.3009767958754
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.67253539416904
DONE TAKING  40  STEPS.
Total reward:  -471.50035655224275
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.671965483396665
DONE TAKING  40  STEPS.
Total reward:  -518.3194126079576
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.973634961789937
DONE TAKING  40  STEPS.
Total reward:  -48.70937225661439
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.771644446476746
DONE TAKING  40  STEPS.
Total reward:  -864.749714311042
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.139492383542425
DONE TAKING  40  STEPS.
Total reward:  -249.9868524474855
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -15.471521538186334
DONE TAKING  40  STEPS.
Total reward:  -193.98263585018387
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.327732929423355
DONE TAKING  40  STEPS.
Total reward:  -545.9149192966746
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.716216513148275
DONE TAKING  40  STEPS.
Total reward:  -353.0832505284802
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.500420343548555
DONE TAKING  40  STEPS.
Total reward:  253.69949593790116
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.560575493442165
DONE TAKING  40  STEPS.
Total reward:  -800.9510856794706
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -30.850821371547717
DONE TAKING  40  STEPS.
Total reward:  -698.0482890308924
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -10.823258168238713
DONE TAKING  40  STEPS.
Total reward:  -320.3532013499602
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.11664536384525
DONE TAKING  40  STEPS.
Total reward:  -331.27045256822
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.38129872237147
DONE TAKING  40  STEPS.
Total reward:  -892.3648247227048
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.75520151417022
DONE TAKING  40  STEPS.
Total reward:  -466.24191081208323
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.75044857156383
DONE TAKING  40  STEPS.
Total reward:  -404.6917909028636
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -18.58668985068838
DONE TAKING  40  STEPS.
Total reward:  -384.2636423212043
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.699770988368673
DONE TAKING  40  STEPS.
Total reward:  -598.6574412229704
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.04955455611404
DONE TAKING  40  STEPS.
Total reward:  -619.449676037278
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.88820286595422
DONE TAKING  40  STEPS.
Total reward:  -671.7255840429543
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.564494184537118
DONE TAKING  40  STEPS.
Total reward:  -648.8525081707525
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.0591560549592
DONE TAKING  40  STEPS.
Total reward:  -414.5261774236543
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.879419503739882
DONE TAKING  40  STEPS.
Total reward:  -267.8097488577336
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter41.ckpt

#####################################
Training the dynamics model..... iteration  42
#####################################

    amount of random data:  8000
    amount of onPol data:  61992
Prob rand:  15990
On pol:  60480
Prob shape:  (76470,)

=== Epoch 0 ===
    train loss:  0.3973625690344996
    val rand:  0.41873738169670105
    val onPol:  0.30637834622309756

=== Epoch 10 ===
    train loss:  0.20902836452794554
    val rand:  0.19915509223937988
    val onPol:  0.25372298520344955

=== Epoch 20 ===
    train loss:  0.16849715977707166
    val rand:  0.1755557656288147
    val onPol:  0.25616801702059233

=== Epoch 30 ===
    train loss:  0.14328021251115222
    val rand:  0.16565559804439545
    val onPol:  0.26543161960748524

=== Epoch 39 ===
    train loss:  0.1256677062319429
    val rand:  0.16516044735908508
    val onPol:  0.27322199367559874
Training duration: 38.81 s

#####################################
performing on-policy MPC rollouts... iter  42
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.611248308741075
DONE TAKING  40  STEPS.
Total reward:  75.1826910338448
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.259428951985967
DONE TAKING  40  STEPS.
Total reward:  -584.9937541402859
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.561630787242734
DONE TAKING  40  STEPS.
Total reward:  -729.0358435215901
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.331574610132044
DONE TAKING  40  STEPS.
Total reward:  -525.8166692740145
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.645941438615008
DONE TAKING  40  STEPS.
Total reward:  -10.293740521237002
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.56610558345475
DONE TAKING  40  STEPS.
Total reward:  -424.04743796518596
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.586706542173278
DONE TAKING  40  STEPS.
Total reward:  -661.4056948789716
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.004497563110814
DONE TAKING  40  STEPS.
Total reward:  -721.8022469041191
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.041646832292102
DONE TAKING  40  STEPS.
Total reward:  -931.95835092621
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.074762761921424
DONE TAKING  40  STEPS.
Total reward:  -923.901643894409
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.932826845777615
DONE TAKING  40  STEPS.
Total reward:  -502.53401510711495
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.187887177239208
DONE TAKING  40  STEPS.
Total reward:  -165.3979470826174
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.774227500555167
DONE TAKING  40  STEPS.
Total reward:  -26.593545233932222
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.757890170889837
DONE TAKING  40  STEPS.
Total reward:  82.34918278177001
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -21.94282779074271
DONE TAKING  40  STEPS.
Total reward:  360.4580251584996
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.134204437881976
DONE TAKING  40  STEPS.
Total reward:  -153.92600494506434
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.577868901163125
DONE TAKING  40  STEPS.
Total reward:  -858.0157987459669
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.254683074678127
DONE TAKING  40  STEPS.
Total reward:  -454.4423615646753
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.95429750579793
DONE TAKING  40  STEPS.
Total reward:  -398.963033577663
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.216410958511744
DONE TAKING  40  STEPS.
Total reward:  -1003.1894461381725
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.504294860830385
DONE TAKING  40  STEPS.
Total reward:  -346.7977838554504
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.824854809258632
DONE TAKING  40  STEPS.
Total reward:  -482.44764738970844
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.36477780876087
DONE TAKING  40  STEPS.
Total reward:  -236.37066448467152
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.165484976528433
DONE TAKING  40  STEPS.
Total reward:  -345.57774304327313
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.189126972675957
DONE TAKING  40  STEPS.
Total reward:  -554.7049900747118
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.51215384205245
DONE TAKING  40  STEPS.
Total reward:  -211.20493087503223
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -13.214559335923406
DONE TAKING  40  STEPS.
Total reward:  -433.9561169987977
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.130130326218357
DONE TAKING  40  STEPS.
Total reward:  212.12520183464105
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.72045367806865
DONE TAKING  40  STEPS.
Total reward:  -1007.0613963036973
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.738396628332247
DONE TAKING  40  STEPS.
Total reward:  -531.1909543838707
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.503758612609875
DONE TAKING  40  STEPS.
Total reward:  -444.8277998754869
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.031697393152726
DONE TAKING  40  STEPS.
Total reward:  -495.0929394266127
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.518942203341673
DONE TAKING  40  STEPS.
Total reward:  -284.7002603884704
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.768456562298113
DONE TAKING  40  STEPS.
Total reward:  -788.8765146939156
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -18.594528875134948
DONE TAKING  40  STEPS.
Total reward:  -303.2785324264195
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.45023690792238
DONE TAKING  40  STEPS.
Total reward:  -248.93214255465796
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.71703899421221
DONE TAKING  40  STEPS.
Total reward:  119.19374568525464
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -13.457273444391681
DONE TAKING  40  STEPS.
Total reward:  -418.55910640797197
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.769038558796996
DONE TAKING  40  STEPS.
Total reward:  -380.6819826774479
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -31.297799396286376
DONE TAKING  40  STEPS.
Total reward:  -467.6699247311745
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter42.ckpt

#####################################
Training the dynamics model..... iteration  43
#####################################

    amount of random data:  8000
    amount of onPol data:  63468
Prob rand:  16185
On pol:  61920
Prob shape:  (78105,)

=== Epoch 0 ===
    train loss:  0.3967056307745607
    val rand:  0.40546914935112
    val onPol:  0.3023675473836752

=== Epoch 10 ===
    train loss:  0.20901448769788994
    val rand:  0.20109450817108154
    val onPol:  0.250328378035472

=== Epoch 20 ===
    train loss:  0.16985079155940758
    val rand:  0.1717659831047058
    val onPol:  0.2520889433530661

=== Epoch 30 ===
    train loss:  0.14397404754632398
    val rand:  0.16620658338069916
    val onPol:  0.2619195110522784

=== Epoch 39 ===
    train loss:  0.12761267392258896
    val rand:  0.16197466850280762
    val onPol:  0.270938896215879
Training duration: 39.27 s

#####################################
performing on-policy MPC rollouts... iter  43
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.14281251740894
DONE TAKING  40  STEPS.
Total reward:  -359.56769245287677
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -15.035593128785571
DONE TAKING  40  STEPS.
Total reward:  -403.6569133954319
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.064571878145816
DONE TAKING  40  STEPS.
Total reward:  -138.6577179819941
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.39845655446593
DONE TAKING  40  STEPS.
Total reward:  -709.0946825709667
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -14.88654427194855
DONE TAKING  40  STEPS.
Total reward:  -512.0502838299295
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.26266077767508
DONE TAKING  40  STEPS.
Total reward:  -332.7889882815233
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.883711944960197
DONE TAKING  40  STEPS.
Total reward:  -344.02159344279363
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.459425819035072
DONE TAKING  40  STEPS.
Total reward:  -352.8510214892576
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.458179844681982
DONE TAKING  40  STEPS.
Total reward:  -338.34571980033957
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.64778239274519
DONE TAKING  40  STEPS.
Total reward:  95.73923411076433
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.49932615672112
DONE TAKING  40  STEPS.
Total reward:  -836.3696124908157
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -12.853259260868231
DONE TAKING  40  STEPS.
Total reward:  -387.03253797579174
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -29.320518017931843
DONE TAKING  40  STEPS.
Total reward:  -916.9079305188235
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.949730598277146
DONE TAKING  40  STEPS.
Total reward:  -360.7101251176399
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -20.865663052829852
DONE TAKING  40  STEPS.
Total reward:  -16.529032684214783
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.50657515822448
DONE TAKING  40  STEPS.
Total reward:  -607.0672146617846
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -12.97494962380066
DONE TAKING  40  STEPS.
Total reward:  205.02599113375342
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.995536018228634
DONE TAKING  40  STEPS.
Total reward:  -9.975297059869
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.31986982822942
DONE TAKING  40  STEPS.
Total reward:  -444.3095144056885
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.995995544424208
DONE TAKING  40  STEPS.
Total reward:  -511.5775578312722
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.72106001218927
DONE TAKING  40  STEPS.
Total reward:  -142.3249178777665
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.028248628472834
DONE TAKING  40  STEPS.
Total reward:  -290.9565861048053
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.283459704456412
DONE TAKING  40  STEPS.
Total reward:  -367.57318832441
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.385338993449256
DONE TAKING  40  STEPS.
Total reward:  -729.5494466286639
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.034307018962306
DONE TAKING  40  STEPS.
Total reward:  -410.2756313613291
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.875576927565476
DONE TAKING  40  STEPS.
Total reward:  -231.7344309068897
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -12.190860568758701
DONE TAKING  40  STEPS.
Total reward:  -294.14286719124607
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.524015688837952
DONE TAKING  40  STEPS.
Total reward:  -412.90610743506403
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.603019873953563
DONE TAKING  40  STEPS.
Total reward:  -452.35404389184555
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.70345632186269
DONE TAKING  40  STEPS.
Total reward:  79.96564633007092
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.03787066887452
DONE TAKING  40  STEPS.
Total reward:  -168.11169607545213
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.82770204552987
DONE TAKING  40  STEPS.
Total reward:  -896.708179713725
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.488560014836143
DONE TAKING  40  STEPS.
Total reward:  -404.43316131047806
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.48596741122428
DONE TAKING  40  STEPS.
Total reward:  -1.929638754273057
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.99114048002216
DONE TAKING  40  STEPS.
Total reward:  -735.2135597187149
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.74824392255716
DONE TAKING  40  STEPS.
Total reward:  -1022.5910314473284
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.67489438474319
DONE TAKING  40  STEPS.
Total reward:  173.62934262362072
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -16.96281575691272
DONE TAKING  40  STEPS.
Total reward:  -426.04022156116946
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.53381732909515
DONE TAKING  40  STEPS.
Total reward:  -171.66219296001276
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.85588375786822
DONE TAKING  40  STEPS.
Total reward:  106.08539312209928
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter43.ckpt

#####################################
Training the dynamics model..... iteration  44
#####################################

    amount of random data:  8000
    amount of onPol data:  64944
Prob rand:  16380
On pol:  63360
Prob shape:  (79740,)

=== Epoch 0 ===
    train loss:  0.3933337984546538
    val rand:  0.40668177604675293
    val onPol:  0.30054425734740037

=== Epoch 10 ===
    train loss:  0.20907901121724037
    val rand:  0.20688021183013916
    val onPol:  0.24675374993911156

=== Epoch 20 ===
    train loss:  0.1691803862010279
    val rand:  0.16901054978370667
    val onPol:  0.2486824748607782

=== Epoch 30 ===
    train loss:  0.14278218352025554
    val rand:  0.1630094051361084
    val onPol:  0.25807055830955505

=== Epoch 39 ===
    train loss:  0.12690369087842204
    val rand:  0.16588911414146423
    val onPol:  0.26606478140904355
Training duration: 39.87 s

#####################################
performing on-policy MPC rollouts... iter  44
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.616319519334496
DONE TAKING  40  STEPS.
Total reward:  -291.9786835699756
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.53252991185522
DONE TAKING  40  STEPS.
Total reward:  -408.6278520220938
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.7681080340189
DONE TAKING  40  STEPS.
Total reward:  -772.4480728593976
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.53826816338245
DONE TAKING  40  STEPS.
Total reward:  -40.66128832636659
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.993034509110707
DONE TAKING  40  STEPS.
Total reward:  -109.22937049731034
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -15.895449927638905
DONE TAKING  40  STEPS.
Total reward:  -517.1377942405528
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.673797571913234
DONE TAKING  40  STEPS.
Total reward:  -538.1583601941527
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.10204996931432
DONE TAKING  40  STEPS.
Total reward:  -654.0288754481811
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.327310463627363
DONE TAKING  40  STEPS.
Total reward:  -541.3821990975894
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.065135491922998
DONE TAKING  40  STEPS.
Total reward:  -997.23199739701
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.04069905397566
DONE TAKING  40  STEPS.
Total reward:  -305.0550920119201
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.573940460569112
DONE TAKING  40  STEPS.
Total reward:  149.6309264590114
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.740654037485243
DONE TAKING  40  STEPS.
Total reward:  -429.2700916503121
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.22284410202363
DONE TAKING  40  STEPS.
Total reward:  -871.2573414727137
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.729180310947363
DONE TAKING  40  STEPS.
Total reward:  -726.2359617292266
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.449879292623717
DONE TAKING  40  STEPS.
Total reward:  -357.2485396192155
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.882523244505293
DONE TAKING  40  STEPS.
Total reward:  189.57961310193568
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.659086462642616
DONE TAKING  40  STEPS.
Total reward:  -331.0037724542481
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.702932113352407
DONE TAKING  40  STEPS.
Total reward:  -285.0722647117427
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.121503058651975
DONE TAKING  40  STEPS.
Total reward:  -422.26688877334
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.283428988952647
DONE TAKING  40  STEPS.
Total reward:  -718.3287157487764
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.52209642324498
DONE TAKING  40  STEPS.
Total reward:  -582.7057583784423
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.66216582156574
DONE TAKING  40  STEPS.
Total reward:  -571.7619223211362
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.016884749338573
DONE TAKING  40  STEPS.
Total reward:  -755.0971506481818
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.759943225660734
DONE TAKING  40  STEPS.
Total reward:  40.85619740383924
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -11.234355229484297
DONE TAKING  40  STEPS.
Total reward:  557.0617522226663
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -24.592474103349645
DONE TAKING  40  STEPS.
Total reward:  -661.0475184488054
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.820252074952585
DONE TAKING  40  STEPS.
Total reward:  -588.034054409406
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.432352381163124
DONE TAKING  40  STEPS.
Total reward:  -330.0062343943792
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.916695280140534
DONE TAKING  40  STEPS.
Total reward:  -465.11482680676744
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.192230077378298
DONE TAKING  40  STEPS.
Total reward:  -633.670750191164
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -10.04644899110479
DONE TAKING  40  STEPS.
Total reward:  -285.065082506422
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -10.971150434905393
DONE TAKING  40  STEPS.
Total reward:  -140.5046591225116
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.34159661860171
DONE TAKING  40  STEPS.
Total reward:  -388.7151682861808
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -31.27132198842915
DONE TAKING  40  STEPS.
Total reward:  -262.77251231074064
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.651696895974382
DONE TAKING  40  STEPS.
Total reward:  -438.6471015555095
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.236697304833477
DONE TAKING  40  STEPS.
Total reward:  -824.6905544346777
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -13.195426197638248
DONE TAKING  40  STEPS.
Total reward:  -428.997942928064
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.490351886934945
DONE TAKING  40  STEPS.
Total reward:  -311.87174943651246
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.930185097389675
DONE TAKING  40  STEPS.
Total reward:  -479.9015332268383
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter44.ckpt

#####################################
Training the dynamics model..... iteration  45
#####################################

    amount of random data:  8000
    amount of onPol data:  66420
Prob rand:  16575
On pol:  64800
Prob shape:  (81375,)

=== Epoch 0 ===
    train loss:  0.39647517400451854
    val rand:  0.40123701095581055
    val onPol:  0.30594541345323834

=== Epoch 10 ===
    train loss:  0.208974603799325
    val rand:  0.211549311876297
    val onPol:  0.2537610051887376

=== Epoch 20 ===
    train loss:  0.17040570881925052
    val rand:  0.1755484789609909
    val onPol:  0.2553498808826719

=== Epoch 30 ===
    train loss:  0.14481836057539227
    val rand:  0.16732458770275116
    val onPol:  0.2633241947208132

=== Epoch 39 ===
    train loss:  0.12781910310629047
    val rand:  0.1686583012342453
    val onPol:  0.2735647239855358
Training duration: 40.85 s

#####################################
performing on-policy MPC rollouts... iter  45
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.378319666638756
DONE TAKING  40  STEPS.
Total reward:  -512.1006805399053
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.714437937607583
DONE TAKING  40  STEPS.
Total reward:  -422.23908331464196
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.474265583696983
DONE TAKING  40  STEPS.
Total reward:  -414.12604469971893
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.605720518008187
DONE TAKING  40  STEPS.
Total reward:  -571.3679205225548
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.947155483966327
DONE TAKING  40  STEPS.
Total reward:  -520.2976021676246
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.685873597122182
DONE TAKING  40  STEPS.
Total reward:  -647.6906780625045
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.670181043739987
DONE TAKING  40  STEPS.
Total reward:  -303.49904801239114
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.409301164537588
DONE TAKING  40  STEPS.
Total reward:  -329.0239443431105
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.280198534322544
DONE TAKING  40  STEPS.
Total reward:  -557.4958423623114
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -11.75027951977027
DONE TAKING  40  STEPS.
Total reward:  -275.7972906460445
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.777771593535682
DONE TAKING  40  STEPS.
Total reward:  -383.1840164075024
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.164163687585738
DONE TAKING  40  STEPS.
Total reward:  -423.1342655758504
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.630823978590335
DONE TAKING  40  STEPS.
Total reward:  -376.4265363862201
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -19.656030481272673
DONE TAKING  40  STEPS.
Total reward:  -309.5782620093895
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.713514949486452
DONE TAKING  40  STEPS.
Total reward:  -502.4961885483488
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.585349148270705
DONE TAKING  40  STEPS.
Total reward:  96.76198384693231
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.971720408550823
DONE TAKING  40  STEPS.
Total reward:  -380.35944477431224
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.520887802333483
DONE TAKING  40  STEPS.
Total reward:  -341.31408957392085
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.513180852630473
DONE TAKING  40  STEPS.
Total reward:  -723.894991244113
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.56993242062165
DONE TAKING  40  STEPS.
Total reward:  -147.44821383208009
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.71185037514236
DONE TAKING  40  STEPS.
Total reward:  -217.14164821579763
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -31.361025373593456
DONE TAKING  40  STEPS.
Total reward:  -771.7263811415355
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.049890147496466
DONE TAKING  40  STEPS.
Total reward:  -547.840908735974
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -31.247456094342425
DONE TAKING  40  STEPS.
Total reward:  -932.5649072756098
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.933038426519488
DONE TAKING  40  STEPS.
Total reward:  -482.6371432266473
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.255460458462153
DONE TAKING  40  STEPS.
Total reward:  8.672352949652645
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.05639880392175
DONE TAKING  40  STEPS.
Total reward:  -673.934000389743
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.17942893379328
DONE TAKING  40  STEPS.
Total reward:  -748.3383574815176
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -12.574249455825843
DONE TAKING  40  STEPS.
Total reward:  -267.67444269222
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.281180352065647
DONE TAKING  40  STEPS.
Total reward:  -492.1807455510283
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.864802591597357
DONE TAKING  40  STEPS.
Total reward:  -692.4818778742651
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.407579088482002
DONE TAKING  40  STEPS.
Total reward:  -655.5869056214237
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -18.347616006637946
DONE TAKING  40  STEPS.
Total reward:  -591.7872098672722
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.08686216098873
DONE TAKING  40  STEPS.
Total reward:  -353.69126329445453
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -15.268737247637404
DONE TAKING  40  STEPS.
Total reward:  -460.9775115861449
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.405400928120137
DONE TAKING  40  STEPS.
Total reward:  -846.8624450658529
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.84453219350995
DONE TAKING  40  STEPS.
Total reward:  157.34242259166524
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.271258941064755
DONE TAKING  40  STEPS.
Total reward:  -118.96325743502966
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.530058825426345
DONE TAKING  40  STEPS.
Total reward:  -908.8819576443333
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.031073192891835
DONE TAKING  40  STEPS.
Total reward:  -37.09783752531958
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter45.ckpt

#####################################
Training the dynamics model..... iteration  46
#####################################

    amount of random data:  8000
    amount of onPol data:  67896
Prob rand:  16770
On pol:  66240
Prob shape:  (83010,)

=== Epoch 0 ===
    train loss:  0.4017174678084291
    val rand:  0.4179992079734802
    val onPol:  0.3052938665662493

=== Epoch 10 ===
    train loss:  0.21243235367683716
    val rand:  0.20905135571956635
    val onPol:  0.2513341094766344

=== Epoch 20 ===
    train loss:  0.17528631372584236
    val rand:  0.1759319007396698
    val onPol:  0.2522319182753563

=== Epoch 30 ===
    train loss:  0.15165383285946316
    val rand:  0.1703704297542572
    val onPol:  0.2614257995571409

=== Epoch 39 ===
    train loss:  0.13502560509943667
    val rand:  0.16783437132835388
    val onPol:  0.27205960771867205
Training duration: 40.88 s

#####################################
performing on-policy MPC rollouts... iter  46
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.941387909436397
DONE TAKING  40  STEPS.
Total reward:  -539.2603252941016
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.000587169744332
DONE TAKING  40  STEPS.
Total reward:  -79.90206296527762
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.72542604177944
DONE TAKING  40  STEPS.
Total reward:  -919.1344543796746
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.35896506759268
DONE TAKING  40  STEPS.
Total reward:  76.89040867022418
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.833351454866865
DONE TAKING  40  STEPS.
Total reward:  -652.147359523405
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.083984782882997
DONE TAKING  40  STEPS.
Total reward:  -916.8244283433097
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.420094624124403
DONE TAKING  40  STEPS.
Total reward:  -589.8053443439712
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.24354481292689
DONE TAKING  40  STEPS.
Total reward:  -587.8900153883333
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.106396742244335
DONE TAKING  40  STEPS.
Total reward:  -180.4789928450466
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.97769620047777
DONE TAKING  40  STEPS.
Total reward:  -927.8980232272426
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.537894430699247
DONE TAKING  40  STEPS.
Total reward:  -558.2375436533589
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.55632655218557
DONE TAKING  40  STEPS.
Total reward:  -360.7104700112045
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.23696246024073
DONE TAKING  40  STEPS.
Total reward:  -917.9620661461731
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.928268644780445
DONE TAKING  40  STEPS.
Total reward:  -283.2043616439442
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.871447222279762
DONE TAKING  40  STEPS.
Total reward:  -828.5253189293275
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.20497233519484
DONE TAKING  40  STEPS.
Total reward:  -28.52161954013673
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.171791326109716
DONE TAKING  40  STEPS.
Total reward:  -123.89992329614415
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.673696577902273
DONE TAKING  40  STEPS.
Total reward:  -257.95552045693694
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.146270731853523
DONE TAKING  40  STEPS.
Total reward:  -378.79021472559884
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.250654250694932
DONE TAKING  40  STEPS.
Total reward:  -280.8961238521006
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.574675594275913
DONE TAKING  40  STEPS.
Total reward:  111.01686903228793
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -17.36816997458542
DONE TAKING  40  STEPS.
Total reward:  -393.7786094119321
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.86080377465037
DONE TAKING  40  STEPS.
Total reward:  -604.7179650794045
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.374495033424143
DONE TAKING  40  STEPS.
Total reward:  -442.128679745641
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -26.709737916380348
DONE TAKING  40  STEPS.
Total reward:  -466.3203836715463
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.740049527004231
DONE TAKING  40  STEPS.
Total reward:  -467.28386411258344
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -22.715115768151257
DONE TAKING  40  STEPS.
Total reward:  -297.2069043803777
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.84726527986745
DONE TAKING  40  STEPS.
Total reward:  -250.1470015005437
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.912263814566124
DONE TAKING  40  STEPS.
Total reward:  -185.05790259816408
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.50958410425452
DONE TAKING  40  STEPS.
Total reward:  -938.6503592743705
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.99721259050864
DONE TAKING  40  STEPS.
Total reward:  -527.769248577588
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.543085605761043
DONE TAKING  40  STEPS.
Total reward:  -459.83325271712766
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.095712199406385
DONE TAKING  40  STEPS.
Total reward:  -160.0892335747747
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.16768917324673
DONE TAKING  40  STEPS.
Total reward:  -910.944288008837
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.41648355649246
DONE TAKING  40  STEPS.
Total reward:  -622.4403235535565
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.245113059182046
DONE TAKING  40  STEPS.
Total reward:  -694.0062781391364
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -22.551555046726076
DONE TAKING  40  STEPS.
Total reward:  -423.3894290952029
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.534415608750233
DONE TAKING  40  STEPS.
Total reward:  -410.610832501634
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.964707301736674
DONE TAKING  40  STEPS.
Total reward:  -484.0849033409006
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.50526123703543
DONE TAKING  40  STEPS.
Total reward:  -649.864294049473
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter46.ckpt

#####################################
Training the dynamics model..... iteration  47
#####################################

    amount of random data:  8000
    amount of onPol data:  69372
Prob rand:  16965
On pol:  67680
Prob shape:  (84645,)

=== Epoch 0 ===
    train loss:  0.3988619975971453
    val rand:  0.4227117896080017
    val onPol:  0.30522353095667704

=== Epoch 10 ===
    train loss:  0.21420345369613533
    val rand:  0.20446884632110596
    val onPol:  0.24988011802945817

=== Epoch 20 ===
    train loss:  0.17713884909947714
    val rand:  0.17373816668987274
    val onPol:  0.25221181341579985

=== Epoch 30 ===
    train loss:  0.15319216260404298
    val rand:  0.16925553977489471
    val onPol:  0.26021110798631397

=== Epoch 39 ===
    train loss:  0.13674103811834798
    val rand:  0.16516128182411194
    val onPol:  0.2667753653866904
Training duration: 41.70 s

#####################################
performing on-policy MPC rollouts... iter  47
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.565158386258393
DONE TAKING  40  STEPS.
Total reward:  -718.4100332759119
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -28.82062729239611
DONE TAKING  40  STEPS.
Total reward:  -734.5705466855641
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -16.22517284936031
DONE TAKING  40  STEPS.
Total reward:  246.63352927630388
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -15.150902539851982
DONE TAKING  40  STEPS.
Total reward:  14.649554104691857
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -12.821013852972845
DONE TAKING  40  STEPS.
Total reward:  -79.75788331453325
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -31.134430763633357
DONE TAKING  40  STEPS.
Total reward:  -697.9355853779821
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.70814328854894
DONE TAKING  40  STEPS.
Total reward:  -476.8449455434663
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.828297332706924
DONE TAKING  40  STEPS.
Total reward:  77.39415860302357
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.608823030509647
DONE TAKING  40  STEPS.
Total reward:  -665.2653287814934
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.78803774682673
DONE TAKING  40  STEPS.
Total reward:  384.68081698143976
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.482673733978704
DONE TAKING  40  STEPS.
Total reward:  57.08398742140413
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.197482445296338
DONE TAKING  40  STEPS.
Total reward:  -274.99217262005646
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.127139026379677
DONE TAKING  40  STEPS.
Total reward:  229.18331030967434
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.45822482513711
DONE TAKING  40  STEPS.
Total reward:  -33.07207278143775
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.81616774785323
DONE TAKING  40  STEPS.
Total reward:  -551.0921213810161
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.870195885425694
DONE TAKING  40  STEPS.
Total reward:  222.2361404384965
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.630825662346602
DONE TAKING  40  STEPS.
Total reward:  -238.58435378567233
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.580901541998344
DONE TAKING  40  STEPS.
Total reward:  -640.699215748585
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.062921028299797
DONE TAKING  40  STEPS.
Total reward:  225.28423309166874
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.526449195064064
DONE TAKING  40  STEPS.
Total reward:  -294.28985584464294
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -12.895873908941295
DONE TAKING  40  STEPS.
Total reward:  251.44863680073027
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.191207918716632
DONE TAKING  40  STEPS.
Total reward:  -776.9617049255419
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.74990541079264
DONE TAKING  40  STEPS.
Total reward:  -281.75718867351804
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.071868794588898
DONE TAKING  40  STEPS.
Total reward:  -530.144068892453
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.209478223511468
DONE TAKING  40  STEPS.
Total reward:  -106.07921870416267
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.124345371099366
DONE TAKING  40  STEPS.
Total reward:  -825.4463958748703
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -19.41892610682015
DONE TAKING  40  STEPS.
Total reward:  -337.4575958488798
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.31922019709078
DONE TAKING  40  STEPS.
Total reward:  -641.1054266165014
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -15.673266619831098
DONE TAKING  40  STEPS.
Total reward:  -128.0533666952239
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.543371788769967
DONE TAKING  40  STEPS.
Total reward:  -608.2867720466735
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.543134078436307
DONE TAKING  40  STEPS.
Total reward:  -94.86030757883749
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.38085415388029
DONE TAKING  40  STEPS.
Total reward:  29.331298880803438
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -9.984384146645287
DONE TAKING  40  STEPS.
Total reward:  345.86357723447907
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.557145960688715
DONE TAKING  40  STEPS.
Total reward:  -559.6747528766963
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.23209860512962
DONE TAKING  40  STEPS.
Total reward:  -406.5436000076575
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.143884298804657
DONE TAKING  40  STEPS.
Total reward:  -24.47086415669588
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -15.552696416264416
DONE TAKING  40  STEPS.
Total reward:  141.97021626302924
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.040652562345148
DONE TAKING  40  STEPS.
Total reward:  -686.6463566377297
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.553210106322013
DONE TAKING  40  STEPS.
Total reward:  -880.6093348928703
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.11558464514425
DONE TAKING  40  STEPS.
Total reward:  -147.2707533610126
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter47.ckpt

#####################################
Training the dynamics model..... iteration  48
#####################################

    amount of random data:  8000
    amount of onPol data:  70848
Prob rand:  17160
On pol:  69120
Prob shape:  (86280,)

=== Epoch 0 ===
    train loss:  0.39878764163170544
    val rand:  0.4048440456390381
    val onPol:  0.30494384169578553

=== Epoch 10 ===
    train loss:  0.21636052598201094
    val rand:  0.21482810378074646
    val onPol:  0.2505138486623764

=== Epoch 20 ===
    train loss:  0.17936029462587266
    val rand:  0.17852139472961426
    val onPol:  0.251325332125028

=== Epoch 30 ===
    train loss:  0.15496091766371614
    val rand:  0.17107737064361572
    val onPol:  0.25836073656876885

=== Epoch 39 ===
    train loss:  0.13821928580069825
    val rand:  0.16475515067577362
    val onPol:  0.2658371180295944
Training duration: 42.72 s

#####################################
performing on-policy MPC rollouts... iter  48
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.0875382673302
DONE TAKING  40  STEPS.
Total reward:  -653.8379136185174
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.220208152935353
DONE TAKING  40  STEPS.
Total reward:  -793.5396493236386
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.32123272451707
DONE TAKING  40  STEPS.
Total reward:  -552.9071745541946
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.435710061186406
DONE TAKING  40  STEPS.
Total reward:  79.10729975304807
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.18260092429941
DONE TAKING  40  STEPS.
Total reward:  110.46479630889012
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.634667627389092
DONE TAKING  40  STEPS.
Total reward:  119.51134025319686
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.637877155388217
DONE TAKING  40  STEPS.
Total reward:  -245.93835674807062
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -14.397919858483291
DONE TAKING  40  STEPS.
Total reward:  -46.48805626689614
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.142349269660766
DONE TAKING  40  STEPS.
Total reward:  -544.1547461930049
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.53309310571293
DONE TAKING  40  STEPS.
Total reward:  -514.7174596457738
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.95356936360591
DONE TAKING  40  STEPS.
Total reward:  -902.2756736817352
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.27995587716839
DONE TAKING  40  STEPS.
Total reward:  42.98105168932809
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.948393565689535
DONE TAKING  40  STEPS.
Total reward:  -586.2599690207613
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.952872960165852
DONE TAKING  40  STEPS.
Total reward:  -698.6864835078677
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.784624060720894
DONE TAKING  40  STEPS.
Total reward:  -161.2168645339197
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.396410414125178
DONE TAKING  40  STEPS.
Total reward:  -750.5485870345135
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.558778958480588
DONE TAKING  40  STEPS.
Total reward:  -822.932412123906
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -22.610238485242252
DONE TAKING  40  STEPS.
Total reward:  348.18447228652684
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.303924372188085
DONE TAKING  40  STEPS.
Total reward:  -508.81757231679615
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.174164842105807
DONE TAKING  40  STEPS.
Total reward:  -611.666670693931
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.664717321701985
DONE TAKING  40  STEPS.
Total reward:  23.953275324344535
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.182663307636695
DONE TAKING  40  STEPS.
Total reward:  -340.72592998581894
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -12.038715084030045
DONE TAKING  40  STEPS.
Total reward:  -359.7005975188539
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.263369128289213
DONE TAKING  40  STEPS.
Total reward:  -361.87602616745994
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.830621753147206
DONE TAKING  40  STEPS.
Total reward:  -471.15864048523326
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.288688650408446
DONE TAKING  40  STEPS.
Total reward:  405.0951086972062
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -14.443712936564474
DONE TAKING  40  STEPS.
Total reward:  -112.7857146258769
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -11.247688244458997
DONE TAKING  40  STEPS.
Total reward:  -323.0596922539464
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.29885824960118
DONE TAKING  40  STEPS.
Total reward:  -889.8752962097587
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.889843360655505
DONE TAKING  40  STEPS.
Total reward:  -507.5963733793107
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.191626468819667
DONE TAKING  40  STEPS.
Total reward:  17.253424147276192
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.638209155096348
DONE TAKING  40  STEPS.
Total reward:  -185.76341349879405
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -31.353649965744687
DONE TAKING  40  STEPS.
Total reward:  -675.4527969868896
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.15664797435593
DONE TAKING  40  STEPS.
Total reward:  -600.9605120776108
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.82687265327011
DONE TAKING  40  STEPS.
Total reward:  -536.8424450618588
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.73087660925157
DONE TAKING  40  STEPS.
Total reward:  -287.95780610955256
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.528373786007236
DONE TAKING  40  STEPS.
Total reward:  -291.16326818259597
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -13.83811893127573
DONE TAKING  40  STEPS.
Total reward:  -91.57651090916568
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.59243606253432
DONE TAKING  40  STEPS.
Total reward:  -82.08052755964184
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.78559200634907
DONE TAKING  40  STEPS.
Total reward:  155.74536471502415
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter48.ckpt

#####################################
Training the dynamics model..... iteration  49
#####################################

    amount of random data:  8000
    amount of onPol data:  72324
Prob rand:  17355
On pol:  70560
Prob shape:  (87915,)

=== Epoch 0 ===
    train loss:  0.39738578266567653
    val rand:  0.41406843066215515
    val onPol:  0.30741605460643767

=== Epoch 10 ===
    train loss:  0.21353515616634436
    val rand:  0.20615875720977783
    val onPol:  0.25154173870881397

=== Epoch 20 ===
    train loss:  0.17653603973793008
    val rand:  0.17738649249076843
    val onPol:  0.25260268052419027

=== Epoch 30 ===
    train loss:  0.15199148088519338
    val rand:  0.16601082682609558
    val onPol:  0.2604840834935506

=== Epoch 39 ===
    train loss:  0.13532332030304692
    val rand:  0.16781793534755707
    val onPol:  0.2692559619744619
Training duration: 43.26 s

#####################################
performing on-policy MPC rollouts... iter  49
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.242401764960526
DONE TAKING  40  STEPS.
Total reward:  -302.0347171320597
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.61460639455308
DONE TAKING  40  STEPS.
Total reward:  -530.8849378523058
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.823378888603557
DONE TAKING  40  STEPS.
Total reward:  -197.7121807406957
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -14.48432130226941
DONE TAKING  40  STEPS.
Total reward:  -9.183862484280993
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -8.20951842570378
DONE TAKING  40  STEPS.
Total reward:  283.164624691521
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.403410558464845
DONE TAKING  40  STEPS.
Total reward:  -814.4277777824941
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.910662224716226
DONE TAKING  40  STEPS.
Total reward:  -400.489370958831
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -14.269628996906668
DONE TAKING  40  STEPS.
Total reward:  -294.4559485555601
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.85992206698559
DONE TAKING  40  STEPS.
Total reward:  -321.2173487442206
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.898284722945814
DONE TAKING  40  STEPS.
Total reward:  -514.5465678317386
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -16.866847560312838
DONE TAKING  40  STEPS.
Total reward:  -115.66608270647767
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.576360545633161
DONE TAKING  40  STEPS.
Total reward:  388.88615636320395
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.091852428675498
DONE TAKING  40  STEPS.
Total reward:  -464.58809388098786
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -13.192714502040674
DONE TAKING  40  STEPS.
Total reward:  367.7386219000037
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.966675379365636
DONE TAKING  40  STEPS.
Total reward:  -294.9142933924189
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.378332471753275
DONE TAKING  40  STEPS.
Total reward:  -497.3847610076169
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.06042062608165
DONE TAKING  40  STEPS.
Total reward:  -884.8371126931878
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.68162346854507
DONE TAKING  40  STEPS.
Total reward:  -685.2648252062905
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.75050398361843
DONE TAKING  40  STEPS.
Total reward:  -364.44822180569554
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.770425661378155
DONE TAKING  40  STEPS.
Total reward:  -401.73872960241977
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.261646245973047
DONE TAKING  40  STEPS.
Total reward:  -549.4497303847714
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.506964206379273
DONE TAKING  40  STEPS.
Total reward:  -589.7474916585825
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -12.057059464408226
DONE TAKING  40  STEPS.
Total reward:  -34.27242095536812
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.336676402893936
DONE TAKING  40  STEPS.
Total reward:  -402.8059016104411
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.192303293578206
DONE TAKING  40  STEPS.
Total reward:  -675.9543221047032
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.965831920667018
DONE TAKING  40  STEPS.
Total reward:  -792.3302689012058
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.182101541835973
DONE TAKING  40  STEPS.
Total reward:  -272.38055975565175
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.52244836237192
DONE TAKING  40  STEPS.
Total reward:  -410.24384486538634
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -12.103986550971243
DONE TAKING  40  STEPS.
Total reward:  -301.82124829972025
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -12.792428731070222
DONE TAKING  40  STEPS.
Total reward:  -320.87083612346277
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.31210524263512
DONE TAKING  40  STEPS.
Total reward:  -95.4430475448937
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.19129689412342
DONE TAKING  40  STEPS.
Total reward:  -473.51798369455787
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.881723721185363
DONE TAKING  40  STEPS.
Total reward:  -172.168547577384
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -11.262661050339954
DONE TAKING  40  STEPS.
Total reward:  -342.9462109635615
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -17.900793944990113
DONE TAKING  40  STEPS.
Total reward:  81.96743360955858
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.57815583742494
DONE TAKING  40  STEPS.
Total reward:  -513.3860386406086
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.994722585616053
DONE TAKING  40  STEPS.
Total reward:  -346.6030040467803
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -31.35884189463927
DONE TAKING  40  STEPS.
Total reward:  -799.9469518700926
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.951070778561334
DONE TAKING  40  STEPS.
Total reward:  -428.28640376447555
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.53323359716769
DONE TAKING  40  STEPS.
Total reward:  80.64715613946967
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter49.ckpt

#####################################
Training the dynamics model..... iteration  50
#####################################

    amount of random data:  8000
    amount of onPol data:  73800
Prob rand:  17550
On pol:  72000
Prob shape:  (89550,)

=== Epoch 0 ===
    train loss:  0.3954290506140939
    val rand:  0.4101165533065796
    val onPol:  0.30362172424793243

=== Epoch 10 ===
    train loss:  0.21428193374611865
    val rand:  0.2055257260799408
    val onPol:  0.2494315028190613

=== Epoch 20 ===
    train loss:  0.1785317906017961
    val rand:  0.17592374980449677
    val onPol:  0.2507873018582662

=== Epoch 30 ===
    train loss:  0.15289326928470326
    val rand:  0.1688138246536255
    val onPol:  0.25782824754714967

=== Epoch 39 ===
    train loss:  0.13710271802613105
    val rand:  0.16619274020195007
    val onPol:  0.2653086175521215
Training duration: 43.89 s

#####################################
performing on-policy MPC rollouts... iter  50
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -12.177466590254882
DONE TAKING  40  STEPS.
Total reward:  -261.4879631602709
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -31.30483635264364
DONE TAKING  40  STEPS.
Total reward:  -88.81955458222473
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.048100285982684
DONE TAKING  40  STEPS.
Total reward:  -500.50470206868937
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -20.332517865752564
DONE TAKING  40  STEPS.
Total reward:  -582.9168388354644
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.699127350205583
DONE TAKING  40  STEPS.
Total reward:  -544.4245330788344
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.613212017458117
DONE TAKING  40  STEPS.
Total reward:  -501.1545953350829
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.0714151001718
DONE TAKING  40  STEPS.
Total reward:  -362.8410054814566
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.75990264133986
DONE TAKING  40  STEPS.
Total reward:  106.61974477994004
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.51069837044759
DONE TAKING  40  STEPS.
Total reward:  -221.68656284518
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.729530630382875
DONE TAKING  40  STEPS.
Total reward:  -461.03029349786476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.10101885902452
DONE TAKING  40  STEPS.
Total reward:  -975.7417737223984
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.023596365324792
DONE TAKING  40  STEPS.
Total reward:  -653.8500758020494
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.828601097320742
DONE TAKING  40  STEPS.
Total reward:  -618.9053508298659
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.87310117439265
DONE TAKING  40  STEPS.
Total reward:  -180.35173452526664
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.1508531705821
DONE TAKING  40  STEPS.
Total reward:  -775.7045580270425
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.164531835777975
DONE TAKING  40  STEPS.
Total reward:  -324.228510246576
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.319422997467033
DONE TAKING  40  STEPS.
Total reward:  257.50800181324064
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -16.215905117751408
DONE TAKING  40  STEPS.
Total reward:  -462.52757743223265
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.875377967785212
DONE TAKING  40  STEPS.
Total reward:  -925.9501782324166
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.3330908392547
DONE TAKING  40  STEPS.
Total reward:  40.166176979441495
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.303418303507307
DONE TAKING  40  STEPS.
Total reward:  -424.1011211311568
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.593642660279578
DONE TAKING  40  STEPS.
Total reward:  -499.5940380508662
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.37766825083715
DONE TAKING  40  STEPS.
Total reward:  -28.032459081320056
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -12.859202325196655
DONE TAKING  40  STEPS.
Total reward:  -421.66004613448774
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.932193565447953
DONE TAKING  40  STEPS.
Total reward:  -866.4465283151004
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -9.123097480978569
DONE TAKING  40  STEPS.
Total reward:  -214.7063328709267
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.02801845542243
DONE TAKING  40  STEPS.
Total reward:  -515.7294233816301
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.553242972516536
DONE TAKING  40  STEPS.
Total reward:  293.05979383405264
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.10245250143842
DONE TAKING  40  STEPS.
Total reward:  -492.2966909175192
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.316060620845832
DONE TAKING  40  STEPS.
Total reward:  -309.43060112279557
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.532860602559765
DONE TAKING  40  STEPS.
Total reward:  -869.1670066792657
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.98607738980484
DONE TAKING  40  STEPS.
Total reward:  -633.5497331626162
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.3254914133201
DONE TAKING  40  STEPS.
Total reward:  -163.5127004343955
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.435334435221915
DONE TAKING  40  STEPS.
Total reward:  -76.6089315781071
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.439733459036347
DONE TAKING  40  STEPS.
Total reward:  -684.8305445354258
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.584441607291957
DONE TAKING  40  STEPS.
Total reward:  -602.147460533168
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.428667546601318
DONE TAKING  40  STEPS.
Total reward:  -668.8898261482562
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -11.941232865182547
DONE TAKING  40  STEPS.
Total reward:  -316.4297051456362
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.69120824707806
DONE TAKING  40  STEPS.
Total reward:  -559.8360613160877
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.20893404240971
DONE TAKING  40  STEPS.
Total reward:  -594.40475893602
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter50.ckpt

#####################################
Training the dynamics model..... iteration  51
#####################################

    amount of random data:  8000
    amount of onPol data:  75276
Prob rand:  17745
On pol:  73440
Prob shape:  (91185,)

=== Epoch 0 ===
    train loss:  0.39268040221728634
    val rand:  0.4085986018180847
    val onPol:  0.30295475920041404

=== Epoch 10 ===
    train loss:  0.21396840280026533
    val rand:  0.2068437933921814
    val onPol:  0.24741328557332357

=== Epoch 20 ===
    train loss:  0.17737101956029958
    val rand:  0.1746044009923935
    val onPol:  0.24992584586143493

=== Epoch 30 ===
    train loss:  0.15413531619176435
    val rand:  0.16594961285591125
    val onPol:  0.2553503801425298

=== Epoch 39 ===
    train loss:  0.13663996283090515
    val rand:  0.1618967354297638
    val onPol:  0.26429858009020485
Training duration: 46.06 s

#####################################
performing on-policy MPC rollouts... iter  51
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.797976265986307
DONE TAKING  40  STEPS.
Total reward:  -550.6703901299807
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.94434241469311
DONE TAKING  40  STEPS.
Total reward:  -695.5515065126089
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.896508278413638
DONE TAKING  40  STEPS.
Total reward:  -795.4971769716011
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.878527678337182
DONE TAKING  40  STEPS.
Total reward:  -651.0554439752201
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.856354081301006
DONE TAKING  40  STEPS.
Total reward:  -920.2614603390433
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.265840246227242
DONE TAKING  40  STEPS.
Total reward:  -982.9522192584459
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.096522364328706
DONE TAKING  40  STEPS.
Total reward:  -352.5589754814126
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.094879662136357
DONE TAKING  40  STEPS.
Total reward:  -210.63395260144873
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.172300903360245
DONE TAKING  40  STEPS.
Total reward:  -902.7946906249236
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.17755636736196
DONE TAKING  40  STEPS.
Total reward:  -587.3686159884678
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.650242383481665
DONE TAKING  40  STEPS.
Total reward:  -610.181956052365
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.3985759123021
DONE TAKING  40  STEPS.
Total reward:  340.97236785916965
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.116022368984776
DONE TAKING  40  STEPS.
Total reward:  -878.8492861552729
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -15.962591145222401
DONE TAKING  40  STEPS.
Total reward:  418.241914643839
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -31.286367317763993
DONE TAKING  40  STEPS.
Total reward:  -1092.4929829950736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.727862929816446
DONE TAKING  40  STEPS.
Total reward:  127.91073510189796
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -15.21642118544435
DONE TAKING  40  STEPS.
Total reward:  -415.23686531883095
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -11.402334552443904
DONE TAKING  40  STEPS.
Total reward:  -8.99572567830156
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.7216626964982
DONE TAKING  40  STEPS.
Total reward:  -339.3646662393362
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.14874173981445
DONE TAKING  40  STEPS.
Total reward:  -233.48155865560898
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -20.000073172377345
DONE TAKING  40  STEPS.
Total reward:  -243.83603483880978
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.4913603426825
DONE TAKING  40  STEPS.
Total reward:  -592.4903243354337
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.497025551457874
DONE TAKING  40  STEPS.
Total reward:  -148.81139436053377
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.138015470497866
DONE TAKING  40  STEPS.
Total reward:  -790.7150498528054
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.98318398415102
DONE TAKING  40  STEPS.
Total reward:  7.751845692499824
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.821505712472703
DONE TAKING  40  STEPS.
Total reward:  -656.8127072479523
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.306369352977594
DONE TAKING  40  STEPS.
Total reward:  -649.2065692281658
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -20.83361058072523
DONE TAKING  40  STEPS.
Total reward:  -295.0965985678199
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.064842650515217
DONE TAKING  40  STEPS.
Total reward:  99.52151135709875
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.537273846178437
DONE TAKING  40  STEPS.
Total reward:  -522.9970544431536
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.092151770293647
DONE TAKING  40  STEPS.
Total reward:  -420.1929171696611
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.955020076333675
DONE TAKING  40  STEPS.
Total reward:  133.78097947316618
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.237884449594254
DONE TAKING  40  STEPS.
Total reward:  225.48773581417188
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.33284785359009
DONE TAKING  40  STEPS.
Total reward:  -313.114836022594
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.99430280135411
DONE TAKING  40  STEPS.
Total reward:  -484.1267357960054
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -13.130117732305857
DONE TAKING  40  STEPS.
Total reward:  -307.525012111312
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.602710232576772
DONE TAKING  40  STEPS.
Total reward:  309.61465353768585
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.950295974585355
DONE TAKING  40  STEPS.
Total reward:  -543.3211257102392
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.556088605799047
DONE TAKING  40  STEPS.
Total reward:  -262.51951709405597
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.771335393164563
DONE TAKING  40  STEPS.
Total reward:  175.2804525088785
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter51.ckpt

#####################################
Training the dynamics model..... iteration  52
#####################################

    amount of random data:  8000
    amount of onPol data:  76752
Prob rand:  17940
On pol:  74880
Prob shape:  (92820,)

=== Epoch 0 ===
    train loss:  0.38642888388581037
    val rand:  0.3983982801437378
    val onPol:  0.3032022062689066

=== Epoch 10 ===
    train loss:  0.21316238974339397
    val rand:  0.21090951561927795
    val onPol:  0.2491049636155367

=== Epoch 20 ===
    train loss:  0.17477570614103455
    val rand:  0.17812398076057434
    val onPol:  0.24932736717164516

=== Epoch 30 ===
    train loss:  0.15064884746930876
    val rand:  0.1637982726097107
    val onPol:  0.2576260669156909

=== Epoch 39 ===
    train loss:  0.13501932970068073
    val rand:  0.16295349597930908
    val onPol:  0.2653299141675234
Training duration: 45.82 s

#####################################
performing on-policy MPC rollouts... iter  52
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.480857631606796
DONE TAKING  40  STEPS.
Total reward:  -367.9831665349363
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.32603539802187
DONE TAKING  40  STEPS.
Total reward:  -465.2363250321853
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.88894867927391
DONE TAKING  40  STEPS.
Total reward:  -69.81452791047266
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.938774498087998
DONE TAKING  40  STEPS.
Total reward:  -277.82127955493877
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.66127525438955
DONE TAKING  40  STEPS.
Total reward:  68.10236768402798
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.36275838968981
DONE TAKING  40  STEPS.
Total reward:  -678.7146284236748
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.870751155731558
DONE TAKING  40  STEPS.
Total reward:  -24.522421952732685
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -12.785689379541767
DONE TAKING  40  STEPS.
Total reward:  -425.828561267525
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.748489952500876
DONE TAKING  40  STEPS.
Total reward:  -594.9605746915536
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -26.813002087577974
DONE TAKING  40  STEPS.
Total reward:  -887.4733649619673
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.733397382306133
DONE TAKING  40  STEPS.
Total reward:  -777.9795755617171
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -25.806861121655533
DONE TAKING  40  STEPS.
Total reward:  -57.12643136494792
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.910153315432638
DONE TAKING  40  STEPS.
Total reward:  -185.5819983834627
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.016535007443924
DONE TAKING  40  STEPS.
Total reward:  -636.328664272128
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.330504026507715
DONE TAKING  40  STEPS.
Total reward:  -492.5960002767652
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.359074818588
DONE TAKING  40  STEPS.
Total reward:  -578.8052323456259
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.43024572146017
DONE TAKING  40  STEPS.
Total reward:  -538.1776226150134
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -15.549544715709892
DONE TAKING  40  STEPS.
Total reward:  -531.4823928802203
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.637439273052014
DONE TAKING  40  STEPS.
Total reward:  -964.8307931905416
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.397313683759737
DONE TAKING  40  STEPS.
Total reward:  -378.56821925778627
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.009888050491952
DONE TAKING  40  STEPS.
Total reward:  -655.79828535036
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.62119833351915
DONE TAKING  40  STEPS.
Total reward:  59.09106367347073
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.86977002782417
DONE TAKING  40  STEPS.
Total reward:  -1018.5067007764287
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.913614244499286
DONE TAKING  40  STEPS.
Total reward:  199.81902576377558
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -15.844434038419237
DONE TAKING  40  STEPS.
Total reward:  -362.3473715074536
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.977532314408364
DONE TAKING  40  STEPS.
Total reward:  -132.9928999569402
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.6133696057584
DONE TAKING  40  STEPS.
Total reward:  -366.19222766809474
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.542377142064172
DONE TAKING  40  STEPS.
Total reward:  -248.08470427815578
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.654816999067656
DONE TAKING  40  STEPS.
Total reward:  -794.9620542537987
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.75135643036348
DONE TAKING  40  STEPS.
Total reward:  -759.326445445469
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.27681173808914
DONE TAKING  40  STEPS.
Total reward:  -666.913567368679
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -19.494626796146463
DONE TAKING  40  STEPS.
Total reward:  -294.4998679901659
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.773786092324983
DONE TAKING  40  STEPS.
Total reward:  -601.6317990507289
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.5139756896798
DONE TAKING  40  STEPS.
Total reward:  -303.57753991207494
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -14.756588866589732
DONE TAKING  40  STEPS.
Total reward:  -358.7454681817082
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.896741575047226
DONE TAKING  40  STEPS.
Total reward:  -567.2856029218709
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.636764095133998
DONE TAKING  40  STEPS.
Total reward:  -634.332243780329
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.389712757307443
DONE TAKING  40  STEPS.
Total reward:  -400.5739957837998
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -13.619785535055948
DONE TAKING  40  STEPS.
Total reward:  -388.46019001652394
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.623874855596547
DONE TAKING  40  STEPS.
Total reward:  -470.0055856058201
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter52.ckpt

#####################################
Training the dynamics model..... iteration  53
#####################################

    amount of random data:  8000
    amount of onPol data:  78228
Prob rand:  18135
On pol:  76320
Prob shape:  (94455,)

=== Epoch 0 ===
    train loss:  0.3887912937156532
    val rand:  0.41343289613723755
    val onPol:  0.2998239090666175

=== Epoch 10 ===
    train loss:  0.21257247451854788
    val rand:  0.2048405259847641
    val onPol:  0.2462334055453539

=== Epoch 20 ===
    train loss:  0.17635988492680632
    val rand:  0.17875802516937256
    val onPol:  0.24854782223701477

=== Epoch 30 ===
    train loss:  0.1509531016421059
    val rand:  0.17241105437278748
    val onPol:  0.25641921162605286

=== Epoch 39 ===
    train loss:  0.13551464320524878
    val rand:  0.168204665184021
    val onPol:  0.2654205849394202
Training duration: 47.13 s

#####################################
performing on-policy MPC rollouts... iter  53
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -14.698208706467534
DONE TAKING  40  STEPS.
Total reward:  229.68086182599757
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.206241613726352
DONE TAKING  40  STEPS.
Total reward:  -63.07806277157499
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.432114267408263
DONE TAKING  40  STEPS.
Total reward:  -570.2013346849112
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.28385467336936
DONE TAKING  40  STEPS.
Total reward:  -406.0943385147171
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.54412006740193
DONE TAKING  40  STEPS.
Total reward:  -236.4481383662044
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.0985289074055
DONE TAKING  40  STEPS.
Total reward:  -207.43829211241138
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.34798459254904
DONE TAKING  40  STEPS.
Total reward:  -287.10415584885106
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.30363401227749
DONE TAKING  40  STEPS.
Total reward:  -707.3546539694674
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.346971255524153
DONE TAKING  40  STEPS.
Total reward:  -727.3034563991738
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.645943749268632
DONE TAKING  40  STEPS.
Total reward:  -479.31058056070395
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.069367324164503
DONE TAKING  40  STEPS.
Total reward:  -251.61506141706928
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.799028768175095
DONE TAKING  40  STEPS.
Total reward:  -175.35305655031596
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.458364496290656
DONE TAKING  40  STEPS.
Total reward:  -196.29199062261856
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.72991036081286
DONE TAKING  40  STEPS.
Total reward:  -323.76584698366196
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -13.439049820124293
DONE TAKING  40  STEPS.
Total reward:  371.97304986344926
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.56120371301747
DONE TAKING  40  STEPS.
Total reward:  257.48883889918176
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.857119567417712
DONE TAKING  40  STEPS.
Total reward:  -720.3893470731065
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -18.169958760689042
DONE TAKING  40  STEPS.
Total reward:  -324.62380378591996
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.505157508665175
DONE TAKING  40  STEPS.
Total reward:  -944.0614393234875
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.23315599294793
DONE TAKING  40  STEPS.
Total reward:  -202.79150473347028
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -13.310054135101028
DONE TAKING  40  STEPS.
Total reward:  -35.09882534104669
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.30655648426167
DONE TAKING  40  STEPS.
Total reward:  -282.24353370048897
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.713543730342828
DONE TAKING  40  STEPS.
Total reward:  -420.1617260563229
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.097865104881855
DONE TAKING  40  STEPS.
Total reward:  -310.6326045359457
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.9101460008334
DONE TAKING  40  STEPS.
Total reward:  -164.64826748557405
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.776189004903017
DONE TAKING  40  STEPS.
Total reward:  -49.54905164577827
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.045210671520806
DONE TAKING  40  STEPS.
Total reward:  -82.62830659815401
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.404634204200853
DONE TAKING  40  STEPS.
Total reward:  -637.8369201800069
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.70970487774437
DONE TAKING  40  STEPS.
Total reward:  -575.5703083472594
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.72653730980719
DONE TAKING  40  STEPS.
Total reward:  -488.0035873025131
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -15.488020185213664
DONE TAKING  40  STEPS.
Total reward:  -404.5648536555616
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.17616711321388
DONE TAKING  40  STEPS.
Total reward:  -203.58508080797682
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.97322724749712
DONE TAKING  40  STEPS.
Total reward:  -705.5593342068389
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -31.101437133878257
DONE TAKING  40  STEPS.
Total reward:  -750.4235149917841
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -10.90047901634702
DONE TAKING  40  STEPS.
Total reward:  92.44152813404175
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.95806319789297
DONE TAKING  40  STEPS.
Total reward:  -385.2177010291746
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.82977201049123
DONE TAKING  40  STEPS.
Total reward:  -508.18336907547894
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.947920882076886
DONE TAKING  40  STEPS.
Total reward:  -44.429409686013386
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.553331278755973
DONE TAKING  40  STEPS.
Total reward:  -1019.1627351677595
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.054416847960297
DONE TAKING  40  STEPS.
Total reward:  -143.85404896511392
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter53.ckpt

#####################################
Training the dynamics model..... iteration  54
#####################################

    amount of random data:  8000
    amount of onPol data:  79704
Prob rand:  18330
On pol:  77760
Prob shape:  (96090,)

=== Epoch 0 ===
    train loss:  0.3902354831682807
    val rand:  0.3991188704967499
    val onPol:  0.29827379155904055

=== Epoch 10 ===
    train loss:  0.21420190264196956
    val rand:  0.2101791352033615
    val onPol:  0.24457462318241596

=== Epoch 20 ===
    train loss:  0.1760185936236764
    val rand:  0.1755354106426239
    val onPol:  0.2453783145174384

=== Epoch 30 ===
    train loss:  0.15334405012946714
    val rand:  0.16897982358932495
    val onPol:  0.252327804453671

=== Epoch 39 ===
    train loss:  0.13712384017871662
    val rand:  0.16522425413131714
    val onPol:  0.2584553575143218
Training duration: 48.51 s

#####################################
performing on-policy MPC rollouts... iter  54
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.980115444531357
DONE TAKING  40  STEPS.
Total reward:  -563.1440720628242
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.298939480999756
DONE TAKING  40  STEPS.
Total reward:  -608.8067399571006
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.810704363157404
DONE TAKING  40  STEPS.
Total reward:  140.55408187489817
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.72966210542802
DONE TAKING  40  STEPS.
Total reward:  -11.880090199263535
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.798140931896484
DONE TAKING  40  STEPS.
Total reward:  -832.3319251145317
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.57048783899272
DONE TAKING  40  STEPS.
Total reward:  -229.6977830864724
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -12.626069291744512
DONE TAKING  40  STEPS.
Total reward:  -318.42433376305553
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.793878988294566
DONE TAKING  40  STEPS.
Total reward:  172.8871918142463
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.037643668485888
DONE TAKING  40  STEPS.
Total reward:  -563.5741632422242
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -15.944614983162426
DONE TAKING  40  STEPS.
Total reward:  -240.36552562539552
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -31.31158566582298
DONE TAKING  40  STEPS.
Total reward:  -810.2319895732135
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -25.49289360504593
DONE TAKING  40  STEPS.
Total reward:  -653.7830571776806
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.09872215457441
DONE TAKING  40  STEPS.
Total reward:  130.3778077774839
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.52746028586953
DONE TAKING  40  STEPS.
Total reward:  -701.5744424929967
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.174423276573748
DONE TAKING  40  STEPS.
Total reward:  -700.7110043056526
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.790023413528495
DONE TAKING  40  STEPS.
Total reward:  -749.6512203220041
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.261143161308947
DONE TAKING  40  STEPS.
Total reward:  -424.6145037539726
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.710753156206884
DONE TAKING  40  STEPS.
Total reward:  140.9184368290869
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.079720796432966
DONE TAKING  40  STEPS.
Total reward:  -631.5596002172105
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.501717947718397
DONE TAKING  40  STEPS.
Total reward:  114.60879989412626
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.654252774349054
DONE TAKING  40  STEPS.
Total reward:  -614.394494958493
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.539889035991838
DONE TAKING  40  STEPS.
Total reward:  -124.26360677618467
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -20.647136886462278
DONE TAKING  40  STEPS.
Total reward:  79.78974997501032
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.713653868636648
DONE TAKING  40  STEPS.
Total reward:  -605.0592982997543
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.468138949744677
DONE TAKING  40  STEPS.
Total reward:  -500.53808104480214
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.635480584509946
DONE TAKING  40  STEPS.
Total reward:  -236.57480685852246
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.733217268450897
DONE TAKING  40  STEPS.
Total reward:  -568.9703298442536
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.831306682890315
DONE TAKING  40  STEPS.
Total reward:  -699.3250805070063
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.451481142643036
DONE TAKING  40  STEPS.
Total reward:  -206.45722326065572
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -12.871188824010867
DONE TAKING  40  STEPS.
Total reward:  346.58018104145617
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.293580177158855
DONE TAKING  40  STEPS.
Total reward:  -674.1374113118087
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -13.304549952463251
DONE TAKING  40  STEPS.
Total reward:  369.88902060561423
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.696085679770533
DONE TAKING  40  STEPS.
Total reward:  208.13224326608642
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.144794663820907
DONE TAKING  40  STEPS.
Total reward:  -188.28577140316315
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -31.10069434237719
DONE TAKING  40  STEPS.
Total reward:  -377.4224649183217
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.306101430344793
DONE TAKING  40  STEPS.
Total reward:  108.9313297116349
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.50732029397241
DONE TAKING  40  STEPS.
Total reward:  -533.4862254957783
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.435437164798348
DONE TAKING  40  STEPS.
Total reward:  -252.68878718641596
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -31.356949709561164
DONE TAKING  40  STEPS.
Total reward:  -778.6427563015062
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.22960910074739
DONE TAKING  40  STEPS.
Total reward:  -721.4773326945236
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter54.ckpt

#####################################
Training the dynamics model..... iteration  55
#####################################

    amount of random data:  8000
    amount of onPol data:  81180
Prob rand:  18525
On pol:  79200
Prob shape:  (97725,)

=== Epoch 0 ===
    train loss:  0.3891105438533582
    val rand:  0.4080587327480316
    val onPol:  0.30098408548270955

=== Epoch 10 ===
    train loss:  0.21431858618008462
    val rand:  0.20590364933013916
    val onPol:  0.24636069641393774

=== Epoch 20 ===
    train loss:  0.1761092680849527
    val rand:  0.1755194514989853
    val onPol:  0.24719379491665783

=== Epoch 30 ===
    train loss:  0.15176483102534946
    val rand:  0.1689266413450241
    val onPol:  0.25317350818830375

=== Epoch 39 ===
    train loss:  0.13645680695772172
    val rand:  0.16519884765148163
    val onPol:  0.26234933909247904
Training duration: 49.11 s

#####################################
performing on-policy MPC rollouts... iter  55
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.956976889289937
DONE TAKING  40  STEPS.
Total reward:  -319.82479619617953
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.28904791503969
DONE TAKING  40  STEPS.
Total reward:  -1116.5551953861193
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.33468175732526
DONE TAKING  40  STEPS.
Total reward:  32.6123474933181
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.797061056797125
DONE TAKING  40  STEPS.
Total reward:  -60.34012500045739
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.130438859082957
DONE TAKING  40  STEPS.
Total reward:  -879.9906407888251
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.2202993483845
DONE TAKING  40  STEPS.
Total reward:  -78.41522895966276
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.335900252424217
DONE TAKING  40  STEPS.
Total reward:  -666.3281266848369
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.04035471468294
DONE TAKING  40  STEPS.
Total reward:  -64.78123014427872
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -17.083717420670116
DONE TAKING  40  STEPS.
Total reward:  57.303173446693265
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.531844902256516
DONE TAKING  40  STEPS.
Total reward:  -201.5301152291222
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.14868917218865
DONE TAKING  40  STEPS.
Total reward:  -51.48098912734496
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.710411853571014
DONE TAKING  40  STEPS.
Total reward:  -322.60121792797685
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.408215687258593
DONE TAKING  40  STEPS.
Total reward:  28.41437253214908
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.195676483760163
DONE TAKING  40  STEPS.
Total reward:  347.2158503946804
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.54387603296837
DONE TAKING  40  STEPS.
Total reward:  34.09581682927685
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.403784965799883
DONE TAKING  40  STEPS.
Total reward:  -437.4208246327547
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -16.079980752887245
DONE TAKING  40  STEPS.
Total reward:  -505.532112931202
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.514621886416496
DONE TAKING  40  STEPS.
Total reward:  -436.1446971627527
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.79253368522492
DONE TAKING  40  STEPS.
Total reward:  -363.70098801271104
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.831107527261764
DONE TAKING  40  STEPS.
Total reward:  -622.11286850661
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.254756664361377
DONE TAKING  40  STEPS.
Total reward:  -268.9273145664285
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -23.981482494522428
DONE TAKING  40  STEPS.
Total reward:  -62.985112426192615
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.378687711841525
DONE TAKING  40  STEPS.
Total reward:  192.92413603899402
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.791163674551154
DONE TAKING  40  STEPS.
Total reward:  -232.20958656499613
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.001762136746507
DONE TAKING  40  STEPS.
Total reward:  77.36059904899813
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -31.373817253998407
DONE TAKING  40  STEPS.
Total reward:  -564.1377367056771
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.00079101759247
DONE TAKING  40  STEPS.
Total reward:  -482.00098770544645
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.352464838871956
DONE TAKING  40  STEPS.
Total reward:  -501.12102327451026
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.490200115840537
DONE TAKING  40  STEPS.
Total reward:  -151.3825198164909
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.049335027676218
DONE TAKING  40  STEPS.
Total reward:  -656.6136824545065
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.989117489600304
DONE TAKING  40  STEPS.
Total reward:  -786.7862403472957
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.835185954122732
DONE TAKING  40  STEPS.
Total reward:  -872.3108065794536
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.743805238641478
DONE TAKING  40  STEPS.
Total reward:  -684.0202003898987
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -20.491097072744225
DONE TAKING  40  STEPS.
Total reward:  47.46877191715437
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -10.66938205504367
DONE TAKING  40  STEPS.
Total reward:  -437.381503609458
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.55997425218782
DONE TAKING  40  STEPS.
Total reward:  -365.704273032451
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.750854771831513
DONE TAKING  40  STEPS.
Total reward:  -26.332057968740997
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.951643240421003
DONE TAKING  40  STEPS.
Total reward:  -159.9070725693191
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -21.87279511356141
DONE TAKING  40  STEPS.
Total reward:  -233.8264323938025
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.847683969307973
DONE TAKING  40  STEPS.
Total reward:  -640.6759197251491
Time for 1 rollout: 1.04 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter55.ckpt

#####################################
Training the dynamics model..... iteration  56
#####################################

    amount of random data:  8000
    amount of onPol data:  82656
Prob rand:  18720
On pol:  80640
Prob shape:  (99360,)

=== Epoch 0 ===
    train loss:  0.38674260752717243
    val rand:  0.40259692072868347
    val onPol:  0.2969061478095896

=== Epoch 10 ===
    train loss:  0.2145099821932537
    val rand:  0.20315787196159363
    val onPol:  0.24411224004100351

=== Epoch 20 ===
    train loss:  0.1782652951546551
    val rand:  0.17511188983917236
    val onPol:  0.24599858592538273

=== Epoch 30 ===
    train loss:  0.15385283276285092
    val rand:  0.1679288148880005
    val onPol:  0.2522187995560029

=== Epoch 39 ===
    train loss:  0.13693700938187925
    val rand:  0.16772465407848358
    val onPol:  0.2598581226433025
Training duration: 50.05 s

#####################################
performing on-policy MPC rollouts... iter  56
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.846776239341594
DONE TAKING  40  STEPS.
Total reward:  -827.0326942458084
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -11.929801594774311
DONE TAKING  40  STEPS.
Total reward:  -365.22597250240455
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.03637520971149
DONE TAKING  40  STEPS.
Total reward:  -199.35334533539356
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.061988287889257
DONE TAKING  40  STEPS.
Total reward:  -770.4465800886794
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.934099709308455
DONE TAKING  40  STEPS.
Total reward:  -608.4728414092161
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.704551564265472
DONE TAKING  40  STEPS.
Total reward:  -703.4411138482714
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -15.692215031073918
DONE TAKING  40  STEPS.
Total reward:  -296.7110086547945
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.975234391963657
DONE TAKING  40  STEPS.
Total reward:  -59.475317139730684
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -8.965359940667565
DONE TAKING  40  STEPS.
Total reward:  356.5698541017523
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.279583041232847
DONE TAKING  40  STEPS.
Total reward:  -420.3273856120154
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.018627496036718
DONE TAKING  40  STEPS.
Total reward:  -389.088825232714
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -9.348181686624752
DONE TAKING  40  STEPS.
Total reward:  333.74348766031653
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.5219212973304
DONE TAKING  40  STEPS.
Total reward:  -380.16709870045156
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.264327534319634
DONE TAKING  40  STEPS.
Total reward:  -588.2490250195359
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -17.45167514203097
DONE TAKING  40  STEPS.
Total reward:  -533.1929844766294
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.76543129326967
DONE TAKING  40  STEPS.
Total reward:  -499.3801196986736
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.089969202115824
DONE TAKING  40  STEPS.
Total reward:  -258.7083552719675
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.36423734480841
DONE TAKING  40  STEPS.
Total reward:  -781.5376414882523
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -16.57173660978367
DONE TAKING  40  STEPS.
Total reward:  -115.08237218512667
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.509615318856085
DONE TAKING  40  STEPS.
Total reward:  256.7245222757728
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.294914474537883
DONE TAKING  40  STEPS.
Total reward:  -727.815934120888
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -20.41550661111598
DONE TAKING  40  STEPS.
Total reward:  -283.6084062260818
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.44217704913366
DONE TAKING  40  STEPS.
Total reward:  -433.87583460679093
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.803408186398265
DONE TAKING  40  STEPS.
Total reward:  -135.473808669633
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.551929896556633
DONE TAKING  40  STEPS.
Total reward:  -837.4331034879316
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.812330490741964
DONE TAKING  40  STEPS.
Total reward:  -811.0263334799208
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.23223303463388
DONE TAKING  40  STEPS.
Total reward:  -128.43955664859376
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.31581519370279
DONE TAKING  40  STEPS.
Total reward:  -585.7165363906455
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.202332735851957
DONE TAKING  40  STEPS.
Total reward:  -251.328405480783
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.601948075298324
DONE TAKING  40  STEPS.
Total reward:  -733.0575750716077
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.41022247095644
DONE TAKING  40  STEPS.
Total reward:  -175.28391147626905
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.595941615189265
DONE TAKING  40  STEPS.
Total reward:  -475.98642757434783
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -31.173297674079517
DONE TAKING  40  STEPS.
Total reward:  125.26907105415832
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.740476490743433
DONE TAKING  40  STEPS.
Total reward:  451.8500346526024
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -31.123104262813467
DONE TAKING  40  STEPS.
Total reward:  -123.0430148921566
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.537521909898558
DONE TAKING  40  STEPS.
Total reward:  93.52867076299813
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.722039785743057
DONE TAKING  40  STEPS.
Total reward:  -639.9842434415588
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -18.40815899763598
DONE TAKING  40  STEPS.
Total reward:  -379.66368468119083
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.641625693449004
DONE TAKING  40  STEPS.
Total reward:  -231.43520029626254
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -29.470078311158787
DONE TAKING  40  STEPS.
Total reward:  -27.520630945896155
Time for 1 rollout: 1.05 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter56.ckpt

#####################################
Training the dynamics model..... iteration  57
#####################################

    amount of random data:  8000
    amount of onPol data:  84132
Prob rand:  18915
On pol:  82080
Prob shape:  (100995,)

=== Epoch 0 ===
    train loss:  0.3868245497572846
    val rand:  0.4013737142086029
    val onPol:  0.294913105228368

=== Epoch 10 ===
    train loss:  0.21495319933153045
    val rand:  0.21087360382080078
    val onPol:  0.24061004379216364

=== Epoch 20 ===
    train loss:  0.1773119425107985
    val rand:  0.17672203481197357
    val onPol:  0.24079320010016947

=== Epoch 30 ===
    train loss:  0.15380045211859766
    val rand:  0.16790322959423065
    val onPol:  0.2482025789863923

=== Epoch 39 ===
    train loss:  0.1383367847972715
    val rand:  0.167581245303154
    val onPol:  0.257190705222242
Training duration: 50.87 s

#####################################
performing on-policy MPC rollouts... iter  57
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.51557974244244
DONE TAKING  40  STEPS.
Total reward:  -705.5844177857119
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.44354636053944
DONE TAKING  40  STEPS.
Total reward:  -32.8760187246247
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.601089597818017
DONE TAKING  40  STEPS.
Total reward:  315.66217773561726
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.39476375908136
DONE TAKING  40  STEPS.
Total reward:  80.47170159956627
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -17.49284216134251
DONE TAKING  40  STEPS.
Total reward:  -398.8495171686824
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.106258106354634
DONE TAKING  40  STEPS.
Total reward:  -29.296280119446017
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.32588622353957
DONE TAKING  40  STEPS.
Total reward:  -369.2110673748293
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.092862169981977
DONE TAKING  40  STEPS.
Total reward:  -839.2253591302432
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.60400126014803
DONE TAKING  40  STEPS.
Total reward:  -542.0186545442073
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.382407690464454
DONE TAKING  40  STEPS.
Total reward:  -414.11617662676304
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.88737340726491
DONE TAKING  40  STEPS.
Total reward:  -751.449661890389
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -18.90481388014728
DONE TAKING  40  STEPS.
Total reward:  -112.31505021384758
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.982898057344762
DONE TAKING  40  STEPS.
Total reward:  -359.9759333719511
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.462984974780966
DONE TAKING  40  STEPS.
Total reward:  -537.3550466766624
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.513283218461925
DONE TAKING  40  STEPS.
Total reward:  -68.28888801619807
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.99284131558462
DONE TAKING  40  STEPS.
Total reward:  158.32942766157217
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.272021560651083
DONE TAKING  40  STEPS.
Total reward:  -207.51724347949155
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.416808508166437
DONE TAKING  40  STEPS.
Total reward:  -458.9725402923299
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.214107000408223
DONE TAKING  40  STEPS.
Total reward:  -702.370517424535
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -18.447363239297875
DONE TAKING  40  STEPS.
Total reward:  -403.4293291888587
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -12.348199412780016
DONE TAKING  40  STEPS.
Total reward:  132.83494493373541
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -20.371697869539357
DONE TAKING  40  STEPS.
Total reward:  -103.70241982990743
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.15351356875804
DONE TAKING  40  STEPS.
Total reward:  -349.2461644070379
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -18.48870423693
DONE TAKING  40  STEPS.
Total reward:  142.68185699584564
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.91352687425964
DONE TAKING  40  STEPS.
Total reward:  -62.147604286001425
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.612590148729858
DONE TAKING  40  STEPS.
Total reward:  -547.7869235573465
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.183491819917343
DONE TAKING  40  STEPS.
Total reward:  76.53457444506583
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.90724270198343
DONE TAKING  40  STEPS.
Total reward:  -376.4977727011089
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.32944661567022
DONE TAKING  40  STEPS.
Total reward:  -676.7798041937884
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.282885083420496
DONE TAKING  40  STEPS.
Total reward:  -667.1394598575984
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.756575018812082
DONE TAKING  40  STEPS.
Total reward:  -211.3060170285886
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.607480095438035
DONE TAKING  40  STEPS.
Total reward:  -882.7152216259376
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.350120974092736
DONE TAKING  40  STEPS.
Total reward:  -783.0081457625
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.23397728669204
DONE TAKING  40  STEPS.
Total reward:  -846.2172490730475
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.245667715035765
DONE TAKING  40  STEPS.
Total reward:  -535.3781553252851
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.7613727900851
DONE TAKING  40  STEPS.
Total reward:  -331.7061555606379
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.208550439371646
DONE TAKING  40  STEPS.
Total reward:  -623.4687081668662
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.415719900815839
DONE TAKING  40  STEPS.
Total reward:  -229.85076434018416
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.879008713565405
DONE TAKING  40  STEPS.
Total reward:  -480.79770210832856
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.338570111938175
DONE TAKING  40  STEPS.
Total reward:  -692.325016515742
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter57.ckpt

#####################################
Training the dynamics model..... iteration  58
#####################################

    amount of random data:  8000
    amount of onPol data:  85608
Prob rand:  19110
On pol:  83520
Prob shape:  (102630,)

=== Epoch 0 ===
    train loss:  0.3847166796028614
    val rand:  0.3900323510169983
    val onPol:  0.3010568171739578

=== Epoch 10 ===
    train loss:  0.21453014723956584
    val rand:  0.20643889904022217
    val onPol:  0.24609167046017116

=== Epoch 20 ===
    train loss:  0.178347260132432
    val rand:  0.17832621932029724
    val onPol:  0.24875498480266994

=== Epoch 30 ===
    train loss:  0.1548358552902937
    val rand:  0.16783593595027924
    val onPol:  0.254762676027086

=== Epoch 39 ===
    train loss:  0.13848750345408917
    val rand:  0.16626960039138794
    val onPol:  0.26295776582426494
Training duration: 51.65 s

#####################################
performing on-policy MPC rollouts... iter  58
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -15.889821914317665
DONE TAKING  40  STEPS.
Total reward:  -104.04107127603628
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.31278169377198
DONE TAKING  40  STEPS.
Total reward:  306.7531406681354
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.9241379712486
DONE TAKING  40  STEPS.
Total reward:  -312.12262726776305
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.322643725371083
DONE TAKING  40  STEPS.
Total reward:  -828.9954079254786
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.157424820965478
DONE TAKING  40  STEPS.
Total reward:  -402.2120403832326
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.672019563813652
DONE TAKING  40  STEPS.
Total reward:  -602.7922113357384
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.324095832045444
DONE TAKING  40  STEPS.
Total reward:  -933.5244752195473
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -20.260047286314197
DONE TAKING  40  STEPS.
Total reward:  -154.60732640531916
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.689371390124244
DONE TAKING  40  STEPS.
Total reward:  -655.148277841323
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -10.832716114256778
DONE TAKING  40  STEPS.
Total reward:  -58.33462824537254
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.107486324457337
DONE TAKING  40  STEPS.
Total reward:  -683.7600900349032
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.563208711397312
DONE TAKING  40  STEPS.
Total reward:  106.65901749697528
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.67893596606708
DONE TAKING  40  STEPS.
Total reward:  -510.89866774751073
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.35097600407977
DONE TAKING  40  STEPS.
Total reward:  -398.43488131054477
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.24240784618849
DONE TAKING  40  STEPS.
Total reward:  236.67230967571658
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.12368903014317
DONE TAKING  40  STEPS.
Total reward:  -723.055979719735
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.689373477582006
DONE TAKING  40  STEPS.
Total reward:  -739.8945554708143
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -15.972066500218705
DONE TAKING  40  STEPS.
Total reward:  -426.88612249447044
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.505656471271628
DONE TAKING  40  STEPS.
Total reward:  -815.3761413371436
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.53903939894193
DONE TAKING  40  STEPS.
Total reward:  -91.73315549218921
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.84158520123144
DONE TAKING  40  STEPS.
Total reward:  215.89343195727264
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.182745932824865
DONE TAKING  40  STEPS.
Total reward:  104.21266843016343
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.97717472188124
DONE TAKING  40  STEPS.
Total reward:  -644.0647779453566
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.945777094648296
DONE TAKING  40  STEPS.
Total reward:  -1109.6743779074452
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -13.589673455318787
DONE TAKING  40  STEPS.
Total reward:  -460.97869510310477
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.75455257641269
DONE TAKING  40  STEPS.
Total reward:  -245.214886248143
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.93008098328872
DONE TAKING  40  STEPS.
Total reward:  -557.5569595326514
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.19545280024275
DONE TAKING  40  STEPS.
Total reward:  -1148.85511538534
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.537465984895103
DONE TAKING  40  STEPS.
Total reward:  -283.4264354246181
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.06865744458866
DONE TAKING  40  STEPS.
Total reward:  -66.11174743340186
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.62161855245758
DONE TAKING  40  STEPS.
Total reward:  -484.16415543656706
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.20555501273538
DONE TAKING  40  STEPS.
Total reward:  -960.1194519136625
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.91325887104194
DONE TAKING  40  STEPS.
Total reward:  -255.0919178613395
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -15.549311132568128
DONE TAKING  40  STEPS.
Total reward:  -458.71093922132974
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -14.247640531449681
DONE TAKING  40  STEPS.
Total reward:  -386.37473491336897
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.74486981970454
DONE TAKING  40  STEPS.
Total reward:  -644.2652961708609
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.09901826138499
DONE TAKING  40  STEPS.
Total reward:  -893.5218163532718
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.651459162916694
DONE TAKING  40  STEPS.
Total reward:  -810.4834012333523
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.802337881073854
DONE TAKING  40  STEPS.
Total reward:  -617.3688017382074
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.955334193260168
DONE TAKING  40  STEPS.
Total reward:  -951.1015150163621
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter58.ckpt

#####################################
Training the dynamics model..... iteration  59
#####################################

    amount of random data:  8000
    amount of onPol data:  87084
Prob rand:  19305
On pol:  84960
Prob shape:  (104265,)

=== Epoch 0 ===
    train loss:  0.3885412647806365
    val rand:  0.39426666498184204
    val onPol:  0.3002743033899201

=== Epoch 10 ===
    train loss:  0.21616069627512852
    val rand:  0.21029922366142273
    val onPol:  0.24398454775412878

=== Epoch 20 ===
    train loss:  0.1818922919592834
    val rand:  0.17552350461483002
    val onPol:  0.24497772422101763

=== Epoch 30 ===
    train loss:  0.1573135973197486
    val rand:  0.17015276849269867
    val onPol:  0.25052175919214886

=== Epoch 39 ===
    train loss:  0.14193069633885558
    val rand:  0.17198404669761658
    val onPol:  0.2597422988878356
Training duration: 52.67 s

#####################################
performing on-policy MPC rollouts... iter  59
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.00293561960799
DONE TAKING  40  STEPS.
Total reward:  -228.02821294224796
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -31.09136167470464
DONE TAKING  40  STEPS.
Total reward:  -247.20003652689917
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.848763346655375
DONE TAKING  40  STEPS.
Total reward:  95.78291797145721
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.997368390669678
DONE TAKING  40  STEPS.
Total reward:  -737.7017744841146
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.297408133108355
DONE TAKING  40  STEPS.
Total reward:  15.276427594180202
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.278401931304025
DONE TAKING  40  STEPS.
Total reward:  22.88979611644791
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -11.72230977164607
DONE TAKING  40  STEPS.
Total reward:  352.0128506423986
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -19.001824200476953
DONE TAKING  40  STEPS.
Total reward:  270.59414978740085
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.912630084023156
DONE TAKING  40  STEPS.
Total reward:  -41.62146886538805
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.800497600004903
DONE TAKING  40  STEPS.
Total reward:  -571.2019411709213
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.575454270358897
DONE TAKING  40  STEPS.
Total reward:  -965.9425606668859
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.479252516426
DONE TAKING  40  STEPS.
Total reward:  -420.510180443296
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.2247293652243
DONE TAKING  40  STEPS.
Total reward:  -883.9682888597198
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.244640516081937
DONE TAKING  40  STEPS.
Total reward:  -560.1336133354871
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -10.900589588916866
DONE TAKING  40  STEPS.
Total reward:  -0.5273561127757316
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.845889252203744
DONE TAKING  40  STEPS.
Total reward:  -438.7438004373783
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.08051963582907
DONE TAKING  40  STEPS.
Total reward:  248.25853224053554
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.939545308000053
DONE TAKING  40  STEPS.
Total reward:  209.9124193797539
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.19549267833607
DONE TAKING  40  STEPS.
Total reward:  250.88456254115593
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.321552908182618
DONE TAKING  40  STEPS.
Total reward:  -669.5201177150968
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.33318257634378
DONE TAKING  40  STEPS.
Total reward:  -704.2614254974493
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.016520929457563
DONE TAKING  40  STEPS.
Total reward:  -556.6089642233584
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.415430950795837
DONE TAKING  40  STEPS.
Total reward:  -7.190913534205276
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.306602748153798
DONE TAKING  40  STEPS.
Total reward:  -412.55149356638566
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.633055591837966
DONE TAKING  40  STEPS.
Total reward:  -37.69029565699109
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.468167851565262
DONE TAKING  40  STEPS.
Total reward:  339.72597961359173
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -24.13339412398042
DONE TAKING  40  STEPS.
Total reward:  226.56722906818894
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.058198619458334
DONE TAKING  40  STEPS.
Total reward:  74.48885935608571
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -18.053931410332122
DONE TAKING  40  STEPS.
Total reward:  -60.071284059619
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.616221409929786
DONE TAKING  40  STEPS.
Total reward:  -238.7020088232116
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.146987834716516
DONE TAKING  40  STEPS.
Total reward:  -204.08984886923642
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -13.515814527864759
DONE TAKING  40  STEPS.
Total reward:  -387.2051529573399
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.595201390004355
DONE TAKING  40  STEPS.
Total reward:  308.6133562707264
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.254001896198304
DONE TAKING  40  STEPS.
Total reward:  -134.73405612783387
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.831183336703525
DONE TAKING  40  STEPS.
Total reward:  -607.7908606566083
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.703590354310936
DONE TAKING  40  STEPS.
Total reward:  -60.00542479272224
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.650270347663092
DONE TAKING  40  STEPS.
Total reward:  -63.12583343191576
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -14.821568101315057
DONE TAKING  40  STEPS.
Total reward:  -71.87087357963928
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.05237471814602
DONE TAKING  40  STEPS.
Total reward:  -381.53100991483524
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.572692472365926
DONE TAKING  40  STEPS.
Total reward:  10.167172210170683
Time for 1 rollout: 1.05 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter59.ckpt

#####################################
Training the dynamics model..... iteration  60
#####################################

    amount of random data:  8000
    amount of onPol data:  88560
Prob rand:  19500
On pol:  86400
Prob shape:  (105900,)

=== Epoch 0 ===
    train loss:  0.38634107442735466
    val rand:  0.4001055955886841
    val onPol:  0.2964347352584203

=== Epoch 10 ===
    train loss:  0.21512233212734888
    val rand:  0.20761677622795105
    val onPol:  0.24063418640030754

=== Epoch 20 ===
    train loss:  0.18054814065255007
    val rand:  0.177712082862854
    val onPol:  0.24290864749087226

=== Epoch 30 ===
    train loss:  0.156951068240462
    val rand:  0.1650497019290924
    val onPol:  0.24955925510989296

=== Epoch 39 ===
    train loss:  0.14128470710180338
    val rand:  0.1641237735748291
    val onPol:  0.2561992820766237
Training duration: 53.13 s

#####################################
performing on-policy MPC rollouts... iter  60
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.578449455729583
DONE TAKING  40  STEPS.
Total reward:  -101.88265074281266
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.369303948417524
DONE TAKING  40  STEPS.
Total reward:  347.14660544532296
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.413366497017737
DONE TAKING  40  STEPS.
Total reward:  -528.1072517239974
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.313068480098178
DONE TAKING  40  STEPS.
Total reward:  215.52011869359407
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -15.59661661774122
DONE TAKING  40  STEPS.
Total reward:  69.69511439371183
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -16.03252750045389
DONE TAKING  40  STEPS.
Total reward:  -435.79294557628407
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -10.634539791733335
DONE TAKING  40  STEPS.
Total reward:  321.35036281406656
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.641257371440616
DONE TAKING  40  STEPS.
Total reward:  -673.4494883530705
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.657497905756866
DONE TAKING  40  STEPS.
Total reward:  85.45982336465903
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.420499506089524
DONE TAKING  40  STEPS.
Total reward:  -805.9131568299525
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.820602021125698
DONE TAKING  40  STEPS.
Total reward:  -634.9221428635177
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.055335398609284
DONE TAKING  40  STEPS.
Total reward:  114.58104623293069
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.922897366257303
DONE TAKING  40  STEPS.
Total reward:  -437.389648561168
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.427642972056873
DONE TAKING  40  STEPS.
Total reward:  192.83012841870146
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.912380033942714
DONE TAKING  40  STEPS.
Total reward:  -317.6859641448373
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.294978167699533
DONE TAKING  40  STEPS.
Total reward:  -71.24610624333954
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -27.588153631555812
DONE TAKING  40  STEPS.
Total reward:  25.41731263172494
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.354298301130974
DONE TAKING  40  STEPS.
Total reward:  -307.2839521381401
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -15.84014426760416
DONE TAKING  40  STEPS.
Total reward:  267.60400349594863
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.754596106619605
DONE TAKING  40  STEPS.
Total reward:  -364.56514157698
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.428937130747293
DONE TAKING  40  STEPS.
Total reward:  -812.2285600046373
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.11881209237298
DONE TAKING  40  STEPS.
Total reward:  -493.0555043796785
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.688105992931078
DONE TAKING  40  STEPS.
Total reward:  -409.0944146843315
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -11.810260621845167
DONE TAKING  40  STEPS.
Total reward:  273.1403568656695
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.168590024076078
DONE TAKING  40  STEPS.
Total reward:  -508.4505325773678
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.4546320845545
DONE TAKING  40  STEPS.
Total reward:  400.02191226751813
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.83522179655404
DONE TAKING  40  STEPS.
Total reward:  125.96987476607558
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.599216377062845
DONE TAKING  40  STEPS.
Total reward:  30.29211344104058
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.040599342062528
DONE TAKING  40  STEPS.
Total reward:  117.03875816061654
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.67557454779066
DONE TAKING  40  STEPS.
Total reward:  74.09370609767717
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.295492434622577
DONE TAKING  40  STEPS.
Total reward:  218.16105161931756
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.7224478168706
DONE TAKING  40  STEPS.
Total reward:  -401.141943056147
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.131464586694932
DONE TAKING  40  STEPS.
Total reward:  -78.72169789369755
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -15.950900952952932
DONE TAKING  40  STEPS.
Total reward:  -208.19076351800823
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.58050919244215
DONE TAKING  40  STEPS.
Total reward:  -364.4624900097012
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.965272320367436
DONE TAKING  40  STEPS.
Total reward:  -78.2234198638459
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.33126288016085
DONE TAKING  40  STEPS.
Total reward:  -258.8893907657648
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.684308631773714
DONE TAKING  40  STEPS.
Total reward:  -802.1048784915338
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.03022589334159
DONE TAKING  40  STEPS.
Total reward:  -538.1645459247358
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.027235448593718
DONE TAKING  40  STEPS.
Total reward:  -540.4009268570928
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter60.ckpt

#####################################
Training the dynamics model..... iteration  61
#####################################

    amount of random data:  8000
    amount of onPol data:  90036
Prob rand:  19695
On pol:  87840
Prob shape:  (107535,)

=== Epoch 0 ===
    train loss:  0.38668609644685475
    val rand:  0.3981732726097107
    val onPol:  0.2982365677231236

=== Epoch 10 ===
    train loss:  0.21780207384200323
    val rand:  0.21719680726528168
    val onPol:  0.24153182694786474

=== Epoch 20 ===
    train loss:  0.18190579371792928
    val rand:  0.17733752727508545
    val onPol:  0.24092680058981242

=== Epoch 30 ===
    train loss:  0.15969074474913733
    val rand:  0.16582058370113373
    val onPol:  0.24667879233234807

=== Epoch 39 ===
    train loss:  0.14465586755956922
    val rand:  0.16928410530090332
    val onPol:  0.25404201604818044
Training duration: 54.12 s

#####################################
performing on-policy MPC rollouts... iter  61
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.077415951522482
DONE TAKING  40  STEPS.
Total reward:  -678.0608518783672
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.15431739705045
DONE TAKING  40  STEPS.
Total reward:  -293.1170125329904
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.00497947553562
DONE TAKING  40  STEPS.
Total reward:  -837.8608385201662
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.576681683245916
DONE TAKING  40  STEPS.
Total reward:  -580.2954596276958
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.634901813650593
DONE TAKING  40  STEPS.
Total reward:  -656.1705961251243
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.774904112423645
DONE TAKING  40  STEPS.
Total reward:  -628.0386381496335
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.40823756953429
DONE TAKING  40  STEPS.
Total reward:  -602.4022201832685
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.83885289709761
DONE TAKING  40  STEPS.
Total reward:  -485.00822367875435
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -10.388417990153885
DONE TAKING  40  STEPS.
Total reward:  552.110689490017
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -23.21236067741998
DONE TAKING  40  STEPS.
Total reward:  48.87762137698853
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -13.21994425949342
DONE TAKING  40  STEPS.
Total reward:  192.4781139763041
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.372919604923432
DONE TAKING  40  STEPS.
Total reward:  -490.427872988503
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.51320319746774
DONE TAKING  40  STEPS.
Total reward:  -861.5328628345508
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.25563187944808
DONE TAKING  40  STEPS.
Total reward:  -60.833210423226994
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.669592695480553
DONE TAKING  40  STEPS.
Total reward:  -507.5765248959918
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.92053478734949
DONE TAKING  40  STEPS.
Total reward:  -964.936959785531
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.98240871057957
DONE TAKING  40  STEPS.
Total reward:  -845.5734477420365
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -14.350919195671965
DONE TAKING  40  STEPS.
Total reward:  -549.7086990588634
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.673413870254556
DONE TAKING  40  STEPS.
Total reward:  -483.70393963408554
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.370152784614582
DONE TAKING  40  STEPS.
Total reward:  -399.6991378458511
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.815871670359908
DONE TAKING  40  STEPS.
Total reward:  -976.7111973349262
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.109232339436204
DONE TAKING  40  STEPS.
Total reward:  -87.39042670614673
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -16.547065882630545
DONE TAKING  40  STEPS.
Total reward:  -534.9970098476787
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.653106815883675
DONE TAKING  40  STEPS.
Total reward:  -89.54838327480444
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.85033648294886
DONE TAKING  40  STEPS.
Total reward:  -496.0955937326424
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.256515443512257
DONE TAKING  40  STEPS.
Total reward:  -643.7071559262359
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -11.429807069513288
DONE TAKING  40  STEPS.
Total reward:  431.14954645803897
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -9.043640991896192
DONE TAKING  40  STEPS.
Total reward:  328.68301909633607
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.23820699522996
DONE TAKING  40  STEPS.
Total reward:  -115.49867326487558
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -12.736569194541282
DONE TAKING  40  STEPS.
Total reward:  185.633522253485
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.143144367908484
DONE TAKING  40  STEPS.
Total reward:  -497.1510627061203
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.410626290899753
DONE TAKING  40  STEPS.
Total reward:  89.80885070584966
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.532026726573076
DONE TAKING  40  STEPS.
Total reward:  -193.11947835949383
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -13.603918562179993
DONE TAKING  40  STEPS.
Total reward:  68.60752843586832
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.914806016823825
DONE TAKING  40  STEPS.
Total reward:  -817.9959904002488
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -11.661360941941751
DONE TAKING  40  STEPS.
Total reward:  225.59718413371954
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.457831816314556
DONE TAKING  40  STEPS.
Total reward:  -503.1293749458597
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -19.785874200865834
DONE TAKING  40  STEPS.
Total reward:  -319.10119619010084
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -10.199286430194906
DONE TAKING  40  STEPS.
Total reward:  -236.03967758570414
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.012340470315653
DONE TAKING  40  STEPS.
Total reward:  -633.7822788710059
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter61.ckpt

#####################################
Training the dynamics model..... iteration  62
#####################################

    amount of random data:  8000
    amount of onPol data:  91512
Prob rand:  19890
On pol:  89280
Prob shape:  (109170,)

=== Epoch 0 ===
    train loss:  0.3830575295177424
    val rand:  0.3977073132991791
    val onPol:  0.29811108504471023

=== Epoch 10 ===
    train loss:  0.21582046549924663
    val rand:  0.20559564232826233
    val onPol:  0.2423107075063806

=== Epoch 20 ===
    train loss:  0.18213679029348312
    val rand:  0.1817835569381714
    val onPol:  0.24314954406336733

=== Epoch 30 ===
    train loss:  0.1575673801798216
    val rand:  0.17274504899978638
    val onPol:  0.2507883278947127

=== Epoch 39 ===
    train loss:  0.14292233503760307
    val rand:  0.16752398014068604
    val onPol:  0.25722995478855937
Training duration: 54.87 s

#####################################
performing on-policy MPC rollouts... iter  62
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -15.461873852460597
DONE TAKING  40  STEPS.
Total reward:  -463.7449256183937
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.387823035405198
DONE TAKING  40  STEPS.
Total reward:  -478.88865927711123
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.879838875357397
DONE TAKING  40  STEPS.
Total reward:  -331.85148658333407
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.20320742759737
DONE TAKING  40  STEPS.
Total reward:  -296.9062534468696
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.930844964337858
DONE TAKING  40  STEPS.
Total reward:  -32.84063700196613
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -9.109350761489669
DONE TAKING  40  STEPS.
Total reward:  15.581444429317916
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.077463705639836
DONE TAKING  40  STEPS.
Total reward:  -804.3323335559634
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.542761358344045
DONE TAKING  40  STEPS.
Total reward:  -721.8190771972743
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.568272086818993
DONE TAKING  40  STEPS.
Total reward:  -355.7807782851005
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -17.104266948377358
DONE TAKING  40  STEPS.
Total reward:  386.71654445236743
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.796454439272154
DONE TAKING  40  STEPS.
Total reward:  -793.3044133877788
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -14.886306966143694
DONE TAKING  40  STEPS.
Total reward:  -307.0709674833035
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -27.406110537516916
DONE TAKING  40  STEPS.
Total reward:  -704.8455294758635
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.78198696871257
DONE TAKING  40  STEPS.
Total reward:  -1023.132628274768
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -14.93546934975078
DONE TAKING  40  STEPS.
Total reward:  345.16454024743484
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.39693923870562
DONE TAKING  40  STEPS.
Total reward:  -744.2785590673088
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.217598987092497
DONE TAKING  40  STEPS.
Total reward:  -182.99533723126993
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.5589892958699
DONE TAKING  40  STEPS.
Total reward:  -762.7731351564678
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.37796788458126
DONE TAKING  40  STEPS.
Total reward:  -783.9454834903936
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.738654866170506
DONE TAKING  40  STEPS.
Total reward:  -295.5023532731864
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.778509577575246
DONE TAKING  40  STEPS.
Total reward:  -747.603023491466
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.198555594398535
DONE TAKING  40  STEPS.
Total reward:  -936.3935950404539
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.919904852381144
DONE TAKING  40  STEPS.
Total reward:  -523.8596662705994
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.668782436190035
DONE TAKING  40  STEPS.
Total reward:  -668.8844100259075
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.737564132559914
DONE TAKING  40  STEPS.
Total reward:  -781.6218039075873
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.404998847396584
DONE TAKING  40  STEPS.
Total reward:  -1018.4153126352484
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.59008468646348
DONE TAKING  40  STEPS.
Total reward:  -52.6913671284651
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.943881435665855
DONE TAKING  40  STEPS.
Total reward:  -602.3409840689327
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.96469305011228
DONE TAKING  40  STEPS.
Total reward:  -1087.4544431313632
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.65478665878107
DONE TAKING  40  STEPS.
Total reward:  -868.3634159210372
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.36104026019421
DONE TAKING  40  STEPS.
Total reward:  -880.1951931130639
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.3987739472217
DONE TAKING  40  STEPS.
Total reward:  5.707933913170036
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.097744675028224
DONE TAKING  40  STEPS.
Total reward:  -577.580620973163
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.59266629950926
DONE TAKING  40  STEPS.
Total reward:  -845.3391217014765
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.903241971917993
DONE TAKING  40  STEPS.
Total reward:  -169.34505479474151
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.945623804095842
DONE TAKING  40  STEPS.
Total reward:  370.3513620437462
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -15.440836608416383
DONE TAKING  40  STEPS.
Total reward:  -86.58818017655099
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.15698527739963
DONE TAKING  40  STEPS.
Total reward:  -252.6226896382618
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -11.480175196503613
DONE TAKING  40  STEPS.
Total reward:  -113.15470002647072
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.905867326112208
DONE TAKING  40  STEPS.
Total reward:  -390.9852631390922
Time for 1 rollout: 1.09 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter62.ckpt

#####################################
Training the dynamics model..... iteration  63
#####################################

    amount of random data:  8000
    amount of onPol data:  92988
Prob rand:  20085
On pol:  90720
Prob shape:  (110805,)

=== Epoch 0 ===
    train loss:  0.3850824162364006
    val rand:  0.39585626125335693
    val onPol:  0.29771001793836294

=== Epoch 10 ===
    train loss:  0.21753615989453262
    val rand:  0.20822791755199432
    val onPol:  0.24158936895822225

=== Epoch 20 ===
    train loss:  0.18098495072788662
    val rand:  0.1744610071182251
    val onPol:  0.24041737067072014

=== Epoch 30 ===
    train loss:  0.1587638212022958
    val rand:  0.16718678176403046
    val onPol:  0.24779933377316124

=== Epoch 39 ===
    train loss:  0.1432199972095313
    val rand:  0.16494928300380707
    val onPol:  0.25548060316788523
Training duration: 55.63 s

#####################################
performing on-policy MPC rollouts... iter  63
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -9.993877445644214
DONE TAKING  40  STEPS.
Total reward:  199.90603062954295
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.813967743723946
DONE TAKING  40  STEPS.
Total reward:  -630.4618932904586
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.936213328023005
DONE TAKING  40  STEPS.
Total reward:  142.1446046108148
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.397194893087175
DONE TAKING  40  STEPS.
Total reward:  221.51651007125594
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.857075281703427
DONE TAKING  40  STEPS.
Total reward:  -393.7609251828734
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.427169213580292
DONE TAKING  40  STEPS.
Total reward:  -118.8641585960014
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.497066535017815
DONE TAKING  40  STEPS.
Total reward:  -167.3058861903009
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -31.297398197007674
DONE TAKING  40  STEPS.
Total reward:  -240.5289261051832
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.826080315569317
DONE TAKING  40  STEPS.
Total reward:  -662.752327133846
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.512098321787274
DONE TAKING  40  STEPS.
Total reward:  -604.446709604424
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.672298698023994
DONE TAKING  40  STEPS.
Total reward:  -467.07809415700507
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.529940177570644
DONE TAKING  40  STEPS.
Total reward:  -853.8017526416132
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.344514121131787
DONE TAKING  40  STEPS.
Total reward:  -45.38798264029134
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -26.06466667760111
DONE TAKING  40  STEPS.
Total reward:  -414.4456714268576
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.41498908149254
DONE TAKING  40  STEPS.
Total reward:  -432.7671835528923
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.915805762022693
DONE TAKING  40  STEPS.
Total reward:  -49.154154736573076
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.309717988947682
DONE TAKING  40  STEPS.
Total reward:  -483.7557013914999
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.00949860314147
DONE TAKING  40  STEPS.
Total reward:  -701.855776397571
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.2073799462906
DONE TAKING  40  STEPS.
Total reward:  -346.8969890747879
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.027691723085184
DONE TAKING  40  STEPS.
Total reward:  -195.11762312986065
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.975314881097473
DONE TAKING  40  STEPS.
Total reward:  -446.10004516033035
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.084712334433505
DONE TAKING  40  STEPS.
Total reward:  -735.4914231570477
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.929903023131654
DONE TAKING  40  STEPS.
Total reward:  -592.9841516471965
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.03706034260684
DONE TAKING  40  STEPS.
Total reward:  132.67084784590574
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.744412681965482
DONE TAKING  40  STEPS.
Total reward:  -439.92806203588253
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.40324238136693
DONE TAKING  40  STEPS.
Total reward:  -309.4251449112442
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.014477567590234
DONE TAKING  40  STEPS.
Total reward:  190.85693823018278
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.786274222231093
DONE TAKING  40  STEPS.
Total reward:  124.75056264719277
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.484951794367024
DONE TAKING  40  STEPS.
Total reward:  -560.1516174393718
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.154115448077167
DONE TAKING  40  STEPS.
Total reward:  -508.0875624194206
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.262959866745813
DONE TAKING  40  STEPS.
Total reward:  115.58931250428834
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.71171953651293
DONE TAKING  40  STEPS.
Total reward:  -193.78554012818407
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.6114600568838
DONE TAKING  40  STEPS.
Total reward:  -123.61666524006377
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.427429045494435
DONE TAKING  40  STEPS.
Total reward:  -296.08668867625346
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.656992234861814
DONE TAKING  40  STEPS.
Total reward:  290.373582469396
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.55186003991707
DONE TAKING  40  STEPS.
Total reward:  -810.7321234475681
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.098882546268847
DONE TAKING  40  STEPS.
Total reward:  -461.22753604795173
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.696733041247576
DONE TAKING  40  STEPS.
Total reward:  -646.0322336084015
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.142197035633355
DONE TAKING  40  STEPS.
Total reward:  -426.50320235584223
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.80401979594821
DONE TAKING  40  STEPS.
Total reward:  -446.47021904270673
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter63.ckpt

#####################################
Training the dynamics model..... iteration  64
#####################################

    amount of random data:  8000
    amount of onPol data:  94464
Prob rand:  20280
On pol:  92160
Prob shape:  (112440,)

=== Epoch 0 ===
    train loss:  0.3846648780450429
    val rand:  0.40326398611068726
    val onPol:  0.2980834968388081

=== Epoch 10 ===
    train loss:  0.21683699960850145
    val rand:  0.21436361968517303
    val onPol:  0.2406441517174244

=== Epoch 20 ===
    train loss:  0.1839432382284234
    val rand:  0.1770901381969452
    val onPol:  0.24109288454055786

=== Epoch 30 ===
    train loss:  0.16078412110947038
    val rand:  0.17228174209594727
    val onPol:  0.24722848758101462

=== Epoch 39 ===
    train loss:  0.1454207909433809
    val rand:  0.16987058520317078
    val onPol:  0.2546444728970528
Training duration: 56.50 s

#####################################
performing on-policy MPC rollouts... iter  64
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.683661545700758
DONE TAKING  40  STEPS.
Total reward:  -647.6026733364976
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -31.063272383528634
DONE TAKING  40  STEPS.
Total reward:  -637.3213670106626
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.10717268888376
DONE TAKING  40  STEPS.
Total reward:  399.683849266324
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.937381070936297
DONE TAKING  40  STEPS.
Total reward:  6.3322662441089665
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.815265844045875
DONE TAKING  40  STEPS.
Total reward:  -485.52831937226404
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.289779720494003
DONE TAKING  40  STEPS.
Total reward:  352.7373851059824
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.139179108269687
DONE TAKING  40  STEPS.
Total reward:  -785.7318340903497
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -14.0449886445946
DONE TAKING  40  STEPS.
Total reward:  -408.59610328339073
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.088107829926628
DONE TAKING  40  STEPS.
Total reward:  -139.7107081623469
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.59550157434604
DONE TAKING  40  STEPS.
Total reward:  -115.08569232621092
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.455569920576846
DONE TAKING  40  STEPS.
Total reward:  403.5197007735734
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.988515598391686
DONE TAKING  40  STEPS.
Total reward:  -458.583590012994
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.248029098277044
DONE TAKING  40  STEPS.
Total reward:  262.997522757147
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.60286871938072
DONE TAKING  40  STEPS.
Total reward:  -279.8869209369181
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.452995045429304
DONE TAKING  40  STEPS.
Total reward:  -661.4149702323953
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.38680545453246
DONE TAKING  40  STEPS.
Total reward:  267.23866589027546
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.54835302625918
DONE TAKING  40  STEPS.
Total reward:  227.4430940711242
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.044643439882673
DONE TAKING  40  STEPS.
Total reward:  -216.59110182535292
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -17.169144755129256
DONE TAKING  40  STEPS.
Total reward:  -139.31878526516593
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.059365213291898
DONE TAKING  40  STEPS.
Total reward:  -835.8349786541252
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -15.549229757581175
DONE TAKING  40  STEPS.
Total reward:  -317.50660046141144
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.579216625807753
DONE TAKING  40  STEPS.
Total reward:  -235.04567728392325
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.142757630376273
DONE TAKING  40  STEPS.
Total reward:  -570.5268104850619
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -31.199695980972347
DONE TAKING  40  STEPS.
Total reward:  -694.809767637403
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -31.098619683397356
DONE TAKING  40  STEPS.
Total reward:  -758.2517976798315
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.148380380237864
DONE TAKING  40  STEPS.
Total reward:  -566.3655135585295
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.74764263856761
DONE TAKING  40  STEPS.
Total reward:  -685.1387662993919
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.393872157929607
DONE TAKING  40  STEPS.
Total reward:  -596.1955267021843
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.511494334542583
DONE TAKING  40  STEPS.
Total reward:  129.55471694255894
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.285365058690747
DONE TAKING  40  STEPS.
Total reward:  312.92326816283116
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.352642298069757
DONE TAKING  40  STEPS.
Total reward:  -89.48726618557166
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.471188062900865
DONE TAKING  40  STEPS.
Total reward:  65.37209444547474
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.887860007322463
DONE TAKING  40  STEPS.
Total reward:  -548.4424894786544
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.603146228431417
DONE TAKING  40  STEPS.
Total reward:  104.82077662158514
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.071583861890524
DONE TAKING  40  STEPS.
Total reward:  -69.98757183717099
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.34350686796025
DONE TAKING  40  STEPS.
Total reward:  -98.34003040096975
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.818790658471485
DONE TAKING  40  STEPS.
Total reward:  -81.10180551774899
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -12.342646790873752
DONE TAKING  40  STEPS.
Total reward:  -274.45239562702216
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.33343400609287
DONE TAKING  40  STEPS.
Total reward:  -779.3820693272148
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.32692238963522
DONE TAKING  40  STEPS.
Total reward:  -550.2288786104299
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter64.ckpt

#####################################
Training the dynamics model..... iteration  65
#####################################

    amount of random data:  8000
    amount of onPol data:  95940
Prob rand:  20475
On pol:  93600
Prob shape:  (114075,)

=== Epoch 0 ===
    train loss:  0.3836967369189134
    val rand:  0.3898589611053467
    val onPol:  0.2956455200910568

=== Epoch 10 ===
    train loss:  0.2175878000420493
    val rand:  0.210554838180542
    val onPol:  0.23994736298918723

=== Epoch 20 ===
    train loss:  0.18267797349809525
    val rand:  0.17427359521389008
    val onPol:  0.24021478295326232

=== Epoch 30 ===
    train loss:  0.15973883739731334
    val rand:  0.16665998101234436
    val onPol:  0.2467498317360878

=== Epoch 39 ===
    train loss:  0.14541568640653077
    val rand:  0.16813215613365173
    val onPol:  0.2528465613722801
Training duration: 56.10 s

#####################################
performing on-policy MPC rollouts... iter  65
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.650667545459402
DONE TAKING  40  STEPS.
Total reward:  -713.3153922638876
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.933417514709312
DONE TAKING  40  STEPS.
Total reward:  89.16905584983965
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.29855327236664
DONE TAKING  40  STEPS.
Total reward:  -312.3304674966097
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.51541496208322
DONE TAKING  40  STEPS.
Total reward:  -651.3655259199851
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.46611369406736
DONE TAKING  40  STEPS.
Total reward:  217.57483059741193
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.710050074874353
DONE TAKING  40  STEPS.
Total reward:  -629.5778124317915
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.645581447144487
DONE TAKING  40  STEPS.
Total reward:  -714.2305095311629
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -31.064341819181163
DONE TAKING  40  STEPS.
Total reward:  191.8673884154552
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.493149544040882
DONE TAKING  40  STEPS.
Total reward:  -155.88257289404302
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.428398686799106
DONE TAKING  40  STEPS.
Total reward:  -315.6410288366997
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.493152243145037
DONE TAKING  40  STEPS.
Total reward:  -493.7764330468689
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.437202984293073
DONE TAKING  40  STEPS.
Total reward:  -949.4704126732448
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.983695407836723
DONE TAKING  40  STEPS.
Total reward:  -402.1781146644011
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -13.51805535763085
DONE TAKING  40  STEPS.
Total reward:  -25.225712959907085
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.307337449628925
DONE TAKING  40  STEPS.
Total reward:  -892.0867901859287
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -28.796961281986153
DONE TAKING  40  STEPS.
Total reward:  -971.2764861503512
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.858951464028817
DONE TAKING  40  STEPS.
Total reward:  -557.1351143249573
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.654971656207437
DONE TAKING  40  STEPS.
Total reward:  -124.67042723716602
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.58710827947087
DONE TAKING  40  STEPS.
Total reward:  -656.4853310068787
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.729631353009292
DONE TAKING  40  STEPS.
Total reward:  200.6054919252428
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.74469570944047
DONE TAKING  40  STEPS.
Total reward:  -92.78543844053144
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.451883084096483
DONE TAKING  40  STEPS.
Total reward:  -59.228248222485284
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.10053095589617
DONE TAKING  40  STEPS.
Total reward:  -628.7777333880592
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.92386654866315
DONE TAKING  40  STEPS.
Total reward:  -849.8791103942265
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.210766375101652
DONE TAKING  40  STEPS.
Total reward:  -302.5562120250271
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.98660224717718
DONE TAKING  40  STEPS.
Total reward:  -475.5610007365835
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.569251642822145
DONE TAKING  40  STEPS.
Total reward:  -541.6987692514208
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.917466876379223
DONE TAKING  40  STEPS.
Total reward:  -348.77500071356843
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.522726885841063
DONE TAKING  40  STEPS.
Total reward:  -783.1671336800014
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.154527314122348
DONE TAKING  40  STEPS.
Total reward:  -410.19921490786396
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -15.148540242192546
DONE TAKING  40  STEPS.
Total reward:  -308.3526031127046
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -31.23708320943129
DONE TAKING  40  STEPS.
Total reward:  -662.0493313881296
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.110393092873952
DONE TAKING  40  STEPS.
Total reward:  -123.77934146865985
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.567487698042473
DONE TAKING  40  STEPS.
Total reward:  -352.1798525546886
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.90385308927971
DONE TAKING  40  STEPS.
Total reward:  -385.43157256893153
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.463648077655968
DONE TAKING  40  STEPS.
Total reward:  184.19237961007667
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.504136667286144
DONE TAKING  40  STEPS.
Total reward:  -469.4558454712924
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.729660680066573
DONE TAKING  40  STEPS.
Total reward:  -267.93357996276023
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.04067493224018
DONE TAKING  40  STEPS.
Total reward:  -594.1236837236514
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -12.314249720948233
DONE TAKING  40  STEPS.
Total reward:  356.86607098761743
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter65.ckpt

#####################################
Training the dynamics model..... iteration  66
#####################################

    amount of random data:  8000
    amount of onPol data:  97416
Prob rand:  20670
On pol:  95040
Prob shape:  (115710,)

=== Epoch 0 ===
    train loss:  0.3801699478096432
    val rand:  0.3904431462287903
    val onPol:  0.2948389083147049

=== Epoch 10 ===
    train loss:  0.21597742478052775
    val rand:  0.20549248158931732
    val onPol:  0.23893596231937408

=== Epoch 20 ===
    train loss:  0.18180711925029755
    val rand:  0.17843589186668396
    val onPol:  0.24045152887701987

=== Epoch 30 ===
    train loss:  0.1584705369340049
    val rand:  0.1702868938446045
    val onPol:  0.2467495769262314

=== Epoch 39 ===
    train loss:  0.1429991955889596
    val rand:  0.16674494743347168
    val onPol:  0.25308739468455316
Training duration: 56.99 s

#####################################
performing on-policy MPC rollouts... iter  66
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.543320641832057
DONE TAKING  40  STEPS.
Total reward:  -480.72636452468294
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.335652263266155
DONE TAKING  40  STEPS.
Total reward:  -464.42090363929526
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.429371492076346
DONE TAKING  40  STEPS.
Total reward:  -477.43787623408394
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.185585948618503
DONE TAKING  40  STEPS.
Total reward:  -188.03986938651485
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -10.758162216823639
DONE TAKING  40  STEPS.
Total reward:  -186.2769922332431
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.476888910570924
DONE TAKING  40  STEPS.
Total reward:  194.83817485844304
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.334524304200173
DONE TAKING  40  STEPS.
Total reward:  -653.8121228633875
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.12064403225733
DONE TAKING  40  STEPS.
Total reward:  -72.2355162737953
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.698493182045713
DONE TAKING  40  STEPS.
Total reward:  -468.11192766589863
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.21207348396033
DONE TAKING  40  STEPS.
Total reward:  -268.27479052248856
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.524864806465544
DONE TAKING  40  STEPS.
Total reward:  -50.70012916393595
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -17.82762877002326
DONE TAKING  40  STEPS.
Total reward:  315.6942719817883
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -29.087817114254953
DONE TAKING  40  STEPS.
Total reward:  -594.8834957257826
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.44944076429995
DONE TAKING  40  STEPS.
Total reward:  -616.7759098863964
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.334208546111586
DONE TAKING  40  STEPS.
Total reward:  41.733670575178834
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.495766912108483
DONE TAKING  40  STEPS.
Total reward:  -509.6419360131805
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.923981232977106
DONE TAKING  40  STEPS.
Total reward:  43.420401183695255
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -14.796958161507717
DONE TAKING  40  STEPS.
Total reward:  -100.90457107227203
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.852080639029456
DONE TAKING  40  STEPS.
Total reward:  334.97942751559395
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.369902703466153
DONE TAKING  40  STEPS.
Total reward:  211.07142571127514
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.1882447266547
DONE TAKING  40  STEPS.
Total reward:  -640.7810819449489
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.338147832327603
DONE TAKING  40  STEPS.
Total reward:  -486.5784156199954
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.997646455023848
DONE TAKING  40  STEPS.
Total reward:  168.90507417859985
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.97322381474953
DONE TAKING  40  STEPS.
Total reward:  -387.84938983836014
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -11.674341100401282
DONE TAKING  40  STEPS.
Total reward:  -376.3286811594024
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.502460535256652
DONE TAKING  40  STEPS.
Total reward:  -486.4078631396928
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.03088125551724
DONE TAKING  40  STEPS.
Total reward:  -548.8829931958567
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.252801369111282
DONE TAKING  40  STEPS.
Total reward:  -445.6148611179516
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -16.62199768987158
DONE TAKING  40  STEPS.
Total reward:  -20.25099174957644
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.99140947190424
DONE TAKING  40  STEPS.
Total reward:  116.27203684767912
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -15.22971473052609
DONE TAKING  40  STEPS.
Total reward:  45.132938821137266
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.941112108678137
DONE TAKING  40  STEPS.
Total reward:  -617.3794440207871
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -14.793588309266179
DONE TAKING  40  STEPS.
Total reward:  -403.5427102889476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.236380523403012
DONE TAKING  40  STEPS.
Total reward:  300.0432099776998
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.47831569396551
DONE TAKING  40  STEPS.
Total reward:  -359.44217536287886
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.422991312992632
DONE TAKING  40  STEPS.
Total reward:  -265.14540029271586
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.560928009143243
DONE TAKING  40  STEPS.
Total reward:  -278.6446746985735
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.166397893790407
DONE TAKING  40  STEPS.
Total reward:  73.80029875565049
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.83822257307766
DONE TAKING  40  STEPS.
Total reward:  -912.399562520014
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.66066009095019
DONE TAKING  40  STEPS.
Total reward:  -560.2603701976103
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter66.ckpt

#####################################
Training the dynamics model..... iteration  67
#####################################

    amount of random data:  8000
    amount of onPol data:  98892
Prob rand:  20865
On pol:  96480
Prob shape:  (117345,)

=== Epoch 0 ===
    train loss:  0.38022223596489585
    val rand:  0.39436060190200806
    val onPol:  0.29235792756080625

=== Epoch 10 ===
    train loss:  0.21801393436812938
    val rand:  0.21719768643379211
    val onPol:  0.23721900284290315

=== Epoch 20 ===
    train loss:  0.18351475595126507
    val rand:  0.18310050666332245
    val onPol:  0.23781006038188934

=== Epoch 30 ===
    train loss:  0.16101757681005385
    val rand:  0.1694573163986206
    val onPol:  0.2443680979311466

=== Epoch 39 ===
    train loss:  0.14567257184128574
    val rand:  0.16481837630271912
    val onPol:  0.250434809923172
Training duration: 59.26 s

#####################################
performing on-policy MPC rollouts... iter  67
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.85404374499819
DONE TAKING  40  STEPS.
Total reward:  -316.04738975767697
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -16.241446950608385
DONE TAKING  40  STEPS.
Total reward:  -342.02558218898713
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -30.723985553521537
DONE TAKING  40  STEPS.
Total reward:  -600.5185863159617
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.000066314681526
DONE TAKING  40  STEPS.
Total reward:  -442.5561228543766
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -13.23672189895564
DONE TAKING  40  STEPS.
Total reward:  388.195440914084
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.170471857103085
DONE TAKING  40  STEPS.
Total reward:  -316.97958001253005
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -11.438203855445009
DONE TAKING  40  STEPS.
Total reward:  365.5300313155222
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.88102371724805
DONE TAKING  40  STEPS.
Total reward:  -207.83029945585722
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -29.664933294761493
DONE TAKING  40  STEPS.
Total reward:  -62.051170306830336
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.60045890867368
DONE TAKING  40  STEPS.
Total reward:  -436.2764039052214
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.018466152305304
DONE TAKING  40  STEPS.
Total reward:  -717.8819168241035
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.651808138174804
DONE TAKING  40  STEPS.
Total reward:  243.60127685242392
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.906683929742645
DONE TAKING  40  STEPS.
Total reward:  -316.32497384987994
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.31868710077619
DONE TAKING  40  STEPS.
Total reward:  -244.32428691658887
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.55139094938746
DONE TAKING  40  STEPS.
Total reward:  33.35766245546964
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.003290446523575
DONE TAKING  40  STEPS.
Total reward:  -352.9248349844677
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.906152584907684
DONE TAKING  40  STEPS.
Total reward:  -409.0753294440681
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.209905305311572
DONE TAKING  40  STEPS.
Total reward:  -708.5498931373343
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -12.272181763984815
DONE TAKING  40  STEPS.
Total reward:  43.95938593046371
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.21467786806238
DONE TAKING  40  STEPS.
Total reward:  -563.0410842033156
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.762497773854644
DONE TAKING  40  STEPS.
Total reward:  -274.2966029605076
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.37850727341489
DONE TAKING  40  STEPS.
Total reward:  -608.7624211987552
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -15.33419273722963
DONE TAKING  40  STEPS.
Total reward:  131.56794751038845
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -15.991627794053239
DONE TAKING  40  STEPS.
Total reward:  -148.99664597560343
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.120140917924054
DONE TAKING  40  STEPS.
Total reward:  -517.3743480667792
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.80190217057733
DONE TAKING  40  STEPS.
Total reward:  -134.69569969758453
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.75570926663323
DONE TAKING  40  STEPS.
Total reward:  433.1065407094591
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.021035337007994
DONE TAKING  40  STEPS.
Total reward:  -668.0085899872025
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.93643480226395
DONE TAKING  40  STEPS.
Total reward:  -576.5165043813653
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.770710596144127
DONE TAKING  40  STEPS.
Total reward:  -486.72791727785284
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.86679896025607
DONE TAKING  40  STEPS.
Total reward:  -461.11685766808023
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.95513635088443
DONE TAKING  40  STEPS.
Total reward:  -511.74693302222556
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.798738022091374
DONE TAKING  40  STEPS.
Total reward:  -383.16348074467805
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.63455021818215
DONE TAKING  40  STEPS.
Total reward:  -194.79045643185273
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -12.074529817402592
DONE TAKING  40  STEPS.
Total reward:  -272.23792095486573
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.000507423660046
DONE TAKING  40  STEPS.
Total reward:  -173.72536009154828
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.73779845052955
DONE TAKING  40  STEPS.
Total reward:  -753.614764372589
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.295259904984938
DONE TAKING  40  STEPS.
Total reward:  125.82179933482207
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -25.26278503606783
DONE TAKING  40  STEPS.
Total reward:  -573.5211964889219
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.50231003035336
DONE TAKING  40  STEPS.
Total reward:  -105.50293416820526
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter67.ckpt

#####################################
Training the dynamics model..... iteration  68
#####################################

    amount of random data:  8000
    amount of onPol data:  100368
Prob rand:  21060
On pol:  97920
Prob shape:  (118980,)

=== Epoch 0 ===
    train loss:  0.3806430784792736
    val rand:  0.3977569043636322
    val onPol:  0.29498668298834846

=== Epoch 10 ===
    train loss:  0.21821785814546305
    val rand:  0.2132105678319931
    val onPol:  0.2396505560193743

=== Epoch 20 ===
    train loss:  0.18418521498297824
    val rand:  0.17957305908203125
    val onPol:  0.23851869929404484

=== Epoch 30 ===
    train loss:  0.16061692665620098
    val rand:  0.17484354972839355
    val onPol:  0.2450800012974512

=== Epoch 39 ===
    train loss:  0.1462605564116404
    val rand:  0.16725435853004456
    val onPol:  0.25127420397031874
Training duration: 60.14 s

#####################################
performing on-policy MPC rollouts... iter  68
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.79685015581859
DONE TAKING  40  STEPS.
Total reward:  -871.4762339800452
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.880496119007468
DONE TAKING  40  STEPS.
Total reward:  298.87372447416743
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.631317349672635
DONE TAKING  40  STEPS.
Total reward:  322.26826540860446
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.797300756744416
DONE TAKING  40  STEPS.
Total reward:  -568.5665320619929
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.544070023935287
DONE TAKING  40  STEPS.
Total reward:  404.2142887746267
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.70683282923404
DONE TAKING  40  STEPS.
Total reward:  -294.6531696008445
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.394387758624937
DONE TAKING  40  STEPS.
Total reward:  -722.9388200267297
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.353053771001214
DONE TAKING  40  STEPS.
Total reward:  -219.29556021126456
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -24.155590171103825
DONE TAKING  40  STEPS.
Total reward:  -841.9895322649216
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.159939054511952
DONE TAKING  40  STEPS.
Total reward:  -371.3872794918716
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.490421659624364
DONE TAKING  40  STEPS.
Total reward:  -69.82985075769325
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.58921405986258
DONE TAKING  40  STEPS.
Total reward:  57.791931159476945
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.848126304975352
DONE TAKING  40  STEPS.
Total reward:  -344.25097555569096
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.597390774044932
DONE TAKING  40  STEPS.
Total reward:  123.80846558228458
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.943871193570587
DONE TAKING  40  STEPS.
Total reward:  -382.87672996879394
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -10.69940428376163
DONE TAKING  40  STEPS.
Total reward:  118.14946810424516
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.63692044589603
DONE TAKING  40  STEPS.
Total reward:  343.7560757667785
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.747935318961773
DONE TAKING  40  STEPS.
Total reward:  -317.33529968550687
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -8.330137487186136
DONE TAKING  40  STEPS.
Total reward:  441.8129288085563
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.292102378821
DONE TAKING  40  STEPS.
Total reward:  166.1577733644718
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.40620165362025
DONE TAKING  40  STEPS.
Total reward:  -859.6005301350285
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.87314407424735
DONE TAKING  40  STEPS.
Total reward:  -730.5728640647736
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -13.933558978352615
DONE TAKING  40  STEPS.
Total reward:  15.018663398281591
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.906214920864972
DONE TAKING  40  STEPS.
Total reward:  42.350167228126736
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.094710529640334
DONE TAKING  40  STEPS.
Total reward:  -473.08012667014816
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.528312892075107
DONE TAKING  40  STEPS.
Total reward:  -670.8753766778832
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.503610136463326
DONE TAKING  40  STEPS.
Total reward:  -735.5658242785366
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.415348629140173
DONE TAKING  40  STEPS.
Total reward:  -644.007011261989
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -14.52712784402481
DONE TAKING  40  STEPS.
Total reward:  -391.63001977295755
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.558159618135896
DONE TAKING  40  STEPS.
Total reward:  -658.8975405756862
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -15.436018323438292
DONE TAKING  40  STEPS.
Total reward:  104.2650054477388
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.08081664736632
DONE TAKING  40  STEPS.
Total reward:  -689.0486295763138
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -21.20128317971728
DONE TAKING  40  STEPS.
Total reward:  -458.4884422253957
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.581811742153832
DONE TAKING  40  STEPS.
Total reward:  129.85172227441052
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.47660162663586
DONE TAKING  40  STEPS.
Total reward:  -343.5267733113136
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.086717014647732
DONE TAKING  40  STEPS.
Total reward:  -380.4738227513146
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.623043498441962
DONE TAKING  40  STEPS.
Total reward:  239.60108955145205
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.314817153578023
DONE TAKING  40  STEPS.
Total reward:  -757.4134986829403
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -12.263618509058523
DONE TAKING  40  STEPS.
Total reward:  -297.8940350130922
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.52259664537982
DONE TAKING  40  STEPS.
Total reward:  -353.0981536133765
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter68.ckpt

#####################################
Training the dynamics model..... iteration  69
#####################################

    amount of random data:  8000
    amount of onPol data:  101844
Prob rand:  21255
On pol:  99360
Prob shape:  (120615,)

=== Epoch 0 ===
    train loss:  0.37998107075691223
    val rand:  0.3969601094722748
    val onPol:  0.29534590740998584

=== Epoch 10 ===
    train loss:  0.2178639510844616
    val rand:  0.2142905294895172
    val onPol:  0.23805840952055796

=== Epoch 20 ===
    train loss:  0.1838005507245977
    val rand:  0.17456857860088348
    val onPol:  0.23949463878359115

=== Epoch 30 ===
    train loss:  0.16105273264519712
    val rand:  0.16602300107479095
    val onPol:  0.24361840245269595

=== Epoch 39 ===
    train loss:  0.14615688907339217
    val rand:  0.16107574105262756
    val onPol:  0.25069702168305713
Training duration: 61.03 s

#####################################
performing on-policy MPC rollouts... iter  69
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.662997601157144
DONE TAKING  40  STEPS.
Total reward:  -367.41499079322665
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.451275478796518
DONE TAKING  40  STEPS.
Total reward:  -746.7624529990532
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.063702017904735
DONE TAKING  40  STEPS.
Total reward:  67.87164597323118
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -22.089026478242808
DONE TAKING  40  STEPS.
Total reward:  66.52806335801571
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -13.635332134407685
DONE TAKING  40  STEPS.
Total reward:  8.67944567159833
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.17186366832672
DONE TAKING  40  STEPS.
Total reward:  -735.7894384507143
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.475383030171617
DONE TAKING  40  STEPS.
Total reward:  415.66557266440486
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.604816873474782
DONE TAKING  40  STEPS.
Total reward:  80.74650028407856
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.054775923275205
DONE TAKING  40  STEPS.
Total reward:  59.637075349064375
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.482487113332148
DONE TAKING  40  STEPS.
Total reward:  -738.4068735418771
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.155123445638502
DONE TAKING  40  STEPS.
Total reward:  285.3777566116318
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.549084741230935
DONE TAKING  40  STEPS.
Total reward:  -57.66087166490136
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.975950779195372
DONE TAKING  40  STEPS.
Total reward:  29.74585022504475
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.331695818710365
DONE TAKING  40  STEPS.
Total reward:  217.04638315940022
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.10604707037292
DONE TAKING  40  STEPS.
Total reward:  -586.8484728003798
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.86666265175177
DONE TAKING  40  STEPS.
Total reward:  -653.6412798138102
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.737962478497685
DONE TAKING  40  STEPS.
Total reward:  -490.61226096533045
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.587690062184016
DONE TAKING  40  STEPS.
Total reward:  -609.9730113757025
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.61059841803176
DONE TAKING  40  STEPS.
Total reward:  -431.6270894661189
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.66834443588299
DONE TAKING  40  STEPS.
Total reward:  -384.97302917878085
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.685845079958014
DONE TAKING  40  STEPS.
Total reward:  -432.3378975668298
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.95115259305891
DONE TAKING  40  STEPS.
Total reward:  -741.1529874174711
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.138969326304263
DONE TAKING  40  STEPS.
Total reward:  -272.52969105480935
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.535865409933823
DONE TAKING  40  STEPS.
Total reward:  279.9676240620288
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -11.4777287305254
DONE TAKING  40  STEPS.
Total reward:  359.2869540568027
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -16.873836505441417
DONE TAKING  40  STEPS.
Total reward:  275.3660077548209
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.715476214414263
DONE TAKING  40  STEPS.
Total reward:  -471.1270372425785
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -20.99937234484073
DONE TAKING  40  STEPS.
Total reward:  -529.2827833479857
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.24041908226534
DONE TAKING  40  STEPS.
Total reward:  -653.9446986879287
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -17.73551095940054
DONE TAKING  40  STEPS.
Total reward:  -443.9823886933626
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.52506833426881
DONE TAKING  40  STEPS.
Total reward:  -327.6864970657333
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.674125999752896
DONE TAKING  40  STEPS.
Total reward:  -775.5642560732302
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.81826865649384
DONE TAKING  40  STEPS.
Total reward:  -545.2199602361355
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -15.488494358626397
DONE TAKING  40  STEPS.
Total reward:  96.98718407358537
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.758080192677447
DONE TAKING  40  STEPS.
Total reward:  -478.20768209470043
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.419593379573612
DONE TAKING  40  STEPS.
Total reward:  -307.66130333999865
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.118704682554313
DONE TAKING  40  STEPS.
Total reward:  -623.991086536919
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.678260333462962
DONE TAKING  40  STEPS.
Total reward:  -262.3373051934981
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.29372901261009
DONE TAKING  40  STEPS.
Total reward:  -445.18147237057116
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.215781398800214
DONE TAKING  40  STEPS.
Total reward:  -264.03342021049156
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter69.ckpt

#####################################
Training the dynamics model..... iteration  70
#####################################

    amount of random data:  8000
    amount of onPol data:  103320
Prob rand:  21450
On pol:  100800
Prob shape:  (122250,)

=== Epoch 0 ===
    train loss:  0.37859500180773376
    val rand:  0.39881882071495056
    val onPol:  0.2961723577408564

=== Epoch 10 ===
    train loss:  0.2171562776094725
    val rand:  0.21202632784843445
    val onPol:  0.2392886614515668

=== Epoch 20 ===
    train loss:  0.1818174547633203
    val rand:  0.17957083880901337
    val onPol:  0.23956323379562014

=== Epoch 30 ===
    train loss:  0.1598788594373134
    val rand:  0.1714521050453186
    val onPol:  0.24501436593986692

=== Epoch 39 ===
    train loss:  0.1465938332326272
    val rand:  0.17012111842632294
    val onPol:  0.2522979094868615
Training duration: 61.90 s

#####################################
performing on-policy MPC rollouts... iter  70
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.51206626967957
DONE TAKING  40  STEPS.
Total reward:  -43.83900730406383
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.21749433150827
DONE TAKING  40  STEPS.
Total reward:  -601.7661001860506
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -13.245098044300176
DONE TAKING  40  STEPS.
Total reward:  -182.28067792639723
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.544090113748837
DONE TAKING  40  STEPS.
Total reward:  -196.61193723825778
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -12.614716121793386
DONE TAKING  40  STEPS.
Total reward:  90.82720206715064
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.832483713031184
DONE TAKING  40  STEPS.
Total reward:  -770.3850362021427
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.828699259251195
DONE TAKING  40  STEPS.
Total reward:  -747.5530218328851
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.124042565513392
DONE TAKING  40  STEPS.
Total reward:  47.771661122842005
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.999708243285273
DONE TAKING  40  STEPS.
Total reward:  -550.4864244321759
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.191445941361252
DONE TAKING  40  STEPS.
Total reward:  -145.0881565072462
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.567794072698753
DONE TAKING  40  STEPS.
Total reward:  -450.44087651385036
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.94145274436716
DONE TAKING  40  STEPS.
Total reward:  -1100.905948264925
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -31.404035335093127
DONE TAKING  40  STEPS.
Total reward:  -905.0468381192701
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -14.146655530484761
DONE TAKING  40  STEPS.
Total reward:  88.67001323374362
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.48610578669505
DONE TAKING  40  STEPS.
Total reward:  -37.436864308677315
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.960717629425487
DONE TAKING  40  STEPS.
Total reward:  -87.4586047434196
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.380598329319717
DONE TAKING  40  STEPS.
Total reward:  -159.49921481235242
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.38218471567962
DONE TAKING  40  STEPS.
Total reward:  -768.2730301576025
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.509690578576656
DONE TAKING  40  STEPS.
Total reward:  -222.0565981673295
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -12.508452293177026
DONE TAKING  40  STEPS.
Total reward:  -143.6607983430619
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.441903285508996
DONE TAKING  40  STEPS.
Total reward:  -590.6593794165725
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.02608938107689
DONE TAKING  40  STEPS.
Total reward:  -313.0007267683178
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.403504340806812
DONE TAKING  40  STEPS.
Total reward:  -148.35514651150038
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.238073674196034
DONE TAKING  40  STEPS.
Total reward:  -455.89352278438776
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.94928545074785
DONE TAKING  40  STEPS.
Total reward:  377.94126576802887
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.80754474150003
DONE TAKING  40  STEPS.
Total reward:  3.3556343244173625
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.927823257490267
DONE TAKING  40  STEPS.
Total reward:  -519.7926442839907
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.778671017592888
DONE TAKING  40  STEPS.
Total reward:  123.78758133008182
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.346038530214795
DONE TAKING  40  STEPS.
Total reward:  -358.0888975677663
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.01677955174101
DONE TAKING  40  STEPS.
Total reward:  424.49361532506146
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.093327747475787
DONE TAKING  40  STEPS.
Total reward:  -700.7985698970843
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.75170703463599
DONE TAKING  40  STEPS.
Total reward:  -431.3318083795314
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.3671273742898
DONE TAKING  40  STEPS.
Total reward:  -761.3075776637294
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.603233560827032
DONE TAKING  40  STEPS.
Total reward:  -320.0387186928318
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.737106619155714
DONE TAKING  40  STEPS.
Total reward:  -489.1666909305663
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.20017128182495
DONE TAKING  40  STEPS.
Total reward:  -106.27441546150652
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.65665687851935
DONE TAKING  40  STEPS.
Total reward:  433.7002034434987
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -12.854727539538706
DONE TAKING  40  STEPS.
Total reward:  -294.9469626359832
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.968824904695815
DONE TAKING  40  STEPS.
Total reward:  -882.337701232331
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.13587657271198
DONE TAKING  40  STEPS.
Total reward:  -376.0675878977074
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter70.ckpt

#####################################
Training the dynamics model..... iteration  71
#####################################

    amount of random data:  8000
    amount of onPol data:  104796
Prob rand:  21645
On pol:  102240
Prob shape:  (123885,)

=== Epoch 0 ===
    train loss:  0.3777647076553329
    val rand:  0.39061248302459717
    val onPol:  0.29673040251840244

=== Epoch 10 ===
    train loss:  0.21764015990668809
    val rand:  0.215016707777977
    val onPol:  0.2395634177056226

=== Epoch 20 ===
    train loss:  0.1822715689779812
    val rand:  0.18267324566841125
    val onPol:  0.23932155831293625

=== Epoch 30 ===
    train loss:  0.16028347092050735
    val rand:  0.17023418843746185
    val onPol:  0.2450455969030207

=== Epoch 39 ===
    train loss:  0.14600603863658745
    val rand:  0.16615819931030273
    val onPol:  0.2516817633401264
Training duration: 62.69 s

#####################################
performing on-policy MPC rollouts... iter  71
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.143069078287592
DONE TAKING  40  STEPS.
Total reward:  -733.5365751602101
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -12.750045689332952
DONE TAKING  40  STEPS.
Total reward:  -319.79696587299674
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.154517070078796
DONE TAKING  40  STEPS.
Total reward:  347.71827993362615
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.967615660052747
DONE TAKING  40  STEPS.
Total reward:  3.0920577994473613
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.095186618513697
DONE TAKING  40  STEPS.
Total reward:  -986.713683572349
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.936409356996837
DONE TAKING  40  STEPS.
Total reward:  -743.7407713033759
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.66655668341676
DONE TAKING  40  STEPS.
Total reward:  -628.407317133482
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.056338480236718
DONE TAKING  40  STEPS.
Total reward:  -511.7951796197119
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -14.775661339845211
DONE TAKING  40  STEPS.
Total reward:  274.810127256612
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -31.04829391074901
DONE TAKING  40  STEPS.
Total reward:  -692.1688449359708
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -30.90026768320433
DONE TAKING  40  STEPS.
Total reward:  -743.0425738989538
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.329723231446913
DONE TAKING  40  STEPS.
Total reward:  -768.6960633645098
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.78854345131305
DONE TAKING  40  STEPS.
Total reward:  -308.9410208243946
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.399837013735485
DONE TAKING  40  STEPS.
Total reward:  35.32760023397432
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.606500542941923
DONE TAKING  40  STEPS.
Total reward:  62.69096537093435
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.262715880245654
DONE TAKING  40  STEPS.
Total reward:  -282.99734634679857
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.564200274140205
DONE TAKING  40  STEPS.
Total reward:  -225.4493925550693
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.484425416697608
DONE TAKING  40  STEPS.
Total reward:  -576.1627315379966
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.468201582160596
DONE TAKING  40  STEPS.
Total reward:  -554.4461231454007
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -12.36642615347325
DONE TAKING  40  STEPS.
Total reward:  -441.72634463955774
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.253083151002485
DONE TAKING  40  STEPS.
Total reward:  -89.68286184811046
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.620705090969292
DONE TAKING  40  STEPS.
Total reward:  556.8467061211454
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.235399990766844
DONE TAKING  40  STEPS.
Total reward:  375.67029285447285
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.040403790745664
DONE TAKING  40  STEPS.
Total reward:  14.65505317043823
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.5248188089957
DONE TAKING  40  STEPS.
Total reward:  -765.1972394301811
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.645404886823453
DONE TAKING  40  STEPS.
Total reward:  113.07980543457336
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.901237505250982
DONE TAKING  40  STEPS.
Total reward:  106.45008416882229
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.680892132382173
DONE TAKING  40  STEPS.
Total reward:  -421.79942482967533
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.036734657531333
DONE TAKING  40  STEPS.
Total reward:  -436.87380746958934
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.9776210094637
DONE TAKING  40  STEPS.
Total reward:  -571.9376124402417
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.187539936937064
DONE TAKING  40  STEPS.
Total reward:  -716.172556940163
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.67619392829696
DONE TAKING  40  STEPS.
Total reward:  -828.3456640574376
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.72495469283513
DONE TAKING  40  STEPS.
Total reward:  -525.1805389898195
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.88161921441666
DONE TAKING  40  STEPS.
Total reward:  102.88785997845189
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.91892984321109
DONE TAKING  40  STEPS.
Total reward:  -65.6034643272629
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.779951405278737
DONE TAKING  40  STEPS.
Total reward:  -679.7196952607931
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.169911420246468
DONE TAKING  40  STEPS.
Total reward:  26.102591890435605
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.498395737853038
DONE TAKING  40  STEPS.
Total reward:  394.06906271880854
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.14238171317772
DONE TAKING  40  STEPS.
Total reward:  -425.91745691593695
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.367515006375108
DONE TAKING  40  STEPS.
Total reward:  209.724891332559
Time for 1 rollout: 1.05 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter71.ckpt

#####################################
Training the dynamics model..... iteration  72
#####################################

    amount of random data:  8000
    amount of onPol data:  106272
Prob rand:  21840
On pol:  103680
Prob shape:  (125520,)

=== Epoch 0 ===
    train loss:  0.37907253369993094
    val rand:  0.392656534910202
    val onPol:  0.2970925440842455

=== Epoch 10 ===
    train loss:  0.21769080283690473
    val rand:  0.2180997133255005
    val onPol:  0.23837232251058926

=== Epoch 20 ===
    train loss:  0.1863390077133568
    val rand:  0.18706059455871582
    val onPol:  0.23815812983296133

=== Epoch 30 ===
    train loss:  0.16365062399786345
    val rand:  0.17342856526374817
    val onPol:  0.2425707524473017

=== Epoch 39 ===
    train loss:  0.15007979383274
    val rand:  0.17676924169063568
    val onPol:  0.25000651248476724
Training duration: 63.46 s

#####################################
performing on-policy MPC rollouts... iter  72
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.137388365609766
DONE TAKING  40  STEPS.
Total reward:  212.02380537649785
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.917643252992328
DONE TAKING  40  STEPS.
Total reward:  -456.47884631671315
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.605706742730284
DONE TAKING  40  STEPS.
Total reward:  184.64745336180613
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -12.338391302429123
DONE TAKING  40  STEPS.
Total reward:  -161.51044547440088
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.972276005036015
DONE TAKING  40  STEPS.
Total reward:  -364.86334719596323
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.528951578131775
DONE TAKING  40  STEPS.
Total reward:  -552.4134205565362
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.85812084713714
DONE TAKING  40  STEPS.
Total reward:  144.662514420699
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.952121774523086
DONE TAKING  40  STEPS.
Total reward:  120.44869032983095
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.44925262910351
DONE TAKING  40  STEPS.
Total reward:  -921.2507525631579
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.63535687058885
DONE TAKING  40  STEPS.
Total reward:  60.11696987226868
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.165808964179107
DONE TAKING  40  STEPS.
Total reward:  -472.8989911314143
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -17.53126284688179
DONE TAKING  40  STEPS.
Total reward:  -454.1621640935648
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.90712814562814
DONE TAKING  40  STEPS.
Total reward:  225.99530429521656
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.12595571878597
DONE TAKING  40  STEPS.
Total reward:  -558.3015105847654
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.30741779272652
DONE TAKING  40  STEPS.
Total reward:  -395.332516406708
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.83633747828991
DONE TAKING  40  STEPS.
Total reward:  -867.9181585414034
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.90658397372191
DONE TAKING  40  STEPS.
Total reward:  -753.1096470396415
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.94083296436707
DONE TAKING  40  STEPS.
Total reward:  -581.1050108930935
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.851045296610994
DONE TAKING  40  STEPS.
Total reward:  -601.065805639025
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.241048544061847
DONE TAKING  40  STEPS.
Total reward:  -863.1669475513477
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.6857323677978
DONE TAKING  40  STEPS.
Total reward:  -317.461602590365
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.388045002413897
DONE TAKING  40  STEPS.
Total reward:  -314.2923872241408
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.32383163702263
DONE TAKING  40  STEPS.
Total reward:  300.89203568856357
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.970101564683578
DONE TAKING  40  STEPS.
Total reward:  223.92819156379622
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.81833402684939
DONE TAKING  40  STEPS.
Total reward:  -807.0287769146807
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.6282332671382
DONE TAKING  40  STEPS.
Total reward:  -999.753831706157
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.43948816658908
DONE TAKING  40  STEPS.
Total reward:  -163.28623015656353
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.183657286026364
DONE TAKING  40  STEPS.
Total reward:  169.8169779099154
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -16.002189112298066
DONE TAKING  40  STEPS.
Total reward:  434.8636922871864
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.989495957870012
DONE TAKING  40  STEPS.
Total reward:  -581.9032355234923
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.174133748102808
DONE TAKING  40  STEPS.
Total reward:  319.7695092334344
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -12.772978754151103
DONE TAKING  40  STEPS.
Total reward:  -37.14166670038539
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -12.999707079181224
DONE TAKING  40  STEPS.
Total reward:  -341.7595608239141
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.11261820704827
DONE TAKING  40  STEPS.
Total reward:  147.34661432101316
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.46728211263469
DONE TAKING  40  STEPS.
Total reward:  147.14104478660894
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.832531588059226
DONE TAKING  40  STEPS.
Total reward:  -888.7199219601398
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.186676718188863
DONE TAKING  40  STEPS.
Total reward:  -39.33638341109328
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.455993168558454
DONE TAKING  40  STEPS.
Total reward:  28.073829778992888
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.272000089047864
DONE TAKING  40  STEPS.
Total reward:  -108.16174091064393
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.726678167734228
DONE TAKING  40  STEPS.
Total reward:  207.13062799621474
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter72.ckpt

#####################################
Training the dynamics model..... iteration  73
#####################################

    amount of random data:  8000
    amount of onPol data:  107748
Prob rand:  22035
On pol:  105120
Prob shape:  (127155,)

=== Epoch 0 ===
    train loss:  0.3785965868061589
    val rand:  0.39012277126312256
    val onPol:  0.2930922250856053

=== Epoch 10 ===
    train loss:  0.2169218060350226
    val rand:  0.2185443639755249
    val onPol:  0.23963069983504034

=== Epoch 20 ===
    train loss:  0.1837869638637189
    val rand:  0.1823870837688446
    val onPol:  0.23745917867530475

=== Epoch 30 ===
    train loss:  0.1609328326679045
    val rand:  0.17566542327404022
    val onPol:  0.2437515909021551

=== Epoch 39 ===
    train loss:  0.14684086953920703
    val rand:  0.1759287416934967
    val onPol:  0.24981867318803613
Training duration: 64.56 s

#####################################
performing on-policy MPC rollouts... iter  73
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -13.858641870276836
DONE TAKING  40  STEPS.
Total reward:  320.6567221176487
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.27291769441844
DONE TAKING  40  STEPS.
Total reward:  -734.4302310053909
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.983765757481834
DONE TAKING  40  STEPS.
Total reward:  175.3307411442007
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.262189306552163
DONE TAKING  40  STEPS.
Total reward:  80.82900455836092
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.454193949380276
DONE TAKING  40  STEPS.
Total reward:  -512.5923936523078
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -11.802342634431128
DONE TAKING  40  STEPS.
Total reward:  -149.70682271208375
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -21.162774246585926
DONE TAKING  40  STEPS.
Total reward:  -486.98084730762065
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.716210459496885
DONE TAKING  40  STEPS.
Total reward:  -491.4542920031002
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -18.630277321981076
DONE TAKING  40  STEPS.
Total reward:  152.0470543653867
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.304306957223588
DONE TAKING  40  STEPS.
Total reward:  -233.110449498942
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.86292547789028
DONE TAKING  40  STEPS.
Total reward:  58.879235421786746
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -20.98183150662961
DONE TAKING  40  STEPS.
Total reward:  -26.445364843751427
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.745109132478674
DONE TAKING  40  STEPS.
Total reward:  -32.39827886982831
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.423807832412354
DONE TAKING  40  STEPS.
Total reward:  -661.7103626604933
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.313069089555903
DONE TAKING  40  STEPS.
Total reward:  -713.6798048276728
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -31.32518328695648
DONE TAKING  40  STEPS.
Total reward:  -881.43644073478
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.672515452870453
DONE TAKING  40  STEPS.
Total reward:  -442.89457884609294
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.969461094402398
DONE TAKING  40  STEPS.
Total reward:  -61.485467691160565
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.846624182571304
DONE TAKING  40  STEPS.
Total reward:  -527.2565806270193
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.64451114231111
DONE TAKING  40  STEPS.
Total reward:  111.58873248128427
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.31667109766575
DONE TAKING  40  STEPS.
Total reward:  -19.470311428990012
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -15.059965237055458
DONE TAKING  40  STEPS.
Total reward:  290.8704426869087
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.622979677069505
DONE TAKING  40  STEPS.
Total reward:  -181.39155276782907
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.964676518704465
DONE TAKING  40  STEPS.
Total reward:  -482.1443262889194
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.25178938080985
DONE TAKING  40  STEPS.
Total reward:  -336.25644692459724
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.762393954152014
DONE TAKING  40  STEPS.
Total reward:  42.795590712279186
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.443818742572354
DONE TAKING  40  STEPS.
Total reward:  -174.58408178510152
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.015596595615797
DONE TAKING  40  STEPS.
Total reward:  227.53700876941247
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.077734662799582
DONE TAKING  40  STEPS.
Total reward:  -423.2222688265864
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.098399465555886
DONE TAKING  40  STEPS.
Total reward:  295.8093190461259
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.3670405934013
DONE TAKING  40  STEPS.
Total reward:  202.51896564172435
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.622527122431343
DONE TAKING  40  STEPS.
Total reward:  243.85299550727385
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.747863300945312
DONE TAKING  40  STEPS.
Total reward:  -602.7303494887796
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.97566518916251
DONE TAKING  40  STEPS.
Total reward:  75.23272598775458
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.58995056502644
DONE TAKING  40  STEPS.
Total reward:  314.5296067560674
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.897377062326864
DONE TAKING  40  STEPS.
Total reward:  -381.10344739493104
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.938367590269788
DONE TAKING  40  STEPS.
Total reward:  -512.1790595489289
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.331900563839014
DONE TAKING  40  STEPS.
Total reward:  -657.5575322864935
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.972395920988276
DONE TAKING  40  STEPS.
Total reward:  -266.96362321571576
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.246287521814494
DONE TAKING  40  STEPS.
Total reward:  -721.4486150777366
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter73.ckpt

#####################################
Training the dynamics model..... iteration  74
#####################################

    amount of random data:  8000
    amount of onPol data:  109224
Prob rand:  22230
On pol:  106560
Prob shape:  (128790,)

=== Epoch 0 ===
    train loss:  0.3782294966072675
    val rand:  0.39500758051872253
    val onPol:  0.2975432037011437

=== Epoch 10 ===
    train loss:  0.21760688745880508
    val rand:  0.21615394949913025
    val onPol:  0.23906523896300275

=== Epoch 20 ===
    train loss:  0.18365445264069682
    val rand:  0.18005681037902832
    val onPol:  0.23862176939197208

=== Epoch 30 ===
    train loss:  0.16208444642593187
    val rand:  0.17046570777893066
    val onPol:  0.24390375031077344

=== Epoch 39 ===
    train loss:  0.14763801185733294
    val rand:  0.16855400800704956
    val onPol:  0.2509331165448479
Training duration: 65.51 s

#####################################
performing on-policy MPC rollouts... iter  74
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.8708970085116
DONE TAKING  40  STEPS.
Total reward:  218.67101324623962
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -16.042258221133014
DONE TAKING  40  STEPS.
Total reward:  260.8647951687378
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.99431216823804
DONE TAKING  40  STEPS.
Total reward:  -28.29457420836227
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.78808627238457
DONE TAKING  40  STEPS.
Total reward:  -344.58187559868156
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.147572263440814
DONE TAKING  40  STEPS.
Total reward:  -675.5468219715256
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.63816677862814
DONE TAKING  40  STEPS.
Total reward:  188.07347925940314
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.136087568303335
DONE TAKING  40  STEPS.
Total reward:  -337.1392556844698
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.05050332083115
DONE TAKING  40  STEPS.
Total reward:  215.92050971792565
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.85928182987149
DONE TAKING  40  STEPS.
Total reward:  -770.1278471313138
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.573752237424635
DONE TAKING  40  STEPS.
Total reward:  384.82740892051754
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -17.102351860067845
DONE TAKING  40  STEPS.
Total reward:  509.7534473791875
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.816624108238912
DONE TAKING  40  STEPS.
Total reward:  -190.29750610354617
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -16.025642137420316
DONE TAKING  40  STEPS.
Total reward:  339.6759584158309
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.059918897085897
DONE TAKING  40  STEPS.
Total reward:  -237.2117072563718
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.877616589371375
DONE TAKING  40  STEPS.
Total reward:  -521.4399509254141
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -12.865557303948538
DONE TAKING  40  STEPS.
Total reward:  33.44829828279896
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.303896131129374
DONE TAKING  40  STEPS.
Total reward:  191.61684884785785
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -14.186805240299114
DONE TAKING  40  STEPS.
Total reward:  -356.2113402294571
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.137103593282546
DONE TAKING  40  STEPS.
Total reward:  -508.7332771679652
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.49046410840798
DONE TAKING  40  STEPS.
Total reward:  -955.8063961982322
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.432579538673115
DONE TAKING  40  STEPS.
Total reward:  187.90874642241374
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.149953063000495
DONE TAKING  40  STEPS.
Total reward:  53.30717971709677
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.011245181013166
DONE TAKING  40  STEPS.
Total reward:  -585.0476168761809
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.90045757291994
DONE TAKING  40  STEPS.
Total reward:  -518.9616933074456
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -15.665963502592685
DONE TAKING  40  STEPS.
Total reward:  -306.6927823638931
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.774332405747753
DONE TAKING  40  STEPS.
Total reward:  -508.5002570542223
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -12.957225139876208
DONE TAKING  40  STEPS.
Total reward:  287.4615969836442
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -14.320241018732016
DONE TAKING  40  STEPS.
Total reward:  157.51047381358887
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -17.19998388172035
DONE TAKING  40  STEPS.
Total reward:  -89.32181404557048
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.505221900407967
DONE TAKING  40  STEPS.
Total reward:  -142.63721640562494
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.480950774172488
DONE TAKING  40  STEPS.
Total reward:  -80.18691198206446
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.589746321465586
DONE TAKING  40  STEPS.
Total reward:  -362.39619161193053
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.611126432527346
DONE TAKING  40  STEPS.
Total reward:  12.007603629607829
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.177227264936093
DONE TAKING  40  STEPS.
Total reward:  -39.45940204210429
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.892463085049105
DONE TAKING  40  STEPS.
Total reward:  -1009.0045702442225
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.93235339671691
DONE TAKING  40  STEPS.
Total reward:  -560.1732917249919
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.291391754792812
DONE TAKING  40  STEPS.
Total reward:  -92.4631769127549
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -13.82668441412764
DONE TAKING  40  STEPS.
Total reward:  -368.4301395926349
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.909039979138342
DONE TAKING  40  STEPS.
Total reward:  108.64011255664543
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.3023624911717
DONE TAKING  40  STEPS.
Total reward:  -521.3095581116594
Time for 1 rollout: 1.06 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter74.ckpt

#####################################
Training the dynamics model..... iteration  75
#####################################

    amount of random data:  8000
    amount of onPol data:  110700
Prob rand:  22425
On pol:  108000
Prob shape:  (130425,)

=== Epoch 0 ===
    train loss:  0.37692588720265335
    val rand:  0.39211446046829224
    val onPol:  0.29655481097490893

=== Epoch 10 ===
    train loss:  0.21708328775533542
    val rand:  0.21338188648223877
    val onPol:  0.23891780622627423

=== Epoch 20 ===
    train loss:  0.18381835631732865
    val rand:  0.17711888253688812
    val onPol:  0.23833178502062094

=== Epoch 30 ===
    train loss:  0.16229940786605745
    val rand:  0.17216148972511292
    val onPol:  0.2444853944622952

=== Epoch 39 ===
    train loss:  0.14797995268829225
    val rand:  0.165510892868042
    val onPol:  0.2503889377998269
Training duration: 66.24 s

#####################################
performing on-policy MPC rollouts... iter  75
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.99615965845902
DONE TAKING  40  STEPS.
Total reward:  -1037.6869791544568
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.956008034458847
DONE TAKING  40  STEPS.
Total reward:  124.3137139860676
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.332006698846396
DONE TAKING  40  STEPS.
Total reward:  -427.71621744146876
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.7498720625305
DONE TAKING  40  STEPS.
Total reward:  -103.91146540144885
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.122504364692993
DONE TAKING  40  STEPS.
Total reward:  192.48801412046657
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.842514713943647
DONE TAKING  40  STEPS.
Total reward:  -151.43453078776204
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.33112811521
DONE TAKING  40  STEPS.
Total reward:  -576.3264923659609
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -10.897643955878348
DONE TAKING  40  STEPS.
Total reward:  488.09602205644455
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -18.1500270684003
DONE TAKING  40  STEPS.
Total reward:  244.9431583928781
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -15.248943513215472
DONE TAKING  40  STEPS.
Total reward:  -99.93853243525909
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.624184682291414
DONE TAKING  40  STEPS.
Total reward:  -371.6408376893879
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.13403170936095
DONE TAKING  40  STEPS.
Total reward:  -561.2499830509037
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.165506060290664
DONE TAKING  40  STEPS.
Total reward:  -348.19646107846313
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.579561889133373
DONE TAKING  40  STEPS.
Total reward:  -539.0451951754217
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.761284067334714
DONE TAKING  40  STEPS.
Total reward:  -656.8808196413212
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.648262619404946
DONE TAKING  40  STEPS.
Total reward:  133.80978895728506
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.66750196877357
DONE TAKING  40  STEPS.
Total reward:  -72.51533917101503
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.900786869546323
DONE TAKING  40  STEPS.
Total reward:  -196.2903211507947
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.179709843494518
DONE TAKING  40  STEPS.
Total reward:  433.96609439684096
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.321786555720863
DONE TAKING  40  STEPS.
Total reward:  -134.29188539235957
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.88708087999879
DONE TAKING  40  STEPS.
Total reward:  -189.000814944589
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.125140758629595
DONE TAKING  40  STEPS.
Total reward:  157.92076894504072
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.860575450813563
DONE TAKING  40  STEPS.
Total reward:  212.2269407325183
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -11.062742922654003
DONE TAKING  40  STEPS.
Total reward:  364.1044523677527
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.86167339953313
DONE TAKING  40  STEPS.
Total reward:  -928.0514177846625
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.409122913982692
DONE TAKING  40  STEPS.
Total reward:  184.4690929694855
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.604084672254963
DONE TAKING  40  STEPS.
Total reward:  -431.19062675387306
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -13.348223909072319
DONE TAKING  40  STEPS.
Total reward:  -155.7905658025884
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.372285408475108
DONE TAKING  40  STEPS.
Total reward:  -273.16907383255915
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.401177118081982
DONE TAKING  40  STEPS.
Total reward:  -403.9104404192275
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.475140047423444
DONE TAKING  40  STEPS.
Total reward:  71.3773876559214
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -15.028177609260077
DONE TAKING  40  STEPS.
Total reward:  144.8933348010993
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.198013948086437
DONE TAKING  40  STEPS.
Total reward:  312.6540457345768
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.65307903346677
DONE TAKING  40  STEPS.
Total reward:  -983.7648390064298
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -14.442072808993345
DONE TAKING  40  STEPS.
Total reward:  264.17239690183857
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.16571382940038
DONE TAKING  40  STEPS.
Total reward:  289.9155503239048
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -15.21894106396881
DONE TAKING  40  STEPS.
Total reward:  36.96100026151133
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -9.161750037498429
DONE TAKING  40  STEPS.
Total reward:  43.75892707146022
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.767225888231742
DONE TAKING  40  STEPS.
Total reward:  -100.1911752833947
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.27064435930634
DONE TAKING  40  STEPS.
Total reward:  -109.11877717268246
Time for 1 rollout: 1.07 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter75.ckpt

#####################################
Training the dynamics model..... iteration  76
#####################################

    amount of random data:  8000
    amount of onPol data:  112176
Prob rand:  22620
On pol:  109440
Prob shape:  (132060,)

=== Epoch 0 ===
    train loss:  0.3775991399696365
    val rand:  0.4020737111568451
    val onPol:  0.2948466753182204

=== Epoch 10 ===
    train loss:  0.21763525248037702
    val rand:  0.21050404012203217
    val onPol:  0.23652974224608878

=== Epoch 20 ===
    train loss:  0.18472643730009577
    val rand:  0.1826089322566986
    val onPol:  0.23692167193993277

=== Epoch 30 ===
    train loss:  0.163685071851029
    val rand:  0.17159691452980042
    val onPol:  0.24210023620854254

=== Epoch 39 ===
    train loss:  0.14971595521335007
    val rand:  0.16829341650009155
    val onPol:  0.24739631168220355
Training duration: 66.79 s

#####################################
performing on-policy MPC rollouts... iter  76
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.978910307700538
DONE TAKING  40  STEPS.
Total reward:  -642.2996920011832
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.421451948803565
DONE TAKING  40  STEPS.
Total reward:  -16.36508788598354
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.165926238083316
DONE TAKING  40  STEPS.
Total reward:  -306.1374617833693
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.247597323162775
DONE TAKING  40  STEPS.
Total reward:  12.23827544919704
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -10.759160810650004
DONE TAKING  40  STEPS.
Total reward:  -329.808200843586
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.825231970248282
DONE TAKING  40  STEPS.
Total reward:  -642.5738372985684
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.724419444560287
DONE TAKING  40  STEPS.
Total reward:  -359.80560106548
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.03718182658429
DONE TAKING  40  STEPS.
Total reward:  208.43241425495668
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.676670920056353
DONE TAKING  40  STEPS.
Total reward:  454.6328940076741
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.156185604191407
DONE TAKING  40  STEPS.
Total reward:  174.60013269910166
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.138759430639652
DONE TAKING  40  STEPS.
Total reward:  218.2399786214023
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.575839888837326
DONE TAKING  40  STEPS.
Total reward:  47.277587448855286
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.812822065732977
DONE TAKING  40  STEPS.
Total reward:  -384.5362816659375
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -15.870318816067151
DONE TAKING  40  STEPS.
Total reward:  524.0935673013101
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -29.671589009483313
DONE TAKING  40  STEPS.
Total reward:  26.621022932957743
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -31.13897783340722
DONE TAKING  40  STEPS.
Total reward:  47.500974157041284
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.642637072502936
DONE TAKING  40  STEPS.
Total reward:  -474.9510249459379
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.967829735130888
DONE TAKING  40  STEPS.
Total reward:  49.42589015863646
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.716314704718357
DONE TAKING  40  STEPS.
Total reward:  105.55137691845012
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.26989837134169
DONE TAKING  40  STEPS.
Total reward:  -249.73486513527934
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.45784861240395
DONE TAKING  40  STEPS.
Total reward:  -265.0515628953471
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.402547646193948
DONE TAKING  40  STEPS.
Total reward:  -233.1000968216092
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.559079190013101
DONE TAKING  40  STEPS.
Total reward:  -26.289081459648813
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.31769511272831
DONE TAKING  40  STEPS.
Total reward:  43.63009134560214
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -18.420912008261773
DONE TAKING  40  STEPS.
Total reward:  -530.358754610947
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -14.222292763024688
DONE TAKING  40  STEPS.
Total reward:  -350.5092339548735
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.4263091471364
DONE TAKING  40  STEPS.
Total reward:  -611.6872763519503
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.451998906823135
DONE TAKING  40  STEPS.
Total reward:  -424.6289113236622
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.620011736630055
DONE TAKING  40  STEPS.
Total reward:  -316.8331224868074
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.06176718487663
DONE TAKING  40  STEPS.
Total reward:  122.01767002365834
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.195745649832197
DONE TAKING  40  STEPS.
Total reward:  -159.17272106826553
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.21696883638219
DONE TAKING  40  STEPS.
Total reward:  -182.99157413685913
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.750962069805468
DONE TAKING  40  STEPS.
Total reward:  -344.0073044973241
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -14.03096966906938
DONE TAKING  40  STEPS.
Total reward:  -431.6830657849603
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.802483017937288
DONE TAKING  40  STEPS.
Total reward:  89.06450195101209
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.778957370890552
DONE TAKING  40  STEPS.
Total reward:  -701.4260769500737
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.572227075059715
DONE TAKING  40  STEPS.
Total reward:  -269.80732673458414
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.722971009724937
DONE TAKING  40  STEPS.
Total reward:  272.0913538694955
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.635903406688065
DONE TAKING  40  STEPS.
Total reward:  366.72883184022385
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.48835818921995
DONE TAKING  40  STEPS.
Total reward:  46.601624389695544
Time for 1 rollout: 1.04 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter76.ckpt

#####################################
Training the dynamics model..... iteration  77
#####################################

    amount of random data:  8000
    amount of onPol data:  113652
Prob rand:  22815
On pol:  110880
Prob shape:  (133695,)

=== Epoch 0 ===
    train loss:  0.37873927363947435
    val rand:  0.41218942403793335
    val onPol:  0.2970061581581831

=== Epoch 10 ===
    train loss:  0.21872801273718648
    val rand:  0.21112516522407532
    val onPol:  0.23956459946930408

=== Epoch 20 ===
    train loss:  0.18528350770930221
    val rand:  0.18204054236412048
    val onPol:  0.23740675362447897

=== Epoch 30 ===
    train loss:  0.16564335528461413
    val rand:  0.16553029417991638
    val onPol:  0.24316075071692467

=== Epoch 39 ===
    train loss:  0.15139752906172668
    val rand:  0.16731373965740204
    val onPol:  0.2486898253361384
Training duration: 67.65 s

#####################################
performing on-policy MPC rollouts... iter  77
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.221862751079218
DONE TAKING  40  STEPS.
Total reward:  473.19407276431843
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.803754120864973
DONE TAKING  40  STEPS.
Total reward:  37.83083725701772
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.776868317289324
DONE TAKING  40  STEPS.
Total reward:  -123.06403671892681
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.81415114925291
DONE TAKING  40  STEPS.
Total reward:  9.264641836026051
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.698884785027516
DONE TAKING  40  STEPS.
Total reward:  406.00937890108304
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.116465241873225
DONE TAKING  40  STEPS.
Total reward:  -847.5042042575973
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.286452309170322
DONE TAKING  40  STEPS.
Total reward:  -400.26186846156793
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.322005205838536
DONE TAKING  40  STEPS.
Total reward:  76.26806115994611
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -11.746335999093274
DONE TAKING  40  STEPS.
Total reward:  298.5982618361839
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.880905937838552
DONE TAKING  40  STEPS.
Total reward:  -57.28452150960807
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.607554333532203
DONE TAKING  40  STEPS.
Total reward:  -106.89112431930003
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.72365551226638
DONE TAKING  40  STEPS.
Total reward:  295.00473265045736
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.165301695597375
DONE TAKING  40  STEPS.
Total reward:  104.85163638818003
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.602451128553112
DONE TAKING  40  STEPS.
Total reward:  -159.6041051152831
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -12.211057111745783
DONE TAKING  40  STEPS.
Total reward:  -83.57800217797052
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.313598437651883
DONE TAKING  40  STEPS.
Total reward:  -732.2359432114135
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.878418898869455
DONE TAKING  40  STEPS.
Total reward:  193.23401349883633
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -13.078889859821716
DONE TAKING  40  STEPS.
Total reward:  -211.44641124151627
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.043357217246637
DONE TAKING  40  STEPS.
Total reward:  -538.0135533224995
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.404565236779945
DONE TAKING  40  STEPS.
Total reward:  124.46277912846026
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.98685360218355
DONE TAKING  40  STEPS.
Total reward:  -1047.4746312932764
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.478768540829844
DONE TAKING  40  STEPS.
Total reward:  -243.90822328283863
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -15.067546122429473
DONE TAKING  40  STEPS.
Total reward:  353.72553135307066
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.784113383792693
DONE TAKING  40  STEPS.
Total reward:  -218.62252493380112
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.73283800695893
DONE TAKING  40  STEPS.
Total reward:  -39.169198728354104
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -18.473830110804762
DONE TAKING  40  STEPS.
Total reward:  237.02039284312042
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -31.267490303168653
DONE TAKING  40  STEPS.
Total reward:  -628.4455852538828
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.451653143116125
DONE TAKING  40  STEPS.
Total reward:  -584.1607408578918
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.127420634672976
DONE TAKING  40  STEPS.
Total reward:  -650.154336375397
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.950725360285105
DONE TAKING  40  STEPS.
Total reward:  39.24877710366877
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -11.647876889271425
DONE TAKING  40  STEPS.
Total reward:  514.8399021171438
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.65438217641638
DONE TAKING  40  STEPS.
Total reward:  -673.5424825195728
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.176989074385826
DONE TAKING  40  STEPS.
Total reward:  215.4311797576969
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.562685342886567
DONE TAKING  40  STEPS.
Total reward:  -922.2973122759237
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.423651372796773
DONE TAKING  40  STEPS.
Total reward:  -674.2076143338296
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.21979074012693
DONE TAKING  40  STEPS.
Total reward:  -669.4802669549285
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.66588893478329
DONE TAKING  40  STEPS.
Total reward:  270.2994353380392
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.61765891227826
DONE TAKING  40  STEPS.
Total reward:  151.9806912477783
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.522562903700617
DONE TAKING  40  STEPS.
Total reward:  73.25347858150269
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.99026929032049
DONE TAKING  40  STEPS.
Total reward:  -78.32342522803391
Time for 1 rollout: 1.05 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter77.ckpt

#####################################
Training the dynamics model..... iteration  78
#####################################

    amount of random data:  8000
    amount of onPol data:  115128
Prob rand:  23010
On pol:  112320
Prob shape:  (135330,)

=== Epoch 0 ===
    train loss:  0.3720378464821613
    val rand:  0.3920484483242035
    val onPol:  0.29696416668593884

=== Epoch 10 ===
    train loss:  0.21806005010324897
    val rand:  0.21427467465400696
    val onPol:  0.23985510195295015

=== Epoch 20 ===
    train loss:  0.18351139630557914
    val rand:  0.17948707938194275
    val onPol:  0.2411729215333859

=== Epoch 30 ===
    train loss:  0.16231230482684844
    val rand:  0.16500169038772583
    val onPol:  0.24609623663127422

=== Epoch 39 ===
    train loss:  0.14870808047778677
    val rand:  0.1673414409160614
    val onPol:  0.25179449034233886
Training duration: 68.58 s

#####################################
performing on-policy MPC rollouts... iter  78
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -11.555737923407035
DONE TAKING  40  STEPS.
Total reward:  93.8774451031098
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.170770255450265
DONE TAKING  40  STEPS.
Total reward:  211.1479643835517
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.991286467064864
DONE TAKING  40  STEPS.
Total reward:  -4.9558535909702135
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.986666616794388
DONE TAKING  40  STEPS.
Total reward:  -180.4103207603934
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.54137508527341
DONE TAKING  40  STEPS.
Total reward:  -132.84723329462133
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -18.864253268622512
DONE TAKING  40  STEPS.
Total reward:  258.5848578986513
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.62058284127923
DONE TAKING  40  STEPS.
Total reward:  -620.4570961965355
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -11.92819006049874
DONE TAKING  40  STEPS.
Total reward:  372.44841280371236
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.607223448838457
DONE TAKING  40  STEPS.
Total reward:  209.06872762462993
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.906071591450072
DONE TAKING  40  STEPS.
Total reward:  10.791025056567197
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.101658469965802
DONE TAKING  40  STEPS.
Total reward:  160.5528455791416
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.458964103188862
DONE TAKING  40  STEPS.
Total reward:  378.2047112768775
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.543890442813808
DONE TAKING  40  STEPS.
Total reward:  -239.10416624006112
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.629258121694065
DONE TAKING  40  STEPS.
Total reward:  -266.69600304558816
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.462543687144057
DONE TAKING  40  STEPS.
Total reward:  -487.23770107558653
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.44573819833801
DONE TAKING  40  STEPS.
Total reward:  -353.700594626243
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.359389272460753
DONE TAKING  40  STEPS.
Total reward:  -60.87995872467542
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.236140630739555
DONE TAKING  40  STEPS.
Total reward:  433.01116996988804
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.237181466967296
DONE TAKING  40  STEPS.
Total reward:  -519.5137520032243
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.412754888782665
DONE TAKING  40  STEPS.
Total reward:  -273.48851231763933
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.185031282183036
DONE TAKING  40  STEPS.
Total reward:  -394.0685219004743
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.219086173017267
DONE TAKING  40  STEPS.
Total reward:  65.81163754646582
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -19.09762852666294
DONE TAKING  40  STEPS.
Total reward:  -497.96868426838256
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.533573201049848
DONE TAKING  40  STEPS.
Total reward:  155.80786782488872
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.069642316149995
DONE TAKING  40  STEPS.
Total reward:  -592.97282066707
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.018677142626386
DONE TAKING  40  STEPS.
Total reward:  424.26889585783977
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.08966189293149
DONE TAKING  40  STEPS.
Total reward:  302.8855359201973
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.891132359179174
DONE TAKING  40  STEPS.
Total reward:  40.874080905977046
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.225017980542106
DONE TAKING  40  STEPS.
Total reward:  -321.57000992899157
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -16.948682876928316
DONE TAKING  40  STEPS.
Total reward:  -19.958346707586724
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -14.212837155124262
DONE TAKING  40  STEPS.
Total reward:  -21.102224209945586
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -14.15000380583276
DONE TAKING  40  STEPS.
Total reward:  608.5070519476237
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -31.140667627560504
DONE TAKING  40  STEPS.
Total reward:  -626.2283202693649
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.362384304008106
DONE TAKING  40  STEPS.
Total reward:  170.99444117049552
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -15.825289667833013
DONE TAKING  40  STEPS.
Total reward:  -517.1224330198111
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -28.33140056523711
DONE TAKING  40  STEPS.
Total reward:  -331.2682183852029
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.807636858295346
DONE TAKING  40  STEPS.
Total reward:  321.7289068239787
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -20.407624667485422
DONE TAKING  40  STEPS.
Total reward:  -320.83480569269216
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.60009388758803
DONE TAKING  40  STEPS.
Total reward:  -59.212128399976194
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.478475646817177
DONE TAKING  40  STEPS.
Total reward:  -143.52261394849188
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter78.ckpt

#####################################
Training the dynamics model..... iteration  79
#####################################

    amount of random data:  8000
    amount of onPol data:  116604
Prob rand:  23205
On pol:  113760
Prob shape:  (136965,)

=== Epoch 0 ===
    train loss:  0.37543859966238785
    val rand:  0.40285056829452515
    val onPol:  0.29663415253162384

=== Epoch 10 ===
    train loss:  0.21677747469269829
    val rand:  0.2122240960597992
    val onPol:  0.23724347166717052

=== Epoch 20 ===
    train loss:  0.18526037757316333
    val rand:  0.1770363748073578
    val onPol:  0.23656327836215496

=== Epoch 30 ===
    train loss:  0.16406031678455152
    val rand:  0.1687753051519394
    val onPol:  0.24107061885297298

=== Epoch 39 ===
    train loss:  0.15068154449989732
    val rand:  0.1727035641670227
    val onPol:  0.24666010960936546
Training duration: 69.27 s

#####################################
performing on-policy MPC rollouts... iter  79
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.893320037394616
DONE TAKING  40  STEPS.
Total reward:  -143.90345525844552
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.372029590232586
DONE TAKING  40  STEPS.
Total reward:  80.22197646455328
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.151394843804084
DONE TAKING  40  STEPS.
Total reward:  202.31886110287738
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.571764672194579
DONE TAKING  40  STEPS.
Total reward:  13.170651386287854
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.041963800819914
DONE TAKING  40  STEPS.
Total reward:  58.62446135395792
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.57141441211712
DONE TAKING  40  STEPS.
Total reward:  -911.0809118377299
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -18.079290815184795
DONE TAKING  40  STEPS.
Total reward:  -14.492955535626997
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.523496753026617
DONE TAKING  40  STEPS.
Total reward:  -49.00917488436076
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -14.646795887161733
DONE TAKING  40  STEPS.
Total reward:  -117.78661334219677
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -26.401407024132588
DONE TAKING  40  STEPS.
Total reward:  -486.1613172107639
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.993240062148658
DONE TAKING  40  STEPS.
Total reward:  -237.98909084122351
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.857672092786217
DONE TAKING  40  STEPS.
Total reward:  18.770978728825405
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -30.16082678871681
DONE TAKING  40  STEPS.
Total reward:  -359.98129181520045
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.419982824749138
DONE TAKING  40  STEPS.
Total reward:  -415.4034365775402
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.236184632823935
DONE TAKING  40  STEPS.
Total reward:  -290.8627112913774
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.627016387769263
DONE TAKING  40  STEPS.
Total reward:  -156.99566487540727
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -12.682961149135474
DONE TAKING  40  STEPS.
Total reward:  -36.97934596515468
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.196961769744128
DONE TAKING  40  STEPS.
Total reward:  363.55872168599626
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.497014423825032
DONE TAKING  40  STEPS.
Total reward:  136.84713691398633
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.178517537389993
DONE TAKING  40  STEPS.
Total reward:  -51.34928416409262
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.85587923699849
DONE TAKING  40  STEPS.
Total reward:  36.65508238900121
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.84302191607226
DONE TAKING  40  STEPS.
Total reward:  133.5596912352034
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.686536367327953
DONE TAKING  40  STEPS.
Total reward:  130.94604853424374
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.50635769053722
DONE TAKING  40  STEPS.
Total reward:  182.78507600681348
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.478636673078135
DONE TAKING  40  STEPS.
Total reward:  -442.66228674365857
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.87477092679479
DONE TAKING  40  STEPS.
Total reward:  -168.47001383629856
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.02372978043176
DONE TAKING  40  STEPS.
Total reward:  -234.93061469950877
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -14.183059279474893
DONE TAKING  40  STEPS.
Total reward:  -103.14222532617742
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.758895091402373
DONE TAKING  40  STEPS.
Total reward:  16.659808509086886
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.005077138006463
DONE TAKING  40  STEPS.
Total reward:  -586.5357277567101
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.599992355028498
DONE TAKING  40  STEPS.
Total reward:  -187.69167390815767
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.811067451488483
DONE TAKING  40  STEPS.
Total reward:  128.95380440582846
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.836644419661177
DONE TAKING  40  STEPS.
Total reward:  -395.01364662082466
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.660964545359885
DONE TAKING  40  STEPS.
Total reward:  -239.63982478109642
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -31.356403636914152
DONE TAKING  40  STEPS.
Total reward:  97.51516088342618
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.152267255830917
DONE TAKING  40  STEPS.
Total reward:  -29.039441042709385
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.170489028108367
DONE TAKING  40  STEPS.
Total reward:  -200.98628914514057
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.56725061982509
DONE TAKING  40  STEPS.
Total reward:  116.22477405778986
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.9735455014495
DONE TAKING  40  STEPS.
Total reward:  95.82634245929027
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.742963934714805
DONE TAKING  40  STEPS.
Total reward:  -468.33002554159077
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter79.ckpt

#####################################
Training the dynamics model..... iteration  80
#####################################

    amount of random data:  8000
    amount of onPol data:  118080
Prob rand:  23400
On pol:  115200
Prob shape:  (138600,)

=== Epoch 0 ===
    train loss:  0.37459311628783193
    val rand:  0.3941870629787445
    val onPol:  0.3007287007570267

=== Epoch 10 ===
    train loss:  0.21794773124986225
    val rand:  0.21301668882369995
    val onPol:  0.23942399859428407

=== Epoch 20 ===
    train loss:  0.18465975213933875
    val rand:  0.1778337061405182
    val onPol:  0.2390856021642685

=== Epoch 30 ===
    train loss:  0.16439743246193286
    val rand:  0.17129561305046082
    val onPol:  0.24406258046627044

=== Epoch 39 ===
    train loss:  0.15119824161132175
    val rand:  0.1624312400817871
    val onPol:  0.2494093358516693
Training duration: 69.89 s

#####################################
performing on-policy MPC rollouts... iter  80
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.497655247742646
DONE TAKING  40  STEPS.
Total reward:  -488.36707890308907
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.1297364273109
DONE TAKING  40  STEPS.
Total reward:  46.76669575756763
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.679439465558822
DONE TAKING  40  STEPS.
Total reward:  287.869432760304
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.552907477897485
DONE TAKING  40  STEPS.
Total reward:  -809.565676860435
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.533827547944924
DONE TAKING  40  STEPS.
Total reward:  -175.38628541024812
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.808057374385605
DONE TAKING  40  STEPS.
Total reward:  -285.9117545994976
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -12.683810994913296
DONE TAKING  40  STEPS.
Total reward:  497.51540478250456
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -24.283639577122162
DONE TAKING  40  STEPS.
Total reward:  -361.69153175859947
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.774951020091176
DONE TAKING  40  STEPS.
Total reward:  -245.56075205596784
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -16.236551772026296
DONE TAKING  40  STEPS.
Total reward:  230.8741632406779
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -9.448010672172012
DONE TAKING  40  STEPS.
Total reward:  288.2032966381541
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -17.39485084597963
DONE TAKING  40  STEPS.
Total reward:  -148.6866181449654
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -9.176419240311883
DONE TAKING  40  STEPS.
Total reward:  628.906627752665
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.588088280293277
DONE TAKING  40  STEPS.
Total reward:  -182.91837682016228
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.77368235139959
DONE TAKING  40  STEPS.
Total reward:  -278.70756396699664
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.842998205400143
DONE TAKING  40  STEPS.
Total reward:  3.0313751779928957
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -13.134089915898816
DONE TAKING  40  STEPS.
Total reward:  81.7388634247781
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.553338497512463
DONE TAKING  40  STEPS.
Total reward:  -70.28718790010879
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.19529195846671
DONE TAKING  40  STEPS.
Total reward:  193.29012800125076
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -11.096979357537775
DONE TAKING  40  STEPS.
Total reward:  541.3820355072223
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.51920524502051
DONE TAKING  40  STEPS.
Total reward:  76.15531025431015
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.166314225169653
DONE TAKING  40  STEPS.
Total reward:  -110.78015517408649
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -11.006428493753726
DONE TAKING  40  STEPS.
Total reward:  472.1305240704777
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.88138391488236
DONE TAKING  40  STEPS.
Total reward:  -46.88317281666192
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -26.45142588587455
DONE TAKING  40  STEPS.
Total reward:  -187.14253445846998
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.968019954551274
DONE TAKING  40  STEPS.
Total reward:  -144.82681254283443
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.699978162932048
DONE TAKING  40  STEPS.
Total reward:  -11.319117682918751
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.521625879601146
DONE TAKING  40  STEPS.
Total reward:  51.93687794222272
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -24.608768471515244
DONE TAKING  40  STEPS.
Total reward:  -89.92931383237385
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.59463324615991
DONE TAKING  40  STEPS.
Total reward:  451.0510021567688
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.40442379780746
DONE TAKING  40  STEPS.
Total reward:  479.6075535327965
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.998496086521303
DONE TAKING  40  STEPS.
Total reward:  77.67827030566045
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.18684943342674
DONE TAKING  40  STEPS.
Total reward:  -286.9312356301301
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.377320438145397
DONE TAKING  40  STEPS.
Total reward:  162.47328059614338
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.299208030551704
DONE TAKING  40  STEPS.
Total reward:  143.02909657814942
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.23413494087774
DONE TAKING  40  STEPS.
Total reward:  4.679492075739109
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -19.90354260281962
DONE TAKING  40  STEPS.
Total reward:  392.7266227431413
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.795550496405024
DONE TAKING  40  STEPS.
Total reward:  89.98845386790487
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.7975394497651
DONE TAKING  40  STEPS.
Total reward:  202.5926313794853
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.49058068297689
DONE TAKING  40  STEPS.
Total reward:  281.85384285799654
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter80.ckpt

#####################################
Training the dynamics model..... iteration  81
#####################################

    amount of random data:  8000
    amount of onPol data:  119556
Prob rand:  23595
On pol:  116640
Prob shape:  (140235,)

=== Epoch 0 ===
    train loss:  0.3781086275210747
    val rand:  0.38777410984039307
    val onPol:  0.2996154135465622

=== Epoch 10 ===
    train loss:  0.21811432377759354
    val rand:  0.216639906167984
    val onPol:  0.24043054401874542

=== Epoch 20 ===
    train loss:  0.18556344896664112
    val rand:  0.17543929815292358
    val onPol:  0.23934105396270752

=== Epoch 30 ===
    train loss:  0.16431412139000037
    val rand:  0.17041921615600586
    val onPol:  0.24347110688686371

=== Epoch 39 ===
    train loss:  0.15101786203436798
    val rand:  0.17152702808380127
    val onPol:  0.25016389548778534
Training duration: 67.68 s

#####################################
performing on-policy MPC rollouts... iter  81
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -15.026512622493446
DONE TAKING  40  STEPS.
Total reward:  302.2939674560956
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.51479261430341
DONE TAKING  40  STEPS.
Total reward:  -227.79661314014626
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -20.197657997784688
DONE TAKING  40  STEPS.
Total reward:  -7.909687322622233
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -19.411423429382463
DONE TAKING  40  STEPS.
Total reward:  165.98370721517173
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.26748661656204
DONE TAKING  40  STEPS.
Total reward:  314.09238934518453
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.07385696296258
DONE TAKING  40  STEPS.
Total reward:  191.71598574231874
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.6665466737478
DONE TAKING  40  STEPS.
Total reward:  -198.89576686315817
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -13.70724200409632
DONE TAKING  40  STEPS.
Total reward:  488.14081346102125
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.18725802075985
DONE TAKING  40  STEPS.
Total reward:  189.9980423332259
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.171027138782073
DONE TAKING  40  STEPS.
Total reward:  -332.4425379424093
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.30124163555169
DONE TAKING  40  STEPS.
Total reward:  -254.3899052592556
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.50164198679184
DONE TAKING  40  STEPS.
Total reward:  -222.13599355856377
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.347867905693185
DONE TAKING  40  STEPS.
Total reward:  16.321291025158278
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -19.239647331033662
DONE TAKING  40  STEPS.
Total reward:  188.59847367123595
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.221918889758786
DONE TAKING  40  STEPS.
Total reward:  283.85820320619257
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.368312889260075
DONE TAKING  40  STEPS.
Total reward:  -523.9673555608829
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.504374933909142
DONE TAKING  40  STEPS.
Total reward:  8.014844695850122
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.101792245459844
DONE TAKING  40  STEPS.
Total reward:  -669.882101536733
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.05941506965664
DONE TAKING  40  STEPS.
Total reward:  172.62539200609757
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -10.4986980157046
DONE TAKING  40  STEPS.
Total reward:  -32.24800161282819
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.682047597686912
DONE TAKING  40  STEPS.
Total reward:  -313.9558237142392
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.578729434012445
DONE TAKING  40  STEPS.
Total reward:  -105.35808292336327
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.918211126132014
DONE TAKING  40  STEPS.
Total reward:  -295.9802146158485
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.09104871934621
DONE TAKING  40  STEPS.
Total reward:  -131.34278903085203
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.59248831794063
DONE TAKING  40  STEPS.
Total reward:  -364.64037669804276
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.655345664650778
DONE TAKING  40  STEPS.
Total reward:  -273.94841779601137
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.211035670209185
DONE TAKING  40  STEPS.
Total reward:  -404.0293577478976
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.73974387618101
DONE TAKING  40  STEPS.
Total reward:  115.16996058931305
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.07256870461593
DONE TAKING  40  STEPS.
Total reward:  -169.89583071148826
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.715809808903437
DONE TAKING  40  STEPS.
Total reward:  -532.4316148294408
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.430376981726116
DONE TAKING  40  STEPS.
Total reward:  52.104527328564046
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.11411203707885
DONE TAKING  40  STEPS.
Total reward:  -38.35254549439002
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.57192347894714
DONE TAKING  40  STEPS.
Total reward:  278.508779615774
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.701258001492302
DONE TAKING  40  STEPS.
Total reward:  -558.6430497476745
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.05342505038213
DONE TAKING  40  STEPS.
Total reward:  -906.851808569665
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -23.93625533660757
DONE TAKING  40  STEPS.
Total reward:  -231.31085772388
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.255009302758104
DONE TAKING  40  STEPS.
Total reward:  -461.69573759895076
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -26.00640977622213
DONE TAKING  40  STEPS.
Total reward:  -531.9505840376881
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.216815058885
DONE TAKING  40  STEPS.
Total reward:  -196.73231175024895
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.298942822679784
DONE TAKING  40  STEPS.
Total reward:  108.56624875425068
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter81.ckpt

#####################################
Training the dynamics model..... iteration  82
#####################################

    amount of random data:  8000
    amount of onPol data:  121032
Prob rand:  23790
On pol:  118080
Prob shape:  (141870,)

=== Epoch 0 ===
    train loss:  0.37396324165030936
    val rand:  0.40484189987182617
    val onPol:  0.2985810214281082

=== Epoch 10 ===
    train loss:  0.21832755595338044
    val rand:  0.21943168342113495
    val onPol:  0.23862417221069335

=== Epoch 20 ===
    train loss:  0.18543545084094312
    val rand:  0.18467208743095398
    val onPol:  0.23747620224952698

=== Epoch 30 ===
    train loss:  0.16466293809431123
    val rand:  0.16743478178977966
    val onPol:  0.24173365473747255

=== Epoch 39 ===
    train loss:  0.15284276196887778
    val rand:  0.17043080925941467
    val onPol:  0.24679048359394073
Training duration: 74.17 s

#####################################
performing on-policy MPC rollouts... iter  82
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.70171278291249
DONE TAKING  40  STEPS.
Total reward:  146.08775446650503
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.27489188512589
DONE TAKING  40  STEPS.
Total reward:  -112.61394435024116
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -30.91057401509063
DONE TAKING  40  STEPS.
Total reward:  -613.4882620855288
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.6744600991829
DONE TAKING  40  STEPS.
Total reward:  -558.9319855933811
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.38886222736076
DONE TAKING  40  STEPS.
Total reward:  35.79339290626677
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.84895911557465
DONE TAKING  40  STEPS.
Total reward:  -97.50640562847236
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.014808790772243
DONE TAKING  40  STEPS.
Total reward:  324.5306959670329
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -15.699251129849653
DONE TAKING  40  STEPS.
Total reward:  387.49502426219595
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.031906539428576
DONE TAKING  40  STEPS.
Total reward:  -234.99364370006734
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.763543325994306
DONE TAKING  40  STEPS.
Total reward:  -587.5826602922299
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.89341430044013
DONE TAKING  40  STEPS.
Total reward:  211.08792568580145
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.72940761951133
DONE TAKING  40  STEPS.
Total reward:  -914.4973013636222
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -30.50239922689794
DONE TAKING  40  STEPS.
Total reward:  -836.7022385117382
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.78603452089823
DONE TAKING  40  STEPS.
Total reward:  -510.06646818637205
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.075578762518823
DONE TAKING  40  STEPS.
Total reward:  138.94025987298267
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.703550128812648
DONE TAKING  40  STEPS.
Total reward:  241.61475978655875
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.286462724900026
DONE TAKING  40  STEPS.
Total reward:  -483.7696272609311
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.918225331574167
DONE TAKING  40  STEPS.
Total reward:  72.79250765974895
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.596408525817324
DONE TAKING  40  STEPS.
Total reward:  -449.89700259788145
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.14044433835233
DONE TAKING  40  STEPS.
Total reward:  -286.0275076232132
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.00597211920405
DONE TAKING  40  STEPS.
Total reward:  71.13653184530361
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.989880781941174
DONE TAKING  40  STEPS.
Total reward:  91.29318306724223
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.810571209445143
DONE TAKING  40  STEPS.
Total reward:  -719.7644741992837
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.64941155851581
DONE TAKING  40  STEPS.
Total reward:  -649.8738191985573
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.381851130025662
DONE TAKING  40  STEPS.
Total reward:  -228.22627417057913
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.910243779388935
DONE TAKING  40  STEPS.
Total reward:  -44.474498902715055
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.944441865317543
DONE TAKING  40  STEPS.
Total reward:  -35.22935115823147
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.0550410754523
DONE TAKING  40  STEPS.
Total reward:  -238.436512049287
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.86925272533136
DONE TAKING  40  STEPS.
Total reward:  -711.9682358733568
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -13.478370802248815
DONE TAKING  40  STEPS.
Total reward:  467.7383825493869
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.09357318738219
DONE TAKING  40  STEPS.
Total reward:  -32.52089054407969
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.27928440593942
DONE TAKING  40  STEPS.
Total reward:  421.15640781495
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.387023895213108
DONE TAKING  40  STEPS.
Total reward:  328.8549563459113
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.212052900310837
DONE TAKING  40  STEPS.
Total reward:  395.24075304060176
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.52044514182547
DONE TAKING  40  STEPS.
Total reward:  -386.48346638756567
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.410413332448087
DONE TAKING  40  STEPS.
Total reward:  -492.2672943125895
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.524448718772177
DONE TAKING  40  STEPS.
Total reward:  -493.3835232767482
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.479359181511043
DONE TAKING  40  STEPS.
Total reward:  410.9336093083206
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -13.809864156262224
DONE TAKING  40  STEPS.
Total reward:  469.5509228018831
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.826153131983993
DONE TAKING  40  STEPS.
Total reward:  -89.32454083804441
Time for 1 rollout: 1.35 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter82.ckpt

#####################################
Training the dynamics model..... iteration  83
#####################################

    amount of random data:  8000
    amount of onPol data:  122508
Prob rand:  23985
On pol:  119520
Prob shape:  (143505,)

=== Epoch 0 ===
    train loss:  0.3706364377268723
    val rand:  0.39449867606163025
    val onPol:  0.29733635902404787

=== Epoch 10 ===
    train loss:  0.21581711220954145
    val rand:  0.2058064043521881
    val onPol:  0.2384769266843796

=== Epoch 20 ===
    train loss:  0.18331415536148207
    val rand:  0.17661863565444946
    val onPol:  0.23838303446769715

=== Epoch 30 ===
    train loss:  0.16176392047532967
    val rand:  0.16952912509441376
    val onPol:  0.2420792120695114

=== Epoch 39 ===
    train loss:  0.14962411565440042
    val rand:  0.16527515649795532
    val onPol:  0.2478821486234665
Training duration: 68.46 s

#####################################
performing on-policy MPC rollouts... iter  83
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.336553508719874
DONE TAKING  40  STEPS.
Total reward:  -850.5541279765065
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.209453960114015
DONE TAKING  40  STEPS.
Total reward:  -145.90256938657103
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.6609075100936
DONE TAKING  40  STEPS.
Total reward:  248.35633794354845
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -19.83271131837387
DONE TAKING  40  STEPS.
Total reward:  394.8877904318315
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.588191231735223
DONE TAKING  40  STEPS.
Total reward:  -49.2860724643385
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.175370605977182
DONE TAKING  40  STEPS.
Total reward:  -3.384563756411243
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.01855509649873
DONE TAKING  40  STEPS.
Total reward:  -247.43147502520117
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.16729976487014
DONE TAKING  40  STEPS.
Total reward:  307.1237302383983
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -16.790197328686112
DONE TAKING  40  STEPS.
Total reward:  -438.87994514979385
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.673525725606336
DONE TAKING  40  STEPS.
Total reward:  226.48297250431713
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.183848097234574
DONE TAKING  40  STEPS.
Total reward:  209.73339759852297
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.09947004499258
DONE TAKING  40  STEPS.
Total reward:  232.75305743105338
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.31171418650162
DONE TAKING  40  STEPS.
Total reward:  -142.2604243983052
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.906075647735854
DONE TAKING  40  STEPS.
Total reward:  115.60302244600776
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.000805079403676
DONE TAKING  40  STEPS.
Total reward:  -845.5650454135741
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.15839930650165
DONE TAKING  40  STEPS.
Total reward:  136.873665904035
Time for 1 rollout: 1.37 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.217988668239418
DONE TAKING  40  STEPS.
Total reward:  238.3163995079819
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -12.367745790032124
DONE TAKING  40  STEPS.
Total reward:  -197.5332451676358
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.291941251070448
DONE TAKING  40  STEPS.
Total reward:  223.03352191894584
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.85421690527412
DONE TAKING  40  STEPS.
Total reward:  -549.9701848521303
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.339270391544375
DONE TAKING  40  STEPS.
Total reward:  193.5664552834352
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.758673943810273
DONE TAKING  40  STEPS.
Total reward:  -402.5129805640418
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.904913928335162
DONE TAKING  40  STEPS.
Total reward:  354.2392221277085
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -15.976171981036288
DONE TAKING  40  STEPS.
Total reward:  351.8592672689347
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.097589306159023
DONE TAKING  40  STEPS.
Total reward:  39.793525941131634
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.64325041114425
DONE TAKING  40  STEPS.
Total reward:  45.34524498354791
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.54480042511676
DONE TAKING  40  STEPS.
Total reward:  452.8314260856185
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.934971143698867
DONE TAKING  40  STEPS.
Total reward:  129.7813375655334
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.552565728358474
DONE TAKING  40  STEPS.
Total reward:  -124.44794180425717
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -18.668869814773842
DONE TAKING  40  STEPS.
Total reward:  -236.11718242785645
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.299961467292704
DONE TAKING  40  STEPS.
Total reward:  -124.21689064591958
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -14.937363594880871
DONE TAKING  40  STEPS.
Total reward:  -40.41991039114122
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.288151236766577
DONE TAKING  40  STEPS.
Total reward:  484.9229985543707
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.50622968199805
DONE TAKING  40  STEPS.
Total reward:  128.32492269112484
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -13.239197403624134
DONE TAKING  40  STEPS.
Total reward:  -40.9982374462232
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.20910630362407
DONE TAKING  40  STEPS.
Total reward:  -0.22858308772084257
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.304347765210345
DONE TAKING  40  STEPS.
Total reward:  268.34124479202933
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -12.375196040656892
DONE TAKING  40  STEPS.
Total reward:  193.845867935449
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.481375117703717
DONE TAKING  40  STEPS.
Total reward:  -523.5549057735107
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.125039766130612
DONE TAKING  40  STEPS.
Total reward:  39.70802340107937
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter83.ckpt

#####################################
Training the dynamics model..... iteration  84
#####################################

    amount of random data:  8000
    amount of onPol data:  123984
Prob rand:  24180
On pol:  120960
Prob shape:  (145140,)

=== Epoch 0 ===
    train loss:  0.3731716391054565
    val rand:  0.3973050117492676
    val onPol:  0.2976165792116752

=== Epoch 10 ===
    train loss:  0.21927763547998436
    val rand:  0.21570317447185516
    val onPol:  0.23915713738936645

=== Epoch 20 ===
    train loss:  0.18660670803208232
    val rand:  0.18585216999053955
    val onPol:  0.23675168248323294

=== Epoch 30 ===
    train loss:  0.16486093896859105
    val rand:  0.1728169173002243
    val onPol:  0.24112393821661288

=== Epoch 39 ===
    train loss:  0.15160912375357463
    val rand:  0.16814909875392914
    val onPol:  0.2467295642082508
Training duration: 74.51 s

#####################################
performing on-policy MPC rollouts... iter  84
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.344754847574702
DONE TAKING  40  STEPS.
Total reward:  48.54644891431596
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -18.960048910220543
DONE TAKING  40  STEPS.
Total reward:  -636.388610875787
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.84621571266365
DONE TAKING  40  STEPS.
Total reward:  160.1149747740232
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -18.549113967818325
DONE TAKING  40  STEPS.
Total reward:  -11.266934430610974
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.103099245076663
DONE TAKING  40  STEPS.
Total reward:  -744.9815708540465
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.813903443851324
DONE TAKING  40  STEPS.
Total reward:  276.10789185662736
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.20845736152268
DONE TAKING  40  STEPS.
Total reward:  217.71807982875
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.52311619043408
DONE TAKING  40  STEPS.
Total reward:  308.41410970611594
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.71783148690386
DONE TAKING  40  STEPS.
Total reward:  -606.8514899259671
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.3955443686245
DONE TAKING  40  STEPS.
Total reward:  417.2327260836663
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.867031052793635
DONE TAKING  40  STEPS.
Total reward:  -215.55661794394013
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.208082069835243
DONE TAKING  40  STEPS.
Total reward:  165.22424505346973
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.671042579960986
DONE TAKING  40  STEPS.
Total reward:  68.11649580694628
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.66227654455993
DONE TAKING  40  STEPS.
Total reward:  -147.59598791102752
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.076713390707244
DONE TAKING  40  STEPS.
Total reward:  -160.6003792624308
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.81049250006555
DONE TAKING  40  STEPS.
Total reward:  -476.8139457693421
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.053032809971896
DONE TAKING  40  STEPS.
Total reward:  300.36772940708005
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.03811942500617
DONE TAKING  40  STEPS.
Total reward:  -6.182023513616855
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.411044065165356
DONE TAKING  40  STEPS.
Total reward:  89.11640780032565
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.396097568307933
DONE TAKING  40  STEPS.
Total reward:  -101.35278766464583
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.747953371507144
DONE TAKING  40  STEPS.
Total reward:  26.67301208844724
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -20.46692944600274
DONE TAKING  40  STEPS.
Total reward:  -11.18873099112627
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.402791308714498
DONE TAKING  40  STEPS.
Total reward:  -133.69301921543752
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.962375678503054
DONE TAKING  40  STEPS.
Total reward:  -369.32363702213667
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.577072580832933
DONE TAKING  40  STEPS.
Total reward:  -14.317654788350751
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.18960415158771
DONE TAKING  40  STEPS.
Total reward:  161.09014375480314
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.529913527012724
DONE TAKING  40  STEPS.
Total reward:  -22.877696638368718
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.38158640001938
DONE TAKING  40  STEPS.
Total reward:  229.3604207848821
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.336120326186794
DONE TAKING  40  STEPS.
Total reward:  -79.71455910469945
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -16.00131177194456
DONE TAKING  40  STEPS.
Total reward:  492.1681465939432
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.89582837901394
DONE TAKING  40  STEPS.
Total reward:  154.6482084128549
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.106100366606498
DONE TAKING  40  STEPS.
Total reward:  -212.27059504606066
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.2172261900194
DONE TAKING  40  STEPS.
Total reward:  -413.75050350109217
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.218297495787168
DONE TAKING  40  STEPS.
Total reward:  121.52214057220375
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.42611785721559
DONE TAKING  40  STEPS.
Total reward:  -343.8068206873703
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.67864875481764
DONE TAKING  40  STEPS.
Total reward:  70.43494592938919
Time for 1 rollout: 1.35 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.746196418971024
DONE TAKING  40  STEPS.
Total reward:  -35.465897363496225
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.099466425467043
DONE TAKING  40  STEPS.
Total reward:  323.0016223639954
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.11198996879489
DONE TAKING  40  STEPS.
Total reward:  45.499592818035495
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.639354427504852
DONE TAKING  40  STEPS.
Total reward:  -676.7538084109906
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter84.ckpt

#####################################
Training the dynamics model..... iteration  85
#####################################

    amount of random data:  8000
    amount of onPol data:  125460
Prob rand:  24375
On pol:  122400
Prob shape:  (146775,)

=== Epoch 0 ===
    train loss:  0.37390753814390487
    val rand:  0.39711427688598633
    val onPol:  0.29725019289897037

=== Epoch 10 ===
    train loss:  0.21877001048801661
    val rand:  0.2130599021911621
    val onPol:  0.2380826736872013

=== Epoch 20 ===
    train loss:  0.18538768678069947
    val rand:  0.1793253868818283
    val onPol:  0.23605556786060333

=== Epoch 30 ===
    train loss:  0.1650996268629194
    val rand:  0.17080864310264587
    val onPol:  0.23911931938849962

=== Epoch 39 ===
    train loss:  0.15284251687409994
    val rand:  0.17010259628295898
    val onPol:  0.24442351666780618
Training duration: 75.54 s

#####################################
performing on-policy MPC rollouts... iter  85
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.154601301339515
DONE TAKING  40  STEPS.
Total reward:  351.6394686982453
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.701935248153863
DONE TAKING  40  STEPS.
Total reward:  -744.8151604435424
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.507820601256135
DONE TAKING  40  STEPS.
Total reward:  164.27175350239568
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.153498527674927
DONE TAKING  40  STEPS.
Total reward:  -95.21728346512123
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.64593337888155
DONE TAKING  40  STEPS.
Total reward:  -169.28111298489452
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -12.721757990617572
DONE TAKING  40  STEPS.
Total reward:  -100.08205582687398
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.889634437291203
DONE TAKING  40  STEPS.
Total reward:  -378.19162459930396
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.497504489163724
DONE TAKING  40  STEPS.
Total reward:  -74.7651316531042
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.826785769459022
DONE TAKING  40  STEPS.
Total reward:  -581.8986386753708
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.148160125280768
DONE TAKING  40  STEPS.
Total reward:  235.85427810152737
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.488403556763608
DONE TAKING  40  STEPS.
Total reward:  -203.09738257218777
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.088856509085318
DONE TAKING  40  STEPS.
Total reward:  -531.0328181446017
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.640672838841557
DONE TAKING  40  STEPS.
Total reward:  323.2496043891807
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.38880088792817
DONE TAKING  40  STEPS.
Total reward:  -197.90109636654327
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.376323515891551
DONE TAKING  40  STEPS.
Total reward:  135.75547676446035
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.839248291175004
DONE TAKING  40  STEPS.
Total reward:  -47.05440778675128
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.355800116528474
DONE TAKING  40  STEPS.
Total reward:  139.1459164471255
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.01852734773203
DONE TAKING  40  STEPS.
Total reward:  21.775978520163175
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.50203363929479
DONE TAKING  40  STEPS.
Total reward:  111.69233615002531
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.30308630995973
DONE TAKING  40  STEPS.
Total reward:  -355.96271399079785
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.34317034523016
DONE TAKING  40  STEPS.
Total reward:  -609.364300785697
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.99039926998316
DONE TAKING  40  STEPS.
Total reward:  -105.35067338287018
Time for 1 rollout: 1.35 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.681325208430323
DONE TAKING  40  STEPS.
Total reward:  -336.1344074222704
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.00895352443989
DONE TAKING  40  STEPS.
Total reward:  -796.3482073594552
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.718861897330324
DONE TAKING  40  STEPS.
Total reward:  26.028028541413754
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.550034300071417
DONE TAKING  40  STEPS.
Total reward:  -19.710815102632967
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.103429820138533
DONE TAKING  40  STEPS.
Total reward:  176.76678253326529
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.578640147965437
DONE TAKING  40  STEPS.
Total reward:  455.34032965458357
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.50984448738042
DONE TAKING  40  STEPS.
Total reward:  -136.9503639927563
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.872176463300985
DONE TAKING  40  STEPS.
Total reward:  -538.9813437853115
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -26.186594292608042
DONE TAKING  40  STEPS.
Total reward:  -36.37624158934811
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.724158672505062
DONE TAKING  40  STEPS.
Total reward:  131.26069402934704
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.525780352856167
DONE TAKING  40  STEPS.
Total reward:  -182.53567549591392
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.000124529548295
DONE TAKING  40  STEPS.
Total reward:  198.4016316794731
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -19.430574432083173
DONE TAKING  40  STEPS.
Total reward:  -510.2406011455466
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.25058644865693
DONE TAKING  40  STEPS.
Total reward:  511.2596907044888
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.75102887822053
DONE TAKING  40  STEPS.
Total reward:  173.28602912272132
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.164729134738785
DONE TAKING  40  STEPS.
Total reward:  -6.316479659835654
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.795719566573453
DONE TAKING  40  STEPS.
Total reward:  -204.94847266089093
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.56643742326584
DONE TAKING  40  STEPS.
Total reward:  -34.41650304923688
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter85.ckpt

#####################################
Training the dynamics model..... iteration  86
#####################################

    amount of random data:  8000
    amount of onPol data:  126936
Prob rand:  24570
On pol:  123840
Prob shape:  (148410,)

=== Epoch 0 ===
    train loss:  0.3735750524849215
    val rand:  0.38397687673568726
    val onPol:  0.29609039769722867

=== Epoch 10 ===
    train loss:  0.21811937007112073
    val rand:  0.21766316890716553
    val onPol:  0.236348369373725

=== Epoch 20 ===
    train loss:  0.1864963544590663
    val rand:  0.18115560710430145
    val onPol:  0.23406933419979536

=== Epoch 30 ===
    train loss:  0.1664091601297517
    val rand:  0.17123857140541077
    val onPol:  0.2386251647885029

=== Epoch 39 ===
    train loss:  0.15356383526820214
    val rand:  0.16761824488639832
    val onPol:  0.24359513933841997
Training duration: 71.61 s

#####################################
performing on-policy MPC rollouts... iter  86
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.08614312646014
DONE TAKING  40  STEPS.
Total reward:  225.14031815228125
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.26203961520722
DONE TAKING  40  STEPS.
Total reward:  -411.60793375711086
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -26.744587919923127
DONE TAKING  40  STEPS.
Total reward:  -811.5798707790475
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.90951970018291
DONE TAKING  40  STEPS.
Total reward:  -562.157058824443
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.450785308394927
DONE TAKING  40  STEPS.
Total reward:  306.2491924918887
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.86465298229984
DONE TAKING  40  STEPS.
Total reward:  -561.8962147868285
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -15.928040950244004
DONE TAKING  40  STEPS.
Total reward:  170.67911588656415
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.667065164761457
DONE TAKING  40  STEPS.
Total reward:  1.940588795784432
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.81445910704377
DONE TAKING  40  STEPS.
Total reward:  -838.8349369431417
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.305091205999997
DONE TAKING  40  STEPS.
Total reward:  147.03896619403284
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.61516577013238
DONE TAKING  40  STEPS.
Total reward:  296.66818052368615
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.197658141750736
DONE TAKING  40  STEPS.
Total reward:  -580.9964191256961
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.763986476103653
DONE TAKING  40  STEPS.
Total reward:  146.36001126704542
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.088358151921142
DONE TAKING  40  STEPS.
Total reward:  452.5445031805468
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.00879467876191
DONE TAKING  40  STEPS.
Total reward:  282.6134843922598
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -31.012784094099857
DONE TAKING  40  STEPS.
Total reward:  -104.26795443742698
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.3092407057802
DONE TAKING  40  STEPS.
Total reward:  241.12769900742578
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.727803824799903
DONE TAKING  40  STEPS.
Total reward:  -368.51109793811264
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.56575586331112
DONE TAKING  40  STEPS.
Total reward:  -384.4097983917502
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -12.144159215355348
DONE TAKING  40  STEPS.
Total reward:  118.76269669094104
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.68203955101272
DONE TAKING  40  STEPS.
Total reward:  475.5134810189639
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.794657753432908
DONE TAKING  40  STEPS.
Total reward:  -520.3717032621631
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -19.80505253662486
DONE TAKING  40  STEPS.
Total reward:  253.41529206560705
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.98139307050822
DONE TAKING  40  STEPS.
Total reward:  47.96717996586443
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.868192761978
DONE TAKING  40  STEPS.
Total reward:  318.64121643395936
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.078599932204316
DONE TAKING  40  STEPS.
Total reward:  -458.9084165296805
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -25.276817679155144
DONE TAKING  40  STEPS.
Total reward:  101.41435039502917
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.767574156241125
DONE TAKING  40  STEPS.
Total reward:  -781.0391245768377
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -13.087847275073461
DONE TAKING  40  STEPS.
Total reward:  -262.36528144345095
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -19.88316561135879
DONE TAKING  40  STEPS.
Total reward:  96.32395876302591
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -31.33192825135241
DONE TAKING  40  STEPS.
Total reward:  -72.32312195194469
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.743390932955457
DONE TAKING  40  STEPS.
Total reward:  -428.4690108627627
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -17.048719413996423
DONE TAKING  40  STEPS.
Total reward:  405.4809115286808
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -12.557290165589832
DONE TAKING  40  STEPS.
Total reward:  -77.50644538210884
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.616223060201758
DONE TAKING  40  STEPS.
Total reward:  197.69363986504766
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.469462978642394
DONE TAKING  40  STEPS.
Total reward:  -485.6690686840461
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.36741050398028
DONE TAKING  40  STEPS.
Total reward:  425.0947799927485
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.748749127806096
DONE TAKING  40  STEPS.
Total reward:  245.1203285044404
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -12.362747944300068
DONE TAKING  40  STEPS.
Total reward:  598.2296499470449
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -12.225622933700942
DONE TAKING  40  STEPS.
Total reward:  326.01519663235575
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter86.ckpt

#####################################
Training the dynamics model..... iteration  87
#####################################

    amount of random data:  8000
    amount of onPol data:  128412
Prob rand:  24765
On pol:  125280
Prob shape:  (150045,)

=== Epoch 0 ===
    train loss:  0.37397024889854846
    val rand:  0.3822638988494873
    val onPol:  0.29979366671156

=== Epoch 10 ===
    train loss:  0.2191804238045175
    val rand:  0.2219381183385849
    val onPol:  0.24077043102847207

=== Epoch 20 ===
    train loss:  0.1871789231031828
    val rand:  0.1834547370672226
    val onPol:  0.23674850165843964

=== Epoch 30 ===
    train loss:  0.1674963135157836
    val rand:  0.17202553153038025
    val onPol:  0.24161037581938286

=== Epoch 39 ===
    train loss:  0.1544728273010905
    val rand:  0.17045935988426208
    val onPol:  0.24795223110251957
Training duration: 70.58 s

#####################################
performing on-policy MPC rollouts... iter  87
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.774453863387446
DONE TAKING  40  STEPS.
Total reward:  307.6436940024663
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.16843832712464
DONE TAKING  40  STEPS.
Total reward:  113.70632333753488
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.81768920067254
DONE TAKING  40  STEPS.
Total reward:  -111.24285804979448
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.285520301304942
DONE TAKING  40  STEPS.
Total reward:  140.55556431597216
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.936168947572654
DONE TAKING  40  STEPS.
Total reward:  -541.8952053999577
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.798529544763046
DONE TAKING  40  STEPS.
Total reward:  114.34324903936133
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.323044546508548
DONE TAKING  40  STEPS.
Total reward:  -415.5774611169362
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -13.597115194608467
DONE TAKING  40  STEPS.
Total reward:  -5.167053332335418
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.796866515559515
DONE TAKING  40  STEPS.
Total reward:  -151.79346607306476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.253644184734654
DONE TAKING  40  STEPS.
Total reward:  15.55951024888805
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.036750426645987
DONE TAKING  40  STEPS.
Total reward:  -194.84808297145352
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -12.877994472189338
DONE TAKING  40  STEPS.
Total reward:  163.1741443049301
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.460881756660225
DONE TAKING  40  STEPS.
Total reward:  232.80040085214563
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.917072280541092
DONE TAKING  40  STEPS.
Total reward:  63.51059639564272
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.294248213278667
DONE TAKING  40  STEPS.
Total reward:  -61.64235930193884
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.070743722322135
DONE TAKING  40  STEPS.
Total reward:  55.28127413622918
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -14.088702612548671
DONE TAKING  40  STEPS.
Total reward:  153.2835935738739
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.808379276341476
DONE TAKING  40  STEPS.
Total reward:  -196.2173450630132
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.214461512952862
DONE TAKING  40  STEPS.
Total reward:  602.666542118413
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.820792680514973
DONE TAKING  40  STEPS.
Total reward:  206.80922356142366
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.615698578071175
DONE TAKING  40  STEPS.
Total reward:  -94.17471434347331
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.02169596080227
DONE TAKING  40  STEPS.
Total reward:  -508.9957833429834
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.43463015488363
DONE TAKING  40  STEPS.
Total reward:  -147.94375435220076
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.676114774015545
DONE TAKING  40  STEPS.
Total reward:  392.4230622283628
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.8984011268752
DONE TAKING  40  STEPS.
Total reward:  362.1824428504016
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.859334554620526
DONE TAKING  40  STEPS.
Total reward:  432.4329065933689
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.021533686061765
DONE TAKING  40  STEPS.
Total reward:  -555.5839817658198
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.711267085638404
DONE TAKING  40  STEPS.
Total reward:  320.73880128320593
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.04381541933317
DONE TAKING  40  STEPS.
Total reward:  176.79617209350943
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.716768865998873
DONE TAKING  40  STEPS.
Total reward:  181.40605681117557
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.291564865623016
DONE TAKING  40  STEPS.
Total reward:  206.35654317224402
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.956736797572482
DONE TAKING  40  STEPS.
Total reward:  1.3072572301851366
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.254504586564416
DONE TAKING  40  STEPS.
Total reward:  -6.086985111443489
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.056257297057765
DONE TAKING  40  STEPS.
Total reward:  -162.96918277979975
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.03265021072776
DONE TAKING  40  STEPS.
Total reward:  -135.04919809547707
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -10.54134095646024
DONE TAKING  40  STEPS.
Total reward:  578.058707426516
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.760939186797728
DONE TAKING  40  STEPS.
Total reward:  -458.7134375415909
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.2998497004318
DONE TAKING  40  STEPS.
Total reward:  -561.2015811031424
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.155761558512662
DONE TAKING  40  STEPS.
Total reward:  301.77434968816044
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.213497760394315
DONE TAKING  40  STEPS.
Total reward:  385.9291919662139
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter87.ckpt

#####################################
Training the dynamics model..... iteration  88
#####################################

    amount of random data:  8000
    amount of onPol data:  129888
Prob rand:  24960
On pol:  126720
Prob shape:  (151680,)

=== Epoch 0 ===
    train loss:  0.3736818416698559
    val rand:  0.380248486995697
    val onPol:  0.2982498065189079

=== Epoch 10 ===
    train loss:  0.21863862132099834
    val rand:  0.21324436366558075
    val onPol:  0.2383898678753111

=== Epoch 20 ===
    train loss:  0.18686077366205486
    val rand:  0.18497377634048462
    val onPol:  0.23461582760016123

=== Epoch 30 ===
    train loss:  0.1675045242080012
    val rand:  0.17224225401878357
    val onPol:  0.23937216345910672

=== Epoch 39 ===
    train loss:  0.155218245914659
    val rand:  0.16963958740234375
    val onPol:  0.24414132093941723
Training duration: 76.07 s

#####################################
performing on-policy MPC rollouts... iter  88
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.620999851228003
DONE TAKING  40  STEPS.
Total reward:  249.92072205228664
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.38322053720521
DONE TAKING  40  STEPS.
Total reward:  298.6721647727027
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.522745135372066
DONE TAKING  40  STEPS.
Total reward:  -612.0226443724522
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.981730898297087
DONE TAKING  40  STEPS.
Total reward:  -517.4088630475197
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.00786895386371
DONE TAKING  40  STEPS.
Total reward:  -194.4561038274716
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.46255428402862
DONE TAKING  40  STEPS.
Total reward:  -1.9673594268452281
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -20.576287468181636
DONE TAKING  40  STEPS.
Total reward:  -0.9815900941601683
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.977386408112675
DONE TAKING  40  STEPS.
Total reward:  -97.75799870587107
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.35269551312284
DONE TAKING  40  STEPS.
Total reward:  189.10190418457216
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -11.29841225929278
DONE TAKING  40  STEPS.
Total reward:  -330.3276584124219
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.008402428268834
DONE TAKING  40  STEPS.
Total reward:  -588.8402163441731
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -15.669116717960701
DONE TAKING  40  STEPS.
Total reward:  314.8244626169168
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.616132271356403
DONE TAKING  40  STEPS.
Total reward:  279.67345633296094
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.893254774846834
DONE TAKING  40  STEPS.
Total reward:  -169.488187693346
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.264102752827636
DONE TAKING  40  STEPS.
Total reward:  151.05144142946298
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.166520011681232
DONE TAKING  40  STEPS.
Total reward:  -311.368592684909
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.556078221620794
DONE TAKING  40  STEPS.
Total reward:  -272.71139275583636
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.282403972329014
DONE TAKING  40  STEPS.
Total reward:  87.46030827384772
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.539497437521007
DONE TAKING  40  STEPS.
Total reward:  -95.24438723019512
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.43281367825291
DONE TAKING  40  STEPS.
Total reward:  225.52027122799734
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -11.364472527304848
DONE TAKING  40  STEPS.
Total reward:  523.1496472577695
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -31.323581061596308
DONE TAKING  40  STEPS.
Total reward:  -763.0354063421167
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -20.403227392347098
DONE TAKING  40  STEPS.
Total reward:  432.92440007411307
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -31.373557389788292
DONE TAKING  40  STEPS.
Total reward:  -384.79057050710094
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.69691138964479
DONE TAKING  40  STEPS.
Total reward:  306.97021480358865
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.219358965855857
DONE TAKING  40  STEPS.
Total reward:  482.06950618033045
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.10102162019753
DONE TAKING  40  STEPS.
Total reward:  -66.44384827361404
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.41426725541554
DONE TAKING  40  STEPS.
Total reward:  -276.1125512552601
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.62999966284906
DONE TAKING  40  STEPS.
Total reward:  -343.2056202201536
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.779533562540813
DONE TAKING  40  STEPS.
Total reward:  190.65886939398757
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.161765016132343
DONE TAKING  40  STEPS.
Total reward:  52.905070167735914
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.59951546253918
DONE TAKING  40  STEPS.
Total reward:  307.5938351491945
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.86221634428251
DONE TAKING  40  STEPS.
Total reward:  187.40049834783375
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.877998843547246
DONE TAKING  40  STEPS.
Total reward:  98.80409131268736
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.055469782572906
DONE TAKING  40  STEPS.
Total reward:  -273.0526205447777
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -15.297710280316586
DONE TAKING  40  STEPS.
Total reward:  383.43561347492727
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.07966937307623
DONE TAKING  40  STEPS.
Total reward:  -541.0270495410136
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.842903184318168
DONE TAKING  40  STEPS.
Total reward:  -160.34278560899384
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.38011469615886
DONE TAKING  40  STEPS.
Total reward:  -287.6830465700613
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -31.07969159531223
DONE TAKING  40  STEPS.
Total reward:  -151.66583475232179
Time for 1 rollout: 1.35 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter88.ckpt

#####################################
Training the dynamics model..... iteration  89
#####################################

    amount of random data:  8000
    amount of onPol data:  131364
Prob rand:  25155
On pol:  128160
Prob shape:  (153315,)

=== Epoch 0 ===
    train loss:  0.3728209837623265
    val rand:  0.3973526656627655
    val onPol:  0.2980614359732027

=== Epoch 10 ===
    train loss:  0.21869653503232975
    val rand:  0.21218155324459076
    val onPol:  0.23741157076976918

=== Epoch 20 ===
    train loss:  0.18713693943709434
    val rand:  0.1903708279132843
    val onPol:  0.23438437890123437

=== Epoch 30 ===
    train loss:  0.1672190465157646
    val rand:  0.16895970702171326
    val onPol:  0.23704798574800845

=== Epoch 39 ===
    train loss:  0.15376018162156427
    val rand:  0.1692626178264618
    val onPol:  0.2418988805126261
Training duration: 74.79 s

#####################################
performing on-policy MPC rollouts... iter  89
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.01979455595788
DONE TAKING  40  STEPS.
Total reward:  -588.6382921929105
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.50326601613738
DONE TAKING  40  STEPS.
Total reward:  202.99058101523437
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.414468436052996
DONE TAKING  40  STEPS.
Total reward:  263.525174484726
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.54642560982831
DONE TAKING  40  STEPS.
Total reward:  142.27701886083625
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.377726940575158
DONE TAKING  40  STEPS.
Total reward:  99.86433336073657
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.530213810976804
DONE TAKING  40  STEPS.
Total reward:  100.92035967754876
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.08607686441366
DONE TAKING  40  STEPS.
Total reward:  -189.15265320118584
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.866452065417608
DONE TAKING  40  STEPS.
Total reward:  -28.40380866905063
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.286168439640942
DONE TAKING  40  STEPS.
Total reward:  196.6730230944505
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.977295110040295
DONE TAKING  40  STEPS.
Total reward:  -755.5598833360125
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.16963480117502
DONE TAKING  40  STEPS.
Total reward:  93.66199184010831
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.864817716294734
DONE TAKING  40  STEPS.
Total reward:  -478.9024054451029
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -20.749769606820074
DONE TAKING  40  STEPS.
Total reward:  292.24095400088976
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.585716714649326
DONE TAKING  40  STEPS.
Total reward:  -203.6308033189115
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.277236052002152
DONE TAKING  40  STEPS.
Total reward:  78.20000041736503
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.372207967255463
DONE TAKING  40  STEPS.
Total reward:  410.2825499962572
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.26391589451297
DONE TAKING  40  STEPS.
Total reward:  -258.6211302062159
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.051886761057908
DONE TAKING  40  STEPS.
Total reward:  376.4176591639739
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.78027810266025
DONE TAKING  40  STEPS.
Total reward:  -113.36356678541935
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.58183907568779
DONE TAKING  40  STEPS.
Total reward:  -180.97957487685193
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.11735144335396
DONE TAKING  40  STEPS.
Total reward:  45.812800444714796
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -31.370260150582258
DONE TAKING  40  STEPS.
Total reward:  -343.5693216241587
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.289369816658578
DONE TAKING  40  STEPS.
Total reward:  -15.4520879082744
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.343804100659334
DONE TAKING  40  STEPS.
Total reward:  -113.67921937358746
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.68436449365027
DONE TAKING  40  STEPS.
Total reward:  -511.7509459635971
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -27.528090659071232
DONE TAKING  40  STEPS.
Total reward:  -139.75519931176643
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.292003912680862
DONE TAKING  40  STEPS.
Total reward:  31.530262725061785
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.919883861228936
DONE TAKING  40  STEPS.
Total reward:  -53.79186811352537
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.50248307462243
DONE TAKING  40  STEPS.
Total reward:  201.1984407761689
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.260797861873343
DONE TAKING  40  STEPS.
Total reward:  233.4790104370018
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.736186201218686
DONE TAKING  40  STEPS.
Total reward:  42.09073437525407
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.28629685044284
DONE TAKING  40  STEPS.
Total reward:  -41.264103661396035
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.06143602468754
DONE TAKING  40  STEPS.
Total reward:  305.7614294168715
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.48583686268539
DONE TAKING  40  STEPS.
Total reward:  -156.17220554109366
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.16590270764906
DONE TAKING  40  STEPS.
Total reward:  240.64740668986838
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.257151000313023
DONE TAKING  40  STEPS.
Total reward:  297.17467048690366
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.790416726481233
DONE TAKING  40  STEPS.
Total reward:  -122.82812054077289
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.665890662187095
DONE TAKING  40  STEPS.
Total reward:  224.1371631611447
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.883686739022977
DONE TAKING  40  STEPS.
Total reward:  -722.8088053115298
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.39153338809822
DONE TAKING  40  STEPS.
Total reward:  -594.1818358474488
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter89.ckpt

#####################################
Training the dynamics model..... iteration  90
#####################################

    amount of random data:  8000
    amount of onPol data:  132840
Prob rand:  25350
On pol:  129600
Prob shape:  (154950,)

=== Epoch 0 ===
    train loss:  0.3704835716264927
    val rand:  0.3854304254055023
    val onPol:  0.29728484473058153

=== Epoch 10 ===
    train loss:  0.2184739386699847
    val rand:  0.21470874547958374
    val onPol:  0.23687058953302248

=== Epoch 20 ===
    train loss:  0.18880468577343895
    val rand:  0.1827685683965683
    val onPol:  0.2330336794257164

=== Epoch 30 ===
    train loss:  0.16920280782197486
    val rand:  0.17474901676177979
    val onPol:  0.23658814973064832

=== Epoch 39 ===
    train loss:  0.15629761305865864
    val rand:  0.17069165408611298
    val onPol:  0.24085846915841103
Training duration: 75.51 s

#####################################
performing on-policy MPC rollouts... iter  90
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.343507160579357
DONE TAKING  40  STEPS.
Total reward:  -28.93543785186287
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.952248030993292
DONE TAKING  40  STEPS.
Total reward:  -637.2923508926308
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.012068078530014
DONE TAKING  40  STEPS.
Total reward:  435.70412129257153
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -14.795599409702668
DONE TAKING  40  STEPS.
Total reward:  96.01019095168778
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.807552412965904
DONE TAKING  40  STEPS.
Total reward:  275.3573492189883
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.38555436183004
DONE TAKING  40  STEPS.
Total reward:  135.0777862261601
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.920063209139958
DONE TAKING  40  STEPS.
Total reward:  -106.06862591504351
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -26.126190675448623
DONE TAKING  40  STEPS.
Total reward:  -374.8083143644318
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.681211179653708
DONE TAKING  40  STEPS.
Total reward:  -405.3651861105457
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -14.903966378453646
DONE TAKING  40  STEPS.
Total reward:  476.56470308120277
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.645802310758217
DONE TAKING  40  STEPS.
Total reward:  84.74036870890208
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.47247778494928
DONE TAKING  40  STEPS.
Total reward:  292.15634606418223
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.97552830183624
DONE TAKING  40  STEPS.
Total reward:  -111.23413213894445
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.99176607380398
DONE TAKING  40  STEPS.
Total reward:  262.1616919595076
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.004290504391587
DONE TAKING  40  STEPS.
Total reward:  330.51434598214837
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.062850760097405
DONE TAKING  40  STEPS.
Total reward:  -103.8594489912808
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -15.854456183692356
DONE TAKING  40  STEPS.
Total reward:  452.12168518551937
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.217909678219073
DONE TAKING  40  STEPS.
Total reward:  -89.48702954857345
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.64644833752429
DONE TAKING  40  STEPS.
Total reward:  41.29151430621387
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.5857835466883
DONE TAKING  40  STEPS.
Total reward:  -6.236698914425432
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.26875309980251
DONE TAKING  40  STEPS.
Total reward:  -511.67392676305303
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.296499616923192
DONE TAKING  40  STEPS.
Total reward:  -673.0528216592663
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -12.139570209345381
DONE TAKING  40  STEPS.
Total reward:  5.932300955899983
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.76530762105938
DONE TAKING  40  STEPS.
Total reward:  342.57590688296165
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.900115904104812
DONE TAKING  40  STEPS.
Total reward:  130.1872677429533
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.421029568806752
DONE TAKING  40  STEPS.
Total reward:  154.78628867550555
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -13.185417965006096
DONE TAKING  40  STEPS.
Total reward:  55.69322151889652
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.47213951494082
DONE TAKING  40  STEPS.
Total reward:  223.77539409161125
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.573217717843114
DONE TAKING  40  STEPS.
Total reward:  -589.4647296403102
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.014023367042018
DONE TAKING  40  STEPS.
Total reward:  -260.08230027572637
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.249961126656146
DONE TAKING  40  STEPS.
Total reward:  -346.9662714013023
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.62829269795999
DONE TAKING  40  STEPS.
Total reward:  244.29365595775815
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -15.440632197054072
DONE TAKING  40  STEPS.
Total reward:  329.3282730788836
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -31.20764936646181
DONE TAKING  40  STEPS.
Total reward:  142.5684844357901
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -11.759151175948695
DONE TAKING  40  STEPS.
Total reward:  -71.08596861527182
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.43441980784394
DONE TAKING  40  STEPS.
Total reward:  173.07311313384255
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -16.172496667328197
DONE TAKING  40  STEPS.
Total reward:  112.65321958580003
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.05558279051249
DONE TAKING  40  STEPS.
Total reward:  242.04861031415393
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -18.00176400146831
DONE TAKING  40  STEPS.
Total reward:  -584.3711789626544
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.383615627407224
DONE TAKING  40  STEPS.
Total reward:  -121.87727483992535
Time for 1 rollout: 1.25 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter90.ckpt

#####################################
Training the dynamics model..... iteration  91
#####################################

    amount of random data:  8000
    amount of onPol data:  134316
Prob rand:  25545
On pol:  131040
Prob shape:  (156585,)

=== Epoch 0 ===
    train loss:  0.3738177031767173
    val rand:  0.3920774459838867
    val onPol:  0.2981298023036548

=== Epoch 10 ===
    train loss:  0.21835727862647322
    val rand:  0.2146119773387909
    val onPol:  0.23630077924047196

=== Epoch 20 ===
    train loss:  0.18666634271379376
    val rand:  0.17819595336914062
    val onPol:  0.23307690822652408

=== Epoch 30 ===
    train loss:  0.16854600583920715
    val rand:  0.17174741625785828
    val onPol:  0.2367033591227872

=== Epoch 39 ===
    train loss:  0.15645942653788894
    val rand:  0.16701197624206543
    val onPol:  0.24096764198371343
Training duration: 76.28 s

#####################################
performing on-policy MPC rollouts... iter  91
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -20.911323663761067
DONE TAKING  40  STEPS.
Total reward:  108.99440308973482
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -13.424821025678618
DONE TAKING  40  STEPS.
Total reward:  486.2443806728411
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -22.743248401334505
DONE TAKING  40  STEPS.
Total reward:  329.8534275373076
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.32222993072772
DONE TAKING  40  STEPS.
Total reward:  -383.78745154910143
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.711348667081133
DONE TAKING  40  STEPS.
Total reward:  225.3944125935059
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.035384731342326
DONE TAKING  40  STEPS.
Total reward:  126.98944192810887
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.432017952538008
DONE TAKING  40  STEPS.
Total reward:  236.2737236664737
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.293645774579286
DONE TAKING  40  STEPS.
Total reward:  -45.02557087175492
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.342444525437024
DONE TAKING  40  STEPS.
Total reward:  271.30172320741724
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.82288956556794
DONE TAKING  40  STEPS.
Total reward:  344.6902272033486
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.202187209305606
DONE TAKING  40  STEPS.
Total reward:  123.81044235381941
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -15.948216656323027
DONE TAKING  40  STEPS.
Total reward:  166.46736471762253
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -29.94910235945003
DONE TAKING  40  STEPS.
Total reward:  -335.2171620444565
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.60054625656524
DONE TAKING  40  STEPS.
Total reward:  -34.75623956311652
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.47675464034275
DONE TAKING  40  STEPS.
Total reward:  -243.74745684538397
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.044521727555907
DONE TAKING  40  STEPS.
Total reward:  47.31539246529587
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.326274127499655
DONE TAKING  40  STEPS.
Total reward:  66.89227890790815
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -23.87842629756003
DONE TAKING  40  STEPS.
Total reward:  36.063147461067075
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.013058393378792
DONE TAKING  40  STEPS.
Total reward:  -80.74888783315672
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.934313739403066
DONE TAKING  40  STEPS.
Total reward:  -328.3975496825566
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.26877057262497
DONE TAKING  40  STEPS.
Total reward:  123.92615614401106
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.569565684189177
DONE TAKING  40  STEPS.
Total reward:  32.13412982748112
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.5160708287625
DONE TAKING  40  STEPS.
Total reward:  141.52925233355768
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.579362756894795
DONE TAKING  40  STEPS.
Total reward:  287.8150805187934
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.2052799846865
DONE TAKING  40  STEPS.
Total reward:  -829.6318097528517
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.80434696604964
DONE TAKING  40  STEPS.
Total reward:  -373.5403152941289
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.96562100454407
DONE TAKING  40  STEPS.
Total reward:  145.76670325939673
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.275345179104924
DONE TAKING  40  STEPS.
Total reward:  11.108121726069964
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.99018949945935
DONE TAKING  40  STEPS.
Total reward:  -70.17201860209504
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.16210990034324
DONE TAKING  40  STEPS.
Total reward:  241.53443049721454
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -11.859083455585957
DONE TAKING  40  STEPS.
Total reward:  310.1997784644089
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.157673723961388
DONE TAKING  40  STEPS.
Total reward:  322.50276490105676
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.01228292793463
DONE TAKING  40  STEPS.
Total reward:  -191.573903161998
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.30314520887787
DONE TAKING  40  STEPS.
Total reward:  -101.71502566238718
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -13.192933064929381
DONE TAKING  40  STEPS.
Total reward:  131.22514791154646
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.04097755863312
DONE TAKING  40  STEPS.
Total reward:  -518.4593872961453
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.982806584473774
DONE TAKING  40  STEPS.
Total reward:  -522.9184757446506
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.49826041182999
DONE TAKING  40  STEPS.
Total reward:  -111.3528247120301
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.745809495847706
DONE TAKING  40  STEPS.
Total reward:  445.0638170746836
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.13942731297732
DONE TAKING  40  STEPS.
Total reward:  228.96316908662686
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter91.ckpt

#####################################
Training the dynamics model..... iteration  92
#####################################

    amount of random data:  8000
    amount of onPol data:  135792
Prob rand:  25740
On pol:  132480
Prob shape:  (158220,)

=== Epoch 0 ===
    train loss:  0.37006430496675685
    val rand:  0.39770597219467163
    val onPol:  0.29514678940176964

=== Epoch 10 ===
    train loss:  0.21809924796561206
    val rand:  0.21696323156356812
    val onPol:  0.2344411819108895

=== Epoch 20 ===
    train loss:  0.18648259110242418
    val rand:  0.18556182086467743
    val onPol:  0.23071146117789404

=== Epoch 30 ===
    train loss:  0.1670112434810805
    val rand:  0.16984330117702484
    val onPol:  0.23424119715179717

=== Epoch 39 ===
    train loss:  0.1552721122611302
    val rand:  0.17042550444602966
    val onPol:  0.23835288626807077
Training duration: 88.27 s

#####################################
performing on-policy MPC rollouts... iter  92
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -15.746358188947989
DONE TAKING  40  STEPS.
Total reward:  130.48219145806684
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -9.164660060078935
DONE TAKING  40  STEPS.
Total reward:  192.09680769218767
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.883924935649887
DONE TAKING  40  STEPS.
Total reward:  306.7477153408896
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -20.347153352253994
DONE TAKING  40  STEPS.
Total reward:  576.2702940844835
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.25025889855428
DONE TAKING  40  STEPS.
Total reward:  409.1050352952487
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.08976759861125
DONE TAKING  40  STEPS.
Total reward:  514.1985861313907
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.968136880085172
DONE TAKING  40  STEPS.
Total reward:  78.53659191781765
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.84577887595863
DONE TAKING  40  STEPS.
Total reward:  -90.75467730966399
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.692786915391903
DONE TAKING  40  STEPS.
Total reward:  -59.422508403485104
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.875335331556908
DONE TAKING  40  STEPS.
Total reward:  423.73653782819986
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.047851877510997
DONE TAKING  40  STEPS.
Total reward:  457.87719122227884
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.591983294216917
DONE TAKING  40  STEPS.
Total reward:  129.59384651580388
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -10.554609136423938
DONE TAKING  40  STEPS.
Total reward:  243.8786279129088
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.794475387954282
DONE TAKING  40  STEPS.
Total reward:  -91.28194751720577
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -13.787998385354015
DONE TAKING  40  STEPS.
Total reward:  471.3213023244209
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.502168274686525
DONE TAKING  40  STEPS.
Total reward:  113.38616942925222
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.735731913876528
DONE TAKING  40  STEPS.
Total reward:  -526.3631575005911
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.474981596238976
DONE TAKING  40  STEPS.
Total reward:  356.3137395810429
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.497505938539348
DONE TAKING  40  STEPS.
Total reward:  -129.08756319924072
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.977942046977216
DONE TAKING  40  STEPS.
Total reward:  -55.02263444946824
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.274650690368848
DONE TAKING  40  STEPS.
Total reward:  224.08283744625916
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.18118468777778
DONE TAKING  40  STEPS.
Total reward:  318.47969277813337
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.592626613207617
DONE TAKING  40  STEPS.
Total reward:  -25.075437526243896
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -26.144674944155728
DONE TAKING  40  STEPS.
Total reward:  -229.83215651759107
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.70561209355708
DONE TAKING  40  STEPS.
Total reward:  -686.1098762588792
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.853541448400584
DONE TAKING  40  STEPS.
Total reward:  -235.32212867739312
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.490835198892313
DONE TAKING  40  STEPS.
Total reward:  206.74934042214161
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.558427686528386
DONE TAKING  40  STEPS.
Total reward:  176.51257575825147
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.463114538930782
DONE TAKING  40  STEPS.
Total reward:  345.45826126449504
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.708899176454135
DONE TAKING  40  STEPS.
Total reward:  148.68024738147287
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.00525900384374
DONE TAKING  40  STEPS.
Total reward:  -198.93646852329562
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.34379431753183
DONE TAKING  40  STEPS.
Total reward:  -399.0599150772606
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.4375138751472
DONE TAKING  40  STEPS.
Total reward:  -755.0583089161298
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.34544404752033
DONE TAKING  40  STEPS.
Total reward:  272.9544887401136
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -9.977920719504432
DONE TAKING  40  STEPS.
Total reward:  425.4352514147149
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.15882857495493
DONE TAKING  40  STEPS.
Total reward:  298.1406833739492
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.957598638815046
DONE TAKING  40  STEPS.
Total reward:  -287.90783509141886
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.983318776778752
DONE TAKING  40  STEPS.
Total reward:  -59.27510109469325
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -10.660188991990951
DONE TAKING  40  STEPS.
Total reward:  136.36770558398558
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.33437034917299
DONE TAKING  40  STEPS.
Total reward:  195.57608453281316
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter92.ckpt

#####################################
Training the dynamics model..... iteration  93
#####################################

    amount of random data:  8000
    amount of onPol data:  137268
Prob rand:  25935
On pol:  133920
Prob shape:  (159855,)

=== Epoch 0 ===
    train loss:  0.36977836480125403
    val rand:  0.38630980253219604
    val onPol:  0.2949876435871782

=== Epoch 10 ===
    train loss:  0.21729246899485588
    val rand:  0.21740476787090302
    val onPol:  0.23353361364068656

=== Epoch 20 ===
    train loss:  0.18686894475458524
    val rand:  0.17709492146968842
    val onPol:  0.23098929175015154

=== Epoch 30 ===
    train loss:  0.16775324606360534
    val rand:  0.1725117415189743
    val onPol:  0.23415782328309684

=== Epoch 39 ===
    train loss:  0.155581707899005
    val rand:  0.16423901915550232
    val onPol:  0.23944434523582458
Training duration: 78.20 s

#####################################
performing on-policy MPC rollouts... iter  93
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.022542630504283
DONE TAKING  40  STEPS.
Total reward:  -174.25066436951062
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.023075990617933
DONE TAKING  40  STEPS.
Total reward:  57.343833091860915
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.367931428922613
DONE TAKING  40  STEPS.
Total reward:  -478.92689192707144
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -19.85071496989786
DONE TAKING  40  STEPS.
Total reward:  319.92072035458665
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -13.908687263199027
DONE TAKING  40  STEPS.
Total reward:  -238.11211054387016
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.98494722780518
DONE TAKING  40  STEPS.
Total reward:  90.5498839515615
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.827027239957964
DONE TAKING  40  STEPS.
Total reward:  546.0148814367119
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.958312568625484
DONE TAKING  40  STEPS.
Total reward:  -418.76216406625093
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.94443524800281
DONE TAKING  40  STEPS.
Total reward:  -110.20445431069659
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.54012532431972
DONE TAKING  40  STEPS.
Total reward:  82.83528317172153
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -13.742461571307615
DONE TAKING  40  STEPS.
Total reward:  -134.59433313222857
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -16.917399268126935
DONE TAKING  40  STEPS.
Total reward:  352.51034637459827
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.283143937550484
DONE TAKING  40  STEPS.
Total reward:  -511.7768539642373
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.50195817529344
DONE TAKING  40  STEPS.
Total reward:  -52.726879568471816
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.23740792581807
DONE TAKING  40  STEPS.
Total reward:  6.645224001357494
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.694428665028923
DONE TAKING  40  STEPS.
Total reward:  70.32401593540521
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -14.141476201522796
DONE TAKING  40  STEPS.
Total reward:  431.21856800796445
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.495876752833208
DONE TAKING  40  STEPS.
Total reward:  141.20867082020814
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.007014218455055
DONE TAKING  40  STEPS.
Total reward:  47.53825043272414
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.2291677923172
DONE TAKING  40  STEPS.
Total reward:  388.70317202724334
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.53393957889733
DONE TAKING  40  STEPS.
Total reward:  -77.33020022664743
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.896732059908715
DONE TAKING  40  STEPS.
Total reward:  418.88833260961235
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.184208741604156
DONE TAKING  40  STEPS.
Total reward:  -272.34439755419476
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.567697139038724
DONE TAKING  40  STEPS.
Total reward:  -222.18990789407349
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -19.612232092204522
DONE TAKING  40  STEPS.
Total reward:  298.6179763328975
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -19.64917840086486
DONE TAKING  40  STEPS.
Total reward:  504.4914919243979
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.17117940434976
DONE TAKING  40  STEPS.
Total reward:  -127.54244200940998
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.43428244864475
DONE TAKING  40  STEPS.
Total reward:  -435.30365275513134
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.126951758664994
DONE TAKING  40  STEPS.
Total reward:  -415.95522389038746
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.621872967289306
DONE TAKING  40  STEPS.
Total reward:  75.17472130787047
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.797820462021924
DONE TAKING  40  STEPS.
Total reward:  240.23155402901085
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.267461195368046
DONE TAKING  40  STEPS.
Total reward:  -45.88708390064268
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -25.798280170439718
DONE TAKING  40  STEPS.
Total reward:  218.7736359669006
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.431959822844231
DONE TAKING  40  STEPS.
Total reward:  487.36782192918366
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.73574353026325
DONE TAKING  40  STEPS.
Total reward:  -493.37740688432064
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.032928603324017
DONE TAKING  40  STEPS.
Total reward:  355.89918458186247
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.83743571420544
DONE TAKING  40  STEPS.
Total reward:  180.0643294718744
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.770175723573388
DONE TAKING  40  STEPS.
Total reward:  214.69115918823763
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -16.58071995243738
DONE TAKING  40  STEPS.
Total reward:  121.761793212454
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -30.469229508800094
DONE TAKING  40  STEPS.
Total reward:  -22.173527229720808
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter93.ckpt

#####################################
Training the dynamics model..... iteration  94
#####################################

    amount of random data:  8000
    amount of onPol data:  138744
Prob rand:  26130
On pol:  135360
Prob shape:  (161490,)

=== Epoch 0 ===
    train loss:  0.36859296721125406
    val rand:  0.3898499608039856
    val onPol:  0.2960907092382168

=== Epoch 10 ===
    train loss:  0.21743636926015217
    val rand:  0.2233629822731018
    val onPol:  0.23475152254104614

=== Epoch 20 ===
    train loss:  0.18697425817686414
    val rand:  0.1820441335439682
    val onPol:  0.23087756232968693

=== Epoch 30 ===
    train loss:  0.1675909399986267
    val rand:  0.17457136511802673
    val onPol:  0.23387862844713803

=== Epoch 39 ===
    train loss:  0.15546561200467368
    val rand:  0.16933386027812958
    val onPol:  0.23946597606971345
Training duration: 79.02 s

#####################################
performing on-policy MPC rollouts... iter  94
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.94000829191685
DONE TAKING  40  STEPS.
Total reward:  11.409474030522919
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.484917627205746
DONE TAKING  40  STEPS.
Total reward:  -225.81666373917423
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.772931021910154
DONE TAKING  40  STEPS.
Total reward:  398.18057672582705
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.34716880459908
DONE TAKING  40  STEPS.
Total reward:  -51.16619255105196
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.39763335958796
DONE TAKING  40  STEPS.
Total reward:  -519.8574995998711
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.45021485456943
DONE TAKING  40  STEPS.
Total reward:  110.4785978959174
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.657082281740852
DONE TAKING  40  STEPS.
Total reward:  -414.81625748569104
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.232753517231227
DONE TAKING  40  STEPS.
Total reward:  19.231666139337054
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.730699883367052
DONE TAKING  40  STEPS.
Total reward:  164.2598475387072
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.102141991351353
DONE TAKING  40  STEPS.
Total reward:  -100.56634029199316
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -15.350605645645896
DONE TAKING  40  STEPS.
Total reward:  382.2036442424603
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -15.048532120095645
DONE TAKING  40  STEPS.
Total reward:  197.23415389552412
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.46125261886897
DONE TAKING  40  STEPS.
Total reward:  -29.44077297938952
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.282435270815373
DONE TAKING  40  STEPS.
Total reward:  224.95985292696992
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.897731971317754
DONE TAKING  40  STEPS.
Total reward:  -205.529009995703
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.541250600044116
DONE TAKING  40  STEPS.
Total reward:  -765.9032762090281
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.37099998523077
DONE TAKING  40  STEPS.
Total reward:  397.9238991927843
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.477703057179465
DONE TAKING  40  STEPS.
Total reward:  296.57558851796836
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -14.934189779538515
DONE TAKING  40  STEPS.
Total reward:  -179.29725524307597
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.323073691447654
DONE TAKING  40  STEPS.
Total reward:  -480.284256953634
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -16.65877740173068
DONE TAKING  40  STEPS.
Total reward:  363.92177603743
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.18425016526637
DONE TAKING  40  STEPS.
Total reward:  -44.66959760696407
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -16.4455263965461
DONE TAKING  40  STEPS.
Total reward:  19.055854500824665
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -26.388653847613305
DONE TAKING  40  STEPS.
Total reward:  53.20084599211661
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -12.333540148189307
DONE TAKING  40  STEPS.
Total reward:  390.8765917131403
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.107177204981866
DONE TAKING  40  STEPS.
Total reward:  224.95456289911442
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.582045567687224
DONE TAKING  40  STEPS.
Total reward:  333.3786449752067
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -15.616966303074662
DONE TAKING  40  STEPS.
Total reward:  23.249987117346535
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.37340579984582
DONE TAKING  40  STEPS.
Total reward:  -193.12333123978806
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -13.29723238959349
DONE TAKING  40  STEPS.
Total reward:  494.59986131182006
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -11.959739357838664
DONE TAKING  40  STEPS.
Total reward:  422.64357880422756
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.10772773380947
DONE TAKING  40  STEPS.
Total reward:  141.81397941009124
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -12.39721261097346
DONE TAKING  40  STEPS.
Total reward:  -165.12358196655435
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.68801658832241
DONE TAKING  40  STEPS.
Total reward:  -2.7676378638007417
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.27090483405349
DONE TAKING  40  STEPS.
Total reward:  -178.99855124095927
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.31602916073973
DONE TAKING  40  STEPS.
Total reward:  -364.3190993823277
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -15.337185239304274
DONE TAKING  40  STEPS.
Total reward:  301.5997467164619
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.968526838446305
DONE TAKING  40  STEPS.
Total reward:  125.7186671783165
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.448121745758286
DONE TAKING  40  STEPS.
Total reward:  -484.35686376773356
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.684728091429848
DONE TAKING  40  STEPS.
Total reward:  -169.55393839497137
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter94.ckpt

#####################################
Training the dynamics model..... iteration  95
#####################################

    amount of random data:  8000
    amount of onPol data:  140220
Prob rand:  26325
On pol:  136800
Prob shape:  (163125,)

=== Epoch 0 ===
    train loss:  0.37059392803495034
    val rand:  0.3829159736633301
    val onPol:  0.2968955070808016

=== Epoch 10 ===
    train loss:  0.22057553057400686
    val rand:  0.21572324633598328
    val onPol:  0.2347568879867422

=== Epoch 20 ===
    train loss:  0.18871340886601862
    val rand:  0.18551400303840637
    val onPol:  0.23087554913142633

=== Epoch 30 ===
    train loss:  0.170331228454158
    val rand:  0.17271149158477783
    val onPol:  0.23223640384345218

=== Epoch 39 ===
    train loss:  0.1584788567427569
    val rand:  0.16782701015472412
    val onPol:  0.23739787833444004
Training duration: 79.74 s

#####################################
performing on-policy MPC rollouts... iter  95
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.445095793493714
DONE TAKING  40  STEPS.
Total reward:  314.4952432427315
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.603006272986526
DONE TAKING  40  STEPS.
Total reward:  -295.8626002301796
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.16040935246349
DONE TAKING  40  STEPS.
Total reward:  348.0506620861147
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.438781847668828
DONE TAKING  40  STEPS.
Total reward:  58.84121373134729
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.637659340491194
DONE TAKING  40  STEPS.
Total reward:  279.7055574221933
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.45251434701814
DONE TAKING  40  STEPS.
Total reward:  -621.485247860576
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -13.306887604267919
DONE TAKING  40  STEPS.
Total reward:  156.1254301307806
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.237879723497684
DONE TAKING  40  STEPS.
Total reward:  190.53963384081882
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.609193368516348
DONE TAKING  40  STEPS.
Total reward:  121.59281924820755
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.25209625483195
DONE TAKING  40  STEPS.
Total reward:  -574.1549047990131
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.015542005153208
DONE TAKING  40  STEPS.
Total reward:  -662.395292930077
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.681792460496315
DONE TAKING  40  STEPS.
Total reward:  -396.75992422585745
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.724149130124857
DONE TAKING  40  STEPS.
Total reward:  59.889752002120204
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.75591579908813
DONE TAKING  40  STEPS.
Total reward:  565.6452567445867
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.304275351354384
DONE TAKING  40  STEPS.
Total reward:  -82.73529003814797
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.730130746943743
DONE TAKING  40  STEPS.
Total reward:  91.96025119411581
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -15.545657452391318
DONE TAKING  40  STEPS.
Total reward:  -27.07361697074226
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.890811677247775
DONE TAKING  40  STEPS.
Total reward:  -168.75208659595674
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.14061652374855
DONE TAKING  40  STEPS.
Total reward:  115.2906219235249
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -14.980971328888854
DONE TAKING  40  STEPS.
Total reward:  -174.42280517990403
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.889063260936766
DONE TAKING  40  STEPS.
Total reward:  158.64344802960844
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.764600160363354
DONE TAKING  40  STEPS.
Total reward:  -71.98737220664937
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.404334804626465
DONE TAKING  40  STEPS.
Total reward:  410.58225707650524
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.397864050945998
DONE TAKING  40  STEPS.
Total reward:  -308.56228462399736
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.881080723813493
DONE TAKING  40  STEPS.
Total reward:  -279.33193163314166
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.921698616739004
DONE TAKING  40  STEPS.
Total reward:  -237.37205237682272
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -31.223220893882576
DONE TAKING  40  STEPS.
Total reward:  19.447849852758715
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.75861947078208
DONE TAKING  40  STEPS.
Total reward:  -460.20256696806484
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.37750361675746
DONE TAKING  40  STEPS.
Total reward:  156.6991031547896
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.056289210556443
DONE TAKING  40  STEPS.
Total reward:  -187.84097239627587
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.600761064387754
DONE TAKING  40  STEPS.
Total reward:  168.90394109860995
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.95261373374523
DONE TAKING  40  STEPS.
Total reward:  114.59429341743933
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -27.496105042121172
DONE TAKING  40  STEPS.
Total reward:  -301.91836978940216
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.52405288622524
DONE TAKING  40  STEPS.
Total reward:  -94.58927768571945
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.33921700391746
DONE TAKING  40  STEPS.
Total reward:  -268.97146575920704
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.358922481961127
DONE TAKING  40  STEPS.
Total reward:  22.713028454067558
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.85013031466988
DONE TAKING  40  STEPS.
Total reward:  178.20252650735605
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.957592579536392
DONE TAKING  40  STEPS.
Total reward:  484.9314373034673
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -12.10536007764032
DONE TAKING  40  STEPS.
Total reward:  396.2152275385985
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.586937275010868
DONE TAKING  40  STEPS.
Total reward:  -259.54985376586217
Time for 1 rollout: 1.11 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter95.ckpt

#####################################
Training the dynamics model..... iteration  96
#####################################

    amount of random data:  8000
    amount of onPol data:  141696
Prob rand:  26520
On pol:  138240
Prob shape:  (164760,)

=== Epoch 0 ===
    train loss:  0.37167539700540797
    val rand:  0.3910664916038513
    val onPol:  0.2995581358671188

=== Epoch 10 ===
    train loss:  0.22014702290203714
    val rand:  0.2161865234375
    val onPol:  0.23505783975124359

=== Epoch 20 ===
    train loss:  0.18972129056758227
    val rand:  0.18647131323814392
    val onPol:  0.23109131604433059

=== Epoch 30 ===
    train loss:  0.17106904976093137
    val rand:  0.17499685287475586
    val onPol:  0.23319035172462463

=== Epoch 39 ===
    train loss:  0.15973493568251065
    val rand:  0.17199711501598358
    val onPol:  0.23832260618607204
Training duration: 79.80 s

#####################################
performing on-policy MPC rollouts... iter  96
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -14.814887806936078
DONE TAKING  40  STEPS.
Total reward:  265.8586898586151
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.857879092049032
DONE TAKING  40  STEPS.
Total reward:  48.886131244122694
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.80565729411895
DONE TAKING  40  STEPS.
Total reward:  317.68336180149504
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.087881744573792
DONE TAKING  40  STEPS.
Total reward:  -791.6363277844529
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.6453303447241
DONE TAKING  40  STEPS.
Total reward:  87.72021720811816
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.113526662108143
DONE TAKING  40  STEPS.
Total reward:  88.9090203177501
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.596566925191237
DONE TAKING  40  STEPS.
Total reward:  -611.9504338806097
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.516279376298613
DONE TAKING  40  STEPS.
Total reward:  159.87889661706203
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.250652279899423
DONE TAKING  40  STEPS.
Total reward:  -567.7970450954454
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.140042166857285
DONE TAKING  40  STEPS.
Total reward:  -17.230951006837778
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.218243151993082
DONE TAKING  40  STEPS.
Total reward:  31.752048388004514
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.15070902542276
DONE TAKING  40  STEPS.
Total reward:  439.64891083693124
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -31.085809619412387
DONE TAKING  40  STEPS.
Total reward:  -529.7258176064373
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.836032376343958
DONE TAKING  40  STEPS.
Total reward:  325.7772142187835
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.43507792049331
DONE TAKING  40  STEPS.
Total reward:  -136.51067329729844
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.976253953386486
DONE TAKING  40  STEPS.
Total reward:  13.090781361682886
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -13.731142446405894
DONE TAKING  40  STEPS.
Total reward:  -358.3447005539091
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.817140383682187
DONE TAKING  40  STEPS.
Total reward:  -283.14460737790273
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -12.484728536990515
DONE TAKING  40  STEPS.
Total reward:  369.1086159256215
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.44974343889537
DONE TAKING  40  STEPS.
Total reward:  -724.2218608968627
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.83017375722175
DONE TAKING  40  STEPS.
Total reward:  298.50882098572066
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.803125203547573
DONE TAKING  40  STEPS.
Total reward:  72.36125193981279
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.66029530783003
DONE TAKING  40  STEPS.
Total reward:  400.10343333250063
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -17.519527694172126
DONE TAKING  40  STEPS.
Total reward:  88.49482255505038
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.625581571214088
DONE TAKING  40  STEPS.
Total reward:  149.83458566377075
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.416497182149413
DONE TAKING  40  STEPS.
Total reward:  -188.80424011944893
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -31.17397383022487
DONE TAKING  40  STEPS.
Total reward:  -617.4631926477502
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.300981660574024
DONE TAKING  40  STEPS.
Total reward:  -89.52062449344376
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.155331749691697
DONE TAKING  40  STEPS.
Total reward:  -262.08162489539745
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.572302604422198
DONE TAKING  40  STEPS.
Total reward:  -501.87108340817747
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.15842976221724
DONE TAKING  40  STEPS.
Total reward:  211.75661967827358
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.34114687349628
DONE TAKING  40  STEPS.
Total reward:  -59.033586867748156
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.216128787543035
DONE TAKING  40  STEPS.
Total reward:  -538.3868518362675
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -9.700669380040466
DONE TAKING  40  STEPS.
Total reward:  547.7212419702576
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.275309405076733
DONE TAKING  40  STEPS.
Total reward:  -32.19259837890904
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.062709912157228
DONE TAKING  40  STEPS.
Total reward:  219.7821856806025
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.460857118725414
DONE TAKING  40  STEPS.
Total reward:  156.26408823611007
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.737934869182137
DONE TAKING  40  STEPS.
Total reward:  -153.87859141037978
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.015705580655176
DONE TAKING  40  STEPS.
Total reward:  228.58038066875255
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.75255807841041
DONE TAKING  40  STEPS.
Total reward:  362.6973297543301
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter96.ckpt

#####################################
Training the dynamics model..... iteration  97
#####################################

    amount of random data:  8000
    amount of onPol data:  143172
Prob rand:  26715
On pol:  139680
Prob shape:  (166395,)

=== Epoch 0 ===
    train loss:  0.3692105463993402
    val rand:  0.38258612155914307
    val onPol:  0.2970876172184944

=== Epoch 10 ===
    train loss:  0.2182214639529034
    val rand:  0.21560955047607422
    val onPol:  0.23576022336880367

=== Epoch 20 ===
    train loss:  0.18866295031743285
    val rand:  0.18173691630363464
    val onPol:  0.2299677645166715

=== Epoch 30 ===
    train loss:  0.17007453822427326
    val rand:  0.17564915120601654
    val onPol:  0.231551460425059

=== Epoch 39 ===
    train loss:  0.15841400407162715
    val rand:  0.17046146094799042
    val onPol:  0.23725921312967937
Training duration: 82.05 s

#####################################
performing on-policy MPC rollouts... iter  97
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.398195049530656
DONE TAKING  40  STEPS.
Total reward:  363.3101311327286
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -11.581144685104439
DONE TAKING  40  STEPS.
Total reward:  490.6662038123191
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.26525420179145
DONE TAKING  40  STEPS.
Total reward:  -406.2764331583945
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.61711939830649
DONE TAKING  40  STEPS.
Total reward:  337.6443161238957
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.462793918619916
DONE TAKING  40  STEPS.
Total reward:  32.83296698968
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.52656401725443
DONE TAKING  40  STEPS.
Total reward:  -776.3502351391372
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.371398927417076
DONE TAKING  40  STEPS.
Total reward:  83.74084522113688
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.16665857892297
DONE TAKING  40  STEPS.
Total reward:  -538.1243329199046
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.856223287381724
DONE TAKING  40  STEPS.
Total reward:  -234.03713718395284
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -15.468144900805092
DONE TAKING  40  STEPS.
Total reward:  128.46203328295599
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -25.344352420994905
DONE TAKING  40  STEPS.
Total reward:  214.4568869710235
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.317989776286925
DONE TAKING  40  STEPS.
Total reward:  115.48098358299526
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.277576018091658
DONE TAKING  40  STEPS.
Total reward:  -224.96072391386647
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.796995691988116
DONE TAKING  40  STEPS.
Total reward:  182.11575474107843
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.702763416554127
DONE TAKING  40  STEPS.
Total reward:  368.17080252433766
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.887904640247378
DONE TAKING  40  STEPS.
Total reward:  139.70775028378816
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.224476716495275
DONE TAKING  40  STEPS.
Total reward:  324.990859452847
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -31.338107199253432
DONE TAKING  40  STEPS.
Total reward:  34.65468016239594
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.65176660226659
DONE TAKING  40  STEPS.
Total reward:  -1.8221738601361688
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.402306435557534
DONE TAKING  40  STEPS.
Total reward:  8.63758178289649
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.384925990007844
DONE TAKING  40  STEPS.
Total reward:  235.6231879068928
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.462024302533557
DONE TAKING  40  STEPS.
Total reward:  -94.59638611974547
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.561673999042632
DONE TAKING  40  STEPS.
Total reward:  274.1548587159915
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.307650999653646
DONE TAKING  40  STEPS.
Total reward:  132.3045720510623
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -17.163471241728864
DONE TAKING  40  STEPS.
Total reward:  249.8240258395982
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.3462083367361
DONE TAKING  40  STEPS.
Total reward:  341.7405133749076
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.91435751664881
DONE TAKING  40  STEPS.
Total reward:  -685.7376653373225
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.160744091333633
DONE TAKING  40  STEPS.
Total reward:  376.42068514809375
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.254520845541474
DONE TAKING  40  STEPS.
Total reward:  -488.4958529950825
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.87805339496825
DONE TAKING  40  STEPS.
Total reward:  -175.67991469127477
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.700943601203083
DONE TAKING  40  STEPS.
Total reward:  -161.95816810497132
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -14.850255460834516
DONE TAKING  40  STEPS.
Total reward:  120.2900017570281
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.77559049060401
DONE TAKING  40  STEPS.
Total reward:  -26.657515625554552
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.731205410554047
DONE TAKING  40  STEPS.
Total reward:  -63.95569184747848
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -17.859886275685096
DONE TAKING  40  STEPS.
Total reward:  302.39856563620174
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -10.35116033051679
DONE TAKING  40  STEPS.
Total reward:  232.7825054524954
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.02312677384056
DONE TAKING  40  STEPS.
Total reward:  -228.8972827543331
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.726530828556466
DONE TAKING  40  STEPS.
Total reward:  445.4910648707662
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.38009684262955
DONE TAKING  40  STEPS.
Total reward:  -596.6169673541256
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.54061474734158
DONE TAKING  40  STEPS.
Total reward:  112.85108785936576
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter97.ckpt

#####################################
Training the dynamics model..... iteration  98
#####################################

    amount of random data:  8000
    amount of onPol data:  144648
Prob rand:  26910
On pol:  141120
Prob shape:  (168030,)

=== Epoch 0 ===
    train loss:  0.36721930625598603
    val rand:  0.3973832130432129
    val onPol:  0.2953272650639216

=== Epoch 10 ===
    train loss:  0.21815183449809145
    val rand:  0.21643397212028503
    val onPol:  0.23195896546045938

=== Epoch 20 ===
    train loss:  0.18673514052316909
    val rand:  0.18616735935211182
    val onPol:  0.22809832990169526

=== Epoch 30 ===
    train loss:  0.16832397305747357
    val rand:  0.17139014601707458
    val onPol:  0.23137010832627614

=== Epoch 39 ===
    train loss:  0.15727649769950203
    val rand:  0.16672377288341522
    val onPol:  0.2362436756491661
Training duration: 82.71 s

#####################################
performing on-policy MPC rollouts... iter  98
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.427981683004965
DONE TAKING  40  STEPS.
Total reward:  368.39104393595335
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.72704350467039
DONE TAKING  40  STEPS.
Total reward:  -459.1915578523095
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.98867317155624
DONE TAKING  40  STEPS.
Total reward:  408.8365168205405
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.471384090087717
DONE TAKING  40  STEPS.
Total reward:  -18.80924959301194
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.77631609117024
DONE TAKING  40  STEPS.
Total reward:  433.84437164687284
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -10.409733051763588
DONE TAKING  40  STEPS.
Total reward:  10.081133093353738
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -12.47502437243958
DONE TAKING  40  STEPS.
Total reward:  -274.58476463433055
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.951331516528956
DONE TAKING  40  STEPS.
Total reward:  328.6940887386615
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.4715102195319
DONE TAKING  40  STEPS.
Total reward:  -505.36276666360084
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.393319529542953
DONE TAKING  40  STEPS.
Total reward:  132.32702065819785
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.68239115512412
DONE TAKING  40  STEPS.
Total reward:  164.0996796323282
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.608157654828165
DONE TAKING  40  STEPS.
Total reward:  194.1436316107031
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.73322419124398
DONE TAKING  40  STEPS.
Total reward:  281.1826353046387
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.696845493304743
DONE TAKING  40  STEPS.
Total reward:  -465.7361254852894
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.07532757859223
DONE TAKING  40  STEPS.
Total reward:  12.838261295345411
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.10849538746826
DONE TAKING  40  STEPS.
Total reward:  280.17995742785934
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.424537625480834
DONE TAKING  40  STEPS.
Total reward:  62.86257627211772
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.239821650674234
DONE TAKING  40  STEPS.
Total reward:  267.46968372917155
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.822963991020597
DONE TAKING  40  STEPS.
Total reward:  374.6447232317667
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.616379687960013
DONE TAKING  40  STEPS.
Total reward:  477.6554483833427
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.395658343760136
DONE TAKING  40  STEPS.
Total reward:  297.53458605370093
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -20.12682697956283
DONE TAKING  40  STEPS.
Total reward:  201.71533201376582
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.517078519415975
DONE TAKING  40  STEPS.
Total reward:  -324.9246392959164
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.116738348315533
DONE TAKING  40  STEPS.
Total reward:  -447.94087052804366
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.61150808815932
DONE TAKING  40  STEPS.
Total reward:  9.006791295751302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.104338543694
DONE TAKING  40  STEPS.
Total reward:  -313.3850296556879
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.996114974739868
DONE TAKING  40  STEPS.
Total reward:  425.14174830606606
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.884447653155046
DONE TAKING  40  STEPS.
Total reward:  -17.129917347478198
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.60606926281597
DONE TAKING  40  STEPS.
Total reward:  188.43299865076798
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -15.554795175611552
DONE TAKING  40  STEPS.
Total reward:  286.883101423814
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.084949322822
DONE TAKING  40  STEPS.
Total reward:  -107.69981868241297
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -11.697749240296789
DONE TAKING  40  STEPS.
Total reward:  203.50635259458943
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.542171912189183
DONE TAKING  40  STEPS.
Total reward:  222.28706078472803
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.21925113168775
DONE TAKING  40  STEPS.
Total reward:  336.7559489650578
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.43965557612439
DONE TAKING  40  STEPS.
Total reward:  -60.66580949914055
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.8164660025008
DONE TAKING  40  STEPS.
Total reward:  337.0021120632399
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.34787270298162
DONE TAKING  40  STEPS.
Total reward:  278.1031147066065
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -11.224237982744123
DONE TAKING  40  STEPS.
Total reward:  41.57679122645546
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.90288383878475
DONE TAKING  40  STEPS.
Total reward:  -617.5852162043666
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -11.892797491753765
DONE TAKING  40  STEPS.
Total reward:  -147.63779338679626
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter98.ckpt

#####################################
Training the dynamics model..... iteration  99
#####################################

    amount of random data:  8000
    amount of onPol data:  146124
Prob rand:  27105
On pol:  142560
Prob shape:  (169665,)

=== Epoch 0 ===
    train loss:  0.3685303574422335
    val rand:  0.3838239312171936
    val onPol:  0.29431528399387996

=== Epoch 10 ===
    train loss:  0.21753095693638677
    val rand:  0.22327560186386108
    val onPol:  0.2346582258741061

=== Epoch 20 ===
    train loss:  0.18791656889404054
    val rand:  0.18673783540725708
    val onPol:  0.22780669629573821

=== Epoch 30 ===
    train loss:  0.1695133484112172
    val rand:  0.1759798526763916
    val onPol:  0.2312084803978602

=== Epoch 39 ===
    train loss:  0.15806717247761268
    val rand:  0.17849740386009216
    val onPol:  0.23511442343393962
Training duration: 83.12 s

#####################################
performing on-policy MPC rollouts... iter  99
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -10.013936837651636
DONE TAKING  40  STEPS.
Total reward:  458.3053592546999
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.697413357594847
DONE TAKING  40  STEPS.
Total reward:  249.37438860269566
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.892802708048535
DONE TAKING  40  STEPS.
Total reward:  -13.330777602791386
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.824102767954926
DONE TAKING  40  STEPS.
Total reward:  -638.6643087325583
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.689084912208465
DONE TAKING  40  STEPS.
Total reward:  -633.85160733451
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.472357387880493
DONE TAKING  40  STEPS.
Total reward:  63.567915408727735
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.774545188179736
DONE TAKING  40  STEPS.
Total reward:  -432.4472603034564
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.01460658678888
DONE TAKING  40  STEPS.
Total reward:  -401.1227000409016
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.235096526884142
DONE TAKING  40  STEPS.
Total reward:  -608.6716095858048
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.27819792484937
DONE TAKING  40  STEPS.
Total reward:  411.9306282805885
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.330025630570074
DONE TAKING  40  STEPS.
Total reward:  189.40756809629673
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -15.568146176881017
DONE TAKING  40  STEPS.
Total reward:  -209.348481510171
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.701177608947273
DONE TAKING  40  STEPS.
Total reward:  227.77573046830958
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.010711177928222
DONE TAKING  40  STEPS.
Total reward:  3.5906094786875684
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.05839782539754
DONE TAKING  40  STEPS.
Total reward:  433.91008421940876
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.317880507265592
DONE TAKING  40  STEPS.
Total reward:  339.5287329417029
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.125380661336937
DONE TAKING  40  STEPS.
Total reward:  -91.89696213868271
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.693908473084882
DONE TAKING  40  STEPS.
Total reward:  286.7571362434042
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.374557986776427
DONE TAKING  40  STEPS.
Total reward:  -453.3303066257106
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.08505276127649
DONE TAKING  40  STEPS.
Total reward:  -97.77444613610851
Time for 1 rollout: 1.45 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.449417400272736
DONE TAKING  40  STEPS.
Total reward:  453.08347804755203
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.002372289728203
DONE TAKING  40  STEPS.
Total reward:  391.61967136329145
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.365654171101482
DONE TAKING  40  STEPS.
Total reward:  4.3898894135505415
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.999097033084873
DONE TAKING  40  STEPS.
Total reward:  -108.92177656355989
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.152830693712225
DONE TAKING  40  STEPS.
Total reward:  -22.872045026015996
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -18.526024481332556
DONE TAKING  40  STEPS.
Total reward:  314.1231766758605
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.7920686041993
DONE TAKING  40  STEPS.
Total reward:  120.14399312461848
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.080015318143282
DONE TAKING  40  STEPS.
Total reward:  441.3830790534451
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.887418785196488
DONE TAKING  40  STEPS.
Total reward:  -840.8671940938166
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.14158429415219
DONE TAKING  40  STEPS.
Total reward:  232.3655532504672
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.10590196040379
DONE TAKING  40  STEPS.
Total reward:  272.63583410497915
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.052068705145103
DONE TAKING  40  STEPS.
Total reward:  2.3648905228482704
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -31.254402665921912
DONE TAKING  40  STEPS.
Total reward:  253.84694794365646
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.641183822601022
DONE TAKING  40  STEPS.
Total reward:  -222.9321504163542
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.426975395770928
DONE TAKING  40  STEPS.
Total reward:  346.20656904099394
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.755539575022553
DONE TAKING  40  STEPS.
Total reward:  214.57379170434598
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.791681865580248
DONE TAKING  40  STEPS.
Total reward:  247.58166341083415
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.4425184724172
DONE TAKING  40  STEPS.
Total reward:  242.61240089709585
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -22.915688504273433
DONE TAKING  40  STEPS.
Total reward:  115.01249853673349
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.56145322367923
DONE TAKING  40  STEPS.
Total reward:  -94.82940970716336
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter99.ckpt

#####################################
Training the dynamics model..... iteration  100
#####################################

    amount of random data:  8000
    amount of onPol data:  147600
Prob rand:  27300
On pol:  144000
Prob shape:  (171300,)

=== Epoch 0 ===
    train loss:  0.3694995005509097
    val rand:  0.3847084939479828
    val onPol:  0.29545249525577794

=== Epoch 10 ===
    train loss:  0.2166670931135109
    val rand:  0.2155446708202362
    val onPol:  0.23324185802090552

=== Epoch 20 ===
    train loss:  0.18658061878766843
    val rand:  0.1864221692085266
    val onPol:  0.22897263448084554

=== Epoch 30 ===
    train loss:  0.16882773569065654
    val rand:  0.17484061419963837
    val onPol:  0.2309606450219308

=== Epoch 39 ===
    train loss:  0.15685002925153263
    val rand:  0.1681033968925476
    val onPol:  0.23483788438381686
Training duration: 84.97 s

#####################################
performing on-policy MPC rollouts... iter  100
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.67124536273215
DONE TAKING  40  STEPS.
Total reward:  281.6665159201393
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.05802163949586
DONE TAKING  40  STEPS.
Total reward:  437.0016801218796
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.157556466876088
DONE TAKING  40  STEPS.
Total reward:  335.58155823683416
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.108289687024957
DONE TAKING  40  STEPS.
Total reward:  325.82550005497086
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.23235730739944
DONE TAKING  40  STEPS.
Total reward:  -23.3606610724603
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.178695408225188
DONE TAKING  40  STEPS.
Total reward:  200.28223050962717
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.29226036722643
DONE TAKING  40  STEPS.
Total reward:  264.66095669311164
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.50453126148664
DONE TAKING  40  STEPS.
Total reward:  -684.5584870120158
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.72331927687508
DONE TAKING  40  STEPS.
Total reward:  1.2371030099470133
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -13.920200646951397
DONE TAKING  40  STEPS.
Total reward:  305.60250201885447
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.69635763465051
DONE TAKING  40  STEPS.
Total reward:  409.03009297042
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.116025980585775
DONE TAKING  40  STEPS.
Total reward:  -57.730292990626815
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.811110466797729
DONE TAKING  40  STEPS.
Total reward:  464.8777893711917
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.691665079447922
DONE TAKING  40  STEPS.
Total reward:  -72.31797164607255
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.19335946444972
DONE TAKING  40  STEPS.
Total reward:  -314.7555976446243
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -13.283013817743754
DONE TAKING  40  STEPS.
Total reward:  554.5815688639819
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.69205603084042
DONE TAKING  40  STEPS.
Total reward:  -374.44941171459993
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.524338675856868
DONE TAKING  40  STEPS.
Total reward:  -364.21906675083426
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.031925432128794
DONE TAKING  40  STEPS.
Total reward:  130.9279407249343
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.606676821100688
DONE TAKING  40  STEPS.
Total reward:  -152.81141314888998
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.545479006218752
DONE TAKING  40  STEPS.
Total reward:  -38.5646146745599
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.229380653203101
DONE TAKING  40  STEPS.
Total reward:  424.3515268812392
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.991778405761348
DONE TAKING  40  STEPS.
Total reward:  -270.4853348040503
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.939573461840588
DONE TAKING  40  STEPS.
Total reward:  430.68035407002117
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.7579462276289
DONE TAKING  40  STEPS.
Total reward:  477.24041467662494
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.954848443927162
DONE TAKING  40  STEPS.
Total reward:  26.917420535478126
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.223657694122984
DONE TAKING  40  STEPS.
Total reward:  299.7504999953565
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.165136194709405
DONE TAKING  40  STEPS.
Total reward:  -409.78413396451253
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.078065931983026
DONE TAKING  40  STEPS.
Total reward:  152.02939102861055
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.934605367192354
DONE TAKING  40  STEPS.
Total reward:  -605.7980600701411
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.419492961766828
DONE TAKING  40  STEPS.
Total reward:  491.18089405611227
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -16.132754570220605
DONE TAKING  40  STEPS.
Total reward:  -332.5622675291956
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.73604857658853
DONE TAKING  40  STEPS.
Total reward:  97.57356067672912
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.790542660822602
DONE TAKING  40  STEPS.
Total reward:  545.0800380565479
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -10.026618931140314
DONE TAKING  40  STEPS.
Total reward:  498.6618352315261
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.110657785993787
DONE TAKING  40  STEPS.
Total reward:  202.243161021472
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -11.155086367650181
DONE TAKING  40  STEPS.
Total reward:  -32.718875973690764
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.2681579987665
DONE TAKING  40  STEPS.
Total reward:  -23.7841260591481
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.008408883903705
DONE TAKING  40  STEPS.
Total reward:  132.0220296744821
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.998112068650116
DONE TAKING  40  STEPS.
Total reward:  -192.28332943276843
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter100.ckpt

#####################################
Training the dynamics model..... iteration  101
#####################################

    amount of random data:  8000
    amount of onPol data:  149076
Prob rand:  27495
On pol:  145440
Prob shape:  (172935,)

=== Epoch 0 ===
    train loss:  0.365890293959694
    val rand:  0.3880859315395355
    val onPol:  0.29642706917178246

=== Epoch 10 ===
    train loss:  0.21760739072140317
    val rand:  0.21974538266658783
    val onPol:  0.23385558012993105

=== Epoch 20 ===
    train loss:  0.1864556252779522
    val rand:  0.1828768253326416
    val onPol:  0.22998157383934145

=== Epoch 30 ===
    train loss:  0.16841078030072618
    val rand:  0.17115068435668945
    val onPol:  0.23160583069247584

=== Epoch 39 ===
    train loss:  0.15725608293840368
    val rand:  0.16968399286270142
    val onPol:  0.23692122630534634
Training duration: 88.46 s

#####################################
performing on-policy MPC rollouts... iter  101
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.908124898135767
DONE TAKING  40  STEPS.
Total reward:  -109.44424741174262
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.369680786397556
DONE TAKING  40  STEPS.
Total reward:  237.29283444726806
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.831774743898002
DONE TAKING  40  STEPS.
Total reward:  -165.45153176545205
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -18.36487145054622
DONE TAKING  40  STEPS.
Total reward:  411.1815777119584
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.61504442874049
DONE TAKING  40  STEPS.
Total reward:  115.91738864941838
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.232474299445364
DONE TAKING  40  STEPS.
Total reward:  236.1174258745659
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.81550018038326
DONE TAKING  40  STEPS.
Total reward:  133.12179511540302
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.722149204569025
DONE TAKING  40  STEPS.
Total reward:  -31.3398041282926
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.090619616127395
DONE TAKING  40  STEPS.
Total reward:  596.2597946686766
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.61280306022917
DONE TAKING  40  STEPS.
Total reward:  -350.422910700314
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.333073560232272
DONE TAKING  40  STEPS.
Total reward:  -147.8340477055799
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.266478377601207
DONE TAKING  40  STEPS.
Total reward:  -398.07658184967397
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.342593080559666
DONE TAKING  40  STEPS.
Total reward:  113.87905823582919
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.3005888858234
DONE TAKING  40  STEPS.
Total reward:  460.1631864621528
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.227255200393877
DONE TAKING  40  STEPS.
Total reward:  384.28506085185757
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.098382078098787
DONE TAKING  40  STEPS.
Total reward:  163.036471775298
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.90348594421308
DONE TAKING  40  STEPS.
Total reward:  -2.8430724831725733
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -12.57080459625567
DONE TAKING  40  STEPS.
Total reward:  503.80677712605694
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.90224081906529
DONE TAKING  40  STEPS.
Total reward:  -93.58270193976205
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.26372489970128
DONE TAKING  40  STEPS.
Total reward:  140.67005792497844
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -9.317940702529647
DONE TAKING  40  STEPS.
Total reward:  483.44018638043326
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.098074164304514
DONE TAKING  40  STEPS.
Total reward:  43.907480058531725
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.680846035384654
DONE TAKING  40  STEPS.
Total reward:  133.7315381585493
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.358369192117227
DONE TAKING  40  STEPS.
Total reward:  358.4734940213245
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.56949036033297
DONE TAKING  40  STEPS.
Total reward:  4.4334232941892004
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.979502078365144
DONE TAKING  40  STEPS.
Total reward:  141.64876564364215
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.830516550295805
DONE TAKING  40  STEPS.
Total reward:  104.19617509045682
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.30415714731944
DONE TAKING  40  STEPS.
Total reward:  480.5653448050151
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.849975472101455
DONE TAKING  40  STEPS.
Total reward:  104.33189239926344
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.627231736386197
DONE TAKING  40  STEPS.
Total reward:  327.7575985627298
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.778061668851155
DONE TAKING  40  STEPS.
Total reward:  270.00033870111884
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.458495985178633
DONE TAKING  40  STEPS.
Total reward:  352.8026516757709
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -13.623025335319948
DONE TAKING  40  STEPS.
Total reward:  516.1358144380422
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -19.716492632230462
DONE TAKING  40  STEPS.
Total reward:  221.98090867605583
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.289766879180668
DONE TAKING  40  STEPS.
Total reward:  409.68323877167603
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.513038385818653
DONE TAKING  40  STEPS.
Total reward:  175.36170760993292
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.337038294467987
DONE TAKING  40  STEPS.
Total reward:  -141.58784245479893
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.223742035563934
DONE TAKING  40  STEPS.
Total reward:  197.35820750756048
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.588817190886367
DONE TAKING  40  STEPS.
Total reward:  -113.95200946342436
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.585290181498742
DONE TAKING  40  STEPS.
Total reward:  395.86056438045364
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter101.ckpt

#####################################
Training the dynamics model..... iteration  102
#####################################

    amount of random data:  8000
    amount of onPol data:  150552
Prob rand:  27690
On pol:  146880
Prob shape:  (174570,)

=== Epoch 0 ===
    train loss:  0.36587368740754966
    val rand:  0.37891697883605957
    val onPol:  0.29542397924007907

=== Epoch 10 ===
    train loss:  0.21597194746136666
    val rand:  0.22010233998298645
    val onPol:  0.23063355203597777

=== Epoch 20 ===
    train loss:  0.18622547756223118
    val rand:  0.18527576327323914
    val onPol:  0.22674279347542795

=== Epoch 30 ===
    train loss:  0.16848394515759804
    val rand:  0.17398469150066376
    val onPol:  0.22853913807099865

=== Epoch 39 ===
    train loss:  0.15711706390275676
    val rand:  0.1719145029783249
    val onPol:  0.23412947260564373
Training duration: 86.19 s

#####################################
performing on-policy MPC rollouts... iter  102
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.118291747634842
DONE TAKING  40  STEPS.
Total reward:  109.74216463696129
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -15.496579537892753
DONE TAKING  40  STEPS.
Total reward:  400.10411081512575
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.299785330116023
DONE TAKING  40  STEPS.
Total reward:  367.26889007823473
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.215223030106483
DONE TAKING  40  STEPS.
Total reward:  -183.0664646873447
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.953752053788463
DONE TAKING  40  STEPS.
Total reward:  -1.3429925302304753
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.62037931603106
DONE TAKING  40  STEPS.
Total reward:  -18.096728142910113
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.12282179968217
DONE TAKING  40  STEPS.
Total reward:  138.49814795239507
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -17.86029813899306
DONE TAKING  40  STEPS.
Total reward:  282.92084447271543
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.99626259038599
DONE TAKING  40  STEPS.
Total reward:  126.7826223208584
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.232669348462817
DONE TAKING  40  STEPS.
Total reward:  181.0858981324501
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.976728691334902
DONE TAKING  40  STEPS.
Total reward:  48.97459001212499
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -18.306266597076217
DONE TAKING  40  STEPS.
Total reward:  300.72900035616317
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.0604969574701
DONE TAKING  40  STEPS.
Total reward:  12.36464999363065
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.910940987980013
DONE TAKING  40  STEPS.
Total reward:  427.52808500975914
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -19.752671504671227
DONE TAKING  40  STEPS.
Total reward:  517.235395173484
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.002538033368353
DONE TAKING  40  STEPS.
Total reward:  389.32518290683225
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.175985280231355
DONE TAKING  40  STEPS.
Total reward:  94.87013413814302
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.17308297449319
DONE TAKING  40  STEPS.
Total reward:  220.8180964314313
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.07087705276018
DONE TAKING  40  STEPS.
Total reward:  191.5161183363632
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.137788373091578
DONE TAKING  40  STEPS.
Total reward:  -28.933207749104938
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.218840222609636
DONE TAKING  40  STEPS.
Total reward:  217.15061206696237
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.65803222852064
DONE TAKING  40  STEPS.
Total reward:  -61.40830362710417
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -16.91182616272949
DONE TAKING  40  STEPS.
Total reward:  87.48176192065017
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.474026183780026
DONE TAKING  40  STEPS.
Total reward:  319.8736960025417
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.030484031169088
DONE TAKING  40  STEPS.
Total reward:  -62.03066407287457
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.244767306703476
DONE TAKING  40  STEPS.
Total reward:  48.84771197163577
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.899694860564935
DONE TAKING  40  STEPS.
Total reward:  -387.9163748128683
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -13.20460516449036
DONE TAKING  40  STEPS.
Total reward:  346.19751671253243
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.478790403508555
DONE TAKING  40  STEPS.
Total reward:  8.760974944889057
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.872155829209444
DONE TAKING  40  STEPS.
Total reward:  -394.14443448794043
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.338819052668647
DONE TAKING  40  STEPS.
Total reward:  28.505624055534156
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.429581498006403
DONE TAKING  40  STEPS.
Total reward:  258.74444552489126
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.827170252197426
DONE TAKING  40  STEPS.
Total reward:  366.1890760480446
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.641581389700395
DONE TAKING  40  STEPS.
Total reward:  -89.94255727820445
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.286132707329376
DONE TAKING  40  STEPS.
Total reward:  429.6146380173297
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.84038944685767
DONE TAKING  40  STEPS.
Total reward:  58.405562846980224
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.38105180691535
DONE TAKING  40  STEPS.
Total reward:  -192.79015937035493
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.654757310416173
DONE TAKING  40  STEPS.
Total reward:  475.6159437577928
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.901509804080575
DONE TAKING  40  STEPS.
Total reward:  288.200716960236
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -15.36227432240481
DONE TAKING  40  STEPS.
Total reward:  62.69358962621176
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter102.ckpt

#####################################
Training the dynamics model..... iteration  103
#####################################

    amount of random data:  8000
    amount of onPol data:  152028
Prob rand:  27885
On pol:  148320
Prob shape:  (176205,)

=== Epoch 0 ===
    train loss:  0.36702236472520716
    val rand:  0.3874083459377289
    val onPol:  0.2999094892293215

=== Epoch 10 ===
    train loss:  0.21784517376921897
    val rand:  0.21525560319423676
    val onPol:  0.23314995877444744

=== Epoch 20 ===
    train loss:  0.18780044782473598
    val rand:  0.18848572671413422
    val onPol:  0.23063756991177797

=== Epoch 30 ===
    train loss:  0.16973448016269263
    val rand:  0.1717505156993866
    val onPol:  0.2309303730726242

=== Epoch 39 ===
    train loss:  0.1591291156878998
    val rand:  0.17416267096996307
    val onPol:  0.2361992346122861
Training duration: 87.09 s

#####################################
performing on-policy MPC rollouts... iter  103
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.681511823014283
DONE TAKING  40  STEPS.
Total reward:  375.0898298595938
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.318323220878405
DONE TAKING  40  STEPS.
Total reward:  -120.09727950037646
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.199448061368294
DONE TAKING  40  STEPS.
Total reward:  346.08737047757336
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.322428245024984
DONE TAKING  40  STEPS.
Total reward:  -414.60961754710746
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.70768002328923
DONE TAKING  40  STEPS.
Total reward:  110.17115701055704
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.36737663773972
DONE TAKING  40  STEPS.
Total reward:  343.59913428187394
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.755272358814423
DONE TAKING  40  STEPS.
Total reward:  -226.04766402819845
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.4914628992788
DONE TAKING  40  STEPS.
Total reward:  -76.27481958746719
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -19.358653883196855
DONE TAKING  40  STEPS.
Total reward:  221.27721230132275
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -13.544350728279046
DONE TAKING  40  STEPS.
Total reward:  60.26507889777696
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.7335212685357
DONE TAKING  40  STEPS.
Total reward:  235.02363556919343
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.360465370741817
DONE TAKING  40  STEPS.
Total reward:  -385.6065694552495
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.61195166058895
DONE TAKING  40  STEPS.
Total reward:  311.6763484926352
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.56632215457394
DONE TAKING  40  STEPS.
Total reward:  -3.2083958214351966
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.504101587086893
DONE TAKING  40  STEPS.
Total reward:  87.28741590718951
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.874805949758812
DONE TAKING  40  STEPS.
Total reward:  242.64624904023307
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.351181587734477
DONE TAKING  40  STEPS.
Total reward:  465.78084582089116
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.212003070360772
DONE TAKING  40  STEPS.
Total reward:  412.6559872094716
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.97639696137977
DONE TAKING  40  STEPS.
Total reward:  -181.73705228393447
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.692428130827583
DONE TAKING  40  STEPS.
Total reward:  -504.1701161874741
Time for 1 rollout: 1.33 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.945667285872712
DONE TAKING  40  STEPS.
Total reward:  234.07033255194366
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.28082555770792
DONE TAKING  40  STEPS.
Total reward:  267.4951185450224
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.742830452802043
DONE TAKING  40  STEPS.
Total reward:  -229.58984983652434
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.961112795946082
DONE TAKING  40  STEPS.
Total reward:  319.61028363742236
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.482461560463737
DONE TAKING  40  STEPS.
Total reward:  -241.90275603625966
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.396969988129307
DONE TAKING  40  STEPS.
Total reward:  -148.66280608273638
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.345944183452048
DONE TAKING  40  STEPS.
Total reward:  460.12212977546943
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.202131837792383
DONE TAKING  40  STEPS.
Total reward:  -585.2806051851109
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.214689026491326
DONE TAKING  40  STEPS.
Total reward:  573.4837371789157
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.81900388725547
DONE TAKING  40  STEPS.
Total reward:  492.95574407112235
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.56721005800227
DONE TAKING  40  STEPS.
Total reward:  302.2499135752633
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.661592660156934
DONE TAKING  40  STEPS.
Total reward:  -38.95479270280697
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.569783937447692
DONE TAKING  40  STEPS.
Total reward:  -32.80020249390181
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.74593152235312
DONE TAKING  40  STEPS.
Total reward:  -689.7398882142825
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.158726583361144
DONE TAKING  40  STEPS.
Total reward:  -233.04834606019918
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.128709477305833
DONE TAKING  40  STEPS.
Total reward:  375.12968426165344
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.216387415066386
DONE TAKING  40  STEPS.
Total reward:  369.426429174101
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -18.200951556741714
DONE TAKING  40  STEPS.
Total reward:  269.19437810634076
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -9.68560306688347
DONE TAKING  40  STEPS.
Total reward:  208.15207304081855
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -30.19948200431488
DONE TAKING  40  STEPS.
Total reward:  75.79241329733931
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter103.ckpt

#####################################
Training the dynamics model..... iteration  104
#####################################

    amount of random data:  8000
    amount of onPol data:  153504
Prob rand:  28080
On pol:  149760
Prob shape:  (177840,)

=== Epoch 0 ===
    train loss:  0.3657922747327546
    val rand:  0.3770763576030731
    val onPol:  0.2950931820087135

=== Epoch 10 ===
    train loss:  0.21669609569850504
    val rand:  0.2244863510131836
    val onPol:  0.23108405759558082

=== Epoch 20 ===
    train loss:  0.18689941810256122
    val rand:  0.18257024884223938
    val onPol:  0.2277777916751802

=== Epoch 30 ===
    train loss:  0.16951436139321122
    val rand:  0.1689693182706833
    val onPol:  0.23088969895616174

=== Epoch 39 ===
    train loss:  0.15788714458859962
    val rand:  0.16985058784484863
    val onPol:  0.2343708286061883
Training duration: 87.48 s

#####################################
performing on-policy MPC rollouts... iter  104
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.251648283601533
DONE TAKING  40  STEPS.
Total reward:  -134.05422064406955
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.66737103469695
DONE TAKING  40  STEPS.
Total reward:  -477.5970015308684
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.80924525473683
DONE TAKING  40  STEPS.
Total reward:  136.60540208840337
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.20371697262412
DONE TAKING  40  STEPS.
Total reward:  312.59267381520186
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -24.131583968789172
DONE TAKING  40  STEPS.
Total reward:  114.05849095333095
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.093087946728794
DONE TAKING  40  STEPS.
Total reward:  -864.3070804319722
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.887595925968927
DONE TAKING  40  STEPS.
Total reward:  317.36942699742326
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.181739314798996
DONE TAKING  40  STEPS.
Total reward:  281.5511260820586
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.185991362233338
DONE TAKING  40  STEPS.
Total reward:  -397.5611863333757
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.389862867905967
DONE TAKING  40  STEPS.
Total reward:  357.52335015173054
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -14.393041437218496
DONE TAKING  40  STEPS.
Total reward:  412.8526145449082
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.049175206701307
DONE TAKING  40  STEPS.
Total reward:  120.26294145867755
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.17985393002688
DONE TAKING  40  STEPS.
Total reward:  -515.0450873537169
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -10.950597167344931
DONE TAKING  40  STEPS.
Total reward:  382.4455414113477
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.386492417619074
DONE TAKING  40  STEPS.
Total reward:  -192.40029843197067
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.4764745133592
DONE TAKING  40  STEPS.
Total reward:  45.28581040584559
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.842067398952846
DONE TAKING  40  STEPS.
Total reward:  -485.8432079484889
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.053917587017168
DONE TAKING  40  STEPS.
Total reward:  -114.60696413033185
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.596899096582334
DONE TAKING  40  STEPS.
Total reward:  -31.713907934220437
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.432627639604295
DONE TAKING  40  STEPS.
Total reward:  163.91971728239972
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.112064225087183
DONE TAKING  40  STEPS.
Total reward:  393.8144375383608
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.031474448527863
DONE TAKING  40  STEPS.
Total reward:  76.93748803893607
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.369382446031075
DONE TAKING  40  STEPS.
Total reward:  42.16200150217511
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -12.699555026614561
DONE TAKING  40  STEPS.
Total reward:  506.90431961724937
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.967645905102394
DONE TAKING  40  STEPS.
Total reward:  142.515889411228
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.694605996905345
DONE TAKING  40  STEPS.
Total reward:  156.0186934701375
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -14.845634634189642
DONE TAKING  40  STEPS.
Total reward:  409.23701151442765
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.831026713976144
DONE TAKING  40  STEPS.
Total reward:  -32.89132965959175
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.79431794226549
DONE TAKING  40  STEPS.
Total reward:  100.90826344094141
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.297924438035935
DONE TAKING  40  STEPS.
Total reward:  231.4523829274857
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.142663369448023
DONE TAKING  40  STEPS.
Total reward:  428.2514844982489
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.888891808943434
DONE TAKING  40  STEPS.
Total reward:  -134.92592372003114
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.107790578666393
DONE TAKING  40  STEPS.
Total reward:  133.9948264513403
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -8.765522340010031
DONE TAKING  40  STEPS.
Total reward:  302.8757602405782
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.44038931426344
DONE TAKING  40  STEPS.
Total reward:  -47.080699154455154
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -21.82080193587577
DONE TAKING  40  STEPS.
Total reward:  470.97876276759
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.085948707745523
DONE TAKING  40  STEPS.
Total reward:  369.84512951954775
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.015234945247112
DONE TAKING  40  STEPS.
Total reward:  -169.18512674900256
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.70546092291809
DONE TAKING  40  STEPS.
Total reward:  -230.17523765972555
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.746912955597168
DONE TAKING  40  STEPS.
Total reward:  342.17267161825896
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter104.ckpt

#####################################
Training the dynamics model..... iteration  105
#####################################

    amount of random data:  8000
    amount of onPol data:  154980
Prob rand:  28275
On pol:  151200
Prob shape:  (179475,)

=== Epoch 0 ===
    train loss:  0.36528578562395914
    val rand:  0.3826614022254944
    val onPol:  0.29542928049340844

=== Epoch 10 ===
    train loss:  0.21875176331826618
    val rand:  0.21212449669837952
    val onPol:  0.23160499148070812

=== Epoch 20 ===
    train loss:  0.18787102290562221
    val rand:  0.187010258436203
    val onPol:  0.22641440574079752

=== Epoch 30 ===
    train loss:  0.1713242381811142
    val rand:  0.17413872480392456
    val onPol:  0.22944193705916405

=== Epoch 39 ===
    train loss:  0.1604252309032849
    val rand:  0.17325668036937714
    val onPol:  0.23343489784747362
Training duration: 88.38 s

#####################################
performing on-policy MPC rollouts... iter  105
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -28.39480478008005
DONE TAKING  40  STEPS.
Total reward:  -106.0079048560367
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.765107309181424
DONE TAKING  40  STEPS.
Total reward:  -255.03492583935576
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.00405203708916
DONE TAKING  40  STEPS.
Total reward:  -115.92832642196726
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -15.755601548422188
DONE TAKING  40  STEPS.
Total reward:  257.6057391308549
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.540093396529237
DONE TAKING  40  STEPS.
Total reward:  -194.4111501399184
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.05870609330337
DONE TAKING  40  STEPS.
Total reward:  239.21755543155285
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -18.839228198519223
DONE TAKING  40  STEPS.
Total reward:  -107.58930447578383
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.196801000648776
DONE TAKING  40  STEPS.
Total reward:  -13.600179615222387
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.41240027764749
DONE TAKING  40  STEPS.
Total reward:  29.829792811479642
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -24.659754550528923
DONE TAKING  40  STEPS.
Total reward:  -81.11800549615398
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.03714336543928
DONE TAKING  40  STEPS.
Total reward:  273.92272747347374
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -20.19244954225247
DONE TAKING  40  STEPS.
Total reward:  -158.90492520295206
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.09297965874753
DONE TAKING  40  STEPS.
Total reward:  390.7345037528554
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.17910532325286
DONE TAKING  40  STEPS.
Total reward:  104.3904026010828
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.369558538928407
DONE TAKING  40  STEPS.
Total reward:  -119.11511066415598
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.575853843902692
DONE TAKING  40  STEPS.
Total reward:  -177.21586686298338
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -28.712316245123585
DONE TAKING  40  STEPS.
Total reward:  161.22789343714035
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.37345564515767
DONE TAKING  40  STEPS.
Total reward:  -236.19998756260205
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.090430327127226
DONE TAKING  40  STEPS.
Total reward:  434.2034183547919
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.614781553597744
DONE TAKING  40  STEPS.
Total reward:  -19.21764263286914
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.873870145406862
DONE TAKING  40  STEPS.
Total reward:  64.71908411823358
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.596306803159784
DONE TAKING  40  STEPS.
Total reward:  190.375159405462
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.692393875084015
DONE TAKING  40  STEPS.
Total reward:  279.61470795044625
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.4411022168977
DONE TAKING  40  STEPS.
Total reward:  382.6798321670026
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.975997113001668
DONE TAKING  40  STEPS.
Total reward:  -9.539559551893145
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.251550630997023
DONE TAKING  40  STEPS.
Total reward:  282.8682893300644
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -16.441742205033577
DONE TAKING  40  STEPS.
Total reward:  462.29447227676076
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.452068917625578
DONE TAKING  40  STEPS.
Total reward:  -22.76845948869146
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.515817040835948
DONE TAKING  40  STEPS.
Total reward:  -238.40109120681134
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.593986331438785
DONE TAKING  40  STEPS.
Total reward:  -183.95093647241384
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.819545860692806
DONE TAKING  40  STEPS.
Total reward:  268.44435756671015
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.85244931006543
DONE TAKING  40  STEPS.
Total reward:  109.11689075250145
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.32533613768363
DONE TAKING  40  STEPS.
Total reward:  302.07079688887075
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -22.80239916967379
DONE TAKING  40  STEPS.
Total reward:  5.805671063803345
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -17.60363107401584
DONE TAKING  40  STEPS.
Total reward:  321.51181127491185
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.80181802221818
DONE TAKING  40  STEPS.
Total reward:  -41.484680814932545
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.860406685150366
DONE TAKING  40  STEPS.
Total reward:  293.0556316017425
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.34503205118701
DONE TAKING  40  STEPS.
Total reward:  87.80421041857639
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -15.365394471666331
DONE TAKING  40  STEPS.
Total reward:  124.90486460600184
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.668880205143946
DONE TAKING  40  STEPS.
Total reward:  -232.76455463909406
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter105.ckpt

#####################################
Training the dynamics model..... iteration  106
#####################################

    amount of random data:  8000
    amount of onPol data:  156456
Prob rand:  28470
On pol:  152640
Prob shape:  (181110,)

=== Epoch 0 ===
    train loss:  0.3694208260129599
    val rand:  0.39285632967948914
    val onPol:  0.2976407648035974

=== Epoch 10 ===
    train loss:  0.2187458224826764
    val rand:  0.21854250133037567
    val onPol:  0.2315765434142315

=== Epoch 20 ===
    train loss:  0.18992387437955516
    val rand:  0.1844538450241089
    val onPol:  0.22698537102251343

=== Epoch 30 ===
    train loss:  0.17232709565851573
    val rand:  0.1804175227880478
    val onPol:  0.23022215655355743

=== Epoch 39 ===
    train loss:  0.16120374063425633
    val rand:  0.17326152324676514
    val onPol:  0.23366211038647275
Training duration: 83.39 s

#####################################
performing on-policy MPC rollouts... iter  106
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.02671999753892
DONE TAKING  40  STEPS.
Total reward:  280.9622388887629
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.927334909943454
DONE TAKING  40  STEPS.
Total reward:  -537.1465723504199
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.779180017980593
DONE TAKING  40  STEPS.
Total reward:  111.44368550624856
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.2627579966176
DONE TAKING  40  STEPS.
Total reward:  -324.2569633669486
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.03158002209995
DONE TAKING  40  STEPS.
Total reward:  268.9102339727413
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.027551891013829
DONE TAKING  40  STEPS.
Total reward:  141.31990417413155
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.068504768104624
DONE TAKING  40  STEPS.
Total reward:  -519.2406816004753
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.549169831574513
DONE TAKING  40  STEPS.
Total reward:  -193.12527401727237
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.348820782523404
DONE TAKING  40  STEPS.
Total reward:  -659.4605981689548
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -14.085717694695848
DONE TAKING  40  STEPS.
Total reward:  451.0755889598507
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.352653431405393
DONE TAKING  40  STEPS.
Total reward:  -447.0870612750772
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.918030423493214
DONE TAKING  40  STEPS.
Total reward:  213.07340259343792
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.662245795269545
DONE TAKING  40  STEPS.
Total reward:  200.007876244803
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.08061088465242
DONE TAKING  40  STEPS.
Total reward:  138.3577766913491
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.862389846858434
DONE TAKING  40  STEPS.
Total reward:  296.8047386751937
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -13.03740429415958
DONE TAKING  40  STEPS.
Total reward:  472.0885925367491
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.580512705975487
DONE TAKING  40  STEPS.
Total reward:  -269.96015856166946
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.750904590320697
DONE TAKING  40  STEPS.
Total reward:  -69.54403466340867
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -16.146798619725566
DONE TAKING  40  STEPS.
Total reward:  164.57962525204988
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.657677703333203
DONE TAKING  40  STEPS.
Total reward:  301.7725842241468
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.102307825099818
DONE TAKING  40  STEPS.
Total reward:  -192.06776806407535
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -11.764427682386284
DONE TAKING  40  STEPS.
Total reward:  381.06798853436425
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -14.105876761580733
DONE TAKING  40  STEPS.
Total reward:  384.0544994594952
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.32491325704617
DONE TAKING  40  STEPS.
Total reward:  276.2592191020639
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.322622162879004
DONE TAKING  40  STEPS.
Total reward:  323.09854929191226
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -24.543811457829612
DONE TAKING  40  STEPS.
Total reward:  352.79246534193106
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.191883691159703
DONE TAKING  40  STEPS.
Total reward:  -87.61932893177132
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.02769578600982
DONE TAKING  40  STEPS.
Total reward:  34.35408297915711
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.82991343435626
DONE TAKING  40  STEPS.
Total reward:  383.6350514402737
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.71422916297105
DONE TAKING  40  STEPS.
Total reward:  -91.3758337561458
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.52209874774626
DONE TAKING  40  STEPS.
Total reward:  -91.05930845580627
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.297123822814278
DONE TAKING  40  STEPS.
Total reward:  239.91018080241506
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.267276443595193
DONE TAKING  40  STEPS.
Total reward:  435.5342473794827
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.447723808430368
DONE TAKING  40  STEPS.
Total reward:  358.5185663208885
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -26.338767053938355
DONE TAKING  40  STEPS.
Total reward:  153.26184681826945
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.54992233068635
DONE TAKING  40  STEPS.
Total reward:  136.076980643448
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.713550399872492
DONE TAKING  40  STEPS.
Total reward:  -16.5230655727314
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -16.520117764923082
DONE TAKING  40  STEPS.
Total reward:  436.42088986829015
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.041466618249054
DONE TAKING  40  STEPS.
Total reward:  -9.293952327354503
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.65905221004918
DONE TAKING  40  STEPS.
Total reward:  -384.43438081163634
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter106.ckpt

#####################################
Training the dynamics model..... iteration  107
#####################################

    amount of random data:  8000
    amount of onPol data:  157932
Prob rand:  28665
On pol:  154080
Prob shape:  (182745,)

=== Epoch 0 ===
    train loss:  0.3644876269142279
    val rand:  0.38684582710266113
    val onPol:  0.29505393812150665

=== Epoch 10 ===
    train loss:  0.21693645116318477
    val rand:  0.22904054820537567
    val onPol:  0.23293953456661917

=== Epoch 20 ===
    train loss:  0.1888812824748875
    val rand:  0.1848008632659912
    val onPol:  0.22635712045611758

=== Epoch 30 ===
    train loss:  0.1711501127967004
    val rand:  0.1750243604183197
    val onPol:  0.2289615675355449

=== Epoch 39 ===
    train loss:  0.16045339300893666
    val rand:  0.17523080110549927
    val onPol:  0.23303325970967612
Training duration: 90.62 s

#####################################
performing on-policy MPC rollouts... iter  107
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.21707876242003
DONE TAKING  40  STEPS.
Total reward:  344.77613233902827
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.927499143910822
DONE TAKING  40  STEPS.
Total reward:  -350.3686698517357
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.132732116255468
DONE TAKING  40  STEPS.
Total reward:  295.557793037673
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.766734639798347
DONE TAKING  40  STEPS.
Total reward:  -39.21723966768785
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.714241927795847
DONE TAKING  40  STEPS.
Total reward:  -381.0421886343649
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.872698446688393
DONE TAKING  40  STEPS.
Total reward:  272.8832777306937
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -15.472879104872835
DONE TAKING  40  STEPS.
Total reward:  505.8691889816681
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -17.05972253407854
DONE TAKING  40  STEPS.
Total reward:  193.39266267985357
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -20.512316789096023
DONE TAKING  40  STEPS.
Total reward:  118.93178178316194
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.240597147289478
DONE TAKING  40  STEPS.
Total reward:  335.3499259160636
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.72019769295931
DONE TAKING  40  STEPS.
Total reward:  410.58191166041775
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.45827616268665
DONE TAKING  40  STEPS.
Total reward:  -220.00425025299535
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.345428355031302
DONE TAKING  40  STEPS.
Total reward:  288.81061890936286
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.63212023018456
DONE TAKING  40  STEPS.
Total reward:  157.2664745206076
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.612310305183136
DONE TAKING  40  STEPS.
Total reward:  -44.49403434966133
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.130126141024586
DONE TAKING  40  STEPS.
Total reward:  534.4243751672706
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.76908323045478
DONE TAKING  40  STEPS.
Total reward:  38.14820340457468
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -9.483003905043601
DONE TAKING  40  STEPS.
Total reward:  636.4163391694138
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.487821158525342
DONE TAKING  40  STEPS.
Total reward:  207.9703059112403
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.227460356744555
DONE TAKING  40  STEPS.
Total reward:  269.74789477947303
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.243916618638934
DONE TAKING  40  STEPS.
Total reward:  -220.90498335293165
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.003098477811537
DONE TAKING  40  STEPS.
Total reward:  327.82253225756807
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.182905323473527
DONE TAKING  40  STEPS.
Total reward:  496.653550341209
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.848193791911136
DONE TAKING  40  STEPS.
Total reward:  275.9688798830065
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.194788563843602
DONE TAKING  40  STEPS.
Total reward:  286.8805736329308
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.574128464971476
DONE TAKING  40  STEPS.
Total reward:  15.567834939456741
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.802624027679666
DONE TAKING  40  STEPS.
Total reward:  -393.4707210452364
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.352744890930115
DONE TAKING  40  STEPS.
Total reward:  -20.424515075287772
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.51616387288352
DONE TAKING  40  STEPS.
Total reward:  -136.21704510822573
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -14.42012280733563
DONE TAKING  40  STEPS.
Total reward:  542.6299738919104
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.277723719910554
DONE TAKING  40  STEPS.
Total reward:  -144.23582212028506
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.45986991517659
DONE TAKING  40  STEPS.
Total reward:  72.26451000218066
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.14105237801158
DONE TAKING  40  STEPS.
Total reward:  524.8295201138812
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.945527173260682
DONE TAKING  40  STEPS.
Total reward:  -5.211179980608968
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.066200699818403
DONE TAKING  40  STEPS.
Total reward:  220.7587202277209
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.611887598794347
DONE TAKING  40  STEPS.
Total reward:  282.6153235967171
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.95918083151158
DONE TAKING  40  STEPS.
Total reward:  316.3505802677706
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.475960530279043
DONE TAKING  40  STEPS.
Total reward:  225.93135657917963
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.898321408224806
DONE TAKING  40  STEPS.
Total reward:  365.7839828220743
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.285039011106473
DONE TAKING  40  STEPS.
Total reward:  -268.135541499025
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter107.ckpt

#####################################
Training the dynamics model..... iteration  108
#####################################

    amount of random data:  8000
    amount of onPol data:  159408
Prob rand:  28860
On pol:  155520
Prob shape:  (184380,)

=== Epoch 0 ===
    train loss:  0.3675314319630464
    val rand:  0.38658374547958374
    val onPol:  0.2964217775698864

=== Epoch 10 ===
    train loss:  0.21857826225459576
    val rand:  0.22220227122306824
    val onPol:  0.23001731074217593

=== Epoch 20 ===
    train loss:  0.18867250349786546
    val rand:  0.18432657420635223
    val onPol:  0.22480851502129526

=== Epoch 30 ===
    train loss:  0.1720957301557064
    val rand:  0.17335842549800873
    val onPol:  0.22647243015693896

=== Epoch 39 ===
    train loss:  0.16145822352005376
    val rand:  0.17177462577819824
    val onPol:  0.2318646234996391
Training duration: 94.53 s

#####################################
performing on-policy MPC rollouts... iter  108
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.26582480646129
DONE TAKING  40  STEPS.
Total reward:  230.5193476733042
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.02718125668602
DONE TAKING  40  STEPS.
Total reward:  -113.26703958312712
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.544611106683643
DONE TAKING  40  STEPS.
Total reward:  268.2405396416012
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.099419199467317
DONE TAKING  40  STEPS.
Total reward:  334.4155933782646
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.834286074415122
DONE TAKING  40  STEPS.
Total reward:  -81.65276899855326
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -9.047523748894822
DONE TAKING  40  STEPS.
Total reward:  439.7789974851274
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.362693066528497
DONE TAKING  40  STEPS.
Total reward:  40.39986871515291
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.96313038045799
DONE TAKING  40  STEPS.
Total reward:  -62.21032699577806
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -29.27732522722681
DONE TAKING  40  STEPS.
Total reward:  324.34534751284366
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.139643916239216
DONE TAKING  40  STEPS.
Total reward:  132.83429520283076
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.413537997115075
DONE TAKING  40  STEPS.
Total reward:  339.1820726040816
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.49120033212579
DONE TAKING  40  STEPS.
Total reward:  209.4143302942542
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -16.08430328224056
DONE TAKING  40  STEPS.
Total reward:  452.60154251654075
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.849246833335172
DONE TAKING  40  STEPS.
Total reward:  116.65771868921999
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.9071468662607
DONE TAKING  40  STEPS.
Total reward:  460.60125407292753
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -18.383184236143684
DONE TAKING  40  STEPS.
Total reward:  347.59361458294336
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.95779438016045
DONE TAKING  40  STEPS.
Total reward:  -215.74248195662494
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.877209533405235
DONE TAKING  40  STEPS.
Total reward:  109.6953133506376
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.802625167420814
DONE TAKING  40  STEPS.
Total reward:  341.7734210717963
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.79495663938203
DONE TAKING  40  STEPS.
Total reward:  -68.36692410439355
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.135001554435542
DONE TAKING  40  STEPS.
Total reward:  337.79702926877167
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.849097289013635
DONE TAKING  40  STEPS.
Total reward:  358.11301095410033
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -18.9827585713335
DONE TAKING  40  STEPS.
Total reward:  -148.70658567905392
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -10.798355655600549
DONE TAKING  40  STEPS.
Total reward:  629.9335787902936
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.843406910864275
DONE TAKING  40  STEPS.
Total reward:  123.76515369086626
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.487439538271616
DONE TAKING  40  STEPS.
Total reward:  422.3987871431119
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.533334863741047
DONE TAKING  40  STEPS.
Total reward:  143.98369738882394
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.03966934405618
DONE TAKING  40  STEPS.
Total reward:  -661.7572987218837
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.151699389912284
DONE TAKING  40  STEPS.
Total reward:  289.712032140743
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.132256397709533
DONE TAKING  40  STEPS.
Total reward:  -34.443756410283285
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.4219227716089
DONE TAKING  40  STEPS.
Total reward:  221.8093686813637
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.679762032046234
DONE TAKING  40  STEPS.
Total reward:  537.3643729808764
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.56521754051392
DONE TAKING  40  STEPS.
Total reward:  76.88757973544143
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.460754980878082
DONE TAKING  40  STEPS.
Total reward:  207.44272081979074
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.725459105613503
DONE TAKING  40  STEPS.
Total reward:  -275.6691549326638
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.702136403834718
DONE TAKING  40  STEPS.
Total reward:  -258.85888283752934
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.62114409908121
DONE TAKING  40  STEPS.
Total reward:  79.58804806266097
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.106214306950136
DONE TAKING  40  STEPS.
Total reward:  278.9718253634143
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.86967048923914
DONE TAKING  40  STEPS.
Total reward:  -719.1561079834205
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.71866951691692
DONE TAKING  40  STEPS.
Total reward:  286.3317925377797
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter108.ckpt

#####################################
Training the dynamics model..... iteration  109
#####################################

    amount of random data:  8000
    amount of onPol data:  160884
Prob rand:  29055
On pol:  156960
Prob shape:  (186015,)

=== Epoch 0 ===
    train loss:  0.36597808858908243
    val rand:  0.3891701102256775
    val onPol:  0.2967861689188901

=== Epoch 10 ===
    train loss:  0.21765412989562535
    val rand:  0.21929363906383514
    val onPol:  0.2299978693618494

=== Epoch 20 ===
    train loss:  0.1892285403633906
    val rand:  0.18980322778224945
    val onPol:  0.2263011840336463

=== Epoch 30 ===
    train loss:  0.17128292469117923
    val rand:  0.1818896234035492
    val onPol:  0.22944547279792674

=== Epoch 39 ===
    train loss:  0.16089581552451634
    val rand:  0.17436306178569794
    val onPol:  0.231320078320363
Training duration: 91.16 s

#####################################
performing on-policy MPC rollouts... iter  109
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.872545690445065
DONE TAKING  40  STEPS.
Total reward:  -71.46922712612937
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.39737264200261
DONE TAKING  40  STEPS.
Total reward:  287.01249393580133
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.300493692220172
DONE TAKING  40  STEPS.
Total reward:  235.13198170802397
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -29.29022163121762
DONE TAKING  40  STEPS.
Total reward:  -464.9353145031517
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.645112079780606
DONE TAKING  40  STEPS.
Total reward:  200.57478054243504
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.71586506752977
DONE TAKING  40  STEPS.
Total reward:  389.54198813399387
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.834901641890205
DONE TAKING  40  STEPS.
Total reward:  135.34762259705826
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.393743383203446
DONE TAKING  40  STEPS.
Total reward:  383.10252530155674
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.422914103585352
DONE TAKING  40  STEPS.
Total reward:  228.51915093170587
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.87335322184613
DONE TAKING  40  STEPS.
Total reward:  346.2655503382716
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.354617177225563
DONE TAKING  40  STEPS.
Total reward:  236.5997783549997
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.187006665051484
DONE TAKING  40  STEPS.
Total reward:  -170.31120279682307
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.755698503531523
DONE TAKING  40  STEPS.
Total reward:  21.275740823172562
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.00281512382665
DONE TAKING  40  STEPS.
Total reward:  229.5978213622685
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -29.019797107782054
DONE TAKING  40  STEPS.
Total reward:  380.3414924366403
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -13.357200242698255
DONE TAKING  40  STEPS.
Total reward:  218.67947861474886
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.710313700775895
DONE TAKING  40  STEPS.
Total reward:  279.708332339384
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.78851063402963
DONE TAKING  40  STEPS.
Total reward:  -44.852716798999424
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.467877526913586
DONE TAKING  40  STEPS.
Total reward:  207.3128871710717
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.9044779548304
DONE TAKING  40  STEPS.
Total reward:  282.68740169747986
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.909465817665527
DONE TAKING  40  STEPS.
Total reward:  90.18007905437045
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -21.155967643898506
DONE TAKING  40  STEPS.
Total reward:  225.2635857901553
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -14.608234739452154
DONE TAKING  40  STEPS.
Total reward:  444.5878388996649
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.400752124454264
DONE TAKING  40  STEPS.
Total reward:  191.47666478638524
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.63668357766928
DONE TAKING  40  STEPS.
Total reward:  -729.7156251011455
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.981592290746644
DONE TAKING  40  STEPS.
Total reward:  335.7412316387781
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -31.274454723010496
DONE TAKING  40  STEPS.
Total reward:  -769.0744186889997
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.27752516817371
DONE TAKING  40  STEPS.
Total reward:  487.506751133222
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.998747604777453
DONE TAKING  40  STEPS.
Total reward:  269.21524682754307
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.371143649795705
DONE TAKING  40  STEPS.
Total reward:  18.685220264258795
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.221102180105824
DONE TAKING  40  STEPS.
Total reward:  182.41629992887314
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.716548206913135
DONE TAKING  40  STEPS.
Total reward:  191.81964153521284
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.435426718001274
DONE TAKING  40  STEPS.
Total reward:  202.02595354098037
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -29.425295824358777
DONE TAKING  40  STEPS.
Total reward:  43.5287529887282
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.54693539662894
DONE TAKING  40  STEPS.
Total reward:  -91.00651704001189
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.935735438703055
DONE TAKING  40  STEPS.
Total reward:  456.86854554354045
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.786873015339264
DONE TAKING  40  STEPS.
Total reward:  -385.4824407168205
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -12.828487525991026
DONE TAKING  40  STEPS.
Total reward:  -29.40481332891686
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.113664436188266
DONE TAKING  40  STEPS.
Total reward:  337.9200151404753
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.053934136321622
DONE TAKING  40  STEPS.
Total reward:  457.060948665999
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter109.ckpt

#####################################
Training the dynamics model..... iteration  110
#####################################

    amount of random data:  8000
    amount of onPol data:  162360
Prob rand:  29250
On pol:  158400
Prob shape:  (187650,)

=== Epoch 0 ===
    train loss:  0.36600481250572725
    val rand:  0.3924212157726288
    val onPol:  0.29666340307277794

=== Epoch 10 ===
    train loss:  0.21643342835004212
    val rand:  0.2219221442937851
    val onPol:  0.2300138955607134

=== Epoch 20 ===
    train loss:  0.1881543280241268
    val rand:  0.1842188835144043
    val onPol:  0.22622763365507126

=== Epoch 30 ===
    train loss:  0.17164743162406598
    val rand:  0.17606334388256073
    val onPol:  0.22822361614774256

=== Epoch 39 ===
    train loss:  0.16080457888177183
    val rand:  0.16921040415763855
    val onPol:  0.23254944559405832
Training duration: 93.92 s

#####################################
performing on-policy MPC rollouts... iter  110
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.63537041976814
DONE TAKING  40  STEPS.
Total reward:  -657.2766242585823
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.83154357108822
DONE TAKING  40  STEPS.
Total reward:  488.7505455946007
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.366790563318123
DONE TAKING  40  STEPS.
Total reward:  526.3864202359676
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.60368431642304
DONE TAKING  40  STEPS.
Total reward:  463.10546476564525
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.696202701468934
DONE TAKING  40  STEPS.
Total reward:  302.249629638221
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.398768578237199
DONE TAKING  40  STEPS.
Total reward:  440.12037913291573
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.062419041971943
DONE TAKING  40  STEPS.
Total reward:  -2.108992133494567
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.650774749387104
DONE TAKING  40  STEPS.
Total reward:  254.23416153856692
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -12.89834918078143
DONE TAKING  40  STEPS.
Total reward:  285.69709228427604
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -24.22002442749301
DONE TAKING  40  STEPS.
Total reward:  34.56250134746578
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.703162591784597
DONE TAKING  40  STEPS.
Total reward:  336.2463150395549
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -31.280909266323246
DONE TAKING  40  STEPS.
Total reward:  -81.96048807889721
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.340021181849345
DONE TAKING  40  STEPS.
Total reward:  7.470142718033023
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.22485815909883
DONE TAKING  40  STEPS.
Total reward:  374.68193600138727
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.071640211384125
DONE TAKING  40  STEPS.
Total reward:  164.52892222828373
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -15.651213473322736
DONE TAKING  40  STEPS.
Total reward:  -454.17922125247554
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -27.05283963919211
DONE TAKING  40  STEPS.
Total reward:  -335.4660293971177
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -31.331928817350608
DONE TAKING  40  STEPS.
Total reward:  102.5073254627822
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.193549746579093
DONE TAKING  40  STEPS.
Total reward:  488.60211059096724
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -14.690390003922209
DONE TAKING  40  STEPS.
Total reward:  315.1090117526683
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.941424665369855
DONE TAKING  40  STEPS.
Total reward:  155.47301116686018
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.93807739563808
DONE TAKING  40  STEPS.
Total reward:  373.2469781686609
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.41456963175459
DONE TAKING  40  STEPS.
Total reward:  199.96263904938485
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.638614419851194
DONE TAKING  40  STEPS.
Total reward:  -46.75344352185265
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -15.161847178225692
DONE TAKING  40  STEPS.
Total reward:  268.03622027854084
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.059565798212915
DONE TAKING  40  STEPS.
Total reward:  125.32276703746528
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.19497987370904
DONE TAKING  40  STEPS.
Total reward:  -170.77362896999833
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.166013273373775
DONE TAKING  40  STEPS.
Total reward:  302.34089193649544
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.72099775915875
DONE TAKING  40  STEPS.
Total reward:  -262.01483152278905
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.112114257260817
DONE TAKING  40  STEPS.
Total reward:  304.6948135490827
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -11.836016798074985
DONE TAKING  40  STEPS.
Total reward:  359.3076280846531
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.874985985167392
DONE TAKING  40  STEPS.
Total reward:  32.09256191168473
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.18316954674631
DONE TAKING  40  STEPS.
Total reward:  163.16987732715978
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.781295176510763
DONE TAKING  40  STEPS.
Total reward:  130.32578876765186
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.641209848854132
DONE TAKING  40  STEPS.
Total reward:  -253.979260409015
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.91524335897049
DONE TAKING  40  STEPS.
Total reward:  238.59152008537552
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.663288701122305
DONE TAKING  40  STEPS.
Total reward:  58.1855558816102
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -16.18709851621606
DONE TAKING  40  STEPS.
Total reward:  270.48556553622814
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.839830833324598
DONE TAKING  40  STEPS.
Total reward:  155.4814075391257
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.431080769413715
DONE TAKING  40  STEPS.
Total reward:  84.75604324044038
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter110.ckpt

#####################################
Training the dynamics model..... iteration  111
#####################################

    amount of random data:  8000
    amount of onPol data:  163836
Prob rand:  29445
On pol:  159840
Prob shape:  (189285,)

=== Epoch 0 ===
    train loss:  0.363204506839194
    val rand:  0.37863633036613464
    val onPol:  0.2935482991092345

=== Epoch 10 ===
    train loss:  0.2162673980966816
    val rand:  0.21811078488826752
    val onPol:  0.23001371411716237

=== Epoch 20 ===
    train loss:  0.18851770916928443
    val rand:  0.1830504983663559
    val onPol:  0.22436203807592392

=== Epoch 30 ===
    train loss:  0.1719274492606238
    val rand:  0.1785886585712433
    val onPol:  0.2267679751795881

=== Epoch 39 ===
    train loss:  0.16217783993983334
    val rand:  0.16959956288337708
    val onPol:  0.2298878426937496
Training duration: 93.14 s

#####################################
performing on-policy MPC rollouts... iter  111
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.14135494209726
DONE TAKING  40  STEPS.
Total reward:  69.2179538962172
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.30211184557967
DONE TAKING  40  STEPS.
Total reward:  -15.740693102299332
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.15323211994548
DONE TAKING  40  STEPS.
Total reward:  386.6863898493744
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.524541357420688
DONE TAKING  40  STEPS.
Total reward:  255.4274382790603
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.481653239157872
DONE TAKING  40  STEPS.
Total reward:  -125.27102705799128
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.52510024932922
DONE TAKING  40  STEPS.
Total reward:  -188.44669892483046
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.075858789395596
DONE TAKING  40  STEPS.
Total reward:  256.53344389692467
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.957330026836864
DONE TAKING  40  STEPS.
Total reward:  -697.2226152145147
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.349571295827296
DONE TAKING  40  STEPS.
Total reward:  -403.9025116332653
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -16.42018969807802
DONE TAKING  40  STEPS.
Total reward:  312.6228602401121
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.780019742680555
DONE TAKING  40  STEPS.
Total reward:  282.2954432586262
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.44407361157213
DONE TAKING  40  STEPS.
Total reward:  -104.94188429349691
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.251562331273327
DONE TAKING  40  STEPS.
Total reward:  -48.52827071839788
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.170109274715752
DONE TAKING  40  STEPS.
Total reward:  -124.46643498096641
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.333230306308902
DONE TAKING  40  STEPS.
Total reward:  9.094302214558894
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.801588949769215
DONE TAKING  40  STEPS.
Total reward:  -78.10156416865794
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.87959961993482
DONE TAKING  40  STEPS.
Total reward:  19.071984054650166
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.221915093261952
DONE TAKING  40  STEPS.
Total reward:  -428.56491481282444
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.71789615474987
DONE TAKING  40  STEPS.
Total reward:  -373.04519348059733
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.357056631776615
DONE TAKING  40  STEPS.
Total reward:  -954.4936966974363
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.77273969949691
DONE TAKING  40  STEPS.
Total reward:  331.82335135598197
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.24313923036746
DONE TAKING  40  STEPS.
Total reward:  196.05360242243486
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.5425812398897
DONE TAKING  40  STEPS.
Total reward:  7.012754024940989
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.637005270604913
DONE TAKING  40  STEPS.
Total reward:  299.31373007128235
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.945159457907415
DONE TAKING  40  STEPS.
Total reward:  331.8746353858054
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.182007406341263
DONE TAKING  40  STEPS.
Total reward:  431.8432886324548
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.038564850750173
DONE TAKING  40  STEPS.
Total reward:  390.365785683408
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.984306398650105
DONE TAKING  40  STEPS.
Total reward:  188.14242658479324
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.212114571473805
DONE TAKING  40  STEPS.
Total reward:  324.0896253944295
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.041908731136644
DONE TAKING  40  STEPS.
Total reward:  -621.5632197000511
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.570473715452792
DONE TAKING  40  STEPS.
Total reward:  435.8119563468505
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.91030417214852
DONE TAKING  40  STEPS.
Total reward:  -698.1909675878085
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.648921719509215
DONE TAKING  40  STEPS.
Total reward:  347.77575117520433
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.544291066680856
DONE TAKING  40  STEPS.
Total reward:  -402.20266334394137
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.088864992916605
DONE TAKING  40  STEPS.
Total reward:  77.84972177285343
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.740322275298876
DONE TAKING  40  STEPS.
Total reward:  -468.4574755990296
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.52309859381065
DONE TAKING  40  STEPS.
Total reward:  298.6436819425747
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -14.003613747460532
DONE TAKING  40  STEPS.
Total reward:  309.3813112211794
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.876552762040813
DONE TAKING  40  STEPS.
Total reward:  224.00043630565526
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -25.798360533687735
DONE TAKING  40  STEPS.
Total reward:  274.9363584849678
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter111.ckpt

#####################################
Training the dynamics model..... iteration  112
#####################################

    amount of random data:  8000
    amount of onPol data:  165312
Prob rand:  29640
On pol:  161280
Prob shape:  (190920,)

=== Epoch 0 ===
    train loss:  0.36294585290134596
    val rand:  0.3775099515914917
    val onPol:  0.2947815869535719

=== Epoch 10 ===
    train loss:  0.21646396214923552
    val rand:  0.21517083048820496
    val onPol:  0.23158799026693616

=== Epoch 20 ===
    train loss:  0.1882533847244196
    val rand:  0.184068500995636
    val onPol:  0.2267474970647267

=== Epoch 30 ===
    train loss:  0.17119617115265578
    val rand:  0.17778679728507996
    val onPol:  0.2283720429454531

=== Epoch 39 ===
    train loss:  0.16095614865902932
    val rand:  0.17390716075897217
    val onPol:  0.23308045140334538
Training duration: 99.84 s

#####################################
performing on-policy MPC rollouts... iter  112
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -14.681379973695588
DONE TAKING  40  STEPS.
Total reward:  224.56495496385946
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.661574529729112
DONE TAKING  40  STEPS.
Total reward:  341.655210035605
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.30196095272607
DONE TAKING  40  STEPS.
Total reward:  161.5785011141973
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.422365283875763
DONE TAKING  40  STEPS.
Total reward:  447.6078804400764
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.087303917235612
DONE TAKING  40  STEPS.
Total reward:  190.06128555162002
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -13.97855876978608
DONE TAKING  40  STEPS.
Total reward:  424.18647819477957
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.166851550541544
DONE TAKING  40  STEPS.
Total reward:  64.70634184948321
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.03118311467113
DONE TAKING  40  STEPS.
Total reward:  132.28545441275273
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.54850774734268
DONE TAKING  40  STEPS.
Total reward:  406.712809977842
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.16656289995926
DONE TAKING  40  STEPS.
Total reward:  227.33351015168523
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.001814403753315
DONE TAKING  40  STEPS.
Total reward:  358.74676782083947
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.83843167008248
DONE TAKING  40  STEPS.
Total reward:  148.81924513635826
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -17.004679164436094
DONE TAKING  40  STEPS.
Total reward:  242.09314044622664
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -18.408759015294144
DONE TAKING  40  STEPS.
Total reward:  -13.765506586152767
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.88201307949666
DONE TAKING  40  STEPS.
Total reward:  -221.96074741597832
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.569332178418946
DONE TAKING  40  STEPS.
Total reward:  -88.31942066587109
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.983009877119574
DONE TAKING  40  STEPS.
Total reward:  306.6624051945002
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.889929188167358
DONE TAKING  40  STEPS.
Total reward:  64.07790386742184
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.377292458757804
DONE TAKING  40  STEPS.
Total reward:  19.623278841655114
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.22347252651767
DONE TAKING  40  STEPS.
Total reward:  133.35640006449768
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.246236516557744
DONE TAKING  40  STEPS.
Total reward:  422.6058640538136
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.118201716197937
DONE TAKING  40  STEPS.
Total reward:  -121.75431034645285
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.455526657129482
DONE TAKING  40  STEPS.
Total reward:  -418.89110642113747
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.37521991439013
DONE TAKING  40  STEPS.
Total reward:  298.1723576455364
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -13.613437479081561
DONE TAKING  40  STEPS.
Total reward:  -125.20639076401744
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -20.844772877782987
DONE TAKING  40  STEPS.
Total reward:  107.62707517760666
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.758292122861477
DONE TAKING  40  STEPS.
Total reward:  284.82663550153745
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.7885954871643
DONE TAKING  40  STEPS.
Total reward:  -687.1704467652145
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.287505583927782
DONE TAKING  40  STEPS.
Total reward:  -450.6179495861028
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.18091726115154
DONE TAKING  40  STEPS.
Total reward:  200.76185841258695
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.710320392642853
DONE TAKING  40  STEPS.
Total reward:  511.86614848329816
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -15.551850711125626
DONE TAKING  40  STEPS.
Total reward:  506.80794250703894
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.021959934945798
DONE TAKING  40  STEPS.
Total reward:  373.2793169187736
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -31.064172007531635
DONE TAKING  40  STEPS.
Total reward:  -198.00902582014285
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.49645093589482
DONE TAKING  40  STEPS.
Total reward:  -16.798194890895967
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.19832809409693
DONE TAKING  40  STEPS.
Total reward:  -26.917701077170207
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.464317992392292
DONE TAKING  40  STEPS.
Total reward:  92.9192055050653
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -13.88124435731065
DONE TAKING  40  STEPS.
Total reward:  407.3102970052606
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.045075086963777
DONE TAKING  40  STEPS.
Total reward:  -442.9480778223947
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.380954237858028
DONE TAKING  40  STEPS.
Total reward:  -39.75375235547091
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter112.ckpt

#####################################
Training the dynamics model..... iteration  113
#####################################

    amount of random data:  8000
    amount of onPol data:  166788
Prob rand:  29835
On pol:  162720
Prob shape:  (192555,)

=== Epoch 0 ===
    train loss:  0.3628696858724381
    val rand:  0.39695000648498535
    val onPol:  0.29365637515272414

=== Epoch 10 ===
    train loss:  0.21500854241721173
    val rand:  0.21973735094070435
    val onPol:  0.22916730216571263

=== Epoch 20 ===
    train loss:  0.1872509755986802
    val rand:  0.18631212413311005
    val onPol:  0.22467329842703684

=== Epoch 30 ===
    train loss:  0.17010050175830405
    val rand:  0.17253552377223969
    val onPol:  0.22734345197677613

=== Epoch 39 ===
    train loss:  0.16013002950460353
    val rand:  0.1707230508327484
    val onPol:  0.23146409009184157
Training duration: 94.72 s

#####################################
performing on-policy MPC rollouts... iter  113
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.163586097209077
DONE TAKING  40  STEPS.
Total reward:  37.32190513205641
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.161487169206865
DONE TAKING  40  STEPS.
Total reward:  -175.26290441178006
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.38593131495106
DONE TAKING  40  STEPS.
Total reward:  511.3054303546538
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.661530632544313
DONE TAKING  40  STEPS.
Total reward:  -381.31273242228394
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.7528503533186
DONE TAKING  40  STEPS.
Total reward:  -601.2768589159867
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.568822643690822
DONE TAKING  40  STEPS.
Total reward:  319.3898982200046
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.97698802788906
DONE TAKING  40  STEPS.
Total reward:  45.381748747677534
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.97655825716098
DONE TAKING  40  STEPS.
Total reward:  -223.61342649570173
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.10644108930168
DONE TAKING  40  STEPS.
Total reward:  289.84589115637607
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.713650008058558
DONE TAKING  40  STEPS.
Total reward:  65.55084643190472
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.20337191869995
DONE TAKING  40  STEPS.
Total reward:  199.81011519308447
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.90864865379887
DONE TAKING  40  STEPS.
Total reward:  -367.5400371481172
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.59070324391838
DONE TAKING  40  STEPS.
Total reward:  33.41736115607678
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -13.086222674300734
DONE TAKING  40  STEPS.
Total reward:  -52.81199628713352
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.932469000147496
DONE TAKING  40  STEPS.
Total reward:  141.53643508210186
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.520545332729768
DONE TAKING  40  STEPS.
Total reward:  -613.8561586058811
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.080827855439416
DONE TAKING  40  STEPS.
Total reward:  -693.7975973351444
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.35995714499301
DONE TAKING  40  STEPS.
Total reward:  295.48359205989703
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.74260334754655
DONE TAKING  40  STEPS.
Total reward:  375.6948798116474
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.56450644834047
DONE TAKING  40  STEPS.
Total reward:  384.9812791812685
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.97937137771313
DONE TAKING  40  STEPS.
Total reward:  393.5756292423223
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.675784399098937
DONE TAKING  40  STEPS.
Total reward:  -191.94905379473607
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.467798231039122
DONE TAKING  40  STEPS.
Total reward:  119.03303188271133
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.299751806916547
DONE TAKING  40  STEPS.
Total reward:  307.1934301282987
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.20362943301069
DONE TAKING  40  STEPS.
Total reward:  -248.07198442378478
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.378011135563675
DONE TAKING  40  STEPS.
Total reward:  -38.55930550899139
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -18.729108318601998
DONE TAKING  40  STEPS.
Total reward:  277.9365024321892
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.672666877628018
DONE TAKING  40  STEPS.
Total reward:  446.5340211577714
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.77906199602684
DONE TAKING  40  STEPS.
Total reward:  135.86621806828632
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.0832197541323
DONE TAKING  40  STEPS.
Total reward:  225.599386823492
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.403894286605066
DONE TAKING  40  STEPS.
Total reward:  -215.9426140690353
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.712421180866492
DONE TAKING  40  STEPS.
Total reward:  -242.23274704558025
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.620598409899422
DONE TAKING  40  STEPS.
Total reward:  209.69469846744798
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.03492840845125
DONE TAKING  40  STEPS.
Total reward:  78.55963011757716
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.292971437793632
DONE TAKING  40  STEPS.
Total reward:  43.83244808501709
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.688831660562585
DONE TAKING  40  STEPS.
Total reward:  -3.735676587025182
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.923741846195533
DONE TAKING  40  STEPS.
Total reward:  -5.67324237186644
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.57171599314582
DONE TAKING  40  STEPS.
Total reward:  -315.4834841423346
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.6934315679468
DONE TAKING  40  STEPS.
Total reward:  -108.61553707641647
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.569070841598545
DONE TAKING  40  STEPS.
Total reward:  437.2349779437867
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter113.ckpt

#####################################
Training the dynamics model..... iteration  114
#####################################

    amount of random data:  8000
    amount of onPol data:  168264
Prob rand:  30030
On pol:  164160
Prob shape:  (194190,)

=== Epoch 0 ===
    train loss:  0.3603813604975124
    val rand:  0.38451334834098816
    val onPol:  0.29205756315163206

=== Epoch 10 ===
    train loss:  0.21517498999598159
    val rand:  0.21648047864437103
    val onPol:  0.22692407923085348

=== Epoch 20 ===
    train loss:  0.18587191634882724
    val rand:  0.18158870935440063
    val onPol:  0.22197815179824829

=== Epoch 30 ===
    train loss:  0.1690537964527085
    val rand:  0.17107829451560974
    val onPol:  0.22471103753362384

=== Epoch 39 ===
    train loss:  0.15882373933427252
    val rand:  0.16889391839504242
    val onPol:  0.22849017339093344
Training duration: 95.69 s

#####################################
performing on-policy MPC rollouts... iter  114
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.279388134602375
DONE TAKING  40  STEPS.
Total reward:  448.2058307897462
Time for 1 rollout: 1.62 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.695927127659342
DONE TAKING  40  STEPS.
Total reward:  396.41038111722884
Time for 1 rollout: 1.57 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.23120821284997
DONE TAKING  40  STEPS.
Total reward:  365.6889599258766
Time for 1 rollout: 2.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -19.304174682186193
DONE TAKING  40  STEPS.
Total reward:  391.3460229717213
Time for 1 rollout: 1.76 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.293425855633956
DONE TAKING  40  STEPS.
Total reward:  150.99353144119382
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -16.7559695200394
DONE TAKING  40  STEPS.
Total reward:  461.8842449083965
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.73746060572647
DONE TAKING  40  STEPS.
Total reward:  227.9148370017089
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.347928102186962
DONE TAKING  40  STEPS.
Total reward:  -17.00302121675822
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -15.203895483409969
DONE TAKING  40  STEPS.
Total reward:  289.2267023878878
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.56021434549218
DONE TAKING  40  STEPS.
Total reward:  92.89944032936324
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -17.917907227230923
DONE TAKING  40  STEPS.
Total reward:  206.44010873647667
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.394155850794654
DONE TAKING  40  STEPS.
Total reward:  476.776460387357
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.347494400969445
DONE TAKING  40  STEPS.
Total reward:  69.01899158828222
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -9.950773012497953
DONE TAKING  40  STEPS.
Total reward:  164.90264830303153
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.650568667047196
DONE TAKING  40  STEPS.
Total reward:  -46.346908325746476
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.28199693906008
DONE TAKING  40  STEPS.
Total reward:  -277.526064487967
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.454534900153973
DONE TAKING  40  STEPS.
Total reward:  348.6714175613952
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.31214983675218
DONE TAKING  40  STEPS.
Total reward:  299.21747675671696
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.56636925496742
DONE TAKING  40  STEPS.
Total reward:  -116.59217436218866
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.92159100801135
DONE TAKING  40  STEPS.
Total reward:  365.4973125176846
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.24013779487303
DONE TAKING  40  STEPS.
Total reward:  35.413021010190064
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -13.375716749546278
DONE TAKING  40  STEPS.
Total reward:  -16.966197213477344
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -10.607794168276412
DONE TAKING  40  STEPS.
Total reward:  184.73532492460927
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.135865311128367
DONE TAKING  40  STEPS.
Total reward:  197.33946171869226
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -15.614917120712914
DONE TAKING  40  STEPS.
Total reward:  184.08246068332033
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.07404827080361
DONE TAKING  40  STEPS.
Total reward:  186.37058764120738
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.056745272120757
DONE TAKING  40  STEPS.
Total reward:  241.13764387691216
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.927541546293856
DONE TAKING  40  STEPS.
Total reward:  -158.79044814350488
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -26.858975151897518
DONE TAKING  40  STEPS.
Total reward:  100.88711893944136
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -16.46283065871405
DONE TAKING  40  STEPS.
Total reward:  -55.08785597848859
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -11.460322004022176
DONE TAKING  40  STEPS.
Total reward:  541.5793766601851
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.454252562982383
DONE TAKING  40  STEPS.
Total reward:  -113.50297555206284
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.441177624331257
DONE TAKING  40  STEPS.
Total reward:  479.26488757971316
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.71041714144954
DONE TAKING  40  STEPS.
Total reward:  -602.8150075071019
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.486318345034288
DONE TAKING  40  STEPS.
Total reward:  -225.7136472261152
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -18.3946870470691
DONE TAKING  40  STEPS.
Total reward:  434.1408409254777
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -17.350846451325467
DONE TAKING  40  STEPS.
Total reward:  442.30430811023604
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.816480726334774
DONE TAKING  40  STEPS.
Total reward:  -304.8300700781939
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.787054622099568
DONE TAKING  40  STEPS.
Total reward:  -250.8001154471784
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.462638910584758
DONE TAKING  40  STEPS.
Total reward:  -208.9635737687994
Time for 1 rollout: 1.23 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter114.ckpt

#####################################
Training the dynamics model..... iteration  115
#####################################

    amount of random data:  8000
    amount of onPol data:  169740
Prob rand:  30225
On pol:  165600
Prob shape:  (195825,)

=== Epoch 0 ===
    train loss:  0.36046046143426946
    val rand:  0.3816441297531128
    val onPol:  0.2923540379319872

=== Epoch 10 ===
    train loss:  0.21379323787402107
    val rand:  0.2165914624929428
    val onPol:  0.2272357566016061

=== Epoch 20 ===
    train loss:  0.18500893114436984
    val rand:  0.18247108161449432
    val onPol:  0.2217325623546328

=== Epoch 30 ===
    train loss:  0.16805296898356284
    val rand:  0.17214004695415497
    val onPol:  0.22511324158736637

=== Epoch 39 ===
    train loss:  0.1570872647287958
    val rand:  0.17144523561000824
    val onPol:  0.2293461446251188
Training duration: 97.74 s

#####################################
performing on-policy MPC rollouts... iter  115
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.64288373433532
DONE TAKING  40  STEPS.
Total reward:  -24.842666092818902
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.337148917202025
DONE TAKING  40  STEPS.
Total reward:  -45.76238382356181
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -10.10366100901787
DONE TAKING  40  STEPS.
Total reward:  480.49472008665236
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.130218976065166
DONE TAKING  40  STEPS.
Total reward:  292.896940521353
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.134780942323456
DONE TAKING  40  STEPS.
Total reward:  453.5503937473384
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.595910994728655
DONE TAKING  40  STEPS.
Total reward:  41.947853099122725
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.016937603189746
DONE TAKING  40  STEPS.
Total reward:  150.5737980611352
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.67933175188719
DONE TAKING  40  STEPS.
Total reward:  324.1265135707628
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.07889934407484
DONE TAKING  40  STEPS.
Total reward:  105.62786149102189
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.434847158731273
DONE TAKING  40  STEPS.
Total reward:  280.0455088823707
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.772955627369416
DONE TAKING  40  STEPS.
Total reward:  466.6078273761761
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.166681544879197
DONE TAKING  40  STEPS.
Total reward:  -334.5637059990077
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.431562056056826
DONE TAKING  40  STEPS.
Total reward:  73.70325316431615
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.669085801802435
DONE TAKING  40  STEPS.
Total reward:  95.0858895226933
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.170973984714596
DONE TAKING  40  STEPS.
Total reward:  221.7972960654162
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -18.468498776298507
DONE TAKING  40  STEPS.
Total reward:  281.97678153981207
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.715024296651386
DONE TAKING  40  STEPS.
Total reward:  300.55321143685495
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.081473634622018
DONE TAKING  40  STEPS.
Total reward:  -3.5775965791808773
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.25597080248114
DONE TAKING  40  STEPS.
Total reward:  395.31705159521886
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.478105601710928
DONE TAKING  40  STEPS.
Total reward:  438.9296167050977
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -20.894836613668353
DONE TAKING  40  STEPS.
Total reward:  -12.183415301735685
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -16.70425484709323
DONE TAKING  40  STEPS.
Total reward:  492.68597938899387
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.072534098907553
DONE TAKING  40  STEPS.
Total reward:  51.36599331696554
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -11.94413830859488
DONE TAKING  40  STEPS.
Total reward:  411.40647998971224
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -16.04926754478608
DONE TAKING  40  STEPS.
Total reward:  -246.593608694413
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.83585367622117
DONE TAKING  40  STEPS.
Total reward:  335.293004286011
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.47032172044006
DONE TAKING  40  STEPS.
Total reward:  62.24622767586984
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.482523259878562
DONE TAKING  40  STEPS.
Total reward:  175.6944990478076
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -26.839859181928368
DONE TAKING  40  STEPS.
Total reward:  2.424041369091995
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.732470532076377
DONE TAKING  40  STEPS.
Total reward:  -491.7075930254532
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -15.006085122802693
DONE TAKING  40  STEPS.
Total reward:  161.07051564601412
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.189700528766476
DONE TAKING  40  STEPS.
Total reward:  31.42656115498253
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.383822393213073
DONE TAKING  40  STEPS.
Total reward:  342.9486892508107
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.533168563426393
DONE TAKING  40  STEPS.
Total reward:  -651.7918629737106
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.389484225440402
DONE TAKING  40  STEPS.
Total reward:  19.90678762218259
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -12.077472008421744
DONE TAKING  40  STEPS.
Total reward:  441.8759166874379
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.28134085892898
DONE TAKING  40  STEPS.
Total reward:  226.50375711942425
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.07757474885252
DONE TAKING  40  STEPS.
Total reward:  332.32472089163076
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.65824625222593
DONE TAKING  40  STEPS.
Total reward:  -208.93127916404052
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.684023114618455
DONE TAKING  40  STEPS.
Total reward:  61.495077438785344
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter115.ckpt

#####################################
Training the dynamics model..... iteration  116
#####################################

    amount of random data:  8000
    amount of onPol data:  171216
Prob rand:  30420
On pol:  167040
Prob shape:  (197460,)

=== Epoch 0 ===
    train loss:  0.3609547569380178
    val rand:  0.38299745321273804
    val onPol:  0.2926185764372349

=== Epoch 10 ===
    train loss:  0.2147661323284174
    val rand:  0.21274089813232422
    val onPol:  0.22808671701285574

=== Epoch 20 ===
    train loss:  0.1850398446058298
    val rand:  0.18334385752677917
    val onPol:  0.2241766456928518

=== Epoch 30 ===
    train loss:  0.16899512874615658
    val rand:  0.1716071218252182
    val onPol:  0.22748422829641235

=== Epoch 39 ===
    train loss:  0.15852222891597004
    val rand:  0.16911070048809052
    val onPol:  0.23254221636388037
Training duration: 102.26 s

#####################################
performing on-policy MPC rollouts... iter  116
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.05963577715871
DONE TAKING  40  STEPS.
Total reward:  -57.42328323702823
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.50840379650822
DONE TAKING  40  STEPS.
Total reward:  207.32459916554407
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -31.1327895131899
DONE TAKING  40  STEPS.
Total reward:  -114.80261952571152
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.802796128672618
DONE TAKING  40  STEPS.
Total reward:  76.55454643403435
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.96441112493101
DONE TAKING  40  STEPS.
Total reward:  51.995240343122006
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.86146103508558
DONE TAKING  40  STEPS.
Total reward:  385.1956843591408
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.77889496520205
DONE TAKING  40  STEPS.
Total reward:  471.6491601364336
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.135013875324226
DONE TAKING  40  STEPS.
Total reward:  -373.7534861155115
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.92368665062261
DONE TAKING  40  STEPS.
Total reward:  188.0857995043741
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.077909169359096
DONE TAKING  40  STEPS.
Total reward:  -423.80644352999303
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.020465295442882
DONE TAKING  40  STEPS.
Total reward:  341.9167755066385
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.366946806587617
DONE TAKING  40  STEPS.
Total reward:  170.45582617274675
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.325336422629267
DONE TAKING  40  STEPS.
Total reward:  362.74914557008094
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.2460908820633
DONE TAKING  40  STEPS.
Total reward:  323.8690272142018
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.78915193925981
DONE TAKING  40  STEPS.
Total reward:  388.13523563015775
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.572441275863497
DONE TAKING  40  STEPS.
Total reward:  -48.003428032813915
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.626682721144917
DONE TAKING  40  STEPS.
Total reward:  -218.98912301999252
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.562388268892498
DONE TAKING  40  STEPS.
Total reward:  289.2479342820016
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.554891679452247
DONE TAKING  40  STEPS.
Total reward:  441.38835122881494
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.92521618895024
DONE TAKING  40  STEPS.
Total reward:  301.05653595633345
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.090346566624483
DONE TAKING  40  STEPS.
Total reward:  -31.314985686706837
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.974534417805526
DONE TAKING  40  STEPS.
Total reward:  8.600245106492707
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.208343971332663
DONE TAKING  40  STEPS.
Total reward:  151.54971703259184
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.367438541546328
DONE TAKING  40  STEPS.
Total reward:  -135.05272239008696
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.40468943052814
DONE TAKING  40  STEPS.
Total reward:  -97.14914050487414
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.33168589085642
DONE TAKING  40  STEPS.
Total reward:  -132.98300329222496
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.383638979583264
DONE TAKING  40  STEPS.
Total reward:  448.20628261248305
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.028223651973438
DONE TAKING  40  STEPS.
Total reward:  314.08558428837665
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.93424694924673
DONE TAKING  40  STEPS.
Total reward:  102.74360421522749
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.313618309654295
DONE TAKING  40  STEPS.
Total reward:  -159.06597582498037
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.673603605220023
DONE TAKING  40  STEPS.
Total reward:  83.14976308569703
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.13829926601565
DONE TAKING  40  STEPS.
Total reward:  -178.44047867596828
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.30905269923266
DONE TAKING  40  STEPS.
Total reward:  299.03085043562305
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.181117491689083
DONE TAKING  40  STEPS.
Total reward:  264.0321664144096
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.198454395327403
DONE TAKING  40  STEPS.
Total reward:  221.63348608735555
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -12.356073082148527
DONE TAKING  40  STEPS.
Total reward:  497.1372596973681
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.310940665220468
DONE TAKING  40  STEPS.
Total reward:  406.2653653144852
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.359542034788785
DONE TAKING  40  STEPS.
Total reward:  117.47883016496561
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.1492840951751
DONE TAKING  40  STEPS.
Total reward:  31.51771493192595
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.398949551070714
DONE TAKING  40  STEPS.
Total reward:  478.2141006432996
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter116.ckpt

#####################################
Training the dynamics model..... iteration  117
#####################################

    amount of random data:  8000
    amount of onPol data:  172692
Prob rand:  30615
On pol:  168480
Prob shape:  (199095,)

=== Epoch 0 ===
    train loss:  0.3601612391852841
    val rand:  0.3706130385398865
    val onPol:  0.2923681756688489

=== Epoch 10 ===
    train loss:  0.21439101351137013
    val rand:  0.21469399333000183
    val onPol:  0.22727074805233213

=== Epoch 20 ===
    train loss:  0.186436095572624
    val rand:  0.1793806552886963
    val onPol:  0.2225911104016834

=== Epoch 30 ===
    train loss:  0.16929319247449795
    val rand:  0.17632417380809784
    val onPol:  0.22492168760961956

=== Epoch 39 ===
    train loss:  0.15878829874635972
    val rand:  0.16789531707763672
    val onPol:  0.22899427016576132
Training duration: 98.15 s

#####################################
performing on-policy MPC rollouts... iter  117
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.149672225334818
DONE TAKING  40  STEPS.
Total reward:  157.42514035698377
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.05135437498276
DONE TAKING  40  STEPS.
Total reward:  185.99767755564193
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.186525817789846
DONE TAKING  40  STEPS.
Total reward:  483.51262348942635
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.024288151199443
DONE TAKING  40  STEPS.
Total reward:  -436.9928993559835
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.554215610646732
DONE TAKING  40  STEPS.
Total reward:  292.004246658924
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -31.09323087624808
DONE TAKING  40  STEPS.
Total reward:  176.93338369824136
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.57667331096775
DONE TAKING  40  STEPS.
Total reward:  375.09898233809395
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.93426084382949
DONE TAKING  40  STEPS.
Total reward:  -78.1371886573153
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -15.784390067642718
DONE TAKING  40  STEPS.
Total reward:  500.85370738067445
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.73374263291854
DONE TAKING  40  STEPS.
Total reward:  106.6506740522698
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -16.624384286566894
DONE TAKING  40  STEPS.
Total reward:  578.838096090393
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.340540300941598
DONE TAKING  40  STEPS.
Total reward:  -112.09557296779701
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.58059499933814
DONE TAKING  40  STEPS.
Total reward:  -91.3153998430011
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.228630540055402
DONE TAKING  40  STEPS.
Total reward:  303.21211779206874
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.92226863580797
DONE TAKING  40  STEPS.
Total reward:  -149.60552192289984
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.404041120964745
DONE TAKING  40  STEPS.
Total reward:  94.19203660402655
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.324944829435413
DONE TAKING  40  STEPS.
Total reward:  464.89057742393186
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.435287592675934
DONE TAKING  40  STEPS.
Total reward:  217.37630177411486
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.12284752680827
DONE TAKING  40  STEPS.
Total reward:  -174.36977401598955
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.499347812018065
DONE TAKING  40  STEPS.
Total reward:  -702.3831789474926
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -12.735280565287216
DONE TAKING  40  STEPS.
Total reward:  616.3494852603775
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.341297805751022
DONE TAKING  40  STEPS.
Total reward:  498.14273709817246
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.228555786993304
DONE TAKING  40  STEPS.
Total reward:  141.83515730220068
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.651704134507973
DONE TAKING  40  STEPS.
Total reward:  274.1825122790582
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.198139180617442
DONE TAKING  40  STEPS.
Total reward:  -418.144665372729
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.897541647639095
DONE TAKING  40  STEPS.
Total reward:  403.22328678513884
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.961010505725877
DONE TAKING  40  STEPS.
Total reward:  105.19918988711441
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -18.242787963528432
DONE TAKING  40  STEPS.
Total reward:  39.7395050836018
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.296388131745665
DONE TAKING  40  STEPS.
Total reward:  -68.24557984470728
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.602500046827252
DONE TAKING  40  STEPS.
Total reward:  308.5329269443016
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -14.22500466402655
DONE TAKING  40  STEPS.
Total reward:  527.3195707346488
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.85971197534526
DONE TAKING  40  STEPS.
Total reward:  401.3270149824174
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -29.206163534307557
DONE TAKING  40  STEPS.
Total reward:  12.025078999300757
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.130533215415127
DONE TAKING  40  STEPS.
Total reward:  389.0556452224277
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -31.291727493764817
DONE TAKING  40  STEPS.
Total reward:  396.3097229511908
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.158402545365465
DONE TAKING  40  STEPS.
Total reward:  232.0497742273221
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.0703821562274
DONE TAKING  40  STEPS.
Total reward:  272.5798291888668
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.934234688461316
DONE TAKING  40  STEPS.
Total reward:  59.34795065842121
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -16.510391108145672
DONE TAKING  40  STEPS.
Total reward:  400.28728989114063
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.885478958857615
DONE TAKING  40  STEPS.
Total reward:  -286.8030301802652
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter117.ckpt

#####################################
Training the dynamics model..... iteration  118
#####################################

    amount of random data:  8000
    amount of onPol data:  174168
Prob rand:  30810
On pol:  169920
Prob shape:  (200730,)

=== Epoch 0 ===
    train loss:  0.3606929040076781
    val rand:  0.37935084104537964
    val onPol:  0.2917346962624126

=== Epoch 10 ===
    train loss:  0.21455182720507895
    val rand:  0.21138343214988708
    val onPol:  0.2257439684536722

=== Epoch 20 ===
    train loss:  0.1859581510023195
    val rand:  0.18219856917858124
    val onPol:  0.22018796081344286

=== Epoch 30 ===
    train loss:  0.16928619857193256
    val rand:  0.17648088932037354
    val onPol:  0.22414048512776694

=== Epoch 39 ===
    train loss:  0.1596279237039235
    val rand:  0.1716868281364441
    val onPol:  0.22784724252091515
Training duration: 99.37 s

#####################################
performing on-policy MPC rollouts... iter  118
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.4843395197597
DONE TAKING  40  STEPS.
Total reward:  217.53813987070959
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.493958255267515
DONE TAKING  40  STEPS.
Total reward:  165.4311739485592
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -30.36726517221271
DONE TAKING  40  STEPS.
Total reward:  -309.0039560432826
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.347677106059454
DONE TAKING  40  STEPS.
Total reward:  305.0882708393201
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.85043789369243
DONE TAKING  40  STEPS.
Total reward:  68.23731154184318
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.41488188612809
DONE TAKING  40  STEPS.
Total reward:  -252.20242173846535
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.840272884839848
DONE TAKING  40  STEPS.
Total reward:  232.85632034132243
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.827061796590883
DONE TAKING  40  STEPS.
Total reward:  522.7262247398579
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -12.433683287306314
DONE TAKING  40  STEPS.
Total reward:  247.7271580516381
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.907498949065662
DONE TAKING  40  STEPS.
Total reward:  139.7011127818588
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.865876648365777
DONE TAKING  40  STEPS.
Total reward:  194.60096898196196
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -15.395065205267379
DONE TAKING  40  STEPS.
Total reward:  410.0806101192494
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.80181827367689
DONE TAKING  40  STEPS.
Total reward:  220.71634289636125
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -27.850832642605077
DONE TAKING  40  STEPS.
Total reward:  -27.019234338847752
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.826652267902197
DONE TAKING  40  STEPS.
Total reward:  290.18249658843155
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.144380967028226
DONE TAKING  40  STEPS.
Total reward:  473.2016573947777
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -20.797111644508952
DONE TAKING  40  STEPS.
Total reward:  244.25222833005878
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -31.117027115148417
DONE TAKING  40  STEPS.
Total reward:  120.62552932799201
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.39175225926724
DONE TAKING  40  STEPS.
Total reward:  345.9287583172896
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -18.45357633743778
DONE TAKING  40  STEPS.
Total reward:  -82.13285414453276
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -15.72726057805921
DONE TAKING  40  STEPS.
Total reward:  344.0683927030652
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.337240155471367
DONE TAKING  40  STEPS.
Total reward:  49.94282680234441
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.74555954106192
DONE TAKING  40  STEPS.
Total reward:  206.1296944743013
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.15346166514145
DONE TAKING  40  STEPS.
Total reward:  400.0444770132414
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.34368076657805
DONE TAKING  40  STEPS.
Total reward:  63.74221225091647
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -13.79048792723613
DONE TAKING  40  STEPS.
Total reward:  502.2614961986318
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.602606365010843
DONE TAKING  40  STEPS.
Total reward:  405.2370441998941
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.959158752908678
DONE TAKING  40  STEPS.
Total reward:  378.0856187497218
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.803242837495063
DONE TAKING  40  STEPS.
Total reward:  242.7227978643407
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.59997316826857
DONE TAKING  40  STEPS.
Total reward:  -252.77974351111683
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -14.519232735808803
DONE TAKING  40  STEPS.
Total reward:  321.8409530645496
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.046745727823684
DONE TAKING  40  STEPS.
Total reward:  -139.8949688379133
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.547726152986062
DONE TAKING  40  STEPS.
Total reward:  387.1648138256726
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.561222586358877
DONE TAKING  40  STEPS.
Total reward:  -6.768182285952999
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.638859420874184
DONE TAKING  40  STEPS.
Total reward:  -329.31164873033816
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.024782033047025
DONE TAKING  40  STEPS.
Total reward:  220.14267313304794
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.461722243892083
DONE TAKING  40  STEPS.
Total reward:  266.47121640447097
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.944893995598264
DONE TAKING  40  STEPS.
Total reward:  373.74364791585185
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.585474531708858
DONE TAKING  40  STEPS.
Total reward:  80.45049347018823
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.125620229938242
DONE TAKING  40  STEPS.
Total reward:  117.56126372708259
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter118.ckpt

#####################################
Training the dynamics model..... iteration  119
#####################################

    amount of random data:  8000
    amount of onPol data:  175644
Prob rand:  31005
On pol:  171360
Prob shape:  (202365,)

=== Epoch 0 ===
    train loss:  0.3602419902252246
    val rand:  0.3967737853527069
    val onPol:  0.2922658823631905

=== Epoch 10 ===
    train loss:  0.214323466186282
    val rand:  0.22423593699932098
    val onPol:  0.22842666345673637

=== Epoch 20 ===
    train loss:  0.18657247575023506
    val rand:  0.18158118426799774
    val onPol:  0.22202976047992706

=== Epoch 30 ===
    train loss:  0.170669647485395
    val rand:  0.17238515615463257
    val onPol:  0.22454532255997528

=== Epoch 39 ===
    train loss:  0.16139518120620824
    val rand:  0.16854363679885864
    val onPol:  0.2275428780027338
Training duration: 100.40 s

#####################################
performing on-policy MPC rollouts... iter  119
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.216756188023552
DONE TAKING  40  STEPS.
Total reward:  217.20286035037333
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.46691400181462
DONE TAKING  40  STEPS.
Total reward:  -176.208794773111
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.350465655391023
DONE TAKING  40  STEPS.
Total reward:  312.63499679949
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -18.95553856000703
DONE TAKING  40  STEPS.
Total reward:  259.26076609017275
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.66447380037916
DONE TAKING  40  STEPS.
Total reward:  25.218640009067514
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.291562022189527
DONE TAKING  40  STEPS.
Total reward:  314.5937733344622
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.996849533559917
DONE TAKING  40  STEPS.
Total reward:  51.644881781588936
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -15.42943030612674
DONE TAKING  40  STEPS.
Total reward:  214.6117148191105
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.831978218695568
DONE TAKING  40  STEPS.
Total reward:  271.8356753262338
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -12.95920398280267
DONE TAKING  40  STEPS.
Total reward:  256.41332191087275
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.362116394313468
DONE TAKING  40  STEPS.
Total reward:  223.31405083091983
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.37836319185519
DONE TAKING  40  STEPS.
Total reward:  -364.288826658056
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.039706998276927
DONE TAKING  40  STEPS.
Total reward:  210.71204152264355
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.006100065486862
DONE TAKING  40  STEPS.
Total reward:  273.8378267954097
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -10.660841598580594
DONE TAKING  40  STEPS.
Total reward:  529.3845794316361
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.653923944629767
DONE TAKING  40  STEPS.
Total reward:  32.12375420343532
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.972513964096027
DONE TAKING  40  STEPS.
Total reward:  8.578510139226488
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.36371749669952
DONE TAKING  40  STEPS.
Total reward:  329.6588124555932
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.66831154949593
DONE TAKING  40  STEPS.
Total reward:  402.84975607416914
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.07970061240432
DONE TAKING  40  STEPS.
Total reward:  235.62931303575772
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.72184571534768
DONE TAKING  40  STEPS.
Total reward:  390.16755978927785
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.298022368229226
DONE TAKING  40  STEPS.
Total reward:  -99.34230791329924
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.53100222279754
DONE TAKING  40  STEPS.
Total reward:  390.94560352719515
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.56509365760213
DONE TAKING  40  STEPS.
Total reward:  428.63397694505574
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.440400998207426
DONE TAKING  40  STEPS.
Total reward:  -277.73852135115186
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.194828994583016
DONE TAKING  40  STEPS.
Total reward:  226.08992901333374
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -14.626995740470392
DONE TAKING  40  STEPS.
Total reward:  257.99756093306064
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.958171909806723
DONE TAKING  40  STEPS.
Total reward:  -99.72265077265475
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.886807015730533
DONE TAKING  40  STEPS.
Total reward:  574.50400070046
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.375386133111984
DONE TAKING  40  STEPS.
Total reward:  58.38968401260598
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -13.247437140620633
DONE TAKING  40  STEPS.
Total reward:  492.56086530117307
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -11.712828915637381
DONE TAKING  40  STEPS.
Total reward:  21.68374603718817
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.447485599333998
DONE TAKING  40  STEPS.
Total reward:  56.57043258053321
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.868396610984895
DONE TAKING  40  STEPS.
Total reward:  138.1415894265615
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.65734667868207
DONE TAKING  40  STEPS.
Total reward:  -82.08906359172745
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.74172112104717
DONE TAKING  40  STEPS.
Total reward:  -42.305826019456205
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.68878551077061
DONE TAKING  40  STEPS.
Total reward:  403.1574965503449
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.46672873343841
DONE TAKING  40  STEPS.
Total reward:  -15.083240894215201
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -17.064659236336563
DONE TAKING  40  STEPS.
Total reward:  120.9457678587466
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.463017049444232
DONE TAKING  40  STEPS.
Total reward:  151.7433331872204
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter119.ckpt

#####################################
Training the dynamics model..... iteration  120
#####################################

    amount of random data:  8000
    amount of onPol data:  177120
Prob rand:  31200
On pol:  172800
Prob shape:  (204000,)

=== Epoch 0 ===
    train loss:  0.3619686553825685
    val rand:  0.3817678391933441
    val onPol:  0.29199885154092636

=== Epoch 10 ===
    train loss:  0.21701695260839846
    val rand:  0.21802479028701782
    val onPol:  0.22637966919589686

=== Epoch 20 ===
    train loss:  0.18901435794992064
    val rand:  0.19067808985710144
    val onPol:  0.2200890847960034

=== Epoch 30 ===
    train loss:  0.17480871553097538
    val rand:  0.17347149550914764
    val onPol:  0.22216554227712992

=== Epoch 39 ===
    train loss:  0.16518985536230268
    val rand:  0.17348985373973846
    val onPol:  0.22456541294987137
Training duration: 86.50 s

#####################################
performing on-policy MPC rollouts... iter  120
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.083206975369535
DONE TAKING  40  STEPS.
Total reward:  313.47904032347463
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.800634051653834
DONE TAKING  40  STEPS.
Total reward:  116.19799539927023
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.13097886334145
DONE TAKING  40  STEPS.
Total reward:  84.4376001030322
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.01674603943368
DONE TAKING  40  STEPS.
Total reward:  323.810543683387
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.257173609646475
DONE TAKING  40  STEPS.
Total reward:  181.68565799628584
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.240143437257338
DONE TAKING  40  STEPS.
Total reward:  143.2102746712362
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.41883809807743
DONE TAKING  40  STEPS.
Total reward:  -164.04276796135989
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.1742153071837
DONE TAKING  40  STEPS.
Total reward:  330.4877682488461
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.998979738481403
DONE TAKING  40  STEPS.
Total reward:  217.18525845099379
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -23.334352210095858
DONE TAKING  40  STEPS.
Total reward:  189.8619498137699
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.90966507635013
DONE TAKING  40  STEPS.
Total reward:  334.73252181743544
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.12839599915913
DONE TAKING  40  STEPS.
Total reward:  31.985574553769787
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.898344717086967
DONE TAKING  40  STEPS.
Total reward:  234.29140009234249
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -21.691944628054628
DONE TAKING  40  STEPS.
Total reward:  366.7238364897563
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.828028382789178
DONE TAKING  40  STEPS.
Total reward:  341.8285685934592
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.30610776786167
DONE TAKING  40  STEPS.
Total reward:  249.7962683805295
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.313470960627757
DONE TAKING  40  STEPS.
Total reward:  363.0587498567434
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -31.331705583036232
DONE TAKING  40  STEPS.
Total reward:  191.2478894211166
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.219293235858682
DONE TAKING  40  STEPS.
Total reward:  -134.37556736020986
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.705425564339293
DONE TAKING  40  STEPS.
Total reward:  -177.72916947413685
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.37999769089716
DONE TAKING  40  STEPS.
Total reward:  88.99819251696314
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.293887547003198
DONE TAKING  40  STEPS.
Total reward:  559.0911454545876
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.583392181320704
DONE TAKING  40  STEPS.
Total reward:  -702.676796290333
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.364606106664525
DONE TAKING  40  STEPS.
Total reward:  494.0523069006722
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.654483693939188
DONE TAKING  40  STEPS.
Total reward:  316.8206707819195
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.423544354991094
DONE TAKING  40  STEPS.
Total reward:  287.5373266267253
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.817950290961576
DONE TAKING  40  STEPS.
Total reward:  105.45413434844824
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.6868643619729
DONE TAKING  40  STEPS.
Total reward:  280.6536549099551
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.95039290068965
DONE TAKING  40  STEPS.
Total reward:  74.67657529011369
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.21173426491822
DONE TAKING  40  STEPS.
Total reward:  273.8436389945111
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -13.549132652471236
DONE TAKING  40  STEPS.
Total reward:  452.1430092752889
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.131100740317443
DONE TAKING  40  STEPS.
Total reward:  85.149866661472
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.3889735882713
DONE TAKING  40  STEPS.
Total reward:  353.93037536467466
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -22.603136272939246
DONE TAKING  40  STEPS.
Total reward:  -136.3741186420829
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -12.529246383527202
DONE TAKING  40  STEPS.
Total reward:  315.2867528222184
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.602885192810177
DONE TAKING  40  STEPS.
Total reward:  100.59091983361094
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.895321022025684
DONE TAKING  40  STEPS.
Total reward:  226.7670077365162
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.039494908744572
DONE TAKING  40  STEPS.
Total reward:  447.4058407793659
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.47063569190997
DONE TAKING  40  STEPS.
Total reward:  -97.34657609768244
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -15.495000999299876
DONE TAKING  40  STEPS.
Total reward:  420.27930221135495
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter120.ckpt

#####################################
Training the dynamics model..... iteration  121
#####################################

    amount of random data:  8000
    amount of onPol data:  178596
Prob rand:  31395
On pol:  174240
Prob shape:  (205635,)

=== Epoch 0 ===
    train loss:  0.359944187420562
    val rand:  0.3823469877243042
    val onPol:  0.2907238211986181

=== Epoch 10 ===
    train loss:  0.21462762437556449
    val rand:  0.21881723403930664
    val onPol:  0.2267231425723514

=== Epoch 20 ===
    train loss:  0.186239181202546
    val rand:  0.18413977324962616
    val onPol:  0.220261014393858

=== Epoch 30 ===
    train loss:  0.16979986797098506
    val rand:  0.17037993669509888
    val onPol:  0.2226354946961274

=== Epoch 39 ===
    train loss:  0.15909482048188064
    val rand:  0.17151564359664917
    val onPol:  0.22641856847582637
Training duration: 101.10 s

#####################################
performing on-policy MPC rollouts... iter  121
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -17.883202798808462
DONE TAKING  40  STEPS.
Total reward:  440.68497822324576
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.23011929809729
DONE TAKING  40  STEPS.
Total reward:  60.94432115122236
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.529283750745083
DONE TAKING  40  STEPS.
Total reward:  -102.87396199736735
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.12380320544689
DONE TAKING  40  STEPS.
Total reward:  -322.95856467027477
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.43965905928516
DONE TAKING  40  STEPS.
Total reward:  273.7930259438866
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -24.284234235050253
DONE TAKING  40  STEPS.
Total reward:  114.87189108936009
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.703989920118705
DONE TAKING  40  STEPS.
Total reward:  -134.91623242118717
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.31708621059338
DONE TAKING  40  STEPS.
Total reward:  265.68787243727263
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -25.347895025243655
DONE TAKING  40  STEPS.
Total reward:  220.60265600503965
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.783392804667205
DONE TAKING  40  STEPS.
Total reward:  -720.0246098057363
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.74666020636852
DONE TAKING  40  STEPS.
Total reward:  526.4402580433443
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.53950785751644
DONE TAKING  40  STEPS.
Total reward:  42.76780523725439
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.42805648220403
DONE TAKING  40  STEPS.
Total reward:  190.6600178876768
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -12.741100644290313
DONE TAKING  40  STEPS.
Total reward:  179.4148537121058
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -16.35640839468698
DONE TAKING  40  STEPS.
Total reward:  432.9878708889199
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.940080844164264
DONE TAKING  40  STEPS.
Total reward:  318.03840126988524
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.214591540466735
DONE TAKING  40  STEPS.
Total reward:  348.57831624928946
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.405468355694786
DONE TAKING  40  STEPS.
Total reward:  -164.60477562686668
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.786966763176515
DONE TAKING  40  STEPS.
Total reward:  108.17338332619863
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.682871909006323
DONE TAKING  40  STEPS.
Total reward:  268.72886357772916
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.16018439838272
DONE TAKING  40  STEPS.
Total reward:  359.0769381432339
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.000851123271715
DONE TAKING  40  STEPS.
Total reward:  302.86301558801784
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.8328551458642
DONE TAKING  40  STEPS.
Total reward:  421.4061868368781
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.767950867323673
DONE TAKING  40  STEPS.
Total reward:  51.066940874937266
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.056478417211416
DONE TAKING  40  STEPS.
Total reward:  286.2624430959791
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.08760847155767
DONE TAKING  40  STEPS.
Total reward:  349.5682194642323
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.41108018636304
DONE TAKING  40  STEPS.
Total reward:  -15.123491815313914
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -9.862362016470547
DONE TAKING  40  STEPS.
Total reward:  499.63307803696733
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.40636702404808
DONE TAKING  40  STEPS.
Total reward:  254.57883113452172
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.240505319094837
DONE TAKING  40  STEPS.
Total reward:  -433.7393106981642
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.783014320523925
DONE TAKING  40  STEPS.
Total reward:  331.1104576257779
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.507120654474228
DONE TAKING  40  STEPS.
Total reward:  312.22234052372653
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.770813390129952
DONE TAKING  40  STEPS.
Total reward:  -355.4911156439997
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.507794531650276
DONE TAKING  40  STEPS.
Total reward:  345.0027485395322
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -17.921914744748175
DONE TAKING  40  STEPS.
Total reward:  69.9266013716951
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.753234642643523
DONE TAKING  40  STEPS.
Total reward:  140.17682249442393
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.14295414510846
DONE TAKING  40  STEPS.
Total reward:  299.32387815462147
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.485978917720676
DONE TAKING  40  STEPS.
Total reward:  -135.81672275745976
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.692529302015178
DONE TAKING  40  STEPS.
Total reward:  161.51595154607378
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.472518809374705
DONE TAKING  40  STEPS.
Total reward:  312.3477653350704
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter121.ckpt

#####################################
Training the dynamics model..... iteration  122
#####################################

    amount of random data:  8000
    amount of onPol data:  180072
Prob rand:  31590
On pol:  175680
Prob shape:  (207270,)

=== Epoch 0 ===
    train loss:  0.36033786796402223
    val rand:  0.3763192594051361
    val onPol:  0.29457566573431615

=== Epoch 10 ===
    train loss:  0.21458273499023797
    val rand:  0.21912893652915955
    val onPol:  0.22731605838788183

=== Epoch 20 ===
    train loss:  0.1869881408344401
    val rand:  0.19003687798976898
    val onPol:  0.22294415180620394

=== Epoch 30 ===
    train loss:  0.17131433374073246
    val rand:  0.17147593200206757
    val onPol:  0.2259332176886107

=== Epoch 39 ===
    train loss:  0.16139288408921496
    val rand:  0.17175078392028809
    val onPol:  0.22852951288223267
Training duration: 101.98 s

#####################################
performing on-policy MPC rollouts... iter  122
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -15.69265554158757
DONE TAKING  40  STEPS.
Total reward:  -21.52321848989525
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.427941560545456
DONE TAKING  40  STEPS.
Total reward:  218.78423643861012
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -16.420293163597663
DONE TAKING  40  STEPS.
Total reward:  247.18505427445282
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.35177726499319
DONE TAKING  40  STEPS.
Total reward:  170.1780697816773
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.04512583304458
DONE TAKING  40  STEPS.
Total reward:  397.96192517384543
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.76789898779509
DONE TAKING  40  STEPS.
Total reward:  -82.51159743363738
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.47262451591159
DONE TAKING  40  STEPS.
Total reward:  250.90878206682993
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.139340445214593
DONE TAKING  40  STEPS.
Total reward:  372.50546891517916
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.142131299053244
DONE TAKING  40  STEPS.
Total reward:  528.9846825279335
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.170400378695614
DONE TAKING  40  STEPS.
Total reward:  24.613440290806057
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -12.66452811158555
DONE TAKING  40  STEPS.
Total reward:  274.32993872966307
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.609847595985766
DONE TAKING  40  STEPS.
Total reward:  494.56758182489733
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.704869187321002
DONE TAKING  40  STEPS.
Total reward:  413.1627077793307
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.516414383179125
DONE TAKING  40  STEPS.
Total reward:  300.0215953561361
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.64552920828565
DONE TAKING  40  STEPS.
Total reward:  283.5694834057871
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -20.456590770828143
DONE TAKING  40  STEPS.
Total reward:  198.05712040100306
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -28.18217376033276
DONE TAKING  40  STEPS.
Total reward:  219.88768585361439
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.12335617762325
DONE TAKING  40  STEPS.
Total reward:  -182.7332497813294
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.595496500588844
DONE TAKING  40  STEPS.
Total reward:  304.0846142899966
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -13.992932692472566
DONE TAKING  40  STEPS.
Total reward:  499.6881653226048
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.81412766425377
DONE TAKING  40  STEPS.
Total reward:  54.9543452930274
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.385898254394082
DONE TAKING  40  STEPS.
Total reward:  81.58497684083947
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.87442206353429
DONE TAKING  40  STEPS.
Total reward:  347.6093902850258
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.861778391929604
DONE TAKING  40  STEPS.
Total reward:  192.7524303869152
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.041990001846735
DONE TAKING  40  STEPS.
Total reward:  17.068040832776525
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.033625430918562
DONE TAKING  40  STEPS.
Total reward:  74.65347800153316
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.732454098069642
DONE TAKING  40  STEPS.
Total reward:  203.15602315054568
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -14.217588836739253
DONE TAKING  40  STEPS.
Total reward:  219.85099486738352
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.23662973803258
DONE TAKING  40  STEPS.
Total reward:  334.2630676760925
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.147950619044032
DONE TAKING  40  STEPS.
Total reward:  -295.3249301098667
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.19688200694161
DONE TAKING  40  STEPS.
Total reward:  383.00527323076074
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.04603629958099
DONE TAKING  40  STEPS.
Total reward:  241.02519677017227
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.927200885026984
DONE TAKING  40  STEPS.
Total reward:  339.88304183749966
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.924189747620822
DONE TAKING  40  STEPS.
Total reward:  171.11335335841085
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -11.776669616497708
DONE TAKING  40  STEPS.
Total reward:  345.0282868290886
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.21238554369284
DONE TAKING  40  STEPS.
Total reward:  443.04141963511887
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -14.209732324045243
DONE TAKING  40  STEPS.
Total reward:  507.9195913829584
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.631251872829985
DONE TAKING  40  STEPS.
Total reward:  558.8819549503746
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.915456336588392
DONE TAKING  40  STEPS.
Total reward:  478.16786026332386
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.663589598655882
DONE TAKING  40  STEPS.
Total reward:  264.51858762490065
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter122.ckpt

#####################################
Training the dynamics model..... iteration  123
#####################################

    amount of random data:  8000
    amount of onPol data:  181548
Prob rand:  31785
On pol:  177120
Prob shape:  (208905,)

=== Epoch 0 ===
    train loss:  0.36376844361132266
    val rand:  0.3765215575695038
    val onPol:  0.29268331276743037

=== Epoch 10 ===
    train loss:  0.2152711437905536
    val rand:  0.2174728363752365
    val onPol:  0.2256887696291271

=== Epoch 20 ===
    train loss:  0.18897888068036706
    val rand:  0.18629609048366547
    val onPol:  0.21990279853343964

=== Epoch 30 ===
    train loss:  0.17270038751702682
    val rand:  0.17437323927879333
    val onPol:  0.22128855280186

=== Epoch 39 ===
    train loss:  0.16334210551690823
    val rand:  0.17610982060432434
    val onPol:  0.22515673660918287
Training duration: 104.77 s

#####################################
performing on-policy MPC rollouts... iter  123
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.931069422609774
DONE TAKING  40  STEPS.
Total reward:  283.5140921126973
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.89078285920599
DONE TAKING  40  STEPS.
Total reward:  115.52960123173676
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.87813108402823
DONE TAKING  40  STEPS.
Total reward:  201.45650590657144
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.795306114882635
DONE TAKING  40  STEPS.
Total reward:  323.47960375710807
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.46227205227818
DONE TAKING  40  STEPS.
Total reward:  123.16597219269758
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.828180507931485
DONE TAKING  40  STEPS.
Total reward:  112.3331974672517
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -18.566332084000873
DONE TAKING  40  STEPS.
Total reward:  4.282384676913959
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.455641778382986
DONE TAKING  40  STEPS.
Total reward:  -184.46276388013197
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -24.60527686392595
DONE TAKING  40  STEPS.
Total reward:  409.48625706699323
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.820290381779742
DONE TAKING  40  STEPS.
Total reward:  10.716727054657209
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.494743683761293
DONE TAKING  40  STEPS.
Total reward:  375.163983350765
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.797795110369716
DONE TAKING  40  STEPS.
Total reward:  201.01173342306774
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.260658885163995
DONE TAKING  40  STEPS.
Total reward:  -133.13860703239408
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.714590643310007
DONE TAKING  40  STEPS.
Total reward:  363.2597477858048
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -30.7871437822126
DONE TAKING  40  STEPS.
Total reward:  272.1400154221834
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.827881737003814
DONE TAKING  40  STEPS.
Total reward:  101.94173656240758
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.626835862855646
DONE TAKING  40  STEPS.
Total reward:  368.88116452503505
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.85167170935917
DONE TAKING  40  STEPS.
Total reward:  -584.6687205135363
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -13.843236986891554
DONE TAKING  40  STEPS.
Total reward:  472.5808917950319
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.73414351899249
DONE TAKING  40  STEPS.
Total reward:  298.937535954548
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -11.572388645117673
DONE TAKING  40  STEPS.
Total reward:  344.2513107036272
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.99670875038136
DONE TAKING  40  STEPS.
Total reward:  140.6264605697631
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.575183821708364
DONE TAKING  40  STEPS.
Total reward:  -51.683934099746224
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.761582875270484
DONE TAKING  40  STEPS.
Total reward:  356.5515450690571
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.13878163777769
DONE TAKING  40  STEPS.
Total reward:  58.99020473249859
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -16.716244475009752
DONE TAKING  40  STEPS.
Total reward:  429.07247873708815
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.72849344791647
DONE TAKING  40  STEPS.
Total reward:  -180.43169955958479
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.61095585203179
DONE TAKING  40  STEPS.
Total reward:  439.3367440744317
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -16.21383790278733
DONE TAKING  40  STEPS.
Total reward:  52.782969873491844
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.004487754196504
DONE TAKING  40  STEPS.
Total reward:  -154.94841450942846
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -13.183242127709464
DONE TAKING  40  STEPS.
Total reward:  437.38148791040794
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -10.744106587069595
DONE TAKING  40  STEPS.
Total reward:  139.27671955723588
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -31.344268544684493
DONE TAKING  40  STEPS.
Total reward:  89.71230648892083
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -22.258170115937578
DONE TAKING  40  STEPS.
Total reward:  219.6664061239095
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.988867823801293
DONE TAKING  40  STEPS.
Total reward:  205.0794816161728
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -23.055116575586794
DONE TAKING  40  STEPS.
Total reward:  172.24609679648904
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.638449731012138
DONE TAKING  40  STEPS.
Total reward:  52.664498480041566
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.30135705577716
DONE TAKING  40  STEPS.
Total reward:  130.96320953147875
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.936361180001036
DONE TAKING  40  STEPS.
Total reward:  299.6259682273934
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.80800874102093
DONE TAKING  40  STEPS.
Total reward:  317.9378087968365
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter123.ckpt

#####################################
Training the dynamics model..... iteration  124
#####################################

    amount of random data:  8000
    amount of onPol data:  183024
Prob rand:  31980
On pol:  178560
Prob shape:  (210540,)

=== Epoch 0 ===
    train loss:  0.3586567165352712
    val rand:  0.3817121982574463
    val onPol:  0.292947797790954

=== Epoch 10 ===
    train loss:  0.21477710903416006
    val rand:  0.22178500890731812
    val onPol:  0.22684535619459653

=== Epoch 20 ===
    train loss:  0.1879973451441512
    val rand:  0.19266025722026825
    val onPol:  0.2202971236486184

=== Epoch 30 ===
    train loss:  0.17286260458674743
    val rand:  0.1784898340702057
    val onPol:  0.22312245557182714

=== Epoch 39 ===
    train loss:  0.16324387073806892
    val rand:  0.17446893453598022
    val onPol:  0.22597033138337888
Training duration: 104.35 s

#####################################
performing on-policy MPC rollouts... iter  124
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.596632705967686
DONE TAKING  40  STEPS.
Total reward:  279.5225655337467
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.448970841060385
DONE TAKING  40  STEPS.
Total reward:  339.02708066844514
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -13.199924412257564
DONE TAKING  40  STEPS.
Total reward:  375.27436708495077
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.61411572381779
DONE TAKING  40  STEPS.
Total reward:  11.916294040155663
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.264557714948992
DONE TAKING  40  STEPS.
Total reward:  286.8732501810799
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.81765396913347
DONE TAKING  40  STEPS.
Total reward:  352.11819101906644
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.677522565037393
DONE TAKING  40  STEPS.
Total reward:  191.8261762640229
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.0866625457994
DONE TAKING  40  STEPS.
Total reward:  207.59942880694527
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.016726361567983
DONE TAKING  40  STEPS.
Total reward:  238.80730645020074
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.371082001176628
DONE TAKING  40  STEPS.
Total reward:  224.6331912534738
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.859326044210075
DONE TAKING  40  STEPS.
Total reward:  -341.9993153387734
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -18.24275594563656
DONE TAKING  40  STEPS.
Total reward:  220.24096588620753
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.08708626533607
DONE TAKING  40  STEPS.
Total reward:  407.54742647485966
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.421034737124195
DONE TAKING  40  STEPS.
Total reward:  302.0787155933631
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.55719867711772
DONE TAKING  40  STEPS.
Total reward:  219.1543697018754
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -14.474307820940872
DONE TAKING  40  STEPS.
Total reward:  476.28208757329475
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -16.59593084713604
DONE TAKING  40  STEPS.
Total reward:  490.8328038583436
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.495346208729956
DONE TAKING  40  STEPS.
Total reward:  302.4690346242625
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.179115647994863
DONE TAKING  40  STEPS.
Total reward:  -301.67290745349675
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.98460042944331
DONE TAKING  40  STEPS.
Total reward:  265.9557687601214
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.534583336821782
DONE TAKING  40  STEPS.
Total reward:  181.2839405098881
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.016557455717695
DONE TAKING  40  STEPS.
Total reward:  395.23854183772295
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -9.916734062223979
DONE TAKING  40  STEPS.
Total reward:  452.0685822801952
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.330146704226372
DONE TAKING  40  STEPS.
Total reward:  401.55094196362904
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.92505309525547
DONE TAKING  40  STEPS.
Total reward:  69.02555301397558
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.34763018523999
DONE TAKING  40  STEPS.
Total reward:  89.39746059358501
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.565425327245773
DONE TAKING  40  STEPS.
Total reward:  28.066888945072247
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.523077860038637
DONE TAKING  40  STEPS.
Total reward:  231.03632629929584
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.568800982713547
DONE TAKING  40  STEPS.
Total reward:  17.180990872111593
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.411896285944405
DONE TAKING  40  STEPS.
Total reward:  221.6183717258
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.129709765143392
DONE TAKING  40  STEPS.
Total reward:  202.5040930486755
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -17.692497829245642
DONE TAKING  40  STEPS.
Total reward:  253.07018984762595
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -17.360053710083644
DONE TAKING  40  STEPS.
Total reward:  386.5162616645878
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -10.219872732205053
DONE TAKING  40  STEPS.
Total reward:  479.3734455654037
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -14.242002822153754
DONE TAKING  40  STEPS.
Total reward:  365.6214320909038
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -15.452997390101322
DONE TAKING  40  STEPS.
Total reward:  563.0805635638757
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.19469199420835
DONE TAKING  40  STEPS.
Total reward:  -88.6557179785267
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.489814776758237
DONE TAKING  40  STEPS.
Total reward:  452.7082611344501
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.69200285148022
DONE TAKING  40  STEPS.
Total reward:  350.4279669128078
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.707740185817935
DONE TAKING  40  STEPS.
Total reward:  550.8880677577347
Time for 1 rollout: 1.23 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter124.ckpt

#####################################
Training the dynamics model..... iteration  125
#####################################

    amount of random data:  8000
    amount of onPol data:  184500
Prob rand:  32175
On pol:  180000
Prob shape:  (212175,)

=== Epoch 0 ===
    train loss:  0.3604356702687084
    val rand:  0.3859017491340637
    val onPol:  0.29299745192894566

=== Epoch 10 ===
    train loss:  0.2147418428302387
    val rand:  0.21778112649917603
    val onPol:  0.22612771621117225

=== Epoch 20 ===
    train loss:  0.18828479668512438
    val rand:  0.18773329257965088
    val onPol:  0.2196323172404216

=== Epoch 30 ===
    train loss:  0.17292293679455054
    val rand:  0.17914895713329315
    val onPol:  0.2218307688450202

=== Epoch 39 ===
    train loss:  0.16409807922183603
    val rand:  0.17368674278259277
    val onPol:  0.22449601537142044
Training duration: 110.89 s

#####################################
performing on-policy MPC rollouts... iter  125
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.130930251488884
DONE TAKING  40  STEPS.
Total reward:  210.65890227882565
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.255845709571705
DONE TAKING  40  STEPS.
Total reward:  466.38951579969705
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.826975862766417
DONE TAKING  40  STEPS.
Total reward:  271.2042029556708
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.79097734467227
DONE TAKING  40  STEPS.
Total reward:  -431.1177348451836
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.140820426826824
DONE TAKING  40  STEPS.
Total reward:  347.78411509952423
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.811490523012754
DONE TAKING  40  STEPS.
Total reward:  211.57335098244448
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -18.24796282804419
DONE TAKING  40  STEPS.
Total reward:  379.01122192483365
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -19.126500769299476
DONE TAKING  40  STEPS.
Total reward:  460.4391056030053
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.77455876105174
DONE TAKING  40  STEPS.
Total reward:  -331.07761069753496
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.77699183633622
DONE TAKING  40  STEPS.
Total reward:  209.06119732300627
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.95308650657808
DONE TAKING  40  STEPS.
Total reward:  355.0704551429595
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.553005220241673
DONE TAKING  40  STEPS.
Total reward:  8.699026387537037
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.5839924828144
DONE TAKING  40  STEPS.
Total reward:  180.6209428730759
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -18.709428026813796
DONE TAKING  40  STEPS.
Total reward:  328.96625258435097
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.92229825545518
DONE TAKING  40  STEPS.
Total reward:  205.68493219009687
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.364326580384294
DONE TAKING  40  STEPS.
Total reward:  25.795923993056192
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.33144382454253
DONE TAKING  40  STEPS.
Total reward:  21.75548199268924
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.187456293328985
DONE TAKING  40  STEPS.
Total reward:  290.18697442452077
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -13.952926204290536
DONE TAKING  40  STEPS.
Total reward:  491.77913582742485
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.979941171699846
DONE TAKING  40  STEPS.
Total reward:  319.9065494296102
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.75190645684514
DONE TAKING  40  STEPS.
Total reward:  449.4753061170883
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.047939020019438
DONE TAKING  40  STEPS.
Total reward:  236.9301416483024
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.12063346602579
DONE TAKING  40  STEPS.
Total reward:  -89.43699649866937
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -15.578748274784889
DONE TAKING  40  STEPS.
Total reward:  577.4955072366723
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.113035613121326
DONE TAKING  40  STEPS.
Total reward:  410.16363030237994
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.597019244410642
DONE TAKING  40  STEPS.
Total reward:  -66.17077142960994
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.98940696971287
DONE TAKING  40  STEPS.
Total reward:  247.75904977836512
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.21020173330821
DONE TAKING  40  STEPS.
Total reward:  313.96144178480375
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.66870309822674
DONE TAKING  40  STEPS.
Total reward:  356.7446002281858
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -18.87508215332768
DONE TAKING  40  STEPS.
Total reward:  41.10748564572444
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -31.123785746991295
DONE TAKING  40  STEPS.
Total reward:  345.58603853891384
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.49158729964944
DONE TAKING  40  STEPS.
Total reward:  323.6533556612382
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -10.47620636484911
DONE TAKING  40  STEPS.
Total reward:  518.9833623668876
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.97514483257298
DONE TAKING  40  STEPS.
Total reward:  223.719453720964
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.40597175696775
DONE TAKING  40  STEPS.
Total reward:  19.734231167814578
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.926651343286927
DONE TAKING  40  STEPS.
Total reward:  189.13926623156974
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -31.194176475521523
DONE TAKING  40  STEPS.
Total reward:  357.7308310169217
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -20.46914099008518
DONE TAKING  40  STEPS.
Total reward:  382.26083496539184
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.240072313947138
DONE TAKING  40  STEPS.
Total reward:  -106.77123917899421
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.459757440923866
DONE TAKING  40  STEPS.
Total reward:  70.6527367075566
Time for 1 rollout: 1.22 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter125.ckpt

#####################################
Training the dynamics model..... iteration  126
#####################################

    amount of random data:  8000
    amount of onPol data:  185976
Prob rand:  32370
On pol:  181440
Prob shape:  (213810,)

=== Epoch 0 ===
    train loss:  0.3606232640554579
    val rand:  0.3951053023338318
    val onPol:  0.29174299461719316

=== Epoch 10 ===
    train loss:  0.21404773129119004
    val rand:  0.21555373072624207
    val onPol:  0.2236109509682044

=== Epoch 20 ===
    train loss:  0.1876252282151787
    val rand:  0.18709957599639893
    val onPol:  0.21895643495596373

=== Epoch 30 ===
    train loss:  0.1729729834148924
    val rand:  0.1775410771369934
    val onPol:  0.22155342996120453

=== Epoch 39 ===
    train loss:  0.16338945442824054
    val rand:  0.16725151240825653
    val onPol:  0.22492539080289695
Training duration: 105.93 s

#####################################
performing on-policy MPC rollouts... iter  126
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.57674128641456
DONE TAKING  40  STEPS.
Total reward:  -61.79914342298602
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.10868437522324
DONE TAKING  40  STEPS.
Total reward:  -117.33046858735457
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -31.31155467861405
DONE TAKING  40  STEPS.
Total reward:  -42.567424855262615
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.74476434261171
DONE TAKING  40  STEPS.
Total reward:  384.09566984699893
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.873647294661403
DONE TAKING  40  STEPS.
Total reward:  453.7093411715409
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -9.72876513375278
DONE TAKING  40  STEPS.
Total reward:  418.90101172016546
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.85599520186817
DONE TAKING  40  STEPS.
Total reward:  -377.0924135456397
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.603052851010993
DONE TAKING  40  STEPS.
Total reward:  299.12515940816996
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.88831424596652
DONE TAKING  40  STEPS.
Total reward:  193.94820574821676
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.439809064973547
DONE TAKING  40  STEPS.
Total reward:  223.91196417014183
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.092458880176416
DONE TAKING  40  STEPS.
Total reward:  367.37110569575856
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.510518553641305
DONE TAKING  40  STEPS.
Total reward:  7.927014242160123
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -16.308710891754753
DONE TAKING  40  STEPS.
Total reward:  10.205346226972111
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.19249236679493
DONE TAKING  40  STEPS.
Total reward:  300.17738910119346
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.458732020303778
DONE TAKING  40  STEPS.
Total reward:  -64.36034449711144
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.570673043485037
DONE TAKING  40  STEPS.
Total reward:  419.9473873107954
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -15.794886683563895
DONE TAKING  40  STEPS.
Total reward:  343.90147123672403
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.192962688729757
DONE TAKING  40  STEPS.
Total reward:  125.27744399917897
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -12.45463031295511
DONE TAKING  40  STEPS.
Total reward:  292.8845769419447
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.808709072949753
DONE TAKING  40  STEPS.
Total reward:  416.7651281491807
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.94328509058389
DONE TAKING  40  STEPS.
Total reward:  86.86157482597322
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -14.889543979598571
DONE TAKING  40  STEPS.
Total reward:  402.39812702946324
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.838934035198168
DONE TAKING  40  STEPS.
Total reward:  328.09855379347164
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.08846358864127
DONE TAKING  40  STEPS.
Total reward:  -10.482808225829721
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -31.118427723392283
DONE TAKING  40  STEPS.
Total reward:  281.4857763763221
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.378013131245865
DONE TAKING  40  STEPS.
Total reward:  -759.0357398127557
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.540963277678227
DONE TAKING  40  STEPS.
Total reward:  74.6735370213326
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.7110276384128
DONE TAKING  40  STEPS.
Total reward:  287.6023455716291
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.268575282352632
DONE TAKING  40  STEPS.
Total reward:  351.2388181241517
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.353920481557367
DONE TAKING  40  STEPS.
Total reward:  382.8218471615738
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.697695801255126
DONE TAKING  40  STEPS.
Total reward:  318.9175353492855
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.55943642915707
DONE TAKING  40  STEPS.
Total reward:  87.16409303713709
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -12.816228646624776
DONE TAKING  40  STEPS.
Total reward:  444.819568682658
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -14.842187253103809
DONE TAKING  40  STEPS.
Total reward:  368.8627144449004
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.141452902751972
DONE TAKING  40  STEPS.
Total reward:  294.0394713051124
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.389100111934084
DONE TAKING  40  STEPS.
Total reward:  -87.2854052708818
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -11.229363686002776
DONE TAKING  40  STEPS.
Total reward:  438.9737797608294
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.37894479136146
DONE TAKING  40  STEPS.
Total reward:  103.22408761585984
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.40817199305597
DONE TAKING  40  STEPS.
Total reward:  462.71177231126114
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -21.9725597374895
DONE TAKING  40  STEPS.
Total reward:  447.4066804987211
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter126.ckpt

#####################################
Training the dynamics model..... iteration  127
#####################################

    amount of random data:  8000
    amount of onPol data:  187452
Prob rand:  32565
On pol:  182880
Prob shape:  (215445,)

=== Epoch 0 ===
    train loss:  0.358803953230381
    val rand:  0.39391812682151794
    val onPol:  0.29280897210805845

=== Epoch 10 ===
    train loss:  0.21438925273361661
    val rand:  0.21856944262981415
    val onPol:  0.22569305163163406

=== Epoch 20 ===
    train loss:  0.18945848296085993
    val rand:  0.1832108348608017
    val onPol:  0.21915479004383087

=== Epoch 30 ===
    train loss:  0.17323988480936914
    val rand:  0.17737220227718353
    val onPol:  0.2212708626802151

=== Epoch 39 ===
    train loss:  0.1642696167031924
    val rand:  0.16737954318523407
    val onPol:  0.223927969733874
Training duration: 113.12 s

#####################################
performing on-policy MPC rollouts... iter  127
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.002561333441466
DONE TAKING  40  STEPS.
Total reward:  213.03261983420532
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -22.110269569991896
DONE TAKING  40  STEPS.
Total reward:  338.5698010114048
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.358075717326367
DONE TAKING  40  STEPS.
Total reward:  251.2883198791522
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.63731602810992
DONE TAKING  40  STEPS.
Total reward:  474.13972921010304
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.811298810121905
DONE TAKING  40  STEPS.
Total reward:  -28.07202188888155
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -11.893155760828522
DONE TAKING  40  STEPS.
Total reward:  69.64527432041142
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.60631715137473
DONE TAKING  40  STEPS.
Total reward:  262.29485074159084
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.869469391293208
DONE TAKING  40  STEPS.
Total reward:  293.16691644422247
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -10.602826991110494
DONE TAKING  40  STEPS.
Total reward:  407.8740941802658
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -21.67360912718998
DONE TAKING  40  STEPS.
Total reward:  473.3759320392153
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.961627720017248
DONE TAKING  40  STEPS.
Total reward:  292.1045074261339
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.21021513733321
DONE TAKING  40  STEPS.
Total reward:  208.28534539198188
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.464123301316835
DONE TAKING  40  STEPS.
Total reward:  -3.8276776155540713
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.12892008627135
DONE TAKING  40  STEPS.
Total reward:  222.1396023810423
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.138047026589387
DONE TAKING  40  STEPS.
Total reward:  252.83112420179623
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.945630705295393
DONE TAKING  40  STEPS.
Total reward:  170.38272004457994
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.65307997267496
DONE TAKING  40  STEPS.
Total reward:  -53.56696178222688
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.40897551602901
DONE TAKING  40  STEPS.
Total reward:  -472.8667194988224
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.615593822200857
DONE TAKING  40  STEPS.
Total reward:  292.8132173107014
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.082091480002205
DONE TAKING  40  STEPS.
Total reward:  39.84700653869821
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.634811767564585
DONE TAKING  40  STEPS.
Total reward:  349.9016371899035
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.329650389837212
DONE TAKING  40  STEPS.
Total reward:  111.01882407328296
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.903313540417585
DONE TAKING  40  STEPS.
Total reward:  141.75202172753103
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.82192554105158
DONE TAKING  40  STEPS.
Total reward:  307.7040088757148
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.271693490224273
DONE TAKING  40  STEPS.
Total reward:  83.78420980175792
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.236167073745248
DONE TAKING  40  STEPS.
Total reward:  237.48115500045432
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -11.839502365341739
DONE TAKING  40  STEPS.
Total reward:  7.71591488640874
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.112094661278057
DONE TAKING  40  STEPS.
Total reward:  141.58566308786274
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.798805730128535
DONE TAKING  40  STEPS.
Total reward:  -171.0788771332364
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -18.400720694655583
DONE TAKING  40  STEPS.
Total reward:  479.90132289078167
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.181668976428753
DONE TAKING  40  STEPS.
Total reward:  212.4193246173009
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -29.57550629560889
DONE TAKING  40  STEPS.
Total reward:  -47.38590624643916
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -31.400765082711246
DONE TAKING  40  STEPS.
Total reward:  -143.13505536277674
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.187201339408567
DONE TAKING  40  STEPS.
Total reward:  -164.3030513132786
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -31.246153414721157
DONE TAKING  40  STEPS.
Total reward:  152.05785933217774
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.267563110937846
DONE TAKING  40  STEPS.
Total reward:  338.6919800819253
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.357208196415073
DONE TAKING  40  STEPS.
Total reward:  386.6660596910991
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.00355413112104
DONE TAKING  40  STEPS.
Total reward:  189.0158189514072
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.9468481064121
DONE TAKING  40  STEPS.
Total reward:  363.79449455944155
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -17.23961019712346
DONE TAKING  40  STEPS.
Total reward:  471.85056532066665
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter127.ckpt

#####################################
Training the dynamics model..... iteration  128
#####################################

    amount of random data:  8000
    amount of onPol data:  188928
Prob rand:  32760
On pol:  184320
Prob shape:  (217080,)

=== Epoch 0 ===
    train loss:  0.3600624977274144
    val rand:  0.38057947158813477
    val onPol:  0.29047114998102186

=== Epoch 10 ===
    train loss:  0.2148538597861644
    val rand:  0.2207755744457245
    val onPol:  0.22443799898028374

=== Epoch 20 ===
    train loss:  0.18847922561580127
    val rand:  0.18948660790920258
    val onPol:  0.21765746399760247

=== Epoch 30 ===
    train loss:  0.1732570367642892
    val rand:  0.17664293944835663
    val onPol:  0.21909800581634045

=== Epoch 39 ===
    train loss:  0.16346377944551743
    val rand:  0.17271298170089722
    val onPol:  0.22307096384465694
Training duration: 108.19 s

#####################################
performing on-policy MPC rollouts... iter  128
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.735613369667412
DONE TAKING  40  STEPS.
Total reward:  184.11277362658393
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.29084023405214
DONE TAKING  40  STEPS.
Total reward:  17.199658184269374
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -20.847002123200987
DONE TAKING  40  STEPS.
Total reward:  290.7155640545367
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.098102751870567
DONE TAKING  40  STEPS.
Total reward:  -16.286460458804303
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.920273400220097
DONE TAKING  40  STEPS.
Total reward:  150.86003391585396
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -9.945387064029314
DONE TAKING  40  STEPS.
Total reward:  532.158008150724
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.50365410121895
DONE TAKING  40  STEPS.
Total reward:  434.8893356845601
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.75731119485206
DONE TAKING  40  STEPS.
Total reward:  -314.5358595306666
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.394700588321466
DONE TAKING  40  STEPS.
Total reward:  178.38476219751618
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.277972577009578
DONE TAKING  40  STEPS.
Total reward:  210.58834219681714
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -11.787477460215424
DONE TAKING  40  STEPS.
Total reward:  171.64689505008172
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.098477483462318
DONE TAKING  40  STEPS.
Total reward:  237.02508339046057
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -27.247268022589974
DONE TAKING  40  STEPS.
Total reward:  403.8291269696184
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.646610651817813
DONE TAKING  40  STEPS.
Total reward:  70.14968047023645
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -12.932065263528505
DONE TAKING  40  STEPS.
Total reward:  185.79262428032368
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -12.08209323574418
DONE TAKING  40  STEPS.
Total reward:  371.68616955069155
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.81679264227092
DONE TAKING  40  STEPS.
Total reward:  300.7526870616049
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.670393842629956
DONE TAKING  40  STEPS.
Total reward:  -774.9056148173846
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.393733873531648
DONE TAKING  40  STEPS.
Total reward:  -660.8441734860367
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.1251104190235
DONE TAKING  40  STEPS.
Total reward:  -450.9911233352905
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -31.26378649636033
DONE TAKING  40  STEPS.
Total reward:  232.66834430454017
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.35389539512717
DONE TAKING  40  STEPS.
Total reward:  207.23858052420442
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.2336804934166
DONE TAKING  40  STEPS.
Total reward:  311.23971283695346
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -18.000845875716468
DONE TAKING  40  STEPS.
Total reward:  107.07087663165132
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.62995115368863
DONE TAKING  40  STEPS.
Total reward:  245.49330700371428
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.598739135610842
DONE TAKING  40  STEPS.
Total reward:  -218.00218571517345
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.13474548594268
DONE TAKING  40  STEPS.
Total reward:  -13.53182128357016
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -28.64768158969523
DONE TAKING  40  STEPS.
Total reward:  -701.6232133136455
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.380043268937946
DONE TAKING  40  STEPS.
Total reward:  376.24456102988063
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.824134575606948
DONE TAKING  40  STEPS.
Total reward:  -888.8408523930698
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.960592019671324
DONE TAKING  40  STEPS.
Total reward:  22.663082430236535
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.735793984487024
DONE TAKING  40  STEPS.
Total reward:  443.42574793580485
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.565783013264724
DONE TAKING  40  STEPS.
Total reward:  -16.335895810285106
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -28.9190347828773
DONE TAKING  40  STEPS.
Total reward:  235.21617051314763
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.190138437455694
DONE TAKING  40  STEPS.
Total reward:  289.4887887907141
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.199538597724109
DONE TAKING  40  STEPS.
Total reward:  -62.88370733637095
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.48446838728271
DONE TAKING  40  STEPS.
Total reward:  -294.69330484678864
Time for 1 rollout: 1.30 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.14360603913703
DONE TAKING  40  STEPS.
Total reward:  444.6326650063601
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.834768144004848
DONE TAKING  40  STEPS.
Total reward:  -190.43883174792947
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -17.387261612529382
DONE TAKING  40  STEPS.
Total reward:  480.4508112634088
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter128.ckpt

#####################################
Training the dynamics model..... iteration  129
#####################################

    amount of random data:  8000
    amount of onPol data:  190404
Prob rand:  32955
On pol:  185760
Prob shape:  (218715,)

=== Epoch 0 ===
    train loss:  0.36023874291212277
    val rand:  0.3713728189468384
    val onPol:  0.28946022093296053

=== Epoch 10 ===
    train loss:  0.21374259226076497
    val rand:  0.2180461585521698
    val onPol:  0.22207846269011497

=== Epoch 20 ===
    train loss:  0.18764572808697855
    val rand:  0.1847536861896515
    val onPol:  0.21716816052794458

=== Epoch 30 ===
    train loss:  0.17246031555275168
    val rand:  0.17499427497386932
    val onPol:  0.2184637699276209

=== Epoch 39 ===
    train loss:  0.1633831604233391
    val rand:  0.17309054732322693
    val onPol:  0.2219178445637226
Training duration: 108.13 s

#####################################
performing on-policy MPC rollouts... iter  129
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -20.92136891378289
DONE TAKING  40  STEPS.
Total reward:  391.789757852979
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -15.163676214863408
DONE TAKING  40  STEPS.
Total reward:  370.94928230667074
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.226817812622272
DONE TAKING  40  STEPS.
Total reward:  217.2189170680926
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.808722563521506
DONE TAKING  40  STEPS.
Total reward:  349.77059021637734
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.35904034836814
DONE TAKING  40  STEPS.
Total reward:  258.0610030927494
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.253568091141894
DONE TAKING  40  STEPS.
Total reward:  420.60079940638644
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.23819179699803
DONE TAKING  40  STEPS.
Total reward:  221.41147969833818
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.091796288516015
DONE TAKING  40  STEPS.
Total reward:  316.07274742687656
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -31.08790338602114
DONE TAKING  40  STEPS.
Total reward:  406.990917313078
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.327205550765626
DONE TAKING  40  STEPS.
Total reward:  -319.57714763953476
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.816065571519825
DONE TAKING  40  STEPS.
Total reward:  -349.1591516634254
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -14.181870405713642
DONE TAKING  40  STEPS.
Total reward:  390.06572038424287
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -14.267982522832767
DONE TAKING  40  STEPS.
Total reward:  520.4175544814514
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.391591849917674
DONE TAKING  40  STEPS.
Total reward:  216.58019141322495
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -29.99979667278229
DONE TAKING  40  STEPS.
Total reward:  216.28150888088447
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.083042267616335
DONE TAKING  40  STEPS.
Total reward:  275.8878085522426
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -16.43183317690906
DONE TAKING  40  STEPS.
Total reward:  232.53969716819913
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.737189406374846
DONE TAKING  40  STEPS.
Total reward:  -206.1415511402188
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -15.635776699020605
DONE TAKING  40  STEPS.
Total reward:  477.94526864546623
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.800052002890133
DONE TAKING  40  STEPS.
Total reward:  99.60337331533137
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.275356376540167
DONE TAKING  40  STEPS.
Total reward:  152.77913845751576
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.406910434646814
DONE TAKING  40  STEPS.
Total reward:  46.80143011237411
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.51700048268022
DONE TAKING  40  STEPS.
Total reward:  299.30970128506607
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.718129750842323
DONE TAKING  40  STEPS.
Total reward:  270.1513860117037
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.915509067407598
DONE TAKING  40  STEPS.
Total reward:  167.63798806325332
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.33497797953227
DONE TAKING  40  STEPS.
Total reward:  390.4868280560415
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.435083972828004
DONE TAKING  40  STEPS.
Total reward:  265.2609449055631
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.254123582295897
DONE TAKING  40  STEPS.
Total reward:  277.498814964104
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.372215809770523
DONE TAKING  40  STEPS.
Total reward:  161.97797652436705
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.29765984675959
DONE TAKING  40  STEPS.
Total reward:  -95.03290870978012
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.305608274773817
DONE TAKING  40  STEPS.
Total reward:  152.3374191855374
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.814705785063648
DONE TAKING  40  STEPS.
Total reward:  356.4860981209383
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.335846605514718
DONE TAKING  40  STEPS.
Total reward:  85.83878866627991
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.404489670381324
DONE TAKING  40  STEPS.
Total reward:  287.8471115856521
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.412886585017887
DONE TAKING  40  STEPS.
Total reward:  119.00510190123143
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.27045547998766
DONE TAKING  40  STEPS.
Total reward:  324.9235802603545
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.565010079389516
DONE TAKING  40  STEPS.
Total reward:  -88.77389619449782
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.206607787203374
DONE TAKING  40  STEPS.
Total reward:  479.8887528506884
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.077198901883964
DONE TAKING  40  STEPS.
Total reward:  148.1333948198043
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -25.674917615740107
DONE TAKING  40  STEPS.
Total reward:  12.145607369505058
Time for 1 rollout: 1.19 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter129.ckpt

#####################################
Training the dynamics model..... iteration  130
#####################################

    amount of random data:  8000
    amount of onPol data:  191880
Prob rand:  33150
On pol:  187200
Prob shape:  (220350,)

=== Epoch 0 ===
    train loss:  0.3578806184752043
    val rand:  0.378654420375824
    val onPol:  0.28972394578158855

=== Epoch 10 ===
    train loss:  0.21469194407379905
    val rand:  0.21825817227363586
    val onPol:  0.22276541106402875

=== Epoch 20 ===
    train loss:  0.188500361317812
    val rand:  0.19136670231819153
    val onPol:  0.2159182608127594

=== Epoch 30 ===
    train loss:  0.17345985524183097
    val rand:  0.17169538140296936
    val onPol:  0.2167746141552925

=== Epoch 39 ===
    train loss:  0.16483154276082682
    val rand:  0.17303721606731415
    val onPol:  0.22010768093168737
Training duration: 108.11 s

#####################################
performing on-policy MPC rollouts... iter  130
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -21.110830137731725
DONE TAKING  40  STEPS.
Total reward:  251.41193669520376
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.63028853888113
DONE TAKING  40  STEPS.
Total reward:  -16.752621722283433
Time for 1 rollout: 1.51 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.913635031639956
DONE TAKING  40  STEPS.
Total reward:  91.31849959088856
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.157786615922134
DONE TAKING  40  STEPS.
Total reward:  -117.03931090115518
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.312261217162245
DONE TAKING  40  STEPS.
Total reward:  304.1584226891944
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -10.993043394722086
DONE TAKING  40  STEPS.
Total reward:  523.5828397928435
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.032113459311688
DONE TAKING  40  STEPS.
Total reward:  472.1856871787615
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.47759119178782
DONE TAKING  40  STEPS.
Total reward:  38.73839115125483
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.728196800077505
DONE TAKING  40  STEPS.
Total reward:  281.56463571822866
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.375724158350085
DONE TAKING  40  STEPS.
Total reward:  81.46779596587581
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.532267487984363
DONE TAKING  40  STEPS.
Total reward:  -250.8846735019822
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -14.490884088796411
DONE TAKING  40  STEPS.
Total reward:  524.8332034854797
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.291746589638475
DONE TAKING  40  STEPS.
Total reward:  398.4310712076839
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.20123605511739
DONE TAKING  40  STEPS.
Total reward:  -123.75028108556089
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.2428944972953
DONE TAKING  40  STEPS.
Total reward:  507.6925241826603
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.219006287187355
DONE TAKING  40  STEPS.
Total reward:  -374.3515596812019
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -20.129785610196087
DONE TAKING  40  STEPS.
Total reward:  459.6603424119929
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.556976171983123
DONE TAKING  40  STEPS.
Total reward:  185.1537543255709
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.81422868202795
DONE TAKING  40  STEPS.
Total reward:  18.404439250339273
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -12.889564486077171
DONE TAKING  40  STEPS.
Total reward:  520.2354925283573
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.438758403055935
DONE TAKING  40  STEPS.
Total reward:  307.91520840081785
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.144227901911343
DONE TAKING  40  STEPS.
Total reward:  364.1062299797321
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.74532731482845
DONE TAKING  40  STEPS.
Total reward:  404.56095351798695
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.36752713852175
DONE TAKING  40  STEPS.
Total reward:  433.8860013734387
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.127668679630954
DONE TAKING  40  STEPS.
Total reward:  315.0407223021031
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.421566727214383
DONE TAKING  40  STEPS.
Total reward:  18.27035466805093
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -14.616995888569868
DONE TAKING  40  STEPS.
Total reward:  479.63895941530376
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -15.663652117857726
DONE TAKING  40  STEPS.
Total reward:  449.00231302510304
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -21.74355575779636
DONE TAKING  40  STEPS.
Total reward:  476.27463776305444
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -17.974338026437504
DONE TAKING  40  STEPS.
Total reward:  489.13853848495825
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.110828660780758
DONE TAKING  40  STEPS.
Total reward:  6.297750055866317
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.674862664540505
DONE TAKING  40  STEPS.
Total reward:  199.64087838903066
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.594031753384947
DONE TAKING  40  STEPS.
Total reward:  -720.641221110064
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.599429395966688
DONE TAKING  40  STEPS.
Total reward:  204.99414051450339
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -15.103933685423614
DONE TAKING  40  STEPS.
Total reward:  522.4791411980933
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.80629149527111
DONE TAKING  40  STEPS.
Total reward:  341.5851198848992
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.448749556552606
DONE TAKING  40  STEPS.
Total reward:  272.19655552672134
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.58659819250622
DONE TAKING  40  STEPS.
Total reward:  248.4041428469064
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.406449077006936
DONE TAKING  40  STEPS.
Total reward:  413.0006002191662
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.950053115870027
DONE TAKING  40  STEPS.
Total reward:  -63.200712305183885
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter130.ckpt

#####################################
Training the dynamics model..... iteration  131
#####################################

    amount of random data:  8000
    amount of onPol data:  193356
Prob rand:  33345
On pol:  188640
Prob shape:  (221985,)

=== Epoch 0 ===
    train loss:  0.3579728917904869
    val rand:  0.3818814754486084
    val onPol:  0.2887243930250406

=== Epoch 10 ===
    train loss:  0.21319366093320605
    val rand:  0.22088700532913208
    val onPol:  0.2216422151774168

=== Epoch 20 ===
    train loss:  0.1877507683380096
    val rand:  0.18402427434921265
    val onPol:  0.21668749451637268

=== Epoch 30 ===
    train loss:  0.17231133057118564
    val rand:  0.17230746150016785
    val onPol:  0.21877936013042926

=== Epoch 39 ===
    train loss:  0.16377525509917984
    val rand:  0.17578980326652527
    val onPol:  0.221614471077919
Training duration: 109.80 s

#####################################
performing on-policy MPC rollouts... iter  131
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.150340514591598
DONE TAKING  40  STEPS.
Total reward:  -63.54846024044519
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.390191347697233
DONE TAKING  40  STEPS.
Total reward:  -499.02935096510583
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -11.135875974971722
DONE TAKING  40  STEPS.
Total reward:  462.41322686776937
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.45213299379238
DONE TAKING  40  STEPS.
Total reward:  360.07832767386355
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.848801537739057
DONE TAKING  40  STEPS.
Total reward:  272.1430201787581
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -10.909652821710193
DONE TAKING  40  STEPS.
Total reward:  388.3825155072669
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.686463835699612
DONE TAKING  40  STEPS.
Total reward:  226.96274858272832
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.025150669509358
DONE TAKING  40  STEPS.
Total reward:  129.29118160364723
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -16.87739424318919
DONE TAKING  40  STEPS.
Total reward:  417.38486219599434
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.268472907825338
DONE TAKING  40  STEPS.
Total reward:  282.74750798998923
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -29.644025343173993
DONE TAKING  40  STEPS.
Total reward:  110.58960644803736
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -13.72154975072492
DONE TAKING  40  STEPS.
Total reward:  510.75770770976385
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.37793634672608
DONE TAKING  40  STEPS.
Total reward:  160.54638449015516
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.601847030906267
DONE TAKING  40  STEPS.
Total reward:  413.83750650285396
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.23564727478988
DONE TAKING  40  STEPS.
Total reward:  201.19616952661949
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -31.223701711740034
DONE TAKING  40  STEPS.
Total reward:  -0.2299814003690379
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.294327500174038
DONE TAKING  40  STEPS.
Total reward:  479.78941666907605
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.902332158417252
DONE TAKING  40  STEPS.
Total reward:  122.93511926001602
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -15.645355963234023
DONE TAKING  40  STEPS.
Total reward:  244.30134105248308
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.617229813907088
DONE TAKING  40  STEPS.
Total reward:  475.2960216036452
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.996063593864406
DONE TAKING  40  STEPS.
Total reward:  346.19551341604205
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -25.38289471304539
DONE TAKING  40  STEPS.
Total reward:  333.19947460648814
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.889157026289226
DONE TAKING  40  STEPS.
Total reward:  299.96689909621057
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.68285019180317
DONE TAKING  40  STEPS.
Total reward:  312.24961453340063
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.163108209554526
DONE TAKING  40  STEPS.
Total reward:  306.27470449385
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.78076062683793
DONE TAKING  40  STEPS.
Total reward:  -158.912931678193
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.457297767205972
DONE TAKING  40  STEPS.
Total reward:  471.75323824714224
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.349369393726086
DONE TAKING  40  STEPS.
Total reward:  -344.6403359780934
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.757219107831055
DONE TAKING  40  STEPS.
Total reward:  -144.90014277880135
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -14.31925042462069
DONE TAKING  40  STEPS.
Total reward:  174.39599133701836
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.361236737513295
DONE TAKING  40  STEPS.
Total reward:  139.4922990207539
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.2329026909259
DONE TAKING  40  STEPS.
Total reward:  382.2323392081609
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.385146627568226
DONE TAKING  40  STEPS.
Total reward:  164.1636928722765
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.8151124661325
DONE TAKING  40  STEPS.
Total reward:  237.34656512045476
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.975957064836535
DONE TAKING  40  STEPS.
Total reward:  221.4070003721694
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.890793897898376
DONE TAKING  40  STEPS.
Total reward:  -23.096482435749436
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.86044812550662
DONE TAKING  40  STEPS.
Total reward:  156.19582442836418
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.18339509568183
DONE TAKING  40  STEPS.
Total reward:  206.32618496825714
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.15698890765923
DONE TAKING  40  STEPS.
Total reward:  5.043300090489712
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -16.714748908782422
DONE TAKING  40  STEPS.
Total reward:  -254.72532871662156
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter131.ckpt

#####################################
Training the dynamics model..... iteration  132
#####################################

    amount of random data:  8000
    amount of onPol data:  194832
Prob rand:  33540
On pol:  190080
Prob shape:  (223620,)

=== Epoch 0 ===
    train loss:  0.35887528484294173
    val rand:  0.38661035895347595
    val onPol:  0.29022416254369227

=== Epoch 10 ===
    train loss:  0.21341215159504787
    val rand:  0.22533759474754333
    val onPol:  0.22353707362965838

=== Epoch 20 ===
    train loss:  0.18710907159048482
    val rand:  0.1820445954799652
    val onPol:  0.21683608649707423

=== Epoch 30 ===
    train loss:  0.17261233638732806
    val rand:  0.17368879914283752
    val onPol:  0.21881660964430832

=== Epoch 39 ===
    train loss:  0.1639150147659516
    val rand:  0.16712632775306702
    val onPol:  0.2212015383127259
Training duration: 109.57 s

#####################################
performing on-policy MPC rollouts... iter  132
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.202362587621035
DONE TAKING  40  STEPS.
Total reward:  105.90150761978434
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -9.186485622929222
DONE TAKING  40  STEPS.
Total reward:  333.16365426418673
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.45972013602414
DONE TAKING  40  STEPS.
Total reward:  97.13607383668347
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -11.104979552001502
DONE TAKING  40  STEPS.
Total reward:  233.98349541596406
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -12.70892898555892
DONE TAKING  40  STEPS.
Total reward:  372.613777941512
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -14.283398823609527
DONE TAKING  40  STEPS.
Total reward:  310.22176219039477
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.84978124046383
DONE TAKING  40  STEPS.
Total reward:  182.9040492911226
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.51832482118259
DONE TAKING  40  STEPS.
Total reward:  246.0080800710175
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.716003684661683
DONE TAKING  40  STEPS.
Total reward:  258.34706222582696
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.47702554162331
DONE TAKING  40  STEPS.
Total reward:  -266.5620114480834
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.88118048578156
DONE TAKING  40  STEPS.
Total reward:  169.20238917062557
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -10.969989020297426
DONE TAKING  40  STEPS.
Total reward:  442.5732806159438
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.07332228867369
DONE TAKING  40  STEPS.
Total reward:  -152.74363978575636
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -31.350357131467803
DONE TAKING  40  STEPS.
Total reward:  -49.08990263348083
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.331647250240506
DONE TAKING  40  STEPS.
Total reward:  382.233371537535
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -15.581906830016319
DONE TAKING  40  STEPS.
Total reward:  553.3298290164753
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.323998664135331
DONE TAKING  40  STEPS.
Total reward:  431.1413593271395
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -27.188848095334038
DONE TAKING  40  STEPS.
Total reward:  393.6700387708468
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.547443495229988
DONE TAKING  40  STEPS.
Total reward:  197.0591285123418
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.147699131296104
DONE TAKING  40  STEPS.
Total reward:  120.36586449033965
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.265409770840062
DONE TAKING  40  STEPS.
Total reward:  423.2857613360244
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -12.320269733802975
DONE TAKING  40  STEPS.
Total reward:  491.7506236890985
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.262856105642257
DONE TAKING  40  STEPS.
Total reward:  297.4187742250297
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.106907331809595
DONE TAKING  40  STEPS.
Total reward:  223.50896555542033
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.8964783442312
DONE TAKING  40  STEPS.
Total reward:  357.5476773737386
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.0683062737632
DONE TAKING  40  STEPS.
Total reward:  -323.0313355054043
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.077501010364696
DONE TAKING  40  STEPS.
Total reward:  77.82469148467396
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.470195227073066
DONE TAKING  40  STEPS.
Total reward:  333.30046882671746
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.22064996452628
DONE TAKING  40  STEPS.
Total reward:  225.6512414298771
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -31.271687980014846
DONE TAKING  40  STEPS.
Total reward:  343.7505648286375
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.043629154464774
DONE TAKING  40  STEPS.
Total reward:  -531.0155706617579
Time for 1 rollout: 1.31 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -31.254027988226312
DONE TAKING  40  STEPS.
Total reward:  -303.7085077007576
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.48152164472566
DONE TAKING  40  STEPS.
Total reward:  366.98745508434195
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.120032589139747
DONE TAKING  40  STEPS.
Total reward:  123.94959454961138
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.423472884220992
DONE TAKING  40  STEPS.
Total reward:  321.6054445805969
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.885994050656514
DONE TAKING  40  STEPS.
Total reward:  27.382926860243984
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -16.791349618785965
DONE TAKING  40  STEPS.
Total reward:  352.53059589562645
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.44782790094532
DONE TAKING  40  STEPS.
Total reward:  -69.64692109498617
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.00477315755586
DONE TAKING  40  STEPS.
Total reward:  -151.24171895947433
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.87255038101233
DONE TAKING  40  STEPS.
Total reward:  418.8756707496324
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter132.ckpt

#####################################
Training the dynamics model..... iteration  133
#####################################

    amount of random data:  8000
    amount of onPol data:  196308
Prob rand:  33735
On pol:  191520
Prob shape:  (225255,)

=== Epoch 0 ===
    train loss:  0.35705777880542644
    val rand:  0.372653067111969
    val onPol:  0.29071767119372766

=== Epoch 10 ===
    train loss:  0.21350119576910362
    val rand:  0.2139689028263092
    val onPol:  0.22315311431884766

=== Epoch 20 ===
    train loss:  0.18724691334916682
    val rand:  0.1820693016052246
    val onPol:  0.21821805325950064

=== Epoch 30 ===
    train loss:  0.17236015842145558
    val rand:  0.1745307743549347
    val onPol:  0.21992348316239146

=== Epoch 39 ===
    train loss:  0.16338786000814415
    val rand:  0.178314670920372
    val onPol:  0.22363576474713115
Training duration: 114.23 s

#####################################
performing on-policy MPC rollouts... iter  133
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.94822046163099
DONE TAKING  40  STEPS.
Total reward:  123.07621710668184
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.583609279086858
DONE TAKING  40  STEPS.
Total reward:  283.4117762465876
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.85445085795556
DONE TAKING  40  STEPS.
Total reward:  -345.129004279
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.179888279452864
DONE TAKING  40  STEPS.
Total reward:  309.89651153374973
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.174992042603986
DONE TAKING  40  STEPS.
Total reward:  -293.263788196234
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.462491730894094
DONE TAKING  40  STEPS.
Total reward:  -141.80355575495497
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.343522531120218
DONE TAKING  40  STEPS.
Total reward:  337.006259888019
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -24.3446037488335
DONE TAKING  40  STEPS.
Total reward:  392.94557224101266
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.851583589839205
DONE TAKING  40  STEPS.
Total reward:  -49.81947025033797
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.169479311464677
DONE TAKING  40  STEPS.
Total reward:  -360.31990667823203
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -15.680002013680284
DONE TAKING  40  STEPS.
Total reward:  486.37139637734793
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.32007371289886
DONE TAKING  40  STEPS.
Total reward:  438.10527215358894
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -18.821864374320988
DONE TAKING  40  STEPS.
Total reward:  288.7740976755626
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.217929467969967
DONE TAKING  40  STEPS.
Total reward:  320.764887524669
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -20.913825955034568
DONE TAKING  40  STEPS.
Total reward:  428.4843777617371
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.09472838140377
DONE TAKING  40  STEPS.
Total reward:  -309.9136910160011
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.791516560201206
DONE TAKING  40  STEPS.
Total reward:  411.16567148588445
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -16.575719867083663
DONE TAKING  40  STEPS.
Total reward:  -291.14460314859326
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.706047132199245
DONE TAKING  40  STEPS.
Total reward:  391.77503887600164
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -14.989209104264651
DONE TAKING  40  STEPS.
Total reward:  486.1583435637509
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.546655906950754
DONE TAKING  40  STEPS.
Total reward:  302.35294536101287
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.77077474499866
DONE TAKING  40  STEPS.
Total reward:  192.02186087402964
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.442429938017195
DONE TAKING  40  STEPS.
Total reward:  147.23791351349266
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -26.639630403927818
DONE TAKING  40  STEPS.
Total reward:  333.6693847057453
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -31.09014025912227
DONE TAKING  40  STEPS.
Total reward:  131.1286529837536
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.858983975641266
DONE TAKING  40  STEPS.
Total reward:  372.6593992520691
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.453644018088376
DONE TAKING  40  STEPS.
Total reward:  272.4945082360937
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.634858231986712
DONE TAKING  40  STEPS.
Total reward:  381.6764615032473
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.96487152354605
DONE TAKING  40  STEPS.
Total reward:  481.73310945122194
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -8.81280614299124
DONE TAKING  40  STEPS.
Total reward:  531.2448887610503
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.900840766949724
DONE TAKING  40  STEPS.
Total reward:  -34.92776486406528
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.976983851423842
DONE TAKING  40  STEPS.
Total reward:  34.22638465602921
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.62491686668667
DONE TAKING  40  STEPS.
Total reward:  193.10817553172063
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.133701470305546
DONE TAKING  40  STEPS.
Total reward:  -173.741515522852
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -12.759106966484776
DONE TAKING  40  STEPS.
Total reward:  360.24646238327114
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.64065218052948
DONE TAKING  40  STEPS.
Total reward:  55.245035338500365
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.85197414009036
DONE TAKING  40  STEPS.
Total reward:  329.9477540628029
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -20.344318848772545
DONE TAKING  40  STEPS.
Total reward:  317.22005109528226
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.152565134914003
DONE TAKING  40  STEPS.
Total reward:  405.16075108011563
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -31.070011079433172
DONE TAKING  40  STEPS.
Total reward:  167.7932314896451
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter133.ckpt

#####################################
Training the dynamics model..... iteration  134
#####################################

    amount of random data:  8000
    amount of onPol data:  197784
Prob rand:  33930
On pol:  192960
Prob shape:  (226890,)

=== Epoch 0 ===
    train loss:  0.3559606262308211
    val rand:  0.3918718695640564
    val onPol:  0.2889575950983094

=== Epoch 10 ===
    train loss:  0.21185120782114852
    val rand:  0.21523571014404297
    val onPol:  0.22291091811366198

=== Epoch 20 ===
    train loss:  0.1855931418609404
    val rand:  0.18336594104766846
    val onPol:  0.217750897858201

=== Epoch 30 ===
    train loss:  0.17100870246004574
    val rand:  0.17213833332061768
    val onPol:  0.22028859940970816

=== Epoch 39 ===
    train loss:  0.16250894896467438
    val rand:  0.17096464335918427
    val onPol:  0.22342449862782549
Training duration: 111.98 s

#####################################
performing on-policy MPC rollouts... iter  134
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.015768361447684
DONE TAKING  40  STEPS.
Total reward:  372.0527218303
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.92298288783862
DONE TAKING  40  STEPS.
Total reward:  403.0440450915539
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.00419233954474
DONE TAKING  40  STEPS.
Total reward:  106.1166569149248
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.338262709482564
DONE TAKING  40  STEPS.
Total reward:  295.00407992589635
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.769534898689166
DONE TAKING  40  STEPS.
Total reward:  254.58639969830966
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.096219544472614
DONE TAKING  40  STEPS.
Total reward:  282.62356248763734
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.233460491331773
DONE TAKING  40  STEPS.
Total reward:  229.73136061079006
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.14112993905863
DONE TAKING  40  STEPS.
Total reward:  50.887090033781675
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.35811975568872
DONE TAKING  40  STEPS.
Total reward:  495.78084400742506
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.812080361057564
DONE TAKING  40  STEPS.
Total reward:  -131.12228287166835
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.07934639603523
DONE TAKING  40  STEPS.
Total reward:  490.6271414766441
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.919693762188164
DONE TAKING  40  STEPS.
Total reward:  -334.6319344852855
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.55022235718924
DONE TAKING  40  STEPS.
Total reward:  316.53966385822685
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.438819229869896
DONE TAKING  40  STEPS.
Total reward:  376.8703627437203
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.159904397767463
DONE TAKING  40  STEPS.
Total reward:  86.09404082017849
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.60894273262369
DONE TAKING  40  STEPS.
Total reward:  99.78247542765055
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.182919217216448
DONE TAKING  40  STEPS.
Total reward:  278.29832361080094
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.76587952819638
DONE TAKING  40  STEPS.
Total reward:  -70.2740545411308
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.619786375284196
DONE TAKING  40  STEPS.
Total reward:  60.111545122105575
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.13817269460081
DONE TAKING  40  STEPS.
Total reward:  301.8396256855717
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -22.442111041994906
DONE TAKING  40  STEPS.
Total reward:  128.10427122379403
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -11.343537847384768
DONE TAKING  40  STEPS.
Total reward:  506.54143676630605
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.738532233034793
DONE TAKING  40  STEPS.
Total reward:  183.431183491384
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.136251145528167
DONE TAKING  40  STEPS.
Total reward:  44.09936863955322
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.992369127031004
DONE TAKING  40  STEPS.
Total reward:  313.9898791764628
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.487161784509674
DONE TAKING  40  STEPS.
Total reward:  491.13245681927873
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.62869635905157
DONE TAKING  40  STEPS.
Total reward:  166.46622522523984
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.307793644913513
DONE TAKING  40  STEPS.
Total reward:  80.75276246125618
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -13.375791995655877
DONE TAKING  40  STEPS.
Total reward:  -208.68244806693244
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.059230487187442
DONE TAKING  40  STEPS.
Total reward:  253.27149364920513
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.970082997915405
DONE TAKING  40  STEPS.
Total reward:  -518.2383170833133
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.46188132388928
DONE TAKING  40  STEPS.
Total reward:  141.48716921210269
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.146136850174283
DONE TAKING  40  STEPS.
Total reward:  24.566918509015643
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.628764962321245
DONE TAKING  40  STEPS.
Total reward:  128.09359633399848
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.338765242817423
DONE TAKING  40  STEPS.
Total reward:  -310.02134012672377
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.278668267881883
DONE TAKING  40  STEPS.
Total reward:  -145.10590546105766
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.476189449920557
DONE TAKING  40  STEPS.
Total reward:  330.9581175598884
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.017537740654312
DONE TAKING  40  STEPS.
Total reward:  267.9594465292581
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.450062804057445
DONE TAKING  40  STEPS.
Total reward:  -256.2441798829807
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.007362125140048
DONE TAKING  40  STEPS.
Total reward:  -94.44864206388121
Time for 1 rollout: 1.12 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter134.ckpt

#####################################
Training the dynamics model..... iteration  135
#####################################

    amount of random data:  8000
    amount of onPol data:  199260
Prob rand:  34125
On pol:  194400
Prob shape:  (228525,)

=== Epoch 0 ===
    train loss:  0.35571945274891875
    val rand:  0.3801310956478119
    val onPol:  0.2884521636934507

=== Epoch 10 ===
    train loss:  0.2123067520993173
    val rand:  0.2187969982624054
    val onPol:  0.22270762565590085

=== Epoch 20 ===
    train loss:  0.18607089588326722
    val rand:  0.19074194133281708
    val onPol:  0.21726902148553304

=== Epoch 30 ===
    train loss:  0.17161709905472572
    val rand:  0.1767893135547638
    val onPol:  0.21949807838315055

=== Epoch 39 ===
    train loss:  0.16209077768261657
    val rand:  0.17385177314281464
    val onPol:  0.2227948627301625
Training duration: 113.60 s

#####################################
performing on-policy MPC rollouts... iter  135
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.461596510877
DONE TAKING  40  STEPS.
Total reward:  389.7293245215424
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -31.252887446871327
DONE TAKING  40  STEPS.
Total reward:  140.5492254097183
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -31.374899869495266
DONE TAKING  40  STEPS.
Total reward:  303.6050739041563
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -14.598105952132341
DONE TAKING  40  STEPS.
Total reward:  200.67734017260324
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.585530960172836
DONE TAKING  40  STEPS.
Total reward:  316.9847847105471
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.370907363566523
DONE TAKING  40  STEPS.
Total reward:  279.4621227854119
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.691731439650198
DONE TAKING  40  STEPS.
Total reward:  157.33840766069926
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.658033247059038
DONE TAKING  40  STEPS.
Total reward:  287.47747855747673
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.993097976399657
DONE TAKING  40  STEPS.
Total reward:  257.5448418935623
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.640737112073573
DONE TAKING  40  STEPS.
Total reward:  186.56600825918292
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -17.521778048265013
DONE TAKING  40  STEPS.
Total reward:  313.5901917212068
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.413260857098294
DONE TAKING  40  STEPS.
Total reward:  284.6480895978938
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.204755991198606
DONE TAKING  40  STEPS.
Total reward:  386.27131606833404
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -31.352449316993155
DONE TAKING  40  STEPS.
Total reward:  290.6227664573206
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -31.232328833732133
DONE TAKING  40  STEPS.
Total reward:  -313.9986266958496
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.37985873709714
DONE TAKING  40  STEPS.
Total reward:  567.4511891618255
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.48568901963538
DONE TAKING  40  STEPS.
Total reward:  286.4786109769528
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.045623827542478
DONE TAKING  40  STEPS.
Total reward:  487.4842261690461
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -25.023407378797362
DONE TAKING  40  STEPS.
Total reward:  155.51985502736562
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.403912735865745
DONE TAKING  40  STEPS.
Total reward:  -232.98204749854742
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -18.105326183643005
DONE TAKING  40  STEPS.
Total reward:  200.25239382680584
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.829163859837585
DONE TAKING  40  STEPS.
Total reward:  298.4806453197545
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.656803621994
DONE TAKING  40  STEPS.
Total reward:  -4.0435124071139725
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.91139476901379
DONE TAKING  40  STEPS.
Total reward:  276.3088591151063
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.63942725414489
DONE TAKING  40  STEPS.
Total reward:  -80.19767105346932
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -12.141028032240468
DONE TAKING  40  STEPS.
Total reward:  490.61417061964994
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.4551538853698
DONE TAKING  40  STEPS.
Total reward:  346.02752648706246
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.674570348932463
DONE TAKING  40  STEPS.
Total reward:  308.77588864140705
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -15.496301256985436
DONE TAKING  40  STEPS.
Total reward:  382.1827107024476
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.875549066680463
DONE TAKING  40  STEPS.
Total reward:  -74.33041253809013
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.017472221643473
DONE TAKING  40  STEPS.
Total reward:  172.01012841810402
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.03486574690099
DONE TAKING  40  STEPS.
Total reward:  192.26343712321852
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.822329524983068
DONE TAKING  40  STEPS.
Total reward:  362.12015102286324
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.676445738936376
DONE TAKING  40  STEPS.
Total reward:  -5.871775487663818
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.1659142075465
DONE TAKING  40  STEPS.
Total reward:  371.67795774999166
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.441023610008603
DONE TAKING  40  STEPS.
Total reward:  349.54928816830756
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.443929168990497
DONE TAKING  40  STEPS.
Total reward:  26.59882645799602
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.184940780941734
DONE TAKING  40  STEPS.
Total reward:  -214.63543495532144
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -14.66606840590291
DONE TAKING  40  STEPS.
Total reward:  295.9372418053553
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -11.830621233113474
DONE TAKING  40  STEPS.
Total reward:  616.5195199129198
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter135.ckpt

#####################################
Training the dynamics model..... iteration  136
#####################################

    amount of random data:  8000
    amount of onPol data:  200736
Prob rand:  34320
On pol:  195840
Prob shape:  (230160,)

=== Epoch 0 ===
    train loss:  0.3568141364175121
    val rand:  0.38285624980926514
    val onPol:  0.2885283338172095

=== Epoch 10 ===
    train loss:  0.21237012714081194
    val rand:  0.2215336561203003
    val onPol:  0.22360542700404212

=== Epoch 20 ===
    train loss:  0.18632083537185642
    val rand:  0.18567237257957458
    val onPol:  0.2183065088022323

=== Epoch 30 ===
    train loss:  0.1715467755406896
    val rand:  0.17650052905082703
    val onPol:  0.2196143560466312

=== Epoch 39 ===
    train loss:  0.16286184464504566
    val rand:  0.1709718406200409
    val onPol:  0.22437983680339085
Training duration: 114.50 s

#####################################
performing on-policy MPC rollouts... iter  136
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.320165019581413
DONE TAKING  40  STEPS.
Total reward:  143.09071729696308
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.517866356483253
DONE TAKING  40  STEPS.
Total reward:  154.82583107263096
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.684569379549544
DONE TAKING  40  STEPS.
Total reward:  257.97107344745484
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.217322761939055
DONE TAKING  40  STEPS.
Total reward:  283.42523799181964
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.586331082344735
DONE TAKING  40  STEPS.
Total reward:  -69.92441461509912
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.33282308061783
DONE TAKING  40  STEPS.
Total reward:  111.05410188957009
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -14.452723826870733
DONE TAKING  40  STEPS.
Total reward:  472.8650837552797
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -20.663135841082692
DONE TAKING  40  STEPS.
Total reward:  321.30691453644164
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -30.632712884669143
DONE TAKING  40  STEPS.
Total reward:  96.44184279994806
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -17.566330694167405
DONE TAKING  40  STEPS.
Total reward:  415.33884210471905
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.781341829687504
DONE TAKING  40  STEPS.
Total reward:  141.98524808421615
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.59556257432919
DONE TAKING  40  STEPS.
Total reward:  -730.988086510746
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.5701979771074
DONE TAKING  40  STEPS.
Total reward:  326.9628520802559
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.30842516974181
DONE TAKING  40  STEPS.
Total reward:  174.33245661141504
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -26.059476336331432
DONE TAKING  40  STEPS.
Total reward:  36.82613131208083
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -27.633022510809386
DONE TAKING  40  STEPS.
Total reward:  -64.51782794640579
Time for 1 rollout: 1.35 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.809714072633703
DONE TAKING  40  STEPS.
Total reward:  309.9330769852486
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.73072260566679
DONE TAKING  40  STEPS.
Total reward:  332.31543865931417
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -13.36203715796859
DONE TAKING  40  STEPS.
Total reward:  418.83599442015634
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.753688038683556
DONE TAKING  40  STEPS.
Total reward:  48.08451579156009
Time for 1 rollout: 1.33 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.782408860267534
DONE TAKING  40  STEPS.
Total reward:  116.5688495647531
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.014122792401245
DONE TAKING  40  STEPS.
Total reward:  -249.20939620905074
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.083718337489728
DONE TAKING  40  STEPS.
Total reward:  -199.11877653095087
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.59860290083135
DONE TAKING  40  STEPS.
Total reward:  72.97936866104897
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.231002211141508
DONE TAKING  40  STEPS.
Total reward:  90.67690348083104
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.133501351428908
DONE TAKING  40  STEPS.
Total reward:  175.55506628186095
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.413369158838893
DONE TAKING  40  STEPS.
Total reward:  42.6682211231966
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.10769720276628
DONE TAKING  40  STEPS.
Total reward:  299.8375927284288
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.32130527663675
DONE TAKING  40  STEPS.
Total reward:  225.45616943261408
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.632399574076405
DONE TAKING  40  STEPS.
Total reward:  432.2100890752207
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.69410348535378
DONE TAKING  40  STEPS.
Total reward:  -554.8923822197161
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -11.260344124974198
DONE TAKING  40  STEPS.
Total reward:  570.2876147331875
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.606490662936498
DONE TAKING  40  STEPS.
Total reward:  145.2162602521306
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.054272082427456
DONE TAKING  40  STEPS.
Total reward:  113.74139624438429
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.503086183755233
DONE TAKING  40  STEPS.
Total reward:  410.9657857689328
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.731483399502196
DONE TAKING  40  STEPS.
Total reward:  228.2531188524564
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.88141521235645
DONE TAKING  40  STEPS.
Total reward:  -724.8956705212352
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.563659414301547
DONE TAKING  40  STEPS.
Total reward:  -506.23980136531105
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.014591574459466
DONE TAKING  40  STEPS.
Total reward:  60.01505979362312
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -14.087233598887385
DONE TAKING  40  STEPS.
Total reward:  375.21275048626876
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter136.ckpt

#####################################
Training the dynamics model..... iteration  137
#####################################

    amount of random data:  8000
    amount of onPol data:  202212
Prob rand:  34515
On pol:  197280
Prob shape:  (231795,)

=== Epoch 0 ===
    train loss:  0.35926838344441053
    val rand:  0.38162073493003845
    val onPol:  0.2932320421650296

=== Epoch 10 ===
    train loss:  0.21361306342667183
    val rand:  0.2238965630531311
    val onPol:  0.22252703919297173

=== Epoch 20 ===
    train loss:  0.18811410335840378
    val rand:  0.19319270551204681
    val onPol:  0.21628676603237787

=== Epoch 30 ===
    train loss:  0.1747548894676487
    val rand:  0.18129192292690277
    val onPol:  0.21746103288162322

=== Epoch 39 ===
    train loss:  0.16625734685664684
    val rand:  0.17613300681114197
    val onPol:  0.2207454059805189
Training duration: 126.14 s

#####################################
performing on-policy MPC rollouts... iter  137
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -30.030910907045367
DONE TAKING  40  STEPS.
Total reward:  171.51389960498688
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.181220169448707
DONE TAKING  40  STEPS.
Total reward:  150.2431535185959
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.131355160953127
DONE TAKING  40  STEPS.
Total reward:  38.31579325123967
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -31.01305113070857
DONE TAKING  40  STEPS.
Total reward:  356.2909845122154
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -13.169640616865772
DONE TAKING  40  STEPS.
Total reward:  429.25549922876024
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.113652079481934
DONE TAKING  40  STEPS.
Total reward:  -20.582589219140115
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.715428543025066
DONE TAKING  40  STEPS.
Total reward:  204.89840161623863
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.702811869073898
DONE TAKING  40  STEPS.
Total reward:  227.72420981264872
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.95014627092894
DONE TAKING  40  STEPS.
Total reward:  366.39956797030095
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.012928895053133
DONE TAKING  40  STEPS.
Total reward:  240.00317103975576
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -19.778205787452535
DONE TAKING  40  STEPS.
Total reward:  195.20866034309398
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.075263644575138
DONE TAKING  40  STEPS.
Total reward:  241.5090066135531
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.2120752751267
DONE TAKING  40  STEPS.
Total reward:  379.30504777859096
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.845938624554037
DONE TAKING  40  STEPS.
Total reward:  150.4419538952953
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.085234252555004
DONE TAKING  40  STEPS.
Total reward:  -77.65635804459673
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.816103381712605
DONE TAKING  40  STEPS.
Total reward:  214.01846432913112
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.150896275367714
DONE TAKING  40  STEPS.
Total reward:  181.76155288173032
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.18826490936032
DONE TAKING  40  STEPS.
Total reward:  -216.99684087737603
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.21695919043463
DONE TAKING  40  STEPS.
Total reward:  36.991264744764216
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.507964665480912
DONE TAKING  40  STEPS.
Total reward:  402.31480472306566
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.766266153040483
DONE TAKING  40  STEPS.
Total reward:  -195.12556603938793
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.16574892697036
DONE TAKING  40  STEPS.
Total reward:  17.692607042909497
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.48011735729277
DONE TAKING  40  STEPS.
Total reward:  -114.75215367876808
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.078339089958682
DONE TAKING  40  STEPS.
Total reward:  104.58365061602291
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -11.043628781353764
DONE TAKING  40  STEPS.
Total reward:  583.8405572211325
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.779025778274097
DONE TAKING  40  STEPS.
Total reward:  336.46088855892117
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -12.157877235063793
DONE TAKING  40  STEPS.
Total reward:  566.5439031871282
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -10.891334718951683
DONE TAKING  40  STEPS.
Total reward:  386.96883081638566
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.145996255196785
DONE TAKING  40  STEPS.
Total reward:  53.27103514535621
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.78573073883024
DONE TAKING  40  STEPS.
Total reward:  -382.9758711917019
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -31.08273374943698
DONE TAKING  40  STEPS.
Total reward:  -120.40668979224233
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -11.43864626757535
DONE TAKING  40  STEPS.
Total reward:  59.99575780174741
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.08139300807983
DONE TAKING  40  STEPS.
Total reward:  447.71199287400697
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -12.187838948289171
DONE TAKING  40  STEPS.
Total reward:  481.5561800749652
Time for 1 rollout: 1.32 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.502682023488997
DONE TAKING  40  STEPS.
Total reward:  367.8885330076051
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.74352640447711
DONE TAKING  40  STEPS.
Total reward:  -67.71457946456006
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.562802342854827
DONE TAKING  40  STEPS.
Total reward:  250.81691853492174
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -31.304820244182885
DONE TAKING  40  STEPS.
Total reward:  152.02863997597572
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.268601728828102
DONE TAKING  40  STEPS.
Total reward:  156.41011093802655
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.082996566711586
DONE TAKING  40  STEPS.
Total reward:  169.70719760397327
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter137.ckpt

#####################################
Training the dynamics model..... iteration  138
#####################################

    amount of random data:  8000
    amount of onPol data:  203688
Prob rand:  34710
On pol:  198720
Prob shape:  (233430,)

=== Epoch 0 ===
    train loss:  0.35379410759433283
    val rand:  0.3765694499015808
    val onPol:  0.286964644872865

=== Epoch 10 ===
    train loss:  0.21102992997064696
    val rand:  0.21890410780906677
    val onPol:  0.22105029814465102

=== Epoch 20 ===
    train loss:  0.1857176383445551
    val rand:  0.1865687221288681
    val onPol:  0.2155281035012977

=== Epoch 30 ===
    train loss:  0.17152310668767154
    val rand:  0.17290721833705902
    val onPol:  0.21769845658956571

=== Epoch 39 ===
    train loss:  0.1625589219750939
    val rand:  0.16966205835342407
    val onPol:  0.22147894529409187
Training duration: 121.24 s

#####################################
performing on-policy MPC rollouts... iter  138
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -21.426226795106437
DONE TAKING  40  STEPS.
Total reward:  296.93535549909257
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.312132911934263
DONE TAKING  40  STEPS.
Total reward:  326.68300363014936
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.3446164028744
DONE TAKING  40  STEPS.
Total reward:  253.41448732110933
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.334195674741885
DONE TAKING  40  STEPS.
Total reward:  58.337953442166096
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.8731263141111
DONE TAKING  40  STEPS.
Total reward:  100.1670502973549
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.05899987049879
DONE TAKING  40  STEPS.
Total reward:  331.23792775045956
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -17.695851156190685
DONE TAKING  40  STEPS.
Total reward:  439.02268723232845
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.592492132848946
DONE TAKING  40  STEPS.
Total reward:  201.49511029920757
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.078318710261662
DONE TAKING  40  STEPS.
Total reward:  432.243475109498
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -11.683377385980524
DONE TAKING  40  STEPS.
Total reward:  453.4256643473932
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.88060988412299
DONE TAKING  40  STEPS.
Total reward:  -194.81460843903534
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -11.148266557740437
DONE TAKING  40  STEPS.
Total reward:  436.94369478070314
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.264627682103175
DONE TAKING  40  STEPS.
Total reward:  45.692494478145875
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.444613709782622
DONE TAKING  40  STEPS.
Total reward:  201.0897061121357
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.970183363844985
DONE TAKING  40  STEPS.
Total reward:  42.2913634336815
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.110180924267965
DONE TAKING  40  STEPS.
Total reward:  -471.92321106562855
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.48206066329956
DONE TAKING  40  STEPS.
Total reward:  186.182513799076
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -22.693127041452694
DONE TAKING  40  STEPS.
Total reward:  342.16293245140355
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.832465783573916
DONE TAKING  40  STEPS.
Total reward:  239.66976739793927
Time for 1 rollout: 1.36 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.25910254761119
DONE TAKING  40  STEPS.
Total reward:  230.86423891177597
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.33329367621205
DONE TAKING  40  STEPS.
Total reward:  201.23868707288278
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -31.140006701136024
DONE TAKING  40  STEPS.
Total reward:  -45.94769550714112
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.05524269771343
DONE TAKING  40  STEPS.
Total reward:  319.09181729041615
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.430222898478775
DONE TAKING  40  STEPS.
Total reward:  -120.17667622647826
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.035186403965355
DONE TAKING  40  STEPS.
Total reward:  286.6452574045954
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.45175780948899
DONE TAKING  40  STEPS.
Total reward:  530.2274302693586
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.822334340890066
DONE TAKING  40  STEPS.
Total reward:  153.38312453607426
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -12.327522921395131
DONE TAKING  40  STEPS.
Total reward:  186.85513277589794
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.703577434749615
DONE TAKING  40  STEPS.
Total reward:  145.49414989187736
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.920491082408592
DONE TAKING  40  STEPS.
Total reward:  29.98406837067379
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.094821131509942
DONE TAKING  40  STEPS.
Total reward:  389.74532836264206
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.12286379323919
DONE TAKING  40  STEPS.
Total reward:  458.79424555395985
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -16.6140328786813
DONE TAKING  40  STEPS.
Total reward:  111.64111781420335
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.69081168365812
DONE TAKING  40  STEPS.
Total reward:  161.1992468897473
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.57298886136279
DONE TAKING  40  STEPS.
Total reward:  -28.59704025356607
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.317093628640787
DONE TAKING  40  STEPS.
Total reward:  340.3571402388723
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.700412294433157
DONE TAKING  40  STEPS.
Total reward:  308.11733502129596
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.666166250001194
DONE TAKING  40  STEPS.
Total reward:  483.62030181815965
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.67925595204732
DONE TAKING  40  STEPS.
Total reward:  194.9190981003206
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.68656614491318
DONE TAKING  40  STEPS.
Total reward:  214.69829024743112
Time for 1 rollout: 1.14 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter138.ckpt

#####################################
Training the dynamics model..... iteration  139
#####################################

    amount of random data:  8000
    amount of onPol data:  205164
Prob rand:  34905
On pol:  200160
Prob shape:  (235065,)

=== Epoch 0 ===
    train loss:  0.3552992672442351
    val rand:  0.38953834772109985
    val onPol:  0.28927265454170314

=== Epoch 10 ===
    train loss:  0.21129833314413599
    val rand:  0.2150089144706726
    val onPol:  0.2194590232400007

=== Epoch 20 ===
    train loss:  0.1855843492452875
    val rand:  0.18505990505218506
    val onPol:  0.2151358820671259

=== Epoch 30 ===
    train loss:  0.17122003734761074
    val rand:  0.17449091374874115
    val onPol:  0.2168657013843226

=== Epoch 39 ===
    train loss:  0.16188137691005383
    val rand:  0.16890732944011688
    val onPol:  0.21947599392990733
Training duration: 116.13 s

#####################################
performing on-policy MPC rollouts... iter  139
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.959481408473042
DONE TAKING  40  STEPS.
Total reward:  -54.46363604696214
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.096536312884965
DONE TAKING  40  STEPS.
Total reward:  451.73836503209
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.466948070999912
DONE TAKING  40  STEPS.
Total reward:  181.51159535582934
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -31.061412507972218
DONE TAKING  40  STEPS.
Total reward:  171.79635377524153
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.281462469714654
DONE TAKING  40  STEPS.
Total reward:  224.7517059558321
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.351941805771965
DONE TAKING  40  STEPS.
Total reward:  232.76799056883988
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.912432567195438
DONE TAKING  40  STEPS.
Total reward:  315.89997041789286
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -16.271870838023336
DONE TAKING  40  STEPS.
Total reward:  483.56494041063706
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.65601209462842
DONE TAKING  40  STEPS.
Total reward:  187.70184588122453
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.418193370282147
DONE TAKING  40  STEPS.
Total reward:  91.3120715166871
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.785549253802156
DONE TAKING  40  STEPS.
Total reward:  213.51527185623618
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.765034551041744
DONE TAKING  40  STEPS.
Total reward:  397.752160803101
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.650460924755414
DONE TAKING  40  STEPS.
Total reward:  -124.95500469801159
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -20.74758924734384
DONE TAKING  40  STEPS.
Total reward:  340.53547807350327
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -30.635662785838424
DONE TAKING  40  STEPS.
Total reward:  71.20116046975218
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.603603988268333
DONE TAKING  40  STEPS.
Total reward:  332.45960152820373
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.05965214885259
DONE TAKING  40  STEPS.
Total reward:  330.78033865972003
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -31.16738110768108
DONE TAKING  40  STEPS.
Total reward:  3.2654682312968646
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.16055431747839
DONE TAKING  40  STEPS.
Total reward:  493.31734138023245
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.513626149419355
DONE TAKING  40  STEPS.
Total reward:  296.50679914163175
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.642200491970442
DONE TAKING  40  STEPS.
Total reward:  287.1397014529946
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.131304730225573
DONE TAKING  40  STEPS.
Total reward:  451.4134779713721
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.578068936443053
DONE TAKING  40  STEPS.
Total reward:  144.18588925897134
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.27127492561602
DONE TAKING  40  STEPS.
Total reward:  33.244405417042685
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.147384470175247
DONE TAKING  40  STEPS.
Total reward:  187.58937595260892
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.446329351793946
DONE TAKING  40  STEPS.
Total reward:  430.69599576420507
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -15.810047626648432
DONE TAKING  40  STEPS.
Total reward:  380.15339656631403
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -15.463648744385946
DONE TAKING  40  STEPS.
Total reward:  451.34984643560455
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.235043993738284
DONE TAKING  40  STEPS.
Total reward:  263.13011340675416
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.844284598856092
DONE TAKING  40  STEPS.
Total reward:  372.7292484320784
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.830789625344316
DONE TAKING  40  STEPS.
Total reward:  315.4133173859665
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.85713558261097
DONE TAKING  40  STEPS.
Total reward:  474.44770215108707
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.614574016452124
DONE TAKING  40  STEPS.
Total reward:  216.37234295748726
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.970242085700647
DONE TAKING  40  STEPS.
Total reward:  259.8965791276202
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.889156499176593
DONE TAKING  40  STEPS.
Total reward:  263.03562590513405
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.825438634777083
DONE TAKING  40  STEPS.
Total reward:  492.0495070307412
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.69025882952742
DONE TAKING  40  STEPS.
Total reward:  -45.398003942742655
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.86908915517343
DONE TAKING  40  STEPS.
Total reward:  347.35390373321417
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.19446761182895
DONE TAKING  40  STEPS.
Total reward:  261.4147655936225
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.502608750899164
DONE TAKING  40  STEPS.
Total reward:  200.96997118647576
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter139.ckpt

#####################################
Training the dynamics model..... iteration  140
#####################################

    amount of random data:  8000
    amount of onPol data:  206640
Prob rand:  35100
On pol:  201600
Prob shape:  (236700,)

=== Epoch 0 ===
    train loss:  0.3551744003316541
    val rand:  0.38045400381088257
    val onPol:  0.28894628203192424

=== Epoch 10 ===
    train loss:  0.21163207295782122
    val rand:  0.21457748115062714
    val onPol:  0.22134732506995977

=== Epoch 20 ===
    train loss:  0.18694097135877197
    val rand:  0.1871679276227951
    val onPol:  0.21738709994526798

=== Epoch 30 ===
    train loss:  0.1719575748815165
    val rand:  0.17365941405296326
    val onPol:  0.21888954382996226

=== Epoch 39 ===
    train loss:  0.1635159763358372
    val rand:  0.17071495950222015
    val onPol:  0.22158144102540128
Training duration: 118.10 s

#####################################
performing on-policy MPC rollouts... iter  140
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.96596100333696
DONE TAKING  40  STEPS.
Total reward:  24.152793172480905
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -22.161275829021385
DONE TAKING  40  STEPS.
Total reward:  334.09760502597175
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -16.96417794515635
DONE TAKING  40  STEPS.
Total reward:  -343.2971199776307
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.21082097341748
DONE TAKING  40  STEPS.
Total reward:  22.91910534109983
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.32587858810075
DONE TAKING  40  STEPS.
Total reward:  15.438685159304185
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.10916315770456
DONE TAKING  40  STEPS.
Total reward:  401.37525603625915
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.587131650216254
DONE TAKING  40  STEPS.
Total reward:  344.55636929847185
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.667431957402485
DONE TAKING  40  STEPS.
Total reward:  343.99210185551493
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -15.564980028613622
DONE TAKING  40  STEPS.
Total reward:  345.3114796002559
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.58712112989945
DONE TAKING  40  STEPS.
Total reward:  135.42516054607742
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -31.03762612512027
DONE TAKING  40  STEPS.
Total reward:  -623.1172169564891
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.311489966169354
DONE TAKING  40  STEPS.
Total reward:  -207.93104287571632
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -29.642401339229636
DONE TAKING  40  STEPS.
Total reward:  298.4792937908942
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.469890773889226
DONE TAKING  40  STEPS.
Total reward:  108.18654981531922
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.306937075708298
DONE TAKING  40  STEPS.
Total reward:  304.8973984021539
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.06082264951353
DONE TAKING  40  STEPS.
Total reward:  50.76818912987921
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.113516969228318
DONE TAKING  40  STEPS.
Total reward:  124.30636906528761
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.521870334989522
DONE TAKING  40  STEPS.
Total reward:  98.01108266411141
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.336248263293182
DONE TAKING  40  STEPS.
Total reward:  487.98877002921915
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.153805810522883
DONE TAKING  40  STEPS.
Total reward:  406.09158391478275
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.8705773192292
DONE TAKING  40  STEPS.
Total reward:  309.9247362856381
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.797803955344413
DONE TAKING  40  STEPS.
Total reward:  -478.0375511238451
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.560211996321293
DONE TAKING  40  STEPS.
Total reward:  197.3156144182543
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.063313786447317
DONE TAKING  40  STEPS.
Total reward:  251.10790430340612
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -31.388503577509745
DONE TAKING  40  STEPS.
Total reward:  216.3975707392575
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.616307523920106
DONE TAKING  40  STEPS.
Total reward:  402.21012220067894
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -13.443095475550193
DONE TAKING  40  STEPS.
Total reward:  491.0381287763147
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.063195768473193
DONE TAKING  40  STEPS.
Total reward:  267.5290958885487
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.506970661356977
DONE TAKING  40  STEPS.
Total reward:  216.6840539194995
Time for 1 rollout: 1.33 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.619634336726104
DONE TAKING  40  STEPS.
Total reward:  -38.326005572309754
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.28444643228155
DONE TAKING  40  STEPS.
Total reward:  505.8968526670595
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.778996980508424
DONE TAKING  40  STEPS.
Total reward:  322.50590227107415
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.756999434398395
DONE TAKING  40  STEPS.
Total reward:  279.7825047976961
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.393624407356597
DONE TAKING  40  STEPS.
Total reward:  423.2950372224112
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.244703024471065
DONE TAKING  40  STEPS.
Total reward:  196.36107034869266
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.93395139142453
DONE TAKING  40  STEPS.
Total reward:  173.24576983758354
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -12.427247514249542
DONE TAKING  40  STEPS.
Total reward:  239.43206259793277
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -17.352061769251154
DONE TAKING  40  STEPS.
Total reward:  449.10134801489875
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -17.78846089074115
DONE TAKING  40  STEPS.
Total reward:  472.3199681547226
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -11.387163551220617
DONE TAKING  40  STEPS.
Total reward:  512.4894770450743
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter140.ckpt

#####################################
Training the dynamics model..... iteration  141
#####################################

    amount of random data:  8000
    amount of onPol data:  208116
Prob rand:  35295
On pol:  203040
Prob shape:  (238335,)

=== Epoch 0 ===
    train loss:  0.35637354100904156
    val rand:  0.38579219579696655
    val onPol:  0.28765259005806665

=== Epoch 10 ===
    train loss:  0.21104386653951418
    val rand:  0.2163543403148651
    val onPol:  0.21976626630533824

=== Epoch 20 ===
    train loss:  0.18679550152312044
    val rand:  0.18465620279312134
    val onPol:  0.21450162746689536

=== Epoch 30 ===
    train loss:  0.17174236444375848
    val rand:  0.17442767322063446
    val onPol:  0.21620719236406413

=== Epoch 39 ===
    train loss:  0.1630039257387961
    val rand:  0.17123036086559296
    val onPol:  0.21944286301732063
Training duration: 118.18 s

#####################################
performing on-policy MPC rollouts... iter  141
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.882303480717816
DONE TAKING  40  STEPS.
Total reward:  408.9988950886111
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.76446651499703
DONE TAKING  40  STEPS.
Total reward:  367.4228574700889
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.65363658375187
DONE TAKING  40  STEPS.
Total reward:  176.44418735813832
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.87151152891617
DONE TAKING  40  STEPS.
Total reward:  329.03998321098175
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.88734977633951
DONE TAKING  40  STEPS.
Total reward:  358.95356168852123
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.396883013817654
DONE TAKING  40  STEPS.
Total reward:  -221.8785314467945
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.93021783802806
DONE TAKING  40  STEPS.
Total reward:  -151.93583834985077
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.373774868972443
DONE TAKING  40  STEPS.
Total reward:  202.6682187555521
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -13.50524152411034
DONE TAKING  40  STEPS.
Total reward:  232.0712294527632
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.21001264540873
DONE TAKING  40  STEPS.
Total reward:  344.9544100455305
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.79814943991035
DONE TAKING  40  STEPS.
Total reward:  41.40588194813935
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.472157384530515
DONE TAKING  40  STEPS.
Total reward:  72.10189973069345
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -16.685471386223128
DONE TAKING  40  STEPS.
Total reward:  435.48952103080677
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -10.757394979630606
DONE TAKING  40  STEPS.
Total reward:  531.084578368528
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.361117334921985
DONE TAKING  40  STEPS.
Total reward:  138.968729543576
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -9.65565581130669
DONE TAKING  40  STEPS.
Total reward:  543.5529817707285
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -14.53475775541159
DONE TAKING  40  STEPS.
Total reward:  380.1293427099897
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.974590107127646
DONE TAKING  40  STEPS.
Total reward:  -200.3299001821015
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.483367416706205
DONE TAKING  40  STEPS.
Total reward:  354.682935478085
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.80218861013092
DONE TAKING  40  STEPS.
Total reward:  395.3355694168311
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.173415768413925
DONE TAKING  40  STEPS.
Total reward:  -54.87888929440521
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.51651569206788
DONE TAKING  40  STEPS.
Total reward:  -30.080620290601292
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -26.239357482982264
DONE TAKING  40  STEPS.
Total reward:  285.9577775867695
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.396018756580336
DONE TAKING  40  STEPS.
Total reward:  277.258968954914
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.984194189640853
DONE TAKING  40  STEPS.
Total reward:  158.16831801319063
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.854129151190346
DONE TAKING  40  STEPS.
Total reward:  -74.78066378789774
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.234036046100584
DONE TAKING  40  STEPS.
Total reward:  85.45009384104344
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -30.574105879963422
DONE TAKING  40  STEPS.
Total reward:  -111.04985400079977
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.00886860509159
DONE TAKING  40  STEPS.
Total reward:  47.12940752016047
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -19.77750802720863
DONE TAKING  40  STEPS.
Total reward:  443.6144104167918
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -10.6662483164183
DONE TAKING  40  STEPS.
Total reward:  313.36501299134284
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -14.664270930051009
DONE TAKING  40  STEPS.
Total reward:  542.9706937550164
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -14.957584729440288
DONE TAKING  40  STEPS.
Total reward:  512.622147190159
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.151456214632283
DONE TAKING  40  STEPS.
Total reward:  -636.4907328266477
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.177827742475436
DONE TAKING  40  STEPS.
Total reward:  -113.08394890876491
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.064979611293776
DONE TAKING  40  STEPS.
Total reward:  348.40293114290034
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.404855773496166
DONE TAKING  40  STEPS.
Total reward:  221.68574206518286
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.778340766771503
DONE TAKING  40  STEPS.
Total reward:  103.61002333046068
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -31.18691366941322
DONE TAKING  40  STEPS.
Total reward:  158.66720906421145
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.45371710182864
DONE TAKING  40  STEPS.
Total reward:  325.11838293225196
Time for 1 rollout: 1.10 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter141.ckpt

#####################################
Training the dynamics model..... iteration  142
#####################################

    amount of random data:  8000
    amount of onPol data:  209592
Prob rand:  35490
On pol:  204480
Prob shape:  (239970,)

=== Epoch 0 ===
    train loss:  0.35722654522993624
    val rand:  0.388924241065979
    val onPol:  0.2894675826484507

=== Epoch 10 ===
    train loss:  0.21334786843667683
    val rand:  0.23600712418556213
    val onPol:  0.22077099707993594

=== Epoch 20 ===
    train loss:  0.18904205698233384
    val rand:  0.19425320625305176
    val onPol:  0.21320691298354755

=== Epoch 30 ===
    train loss:  0.1753543008469109
    val rand:  0.17842978239059448
    val onPol:  0.21472769467668099

=== Epoch 39 ===
    train loss:  0.1674119560764386
    val rand:  0.17220056056976318
    val onPol:  0.21798547831448642
Training duration: 121.58 s

#####################################
performing on-policy MPC rollouts... iter  142
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.54537830385545
DONE TAKING  40  STEPS.
Total reward:  -64.72995728943044
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.558234839077983
DONE TAKING  40  STEPS.
Total reward:  466.7698805074669
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.949474669519216
DONE TAKING  40  STEPS.
Total reward:  174.53010830154193
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -18.43105963998168
DONE TAKING  40  STEPS.
Total reward:  289.92701391506444
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.332682993177848
DONE TAKING  40  STEPS.
Total reward:  397.436285605942
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.380567812100907
DONE TAKING  40  STEPS.
Total reward:  -198.31519353285276
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.676366616590336
DONE TAKING  40  STEPS.
Total reward:  -226.35847633432837
Time for 1 rollout: 1.28 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.899862900311504
DONE TAKING  40  STEPS.
Total reward:  449.0156045572988
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -30.14443605890625
DONE TAKING  40  STEPS.
Total reward:  302.7611010557328
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.385268047694787
DONE TAKING  40  STEPS.
Total reward:  440.87929749606394
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.72844576554722
DONE TAKING  40  STEPS.
Total reward:  131.57098785902264
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.03484532325986
DONE TAKING  40  STEPS.
Total reward:  309.22373694953643
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -14.955539580236277
DONE TAKING  40  STEPS.
Total reward:  -189.60705827909675
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.479165180077867
DONE TAKING  40  STEPS.
Total reward:  465.7950531751593
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.331922010193633
DONE TAKING  40  STEPS.
Total reward:  397.74615732579167
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.31256169806744
DONE TAKING  40  STEPS.
Total reward:  307.37250125311334
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.69154597055469
DONE TAKING  40  STEPS.
Total reward:  87.31169146024419
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.419020475851816
DONE TAKING  40  STEPS.
Total reward:  154.9790784286547
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -11.864234695726063
DONE TAKING  40  STEPS.
Total reward:  330.5183869999068
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.983918995057714
DONE TAKING  40  STEPS.
Total reward:  79.97152634923788
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.196097021531717
DONE TAKING  40  STEPS.
Total reward:  -119.35766416118345
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.35736797025272
DONE TAKING  40  STEPS.
Total reward:  -16.608404796958098
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.10009217239269
DONE TAKING  40  STEPS.
Total reward:  0.5108955693697652
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.56512326389421
DONE TAKING  40  STEPS.
Total reward:  356.39397304259234
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.080520482220706
DONE TAKING  40  STEPS.
Total reward:  400.4495467083501
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.4737853281913
DONE TAKING  40  STEPS.
Total reward:  372.2946822938383
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.961467606170643
DONE TAKING  40  STEPS.
Total reward:  132.25850992299522
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.779043763745314
DONE TAKING  40  STEPS.
Total reward:  -3.8159001907102947
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.492123009772342
DONE TAKING  40  STEPS.
Total reward:  384.3074747381665
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.81152256758431
DONE TAKING  40  STEPS.
Total reward:  433.18966556549685
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.128123606155604
DONE TAKING  40  STEPS.
Total reward:  235.33371077728464
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -12.888755163510679
DONE TAKING  40  STEPS.
Total reward:  554.7712674380597
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.487029985926146
DONE TAKING  40  STEPS.
Total reward:  300.667483827815
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.05825176535984
DONE TAKING  40  STEPS.
Total reward:  409.37398775220487
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.43186425286207
DONE TAKING  40  STEPS.
Total reward:  278.6412595127944
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.313659145955285
DONE TAKING  40  STEPS.
Total reward:  286.32026217788075
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -29.84112699550272
DONE TAKING  40  STEPS.
Total reward:  -52.4742722420795
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.018429353820963
DONE TAKING  40  STEPS.
Total reward:  167.02773269461562
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -22.53799465726864
DONE TAKING  40  STEPS.
Total reward:  136.58061776212577
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.871026507258403
DONE TAKING  40  STEPS.
Total reward:  392.96081701363846
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter142.ckpt

#####################################
Training the dynamics model..... iteration  143
#####################################

    amount of random data:  8000
    amount of onPol data:  211068
Prob rand:  35685
On pol:  205920
Prob shape:  (241605,)

=== Epoch 0 ===
    train loss:  0.35548305308995987
    val rand:  0.3724312484264374
    val onPol:  0.28738882121714676

=== Epoch 10 ===
    train loss:  0.21126773450404976
    val rand:  0.21786025166511536
    val onPol:  0.21992068297483705

=== Epoch 20 ===
    train loss:  0.18851645980544404
    val rand:  0.18845051527023315
    val onPol:  0.21473504636775365

=== Epoch 30 ===
    train loss:  0.17466155589892354
    val rand:  0.17619359493255615
    val onPol:  0.2163554331795736

=== Epoch 39 ===
    train loss:  0.1654760438608769
    val rand:  0.17410968244075775
    val onPol:  0.21878454664891417
Training duration: 124.57 s

#####################################
performing on-policy MPC rollouts... iter  143
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -28.44841903329696
DONE TAKING  40  STEPS.
Total reward:  184.99872373359437
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.285473409833944
DONE TAKING  40  STEPS.
Total reward:  123.89211017380927
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.28922723323288
DONE TAKING  40  STEPS.
Total reward:  490.5634059349321
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.853022783116522
DONE TAKING  40  STEPS.
Total reward:  136.9875678969281
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -17.303076830040638
DONE TAKING  40  STEPS.
Total reward:  532.7914192156668
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.155578533552333
DONE TAKING  40  STEPS.
Total reward:  -63.74331752403369
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.875673873992667
DONE TAKING  40  STEPS.
Total reward:  380.2899494072136
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.471034269231424
DONE TAKING  40  STEPS.
Total reward:  314.8620354117013
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.845512757900618
DONE TAKING  40  STEPS.
Total reward:  360.9014142334599
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -13.01489537958729
DONE TAKING  40  STEPS.
Total reward:  252.9939082828162
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.01940785881168
DONE TAKING  40  STEPS.
Total reward:  419.7241022550261
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -29.1388298726866
DONE TAKING  40  STEPS.
Total reward:  -619.309988933224
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.085230649642163
DONE TAKING  40  STEPS.
Total reward:  -92.14799431160637
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.430733677353782
DONE TAKING  40  STEPS.
Total reward:  82.427539788443
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -20.446169874888405
DONE TAKING  40  STEPS.
Total reward:  211.4387451989379
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.750918406189378
DONE TAKING  40  STEPS.
Total reward:  -246.09818521400555
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.570749909044878
DONE TAKING  40  STEPS.
Total reward:  142.11647298577088
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.9567629536646
DONE TAKING  40  STEPS.
Total reward:  97.40568708734726
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -18.318439983941342
DONE TAKING  40  STEPS.
Total reward:  396.84327362861336
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.46860513913399
DONE TAKING  40  STEPS.
Total reward:  70.92020264392066
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -15.45342506217169
DONE TAKING  40  STEPS.
Total reward:  368.5893825323683
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.46600672344336
DONE TAKING  40  STEPS.
Total reward:  237.54750745889743
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.743788799116768
DONE TAKING  40  STEPS.
Total reward:  473.6499497151717
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.775122449748437
DONE TAKING  40  STEPS.
Total reward:  305.8034923946552
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.297664402821866
DONE TAKING  40  STEPS.
Total reward:  287.4458469330928
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.00444512158444
DONE TAKING  40  STEPS.
Total reward:  432.566374971533
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.74683639303741
DONE TAKING  40  STEPS.
Total reward:  -147.05531998899073
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.116076691637794
DONE TAKING  40  STEPS.
Total reward:  335.19214732440366
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.102575105294925
DONE TAKING  40  STEPS.
Total reward:  2.66002621475824
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.789901400424238
DONE TAKING  40  STEPS.
Total reward:  356.46628613003145
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.787768851845293
DONE TAKING  40  STEPS.
Total reward:  267.3600961187788
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -12.174754447088311
DONE TAKING  40  STEPS.
Total reward:  -168.35859535455407
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.69949350732025
DONE TAKING  40  STEPS.
Total reward:  313.40326556931166
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.822064295720327
DONE TAKING  40  STEPS.
Total reward:  97.13183016616284
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -19.70752758045495
DONE TAKING  40  STEPS.
Total reward:  521.2610207930297
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.453853777427945
DONE TAKING  40  STEPS.
Total reward:  125.69519681671413
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.454786988710282
DONE TAKING  40  STEPS.
Total reward:  155.05909279653096
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.573558743002984
DONE TAKING  40  STEPS.
Total reward:  85.57102416481047
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.14456717381639
DONE TAKING  40  STEPS.
Total reward:  173.07439908820572
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.055984719497133
DONE TAKING  40  STEPS.
Total reward:  252.4788121650826
Time for 1 rollout: 1.16 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter143.ckpt

#####################################
Training the dynamics model..... iteration  144
#####################################

    amount of random data:  8000
    amount of onPol data:  212544
Prob rand:  35880
On pol:  207360
Prob shape:  (243240,)

=== Epoch 0 ===
    train loss:  0.35309090658238057
    val rand:  0.3755803108215332
    val onPol:  0.2890253401464886

=== Epoch 10 ===
    train loss:  0.21108025670051575
    val rand:  0.2206425964832306
    val onPol:  0.2206223318974177

=== Epoch 20 ===
    train loss:  0.18638717582351283
    val rand:  0.18839424848556519
    val onPol:  0.21535359819730124

=== Epoch 30 ===
    train loss:  0.17255308659453142
    val rand:  0.18062123656272888
    val onPol:  0.2187850359413359

=== Epoch 39 ===
    train loss:  0.1638760084854929
    val rand:  0.1754056215286255
    val onPol:  0.22032740712165833
Training duration: 119.64 s

#####################################
performing on-policy MPC rollouts... iter  144
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.529383285331562
DONE TAKING  40  STEPS.
Total reward:  -7.696974223998772
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.531042933620412
DONE TAKING  40  STEPS.
Total reward:  362.2851691998048
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.149821302511643
DONE TAKING  40  STEPS.
Total reward:  339.5229683870165
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -8.997527352637242
DONE TAKING  40  STEPS.
Total reward:  207.92360248106118
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.629052638057345
DONE TAKING  40  STEPS.
Total reward:  -64.52533395523142
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.67656857410868
DONE TAKING  40  STEPS.
Total reward:  332.36661666800416
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.74070225301776
DONE TAKING  40  STEPS.
Total reward:  372.81658519817154
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.775844787157588
DONE TAKING  40  STEPS.
Total reward:  182.07561034129134
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.394889027844222
DONE TAKING  40  STEPS.
Total reward:  390.20086674528704
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -15.745264276440867
DONE TAKING  40  STEPS.
Total reward:  238.8851556175636
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.445308797908666
DONE TAKING  40  STEPS.
Total reward:  240.63326882295792
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -10.947125796106612
DONE TAKING  40  STEPS.
Total reward:  459.22420838724344
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.54623192312814
DONE TAKING  40  STEPS.
Total reward:  252.86505609010638
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.518538450805828
DONE TAKING  40  STEPS.
Total reward:  313.2519914411027
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.55049095457997
DONE TAKING  40  STEPS.
Total reward:  403.06984977798373
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.3376734591525
DONE TAKING  40  STEPS.
Total reward:  -235.6733722738523
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.411061878643814
DONE TAKING  40  STEPS.
Total reward:  325.8854542117504
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.97299158127305
DONE TAKING  40  STEPS.
Total reward:  181.744013195139
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.848971660215454
DONE TAKING  40  STEPS.
Total reward:  -93.92560906920426
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.081026764861516
DONE TAKING  40  STEPS.
Total reward:  492.7934298622917
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.816273773018093
DONE TAKING  40  STEPS.
Total reward:  49.597483923055094
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.530015660697146
DONE TAKING  40  STEPS.
Total reward:  216.40745259263608
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.301571967441504
DONE TAKING  40  STEPS.
Total reward:  -19.98367178783902
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.484378314063537
DONE TAKING  40  STEPS.
Total reward:  207.19604696983626
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -13.970559067237648
DONE TAKING  40  STEPS.
Total reward:  530.5831593912983
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.03212554836298
DONE TAKING  40  STEPS.
Total reward:  285.3499524197925
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.368276146650338
DONE TAKING  40  STEPS.
Total reward:  150.04124187521384
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.922445362619655
DONE TAKING  40  STEPS.
Total reward:  373.9570283159791
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.874343966723448
DONE TAKING  40  STEPS.
Total reward:  231.78601798040228
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -13.19965235255541
DONE TAKING  40  STEPS.
Total reward:  281.0200237605725
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.566174585527758
DONE TAKING  40  STEPS.
Total reward:  365.5351072649187
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.854257445758137
DONE TAKING  40  STEPS.
Total reward:  192.92748768696853
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -11.787752831756567
DONE TAKING  40  STEPS.
Total reward:  470.1644067555427
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.977096007716685
DONE TAKING  40  STEPS.
Total reward:  447.29675381726327
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -29.070532913670093
DONE TAKING  40  STEPS.
Total reward:  -165.14310716502368
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.98533879710993
DONE TAKING  40  STEPS.
Total reward:  290.5217509649869
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -19.70396743428759
DONE TAKING  40  STEPS.
Total reward:  -101.53905750315018
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.948431844018952
DONE TAKING  40  STEPS.
Total reward:  206.45779118861606
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.35731794582958
DONE TAKING  40  STEPS.
Total reward:  222.19085404682312
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.76745081742315
DONE TAKING  40  STEPS.
Total reward:  454.7306380344025
Time for 1 rollout: 1.17 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter144.ckpt

#####################################
Training the dynamics model..... iteration  145
#####################################

    amount of random data:  8000
    amount of onPol data:  214020
Prob rand:  36075
On pol:  208800
Prob shape:  (244875,)

=== Epoch 0 ===
    train loss:  0.356671284058104
    val rand:  0.3858148455619812
    val onPol:  0.28857634431786006

=== Epoch 10 ===
    train loss:  0.21172257896247768
    val rand:  0.22343747317790985
    val onPol:  0.2193306412961748

=== Epoch 20 ===
    train loss:  0.18707709061176708
    val rand:  0.19174134731292725
    val onPol:  0.21415886183579763

=== Epoch 30 ===
    train loss:  0.17274102952066325
    val rand:  0.17770671844482422
    val onPol:  0.21490273740556504

=== Epoch 39 ===
    train loss:  0.16524203215184072
    val rand:  0.1737154722213745
    val onPol:  0.21770101818773482
Training duration: 127.86 s

#####################################
performing on-policy MPC rollouts... iter  145
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.82312224893606
DONE TAKING  40  STEPS.
Total reward:  194.05753729968492
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.66923218779836
DONE TAKING  40  STEPS.
Total reward:  0.4386407794879439
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.274607089338637
DONE TAKING  40  STEPS.
Total reward:  300.4971573891643
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.93013629217194
DONE TAKING  40  STEPS.
Total reward:  367.3975989403272
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.437441061266775
DONE TAKING  40  STEPS.
Total reward:  329.3184402745769
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.47395972841549
DONE TAKING  40  STEPS.
Total reward:  -154.8889603259895
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.46293065507573
DONE TAKING  40  STEPS.
Total reward:  43.65730008279165
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.081562240810186
DONE TAKING  40  STEPS.
Total reward:  3.900897694587755
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.266702161716296
DONE TAKING  40  STEPS.
Total reward:  57.99738550725678
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.83595290404532
DONE TAKING  40  STEPS.
Total reward:  421.8197825171244
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.80220161770681
DONE TAKING  40  STEPS.
Total reward:  20.179950994001285
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.724902671884877
DONE TAKING  40  STEPS.
Total reward:  190.80547649666383
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.08579047655133
DONE TAKING  40  STEPS.
Total reward:  191.19774462163744
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.013629163093146
DONE TAKING  40  STEPS.
Total reward:  554.3758368703767
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.305264205851817
DONE TAKING  40  STEPS.
Total reward:  182.09326975545065
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.08063096855315
DONE TAKING  40  STEPS.
Total reward:  244.19971249515302
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.956067667107295
DONE TAKING  40  STEPS.
Total reward:  186.5714185141991
Time for 1 rollout: 1.34 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.375992578299083
DONE TAKING  40  STEPS.
Total reward:  227.76807083498457
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.480930071348894
DONE TAKING  40  STEPS.
Total reward:  361.9644836998066
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.350505078602357
DONE TAKING  40  STEPS.
Total reward:  458.47639049116896
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.99215071842672
DONE TAKING  40  STEPS.
Total reward:  347.1086518533555
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.787039726304055
DONE TAKING  40  STEPS.
Total reward:  -294.7006667907779
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.064582108300893
DONE TAKING  40  STEPS.
Total reward:  353.4714522390311
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -16.40375114646895
DONE TAKING  40  STEPS.
Total reward:  476.8176717243296
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.27801191086613
DONE TAKING  40  STEPS.
Total reward:  389.3727190160657
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.068108936513024
DONE TAKING  40  STEPS.
Total reward:  -588.0388785973951
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.48001706837202
DONE TAKING  40  STEPS.
Total reward:  341.40524709735496
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.86438017121559
DONE TAKING  40  STEPS.
Total reward:  -435.2841310058447
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.936155733540152
DONE TAKING  40  STEPS.
Total reward:  168.83691181257976
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.62234789973086
DONE TAKING  40  STEPS.
Total reward:  216.06131216335504
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.541984832873343
DONE TAKING  40  STEPS.
Total reward:  331.1488999618652
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.747862610731076
DONE TAKING  40  STEPS.
Total reward:  436.5216456030356
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.683835468882744
DONE TAKING  40  STEPS.
Total reward:  224.50897732345177
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -11.373012770988662
DONE TAKING  40  STEPS.
Total reward:  445.1213618342583
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.32688994183306
DONE TAKING  40  STEPS.
Total reward:  407.8862021260334
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.207313979413264
DONE TAKING  40  STEPS.
Total reward:  433.12122682259445
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -10.074381731353972
DONE TAKING  40  STEPS.
Total reward:  490.6871865557374
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -9.300245381029752
DONE TAKING  40  STEPS.
Total reward:  580.4437048979908
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.062324195571417
DONE TAKING  40  STEPS.
Total reward:  359.94751265049496
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.165888271703512
DONE TAKING  40  STEPS.
Total reward:  371.6778480679509
Time for 1 rollout: 1.15 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter145.ckpt

#####################################
Training the dynamics model..... iteration  146
#####################################

    amount of random data:  8000
    amount of onPol data:  215496
Prob rand:  36270
On pol:  210240
Prob shape:  (246510,)

=== Epoch 0 ===
    train loss:  0.3561506129475988
    val rand:  0.38687825202941895
    val onPol:  0.2883460637595918

=== Epoch 10 ===
    train loss:  0.21207566565510635
    val rand:  0.22501294314861298
    val onPol:  0.21980579694112143

=== Epoch 20 ===
    train loss:  0.18672851174140423
    val rand:  0.19197368621826172
    val onPol:  0.2148255106475618

=== Epoch 30 ===
    train loss:  0.17421661146960982
    val rand:  0.18078558146953583
    val onPol:  0.2155259864197837

=== Epoch 39 ===
    train loss:  0.16575285665334635
    val rand:  0.17395780980587006
    val onPol:  0.21767399178610908
Training duration: 111.16 s

#####################################
performing on-policy MPC rollouts... iter  146
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -14.889141455505692
DONE TAKING  40  STEPS.
Total reward:  431.7529296872193
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.133415742276995
DONE TAKING  40  STEPS.
Total reward:  160.57873827927193
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.75607032195218
DONE TAKING  40  STEPS.
Total reward:  238.0230971763056
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -18.47033900686808
DONE TAKING  40  STEPS.
Total reward:  484.892711744008
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -13.229961671624295
DONE TAKING  40  STEPS.
Total reward:  430.28233601957504
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.822578468005627
DONE TAKING  40  STEPS.
Total reward:  -82.56866390865919
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.459831727834448
DONE TAKING  40  STEPS.
Total reward:  128.8304986516638
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.63236909201046
DONE TAKING  40  STEPS.
Total reward:  418.15898465503244
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.660782356387205
DONE TAKING  40  STEPS.
Total reward:  197.72063078939485
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.7417312126847
DONE TAKING  40  STEPS.
Total reward:  248.38815527763433
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -18.674720554905978
DONE TAKING  40  STEPS.
Total reward:  484.8438612728319
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.72426184855268
DONE TAKING  40  STEPS.
Total reward:  -460.29913348820367
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.308528873093014
DONE TAKING  40  STEPS.
Total reward:  213.39189642651377
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.07119914327664
DONE TAKING  40  STEPS.
Total reward:  161.80730313617937
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.844506063510686
DONE TAKING  40  STEPS.
Total reward:  323.0716943664048
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.114031448419148
DONE TAKING  40  STEPS.
Total reward:  298.4875466487751
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.556159474299484
DONE TAKING  40  STEPS.
Total reward:  126.3298978777231
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.984100224621404
DONE TAKING  40  STEPS.
Total reward:  282.73966923536983
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -15.798265666378413
DONE TAKING  40  STEPS.
Total reward:  435.19458706555895
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.310537082230116
DONE TAKING  40  STEPS.
Total reward:  159.79765138439924
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.33004040323098
DONE TAKING  40  STEPS.
Total reward:  110.34060021118117
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.050990768593714
DONE TAKING  40  STEPS.
Total reward:  323.902397666685
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.79645719779604
DONE TAKING  40  STEPS.
Total reward:  80.15892218370787
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.10459423003281
DONE TAKING  40  STEPS.
Total reward:  198.48453587871484
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.983492288243625
DONE TAKING  40  STEPS.
Total reward:  203.24286010927017
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.414090585056908
DONE TAKING  40  STEPS.
Total reward:  38.63410296738263
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.634396546173935
DONE TAKING  40  STEPS.
Total reward:  244.53608354912103
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.390342627720518
DONE TAKING  40  STEPS.
Total reward:  45.24844119810453
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -12.663416659227902
DONE TAKING  40  STEPS.
Total reward:  487.15278269882174
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.559090826365743
DONE TAKING  40  STEPS.
Total reward:  461.6858412835769
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.114270206660983
DONE TAKING  40  STEPS.
Total reward:  143.72197945324538
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.288408292113434
DONE TAKING  40  STEPS.
Total reward:  99.67612232114678
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -25.169903295504348
DONE TAKING  40  STEPS.
Total reward:  248.88036480913703
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.35853238595013
DONE TAKING  40  STEPS.
Total reward:  -199.43133282002202
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -14.748016048966628
DONE TAKING  40  STEPS.
Total reward:  444.81372892066184
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.254919492085115
DONE TAKING  40  STEPS.
Total reward:  472.52255367358066
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -13.48097340948858
DONE TAKING  40  STEPS.
Total reward:  576.7334395538443
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.384316053160706
DONE TAKING  40  STEPS.
Total reward:  456.52033565924046
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.579394555521862
DONE TAKING  40  STEPS.
Total reward:  434.4117200183439
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -31.07922814703813
DONE TAKING  40  STEPS.
Total reward:  62.23996882774558
Time for 1 rollout: 1.13 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter146.ckpt

#####################################
Training the dynamics model..... iteration  147
#####################################

    amount of random data:  8000
    amount of onPol data:  216972
Prob rand:  36465
On pol:  211680
Prob shape:  (248145,)

=== Epoch 0 ===
    train loss:  0.35585977093986243
    val rand:  0.38928818702697754
    val onPol:  0.2877432780133353

=== Epoch 10 ===
    train loss:  0.21242823919727782
    val rand:  0.22783808410167694
    val onPol:  0.22029349737697176

=== Epoch 20 ===
    train loss:  0.18820550991607107
    val rand:  0.18492721021175385
    val onPol:  0.21401505569616955

=== Epoch 30 ===
    train loss:  0.1751558917674644
    val rand:  0.18029873073101044
    val onPol:  0.21511399646600088

=== Epoch 39 ===
    train loss:  0.166562580526614
    val rand:  0.1747431606054306
    val onPol:  0.2172753456566069
Training duration: 123.44 s

#####################################
performing on-policy MPC rollouts... iter  147
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -14.990191099847268
DONE TAKING  40  STEPS.
Total reward:  285.65136186695327
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.761476634350174
DONE TAKING  40  STEPS.
Total reward:  85.77277470417667
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.375953064235773
DONE TAKING  40  STEPS.
Total reward:  326.87891185432585
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.885107034826756
DONE TAKING  40  STEPS.
Total reward:  -61.301913430538946
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.931840239836223
DONE TAKING  40  STEPS.
Total reward:  -25.797897661300976
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.757154310337164
DONE TAKING  40  STEPS.
Total reward:  114.90852463967329
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.35424190193813
DONE TAKING  40  STEPS.
Total reward:  -232.3778783055987
Time for 1 rollout: 1.29 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.533633263803377
DONE TAKING  40  STEPS.
Total reward:  76.1543225897143
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.17755625961596
DONE TAKING  40  STEPS.
Total reward:  111.71162153048776
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.159695542290113
DONE TAKING  40  STEPS.
Total reward:  195.5775560648954
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.192680771817557
DONE TAKING  40  STEPS.
Total reward:  36.77901440330655
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.496782092514803
DONE TAKING  40  STEPS.
Total reward:  31.92272370053506
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -15.840954461477681
DONE TAKING  40  STEPS.
Total reward:  548.9691456008634
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.824757558746853
DONE TAKING  40  STEPS.
Total reward:  429.0634519116213
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.260678702615877
DONE TAKING  40  STEPS.
Total reward:  257.0136882835241
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -9.453917245390128
DONE TAKING  40  STEPS.
Total reward:  431.3512969869466
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -18.394064262178546
DONE TAKING  40  STEPS.
Total reward:  226.47490068808762
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -15.970877149653724
DONE TAKING  40  STEPS.
Total reward:  160.9195169120748
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.115111551143478
DONE TAKING  40  STEPS.
Total reward:  -321.8975589835385
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.88598646697312
DONE TAKING  40  STEPS.
Total reward:  142.04511520629987
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.82845938325345
DONE TAKING  40  STEPS.
Total reward:  462.5576419263221
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -9.048432744308867
DONE TAKING  40  STEPS.
Total reward:  505.3426548324076
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -16.502972865226113
DONE TAKING  40  STEPS.
Total reward:  410.71419113879665
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.696183732174884
DONE TAKING  40  STEPS.
Total reward:  181.3153505984386
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.250629803746584
DONE TAKING  40  STEPS.
Total reward:  230.7125293310374
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.171914073135
DONE TAKING  40  STEPS.
Total reward:  593.8512569509076
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.487444519274217
DONE TAKING  40  STEPS.
Total reward:  262.863761699155
Time for 1 rollout: 1.27 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.313796871820884
DONE TAKING  40  STEPS.
Total reward:  158.97219039125238
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -19.651045564283123
DONE TAKING  40  STEPS.
Total reward:  427.2226723017274
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.10386859913217
DONE TAKING  40  STEPS.
Total reward:  237.62386057679674
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.1242065674801
DONE TAKING  40  STEPS.
Total reward:  378.41490085849097
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.59996686471756
DONE TAKING  40  STEPS.
Total reward:  415.70176808670806
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.115167547558087
DONE TAKING  40  STEPS.
Total reward:  353.86550424766517
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.674264915473554
DONE TAKING  40  STEPS.
Total reward:  127.83080776789495
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.951738700207844
DONE TAKING  40  STEPS.
Total reward:  197.35006777227366
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.447103460924865
DONE TAKING  40  STEPS.
Total reward:  40.318941856185376
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.623565515459834
DONE TAKING  40  STEPS.
Total reward:  384.2013341432066
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.54568150389028
DONE TAKING  40  STEPS.
Total reward:  185.60600760800514
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.953451071720366
DONE TAKING  40  STEPS.
Total reward:  210.36175766297293
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.38805070161019
DONE TAKING  40  STEPS.
Total reward:  176.09657892513366
Time for 1 rollout: 1.20 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter147.ckpt

#####################################
Training the dynamics model..... iteration  148
#####################################

    amount of random data:  8000
    amount of onPol data:  218448
Prob rand:  36660
On pol:  213120
Prob shape:  (249780,)

=== Epoch 0 ===
    train loss:  0.3534914722065661
    val rand:  0.3878635764122009
    val onPol:  0.2864663885987323

=== Epoch 10 ===
    train loss:  0.2119579551095101
    val rand:  0.21349883079528809
    val onPol:  0.22012026899534723

=== Epoch 20 ===
    train loss:  0.18757927699255503
    val rand:  0.19119058549404144
    val onPol:  0.21383298577173895

=== Epoch 30 ===
    train loss:  0.17397495853337908
    val rand:  0.18024620413780212
    val onPol:  0.21594171096449313

=== Epoch 39 ===
    train loss:  0.16617823610927535
    val rand:  0.1718340516090393
    val onPol:  0.21840925158365912
Training duration: 122.68 s

#####################################
performing on-policy MPC rollouts... iter  148
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.071619674127213
DONE TAKING  40  STEPS.
Total reward:  509.6254056960757
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -28.68994022349247
DONE TAKING  40  STEPS.
Total reward:  55.348177830114025
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.244439666218682
DONE TAKING  40  STEPS.
Total reward:  370.1638023120431
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.633108931423756
DONE TAKING  40  STEPS.
Total reward:  401.01526511825705
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.200958852772967
DONE TAKING  40  STEPS.
Total reward:  177.57341698198013
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.400737071434026
DONE TAKING  40  STEPS.
Total reward:  486.5610883517521
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.748798753367463
DONE TAKING  40  STEPS.
Total reward:  275.8622730843913
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -12.622508373570561
DONE TAKING  40  STEPS.
Total reward:  414.75977386182245
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.93806882801531
DONE TAKING  40  STEPS.
Total reward:  382.1851923278525
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.82216561750222
DONE TAKING  40  STEPS.
Total reward:  408.2578218346422
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -19.0295881722453
DONE TAKING  40  STEPS.
Total reward:  383.58558765230856
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.045714336098055
DONE TAKING  40  STEPS.
Total reward:  -280.91563753855644
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -12.543928943980248
DONE TAKING  40  STEPS.
Total reward:  355.05150911322835
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.31693549562069
DONE TAKING  40  STEPS.
Total reward:  419.63405681119514
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.402521438739388
DONE TAKING  40  STEPS.
Total reward:  179.51568644151712
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.675477716862407
DONE TAKING  40  STEPS.
Total reward:  484.78595495209834
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.684314973103017
DONE TAKING  40  STEPS.
Total reward:  -12.287491880259768
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -14.367270359152915
DONE TAKING  40  STEPS.
Total reward:  506.2279273825065
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.05487640435711
DONE TAKING  40  STEPS.
Total reward:  341.206807594239
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.92247379417707
DONE TAKING  40  STEPS.
Total reward:  70.37941899237137
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -10.824818624395853
DONE TAKING  40  STEPS.
Total reward:  468.90923692985166
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.704833833665674
DONE TAKING  40  STEPS.
Total reward:  -58.196139221527694
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.908831641469277
DONE TAKING  40  STEPS.
Total reward:  295.71951026826486
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.99731084711213
DONE TAKING  40  STEPS.
Total reward:  78.87548308595461
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.613742635261936
DONE TAKING  40  STEPS.
Total reward:  155.91708678898505
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.944953745537116
DONE TAKING  40  STEPS.
Total reward:  296.6294383401567
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -18.330338715986073
DONE TAKING  40  STEPS.
Total reward:  341.0039591227982
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.82524192449807
DONE TAKING  40  STEPS.
Total reward:  444.58298832382474
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.950600231737322
DONE TAKING  40  STEPS.
Total reward:  156.3159799227964
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.348800994501122
DONE TAKING  40  STEPS.
Total reward:  407.3980863016666
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.543338334833294
DONE TAKING  40  STEPS.
Total reward:  106.80367813017187
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -15.600589152284503
DONE TAKING  40  STEPS.
Total reward:  193.82751296590374
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.638467502408613
DONE TAKING  40  STEPS.
Total reward:  100.50646174971445
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -29.342208770944612
DONE TAKING  40  STEPS.
Total reward:  103.45414782385431
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.894357720053062
DONE TAKING  40  STEPS.
Total reward:  162.79272079170974
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.50490102163861
DONE TAKING  40  STEPS.
Total reward:  -255.71884164120942
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.634180527751187
DONE TAKING  40  STEPS.
Total reward:  458.16067443389113
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.336689962147755
DONE TAKING  40  STEPS.
Total reward:  -456.5204455502676
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.719293767578463
DONE TAKING  40  STEPS.
Total reward:  -34.38484143947683
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -31.170352330273005
DONE TAKING  40  STEPS.
Total reward:  -46.11419584480763
Time for 1 rollout: 1.21 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter148.ckpt

#####################################
Training the dynamics model..... iteration  149
#####################################

    amount of random data:  8000
    amount of onPol data:  219924
Prob rand:  36855
On pol:  214560
Prob shape:  (251415,)

=== Epoch 0 ===
    train loss:  0.354005718364735
    val rand:  0.37525874376296997
    val onPol:  0.28568369895219803

=== Epoch 10 ===
    train loss:  0.21155569303302804
    val rand:  0.22062593698501587
    val onPol:  0.21830526512602103

=== Epoch 20 ===
    train loss:  0.18624631046884657
    val rand:  0.18857704102993011
    val onPol:  0.2126806893426439

=== Epoch 30 ===
    train loss:  0.172804212406308
    val rand:  0.17667141556739807
    val onPol:  0.21452408510705698

=== Epoch 39 ===
    train loss:  0.1648684605622243
    val rand:  0.17536842823028564
    val onPol:  0.21778838109710943
Training duration: 125.30 s

#####################################
performing on-policy MPC rollouts... iter  149
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -18.613057623676262
DONE TAKING  40  STEPS.
Total reward:  361.10389955241357
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.239239406174967
DONE TAKING  40  STEPS.
Total reward:  70.90079064981673
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.584029729698553
DONE TAKING  40  STEPS.
Total reward:  143.10071661349485
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.926694090789706
DONE TAKING  40  STEPS.
Total reward:  250.8893595862241
Time for 1 rollout: 1.13 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.397496696121348
DONE TAKING  40  STEPS.
Total reward:  145.15036451390137
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -12.264751945042436
DONE TAKING  40  STEPS.
Total reward:  543.0974407380586
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.431452345380244
DONE TAKING  40  STEPS.
Total reward:  70.82923686561139
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.97589775827729
DONE TAKING  40  STEPS.
Total reward:  490.90551831254066
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.42735419583704
DONE TAKING  40  STEPS.
Total reward:  -11.156475117413457
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.77350288839737
DONE TAKING  40  STEPS.
Total reward:  55.39893074140719
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.14170120808589
DONE TAKING  40  STEPS.
Total reward:  469.1417656658305
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.947344249541274
DONE TAKING  40  STEPS.
Total reward:  -42.2484541081035
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.122790731535453
DONE TAKING  40  STEPS.
Total reward:  -185.56946611937968
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.69441150395277
DONE TAKING  40  STEPS.
Total reward:  252.15368419282217
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -14.712733849848362
DONE TAKING  40  STEPS.
Total reward:  229.6226843502307
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.53043148749842
DONE TAKING  40  STEPS.
Total reward:  358.1264539683941
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.056753872759426
DONE TAKING  40  STEPS.
Total reward:  247.53915562418894
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -16.825277101588412
DONE TAKING  40  STEPS.
Total reward:  381.30376164174425
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.677690021868862
DONE TAKING  40  STEPS.
Total reward:  -17.038877399426116
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.441873818063474
DONE TAKING  40  STEPS.
Total reward:  196.2227970350017
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.60970141630324
DONE TAKING  40  STEPS.
Total reward:  384.35410828640397
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.04948716680662
DONE TAKING  40  STEPS.
Total reward:  32.20741658896643
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.062218146129105
DONE TAKING  40  STEPS.
Total reward:  335.210462099318
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.743243959970542
DONE TAKING  40  STEPS.
Total reward:  349.58537994116756
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.217116985525593
DONE TAKING  40  STEPS.
Total reward:  424.85703014390504
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.833751311879745
DONE TAKING  40  STEPS.
Total reward:  204.37919864527896
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.76504630998724
DONE TAKING  40  STEPS.
Total reward:  402.2906389147698
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -17.52405230390173
DONE TAKING  40  STEPS.
Total reward:  114.54508396869953
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.60954316152104
DONE TAKING  40  STEPS.
Total reward:  119.54801176791247
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -18.86092560816515
DONE TAKING  40  STEPS.
Total reward:  420.6990607783274
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -31.378303832442917
DONE TAKING  40  STEPS.
Total reward:  -540.5504877579491
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.8256105811284
DONE TAKING  40  STEPS.
Total reward:  98.72305873883326
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.152002406690066
DONE TAKING  40  STEPS.
Total reward:  273.629837377275
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -17.388988776992647
DONE TAKING  40  STEPS.
Total reward:  543.8723266774535
Time for 1 rollout: 1.16 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.828656917632514
DONE TAKING  40  STEPS.
Total reward:  208.45650787011527
Time for 1 rollout: 1.26 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.76882094353068
DONE TAKING  40  STEPS.
Total reward:  46.42774375779139
Time for 1 rollout: 1.24 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.721671833094135
DONE TAKING  40  STEPS.
Total reward:  232.9426763969052
Time for 1 rollout: 1.21 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.720824164514802
DONE TAKING  40  STEPS.
Total reward:  59.84375492928056
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -18.219924015267665
DONE TAKING  40  STEPS.
Total reward:  49.50379279632688
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.17551584354138
DONE TAKING  40  STEPS.
Total reward:  512.260180172216
Time for 1 rollout: 1.18 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/e1/dclaw_turn/models/model_aggIter149.ckpt
