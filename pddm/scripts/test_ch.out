Added 1 configs from ../config/cheetah.txt
create env called
--------------------------------- 
Simulation dt:  0.05
State space dimension:  (18,)
Action space dimension:  (6,) 
-----------------------------------
Beginning to do  200  random rollouts.
Completed rollout #  0
Completed rollout #  40
Completed rollout #  80
Completed rollout #  100
Completed rollout #  120
Completed rollout #  160
Completed rollout #  140
Completed rollout #  180
Completed rollout #  20
Completed rollout #  60
Performed  200  rollouts, each with  100  steps.
Beginning to do  50  random rollouts.
Completed rollout #  10
Completed rollout #  35
Completed rollout #  20
Completed rollout #  5
Completed rollout #  45
Completed rollout #  30
Completed rollout #  15
Completed rollout #  40
Completed rollout #  0
Completed rollout #  25
Performed  50  rollouts, each with  100  steps.


######################
Done getting data....
input size:  24
action size:  6
output size:  18
dataX dims:  (19800, 1, 18)
dataY dims:  (19800, 1, 6)
dataZ dims:  (19800, 18) 
######################


#####################################
Training the dynamics model..... iteration  0
#####################################

    amount of random data:  20000
    amount of onPol data:  0

=== Epoch 0 ===
    train loss:  0.9400785068670908
    val rand:  0.5234207908312479
    val onPol:  0.5234174529711405

=== Epoch 10 ===
    train loss:  0.09643207490444183
    val rand:  0.09269758313894272
    val onPol:  0.09270310898621877

=== Epoch 20 ===
    train loss:  0.0670962513734897
    val rand:  0.06730016072591145
    val onPol:  0.06730620563030243

=== Epoch 30 ===
    train loss:  0.05405079418172439
    val rand:  0.05598935733238856
    val onPol:  0.05599494278430939

=== Epoch 39 ===
    train loss:  0.04687726870179176
    val rand:  0.04957826808094978
    val onPol:  0.049580579002698265
Training duration: 2.07 s

#####################################
performing on-policy MPC rollouts... iter  0
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -1.403832741225355
DONE TAKING  100  STEPS.
Total reward:  10.350426670269442
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.4870198502845017
DONE TAKING  74  STEPS.
Total reward:  23.9949774444021
Time for 1 rollout: 3.51 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.019923004128576477
DONE TAKING  100  STEPS.
Total reward:  24.654656501611168
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -1.011568897118254
DONE TAKING  100  STEPS.
Total reward:  38.23922508341134
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.60458658173747
DONE TAKING  100  STEPS.
Total reward:  16.19487176208705
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.02083554953761474
DONE TAKING  100  STEPS.
Total reward:  27.798176994330543
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.8719759647972083
DONE TAKING  100  STEPS.
Total reward:  21.62787976914974
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.009792776467118625
DONE TAKING  97  STEPS.
Total reward:  6.408385258128177
Time for 1 rollout: 4.18 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.427984669206207
DONE TAKING  100  STEPS.
Total reward:  20.105921168496025
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.1417109645564389
DONE TAKING  100  STEPS.
Total reward:  17.87426766024351
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.1953940703880856
DONE TAKING  100  STEPS.
Total reward:  28.8033208824009
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.8969698631689176
DONE TAKING  100  STEPS.
Total reward:  -3.649410473590427
Time for 1 rollout: 4.51 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.5574246773769072
DONE TAKING  69  STEPS.
Total reward:  14.648524267423749
Time for 1 rollout: 3.06 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.45552297333228586
DONE TAKING  100  STEPS.
Total reward:  36.03020185065442
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.31702158717445095
DONE TAKING  100  STEPS.
Total reward:  23.609991513686275
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.3942527980274952
DONE TAKING  65  STEPS.
Total reward:  11.96196206535159
Time for 1 rollout: 2.79 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.31542865470889614
DONE TAKING  100  STEPS.
Total reward:  25.33552734517165
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.9255856512061491
DONE TAKING  100  STEPS.
Total reward:  24.303830284666734
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.6735398122004553
DONE TAKING  80  STEPS.
Total reward:  2.613114791320633
Time for 1 rollout: 3.46 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.30585461700389494
DONE TAKING  39  STEPS.
Total reward:  -8.152760300830503
Time for 1 rollout: 1.68 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.31384833730456974
DONE TAKING  50  STEPS.
Total reward:  12.445125776171487
Time for 1 rollout: 2.15 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.022641097765561363
DONE TAKING  100  STEPS.
Total reward:  24.460549730988273
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.5969693013244306
DONE TAKING  41  STEPS.
Total reward:  5.842362875263492
Time for 1 rollout: 1.76 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.1631873137301234
DONE TAKING  100  STEPS.
Total reward:  13.662103351317853
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.9034966365845263
DONE TAKING  100  STEPS.
Total reward:  -0.7749061275448224
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.3133241156338411
DONE TAKING  100  STEPS.
Total reward:  32.88034120597761
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.05708503519573474
DONE TAKING  100  STEPS.
Total reward:  17.74532781404682
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.09325366592817638
DONE TAKING  100  STEPS.
Total reward:  -4.671991939804736
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.04572684847237457
DONE TAKING  52  STEPS.
Total reward:  4.327284259593171
Time for 1 rollout: 2.25 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.6940990223106775
DONE TAKING  69  STEPS.
Total reward:  1.1990507330500715
Time for 1 rollout: 2.98 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  100  steps.
0
done step  0 , rew:  -0.08128222742683494
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
DONE TAKING  100  STEPS.
Total reward:  436.5620124093708
Time for 1 rollout: 396.26 s


Beginning to do  1  random rollouts.
Completed rollout #  0
Performed  1  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
16.37249647966423
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
2.0123165677108172
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter0.ckpt

#####################################
Training the dynamics model..... iteration  1
#####################################

    amount of random data:  20000
    amount of onPol data:  2442

=== Epoch 0 ===
    train loss:  0.31739794678593936
    val rand:  0.17600561181704202
    val onPol:  0.10229286551475525

=== Epoch 10 ===
    train loss:  0.044866063681087996
    val rand:  0.07226034005482991
    val onPol:  0.047991376370191574

=== Epoch 20 ===
    train loss:  0.03343888636874525
    val rand:  0.05769682923952738
    val onPol:  0.04177115857601166

=== Epoch 30 ===
    train loss:  0.027374876368986934
    val rand:  0.04942329476277033
    val onPol:  0.03912580385804176

=== Epoch 39 ===
    train loss:  0.023846121995072616
    val rand:  0.04451843723654747
    val onPol:  0.03770267963409424
Training duration: 5.38 s

#####################################
performing on-policy MPC rollouts... iter  1
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.7508105098290414
DONE TAKING  100  STEPS.
Total reward:  72.44626095666621
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.3105205848140895
DONE TAKING  95  STEPS.
Total reward:  53.52532021351264
Time for 1 rollout: 4.12 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.2954326426629097
DONE TAKING  100  STEPS.
Total reward:  98.27414628822967
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.565926988753022
DONE TAKING  100  STEPS.
Total reward:  90.82683649757278
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.8235998336333539
DONE TAKING  44  STEPS.
Total reward:  9.92266195069433
Time for 1 rollout: 1.91 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.46233899994867556
DONE TAKING  100  STEPS.
Total reward:  59.67535266430127
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.4028615897292772
DONE TAKING  36  STEPS.
Total reward:  23.30910765838815
Time for 1 rollout: 1.56 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.17249567867631926
DONE TAKING  68  STEPS.
Total reward:  64.82137364422614
Time for 1 rollout: 2.94 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.19042918990446722
DONE TAKING  100  STEPS.
Total reward:  78.08515383906263
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.23790750324985763
DONE TAKING  50  STEPS.
Total reward:  49.78037881988842
Time for 1 rollout: 2.16 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.3335738535260067
DONE TAKING  29  STEPS.
Total reward:  19.466356559365774
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.26471227412301973
DONE TAKING  100  STEPS.
Total reward:  74.87076201117489
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.6419995939814063
DONE TAKING  100  STEPS.
Total reward:  73.45563001666316
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.873395984541061
DONE TAKING  100  STEPS.
Total reward:  95.52934564885454
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.9535700607777502
DONE TAKING  32  STEPS.
Total reward:  30.028135450867246
Time for 1 rollout: 1.37 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.30633580538623395
DONE TAKING  100  STEPS.
Total reward:  82.87489417906203
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.9870787910904613
DONE TAKING  100  STEPS.
Total reward:  92.99475855716055
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.522268424395252
DONE TAKING  100  STEPS.
Total reward:  86.53856089117406
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.2712533078001058
DONE TAKING  100  STEPS.
Total reward:  65.21720708851126
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.5854379025271177
DONE TAKING  100  STEPS.
Total reward:  111.12974076848451
Time for 1 rollout: 4.47 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.622838790207252
DONE TAKING  100  STEPS.
Total reward:  104.94822813032995
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.9680383860806927
DONE TAKING  36  STEPS.
Total reward:  17.97643501740714
Time for 1 rollout: 1.56 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.7111897389696462
DONE TAKING  18  STEPS.
Total reward:  -2.1548362104350836
Time for 1 rollout: 0.79 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.9999416904530203
DONE TAKING  100  STEPS.
Total reward:  76.7262618641938
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.127725704644095
DONE TAKING  57  STEPS.
Total reward:  59.70861773010846
Time for 1 rollout: 2.48 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.9864974193156673
DONE TAKING  100  STEPS.
Total reward:  69.70951428314133
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.3612695924619126
DONE TAKING  91  STEPS.
Total reward:  46.986980676128105
Time for 1 rollout: 3.96 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.22733360260167004
DONE TAKING  27  STEPS.
Total reward:  19.48567367689027
Time for 1 rollout: 1.17 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.21659951003659356
DONE TAKING  25  STEPS.
Total reward:  11.709553889679103
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.5558919087136552
DONE TAKING  100  STEPS.
Total reward:  41.63758726562726
Time for 1 rollout: 4.35 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/font_manager.py:1320: UserWarning: findfont: Font family ['serif'] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter1.ckpt

#####################################
Training the dynamics model..... iteration  2
#####################################

    amount of random data:  20000
    amount of onPol data:  4625

=== Epoch 0 ===
    train loss:  0.31686221949152044
    val rand:  0.15042802691459656
    val onPol:  0.12587150931358337

=== Epoch 10 ===
    train loss:  0.04868473797231107
    val rand:  0.062373376140991844
    val onPol:  0.060664817690849304

=== Epoch 20 ===
    train loss:  0.03654685203690786
    val rand:  0.04927926883101463
    val onPol:  0.051771800965070724

=== Epoch 30 ===
    train loss:  0.03048408096907912
    val rand:  0.042627679804960884
    val onPol:  0.047726213932037354

=== Epoch 39 ===
    train loss:  0.027112817341411435
    val rand:  0.038954285283883415
    val onPol:  0.045537665486335754
Training duration: 5.22 s

#####################################
performing on-policy MPC rollouts... iter  2
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.12681637457404246
DONE TAKING  100  STEPS.
Total reward:  133.30575586128097
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.6525762946092896
DONE TAKING  100  STEPS.
Total reward:  109.45761826077354
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.33358501019827425
DONE TAKING  100  STEPS.
Total reward:  115.79271439519063
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.2599626697491033
DONE TAKING  100  STEPS.
Total reward:  137.0590593184698
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.24688173126169574
DONE TAKING  100  STEPS.
Total reward:  119.91098630534036
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.30932303455966204
DONE TAKING  100  STEPS.
Total reward:  123.57309444065064
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.4440096535237763
DONE TAKING  100  STEPS.
Total reward:  123.1647281510694
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.3360140687473183
DONE TAKING  100  STEPS.
Total reward:  122.16774498724853
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.08910402119200944
DONE TAKING  100  STEPS.
Total reward:  140.15287310313497
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.305443147635038
DONE TAKING  100  STEPS.
Total reward:  126.2617768356503
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.06946618289627712
DONE TAKING  100  STEPS.
Total reward:  122.82195813833992
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.6409701199390367
DONE TAKING  100  STEPS.
Total reward:  160.04177363257702
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.7883281509945116
DONE TAKING  100  STEPS.
Total reward:  127.12977356930017
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.6069302313357087
DONE TAKING  100  STEPS.
Total reward:  122.82984349554415
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.32849478047631525
DONE TAKING  100  STEPS.
Total reward:  144.74084208582553
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.6453543504494902
DONE TAKING  100  STEPS.
Total reward:  145.95705526060252
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.27251619500944874
DONE TAKING  100  STEPS.
Total reward:  125.70202357640744
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.4731119088702628
DONE TAKING  100  STEPS.
Total reward:  117.05989190815043
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.2338757655118
DONE TAKING  100  STEPS.
Total reward:  115.14666297245442
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.5763066436710692
DONE TAKING  100  STEPS.
Total reward:  158.6559206707822
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.260669784058176
DONE TAKING  100  STEPS.
Total reward:  158.66513621454922
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.4792000745295009
DONE TAKING  100  STEPS.
Total reward:  115.96473127345573
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.3780165838779422
DONE TAKING  100  STEPS.
Total reward:  135.90051316401303
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.5742541247214904
DONE TAKING  38  STEPS.
Total reward:  38.41426168271213
Time for 1 rollout: 1.64 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.05730242987602391
DONE TAKING  100  STEPS.
Total reward:  112.90404502754906
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.6343043657017848
DONE TAKING  100  STEPS.
Total reward:  147.64118953233475
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.18184753895764755
DONE TAKING  100  STEPS.
Total reward:  147.5700381822329
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.9206820001133929
DONE TAKING  100  STEPS.
Total reward:  140.57357561439264
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.5251461146602692
DONE TAKING  100  STEPS.
Total reward:  148.04415758111642
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.07538411731354766
DONE TAKING  100  STEPS.
Total reward:  129.8491608041312
Time for 1 rollout: 4.27 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter2.ckpt

#####################################
Training the dynamics model..... iteration  3
#####################################

    amount of random data:  20000
    amount of onPol data:  7290

=== Epoch 0 ===
    train loss:  0.370573487598449
    val rand:  0.15391233563423157
    val onPol:  0.13630953431129456

=== Epoch 10 ===
    train loss:  0.053807376651093364
    val rand:  0.0612652525305748
    val onPol:  0.05715644359588623

=== Epoch 20 ===
    train loss:  0.040441072545945644
    val rand:  0.04726602261265119
    val onPol:  0.04623018950223923

=== Epoch 30 ===
    train loss:  0.0342914261855185
    val rand:  0.041032409916321434
    val onPol:  0.04214148223400116

=== Epoch 39 ===
    train loss:  0.03091771568870172
    val rand:  0.03752517327666283
    val onPol:  0.039439938962459564
Training duration: 4.57 s

#####################################
performing on-policy MPC rollouts... iter  3
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.8401992172448324
DONE TAKING  100  STEPS.
Total reward:  192.01818110709087
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.040590980972103514
DONE TAKING  100  STEPS.
Total reward:  174.90105849808296
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.36282518394947433
DONE TAKING  100  STEPS.
Total reward:  172.07442965391797
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -1.1053959307005428
DONE TAKING  100  STEPS.
Total reward:  166.7387770209646
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.517327844487655
DONE TAKING  100  STEPS.
Total reward:  177.98214579389366
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.7019076058451292
DONE TAKING  100  STEPS.
Total reward:  173.7707927803913
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.4881693551178926
DONE TAKING  100  STEPS.
Total reward:  130.43027279844387
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.9730666458415198
DONE TAKING  100  STEPS.
Total reward:  194.75988225783726
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -1.0575863591033023
DONE TAKING  100  STEPS.
Total reward:  162.6580809589137
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.04041892079458565
DONE TAKING  100  STEPS.
Total reward:  160.84046954766384
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.11567393559238236
DONE TAKING  100  STEPS.
Total reward:  175.27290821165863
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.89638203684359
DONE TAKING  100  STEPS.
Total reward:  164.09795068405234
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.4074501826917279
DONE TAKING  100  STEPS.
Total reward:  175.49739691099666
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.05691293344625148
DONE TAKING  100  STEPS.
Total reward:  185.59753597989697
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.191003175933809
DONE TAKING  100  STEPS.
Total reward:  193.1202959104818
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.12972767772799365
DONE TAKING  100  STEPS.
Total reward:  164.90159421820243
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.6864133418789999
DONE TAKING  100  STEPS.
Total reward:  1.6542962992582864
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.0787052824281961
DONE TAKING  100  STEPS.
Total reward:  176.7476096838682
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.6668510754896046
DONE TAKING  100  STEPS.
Total reward:  0.7401443030151471
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.6357458231956297
DONE TAKING  100  STEPS.
Total reward:  181.67581394993675
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.015126709022057878
DONE TAKING  100  STEPS.
Total reward:  151.9959519560827
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.4835035114334144
DONE TAKING  100  STEPS.
Total reward:  166.85949127673967
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.4999749902669199
DONE TAKING  100  STEPS.
Total reward:  148.6311699026944
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.0419264779255282
DONE TAKING  100  STEPS.
Total reward:  180.22248756198422
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.638986953539399
DONE TAKING  100  STEPS.
Total reward:  162.90650730097673
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.47164247633524164
DONE TAKING  100  STEPS.
Total reward:  198.71902789218095
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.8091909530184458
DONE TAKING  100  STEPS.
Total reward:  212.21915624529208
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.5789399413820381
DONE TAKING  100  STEPS.
Total reward:  154.85713085397612
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.3995392647798426
DONE TAKING  100  STEPS.
Total reward:  166.68209180839787
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.6952826980824203
DONE TAKING  100  STEPS.
Total reward:  169.01967202174805
Time for 1 rollout: 4.27 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter3.ckpt

#####################################
Training the dynamics model..... iteration  4
#####################################

    amount of random data:  20000
    amount of onPol data:  10017

=== Epoch 0 ===
    train loss:  0.32622487995869076
    val rand:  0.13638297468423843
    val onPol:  0.12265371531248093

=== Epoch 10 ===
    train loss:  0.048363054887606546
    val rand:  0.056626904755830765
    val onPol:  0.05116238445043564

=== Epoch 20 ===
    train loss:  0.037038200749800756
    val rand:  0.044418552269538246
    val onPol:  0.042497068643569946

=== Epoch 30 ===
    train loss:  0.03177094927582985
    val rand:  0.03866622472802798
    val onPol:  0.0387052446603775

=== Epoch 39 ===
    train loss:  0.028943564074161727
    val rand:  0.035532791167497635
    val onPol:  0.03661805018782616
Training duration: 5.55 s

#####################################
performing on-policy MPC rollouts... iter  4
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.7193473974898756
DONE TAKING  27  STEPS.
Total reward:  20.329679201728357
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.24272578507695874
DONE TAKING  40  STEPS.
Total reward:  29.306624423822004
Time for 1 rollout: 1.73 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.519299928769689
DONE TAKING  100  STEPS.
Total reward:  59.55133891732767
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.43220139117871925
DONE TAKING  100  STEPS.
Total reward:  191.86995275968545
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.22068658851106182
DONE TAKING  100  STEPS.
Total reward:  218.1770659834346
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.12200682557700777
DONE TAKING  100  STEPS.
Total reward:  215.15533918637632
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.5223596249758864
DONE TAKING  100  STEPS.
Total reward:  173.1525775438306
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.1927846591034766
DONE TAKING  100  STEPS.
Total reward:  221.01341125447843
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.8942675766179788
DONE TAKING  100  STEPS.
Total reward:  177.222048385612
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.8142020243652377
DONE TAKING  100  STEPS.
Total reward:  219.3307462421281
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.677811051650763
DONE TAKING  100  STEPS.
Total reward:  177.30225909871373
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.5236703492654063
DONE TAKING  100  STEPS.
Total reward:  258.2552303775446
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.5643475102850821
DONE TAKING  100  STEPS.
Total reward:  173.35293554804056
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.3911227861751741
DONE TAKING  32  STEPS.
Total reward:  27.152832673500203
Time for 1 rollout: 1.39 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.34611705261951986
DONE TAKING  100  STEPS.
Total reward:  52.22985112336947
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.614938360097044
DONE TAKING  100  STEPS.
Total reward:  218.72152578600534
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.8932579765975062
DONE TAKING  100  STEPS.
Total reward:  222.33411053268864
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.1667287233977532
DONE TAKING  100  STEPS.
Total reward:  237.93931187700423
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.09695236542715152
DONE TAKING  100  STEPS.
Total reward:  214.30239563747017
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.42340521457686414
DONE TAKING  100  STEPS.
Total reward:  227.5900948339903
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.5317438471414975
DONE TAKING  81  STEPS.
Total reward:  143.54457109546865
Time for 1 rollout: 3.50 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.2649325241384155
DONE TAKING  100  STEPS.
Total reward:  263.12366082206955
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -1.1673806883775704
DONE TAKING  100  STEPS.
Total reward:  208.59122618045933
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.28937965053257353
DONE TAKING  100  STEPS.
Total reward:  225.6255325251259
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.14788979514172898
DONE TAKING  100  STEPS.
Total reward:  214.3805467810823
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.49184047085843097
DONE TAKING  100  STEPS.
Total reward:  204.28890153765167
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.26578668932148203
DONE TAKING  100  STEPS.
Total reward:  203.0079515794741
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.49412296765623587
DONE TAKING  100  STEPS.
Total reward:  220.30625610859863
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.6067823335979577
DONE TAKING  100  STEPS.
Total reward:  214.91171563459514
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.9475175430478331
DONE TAKING  100  STEPS.
Total reward:  204.14460535003582
Time for 1 rollout: 4.28 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter4.ckpt

#####################################
Training the dynamics model..... iteration  5
#####################################

    amount of random data:  20000
    amount of onPol data:  12524

=== Epoch 0 ===
    train loss:  0.38416476398706434
    val rand:  0.15207674105962118
    val onPol:  0.14343547821044922

=== Epoch 10 ===
    train loss:  0.055162257576982184
    val rand:  0.05908181518316269
    val onPol:  0.05542246997356415

=== Epoch 20 ===
    train loss:  0.04189407688875993
    val rand:  0.045161500573158264
    val onPol:  0.04459455609321594

=== Epoch 30 ===
    train loss:  0.03598363411923249
    val rand:  0.03909204651912054
    val onPol:  0.040128860622644424

=== Epoch 39 ===
    train loss:  0.03293537298838298
    val rand:  0.035751101871331535
    val onPol:  0.03760869801044464
Training duration: 4.25 s

#####################################
performing on-policy MPC rollouts... iter  5
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -1.0594279122781525
DONE TAKING  100  STEPS.
Total reward:  263.8381150839383
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.03809948805588613
DONE TAKING  100  STEPS.
Total reward:  186.87642370613315
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.4246789630310651
DONE TAKING  100  STEPS.
Total reward:  208.6466870636415
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.29379326899474456
DONE TAKING  100  STEPS.
Total reward:  160.12431064718683
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.5520564416526139
DONE TAKING  100  STEPS.
Total reward:  166.48417589170094
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.7567996398658696
DONE TAKING  100  STEPS.
Total reward:  212.77870019795583
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.44133854138842965
DONE TAKING  100  STEPS.
Total reward:  160.7065038588922
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.24514608174464933
DONE TAKING  100  STEPS.
Total reward:  206.1469853662235
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.7971562445175262
DONE TAKING  100  STEPS.
Total reward:  199.64941802229455
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.15538951060351244
DONE TAKING  100  STEPS.
Total reward:  207.25876236906953
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -1.3571000103247826
DONE TAKING  100  STEPS.
Total reward:  189.87869567916616
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -1.2857363233729
DONE TAKING  100  STEPS.
Total reward:  217.75590213480123
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.5613502442417109
DONE TAKING  87  STEPS.
Total reward:  156.54646810823203
Time for 1 rollout: 3.75 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.29711577039418313
DONE TAKING  100  STEPS.
Total reward:  219.84171164795902
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.2579107403104812
DONE TAKING  100  STEPS.
Total reward:  164.58611636761256
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.5242746488404469
DONE TAKING  100  STEPS.
Total reward:  194.70946911086858
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.19410707343043573
DONE TAKING  100  STEPS.
Total reward:  184.17738427586636
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.979755279567197
DONE TAKING  100  STEPS.
Total reward:  211.6832986819833
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.9121882511104278
DONE TAKING  24  STEPS.
Total reward:  10.398511578463042
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.2124219094977532
DONE TAKING  100  STEPS.
Total reward:  187.06315675287522
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.6071178067721705
DONE TAKING  100  STEPS.
Total reward:  226.76455790431166
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.16959078179472817
DONE TAKING  100  STEPS.
Total reward:  223.50877710918826
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.2844064274719117
DONE TAKING  100  STEPS.
Total reward:  197.79132985401603
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.3996809503777484
DONE TAKING  100  STEPS.
Total reward:  172.72534022036407
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.4076516201314919
DONE TAKING  100  STEPS.
Total reward:  220.99685927404067
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.6006876415873827
DONE TAKING  100  STEPS.
Total reward:  216.42523368428053
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.33202519520232526
DONE TAKING  100  STEPS.
Total reward:  216.38752308054404
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.6146816712838409
DONE TAKING  100  STEPS.
Total reward:  231.59553506226757
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.2442901179742777
DONE TAKING  100  STEPS.
Total reward:  172.59004944234286
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.0824452737837185
DONE TAKING  100  STEPS.
Total reward:  150.3832325731559
Time for 1 rollout: 4.32 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
15.714885139007638
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.7886489331286703
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter5.ckpt

#####################################
Training the dynamics model..... iteration  6
#####################################

    amount of random data:  20000
    amount of onPol data:  15162

=== Epoch 0 ===
    train loss:  0.3654862129512955
    val rand:  0.14238661030928293
    val onPol:  0.14414598047733307

=== Epoch 10 ===
    train loss:  0.0528334711185273
    val rand:  0.05655617639422417
    val onPol:  0.05452851951122284

=== Epoch 20 ===
    train loss:  0.040398584788336474
    val rand:  0.04355832189321518
    val onPol:  0.04341336339712143

=== Epoch 30 ===
    train loss:  0.034905007218613344
    val rand:  0.037859346717596054
    val onPol:  0.0389033667743206

=== Epoch 39 ===
    train loss:  0.03201814351932091
    val rand:  0.03508473808566729
    val onPol:  0.03660152107477188
Training duration: 4.78 s

#####################################
performing on-policy MPC rollouts... iter  6
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.13349655243200753
DONE TAKING  100  STEPS.
Total reward:  218.8764723576964
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.10974574329029263
DONE TAKING  100  STEPS.
Total reward:  201.0826724040292
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.08441519124601975
DONE TAKING  14  STEPS.
Total reward:  9.370877481177809
Time for 1 rollout: 0.61 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.9233480427624151
DONE TAKING  100  STEPS.
Total reward:  235.71872150474363
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.9846874937455249
DONE TAKING  100  STEPS.
Total reward:  220.48254399778025
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.7769132826230529
DONE TAKING  100  STEPS.
Total reward:  200.32332347211698
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.4085190000649518
DONE TAKING  100  STEPS.
Total reward:  215.5959753399806
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.7685444230699646
DONE TAKING  100  STEPS.
Total reward:  258.7322047604089
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.449796634449899
DONE TAKING  44  STEPS.
Total reward:  84.32494496358994
Time for 1 rollout: 1.90 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.2703982807051485
DONE TAKING  98  STEPS.
Total reward:  216.39759759670815
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.3817832050059153
DONE TAKING  100  STEPS.
Total reward:  233.96150344503624
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.7710401970210938
DONE TAKING  100  STEPS.
Total reward:  233.62208809368775
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.8533375883461605
DONE TAKING  100  STEPS.
Total reward:  117.09543305263273
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.30848985826750536
DONE TAKING  100  STEPS.
Total reward:  195.1697845019431
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.9715550900300878
DONE TAKING  100  STEPS.
Total reward:  204.37261192298496
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.7661291631256875
DONE TAKING  100  STEPS.
Total reward:  202.2079665678264
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.3061842462381852
DONE TAKING  100  STEPS.
Total reward:  202.3362850036489
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.11242349912967939
DONE TAKING  100  STEPS.
Total reward:  226.42650625553347
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.35279700820548704
DONE TAKING  100  STEPS.
Total reward:  124.0188151206001
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.24780332224672436
DONE TAKING  42  STEPS.
Total reward:  53.17910921823925
Time for 1 rollout: 1.80 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.11784031391982108
DONE TAKING  100  STEPS.
Total reward:  258.6831245134677
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.5094902470882126
DONE TAKING  100  STEPS.
Total reward:  237.06687916679243
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.7679920121692534
DONE TAKING  100  STEPS.
Total reward:  247.62351471059642
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.6004394438288699
DONE TAKING  100  STEPS.
Total reward:  216.68551594264224
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.07765027970727131
DONE TAKING  96  STEPS.
Total reward:  188.71526106028347
Time for 1 rollout: 4.13 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.1807826835576005
DONE TAKING  72  STEPS.
Total reward:  127.80721772673942
Time for 1 rollout: 3.08 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.791124584487232
DONE TAKING  100  STEPS.
Total reward:  239.68740804927884
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.5368813500425696
DONE TAKING  100  STEPS.
Total reward:  204.28787950338216
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.67358490365049
DONE TAKING  100  STEPS.
Total reward:  219.9916895720131
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.0004688642858497
DONE TAKING  100  STEPS.
Total reward:  218.89182389477799
Time for 1 rollout: 4.31 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter6.ckpt

#####################################
Training the dynamics model..... iteration  7
#####################################

    amount of random data:  20000
    amount of onPol data:  17655

=== Epoch 0 ===
    train loss:  0.3574963836251078
    val rand:  0.13710998247067133
    val onPol:  0.13203035295009613

=== Epoch 10 ===
    train loss:  0.050822090860959644
    val rand:  0.05467341591914495
    val onPol:  0.05033717304468155

=== Epoch 20 ===
    train loss:  0.039263301805869955
    val rand:  0.04255806282162666
    val onPol:  0.0409109853208065

=== Epoch 30 ===
    train loss:  0.0341300242454619
    val rand:  0.03733018909891447
    val onPol:  0.03718151897192001

=== Epoch 39 ===
    train loss:  0.031343874597066154
    val rand:  0.03442422424753507
    val onPol:  0.034587908536195755
Training duration: 5.26 s

#####################################
performing on-policy MPC rollouts... iter  7
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.17327694596753876
DONE TAKING  100  STEPS.
Total reward:  192.03932080608251
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.686592707869207
DONE TAKING  100  STEPS.
Total reward:  260.55912790199926
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.233668722457121
DONE TAKING  100  STEPS.
Total reward:  141.90545053923265
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.18617574125865402
DONE TAKING  100  STEPS.
Total reward:  192.2964096282565
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.989179379369123
DONE TAKING  100  STEPS.
Total reward:  239.4367900860595
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.5282319161236215
DONE TAKING  71  STEPS.
Total reward:  85.47590648602043
Time for 1 rollout: 3.05 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.4323938526675457
DONE TAKING  100  STEPS.
Total reward:  238.65437481980013
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.28739843570021245
DONE TAKING  100  STEPS.
Total reward:  214.11185568947823
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.40381449576359707
DONE TAKING  100  STEPS.
Total reward:  212.50969715211673
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.4842494916017418
DONE TAKING  100  STEPS.
Total reward:  220.58508476872774
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.15815034272513295
DONE TAKING  100  STEPS.
Total reward:  250.34830294550548
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.29572606542157065
DONE TAKING  100  STEPS.
Total reward:  230.76903508780927
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.374285629339173
DONE TAKING  100  STEPS.
Total reward:  158.36940170610816
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.35063423292043505
DONE TAKING  100  STEPS.
Total reward:  215.26608317168376
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.5327754365299805
DONE TAKING  41  STEPS.
Total reward:  50.75493747327609
Time for 1 rollout: 1.76 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.31425930184964473
DONE TAKING  100  STEPS.
Total reward:  250.39943948138267
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.4979928229760272
DONE TAKING  100  STEPS.
Total reward:  214.9421756611455
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.085412948677657
DONE TAKING  100  STEPS.
Total reward:  213.57279541530121
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.03508564633951283
DONE TAKING  100  STEPS.
Total reward:  231.12357197876756
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.6965721452331077
DONE TAKING  100  STEPS.
Total reward:  210.00573930922178
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.44774769182216634
DONE TAKING  100  STEPS.
Total reward:  276.9814615684987
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.5122754351752004
DONE TAKING  100  STEPS.
Total reward:  173.97569782231025
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -1.4197451421470066
DONE TAKING  100  STEPS.
Total reward:  201.79621953051924
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.3648077010598159
DONE TAKING  100  STEPS.
Total reward:  245.6543641396852
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.5905395395916724
DONE TAKING  100  STEPS.
Total reward:  198.76339253980436
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.01548612012127204
DONE TAKING  28  STEPS.
Total reward:  7.598592083977779
Time for 1 rollout: 1.20 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.6797990717285224
DONE TAKING  100  STEPS.
Total reward:  144.10961856615103
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.1669811422347773
DONE TAKING  100  STEPS.
Total reward:  188.7522376658702
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.025856723306505507
DONE TAKING  100  STEPS.
Total reward:  174.74490968851663
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.44785277077432284
DONE TAKING  100  STEPS.
Total reward:  81.84357892166679
Time for 1 rollout: 4.29 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter7.ckpt

#####################################
Training the dynamics model..... iteration  8
#####################################

    amount of random data:  20000
    amount of onPol data:  20222

=== Epoch 0 ===
    train loss:  0.3328435486409722
    val rand:  0.1293476695815722
    val onPol:  0.12110160291194916

=== Epoch 10 ===
    train loss:  0.04959160434763606
    val rand:  0.05239486818512281
    val onPol:  0.047595612704753876

=== Epoch 20 ===
    train loss:  0.038379606586403964
    val rand:  0.0404676819841067
    val onPol:  0.039196476340293884

=== Epoch 30 ===
    train loss:  0.03353827128686556
    val rand:  0.035641998052597046
    val onPol:  0.035311877727508545

=== Epoch 39 ===
    train loss:  0.030770216773195965
    val rand:  0.03302432348330816
    val onPol:  0.03308441489934921
Training duration: 5.83 s

#####################################
performing on-policy MPC rollouts... iter  8
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.2862723633973198
DONE TAKING  100  STEPS.
Total reward:  223.51329142647543
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.369097089350274
DONE TAKING  100  STEPS.
Total reward:  278.0384973050879
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.5789416505491353
DONE TAKING  100  STEPS.
Total reward:  243.029460051737
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.2041489880686015
DONE TAKING  100  STEPS.
Total reward:  203.58468419930466
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.4452280044602375
DONE TAKING  100  STEPS.
Total reward:  243.7571973786043
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.6470943417818148
DONE TAKING  100  STEPS.
Total reward:  283.91134206707613
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.1639410863043666
DONE TAKING  100  STEPS.
Total reward:  245.31472759562843
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.0906274681040557
DONE TAKING  100  STEPS.
Total reward:  273.8933446321029
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.7309114301580075
DONE TAKING  100  STEPS.
Total reward:  259.11193591247843
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.03884589430648479
DONE TAKING  100  STEPS.
Total reward:  223.96406881262396
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.20414715551421167
DONE TAKING  100  STEPS.
Total reward:  262.62371806294897
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.12911419658116757
DONE TAKING  100  STEPS.
Total reward:  266.358314652008
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.28560693323421404
DONE TAKING  100  STEPS.
Total reward:  242.53915825591486
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.792985274204151
DONE TAKING  100  STEPS.
Total reward:  294.172021036332
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.5021058934703007
DONE TAKING  100  STEPS.
Total reward:  274.60735050060606
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.0016451551350240706
DONE TAKING  100  STEPS.
Total reward:  197.26161705160547
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.6708769756811421
DONE TAKING  100  STEPS.
Total reward:  238.02701515994028
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.8272049939700623
DONE TAKING  100  STEPS.
Total reward:  253.01724834231592
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.019907658678172936
DONE TAKING  100  STEPS.
Total reward:  254.53499198588213
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.052713537074799144
DONE TAKING  19  STEPS.
Total reward:  6.301912415897714
Time for 1 rollout: 0.86 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.3192412198369953
DONE TAKING  100  STEPS.
Total reward:  237.6736251209234
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.0036137590249648993
DONE TAKING  100  STEPS.
Total reward:  243.89110773602664
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.8169640045903316
DONE TAKING  100  STEPS.
Total reward:  267.258667819689
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.0171089842730177
DONE TAKING  100  STEPS.
Total reward:  208.2980250817927
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.6872128756351192
DONE TAKING  100  STEPS.
Total reward:  262.4263648120959
Time for 1 rollout: 4.47 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.0798788174466762
DONE TAKING  100  STEPS.
Total reward:  293.021616822976
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.39975215557979926
DONE TAKING  100  STEPS.
Total reward:  264.58189764239046
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.43557410687299314
DONE TAKING  100  STEPS.
Total reward:  239.32665025621898
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.6441784347752161
DONE TAKING  100  STEPS.
Total reward:  295.4646556131396
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.49649370552214467
DONE TAKING  100  STEPS.
Total reward:  279.1930669745047
Time for 1 rollout: 4.30 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter8.ckpt

#####################################
Training the dynamics model..... iteration  9
#####################################

    amount of random data:  20000
    amount of onPol data:  22868

=== Epoch 0 ===
    train loss:  0.29605745358599556
    val rand:  0.11947796245416005
    val onPol:  0.1092449277639389

=== Epoch 10 ===
    train loss:  0.04671401273873117
    val rand:  0.048603626588980355
    val onPol:  0.04383721947669983

=== Epoch 20 ===
    train loss:  0.03667812604043219
    val rand:  0.03843439991275469
    val onPol:  0.036095425486564636

=== Epoch 30 ===
    train loss:  0.03206535710228814
    val rand:  0.03398482998212179
    val onPol:  0.0324489027261734

=== Epoch 39 ===
    train loss:  0.02933579927517308
    val rand:  0.03161147547264894
    val onPol:  0.03022310510277748
Training duration: 6.82 s

#####################################
performing on-policy MPC rollouts... iter  9
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.460375224872973
DONE TAKING  100  STEPS.
Total reward:  308.433988505952
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.114521636828854
DONE TAKING  100  STEPS.
Total reward:  335.102154330299
Time for 1 rollout: 4.50 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7026665365144983
DONE TAKING  100  STEPS.
Total reward:  250.35156498511827
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.6534396786665579
DONE TAKING  100  STEPS.
Total reward:  242.48672063608237
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.18901310893071155
DONE TAKING  100  STEPS.
Total reward:  329.523169290814
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.6616774945157984
DONE TAKING  100  STEPS.
Total reward:  282.594311627247
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.3349113769206383
DONE TAKING  42  STEPS.
Total reward:  61.787158026327766
Time for 1 rollout: 1.94 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5328543689956842
DONE TAKING  100  STEPS.
Total reward:  297.833816831618
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.35128145370247743
DONE TAKING  100  STEPS.
Total reward:  291.39288981648923
Time for 1 rollout: 4.54 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.10557247307876164
DONE TAKING  100  STEPS.
Total reward:  283.09925326928703
Time for 1 rollout: 4.42 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -1.2007345827286626
DONE TAKING  100  STEPS.
Total reward:  213.7385755266222
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.31336215280629176
DONE TAKING  100  STEPS.
Total reward:  301.0720969535818
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.7541032254961882
DONE TAKING  100  STEPS.
Total reward:  286.7787483982008
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.3027870283086938
DONE TAKING  100  STEPS.
Total reward:  309.9127157495428
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.06020841957639171
DONE TAKING  100  STEPS.
Total reward:  280.087725129623
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.2398593891128753
DONE TAKING  100  STEPS.
Total reward:  197.29583876593722
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.7455630681593316
DONE TAKING  100  STEPS.
Total reward:  250.9839602237399
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.153771856912379
DONE TAKING  35  STEPS.
Total reward:  13.112149916046285
Time for 1 rollout: 1.52 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.20612781334955405
DONE TAKING  100  STEPS.
Total reward:  289.5158070401709
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.10385074129518777
DONE TAKING  100  STEPS.
Total reward:  263.8349319877729
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.5393459876112111
DONE TAKING  100  STEPS.
Total reward:  298.7780237191068
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.7242047903809298
DONE TAKING  100  STEPS.
Total reward:  296.5612045775159
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.42870620544710675
DONE TAKING  100  STEPS.
Total reward:  270.40412652676355
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.6055530906622328
DONE TAKING  100  STEPS.
Total reward:  256.06400258502015
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.297176060967528
DONE TAKING  100  STEPS.
Total reward:  281.5930003135978
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.4845416659379543
DONE TAKING  100  STEPS.
Total reward:  322.99670333722315
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.5588258706353988
DONE TAKING  100  STEPS.
Total reward:  291.3522088558441
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.23879993970569682
DONE TAKING  100  STEPS.
Total reward:  292.5509367699123
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.8335541551217863
DONE TAKING  100  STEPS.
Total reward:  308.3257800320254
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.7073987844808829
DONE TAKING  100  STEPS.
Total reward:  300.63083580766823
Time for 1 rollout: 4.46 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter9.ckpt

#####################################
Training the dynamics model..... iteration  10
#####################################

    amount of random data:  20000
    amount of onPol data:  25472

=== Epoch 0 ===
    train loss:  0.35659351758658886
    val rand:  0.13113942245642343
    val onPol:  0.13178883492946625

=== Epoch 10 ===
    train loss:  0.053191360901109874
    val rand:  0.051857009530067444
    val onPol:  0.050309114158153534

=== Epoch 20 ===
    train loss:  0.04090335895307362
    val rand:  0.03971507648626963
    val onPol:  0.040425803512334824

=== Epoch 30 ===
    train loss:  0.035541371209546924
    val rand:  0.03454836085438728
    val onPol:  0.03583498299121857

=== Epoch 39 ===
    train loss:  0.032600187754724175
    val rand:  0.03258350367347399
    val onPol:  0.03395368903875351
Training duration: 6.42 s

#####################################
performing on-policy MPC rollouts... iter  10
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.21154129845158207
DONE TAKING  27  STEPS.
Total reward:  14.39514987207258
Time for 1 rollout: 1.25 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.046789866564224056
DONE TAKING  100  STEPS.
Total reward:  282.2373027517251
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.23921716355488545
DONE TAKING  100  STEPS.
Total reward:  260.98797578430407
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.47501624934247344
DONE TAKING  100  STEPS.
Total reward:  250.83072953364632
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.46356485254348817
DONE TAKING  100  STEPS.
Total reward:  268.407498402805
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.7966127895147658
DONE TAKING  100  STEPS.
Total reward:  249.05405776165432
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.010805133814774479
DONE TAKING  100  STEPS.
Total reward:  267.37016672804265
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.08560474077255714
DONE TAKING  100  STEPS.
Total reward:  26.993792042070353
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.11932938750346445
DONE TAKING  100  STEPS.
Total reward:  144.7113933687792
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.23659981634202332
DONE TAKING  100  STEPS.
Total reward:  245.72291541586588
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.12658541817643032
DONE TAKING  100  STEPS.
Total reward:  257.8169523896971
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.2597007340098691
DONE TAKING  100  STEPS.
Total reward:  209.33015279237085
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.4505820174653001
DONE TAKING  80  STEPS.
Total reward:  168.06643889474904
Time for 1 rollout: 3.40 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.0811449307519067
DONE TAKING  100  STEPS.
Total reward:  205.23937501381508
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.0281063020856789
DONE TAKING  100  STEPS.
Total reward:  196.28056527582967
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.4756000760714223
DONE TAKING  100  STEPS.
Total reward:  283.5064413369649
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.8621813002264864
DONE TAKING  100  STEPS.
Total reward:  202.90565476675314
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.5606025614331793
DONE TAKING  75  STEPS.
Total reward:  147.99356662119658
Time for 1 rollout: 3.20 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.4536484800320579
DONE TAKING  100  STEPS.
Total reward:  264.1338340605417
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.21956165361904462
DONE TAKING  100  STEPS.
Total reward:  176.2504597184868
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.0868106124607409
DONE TAKING  100  STEPS.
Total reward:  210.45921858722429
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.20849638850218374
DONE TAKING  100  STEPS.
Total reward:  280.0739347839446
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.7913343699563768
DONE TAKING  83  STEPS.
Total reward:  143.05256021170618
Time for 1 rollout: 3.52 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.8246571584910845
DONE TAKING  71  STEPS.
Total reward:  171.8128701969071
Time for 1 rollout: 3.00 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.8522511475720175
DONE TAKING  100  STEPS.
Total reward:  280.9575303391455
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.5055547289909054
DONE TAKING  100  STEPS.
Total reward:  221.72538527838628
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.8411980778032339
DONE TAKING  23  STEPS.
Total reward:  13.595656722290359
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.47846433918216236
DONE TAKING  100  STEPS.
Total reward:  251.96336174727517
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.24315305083956887
DONE TAKING  100  STEPS.
Total reward:  224.55949695298239
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.38780295558114414
DONE TAKING  100  STEPS.
Total reward:  278.7181185473312
Time for 1 rollout: 4.22 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
13.45623263127849
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.7015097189196757
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter10.ckpt

#####################################
Training the dynamics model..... iteration  11
#####################################

    amount of random data:  20000
    amount of onPol data:  27958

=== Epoch 0 ===
    train loss:  0.3530895249808536
    val rand:  0.13155531883239746
    val onPol:  0.14582113921642303

=== Epoch 10 ===
    train loss:  0.05520378338063464
    val rand:  0.053006529808044434
    val onPol:  0.05612948164343834

=== Epoch 20 ===
    train loss:  0.04286782651701394
    val rand:  0.040831307570139565
    val onPol:  0.04500110074877739

=== Epoch 30 ===
    train loss:  0.036972506738760895
    val rand:  0.035587938502430916
    val onPol:  0.039575522765517235

=== Epoch 39 ===
    train loss:  0.03389346194179619
    val rand:  0.03271888196468353
    val onPol:  0.036951929330825806
Training duration: 4.86 s

#####################################
performing on-policy MPC rollouts... iter  11
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -1.4463229419793064
DONE TAKING  100  STEPS.
Total reward:  227.7908063156767
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.5175546093658507
DONE TAKING  100  STEPS.
Total reward:  247.67692116705467
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.2911766844576539
DONE TAKING  100  STEPS.
Total reward:  196.1344895956809
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.05961481122174058
DONE TAKING  100  STEPS.
Total reward:  190.84339951854602
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.20872425504453446
DONE TAKING  100  STEPS.
Total reward:  225.28859631503846
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.9746090030497635
DONE TAKING  100  STEPS.
Total reward:  242.27539320919436
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.01860599268989148
DONE TAKING  100  STEPS.
Total reward:  204.35067157073365
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.43850964962666605
DONE TAKING  100  STEPS.
Total reward:  243.15734891582753
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -1.6450572127156329
DONE TAKING  100  STEPS.
Total reward:  251.07822921627903
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.1386827419154576
DONE TAKING  100  STEPS.
Total reward:  89.9433194336948
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.3906168123014784
DONE TAKING  100  STEPS.
Total reward:  227.62624005282586
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.05687632495588098
DONE TAKING  100  STEPS.
Total reward:  226.80947485510865
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.9376660099971352
DONE TAKING  100  STEPS.
Total reward:  185.1820739791872
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.3534584645744027
DONE TAKING  100  STEPS.
Total reward:  244.24452235548526
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.6493269500736533
DONE TAKING  100  STEPS.
Total reward:  270.5776606637639
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.711760206154236
DONE TAKING  100  STEPS.
Total reward:  246.03762281033258
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.914978495368108
DONE TAKING  100  STEPS.
Total reward:  215.83414933035098
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.14645180064547242
DONE TAKING  100  STEPS.
Total reward:  226.07202027624768
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.047813338630381064
DONE TAKING  100  STEPS.
Total reward:  240.66522308739192
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.3573673928306022
DONE TAKING  100  STEPS.
Total reward:  229.27457901332576
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.23910705098213975
DONE TAKING  100  STEPS.
Total reward:  237.86290054183868
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.2738652901246257
DONE TAKING  100  STEPS.
Total reward:  210.93150993097132
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -1.3558330225861839
DONE TAKING  100  STEPS.
Total reward:  219.01092043405893
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.703916522456044
DONE TAKING  100  STEPS.
Total reward:  227.27012398684235
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.5510101428653891
DONE TAKING  100  STEPS.
Total reward:  255.6600397391605
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.945284418255198
DONE TAKING  100  STEPS.
Total reward:  254.64867283900188
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.25853016947266766
DONE TAKING  100  STEPS.
Total reward:  192.5473118275428
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.0185252891499135
DONE TAKING  100  STEPS.
Total reward:  259.93441453078174
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.23206532345731862
DONE TAKING  61  STEPS.
Total reward:  82.64341283199691
Time for 1 rollout: 2.59 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.4808413144488668
DONE TAKING  100  STEPS.
Total reward:  194.3733354341012
Time for 1 rollout: 4.24 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter11.ckpt

#####################################
Training the dynamics model..... iteration  12
#####################################

    amount of random data:  20000
    amount of onPol data:  30685

=== Epoch 0 ===
    train loss:  0.3596285987231467
    val rand:  0.12930249671141306
    val onPol:  0.14054343849420547

=== Epoch 10 ===
    train loss:  0.05411504581570625
    val rand:  0.05241050571203232
    val onPol:  0.05332258902490139

=== Epoch 20 ===
    train loss:  0.041462447597748704
    val rand:  0.03960624088843664
    val onPol:  0.04271432012319565

=== Epoch 30 ===
    train loss:  0.03594481168935696
    val rand:  0.03472172965606054
    val onPol:  0.03799168951809406

=== Epoch 39 ===
    train loss:  0.03291752877541714
    val rand:  0.032032170643409096
    val onPol:  0.03510377183556557
Training duration: 5.05 s

#####################################
performing on-policy MPC rollouts... iter  12
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.38843640576668464
DONE TAKING  100  STEPS.
Total reward:  251.7370512534789
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.2683756112972847
DONE TAKING  100  STEPS.
Total reward:  311.65981914365204
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.6522326751451795
DONE TAKING  100  STEPS.
Total reward:  269.5800307361823
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.09739014029261142
DONE TAKING  100  STEPS.
Total reward:  266.30210316990036
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.019205372814402127
DONE TAKING  100  STEPS.
Total reward:  275.1459666562399
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.3335432025169611
DONE TAKING  100  STEPS.
Total reward:  292.0052822025121
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.3919638915867077
DONE TAKING  100  STEPS.
Total reward:  236.35959520016456
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.32319117007659637
DONE TAKING  100  STEPS.
Total reward:  263.66265521603674
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.2508056668065024
DONE TAKING  100  STEPS.
Total reward:  321.35186318145287
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.6340814767345587
DONE TAKING  100  STEPS.
Total reward:  295.64752773740537
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.9114733175228239
DONE TAKING  100  STEPS.
Total reward:  267.6332062473964
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.19441251360231424
DONE TAKING  100  STEPS.
Total reward:  252.9448244711573
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.5201084081377833
DONE TAKING  100  STEPS.
Total reward:  263.3564157516907
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5836938605663635
DONE TAKING  100  STEPS.
Total reward:  285.1547262725285
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.4417104815103572
DONE TAKING  100  STEPS.
Total reward:  273.6888258767897
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.26181235275754444
DONE TAKING  100  STEPS.
Total reward:  301.116524609549
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.8756210339687047
DONE TAKING  100  STEPS.
Total reward:  271.4813926019062
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.5217418875614541
DONE TAKING  100  STEPS.
Total reward:  264.5769256767985
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.26031251440375
DONE TAKING  100  STEPS.
Total reward:  298.22960746378675
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.7850067232664859
DONE TAKING  100  STEPS.
Total reward:  252.58035128518887
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.015544244911951
DONE TAKING  100  STEPS.
Total reward:  283.6388108776928
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.2034310595948483
DONE TAKING  100  STEPS.
Total reward:  252.0852049705102
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.4108287388232844
DONE TAKING  100  STEPS.
Total reward:  297.28724248554215
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.45949769710477006
DONE TAKING  100  STEPS.
Total reward:  250.5383119913104
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.7396462369387828
DONE TAKING  100  STEPS.
Total reward:  285.23233294380475
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.27783302312261887
DONE TAKING  100  STEPS.
Total reward:  30.691678793987464
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.12638889084495705
DONE TAKING  100  STEPS.
Total reward:  109.55926401669794
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.3810695420658532
DONE TAKING  100  STEPS.
Total reward:  334.698543298878
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.8011601118303567
DONE TAKING  100  STEPS.
Total reward:  280.9365955818186
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.5807128213717893
DONE TAKING  100  STEPS.
Total reward:  11.529104073670384
Time for 1 rollout: 4.51 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter12.ckpt

#####################################
Training the dynamics model..... iteration  13
#####################################

    amount of random data:  20000
    amount of onPol data:  33412

=== Epoch 0 ===
    train loss:  0.3347929618076274
    val rand:  0.1245196262995402
    val onPol:  0.13217561691999435

=== Epoch 10 ===
    train loss:  0.05199965775797242
    val rand:  0.04983812943100929
    val onPol:  0.05078394338488579

=== Epoch 20 ===
    train loss:  0.040095504667413864
    val rand:  0.03840439890821775
    val onPol:  0.04095197655260563

=== Epoch 30 ===
    train loss:  0.03512172616626087
    val rand:  0.03391613935430845
    val onPol:  0.03656637482345104

=== Epoch 39 ===
    train loss:  0.03218466915974492
    val rand:  0.031734575827916466
    val onPol:  0.03417457640171051
Training duration: 5.51 s

#####################################
performing on-policy MPC rollouts... iter  13
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.4977705744450394
DONE TAKING  100  STEPS.
Total reward:  208.97087139723595
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.07175716007863939
DONE TAKING  100  STEPS.
Total reward:  286.6418848663519
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.09034132170786266
DONE TAKING  23  STEPS.
Total reward:  13.87203165250719
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.3753983888207075
DONE TAKING  100  STEPS.
Total reward:  275.2617457733266
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.1114190926204195
DONE TAKING  100  STEPS.
Total reward:  284.1797664128905
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.5378459018864734
DONE TAKING  100  STEPS.
Total reward:  240.2663953172605
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.5677926241985278
DONE TAKING  21  STEPS.
Total reward:  8.253281236531553
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.4241003998496614
DONE TAKING  100  STEPS.
Total reward:  245.91522970687535
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.846200511502025
DONE TAKING  19  STEPS.
Total reward:  13.000344629544552
Time for 1 rollout: 0.81 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.6238881880869737
DONE TAKING  100  STEPS.
Total reward:  204.4747134913662
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.3664174520025192
DONE TAKING  100  STEPS.
Total reward:  255.35795923738397
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.07849425398335044
DONE TAKING  100  STEPS.
Total reward:  229.60811992297104
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.9419798103916837
DONE TAKING  100  STEPS.
Total reward:  203.92407454518545
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.20223783006899418
DONE TAKING  100  STEPS.
Total reward:  298.2855756992559
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.835216745578816
DONE TAKING  100  STEPS.
Total reward:  216.86192019075295
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.7361409164129084
DONE TAKING  53  STEPS.
Total reward:  53.697223201178595
Time for 1 rollout: 2.27 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5708051913850475
DONE TAKING  100  STEPS.
Total reward:  15.25827741401711
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.8837739530690389
DONE TAKING  100  STEPS.
Total reward:  335.92957617152314
Time for 1 rollout: 4.50 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.4211605502100527
DONE TAKING  100  STEPS.
Total reward:  298.5752903120672
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.8029797413076581
DONE TAKING  100  STEPS.
Total reward:  272.9042385621038
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.3908521620702157
DONE TAKING  100  STEPS.
Total reward:  253.71815705059308
Time for 1 rollout: 4.89 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.06937978677200454
DONE TAKING  100  STEPS.
Total reward:  291.07352694289375
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.04155419898641163
DONE TAKING  100  STEPS.
Total reward:  269.43488590890394
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.20083643840141335
DONE TAKING  100  STEPS.
Total reward:  176.76463276257817
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.7056150419260753
DONE TAKING  100  STEPS.
Total reward:  236.2042454126488
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.626381686801804
DONE TAKING  100  STEPS.
Total reward:  271.46081105952385
Time for 1 rollout: 4.52 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.27884095746562754
DONE TAKING  100  STEPS.
Total reward:  269.78155240484625
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.04644462864073409
DONE TAKING  100  STEPS.
Total reward:  234.80192801796798
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.1903514944030495
DONE TAKING  50  STEPS.
Total reward:  37.22195196511782
Time for 1 rollout: 2.18 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.20683023094556113
DONE TAKING  100  STEPS.
Total reward:  287.39653800981296
Time for 1 rollout: 4.59 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter13.ckpt

#####################################
Training the dynamics model..... iteration  14
#####################################

    amount of random data:  20000
    amount of onPol data:  35855

=== Epoch 0 ===
    train loss:  0.31264483332633974
    val rand:  0.11971415579319
    val onPol:  0.12569813430309296

=== Epoch 10 ===
    train loss:  0.051695667766034605
    val rand:  0.04991171881556511
    val onPol:  0.05026141181588173

=== Epoch 20 ===
    train loss:  0.03979505803436041
    val rand:  0.03836845109860102
    val onPol:  0.04042636603116989

=== Epoch 30 ===
    train loss:  0.034867503214627504
    val rand:  0.03356423166890939
    val onPol:  0.03575660288333893

=== Epoch 39 ===
    train loss:  0.03207403514534235
    val rand:  0.03095281558732192
    val onPol:  0.033362507820129395
Training duration: 6.04 s

#####################################
performing on-policy MPC rollouts... iter  14
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.5180160406783749
DONE TAKING  100  STEPS.
Total reward:  284.6153300686082
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.431040925169282
DONE TAKING  100  STEPS.
Total reward:  277.1333372004715
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.233946466754349
DONE TAKING  100  STEPS.
Total reward:  285.42122414622224
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.16633722586528796
DONE TAKING  100  STEPS.
Total reward:  279.47763713324485
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.13216512756228
DONE TAKING  100  STEPS.
Total reward:  303.6977376555444
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.26899564127528375
DONE TAKING  100  STEPS.
Total reward:  289.908458223704
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.5897916978143046
DONE TAKING  96  STEPS.
Total reward:  278.39134095463913
Time for 1 rollout: 4.14 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.15796678337538422
DONE TAKING  100  STEPS.
Total reward:  300.29854380781165
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -1.1587339138697232
DONE TAKING  100  STEPS.
Total reward:  132.0701076303765
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.0422425790307537
DONE TAKING  100  STEPS.
Total reward:  246.34848851122993
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5236643519482261
DONE TAKING  100  STEPS.
Total reward:  279.4855567600902
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.2707143780040202
DONE TAKING  100  STEPS.
Total reward:  279.5827457072756
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -1.1522982864386022
DONE TAKING  100  STEPS.
Total reward:  232.08051275787966
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 13
done step  0 , rew:  1.0297271838217508
DONE TAKING  100  STEPS.
Total reward:  278.6908060282092
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.6310948501915982
DONE TAKING  100  STEPS.
Total reward:  323.294650860183
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.704618434694833
DONE TAKING  100  STEPS.
Total reward:  319.73531924869525
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.2341266700770582
DONE TAKING  100  STEPS.
Total reward:  247.10922044107855
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.12229930263401063
DONE TAKING  100  STEPS.
Total reward:  281.70827000154145
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.4509463248551968
DONE TAKING  100  STEPS.
Total reward:  7.028766403094389
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.730923049516261
DONE TAKING  100  STEPS.
Total reward:  262.4220731763216
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.4457638978818056
DONE TAKING  100  STEPS.
Total reward:  300.60857150925455
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.22672450015945678
DONE TAKING  100  STEPS.
Total reward:  266.21145305721654
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.350167011927187
DONE TAKING  100  STEPS.
Total reward:  255.23990083930244
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.4404560909844998
DONE TAKING  100  STEPS.
Total reward:  278.7152273750266
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.137791191936422
DONE TAKING  100  STEPS.
Total reward:  236.8630560518449
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.32443847244373036
DONE TAKING  100  STEPS.
Total reward:  286.52000402010685
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.014692930720212313
DONE TAKING  100  STEPS.
Total reward:  229.20167461084745
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.25761038964865557
DONE TAKING  100  STEPS.
Total reward:  247.05104109256834
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.7970057700959119
DONE TAKING  100  STEPS.
Total reward:  235.2180775428759
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.3046579574014565
DONE TAKING  100  STEPS.
Total reward:  274.4904321144798
Time for 1 rollout: 4.28 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter14.ckpt

#####################################
Training the dynamics model..... iteration  15
#####################################

    amount of random data:  20000
    amount of onPol data:  38578

=== Epoch 0 ===
    train loss:  0.30974342496622176
    val rand:  0.11680417756239574
    val onPol:  0.12213004380464554

=== Epoch 10 ===
    train loss:  0.049959917863210045
    val rand:  0.04812103509902954
    val onPol:  0.04802250675857067

=== Epoch 20 ===
    train loss:  0.03853161615275201
    val rand:  0.036911883701880775
    val onPol:  0.03855437971651554

=== Epoch 30 ===
    train loss:  0.03373051541192191
    val rand:  0.032398853451013565
    val onPol:  0.03444318659603596

=== Epoch 39 ===
    train loss:  0.030888472018497332
    val rand:  0.030358330657084782
    val onPol:  0.031855459325015545
Training duration: 8.64 s

#####################################
performing on-policy MPC rollouts... iter  15
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3144242475656023
DONE TAKING  100  STEPS.
Total reward:  286.0016169516965
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.3667829603230743
DONE TAKING  100  STEPS.
Total reward:  294.70158363629827
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.07267408958922894
DONE TAKING  100  STEPS.
Total reward:  307.879719877392
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.3895241643279031
DONE TAKING  100  STEPS.
Total reward:  272.95771601158424
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.6890761857323642
DONE TAKING  100  STEPS.
Total reward:  191.57968491032722
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.8666685869909289
DONE TAKING  100  STEPS.
Total reward:  266.3010903316614
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.32110183706152584
DONE TAKING  100  STEPS.
Total reward:  252.24683189549344
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.6623440969377686
DONE TAKING  100  STEPS.
Total reward:  234.37369568173787
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.31165338067478204
DONE TAKING  100  STEPS.
Total reward:  332.86915298638104
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.18741471299635087
DONE TAKING  100  STEPS.
Total reward:  214.168670748602
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5739418915995056
DONE TAKING  100  STEPS.
Total reward:  243.30841815485383
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.7914013661799008
DONE TAKING  100  STEPS.
Total reward:  185.49796930349197
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.11210071970168602
DONE TAKING  100  STEPS.
Total reward:  265.82397178294315
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.17541939759526995
DONE TAKING  100  STEPS.
Total reward:  327.34536393099137
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.4267651363497733
DONE TAKING  100  STEPS.
Total reward:  302.61363297708925
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.15169897079734287
DONE TAKING  100  STEPS.
Total reward:  268.40145390627674
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5075228990445171
DONE TAKING  100  STEPS.
Total reward:  279.6117892740495
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.2482812058841144
DONE TAKING  100  STEPS.
Total reward:  318.5726018728297
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.16635241608720236
DONE TAKING  100  STEPS.
Total reward:  220.1343994926444
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.357353979803536
DONE TAKING  100  STEPS.
Total reward:  297.86005984222254
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.3804449287710528
DONE TAKING  100  STEPS.
Total reward:  271.2912743520596
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.7451703073458236
DONE TAKING  100  STEPS.
Total reward:  199.2879170800958
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.4451846897281343
DONE TAKING  100  STEPS.
Total reward:  278.7469705495892
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.5178971292139822
DONE TAKING  100  STEPS.
Total reward:  275.36444725136454
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.9610982937398809
DONE TAKING  96  STEPS.
Total reward:  323.23484285859405
Time for 1 rollout: 4.07 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.508091503067237
DONE TAKING  100  STEPS.
Total reward:  311.26327835442385
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.8334223015391415
DONE TAKING  100  STEPS.
Total reward:  240.04401699588587
Time for 1 rollout: 4.56 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.6353228928673769
DONE TAKING  100  STEPS.
Total reward:  344.76870745670067
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.9852207715380314
DONE TAKING  100  STEPS.
Total reward:  292.5235699752267
Time for 1 rollout: 4.97 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.12727909075867566
DONE TAKING  100  STEPS.
Total reward:  290.1413500319499
Time for 1 rollout: 4.96 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
12.4909267707959
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.8228623693111603
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter15.ckpt

#####################################
Training the dynamics model..... iteration  16
#####################################

    amount of random data:  20000
    amount of onPol data:  41301

=== Epoch 0 ===
    train loss:  0.3201484117995609
    val rand:  0.11810908714930217
    val onPol:  0.11951635405421257

=== Epoch 10 ===
    train loss:  0.05111724857918241
    val rand:  0.049411424746116005
    val onPol:  0.04837554320693016

=== Epoch 20 ===
    train loss:  0.03951241905716332
    val rand:  0.03793849299351374
    val onPol:  0.039038052782416344

=== Epoch 30 ===
    train loss:  0.03421259857714176
    val rand:  0.03306329995393753
    val onPol:  0.03466641530394554

=== Epoch 39 ===
    train loss:  0.03123850654810667
    val rand:  0.030425197755297024
    val onPol:  0.03165734000504017
Training duration: 8.50 s

#####################################
performing on-policy MPC rollouts... iter  16
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.37963791713378225
DONE TAKING  100  STEPS.
Total reward:  295.05875495333385
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.42931759181873574
DONE TAKING  100  STEPS.
Total reward:  311.970162387934
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7942351972808119
DONE TAKING  100  STEPS.
Total reward:  296.4412602208384
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.3700892473330963
DONE TAKING  100  STEPS.
Total reward:  290.2126428045836
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.051809706015662774
DONE TAKING  100  STEPS.
Total reward:  319.359727793664
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.14179450977705077
DONE TAKING  100  STEPS.
Total reward:  296.70287463511403
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.6973790632819915
DONE TAKING  100  STEPS.
Total reward:  323.84188517384086
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.1746631459585106
DONE TAKING  100  STEPS.
Total reward:  280.6773369320843
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.14771287459834392
DONE TAKING  100  STEPS.
Total reward:  258.88201633268955
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.1812740017655914
DONE TAKING  100  STEPS.
Total reward:  268.2018599088972
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.44639612965147146
DONE TAKING  100  STEPS.
Total reward:  264.33906281424936
Time for 1 rollout: 4.93 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.7076246205339153
DONE TAKING  100  STEPS.
Total reward:  283.04341903926684
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -1.0943517524290778
DONE TAKING  100  STEPS.
Total reward:  314.75143810214604
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.8641314996026669
DONE TAKING  100  STEPS.
Total reward:  232.5368333796794
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.10664621263372784
DONE TAKING  100  STEPS.
Total reward:  279.9948795075032
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.1451096702557157
DONE TAKING  100  STEPS.
Total reward:  249.98035748680098
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.8642540584598737
DONE TAKING  100  STEPS.
Total reward:  309.1936212299935
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.3273484824459427
DONE TAKING  100  STEPS.
Total reward:  268.2050493538973
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.4068223606776099
DONE TAKING  100  STEPS.
Total reward:  278.2092324369013
Time for 1 rollout: 4.47 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.08649142724430359
DONE TAKING  100  STEPS.
Total reward:  288.45424291582884
Time for 1 rollout: 4.71 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.1425569513262415
DONE TAKING  100  STEPS.
Total reward:  289.7217646839451
Time for 1 rollout: 4.69 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.06985750846313724
DONE TAKING  100  STEPS.
Total reward:  220.52565146293335
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.8796382694409013
DONE TAKING  100  STEPS.
Total reward:  273.8568911740771
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.4140806494133433
DONE TAKING  100  STEPS.
Total reward:  291.9122870164076
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.5161863557365607
DONE TAKING  100  STEPS.
Total reward:  276.24195699066865
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.8709976436089151
DONE TAKING  100  STEPS.
Total reward:  290.11130646767515
Time for 1 rollout: 4.54 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.47103389063632817
DONE TAKING  100  STEPS.
Total reward:  262.88856806839385
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.2222451091431887
DONE TAKING  100  STEPS.
Total reward:  316.8137963631234
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -1.1755019751502451
DONE TAKING  100  STEPS.
Total reward:  309.0492548497425
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.1460693056004171
DONE TAKING  100  STEPS.
Total reward:  280.3013895556792
Time for 1 rollout: 4.30 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter16.ckpt

#####################################
Training the dynamics model..... iteration  17
#####################################

    amount of random data:  20000
    amount of onPol data:  44028

=== Epoch 0 ===
    train loss:  0.30246628950471466
    val rand:  0.11328015724817912
    val onPol:  0.12180701891581218

=== Epoch 10 ===
    train loss:  0.04927227524635584
    val rand:  0.047240053613980613
    val onPol:  0.049425963312387466

=== Epoch 20 ===
    train loss:  0.03813433485186618
    val rand:  0.036436172823111214
    val onPol:  0.03976902489860853

=== Epoch 30 ===
    train loss:  0.03343308684618577
    val rand:  0.0321763443450133
    val onPol:  0.03545239691932996

=== Epoch 39 ===
    train loss:  0.030566281962977802
    val rand:  0.029603872448205948
    val onPol:  0.032555693139632545
Training duration: 6.82 s

#####################################
performing on-policy MPC rollouts... iter  17
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.5696117027750989
DONE TAKING  100  STEPS.
Total reward:  304.0698774618098
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.9759578782001461
DONE TAKING  100  STEPS.
Total reward:  291.8143910511583
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.16877281259044538
DONE TAKING  100  STEPS.
Total reward:  294.5131576011904
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.02184547250951613
DONE TAKING  100  STEPS.
Total reward:  277.61030400349557
Time for 1 rollout: 4.42 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.604842383803688
DONE TAKING  100  STEPS.
Total reward:  301.48866233412434
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.5606449425005005
DONE TAKING  100  STEPS.
Total reward:  297.42707999173274
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.42608530326436045
DONE TAKING  100  STEPS.
Total reward:  315.72080847108913
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.39125821748052775
DONE TAKING  100  STEPS.
Total reward:  321.7058223814316
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.06083799414532533
DONE TAKING  100  STEPS.
Total reward:  318.764001533547
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.9151499420115434
DONE TAKING  100  STEPS.
Total reward:  283.52980602320764
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5412208805926959
DONE TAKING  100  STEPS.
Total reward:  275.70756966051215
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.2332391598540068
DONE TAKING  100  STEPS.
Total reward:  339.20487732489784
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.7465187509646687
DONE TAKING  100  STEPS.
Total reward:  267.1585429033461
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.8085151932793186
DONE TAKING  100  STEPS.
Total reward:  294.86205711579134
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.36021202595894924
DONE TAKING  100  STEPS.
Total reward:  242.5812651632123
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.11647727790234191
DONE TAKING  100  STEPS.
Total reward:  321.21046006823343
Time for 1 rollout: 4.42 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.7481340059483966
DONE TAKING  100  STEPS.
Total reward:  276.7116874818156
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.1242322214208498
DONE TAKING  100  STEPS.
Total reward:  286.11068520209784
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.46332843597803475
DONE TAKING  100  STEPS.
Total reward:  354.3026299694697
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.48643233303317407
DONE TAKING  100  STEPS.
Total reward:  307.08041534504935
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.1411290194790575
DONE TAKING  100  STEPS.
Total reward:  286.13718424618963
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.8322165681971058
DONE TAKING  100  STEPS.
Total reward:  334.6629257380959
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.28467522906306303
DONE TAKING  100  STEPS.
Total reward:  278.34961169001525
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.9754783035027675
DONE TAKING  100  STEPS.
Total reward:  254.7799154847502
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.1144360041852871
DONE TAKING  100  STEPS.
Total reward:  260.77610711585476
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.3868467929022103
DONE TAKING  100  STEPS.
Total reward:  289.58747290604947
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.553737206307303
DONE TAKING  100  STEPS.
Total reward:  334.93724440899643
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.0758363224163687
DONE TAKING  100  STEPS.
Total reward:  282.39538635365494
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.9775424951804697
DONE TAKING  100  STEPS.
Total reward:  290.055017354254
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.5384045101408982
DONE TAKING  100  STEPS.
Total reward:  274.63429629415845
Time for 1 rollout: 4.32 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter17.ckpt

#####################################
Training the dynamics model..... iteration  18
#####################################

    amount of random data:  20000
    amount of onPol data:  46755

=== Epoch 0 ===
    train loss:  0.29107530337447923
    val rand:  0.11148676027854283
    val onPol:  0.11887278407812119

=== Epoch 10 ===
    train loss:  0.04869280328663687
    val rand:  0.047133978456258774
    val onPol:  0.04831239953637123

=== Epoch 20 ===
    train loss:  0.037530413595959544
    val rand:  0.03637910385926565
    val onPol:  0.03871371721227964

=== Epoch 30 ===
    train loss:  0.032508308494774006
    val rand:  0.03191369026899338
    val onPol:  0.03427771913508574

=== Epoch 39 ===
    train loss:  0.029635368186670046
    val rand:  0.02913310130437215
    val onPol:  0.031261490657925606
Training duration: 8.24 s

#####################################
performing on-policy MPC rollouts... iter  18
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.05878581552027934
DONE TAKING  87  STEPS.
Total reward:  73.41980287284387
Time for 1 rollout: 3.79 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.10191249840931252
DONE TAKING  100  STEPS.
Total reward:  290.4780872734609
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.015347260030730309
DONE TAKING  100  STEPS.
Total reward:  322.65944493647845
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -1.3086795465899195
DONE TAKING  100  STEPS.
Total reward:  316.9715715667362
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.1871591603381109
DONE TAKING  100  STEPS.
Total reward:  71.08832512020136
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.15143870496644893
DONE TAKING  100  STEPS.
Total reward:  340.82792211785835
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.6523508405559364
DONE TAKING  100  STEPS.
Total reward:  289.5978098618919
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.7172356925443111
DONE TAKING  100  STEPS.
Total reward:  46.42522964716346
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.08164765102626115
DONE TAKING  100  STEPS.
Total reward:  299.28416655232087
Time for 1 rollout: 4.51 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.219549048722262
DONE TAKING  100  STEPS.
Total reward:  257.2411931358613
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.11628814914476238
DONE TAKING  100  STEPS.
Total reward:  180.5650128796926
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.13544659269901366
DONE TAKING  100  STEPS.
Total reward:  274.24271126440243
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.4441536185558912
DONE TAKING  100  STEPS.
Total reward:  339.4211416973112
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.10433063237647475
DONE TAKING  100  STEPS.
Total reward:  360.80162587970494
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.02141288910286642
DONE TAKING  100  STEPS.
Total reward:  262.7401406862111
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.05281783923517941
DONE TAKING  100  STEPS.
Total reward:  312.5945780806104
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.3838156189133166
DONE TAKING  100  STEPS.
Total reward:  343.43729294445404
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.5296447985900545
DONE TAKING  100  STEPS.
Total reward:  12.112866359875884
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.143252528798726
DONE TAKING  100  STEPS.
Total reward:  322.98395617403634
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.8923089773597915
DONE TAKING  100  STEPS.
Total reward:  299.2238316680804
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.012097767381606554
DONE TAKING  100  STEPS.
Total reward:  317.0169733408438
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.3152145073866291
DONE TAKING  100  STEPS.
Total reward:  254.93411896042173
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.36946568681468556
DONE TAKING  100  STEPS.
Total reward:  309.55763051374896
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.0397265684859551
DONE TAKING  100  STEPS.
Total reward:  332.7150294827018
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.905462506168134
DONE TAKING  100  STEPS.
Total reward:  283.6073356993411
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.4837778825441109
DONE TAKING  100  STEPS.
Total reward:  324.7504118369964
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.6163286617458988
DONE TAKING  100  STEPS.
Total reward:  9.876750494779026
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.05454826814245106
DONE TAKING  100  STEPS.
Total reward:  307.27269812679225
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.17340484960929545
DONE TAKING  100  STEPS.
Total reward:  328.5900164562803
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.8760292453388896
DONE TAKING  89  STEPS.
Total reward:  310.8174943464714
Time for 1 rollout: 3.82 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter18.ckpt

#####################################
Training the dynamics model..... iteration  19
#####################################

    amount of random data:  20000
    amount of onPol data:  49469

=== Epoch 0 ===
    train loss:  0.2654984164237976
    val rand:  0.10653967161973317
    val onPol:  0.11035278191169103

=== Epoch 10 ===
    train loss:  0.04664498634636402
    val rand:  0.04498612880706787
    val onPol:  0.04576292261481285

=== Epoch 20 ===
    train loss:  0.036395253390073774
    val rand:  0.03521911675731341
    val onPol:  0.03724565108617147

=== Epoch 30 ===
    train loss:  0.03168306235224008
    val rand:  0.030952775850892067
    val onPol:  0.032671509931484856

=== Epoch 39 ===
    train loss:  0.02901769172400236
    val rand:  0.02880895882844925
    val onPol:  0.030363236243526142
Training duration: 8.65 s

#####################################
performing on-policy MPC rollouts... iter  19
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.6120343768883261
DONE TAKING  100  STEPS.
Total reward:  283.598619419331
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.3319216443238904
DONE TAKING  100  STEPS.
Total reward:  324.7488908116589
Time for 1 rollout: 4.64 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.357034903095466
DONE TAKING  100  STEPS.
Total reward:  234.0333612448409
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.22317672802650668
DONE TAKING  100  STEPS.
Total reward:  285.4939609959361
Time for 1 rollout: 4.89 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.36928332946655196
DONE TAKING  100  STEPS.
Total reward:  300.71398309220115
Time for 1 rollout: 4.80 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.8982181840706289
DONE TAKING  100  STEPS.
Total reward:  287.3510929391234
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.43336720168657245
DONE TAKING  100  STEPS.
Total reward:  301.04579468633744
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5488577136143884
DONE TAKING  100  STEPS.
Total reward:  330.6556195894091
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -1.3865842013621588
DONE TAKING  100  STEPS.
Total reward:  269.12055839728805
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.3968514974297601
DONE TAKING  100  STEPS.
Total reward:  279.7740283543862
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.3396764043317651
DONE TAKING  100  STEPS.
Total reward:  255.32619739251652
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.11269360796628515
DONE TAKING  100  STEPS.
Total reward:  264.6015865485242
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.13933537694640927
DONE TAKING  100  STEPS.
Total reward:  314.20759547285877
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.265028544228312
DONE TAKING  100  STEPS.
Total reward:  311.4745703390873
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.2452132349100627
DONE TAKING  56  STEPS.
Total reward:  36.8301617641007
Time for 1 rollout: 2.44 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.8957023136972679
DONE TAKING  100  STEPS.
Total reward:  205.10571631246378
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.1315915232908274
DONE TAKING  100  STEPS.
Total reward:  317.8526874432017
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.045040463166082734
DONE TAKING  100  STEPS.
Total reward:  283.7561052729318
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.13988094310124716
DONE TAKING  100  STEPS.
Total reward:  317.50525442269685
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.14745258862423655
DONE TAKING  100  STEPS.
Total reward:  286.0842048239539
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.05370785907412
DONE TAKING  100  STEPS.
Total reward:  265.6388598678392
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.22893575385196757
DONE TAKING  100  STEPS.
Total reward:  295.98150085398913
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.4124210654620145
DONE TAKING  100  STEPS.
Total reward:  326.13172206155843
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.05006954136048261
DONE TAKING  100  STEPS.
Total reward:  295.48380411460016
Time for 1 rollout: 4.96 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.43963225904811926
DONE TAKING  100  STEPS.
Total reward:  317.19354981805304
Time for 1 rollout: 4.94 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.8893005282376674
DONE TAKING  100  STEPS.
Total reward:  304.6649841447483
Time for 1 rollout: 4.94 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.5291639763729196
DONE TAKING  100  STEPS.
Total reward:  289.4704487473483
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.9878587322792106
DONE TAKING  100  STEPS.
Total reward:  250.74027762863614
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.6921910868257167
DONE TAKING  100  STEPS.
Total reward:  289.336374464113
Time for 1 rollout: 4.94 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.41723170773370677
DONE TAKING  100  STEPS.
Total reward:  274.87573891629813
Time for 1 rollout: 4.95 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter19.ckpt

#####################################
Training the dynamics model..... iteration  20
#####################################

    amount of random data:  20000
    amount of onPol data:  52152

=== Epoch 0 ===
    train loss:  0.2650120950375612
    val rand:  0.10533026109139125
    val onPol:  0.10888940840959549

=== Epoch 10 ===
    train loss:  0.046609041352684684
    val rand:  0.04502789303660393
    val onPol:  0.045585246135791145

=== Epoch 20 ===
    train loss:  0.0365085661984407
    val rand:  0.0352641853193442
    val onPol:  0.037074671437342964

=== Epoch 30 ===
    train loss:  0.03176790067496208
    val rand:  0.031079270566503208
    val onPol:  0.03253797131280104

=== Epoch 39 ===
    train loss:  0.02889181010854932
    val rand:  0.028659101575613022
    val onPol:  0.02979097639520963
Training duration: 8.10 s

#####################################
performing on-policy MPC rollouts... iter  20
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.30032570952560045
DONE TAKING  100  STEPS.
Total reward:  325.55485273381544
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.21522825178844796
DONE TAKING  76  STEPS.
Total reward:  229.34181094488326
Time for 1 rollout: 3.32 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.4637269874651756
DONE TAKING  48  STEPS.
Total reward:  66.11179304408999
Time for 1 rollout: 2.10 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.2870825829050621
DONE TAKING  100  STEPS.
Total reward:  312.4504770735874
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.4735292418330955
DONE TAKING  100  STEPS.
Total reward:  293.6179785533019
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.3490513922236559
DONE TAKING  100  STEPS.
Total reward:  330.76237424816577
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.5732138921291472
DONE TAKING  100  STEPS.
Total reward:  324.040357395875
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.12824040097046058
DONE TAKING  100  STEPS.
Total reward:  340.5498460865708
Time for 1 rollout: 4.65 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.35637074785588013
DONE TAKING  100  STEPS.
Total reward:  320.00649902159154
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.06025020352793401
DONE TAKING  100  STEPS.
Total reward:  316.90972605963367
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.21585058299596055
DONE TAKING  100  STEPS.
Total reward:  330.39377844349235
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.5433067105450393
DONE TAKING  100  STEPS.
Total reward:  311.7865479748361
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.8157963988343226
DONE TAKING  100  STEPS.
Total reward:  293.89025506662733
Time for 1 rollout: 5.00 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5792840311732845
DONE TAKING  100  STEPS.
Total reward:  317.12027722960784
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.48933146696374985
DONE TAKING  32  STEPS.
Total reward:  54.143999663998876
Time for 1 rollout: 1.55 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.679883086341983
DONE TAKING  100  STEPS.
Total reward:  275.141669432473
Time for 1 rollout: 4.78 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.36500082566360226
DONE TAKING  100  STEPS.
Total reward:  333.2155444076764
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.7566503278034846
DONE TAKING  100  STEPS.
Total reward:  337.9659718197428
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.8145992719012538
DONE TAKING  100  STEPS.
Total reward:  341.0721991738935
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.3322976733683252
DONE TAKING  100  STEPS.
Total reward:  339.87000508900815
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.4406820063095816
DONE TAKING  100  STEPS.
Total reward:  320.7868039760606
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.1953451552935348
DONE TAKING  100  STEPS.
Total reward:  356.94381513177916
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.33195746028032913
DONE TAKING  100  STEPS.
Total reward:  345.3827510105133
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.3887059737738312
DONE TAKING  100  STEPS.
Total reward:  274.2242075692669
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.05592383544600173
DONE TAKING  100  STEPS.
Total reward:  324.89840472488595
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.3504036947706712
DONE TAKING  100  STEPS.
Total reward:  284.7168365782094
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.0510985277121776
DONE TAKING  100  STEPS.
Total reward:  320.5441022075355
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.10576025206501191
DONE TAKING  100  STEPS.
Total reward:  292.9076585223487
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.6021298550220714
DONE TAKING  100  STEPS.
Total reward:  293.7438879590677
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.2676036416090763
DONE TAKING  100  STEPS.
Total reward:  334.2021470268364
Time for 1 rollout: 4.37 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
13.34403969522574
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.854947789219829
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter20.ckpt

#####################################
Training the dynamics model..... iteration  21
#####################################

    amount of random data:  20000
    amount of onPol data:  54735

=== Epoch 0 ===
    train loss:  0.25817053778855886
    val rand:  0.10152483483155568
    val onPol:  0.10472836097081502

=== Epoch 10 ===
    train loss:  0.04541663225326273
    val rand:  0.04376827056209246
    val onPol:  0.04454884181420008

=== Epoch 20 ===
    train loss:  0.035565431540211044
    val rand:  0.034448848416407905
    val onPol:  0.035982279727856316

=== Epoch 30 ===
    train loss:  0.031169647833815328
    val rand:  0.03064715179304282
    val onPol:  0.03163795483609041

=== Epoch 39 ===
    train loss:  0.028348853777128237
    val rand:  0.0279869952549537
    val onPol:  0.029118115703264873
Training duration: 9.48 s

#####################################
performing on-policy MPC rollouts... iter  21
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3386953129167436
DONE TAKING  100  STEPS.
Total reward:  335.1239010409632
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.6115383576244366
DONE TAKING  100  STEPS.
Total reward:  296.26552805180603
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7358797555298215
DONE TAKING  100  STEPS.
Total reward:  333.2356953108176
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.1168900199996564
DONE TAKING  20  STEPS.
Total reward:  14.221899336258211
Time for 1 rollout: 0.86 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.15447323250982659
DONE TAKING  100  STEPS.
Total reward:  100.26014582768367
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.036229323450308715
DONE TAKING  100  STEPS.
Total reward:  336.45571241211087
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.29694226423216
DONE TAKING  100  STEPS.
Total reward:  286.9478043164254
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.07348086087705824
DONE TAKING  100  STEPS.
Total reward:  266.0545280502653
Time for 1 rollout: 4.70 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.0861635852332498
DONE TAKING  100  STEPS.
Total reward:  252.82592593220986
Time for 1 rollout: 4.93 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.088840146878382
DONE TAKING  100  STEPS.
Total reward:  236.48163055350275
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.30665699643987787
DONE TAKING  100  STEPS.
Total reward:  286.8630739668342
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.2718336637923922
DONE TAKING  100  STEPS.
Total reward:  322.8762093403443
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.6739244731482618
DONE TAKING  100  STEPS.
Total reward:  286.74715971298923
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5514372673265818
DONE TAKING  100  STEPS.
Total reward:  310.33631759018465
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.45140473186677144
DONE TAKING  100  STEPS.
Total reward:  280.5088228916689
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.5236930086569884
DONE TAKING  100  STEPS.
Total reward:  317.9578030852681
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.5130789079129402
DONE TAKING  100  STEPS.
Total reward:  298.76746110833477
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.40584573278800595
DONE TAKING  100  STEPS.
Total reward:  300.5976363863532
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.0882295107395664
DONE TAKING  100  STEPS.
Total reward:  297.6162515356782
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.8561419151492873
DONE TAKING  100  STEPS.
Total reward:  108.99401857851082
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.15994827643735082
DONE TAKING  100  STEPS.
Total reward:  300.96144617122087
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.14770490929186075
DONE TAKING  100  STEPS.
Total reward:  270.7814294113411
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.9736667781579382
DONE TAKING  100  STEPS.
Total reward:  331.26036492626935
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.1449470408345728
DONE TAKING  100  STEPS.
Total reward:  271.08601600500344
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.5894353281444189
DONE TAKING  100  STEPS.
Total reward:  306.8729648324865
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.6546429467487458
DONE TAKING  100  STEPS.
Total reward:  307.2442776510816
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.8611860581932016
DONE TAKING  100  STEPS.
Total reward:  351.5774768449882
Time for 1 rollout: 4.47 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.5014758509000545
DONE TAKING  100  STEPS.
Total reward:  317.1261872698458
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.8632954750683827
DONE TAKING  100  STEPS.
Total reward:  305.16842726421424
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.7194114843498052
DONE TAKING  100  STEPS.
Total reward:  316.4289348673472
Time for 1 rollout: 4.21 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter21.ckpt

#####################################
Training the dynamics model..... iteration  22
#####################################

    amount of random data:  20000
    amount of onPol data:  57382

=== Epoch 0 ===
    train loss:  0.2523728402863656
    val rand:  0.10167706261078517
    val onPol:  0.10595297999680042

=== Epoch 10 ===
    train loss:  0.04458599111863545
    val rand:  0.043207813054323196
    val onPol:  0.04405205138027668

=== Epoch 20 ===
    train loss:  0.035160589697105546
    val rand:  0.03398354103167852
    val onPol:  0.03560664318501949

=== Epoch 30 ===
    train loss:  0.030606030519785627
    val rand:  0.03006809391081333
    val onPol:  0.031183746177703142

=== Epoch 39 ===
    train loss:  0.027692061948723028
    val rand:  0.02752770173052947
    val onPol:  0.02825980121269822
Training duration: 7.65 s

#####################################
performing on-policy MPC rollouts... iter  22
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.8930321176597913
DONE TAKING  100  STEPS.
Total reward:  359.88302665131255
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.20391323763064545
DONE TAKING  100  STEPS.
Total reward:  300.2636839915668
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.2028114707993583
DONE TAKING  100  STEPS.
Total reward:  325.8363528929471
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.14848007069634542
DONE TAKING  100  STEPS.
Total reward:  299.997477942595
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.05277159765091077
DONE TAKING  100  STEPS.
Total reward:  280.44989577538826
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.18852288739198408
DONE TAKING  100  STEPS.
Total reward:  195.22832601442593
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.14653850885986613
DONE TAKING  100  STEPS.
Total reward:  357.2844612816273
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5424773638196704
DONE TAKING  100  STEPS.
Total reward:  326.2523627103983
Time for 1 rollout: 4.96 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.3013936387183143
DONE TAKING  100  STEPS.
Total reward:  317.11420599828926
Time for 1 rollout: 4.49 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.1798699968312809
DONE TAKING  100  STEPS.
Total reward:  295.23318928273596
Time for 1 rollout: 4.69 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.5655041526769985
DONE TAKING  100  STEPS.
Total reward:  327.28329024319345
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.6552791485464193
DONE TAKING  100  STEPS.
Total reward:  306.0605164398096
Time for 1 rollout: 4.50 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.2642300051291455
DONE TAKING  100  STEPS.
Total reward:  287.9829262428892
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.9295150569585977
DONE TAKING  100  STEPS.
Total reward:  159.84890174299002
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.653893700642797
DONE TAKING  100  STEPS.
Total reward:  294.55354470509934
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.5380818835743579
DONE TAKING  100  STEPS.
Total reward:  320.0229881326232
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.0672045114832645
DONE TAKING  100  STEPS.
Total reward:  315.19590976352856
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.6162510816432395
DONE TAKING  100  STEPS.
Total reward:  158.64678374194654
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.3257054770513393
DONE TAKING  100  STEPS.
Total reward:  318.21334051643504
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.6463173868231343
DONE TAKING  100  STEPS.
Total reward:  165.98996615641286
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.0029067241638688623
DONE TAKING  100  STEPS.
Total reward:  173.4552169513919
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.35903003748596074
DONE TAKING  100  STEPS.
Total reward:  303.4471311968208
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.4736910476106844
DONE TAKING  100  STEPS.
Total reward:  305.1517793598895
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.1190878146050938
DONE TAKING  100  STEPS.
Total reward:  294.20593219177704
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.686985456098951
DONE TAKING  100  STEPS.
Total reward:  32.88632316677063
Time for 1 rollout: 4.48 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.0021528443197042224
DONE TAKING  100  STEPS.
Total reward:  344.4418641146818
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.6926572301972667
DONE TAKING  100  STEPS.
Total reward:  134.49743372059734
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.3855197284067833
DONE TAKING  100  STEPS.
Total reward:  282.2011129559272
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.7038734544118832
DONE TAKING  100  STEPS.
Total reward:  279.86811363295243
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.3033684254273479
DONE TAKING  100  STEPS.
Total reward:  253.13541220585498
Time for 1 rollout: 4.25 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter22.ckpt

#####################################
Training the dynamics model..... iteration  23
#####################################

    amount of random data:  20000
    amount of onPol data:  60109

=== Epoch 0 ===
    train loss:  0.2455538025094291
    val rand:  0.09802070756753285
    val onPol:  0.10197456739842892

=== Epoch 10 ===
    train loss:  0.04377289785672042
    val rand:  0.04176460454861323
    val onPol:  0.042951660230755806

=== Epoch 20 ===
    train loss:  0.03477935183603885
    val rand:  0.03329421083132426
    val onPol:  0.03507372457534075

=== Epoch 30 ===
    train loss:  0.030480234931081027
    val rand:  0.029285887877146404
    val onPol:  0.03076817747205496

=== Epoch 39 ===
    train loss:  0.027658547448404763
    val rand:  0.027228888124227524
    val onPol:  0.02803347446024418
Training duration: 10.50 s

#####################################
performing on-policy MPC rollouts... iter  23
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.8785451876996824
DONE TAKING  100  STEPS.
Total reward:  337.4062251986641
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.3383451917643256
DONE TAKING  100  STEPS.
Total reward:  281.5944781209295
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7261228432566371
DONE TAKING  100  STEPS.
Total reward:  281.59911090180213
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.6239057031947581
DONE TAKING  100  STEPS.
Total reward:  316.34645857476886
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.34824727121708543
DONE TAKING  100  STEPS.
Total reward:  282.4449129795661
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.18025743322619941
DONE TAKING  100  STEPS.
Total reward:  303.935088159097
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -1.0802768655180102
DONE TAKING  100  STEPS.
Total reward:  267.2089202736233
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.43025463523885865
DONE TAKING  100  STEPS.
Total reward:  361.06651984504896
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.5886138055152899
DONE TAKING  100  STEPS.
Total reward:  299.36906661233843
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.994316324993967
DONE TAKING  100  STEPS.
Total reward:  315.8036132693055
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -1.3833491021116924
DONE TAKING  100  STEPS.
Total reward:  312.6108613980573
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.29033155214330486
DONE TAKING  34  STEPS.
Total reward:  54.277535687992575
Time for 1 rollout: 1.46 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.5702569487714506
DONE TAKING  100  STEPS.
Total reward:  189.07827544223474
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.17841041372896227
DONE TAKING  100  STEPS.
Total reward:  272.09098987207483
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.5245061078729389
DONE TAKING  100  STEPS.
Total reward:  290.9043675632325
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.5917616368162784
DONE TAKING  100  STEPS.
Total reward:  313.06986377016835
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.18673933055224579
DONE TAKING  100  STEPS.
Total reward:  282.77705399005833
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.2386465495556345
DONE TAKING  100  STEPS.
Total reward:  308.0940932304901
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.40473854852880453
DONE TAKING  100  STEPS.
Total reward:  289.81994064290745
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.3188198919908887
DONE TAKING  100  STEPS.
Total reward:  331.34518467122564
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.6916718459149068
DONE TAKING  100  STEPS.
Total reward:  279.1240862634407
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.146806212056256
DONE TAKING  100  STEPS.
Total reward:  319.8212288267751
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.7416341259433679
DONE TAKING  100  STEPS.
Total reward:  317.2281708377937
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.42751808168507277
DONE TAKING  100  STEPS.
Total reward:  271.05783892720814
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.0950812939316282
DONE TAKING  100  STEPS.
Total reward:  266.29328855481054
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.396544085223799
DONE TAKING  100  STEPS.
Total reward:  311.3879983935051
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.59016026749187
DONE TAKING  100  STEPS.
Total reward:  339.5818982107198
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.24819069409709002
DONE TAKING  100  STEPS.
Total reward:  322.20070732035595
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.7498709527049648
DONE TAKING  100  STEPS.
Total reward:  252.9675225445269
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.0273551003086214
DONE TAKING  84  STEPS.
Total reward:  242.49502599338769
Time for 1 rollout: 3.63 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter23.ckpt

#####################################
Training the dynamics model..... iteration  24
#####################################

    amount of random data:  20000
    amount of onPol data:  62770

=== Epoch 0 ===
    train loss:  0.2491811024116688
    val rand:  0.09942866365114848
    val onPol:  0.10377210937440395

=== Epoch 10 ===
    train loss:  0.04444877137659026
    val rand:  0.042883262038230896
    val onPol:  0.04379557725042105

=== Epoch 20 ===
    train loss:  0.03539956812975836
    val rand:  0.03418424539268017
    val onPol:  0.03575787506997585

=== Epoch 30 ===
    train loss:  0.030971136493761032
    val rand:  0.030201659848292668
    val onPol:  0.03138163639232516

=== Epoch 39 ===
    train loss:  0.028272775444583814
    val rand:  0.027890040228764217
    val onPol:  0.028567731380462646
Training duration: 10.86 s

#####################################
performing on-policy MPC rollouts... iter  24
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.1483205429933298
DONE TAKING  86  STEPS.
Total reward:  245.32351061129128
Time for 1 rollout: 3.90 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.9947063373446456
DONE TAKING  100  STEPS.
Total reward:  355.286754361605
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.8065922195253189
DONE TAKING  100  STEPS.
Total reward:  290.72890019275917
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.6016144078330982
DONE TAKING  100  STEPS.
Total reward:  315.9995994169307
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.1579639807750029
DONE TAKING  100  STEPS.
Total reward:  240.43408874718727
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.11772440435526986
DONE TAKING  100  STEPS.
Total reward:  331.89943280253897
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.09182795764117571
DONE TAKING  100  STEPS.
Total reward:  344.7284359018063
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -1.1065024870623954
DONE TAKING  100  STEPS.
Total reward:  340.4760586165621
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -1.1190549329122885
DONE TAKING  100  STEPS.
Total reward:  280.9483568654279
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.2661587750250795
DONE TAKING  100  STEPS.
Total reward:  331.91745512137976
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5915551707444541
DONE TAKING  100  STEPS.
Total reward:  348.18873579714017
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.2963090388304896
DONE TAKING  100  STEPS.
Total reward:  306.36411329710376
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.9182549956022417
DONE TAKING  100  STEPS.
Total reward:  344.6201586320622
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.26497826756805526
DONE TAKING  100  STEPS.
Total reward:  305.40048396707454
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.567880939358699
DONE TAKING  100  STEPS.
Total reward:  349.391581913549
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.5174151960372205
DONE TAKING  100  STEPS.
Total reward:  338.8248080115834
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5167622684891382
DONE TAKING  100  STEPS.
Total reward:  349.4556394084796
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.9443531202100026
DONE TAKING  100  STEPS.
Total reward:  312.32932770244224
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.2236597698424443
DONE TAKING  100  STEPS.
Total reward:  281.97744349992263
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.42754036654138866
DONE TAKING  100  STEPS.
Total reward:  306.7431967115723
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.7723512399709611
DONE TAKING  100  STEPS.
Total reward:  346.06023701979996
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.7578309196362655
DONE TAKING  100  STEPS.
Total reward:  297.73006835370916
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.24497566625284145
DONE TAKING  100  STEPS.
Total reward:  307.15108607856877
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.3703712651565103
DONE TAKING  100  STEPS.
Total reward:  333.09053220852553
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.26458851333909694
DONE TAKING  76  STEPS.
Total reward:  223.2344038835293
Time for 1 rollout: 3.29 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.3046551164564019
DONE TAKING  100  STEPS.
Total reward:  308.58632579758654
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.14089780367299665
DONE TAKING  100  STEPS.
Total reward:  341.8351629739496
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.30350623276034616
DONE TAKING  100  STEPS.
Total reward:  282.4051758160946
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.6270429894059629
DONE TAKING  100  STEPS.
Total reward:  306.5752745538741
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.33404381570897757
DONE TAKING  100  STEPS.
Total reward:  320.16512093247644
Time for 1 rollout: 4.32 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter24.ckpt

#####################################
Training the dynamics model..... iteration  25
#####################################

    amount of random data:  20000
    amount of onPol data:  65459

=== Epoch 0 ===
    train loss:  0.24265161617880776
    val rand:  0.0983714908361435
    val onPol:  0.1008937880396843

=== Epoch 10 ===
    train loss:  0.042973846433654664
    val rand:  0.04061005264520645
    val onPol:  0.042244707234203815

=== Epoch 20 ===
    train loss:  0.03451518069893595
    val rand:  0.033005017787218094
    val onPol:  0.0348234036937356

=== Epoch 30 ===
    train loss:  0.03016853767136733
    val rand:  0.029630980143944424
    val onPol:  0.030371123924851418

=== Epoch 39 ===
    train loss:  0.027452083363656014
    val rand:  0.02715707632402579
    val onPol:  0.027601254172623158
Training duration: 10.83 s

#####################################
performing on-policy MPC rollouts... iter  25
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.21998003329802782
DONE TAKING  100  STEPS.
Total reward:  335.7317224579953
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.3767200818397786
DONE TAKING  100  STEPS.
Total reward:  20.79493971079847
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.05686755281419764
DONE TAKING  100  STEPS.
Total reward:  263.58779467845454
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.19977200822320376
DONE TAKING  100  STEPS.
Total reward:  328.05614020589655
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.853214014758219
DONE TAKING  100  STEPS.
Total reward:  270.4007021473828
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.10758222975047461
DONE TAKING  100  STEPS.
Total reward:  227.01017559834725
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -1.2530695757231385
DONE TAKING  100  STEPS.
Total reward:  265.39346824491037
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.3299563206152969
DONE TAKING  100  STEPS.
Total reward:  316.4287248279068
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.33064334802308604
DONE TAKING  100  STEPS.
Total reward:  312.3660348110098
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.8265643850470422
DONE TAKING  100  STEPS.
Total reward:  314.4977147130116
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.07677887414884346
DONE TAKING  100  STEPS.
Total reward:  320.99719711846905
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.7680825986300245
DONE TAKING  100  STEPS.
Total reward:  268.0266843905156
Time for 1 rollout: 4.69 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.06346085742945706
DONE TAKING  100  STEPS.
Total reward:  318.2915983989714
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.009456766716579912
DONE TAKING  100  STEPS.
Total reward:  24.636710305605078
Time for 1 rollout: 4.95 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.1171682718643572
DONE TAKING  100  STEPS.
Total reward:  19.499142033299332
Time for 1 rollout: 4.93 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.046823306298178075
DONE TAKING  100  STEPS.
Total reward:  256.90978342668797
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.326040562321565
DONE TAKING  100  STEPS.
Total reward:  2.3443032329689917
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.06150693527925821
DONE TAKING  100  STEPS.
Total reward:  274.5336080567882
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.16439449484188584
DONE TAKING  100  STEPS.
Total reward:  386.5925672565343
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.44688437968421
DONE TAKING  100  STEPS.
Total reward:  331.55685097712694
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.1932542647570255
DONE TAKING  100  STEPS.
Total reward:  348.1026053985497
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.8044574891245306
DONE TAKING  100  STEPS.
Total reward:  -0.9235957710812797
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.13013679439845416
DONE TAKING  100  STEPS.
Total reward:  3.267829316690572
Time for 1 rollout: 4.65 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.24677348554015416
DONE TAKING  100  STEPS.
Total reward:  298.542542339115
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.4419653052859935
DONE TAKING  100  STEPS.
Total reward:  298.13684661674375
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.5908202269779226
DONE TAKING  100  STEPS.
Total reward:  342.65677144278646
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.04339523221556043
DONE TAKING  100  STEPS.
Total reward:  354.1556411308578
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.6287937178010038
DONE TAKING  100  STEPS.
Total reward:  309.2273019069725
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.19417853275099584
DONE TAKING  100  STEPS.
Total reward:  213.366839516267
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.8289621712127433
DONE TAKING  100  STEPS.
Total reward:  265.2374830356977
Time for 1 rollout: 4.31 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
14.315698253139
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.7803032177486247
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter25.ckpt

#####################################
Training the dynamics model..... iteration  26
#####################################

    amount of random data:  20000
    amount of onPol data:  68186

=== Epoch 0 ===
    train loss:  0.23541280168753403
    val rand:  0.09659703820943832
    val onPol:  0.10033152624964714

=== Epoch 10 ===
    train loss:  0.04178333116265444
    val rand:  0.039537823448578514
    val onPol:  0.040801215916872025

=== Epoch 20 ===
    train loss:  0.033269591916065946
    val rand:  0.03237454531093439
    val onPol:  0.033362583722919226

=== Epoch 30 ===
    train loss:  0.02901415635760014
    val rand:  0.02854065348704656
    val onPol:  0.02889832854270935

=== Epoch 39 ===
    train loss:  0.026279416049902256
    val rand:  0.026399025072654087
    val onPol:  0.0265151122584939
Training duration: 11.40 s

#####################################
performing on-policy MPC rollouts... iter  26
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.5906543843160779
DONE TAKING  100  STEPS.
Total reward:  275.4172532814037
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.8339041523584478
DONE TAKING  100  STEPS.
Total reward:  315.70547890039387
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.05523660140697684
DONE TAKING  100  STEPS.
Total reward:  332.33260869875176
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.004679711703932082
DONE TAKING  100  STEPS.
Total reward:  313.6010408974155
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.48513407290482424
DONE TAKING  100  STEPS.
Total reward:  388.3032295915326
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.10508935733017984
DONE TAKING  100  STEPS.
Total reward:  294.9629716615813
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -1.020542674201358
DONE TAKING  100  STEPS.
Total reward:  302.85481380568183
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.005949818866038084
DONE TAKING  100  STEPS.
Total reward:  284.69664199156506
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.06743423417333291
DONE TAKING  100  STEPS.
Total reward:  285.32415127537917
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.4022927291894332
DONE TAKING  100  STEPS.
Total reward:  262.36438597960824
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.13290703746826493
DONE TAKING  100  STEPS.
Total reward:  281.8889797144408
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.8333948333317103
DONE TAKING  100  STEPS.
Total reward:  333.1131880899169
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -1.7381825888044546
DONE TAKING  100  STEPS.
Total reward:  333.58117476088523
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5503519000591856
DONE TAKING  100  STEPS.
Total reward:  192.01548551521302
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.21462530657280765
DONE TAKING  100  STEPS.
Total reward:  291.8568174616253
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.30791414048674426
DONE TAKING  100  STEPS.
Total reward:  287.63764124173156
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.4543391190528743
DONE TAKING  100  STEPS.
Total reward:  336.14054044714834
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.48776244616164366
DONE TAKING  100  STEPS.
Total reward:  297.1198068596571
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.7127534905622601
DONE TAKING  100  STEPS.
Total reward:  259.0179967258834
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.4530958633290205
DONE TAKING  100  STEPS.
Total reward:  291.4027560197755
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 20
done step  0 , rew:  0.5891070384811222
DONE TAKING  100  STEPS.
Total reward:  303.0335752042629
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.9347604884484799
DONE TAKING  100  STEPS.
Total reward:  302.2395133455097
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.9352966386549642
DONE TAKING  100  STEPS.
Total reward:  344.44508307603957
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.3769520811131266
DONE TAKING  100  STEPS.
Total reward:  350.803393141907
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.0280610669323695
DONE TAKING  100  STEPS.
Total reward:  382.8711030613162
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.7265534876767396
DONE TAKING  100  STEPS.
Total reward:  302.30521491714086
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.4619807906565464
DONE TAKING  100  STEPS.
Total reward:  300.36447220123864
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.6209019837279446
DONE TAKING  100  STEPS.
Total reward:  291.9368769740829
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.7381308953942749
DONE TAKING  100  STEPS.
Total reward:  293.4818339555465
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.3720488178508427
DONE TAKING  100  STEPS.
Total reward:  290.06382990383185
Time for 1 rollout: 4.23 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter26.ckpt

#####################################
Training the dynamics model..... iteration  27
#####################################

    amount of random data:  20000
    amount of onPol data:  70913

=== Epoch 0 ===
    train loss:  0.23092830448008295
    val rand:  0.09520452717940013
    val onPol:  0.09859661906957626

=== Epoch 10 ===
    train loss:  0.041842211871894436
    val rand:  0.03977321336666743
    val onPol:  0.04241575300693512

=== Epoch 20 ===
    train loss:  0.033434916649069356
    val rand:  0.03217675971488158
    val onPol:  0.034343118965625766

=== Epoch 30 ===
    train loss:  0.02908767434532073
    val rand:  0.029063136006395023
    val onPol:  0.029886117950081826

=== Epoch 39 ===
    train loss:  0.026514155289797642
    val rand:  0.026444018507997196
    val onPol:  0.027239474281668664
Training duration: 9.28 s

#####################################
performing on-policy MPC rollouts... iter  27
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.18658607930718812
DONE TAKING  100  STEPS.
Total reward:  302.3769459720248
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.5910288571187572
DONE TAKING  100  STEPS.
Total reward:  281.43127356413163
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.6158156784475853
DONE TAKING  100  STEPS.
Total reward:  335.5057227291215
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.012662896146950958
DONE TAKING  100  STEPS.
Total reward:  265.11307707409867
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.7745655368129682
DONE TAKING  100  STEPS.
Total reward:  279.6651248357426
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.9494112061038327
DONE TAKING  100  STEPS.
Total reward:  387.00523638944276
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.7404545098265596
DONE TAKING  100  STEPS.
Total reward:  315.3109210148811
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5170321388538158
DONE TAKING  100  STEPS.
Total reward:  343.5181671399613
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.19346196951540395
DONE TAKING  100  STEPS.
Total reward:  301.7669703961017
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.3514521521529328
DONE TAKING  100  STEPS.
Total reward:  345.583711085176
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.20008289769506593
DONE TAKING  100  STEPS.
Total reward:  357.76954040594757
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.1615222258921878
DONE TAKING  100  STEPS.
Total reward:  332.0363228622395
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.16179842723350643
DONE TAKING  100  STEPS.
Total reward:  334.436136754744
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.9373562354080314
DONE TAKING  100  STEPS.
Total reward:  298.59364467346745
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.9592188633210152
DONE TAKING  100  STEPS.
Total reward:  310.2696609784026
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -1.045375357630493
DONE TAKING  100  STEPS.
Total reward:  318.46097830044
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.46261948464874136
DONE TAKING  100  STEPS.
Total reward:  320.33421599887237
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.6135816565688853
DONE TAKING  100  STEPS.
Total reward:  357.9241566188681
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.34357013159752775
DONE TAKING  100  STEPS.
Total reward:  337.32384905432804
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.13197830886878634
DONE TAKING  100  STEPS.
Total reward:  248.61389519276509
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.7575445361970875
DONE TAKING  100  STEPS.
Total reward:  290.37117944969395
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.2238100991407894
DONE TAKING  100  STEPS.
Total reward:  287.47727350039577
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.1493192486849302
DONE TAKING  100  STEPS.
Total reward:  211.06138319463906
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.6200015599241573
DONE TAKING  100  STEPS.
Total reward:  346.1335224390052
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.381133511620907
DONE TAKING  100  STEPS.
Total reward:  367.1781653163554
Time for 1 rollout: 4.69 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.4069899056465053
DONE TAKING  100  STEPS.
Total reward:  372.83538591244974
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -1.4608814766300329
DONE TAKING  100  STEPS.
Total reward:  324.33620262698315
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.633323848086637
DONE TAKING  100  STEPS.
Total reward:  313.3335223082873
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.7481229859230408
DONE TAKING  100  STEPS.
Total reward:  351.91691090167257
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.0983509546916248
DONE TAKING  100  STEPS.
Total reward:  326.78691248601126
Time for 1 rollout: 4.46 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter27.ckpt

#####################################
Training the dynamics model..... iteration  28
#####################################

    amount of random data:  20000
    amount of onPol data:  73640

=== Epoch 0 ===
    train loss:  0.23457405068304227
    val rand:  0.09583225349585216
    val onPol:  0.09801136255264283

=== Epoch 10 ===
    train loss:  0.042021311927532806
    val rand:  0.040456436574459076
    val onPol:  0.042235903441905975

=== Epoch 20 ===
    train loss:  0.03332511314015458
    val rand:  0.03239553111294905
    val onPol:  0.03405897617340088

=== Epoch 30 ===
    train loss:  0.02902118005938288
    val rand:  0.02882577230532964
    val onPol:  0.029783279821276664

=== Epoch 39 ===
    train loss:  0.026396299806841904
    val rand:  0.02654603123664856
    val onPol:  0.027329908311367036
Training duration: 11.31 s

#####################################
performing on-policy MPC rollouts... iter  28
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.2882457446145146
DONE TAKING  100  STEPS.
Total reward:  350.9396304042522
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.8425542407336064
DONE TAKING  100  STEPS.
Total reward:  217.47222440924767
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.026611169014152253
DONE TAKING  65  STEPS.
Total reward:  175.51107180159366
Time for 1 rollout: 2.90 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.10372625478074698
DONE TAKING  100  STEPS.
Total reward:  372.7114468011328
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.17233717419297329
DONE TAKING  100  STEPS.
Total reward:  290.38138519881323
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.6508925050327465
DONE TAKING  100  STEPS.
Total reward:  284.45432703322115
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.3155187639250622
DONE TAKING  100  STEPS.
Total reward:  322.4481336009004
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.003919157597230771
DONE TAKING  100  STEPS.
Total reward:  301.7757701610377
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.2648544960526825
DONE TAKING  100  STEPS.
Total reward:  302.60617007993176
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.8747155119546908
DONE TAKING  100  STEPS.
Total reward:  292.9424603271331
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.0912860202759741
DONE TAKING  100  STEPS.
Total reward:  356.8260700647284
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.29287670922380005
DONE TAKING  100  STEPS.
Total reward:  322.8182654004862
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.6301768439252514
DONE TAKING  100  STEPS.
Total reward:  350.5185325380786
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5907397570854771
DONE TAKING  100  STEPS.
Total reward:  142.15321831006423
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.1621416448477437
DONE TAKING  100  STEPS.
Total reward:  285.44606727588825
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.06716843321200618
DONE TAKING  100  STEPS.
Total reward:  313.37653015044265
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.18588083450317872
DONE TAKING  100  STEPS.
Total reward:  325.3220365051158
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.9422620044386528
DONE TAKING  45  STEPS.
Total reward:  52.22875279838754
Time for 1 rollout: 1.95 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.4369046397531977
DONE TAKING  62  STEPS.
Total reward:  31.777867004857153
Time for 1 rollout: 2.68 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.1523947158355474
DONE TAKING  100  STEPS.
Total reward:  212.42002889263634
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.26695950361170195
DONE TAKING  100  STEPS.
Total reward:  361.78614234736506
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.0583933299229742
DONE TAKING  100  STEPS.
Total reward:  355.98347908486545
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -1.5223540450115696
DONE TAKING  100  STEPS.
Total reward:  284.14322305456795
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.1265916041664952
DONE TAKING  100  STEPS.
Total reward:  332.1701385223722
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.2267078846944675
DONE TAKING  100  STEPS.
Total reward:  209.37529445860946
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.1426597672689177
DONE TAKING  100  STEPS.
Total reward:  259.7997113953904
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.612201905611543
DONE TAKING  100  STEPS.
Total reward:  291.6398726162474
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.8598091147166143
DONE TAKING  100  STEPS.
Total reward:  266.9592762371234
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.022042312226586258
DONE TAKING  100  STEPS.
Total reward:  299.3334111285763
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.6419866336041573
DONE TAKING  100  STEPS.
Total reward:  314.4745625525133
Time for 1 rollout: 4.83 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter28.ckpt

#####################################
Training the dynamics model..... iteration  29
#####################################

    amount of random data:  20000
    amount of onPol data:  76239

=== Epoch 0 ===
    train loss:  0.21918988469201076
    val rand:  0.09305570522944133
    val onPol:  0.09454220533370972

=== Epoch 10 ===
    train loss:  0.04005620077672139
    val rand:  0.03819382190704346
    val onPol:  0.040217798203229904

=== Epoch 20 ===
    train loss:  0.03180154614990026
    val rand:  0.030674514671166737
    val onPol:  0.03236029408872128

=== Epoch 30 ===
    train loss:  0.027528358465978797
    val rand:  0.027114978060126305
    val onPol:  0.02812628708779812

=== Epoch 39 ===
    train loss:  0.024973267899222776
    val rand:  0.02532565842072169
    val onPol:  0.025533606857061387
Training duration: 12.62 s

#####################################
performing on-policy MPC rollouts... iter  29
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3861147268271886
DONE TAKING  100  STEPS.
Total reward:  345.09860519830886
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.3933260850225955
DONE TAKING  100  STEPS.
Total reward:  340.8688629624034
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -1.1349292197799525
DONE TAKING  100  STEPS.
Total reward:  358.2820211524354
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.41952921800023313
DONE TAKING  100  STEPS.
Total reward:  351.2472842510614
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.29020546380896445
DONE TAKING  100  STEPS.
Total reward:  326.5739376871409
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.3504331147259012
DONE TAKING  100  STEPS.
Total reward:  323.0508150693602
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.45333140094663726
DONE TAKING  100  STEPS.
Total reward:  305.70804007403115
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.3453657192459443
DONE TAKING  100  STEPS.
Total reward:  302.3864380060418
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.8474154993072951
DONE TAKING  100  STEPS.
Total reward:  345.05046834659976
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.14031989840587186
DONE TAKING  100  STEPS.
Total reward:  343.35317396884
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.053000528167179844
DONE TAKING  100  STEPS.
Total reward:  279.9059737798112
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -1.40380019927956
DONE TAKING  100  STEPS.
Total reward:  338.498217629965
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.026714640712634255
DONE TAKING  100  STEPS.
Total reward:  359.5149548726748
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -1.1371074389079716
DONE TAKING  100  STEPS.
Total reward:  374.55080925877724
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.12121896522187714
DONE TAKING  100  STEPS.
Total reward:  278.5899563105332
Time for 1 rollout: 4.48 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.24096027241684764
DONE TAKING  100  STEPS.
Total reward:  281.98194496732697
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.9052565474143254
DONE TAKING  100  STEPS.
Total reward:  330.29079073452147
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.051138375552473
DONE TAKING  100  STEPS.
Total reward:  273.32801093397916
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.17133826618837325
DONE TAKING  100  STEPS.
Total reward:  316.74137341982805
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.4163322570369994
DONE TAKING  100  STEPS.
Total reward:  312.25932320133546
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.6161625548481828
DONE TAKING  100  STEPS.
Total reward:  312.7292033637879
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.6047389333542961
DONE TAKING  100  STEPS.
Total reward:  334.7567011850202
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.004304842831842126
DONE TAKING  100  STEPS.
Total reward:  356.25577605480447
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.27479230755460415
DONE TAKING  100  STEPS.
Total reward:  270.0576350856135
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.9016761108884075
DONE TAKING  100  STEPS.
Total reward:  355.2347876037214
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.7241885966768766
DONE TAKING  100  STEPS.
Total reward:  297.98712046198045
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.5862206808183995
DONE TAKING  100  STEPS.
Total reward:  359.7314923315001
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.6160276480747835
DONE TAKING  100  STEPS.
Total reward:  323.88090414263763
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.4291846906701826
DONE TAKING  100  STEPS.
Total reward:  296.70114281742946
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.380136894810157
DONE TAKING  100  STEPS.
Total reward:  280.04429101695274
Time for 1 rollout: 4.32 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter29.ckpt

#####################################
Training the dynamics model..... iteration  30
#####################################

    amount of random data:  20000
    amount of onPol data:  78966

=== Epoch 0 ===
    train loss:  0.2230233351049358
    val rand:  0.09305105110009511
    val onPol:  0.096107017993927

=== Epoch 10 ===
    train loss:  0.04055110839744137
    val rand:  0.038970125218232475
    val onPol:  0.04075002893805504

=== Epoch 20 ===
    train loss:  0.032230250486364104
    val rand:  0.03154339144627253
    val onPol:  0.03276456780731678

=== Epoch 30 ===
    train loss:  0.027942413897955255
    val rand:  0.027727150668700535
    val onPol:  0.028395775705575943

=== Epoch 39 ===
    train loss:  0.02517829376132521
    val rand:  0.025249349574247997
    val onPol:  0.02560273967683315
Training duration: 13.90 s

#####################################
performing on-policy MPC rollouts... iter  30
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.05905978208724283
DONE TAKING  100  STEPS.
Total reward:  292.34986190194223
Time for 1 rollout: 4.52 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.47568529828200934
DONE TAKING  100  STEPS.
Total reward:  392.4365036800305
Time for 1 rollout: 4.54 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.8321630292565266
DONE TAKING  100  STEPS.
Total reward:  339.49669514448306
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.2351915358208987
DONE TAKING  100  STEPS.
Total reward:  297.71142422667106
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.36761015526325946
DONE TAKING  100  STEPS.
Total reward:  217.27387143328912
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.13052044742582855
DONE TAKING  100  STEPS.
Total reward:  308.4342344751076
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.25262823689819325
DONE TAKING  100  STEPS.
Total reward:  320.79621491277896
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.3493446599375582
DONE TAKING  100  STEPS.
Total reward:  305.23240729884344
Time for 1 rollout: 4.65 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.008006663557524718
DONE TAKING  100  STEPS.
Total reward:  351.1701443188233
Time for 1 rollout: 4.72 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.9704331238889674
DONE TAKING  100  STEPS.
Total reward:  345.4386914283584
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.23715197942232188
DONE TAKING  100  STEPS.
Total reward:  293.1474366918943
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -1.5045477062749237
DONE TAKING  100  STEPS.
Total reward:  341.25161856144905
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -1.259627090536378
DONE TAKING  100  STEPS.
Total reward:  353.83368445095635
Time for 1 rollout: 4.51 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.3788339567129859
DONE TAKING  100  STEPS.
Total reward:  324.9444329216312
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.03981290921966431
DONE TAKING  100  STEPS.
Total reward:  333.3618181912456
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.47686273703484394
DONE TAKING  100  STEPS.
Total reward:  263.8954247885017
Time for 1 rollout: 4.50 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.2630300021473868
DONE TAKING  100  STEPS.
Total reward:  359.71578070965455
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 17
done step  0 , rew:  1.129978558956573
DONE TAKING  100  STEPS.
Total reward:  313.75560966349695
Time for 1 rollout: 4.52 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.0372461867455027
DONE TAKING  100  STEPS.
Total reward:  315.6242219676408
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.11442346098609313
DONE TAKING  100  STEPS.
Total reward:  291.4490817521152
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.6739989074990675
DONE TAKING  100  STEPS.
Total reward:  342.74052740387697
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.4440327557783802
DONE TAKING  100  STEPS.
Total reward:  368.22470784547244
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.5341981590390608
DONE TAKING  100  STEPS.
Total reward:  324.9413531396936
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.3879370004672716
DONE TAKING  100  STEPS.
Total reward:  269.1680117625613
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.20439212810558
DONE TAKING  100  STEPS.
Total reward:  330.25810758800446
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.2815021010141647
DONE TAKING  100  STEPS.
Total reward:  272.4838367544511
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.6216958181180602
DONE TAKING  100  STEPS.
Total reward:  324.5185400972554
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.6482994428348063
DONE TAKING  100  STEPS.
Total reward:  323.63513028202976
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.001198627639448585
DONE TAKING  100  STEPS.
Total reward:  348.34671342150364
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.7419188018254602
DONE TAKING  100  STEPS.
Total reward:  344.9520307311765
Time for 1 rollout: 4.75 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
13.295404342790409
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.6988863256966165
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter30.ckpt

#####################################
Training the dynamics model..... iteration  31
#####################################

    amount of random data:  20000
    amount of onPol data:  81693

=== Epoch 0 ===
    train loss:  0.21814571529626847
    val rand:  0.09177444378534953
    val onPol:  0.09291804432868958

=== Epoch 10 ===
    train loss:  0.03928728565573692
    val rand:  0.03779455522696177
    val onPol:  0.03924780935049057

=== Epoch 20 ===
    train loss:  0.031197694465517997
    val rand:  0.030717539911468823
    val onPol:  0.031884638220071794

=== Epoch 30 ===
    train loss:  0.027260556841890018
    val rand:  0.027170212318499882
    val onPol:  0.02769506089389324

=== Epoch 39 ===
    train loss:  0.024852445324261983
    val rand:  0.025283218671878178
    val onPol:  0.025286345556378365
Training duration: 12.63 s

#####################################
performing on-policy MPC rollouts... iter  31
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.42642937968148054
DONE TAKING  100  STEPS.
Total reward:  342.69874419104895
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.6790262083925307
DONE TAKING  100  STEPS.
Total reward:  281.7485953318716
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.582714198664247
DONE TAKING  100  STEPS.
Total reward:  362.6896413923433
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.9648972422594779
DONE TAKING  100  STEPS.
Total reward:  339.4590523674572
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.29523432738784966
DONE TAKING  100  STEPS.
Total reward:  337.00482575813083
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.4527937296671277
DONE TAKING  100  STEPS.
Total reward:  322.885053421147
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.6634877036885061
DONE TAKING  100  STEPS.
Total reward:  360.6747772322249
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5440394909947541
DONE TAKING  100  STEPS.
Total reward:  364.52339254440085
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.39307994182158423
DONE TAKING  100  STEPS.
Total reward:  365.81176224624323
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.06805150417095214
DONE TAKING  100  STEPS.
Total reward:  329.830499724113
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.7194043680729694
DONE TAKING  100  STEPS.
Total reward:  369.20919938338153
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.007675014834056498
DONE TAKING  100  STEPS.
Total reward:  362.91454727890573
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.5231612447349177
DONE TAKING  100  STEPS.
Total reward:  329.46624636233634
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.18640829925430097
DONE TAKING  100  STEPS.
Total reward:  326.6906756247598
Time for 1 rollout: 4.42 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.28325011842727404
DONE TAKING  100  STEPS.
Total reward:  383.6289793923239
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.688902769221333
DONE TAKING  100  STEPS.
Total reward:  309.25637673267374
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.9005366218124764
DONE TAKING  100  STEPS.
Total reward:  362.7846140119924
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -1.453761382063743
DONE TAKING  100  STEPS.
Total reward:  344.5282567627072
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.607119665628332
DONE TAKING  100  STEPS.
Total reward:  313.82608446727795
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.4788104544086596
DONE TAKING  100  STEPS.
Total reward:  305.90449444670793
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.19366663397807538
DONE TAKING  100  STEPS.
Total reward:  370.79181818701784
Time for 1 rollout: 4.47 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.4938974401352584
DONE TAKING  100  STEPS.
Total reward:  13.329606365986354
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.8399180819029901
DONE TAKING  100  STEPS.
Total reward:  283.74162559939595
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.0170077693361104
DONE TAKING  100  STEPS.
Total reward:  289.11912498974147
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.739884014591591
DONE TAKING  100  STEPS.
Total reward:  278.8298273175958
Time for 1 rollout: 4.38 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.5524027558145558
DONE TAKING  100  STEPS.
Total reward:  327.2553494848663
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.22200124250312597
DONE TAKING  100  STEPS.
Total reward:  330.75800756124266
Time for 1 rollout: 4.49 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.065963717292223
DONE TAKING  100  STEPS.
Total reward:  327.601844639932
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.6564585254584243
DONE TAKING  100  STEPS.
Total reward:  300.8730410459288
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.9449224216370098
DONE TAKING  100  STEPS.
Total reward:  341.30458074411933
Time for 1 rollout: 4.29 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter31.ckpt

#####################################
Training the dynamics model..... iteration  32
#####################################

    amount of random data:  20000
    amount of onPol data:  84420

=== Epoch 0 ===
    train loss:  0.20942004063686767
    val rand:  0.0894324133793513
    val onPol:  0.09135679776469867

=== Epoch 10 ===
    train loss:  0.03893900623956284
    val rand:  0.03735795244574547
    val onPol:  0.03900402163465818

=== Epoch 20 ===
    train loss:  0.03128488925467064
    val rand:  0.030520598714550335
    val onPol:  0.03160183411091566

=== Epoch 30 ===
    train loss:  0.027177671768835614
    val rand:  0.02684393587211768
    val onPol:  0.027506254923840363

=== Epoch 39 ===
    train loss:  0.02458236247978427
    val rand:  0.02462416576842467
    val onPol:  0.02523121051490307
Training duration: 11.98 s

#####################################
performing on-policy MPC rollouts... iter  32
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3355485979675815
DONE TAKING  100  STEPS.
Total reward:  369.38610756314534
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.17205119090307527
DONE TAKING  100  STEPS.
Total reward:  292.39028007800624
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.5100410211864416
DONE TAKING  100  STEPS.
Total reward:  377.16857915461094
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.6940632107811421
DONE TAKING  100  STEPS.
Total reward:  310.49339397286536
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.03662943313322739
DONE TAKING  100  STEPS.
Total reward:  301.072153452291
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.4008523068735914
DONE TAKING  100  STEPS.
Total reward:  350.4174860121546
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.41551848812735503
DONE TAKING  100  STEPS.
Total reward:  355.32194594787006
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.14105455011635956
DONE TAKING  100  STEPS.
Total reward:  305.0729796246927
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.8571616505186218
DONE TAKING  100  STEPS.
Total reward:  305.42794599561057
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.2808655292224622
DONE TAKING  100  STEPS.
Total reward:  354.42239868869535
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5156831971475752
DONE TAKING  100  STEPS.
Total reward:  342.8231276784715
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.5028179964569842
DONE TAKING  100  STEPS.
Total reward:  275.1329118878782
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.03446059787758529
DONE TAKING  100  STEPS.
Total reward:  324.7468892030983
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.18343667433522498
DONE TAKING  100  STEPS.
Total reward:  206.955932620106
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.4450189544578632
DONE TAKING  100  STEPS.
Total reward:  354.2882930898174
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.08847479664365478
DONE TAKING  100  STEPS.
Total reward:  331.27008889518925
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.0040938335769602485
DONE TAKING  100  STEPS.
Total reward:  387.64894735548216
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.2231274552910017
DONE TAKING  100  STEPS.
Total reward:  358.02862229318345
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.958666878995488
DONE TAKING  100  STEPS.
Total reward:  282.2107594154784
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.8625619692574893
DONE TAKING  100  STEPS.
Total reward:  332.08006923248234
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.45871055981024755
DONE TAKING  100  STEPS.
Total reward:  325.94951803927137
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.11509344550634429
DONE TAKING  100  STEPS.
Total reward:  351.46232138863405
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.8691265707110433
DONE TAKING  100  STEPS.
Total reward:  315.5498474549689
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.3164217186051712
DONE TAKING  100  STEPS.
Total reward:  309.27322311313026
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.20401634336613306
DONE TAKING  100  STEPS.
Total reward:  323.41027351308685
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.1331190700127252
DONE TAKING  70  STEPS.
Total reward:  199.37678385319373
Time for 1 rollout: 2.98 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.006445067006727714
DONE TAKING  100  STEPS.
Total reward:  341.6650620200968
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.6699701913368589
DONE TAKING  100  STEPS.
Total reward:  307.0499645334795
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -1.0071278057766078
DONE TAKING  100  STEPS.
Total reward:  351.3525030214385
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.6849254173769268
DONE TAKING  100  STEPS.
Total reward:  313.55092189167414
Time for 1 rollout: 4.89 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter32.ckpt

#####################################
Training the dynamics model..... iteration  33
#####################################

    amount of random data:  20000
    amount of onPol data:  87117

=== Epoch 0 ===
    train loss:  0.2075340969464447
    val rand:  0.09091588606437047
    val onPol:  0.09183416267236073

=== Epoch 10 ===
    train loss:  0.03864929358227343
    val rand:  0.03697740534941355
    val onPol:  0.03839511672655741

=== Epoch 20 ===
    train loss:  0.030835272649986836
    val rand:  0.030436543747782707
    val onPol:  0.031100332426528137

=== Epoch 30 ===
    train loss:  0.026735301424242273
    val rand:  0.026489035536845524
    val onPol:  0.027021560507516067

=== Epoch 39 ===
    train loss:  0.024166678255306013
    val rand:  0.024329292277495067
    val onPol:  0.02446747695406278
Training duration: 13.47 s

#####################################
performing on-policy MPC rollouts... iter  33
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.5212652501266475
DONE TAKING  100  STEPS.
Total reward:  355.0219723052472
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.4315405394236307
DONE TAKING  100  STEPS.
Total reward:  371.8311361663774
Time for 1 rollout: 4.77 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.16746307223649656
DONE TAKING  100  STEPS.
Total reward:  310.54856361662473
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.1348072708744353
DONE TAKING  100  STEPS.
Total reward:  330.55211283718177
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.8228281259505181
DONE TAKING  100  STEPS.
Total reward:  351.30498403137204
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.4287050460132953
DONE TAKING  100  STEPS.
Total reward:  398.3316839271805
Time for 1 rollout: 4.52 s



####################### Performing MPC rollout # 6
done step  0 , rew:  0.6749007482991725
DONE TAKING  100  STEPS.
Total reward:  324.84849355114034
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.33639713528598525
DONE TAKING  100  STEPS.
Total reward:  350.3450627200871
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -2.063091040118807
DONE TAKING  100  STEPS.
Total reward:  347.21760154559985
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.2794244713320115
DONE TAKING  100  STEPS.
Total reward:  342.7150645029463
Time for 1 rollout: 5.03 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.3463567389420867
DONE TAKING  100  STEPS.
Total reward:  380.8438611433282
Time for 1 rollout: 4.94 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.522683658516351
DONE TAKING  100  STEPS.
Total reward:  292.49222835580025
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.3431217822868907
DONE TAKING  100  STEPS.
Total reward:  340.71711425502673
Time for 1 rollout: 4.72 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.6095319536305757
DONE TAKING  100  STEPS.
Total reward:  319.9571355898682
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.5554984631486961
DONE TAKING  100  STEPS.
Total reward:  361.6896373040965
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.4422980438281371
DONE TAKING  100  STEPS.
Total reward:  319.1524119365845
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.10560729091446791
DONE TAKING  100  STEPS.
Total reward:  324.65810697816903
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.6548965593591995
DONE TAKING  100  STEPS.
Total reward:  366.66436613356194
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.9938805121541944
DONE TAKING  100  STEPS.
Total reward:  331.33039804396594
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.26522188368517446
DONE TAKING  100  STEPS.
Total reward:  359.96101045441117
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.3757401337855567
DONE TAKING  100  STEPS.
Total reward:  315.8993970279538
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.36156850956637615
DONE TAKING  100  STEPS.
Total reward:  310.33632449094307
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.059527674297396194
DONE TAKING  100  STEPS.
Total reward:  317.744202044136
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.5091161549654579
DONE TAKING  100  STEPS.
Total reward:  294.14339542223917
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.823818583928041
DONE TAKING  100  STEPS.
Total reward:  378.328357975843
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.3086053362010157
DONE TAKING  100  STEPS.
Total reward:  330.07891734376494
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.3049411160762414
DONE TAKING  100  STEPS.
Total reward:  360.05055261232496
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.1169023249246357
DONE TAKING  100  STEPS.
Total reward:  288.37557742469244
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.38235815782603133
DONE TAKING  100  STEPS.
Total reward:  351.39148107686674
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.30895659914094664
DONE TAKING  100  STEPS.
Total reward:  368.85145509420937
Time for 1 rollout: 4.26 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter33.ckpt

#####################################
Training the dynamics model..... iteration  34
#####################################

    amount of random data:  20000
    amount of onPol data:  89844

=== Epoch 0 ===
    train loss:  0.1980201995667116
    val rand:  0.08688545972108841
    val onPol:  0.0877254344522953

=== Epoch 10 ===
    train loss:  0.03785986342915782
    val rand:  0.03631550073623657
    val onPol:  0.038022310162583985

=== Epoch 20 ===
    train loss:  0.029917076414014088
    val rand:  0.029637018218636513
    val onPol:  0.030006383856137592

=== Epoch 30 ===
    train loss:  0.025996670494844883
    val rand:  0.026572422434886295
    val onPol:  0.026169315601388615

=== Epoch 39 ===
    train loss:  0.02346503789778109
    val rand:  0.023897141218185425
    val onPol:  0.023530815728008747
Training duration: 15.08 s

#####################################
performing on-policy MPC rollouts... iter  34
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.6638543795272492
DONE TAKING  100  STEPS.
Total reward:  349.892923071388
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.16217908182027058
DONE TAKING  100  STEPS.
Total reward:  360.0894702547832
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -1.277771841658286
DONE TAKING  100  STEPS.
Total reward:  211.60863781262293
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.73162853681952
DONE TAKING  100  STEPS.
Total reward:  353.7094116852085
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.13779569870462408
DONE TAKING  100  STEPS.
Total reward:  300.90367396375353
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.49854241270868044
DONE TAKING  100  STEPS.
Total reward:  381.8277872492787
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.507404025926252
DONE TAKING  100  STEPS.
Total reward:  323.63542041751487
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5090212480277259
DONE TAKING  100  STEPS.
Total reward:  339.27438013565904
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.054816286810026066
DONE TAKING  100  STEPS.
Total reward:  316.77729864550736
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.6799406071078655
DONE TAKING  100  STEPS.
Total reward:  384.0904218152067
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.1261241356219004
DONE TAKING  100  STEPS.
Total reward:  330.73797134506117
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.4263976925471887
DONE TAKING  100  STEPS.
Total reward:  271.9621482171181
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.6707231074068524
DONE TAKING  100  STEPS.
Total reward:  427.0205451188432
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.016775500924341658
DONE TAKING  100  STEPS.
Total reward:  384.2980501472533
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.49373804493671264
DONE TAKING  100  STEPS.
Total reward:  363.22568045333503
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.5725361450751245
DONE TAKING  100  STEPS.
Total reward:  339.82353368203155
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.7391515737439879
DONE TAKING  100  STEPS.
Total reward:  356.2782627256578
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.6175632667190541
DONE TAKING  100  STEPS.
Total reward:  371.2224302262188
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.7812824432302358
DONE TAKING  100  STEPS.
Total reward:  342.90063495193135
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.6545185960298449
DONE TAKING  100  STEPS.
Total reward:  360.0976224852564
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.3749718033923712
DONE TAKING  100  STEPS.
Total reward:  271.51532827042325
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.5615878612576277
DONE TAKING  100  STEPS.
Total reward:  322.9726929895442
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.37463679883462486
DONE TAKING  100  STEPS.
Total reward:  363.48784387911843
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.4000409513538913
DONE TAKING  100  STEPS.
Total reward:  269.50582876967076
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.4671437978210673
DONE TAKING  100  STEPS.
Total reward:  225.13636483911182
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.205936674439085
DONE TAKING  100  STEPS.
Total reward:  349.24538488687136
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.3019257342780806
DONE TAKING  100  STEPS.
Total reward:  341.2199051555795
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.2953504181638816
DONE TAKING  100  STEPS.
Total reward:  327.9188610838137
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.1384356997818067
DONE TAKING  100  STEPS.
Total reward:  352.69323133727795
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.38582232061157706
DONE TAKING  100  STEPS.
Total reward:  251.39076815310332
Time for 1 rollout: 4.35 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter34.ckpt

#####################################
Training the dynamics model..... iteration  35
#####################################

    amount of random data:  20000
    amount of onPol data:  92571

=== Epoch 0 ===
    train loss:  0.20123976460063314
    val rand:  0.08848227808872859
    val onPol:  0.08791552732388179

=== Epoch 10 ===
    train loss:  0.038732963827360106
    val rand:  0.0377091479798158
    val onPol:  0.03816226248939832

=== Epoch 20 ===
    train loss:  0.03054689227726804
    val rand:  0.030087110276023548
    val onPol:  0.030486054097612698

=== Epoch 30 ===
    train loss:  0.02642589684082083
    val rand:  0.02664881758391857
    val onPol:  0.026456142775714397

=== Epoch 39 ===
    train loss:  0.023867707699537277
    val rand:  0.024181780715783436
    val onPol:  0.023927458251516025
Training duration: 15.53 s

#####################################
performing on-policy MPC rollouts... iter  35
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -1.4679204125098761
DONE TAKING  100  STEPS.
Total reward:  305.6020389318842
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.2484054318536197
DONE TAKING  100  STEPS.
Total reward:  349.93628653868876
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7538964586763459
DONE TAKING  100  STEPS.
Total reward:  341.1173355761219
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.6565783885492709
DONE TAKING  100  STEPS.
Total reward:  328.3562562281829
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.016731187812953116
DONE TAKING  100  STEPS.
Total reward:  300.41875654104905
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.6704019682433633
DONE TAKING  100  STEPS.
Total reward:  350.8411499788486
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.4184195191180363
DONE TAKING  100  STEPS.
Total reward:  413.7440801725093
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -1.3666404480713554
DONE TAKING  100  STEPS.
Total reward:  162.06663334410223
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.14924337253031988
DONE TAKING  100  STEPS.
Total reward:  364.88162620452107
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.19694381001799763
DONE TAKING  100  STEPS.
Total reward:  350.04900992909853
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.8102796804816578
DONE TAKING  100  STEPS.
Total reward:  320.8963606590208
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.5557848965434475
DONE TAKING  100  STEPS.
Total reward:  301.21647253478943
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.6341792585872882
DONE TAKING  100  STEPS.
Total reward:  334.0963905077889
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.12484628963064026
DONE TAKING  100  STEPS.
Total reward:  337.84683945481356
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.4764290782924797
DONE TAKING  100  STEPS.
Total reward:  330.16316911682736
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.14813065194837727
DONE TAKING  100  STEPS.
Total reward:  322.1651697090908
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.5053589433156227
DONE TAKING  100  STEPS.
Total reward:  274.83884712621926
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.2958680610868983
DONE TAKING  100  STEPS.
Total reward:  355.77375878070177
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.7639438778689239
DONE TAKING  100  STEPS.
Total reward:  341.2357626449054
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.981065137848358
DONE TAKING  100  STEPS.
Total reward:  307.6924996717766
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.009998230463497071
DONE TAKING  100  STEPS.
Total reward:  408.0582375307154
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.05390027783692784
DONE TAKING  100  STEPS.
Total reward:  379.1073133448739
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -1.1490311125525934
DONE TAKING  100  STEPS.
Total reward:  325.91657476142944
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.3656973984004152
DONE TAKING  100  STEPS.
Total reward:  358.3516288547964
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -1.1781412558028543
DONE TAKING  100  STEPS.
Total reward:  372.06888705024767
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.5689528204613125
DONE TAKING  100  STEPS.
Total reward:  376.3953423913363
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.15221019100820316
DONE TAKING  100  STEPS.
Total reward:  329.0782396053733
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.0152683255195907
DONE TAKING  100  STEPS.
Total reward:  374.17458365991666
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.7226792358581442
DONE TAKING  100  STEPS.
Total reward:  341.15520511645076
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.06226589973732877
DONE TAKING  100  STEPS.
Total reward:  376.5848774736826
Time for 1 rollout: 4.30 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
10.218050341568606
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.685577214270135
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter35.ckpt

#####################################
Training the dynamics model..... iteration  36
#####################################

    amount of random data:  20000
    amount of onPol data:  95298

=== Epoch 0 ===
    train loss:  0.20183910061331356
    val rand:  0.08913613607486089
    val onPol:  0.08875054121017456

=== Epoch 10 ===
    train loss:  0.03809559437281945
    val rand:  0.03718679522474607
    val onPol:  0.0376215148717165

=== Epoch 20 ===
    train loss:  0.03045979321879499
    val rand:  0.030394565934936207
    val onPol:  0.030404741254945595

=== Epoch 30 ===
    train loss:  0.02636566230041139
    val rand:  0.026568190505107243
    val onPol:  0.026656036886076134

=== Epoch 39 ===
    train loss:  0.023669209616149173
    val rand:  0.024029243116577465
    val onPol:  0.023758618161082268
Training duration: 13.27 s

#####################################
performing on-policy MPC rollouts... iter  36
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.30912993471709654
DONE TAKING  100  STEPS.
Total reward:  346.3137821933185
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.6567609183637435
DONE TAKING  100  STEPS.
Total reward:  285.3251430419604
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7534813441293919
DONE TAKING  100  STEPS.
Total reward:  321.22036086773346
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.533748441858143
DONE TAKING  100  STEPS.
Total reward:  357.31560447056705
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.1764177372947118
DONE TAKING  100  STEPS.
Total reward:  318.2417395974331
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.4177967431295734
DONE TAKING  100  STEPS.
Total reward:  340.4898316117169
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.8484911842709053
DONE TAKING  100  STEPS.
Total reward:  329.2304005977454
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.5335273403331788
DONE TAKING  100  STEPS.
Total reward:  239.87343980664272
Time for 1 rollout: 4.51 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.3847905509320716
DONE TAKING  100  STEPS.
Total reward:  294.55595704023
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.0425395051342747
DONE TAKING  100  STEPS.
Total reward:  388.09368150647424
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.380914382261179
DONE TAKING  100  STEPS.
Total reward:  361.59296321336393
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.7315835220357255
DONE TAKING  100  STEPS.
Total reward:  353.18619329286844
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.3488455487240789
DONE TAKING  100  STEPS.
Total reward:  360.48128598954565
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.6760786403096073
DONE TAKING  100  STEPS.
Total reward:  280.5148314674239
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.20673839736962352
DONE TAKING  100  STEPS.
Total reward:  378.0371849739505
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.9079245296898731
DONE TAKING  100  STEPS.
Total reward:  336.22814579633
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.12734617518385669
DONE TAKING  100  STEPS.
Total reward:  310.2580861520042
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.20120914829352807
DONE TAKING  100  STEPS.
Total reward:  277.44976829986524
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.8770391976151861
DONE TAKING  100  STEPS.
Total reward:  341.2618784193923
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.6063188946890079
DONE TAKING  100  STEPS.
Total reward:  357.8545025313668
Time for 1 rollout: 4.93 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.29687722960900814
DONE TAKING  100  STEPS.
Total reward:  347.74070461048854
Time for 1 rollout: 4.95 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.4794580162659413
DONE TAKING  100  STEPS.
Total reward:  301.33371553221383
Time for 1 rollout: 4.78 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.32220277392395663
DONE TAKING  100  STEPS.
Total reward:  270.4253772941488
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.20885653744889804
DONE TAKING  100  STEPS.
Total reward:  401.7127238810147
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.09172153476642769
DONE TAKING  100  STEPS.
Total reward:  311.1334807544451
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.4486549048432823
DONE TAKING  100  STEPS.
Total reward:  363.15897067296964
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.43414281220658996
DONE TAKING  100  STEPS.
Total reward:  355.4317450555854
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.7595739654692175
DONE TAKING  100  STEPS.
Total reward:  324.4116901362175
Time for 1 rollout: 4.93 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -1.005262085324763
DONE TAKING  100  STEPS.
Total reward:  333.30314486535394
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.0003375948765167
DONE TAKING  100  STEPS.
Total reward:  338.77729564358964
Time for 1 rollout: 4.88 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter36.ckpt

#####################################
Training the dynamics model..... iteration  37
#####################################

    amount of random data:  20000
    amount of onPol data:  98025

=== Epoch 0 ===
    train loss:  0.19548134360162692
    val rand:  0.08651627600193024
    val onPol:  0.08683868178299495

=== Epoch 10 ===
    train loss:  0.03725495514855988
    val rand:  0.03585586200157801
    val onPol:  0.037823288036244254

=== Epoch 20 ===
    train loss:  0.029969529580624623
    val rand:  0.029310429468750954
    val onPol:  0.030731850702847754

=== Epoch 30 ===
    train loss:  0.026018750885951108
    val rand:  0.025787121926744778
    val onPol:  0.02651889648820673

=== Epoch 39 ===
    train loss:  0.02342439845375631
    val rand:  0.023573073868950207
    val onPol:  0.024189267041427747
Training duration: 12.39 s

#####################################
performing on-policy MPC rollouts... iter  37
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.5382968640406278
DONE TAKING  100  STEPS.
Total reward:  313.31185207106284
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.21662812259888914
DONE TAKING  100  STEPS.
Total reward:  358.8974176662013
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.40352543472907965
DONE TAKING  100  STEPS.
Total reward:  374.7175711173248
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.21695402977922115
DONE TAKING  100  STEPS.
Total reward:  314.27467514542286
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.1210757157949252
DONE TAKING  100  STEPS.
Total reward:  290.8127916696345
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.1000611253137447
DONE TAKING  100  STEPS.
Total reward:  380.6304548659849
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.060846224049211306
DONE TAKING  100  STEPS.
Total reward:  360.005163633601
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.7703003334411657
DONE TAKING  100  STEPS.
Total reward:  363.35113890408576
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.3769379537766083
DONE TAKING  100  STEPS.
Total reward:  353.28769625661454
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.1778045323107198
DONE TAKING  100  STEPS.
Total reward:  316.72204520057824
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.16716749252153523
DONE TAKING  100  STEPS.
Total reward:  342.1757627926299
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.24324990500143223
DONE TAKING  100  STEPS.
Total reward:  349.10414912271966
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.5510046055348407
DONE TAKING  100  STEPS.
Total reward:  386.57351958341235
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.37271932015180875
DONE TAKING  100  STEPS.
Total reward:  375.31812645432854
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.07719378313629952
DONE TAKING  100  STEPS.
Total reward:  330.2676865059087
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -1.3418719689659473
DONE TAKING  100  STEPS.
Total reward:  184.66927725997857
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.32221432352541546
DONE TAKING  100  STEPS.
Total reward:  383.57365298607255
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.43199167969132934
DONE TAKING  100  STEPS.
Total reward:  352.55536654773715
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.20626994186348313
DONE TAKING  100  STEPS.
Total reward:  345.92031346959425
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.12137739741618103
DONE TAKING  100  STEPS.
Total reward:  330.334098881132
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.04988507780997831
DONE TAKING  100  STEPS.
Total reward:  340.3802437395016
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.31143395597337625
DONE TAKING  100  STEPS.
Total reward:  348.1297973836645
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.3405714328437527
DONE TAKING  100  STEPS.
Total reward:  284.19711580073283
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.0030265791111024
DONE TAKING  100  STEPS.
Total reward:  333.13114480993903
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.6372457656490281
DONE TAKING  100  STEPS.
Total reward:  374.32789647596877
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.3917708707254426
DONE TAKING  100  STEPS.
Total reward:  345.0196144284974
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.07571418076477758
DONE TAKING  100  STEPS.
Total reward:  354.4727358830202
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.09797082225340042
DONE TAKING  100  STEPS.
Total reward:  380.9713451198158
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.7604484984272203
DONE TAKING  100  STEPS.
Total reward:  349.03182342380455
Time for 1 rollout: 4.19 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.1009782033402753
DONE TAKING  100  STEPS.
Total reward:  339.65922089967677
Time for 1 rollout: 4.18 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter37.ckpt

#####################################
Training the dynamics model..... iteration  38
#####################################

    amount of random data:  20000
    amount of onPol data:  100752

=== Epoch 0 ===
    train loss:  0.18748004626896647
    val rand:  0.08522658546765645
    val onPol:  0.08602515501635415

=== Epoch 10 ===
    train loss:  0.03677956031428443
    val rand:  0.03547446429729462
    val onPol:  0.03728608414530754

=== Epoch 20 ===
    train loss:  0.02951759162048499
    val rand:  0.029065399741133053
    val onPol:  0.030096636286803653

=== Epoch 30 ===
    train loss:  0.025590389656523865
    val rand:  0.025505512952804565
    val onPol:  0.026296177612883703

=== Epoch 39 ===
    train loss:  0.02300583968559901
    val rand:  0.02347632683813572
    val onPol:  0.023752014551843916
Training duration: 12.27 s

#####################################
performing on-policy MPC rollouts... iter  38
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.17722203544480586
DONE TAKING  100  STEPS.
Total reward:  317.8652466990054
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.14648182798549828
DONE TAKING  100  STEPS.
Total reward:  381.5388140390078
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.24720307208414694
DONE TAKING  100  STEPS.
Total reward:  365.2804343910093
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.17237632664260877
DONE TAKING  100  STEPS.
Total reward:  387.19387713001237
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.2420800970989199
DONE TAKING  100  STEPS.
Total reward:  373.263763351141
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.06938993969446655
DONE TAKING  100  STEPS.
Total reward:  309.58441317144656
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.2704273518606993
DONE TAKING  100  STEPS.
Total reward:  349.9765681976149
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.39385736808456095
DONE TAKING  100  STEPS.
Total reward:  317.9158972179173
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.004439247118404356
DONE TAKING  100  STEPS.
Total reward:  320.3513234068872
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.6938306541522234
DONE TAKING  100  STEPS.
Total reward:  352.4989588760241
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.38673269453133213
DONE TAKING  100  STEPS.
Total reward:  339.1308673832926
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.20563976640848447
DONE TAKING  100  STEPS.
Total reward:  331.41697805904903
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.05310261602933006
DONE TAKING  100  STEPS.
Total reward:  350.99370420357644
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.7131489526571149
DONE TAKING  100  STEPS.
Total reward:  371.17833104360005
Time for 1 rollout: 4.20 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -1.172480558242401
DONE TAKING  100  STEPS.
Total reward:  373.2195127465172
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.3105223750355853
DONE TAKING  100  STEPS.
Total reward:  320.7852718094492
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.6816763831644257
DONE TAKING  100  STEPS.
Total reward:  361.4787562214866
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.978192805262059
DONE TAKING  100  STEPS.
Total reward:  344.520391331325
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.7200584620587434
DONE TAKING  100  STEPS.
Total reward:  336.8371886826554
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.26567621061141
DONE TAKING  100  STEPS.
Total reward:  337.27348538299117
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.0225156341873666
DONE TAKING  100  STEPS.
Total reward:  364.0827371304327
Time for 1 rollout: 4.21 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.05990130395762569
DONE TAKING  100  STEPS.
Total reward:  327.8957439626405
Time for 1 rollout: 4.48 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.16429394769178607
DONE TAKING  100  STEPS.
Total reward:  367.25563016526695
Time for 1 rollout: 4.95 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.4326850241308011
DONE TAKING  100  STEPS.
Total reward:  302.301688848238
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.18004609853273829
DONE TAKING  100  STEPS.
Total reward:  356.1717248208391
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.3091997151582313
DONE TAKING  100  STEPS.
Total reward:  375.0780725710658
Time for 1 rollout: 4.56 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.366838687535885
DONE TAKING  100  STEPS.
Total reward:  354.7935511879259
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.588817479819725
DONE TAKING  100  STEPS.
Total reward:  372.8333516602731
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.017967315424117614
DONE TAKING  100  STEPS.
Total reward:  342.8418824132188
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.1801785325849248
DONE TAKING  100  STEPS.
Total reward:  325.3774074304443
Time for 1 rollout: 4.29 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter38.ckpt

#####################################
Training the dynamics model..... iteration  39
#####################################

    amount of random data:  20000
    amount of onPol data:  103479

=== Epoch 0 ===
    train loss:  0.20137395653063836
    val rand:  0.08720376839240392
    val onPol:  0.08786628714629582

=== Epoch 10 ===
    train loss:  0.03725909251395775
    val rand:  0.03573531781633695
    val onPol:  0.03751240511025701

=== Epoch 20 ===
    train loss:  0.02980097500688356
    val rand:  0.02949989524980386
    val onPol:  0.03063829935022763

=== Epoch 30 ===
    train loss:  0.025645240027781412
    val rand:  0.02589218070109685
    val onPol:  0.026065310995493616

=== Epoch 39 ===
    train loss:  0.02307287449746028
    val rand:  0.023685078447063763
    val onPol:  0.02359053253063134
Training duration: 12.85 s

#####################################
performing on-policy MPC rollouts... iter  39
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.8963827959245413
DONE TAKING  100  STEPS.
Total reward:  304.46103758086025
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.16787742791506713
DONE TAKING  100  STEPS.
Total reward:  354.85545008853865
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.06717343016113608
DONE TAKING  100  STEPS.
Total reward:  303.9358995349723
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.8876414032473706
DONE TAKING  100  STEPS.
Total reward:  277.1779238790883
Time for 1 rollout: 4.48 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.2872465885528648
DONE TAKING  100  STEPS.
Total reward:  342.00602857383296
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.8729228093009325
DONE TAKING  100  STEPS.
Total reward:  273.2096022471363
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.21253797019778695
DONE TAKING  100  STEPS.
Total reward:  309.2694984513229
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.32479743318973875
DONE TAKING  100  STEPS.
Total reward:  330.74290409881826
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.8398476453878471
DONE TAKING  100  STEPS.
Total reward:  356.35812507682056
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.542023944245097
DONE TAKING  100  STEPS.
Total reward:  339.26550266922084
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.8537385285414278
DONE TAKING  100  STEPS.
Total reward:  279.6369215029717
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.6070764348003784
DONE TAKING  100  STEPS.
Total reward:  364.40393673658957
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.28790162333681624
DONE TAKING  100  STEPS.
Total reward:  333.6511565383711
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.2967156453880257
DONE TAKING  100  STEPS.
Total reward:  354.85090800340754
Time for 1 rollout: 4.49 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.04470113266464906
DONE TAKING  100  STEPS.
Total reward:  313.4076974647267
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.6351655456230463
DONE TAKING  100  STEPS.
Total reward:  315.94974824465817
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 16
done step  0 , rew:  0.08495477859850273
DONE TAKING  100  STEPS.
Total reward:  354.01823179750295
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.14577305247909872
DONE TAKING  100  STEPS.
Total reward:  356.8753717758735
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.6367794451765637
DONE TAKING  100  STEPS.
Total reward:  298.5378230985165
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.686817870200235
DONE TAKING  100  STEPS.
Total reward:  281.5288496247525
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.5528891915364851
DONE TAKING  100  STEPS.
Total reward:  349.44229733314063
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.0028075742357927397
DONE TAKING  100  STEPS.
Total reward:  337.9860934716577
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.6377749823104113
DONE TAKING  100  STEPS.
Total reward:  322.0662613482459
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.7843821664736873
DONE TAKING  100  STEPS.
Total reward:  298.9322116407547
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.6436589162807395
DONE TAKING  100  STEPS.
Total reward:  344.70748295889854
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -1.1717042384072247
DONE TAKING  100  STEPS.
Total reward:  307.8496086379247
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.4960798575141814
DONE TAKING  100  STEPS.
Total reward:  322.9082253916304
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.3617674807905855
DONE TAKING  100  STEPS.
Total reward:  7.654780193363967
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.040800154412115056
DONE TAKING  100  STEPS.
Total reward:  394.8375130406864
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.6447279248206801
DONE TAKING  100  STEPS.
Total reward:  377.79750330247595
Time for 1 rollout: 4.29 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter39.ckpt

#####################################
Training the dynamics model..... iteration  40
#####################################

    amount of random data:  20000
    amount of onPol data:  106206

=== Epoch 0 ===
    train loss:  0.18000410782529952
    val rand:  0.08325810233751933
    val onPol:  0.08298639740262713

=== Epoch 10 ===
    train loss:  0.03597387869624381
    val rand:  0.03464447086056074
    val onPol:  0.03642619241561208

=== Epoch 20 ===
    train loss:  0.028608993845100097
    val rand:  0.028197328249613445
    val onPol:  0.02908833883702755

=== Epoch 30 ===
    train loss:  0.024754237324157928
    val rand:  0.02478766379257043
    val onPol:  0.025137579600725855

=== Epoch 39 ===
    train loss:  0.022261962770147525
    val rand:  0.022568884616096813
    val onPol:  0.022656407207250595
Training duration: 16.30 s

#####################################
performing on-policy MPC rollouts... iter  40
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.7978354977479899
DONE TAKING  100  STEPS.
Total reward:  350.7787290924502
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.686083032623358
DONE TAKING  100  STEPS.
Total reward:  373.16165978604016
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.29330605698416107
DONE TAKING  100  STEPS.
Total reward:  370.3004789059706
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.5366109728487173
DONE TAKING  100  STEPS.
Total reward:  63.21973710496287
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.15407784300174032
DONE TAKING  100  STEPS.
Total reward:  339.2260726679588
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 5
done step  0 , rew:  1.1025879105933167
DONE TAKING  100  STEPS.
Total reward:  258.37183235696887
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.934644725628415
DONE TAKING  100  STEPS.
Total reward:  359.23969995432975
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.33588956311761825
DONE TAKING  100  STEPS.
Total reward:  338.9106918927435
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.13132601048881887
DONE TAKING  100  STEPS.
Total reward:  350.85869641391093
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.7640311676953355
DONE TAKING  100  STEPS.
Total reward:  365.2988448352834
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.09813306872556463
DONE TAKING  100  STEPS.
Total reward:  409.4789079138258
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.09806302167767394
DONE TAKING  100  STEPS.
Total reward:  370.9476322098645
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.8167920366581761
DONE TAKING  100  STEPS.
Total reward:  341.2397843758542
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 13
done step  0 , rew:  0.12815797868319287
DONE TAKING  100  STEPS.
Total reward:  321.40627551172213
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.3247960296497574
DONE TAKING  100  STEPS.
Total reward:  355.694324855713
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.07158612305393242
DONE TAKING  100  STEPS.
Total reward:  387.7957510658206
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.29850519159305666
DONE TAKING  100  STEPS.
Total reward:  354.81369852632287
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.6919471751386619
DONE TAKING  100  STEPS.
Total reward:  344.585542267548
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.0005569196150884345
DONE TAKING  100  STEPS.
Total reward:  374.39328361801716
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.9221250023249494
DONE TAKING  81  STEPS.
Total reward:  259.1932393624811
Time for 1 rollout: 3.42 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.3670271221299779
DONE TAKING  100  STEPS.
Total reward:  355.36431122329896
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.1842910579238668
DONE TAKING  100  STEPS.
Total reward:  402.297913735722
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.36507746827884546
DONE TAKING  100  STEPS.
Total reward:  322.57982082245803
Time for 1 rollout: 4.77 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.6800791745337138
DONE TAKING  100  STEPS.
Total reward:  313.3743920762986
Time for 1 rollout: 4.89 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.10323621649171527
DONE TAKING  100  STEPS.
Total reward:  -3.1062526222142886
Time for 1 rollout: 4.90 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.08050850062217696
DONE TAKING  100  STEPS.
Total reward:  355.4367256924845
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.44324218414214595
DONE TAKING  100  STEPS.
Total reward:  376.6700720637919
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.2289752010430216
DONE TAKING  100  STEPS.
Total reward:  360.4178731967506
Time for 1 rollout: 4.79 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.2729074180793044
DONE TAKING  100  STEPS.
Total reward:  372.31563011806355
Time for 1 rollout: 4.80 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -1.25487987876555
DONE TAKING  100  STEPS.
Total reward:  373.1754239122437
Time for 1 rollout: 4.88 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
13.122880175503116
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.4975473452440244
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter40.ckpt

#####################################
Training the dynamics model..... iteration  41
#####################################

    amount of random data:  20000
    amount of onPol data:  108914

=== Epoch 0 ===
    train loss:  0.183196209759141
    val rand:  0.08379542827606201
    val onPol:  0.08332884418112892

=== Epoch 10 ===
    train loss:  0.03594334920247396
    val rand:  0.034909615914026894
    val onPol:  0.03602262320263045

=== Epoch 20 ===
    train loss:  0.028640461542333167
    val rand:  0.02835624727110068
    val onPol:  0.02879627953682627

=== Epoch 30 ===
    train loss:  0.024678390104478847
    val rand:  0.02491670846939087
    val onPol:  0.024995417733277594

=== Epoch 39 ===
    train loss:  0.022193183171718072
    val rand:  0.022480476647615433
    val onPol:  0.022380089919481958
Training duration: 17.09 s

#####################################
performing on-policy MPC rollouts... iter  41
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3759692946821619
DONE TAKING  100  STEPS.
Total reward:  367.1934341192548
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.12731239227803556
DONE TAKING  100  STEPS.
Total reward:  390.0901997757311
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.04993187368912294
DONE TAKING  100  STEPS.
Total reward:  316.69047870350227
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.05704096186960536
DONE TAKING  100  STEPS.
Total reward:  344.1584536331756
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.39552402510845425
DONE TAKING  100  STEPS.
Total reward:  330.4877011275938
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.1457588607879936
DONE TAKING  100  STEPS.
Total reward:  367.0112481434318
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.8987280398235661
DONE TAKING  100  STEPS.
Total reward:  247.8616323285763
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5667821406235962
DONE TAKING  100  STEPS.
Total reward:  208.6909424836791
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.036536519956553354
DONE TAKING  100  STEPS.
Total reward:  373.0030070946582
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.5590282268866749
DONE TAKING  100  STEPS.
Total reward:  331.5607215204022
Time for 1 rollout: 4.76 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.11191970278320351
DONE TAKING  100  STEPS.
Total reward:  329.36694672822415
Time for 1 rollout: 4.57 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.38596936667619164
DONE TAKING  100  STEPS.
Total reward:  290.481984411438
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.6640231661601472
DONE TAKING  100  STEPS.
Total reward:  268.74921074489805
Time for 1 rollout: 4.80 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.38950082308699757
DONE TAKING  100  STEPS.
Total reward:  349.3170832947564
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.045674059960430974
DONE TAKING  100  STEPS.
Total reward:  374.7325081594618
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.14568157271833962
DONE TAKING  100  STEPS.
Total reward:  366.87682844014904
Time for 1 rollout: 5.03 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5174136470788607
DONE TAKING  100  STEPS.
Total reward:  333.2042518613901
Time for 1 rollout: 4.95 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.9262369593820293
DONE TAKING  100  STEPS.
Total reward:  361.283564935869
Time for 1 rollout: 4.98 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.6810078827192485
DONE TAKING  100  STEPS.
Total reward:  394.0396144629172
Time for 1 rollout: 4.96 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.1906356050061904
DONE TAKING  100  STEPS.
Total reward:  342.49488164259384
Time for 1 rollout: 4.96 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.6085394791354828
DONE TAKING  100  STEPS.
Total reward:  361.2789116058556
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.9198121501822631
DONE TAKING  100  STEPS.
Total reward:  320.33091807983044
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.04530467647589735
DONE TAKING  100  STEPS.
Total reward:  372.97856637123624
Time for 1 rollout: 4.75 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -1.3294803009663987
DONE TAKING  100  STEPS.
Total reward:  315.93151735342104
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.047274187391590825
DONE TAKING  100  STEPS.
Total reward:  222.39809959901797
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.20350864578067063
DONE TAKING  96  STEPS.
Total reward:  298.2530222825587
Time for 1 rollout: 4.57 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.14150019537345412
DONE TAKING  100  STEPS.
Total reward:  394.6574399808613
Time for 1 rollout: 4.78 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.1704355980642659
DONE TAKING  100  STEPS.
Total reward:  372.7936973492015
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.46707643285257533
DONE TAKING  100  STEPS.
Total reward:  306.9118311783724
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.5243349683338283
DONE TAKING  100  STEPS.
Total reward:  334.91534470584014
Time for 1 rollout: 4.82 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter41.ckpt

#####################################
Training the dynamics model..... iteration  42
#####################################

    amount of random data:  20000
    amount of onPol data:  111637

=== Epoch 0 ===
    train loss:  0.19054183234669725
    val rand:  0.08486800144116084
    val onPol:  0.08469173099313464

=== Epoch 10 ===
    train loss:  0.036642745935491154
    val rand:  0.03555104757348696
    val onPol:  0.036747356078454425

=== Epoch 20 ===
    train loss:  0.029058492704465682
    val rand:  0.028976864491899807
    val onPol:  0.029595829812543734

=== Epoch 30 ===
    train loss:  0.02514818202400086
    val rand:  0.025349571059147518
    val onPol:  0.02549384906888008

=== Epoch 39 ===
    train loss:  0.02267927927326183
    val rand:  0.02303505005935828
    val onPol:  0.02290112817926066
Training duration: 16.60 s

#####################################
performing on-policy MPC rollouts... iter  42
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.6622262464426363
DONE TAKING  100  STEPS.
Total reward:  361.46467832834253
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.15922318125190407
DONE TAKING  100  STEPS.
Total reward:  302.3097128081911
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.08264512849677408
DONE TAKING  100  STEPS.
Total reward:  342.76592486791486
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.23837756587099027
DONE TAKING  100  STEPS.
Total reward:  345.2321414438778
Time for 1 rollout: 4.48 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.7728813429504056
DONE TAKING  100  STEPS.
Total reward:  309.08243958472735
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.685162735857964
DONE TAKING  100  STEPS.
Total reward:  318.35958004215314
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.24877199497893426
DONE TAKING  100  STEPS.
Total reward:  376.4331713094746
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.07538313160214828
DONE TAKING  100  STEPS.
Total reward:  373.5044262677361
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.04080849151237584
DONE TAKING  100  STEPS.
Total reward:  344.9102629436641
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.31904285455956743
DONE TAKING  100  STEPS.
Total reward:  370.31236533823034
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.33280556030681074
DONE TAKING  100  STEPS.
Total reward:  374.53375621817804
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.17925694765587813
DONE TAKING  100  STEPS.
Total reward:  378.4937549874282
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.22451977104303433
DONE TAKING  100  STEPS.
Total reward:  306.4688153516599
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.7128185778869485
DONE TAKING  100  STEPS.
Total reward:  330.6762612600882
Time for 1 rollout: 4.44 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.07721084613123036
DONE TAKING  100  STEPS.
Total reward:  363.12247123486867
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.7915838782246031
DONE TAKING  100  STEPS.
Total reward:  360.895617296804
Time for 1 rollout: 4.74 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.073091455530593
DONE TAKING  100  STEPS.
Total reward:  320.798900924572
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.7951590660279438
DONE TAKING  100  STEPS.
Total reward:  330.40485630121
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.5432663282235972
DONE TAKING  100  STEPS.
Total reward:  332.7035685669921
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.0991923329681482
DONE TAKING  100  STEPS.
Total reward:  393.2235297337648
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.7210569734421115
DONE TAKING  100  STEPS.
Total reward:  379.9279381458508
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.937645017200412
DONE TAKING  100  STEPS.
Total reward:  326.8068460773093
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.9875830754854009
DONE TAKING  100  STEPS.
Total reward:  348.2976556773664
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.02976684931219291
DONE TAKING  100  STEPS.
Total reward:  333.1859811436893
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.3251878704845225
DONE TAKING  100  STEPS.
Total reward:  336.8190774994603
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.1593096711147289
DONE TAKING  100  STEPS.
Total reward:  321.8117713004305
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.33998834324229643
DONE TAKING  100  STEPS.
Total reward:  352.4566554078451
Time for 1 rollout: 4.46 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -1.1896918153204066
DONE TAKING  100  STEPS.
Total reward:  318.71951812809283
Time for 1 rollout: 4.45 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.40541537688460305
DONE TAKING  100  STEPS.
Total reward:  348.5933867083654
Time for 1 rollout: 4.71 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.1471216518017161
DONE TAKING  100  STEPS.
Total reward:  319.4958733504342
Time for 1 rollout: 4.82 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter42.ckpt

#####################################
Training the dynamics model..... iteration  43
#####################################

    amount of random data:  20000
    amount of onPol data:  114364

=== Epoch 0 ===
    train loss:  0.18243416003882884
    val rand:  0.08341046671072642
    val onPol:  0.08311399724334478

=== Epoch 10 ===
    train loss:  0.035793211087584494
    val rand:  0.03472757898271084
    val onPol:  0.035902021918445826

=== Epoch 20 ===
    train loss:  0.028678818587213755
    val rand:  0.028323878223697346
    val onPol:  0.029275722103193402

=== Epoch 30 ===
    train loss:  0.024731159545481204
    val rand:  0.024991881102323532
    val onPol:  0.025245228316634893

=== Epoch 39 ===
    train loss:  0.022346307933330537
    val rand:  0.02284392776588599
    val onPol:  0.02297671721316874
Training duration: 16.25 s

#####################################
performing on-policy MPC rollouts... iter  43
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.20608573270492844
DONE TAKING  100  STEPS.
Total reward:  400.66695383368216
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.24621971646255222
DONE TAKING  100  STEPS.
Total reward:  392.8369006153109
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.3369034536184827
DONE TAKING  100  STEPS.
Total reward:  376.65673482370346
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.6755330743736289
DONE TAKING  100  STEPS.
Total reward:  371.3429467086428
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.1436969285674078
DONE TAKING  100  STEPS.
Total reward:  368.9666830977555
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.1172029409919155
DONE TAKING  100  STEPS.
Total reward:  378.9610333710856
Time for 1 rollout: 4.51 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.4134754322113567
DONE TAKING  100  STEPS.
Total reward:  354.93610012342555
Time for 1 rollout: 4.65 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.31331899420440396
DONE TAKING  66  STEPS.
Total reward:  210.78203233830774
Time for 1 rollout: 3.07 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.7862269731638555
DONE TAKING  100  STEPS.
Total reward:  396.9038736424922
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -0.3469589291702841
DONE TAKING  100  STEPS.
Total reward:  357.12281883976596
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.35515355220025424
DONE TAKING  100  STEPS.
Total reward:  376.80336130769444
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.5749867365593604
DONE TAKING  100  STEPS.
Total reward:  388.6628688531168
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.3054735206245167
DONE TAKING  100  STEPS.
Total reward:  370.20513884530834
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5782136435997458
DONE TAKING  100  STEPS.
Total reward:  360.5028514216126
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.160736164845528
DONE TAKING  100  STEPS.
Total reward:  377.29054549514296
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.38220140170267924
DONE TAKING  100  STEPS.
Total reward:  387.3655391202366
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.349483994425222
DONE TAKING  100  STEPS.
Total reward:  336.83675692266434
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.9043751932582262
DONE TAKING  100  STEPS.
Total reward:  383.2092445004506
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.06959117900888151
DONE TAKING  100  STEPS.
Total reward:  308.9884203264039
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.22472820516449601
DONE TAKING  100  STEPS.
Total reward:  370.91943198178654
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.40212946079108214
DONE TAKING  100  STEPS.
Total reward:  349.3763067700987
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.6319849202406993
DONE TAKING  100  STEPS.
Total reward:  378.51185892105866
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.8686829412469282
DONE TAKING  100  STEPS.
Total reward:  276.4137881332951
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.36695702702601435
DONE TAKING  81  STEPS.
Total reward:  259.8124450624549
Time for 1 rollout: 3.51 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.516560917912627
DONE TAKING  100  STEPS.
Total reward:  330.4001206599961
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.2307612567320137
DONE TAKING  100  STEPS.
Total reward:  376.9404615211432
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.6952089048967381
DONE TAKING  100  STEPS.
Total reward:  334.61513447029387
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.4761653613392631
DONE TAKING  100  STEPS.
Total reward:  363.13585910794905
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.6646114610676719
DONE TAKING  100  STEPS.
Total reward:  324.5258226507819
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.5223494153403405
DONE TAKING  70  STEPS.
Total reward:  227.0686130790484
Time for 1 rollout: 3.03 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter43.ckpt

#####################################
Training the dynamics model..... iteration  44
#####################################

    amount of random data:  20000
    amount of onPol data:  117038

=== Epoch 0 ===
    train loss:  0.1762546126310732
    val rand:  0.08180475980043411
    val onPol:  0.08126216940581799

=== Epoch 10 ===
    train loss:  0.03535195553273547
    val rand:  0.034424250945448875
    val onPol:  0.03548554563894868

=== Epoch 20 ===
    train loss:  0.028300822566391205
    val rand:  0.028195015465219814
    val onPol:  0.028760453453287482

=== Epoch 30 ===
    train loss:  0.024606618993714743
    val rand:  0.02480829196671645
    val onPol:  0.024985275696963072

=== Epoch 39 ===
    train loss:  0.02215424658474969
    val rand:  0.02246122434735298
    val onPol:  0.0226398971863091
Training duration: 17.68 s

#####################################
performing on-policy MPC rollouts... iter  44
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.16500708643485593
DONE TAKING  100  STEPS.
Total reward:  330.71684951671403
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.6415149542519514
DONE TAKING  100  STEPS.
Total reward:  335.1798907011386
Time for 1 rollout: 4.32 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.004500285524253064
DONE TAKING  100  STEPS.
Total reward:  381.4238691222861
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -1.221929327752084
DONE TAKING  100  STEPS.
Total reward:  333.6142607758777
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.07134691656491564
DONE TAKING  100  STEPS.
Total reward:  319.62961742314724
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.5649015448048312
DONE TAKING  100  STEPS.
Total reward:  342.2374104201678
Time for 1 rollout: 4.52 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.7946838564845072
DONE TAKING  100  STEPS.
Total reward:  348.5877693728673
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.8318335073139516
DONE TAKING  100  STEPS.
Total reward:  312.78539832335287
Time for 1 rollout: 4.31 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.8623791620591528
DONE TAKING  100  STEPS.
Total reward:  391.4045255047451
Time for 1 rollout: 4.39 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.1879441128501275
DONE TAKING  100  STEPS.
Total reward:  412.90498873057794
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.3509391115786461
DONE TAKING  100  STEPS.
Total reward:  358.63098045461913
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.6895732549445481
DONE TAKING  100  STEPS.
Total reward:  307.4569697259648
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.2730329705897032
DONE TAKING  100  STEPS.
Total reward:  301.92150043234824
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.9691314683992892
DONE TAKING  100  STEPS.
Total reward:  352.7963974956016
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.7718471266594715
DONE TAKING  100  STEPS.
Total reward:  333.59798020833944
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -1.605394913231528
DONE TAKING  100  STEPS.
Total reward:  386.1091160116966
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5965582573042016
DONE TAKING  100  STEPS.
Total reward:  371.06488992221904
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.22692843688638872
DONE TAKING  100  STEPS.
Total reward:  235.82236298435262
Time for 1 rollout: 4.81 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.203596351161363
DONE TAKING  100  STEPS.
Total reward:  377.6941382751125
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.2290730018120972
DONE TAKING  100  STEPS.
Total reward:  330.45362632532004
Time for 1 rollout: 4.91 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.106824966153745
DONE TAKING  100  STEPS.
Total reward:  336.9854349892606
Time for 1 rollout: 4.70 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.3762078632869504
DONE TAKING  100  STEPS.
Total reward:  328.03822209027675
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.49174453153452996
DONE TAKING  100  STEPS.
Total reward:  342.4303666440035
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.6293209059247704
DONE TAKING  100  STEPS.
Total reward:  311.6570333558145
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.1975308127455685
DONE TAKING  100  STEPS.
Total reward:  373.45007547564296
Time for 1 rollout: 4.53 s



####################### Performing MPC rollout # 25
done step  0 , rew:  0.19425649291009695
DONE TAKING  100  STEPS.
Total reward:  294.1956353855917
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.5014017439904754
DONE TAKING  41  STEPS.
Total reward:  94.32705973704917
Time for 1 rollout: 1.97 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.04730923334875847
DONE TAKING  100  STEPS.
Total reward:  319.7127356087495
Time for 1 rollout: 4.89 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.23503253741828212
DONE TAKING  100  STEPS.
Total reward:  349.63806442773387
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.018839095254949367
DONE TAKING  100  STEPS.
Total reward:  338.67305178470633
Time for 1 rollout: 4.83 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter44.ckpt

#####################################
Training the dynamics model..... iteration  45
#####################################

    amount of random data:  20000
    amount of onPol data:  119706

=== Epoch 0 ===
    train loss:  0.18002567304155
    val rand:  0.0816828856865565
    val onPol:  0.08083152584731579

=== Epoch 10 ===
    train loss:  0.03525664127216889
    val rand:  0.034174121295412384
    val onPol:  0.035169719252735376

=== Epoch 20 ===
    train loss:  0.028134743933780834
    val rand:  0.02795827512939771
    val onPol:  0.028429474215954542

=== Epoch 30 ===
    train loss:  0.02424412639811635
    val rand:  0.02455220992366473
    val onPol:  0.024348551873117685

=== Epoch 39 ===
    train loss:  0.021732070877288397
    val rand:  0.021980542689561844
    val onPol:  0.02195557951927185
Training duration: 17.77 s

#####################################
performing on-policy MPC rollouts... iter  45
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.3664348103306654
DONE TAKING  100  STEPS.
Total reward:  78.09551657604906
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.3078373312162297
DONE TAKING  100  STEPS.
Total reward:  282.02067207349205
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.5370997965324835
DONE TAKING  100  STEPS.
Total reward:  329.6979565663802
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.4897420335783491
DONE TAKING  100  STEPS.
Total reward:  353.57039515388567
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.1729249989601627
DONE TAKING  100  STEPS.
Total reward:  356.3190906528631
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.5732529193776088
DONE TAKING  100  STEPS.
Total reward:  371.1894560773719
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.624261391261868
DONE TAKING  100  STEPS.
Total reward:  375.97879654562473
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.7093219756422113
DONE TAKING  100  STEPS.
Total reward:  370.3852604408654
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.21136685936537186
DONE TAKING  100  STEPS.
Total reward:  310.858783253859
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.16327744960717344
DONE TAKING  100  STEPS.
Total reward:  409.5052384663923
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -1.2129186741368514
DONE TAKING  100  STEPS.
Total reward:  409.93301036988186
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 11
done step  0 , rew:  0.1926082909268016
DONE TAKING  100  STEPS.
Total reward:  310.78885255834143
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.5288465023113558
DONE TAKING  100  STEPS.
Total reward:  374.477656794141
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.6636866921796798
DONE TAKING  100  STEPS.
Total reward:  358.492903949941
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.5465120688673559
DONE TAKING  100  STEPS.
Total reward:  327.4833005331014
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.502392394235304
DONE TAKING  100  STEPS.
Total reward:  380.0254230794687
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.3374365277479219
DONE TAKING  100  STEPS.
Total reward:  365.0482544738904
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.4800548264886949
DONE TAKING  100  STEPS.
Total reward:  372.12246421241844
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 18
done step  0 , rew:  0.19469922103484644
DONE TAKING  100  STEPS.
Total reward:  350.3268435682662
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -1.0803168000501402
DONE TAKING  100  STEPS.
Total reward:  391.7446260481108
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.36380386016559685
DONE TAKING  100  STEPS.
Total reward:  346.2790219550059
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 21
done step  0 , rew:  0.16869996457435574
DONE TAKING  100  STEPS.
Total reward:  386.28368167233936
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.553465579571113
DONE TAKING  100  STEPS.
Total reward:  342.47747122204595
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.29145932590357504
DONE TAKING  100  STEPS.
Total reward:  362.7098105570819
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.8754240063554135
DONE TAKING  100  STEPS.
Total reward:  376.8795866837634
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.0823727219499431
DONE TAKING  100  STEPS.
Total reward:  322.42425889409367
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.06794200036079567
DONE TAKING  100  STEPS.
Total reward:  392.20403800496695
Time for 1 rollout: 4.35 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.32713251499902807
DONE TAKING  100  STEPS.
Total reward:  355.2411351612953
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.6187139187423205
DONE TAKING  100  STEPS.
Total reward:  369.91375360298224
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.9400913610819563
DONE TAKING  100  STEPS.
Total reward:  388.2586800840171
Time for 1 rollout: 4.21 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
(101, 18)
std:  (101, 18)
pred:  (101, 18)
10.820575694588465
here
(100, 18)
std:  (100, 18)
pred:  (100, 18)
1.964471339764376
here
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter45.ckpt

#####################################
Training the dynamics model..... iteration  46
#####################################

    amount of random data:  20000
    amount of onPol data:  122433

=== Epoch 0 ===
    train loss:  0.17577027185064442
    val rand:  0.08079711099465688
    val onPol:  0.07948792725801468

=== Epoch 10 ===
    train loss:  0.034851738023308085
    val rand:  0.03329444738725821
    val onPol:  0.03462224826216698

=== Epoch 20 ===
    train loss:  0.02789622733264037
    val rand:  0.027539367477099102
    val onPol:  0.028248606249690056

=== Epoch 30 ===
    train loss:  0.024202276249679754
    val rand:  0.024178906654318173
    val onPol:  0.024307897314429283

=== Epoch 39 ===
    train loss:  0.021924111886687997
    val rand:  0.02212775560716788
    val onPol:  0.022089134203270078
Training duration: 18.40 s

#####################################
performing on-policy MPC rollouts... iter  46
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.073185567567943
DONE TAKING  100  STEPS.
Total reward:  321.2158359594015
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -0.6454744524654923
DONE TAKING  100  STEPS.
Total reward:  387.79830224506503
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.7234470570595699
DONE TAKING  100  STEPS.
Total reward:  381.3232628161239
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.23263578803953472
DONE TAKING  100  STEPS.
Total reward:  401.73210686469343
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 4
done step  0 , rew:  0.6957734559998231
DONE TAKING  100  STEPS.
Total reward:  377.1290072818879
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.07631023618669261
DONE TAKING  100  STEPS.
Total reward:  366.1717985393984
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.27389309074138246
DONE TAKING  100  STEPS.
Total reward:  344.92910743274257
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 7
done step  0 , rew:  0.658397005521733
DONE TAKING  100  STEPS.
Total reward:  330.8692542206981
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.6915523678044484
DONE TAKING  100  STEPS.
Total reward:  363.686640192954
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.060941447469947535
DONE TAKING  100  STEPS.
Total reward:  368.0807903415754
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.1213217813717299
DONE TAKING  100  STEPS.
Total reward:  427.79860676336426
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.6653291908102827
DONE TAKING  100  STEPS.
Total reward:  367.22246048957663
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.17954577385333373
DONE TAKING  100  STEPS.
Total reward:  365.1454803676315
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.1213169393761626
DONE TAKING  100  STEPS.
Total reward:  287.8917102719949
Time for 1 rollout: 4.22 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.7088122405361978
DONE TAKING  100  STEPS.
Total reward:  369.15019545824066
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 15
done step  0 , rew:  0.49705546764649666
DONE TAKING  100  STEPS.
Total reward:  334.67017763953316
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.0724104838422044
DONE TAKING  100  STEPS.
Total reward:  284.5398189423801
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.7754356167908
DONE TAKING  100  STEPS.
Total reward:  349.3621927960053
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -1.1006146214819608
DONE TAKING  100  STEPS.
Total reward:  342.48870083236113
Time for 1 rollout: 4.41 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.20160931665221446
DONE TAKING  100  STEPS.
Total reward:  392.98932630729246
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -1.1363368528088305
DONE TAKING  100  STEPS.
Total reward:  371.3254844809969
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.5750346571261972
DONE TAKING  100  STEPS.
Total reward:  350.4357295126053
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.5578948394910029
DONE TAKING  100  STEPS.
Total reward:  328.772400667632
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.0633428870262645
DONE TAKING  100  STEPS.
Total reward:  378.6363933504032
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.9455797697870626
DONE TAKING  100  STEPS.
Total reward:  342.83507581904524
Time for 1 rollout: 4.61 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.22124911669508923
DONE TAKING  100  STEPS.
Total reward:  382.6595345575501
Time for 1 rollout: 4.55 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.36211594356253296
DONE TAKING  100  STEPS.
Total reward:  322.72675822341057
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.45967348613911196
DONE TAKING  100  STEPS.
Total reward:  391.51880494104824
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.05268313048356674
DONE TAKING  100  STEPS.
Total reward:  365.9138117709446
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 29
done step  0 , rew:  0.47618724379729066
DONE TAKING  100  STEPS.
Total reward:  356.99153229234213
Time for 1 rollout: 4.83 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter46.ckpt

#####################################
Training the dynamics model..... iteration  47
#####################################

    amount of random data:  20000
    amount of onPol data:  125160

=== Epoch 0 ===
    train loss:  0.17717511075790282
    val rand:  0.08143421510855357
    val onPol:  0.08116870559751987

=== Epoch 10 ===
    train loss:  0.035292798101350116
    val rand:  0.03413414147992929
    val onPol:  0.03543108771555126

=== Epoch 20 ===
    train loss:  0.028140222498526175
    val rand:  0.02781650920708974
    val onPol:  0.028484119102358818

=== Epoch 30 ===
    train loss:  0.024224164430052042
    val rand:  0.024239804595708847
    val onPol:  0.02437711483798921

=== Epoch 39 ===
    train loss:  0.021722519408083625
    val rand:  0.021905674909551937
    val onPol:  0.022042129188776016
Training duration: 18.15 s

#####################################
performing on-policy MPC rollouts... iter  47
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.44556004824278567
DONE TAKING  100  STEPS.
Total reward:  330.26041308673786
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 1
done step  0 , rew:  -1.014224774307714
DONE TAKING  100  STEPS.
Total reward:  378.1588170833122
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -0.8069405928049077
DONE TAKING  100  STEPS.
Total reward:  182.50821424528982
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -1.2642156461926346
DONE TAKING  100  STEPS.
Total reward:  344.96519468682214
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.31931214581817613
DONE TAKING  100  STEPS.
Total reward:  322.76627339645813
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 5
done step  0 , rew:  0.4507354132725965
DONE TAKING  100  STEPS.
Total reward:  339.3264945032356
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.03307223679825619
DONE TAKING  100  STEPS.
Total reward:  341.33024270509844
Time for 1 rollout: 4.26 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5849610555426364
DONE TAKING  100  STEPS.
Total reward:  363.14946869202186
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 8
done step  0 , rew:  0.8835334940837641
DONE TAKING  100  STEPS.
Total reward:  351.82037239065016
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 9
done step  0 , rew:  -1.1055080934382677
DONE TAKING  100  STEPS.
Total reward:  411.96480351256633
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.303784273381381
DONE TAKING  100  STEPS.
Total reward:  333.9120662200153
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.6073972511461491
DONE TAKING  100  STEPS.
Total reward:  307.93021227514345
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.1377289011525601
DONE TAKING  100  STEPS.
Total reward:  330.85242871566425
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -0.5215305422151526
DONE TAKING  100  STEPS.
Total reward:  376.22307320528205
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.16357246930667346
DONE TAKING  100  STEPS.
Total reward:  353.2116942289867
Time for 1 rollout: 4.23 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.25129910010772843
DONE TAKING  100  STEPS.
Total reward:  346.121935597497
Time for 1 rollout: 4.40 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.5083404109331697
DONE TAKING  100  STEPS.
Total reward:  350.6635436653814
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 17
done step  0 , rew:  -0.04263962296367205
DONE TAKING  100  STEPS.
Total reward:  328.48729945489157
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.023144951333677374
DONE TAKING  100  STEPS.
Total reward:  384.6832225430497
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.14806505638711553
DONE TAKING  100  STEPS.
Total reward:  324.42563792957003
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.4247250683971333
DONE TAKING  100  STEPS.
Total reward:  367.65208612830327
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.17648619825797074
DONE TAKING  100  STEPS.
Total reward:  357.3553152949297
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 22
done step  0 , rew:  0.1769610900278264
DONE TAKING  100  STEPS.
Total reward:  292.2604824020478
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.3465619598944133
DONE TAKING  100  STEPS.
Total reward:  366.61134245076073
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.6907691322245606
DONE TAKING  100  STEPS.
Total reward:  369.24151268682704
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.5539630253503605
DONE TAKING  100  STEPS.
Total reward:  390.4095737397748
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 26
done step  0 , rew:  0.6224270266416304
DONE TAKING  100  STEPS.
Total reward:  350.25384050011246
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 27
done step  0 , rew:  0.5316651295147202
DONE TAKING  100  STEPS.
Total reward:  401.9575051999818
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -0.38342121546746233
DONE TAKING  100  STEPS.
Total reward:  369.9751600621421
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.3073110848402602
DONE TAKING  100  STEPS.
Total reward:  374.11935213229003
Time for 1 rollout: 4.28 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter47.ckpt

#####################################
Training the dynamics model..... iteration  48
#####################################

    amount of random data:  20000
    amount of onPol data:  127887

=== Epoch 0 ===
    train loss:  0.1786305231126872
    val rand:  0.08172961572806041
    val onPol:  0.08086375974946552

=== Epoch 10 ===
    train loss:  0.03475422886284915
    val rand:  0.033799574399987854
    val onPol:  0.03505538942085372

=== Epoch 20 ===
    train loss:  0.027861302193592896
    val rand:  0.02782163458565871
    val onPol:  0.028361184315549

=== Epoch 30 ===
    train loss:  0.023964416354217314
    val rand:  0.024186966319878895
    val onPol:  0.02425423367983765

=== Epoch 39 ===
    train loss:  0.021454428136348725
    val rand:  0.022415924817323685
    val onPol:  0.022243874354494944
Training duration: 18.92 s

#####################################
performing on-policy MPC rollouts... iter  48
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  -0.9833102793191556
DONE TAKING  100  STEPS.
Total reward:  201.9874567019799
Time for 1 rollout: 4.33 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.4102328375502327
DONE TAKING  100  STEPS.
Total reward:  332.1042892668223
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 2
done step  0 , rew:  0.7786680099113457
DONE TAKING  100  STEPS.
Total reward:  358.7956480081833
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 3
done step  0 , rew:  0.7097656216785806
DONE TAKING  100  STEPS.
Total reward:  375.95626295122844
Time for 1 rollout: 4.68 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -0.3579338366590769
DONE TAKING  100  STEPS.
Total reward:  329.2328757327853
Time for 1 rollout: 4.72 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -1.297020255375619
DONE TAKING  100  STEPS.
Total reward:  376.68256313836855
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -0.3128505957210741
DONE TAKING  100  STEPS.
Total reward:  366.5570876850118
Time for 1 rollout: 4.64 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.8737283052932632
DONE TAKING  100  STEPS.
Total reward:  153.3426795807084
Time for 1 rollout: 4.75 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.4542190020428122
DONE TAKING  100  STEPS.
Total reward:  369.892905914048
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.02410584940947727
DONE TAKING  100  STEPS.
Total reward:  307.93050609943185
Time for 1 rollout: 4.84 s



####################### Performing MPC rollout # 10
done step  0 , rew:  -0.5175236352659984
DONE TAKING  100  STEPS.
Total reward:  361.5145830384442
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.4769454085630578
DONE TAKING  100  STEPS.
Total reward:  322.1809001790473
Time for 1 rollout: 4.82 s



####################### Performing MPC rollout # 12
done step  0 , rew:  0.09182296952051644
DONE TAKING  100  STEPS.
Total reward:  345.5488193377802
Time for 1 rollout: 4.86 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -1.340496332862811
DONE TAKING  100  STEPS.
Total reward:  322.31059693610473
Time for 1 rollout: 4.85 s



####################### Performing MPC rollout # 14
done step  0 , rew:  -0.28229078782805495
DONE TAKING  100  STEPS.
Total reward:  328.05381561097454
Time for 1 rollout: 4.64 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.9521382842533019
DONE TAKING  100  STEPS.
Total reward:  404.8064745879965
Time for 1 rollout: 4.88 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -0.0884573854135737
DONE TAKING  100  STEPS.
Total reward:  348.10286545383985
Time for 1 rollout: 4.83 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.22443208637236328
DONE TAKING  100  STEPS.
Total reward:  382.81760194194214
Time for 1 rollout: 4.70 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.13132477118410804
DONE TAKING  100  STEPS.
Total reward:  368.70235507430846
Time for 1 rollout: 4.34 s



####################### Performing MPC rollout # 19
done step  0 , rew:  -0.1923732158187958
DONE TAKING  100  STEPS.
Total reward:  349.5403276341744
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.4877095306731207
DONE TAKING  100  STEPS.
Total reward:  373.61037183875766
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -1.0421552348623644
DONE TAKING  100  STEPS.
Total reward:  308.06796750251175
Time for 1 rollout: 4.43 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.38022901167790124
DONE TAKING  100  STEPS.
Total reward:  422.6706074595821
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 23
done step  0 , rew:  0.16589138468390768
DONE TAKING  100  STEPS.
Total reward:  282.99530075523035
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 24
done step  0 , rew:  -0.6718640666589552
DONE TAKING  100  STEPS.
Total reward:  331.94599291174876
Time for 1 rollout: 4.29 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.2551790220598116
DONE TAKING  100  STEPS.
Total reward:  364.2713169609171
Time for 1 rollout: 4.37 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -1.1950424339838308
DONE TAKING  100  STEPS.
Total reward:  367.8326005506895
Time for 1 rollout: 4.30 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.06011150446478371
DONE TAKING  100  STEPS.
Total reward:  352.18555876415274
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 28
done step  0 , rew:  -1.1353538277256963
DONE TAKING  89  STEPS.
Total reward:  273.2756338664039
Time for 1 rollout: 3.80 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.28464630650356637
DONE TAKING  100  STEPS.
Total reward:  389.1001970011457
Time for 1 rollout: 4.28 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter48.ckpt

#####################################
Training the dynamics model..... iteration  49
#####################################

    amount of random data:  20000
    amount of onPol data:  130614

=== Epoch 0 ===
    train loss:  0.17052570949973805
    val rand:  0.08003858228524525
    val onPol:  0.07833799471457799

=== Epoch 10 ===
    train loss:  0.03382616393667247
    val rand:  0.03313866816461086
    val onPol:  0.033811469044950276

=== Epoch 20 ===
    train loss:  0.02711429347151092
    val rand:  0.027163585027058918
    val onPol:  0.027299992326233122

=== Epoch 30 ===
    train loss:  0.02329419771142836
    val rand:  0.024096473430593807
    val onPol:  0.023865117587976985

=== Epoch 39 ===
    train loss:  0.021004600982580866
    val rand:  0.021637851372361183
    val onPol:  0.021393928676843643
Training duration: 15.73 s

#####################################
performing on-policy MPC rollouts... iter  49
#####################################


####################### Performing MPC rollout # 0
done step  0 , rew:  0.09234519715384182
DONE TAKING  81  STEPS.
Total reward:  198.42089256618476
Time for 1 rollout: 3.79 s



####################### Performing MPC rollout # 1
done step  0 , rew:  0.1311490005225752
DONE TAKING  100  STEPS.
Total reward:  355.7394388007669
Time for 1 rollout: 4.89 s



####################### Performing MPC rollout # 2
done step  0 , rew:  -1.0110815005382874
DONE TAKING  100  STEPS.
Total reward:  379.6822858490345
Time for 1 rollout: 4.87 s



####################### Performing MPC rollout # 3
done step  0 , rew:  -0.3292881310984612
DONE TAKING  100  STEPS.
Total reward:  367.23335036477914
Time for 1 rollout: 4.78 s



####################### Performing MPC rollout # 4
done step  0 , rew:  -1.0580771490886973
DONE TAKING  100  STEPS.
Total reward:  349.18476217851367
Time for 1 rollout: 4.80 s



####################### Performing MPC rollout # 5
done step  0 , rew:  -0.38323668370242847
DONE TAKING  100  STEPS.
Total reward:  390.99361768695917
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 6
done step  0 , rew:  -1.033618937047184
DONE TAKING  100  STEPS.
Total reward:  343.4880972454098
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 7
done step  0 , rew:  -0.5819005777758132
DONE TAKING  100  STEPS.
Total reward:  360.00395591780824
Time for 1 rollout: 4.91 s



####################### Performing MPC rollout # 8
done step  0 , rew:  -0.7975079761488642
DONE TAKING  100  STEPS.
Total reward:  319.2270718777087
Time for 1 rollout: 4.72 s



####################### Performing MPC rollout # 9
done step  0 , rew:  0.03594332512907472
DONE TAKING  100  STEPS.
Total reward:  374.5317902936859
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 10
done step  0 , rew:  0.0016959012005176577
DONE TAKING  100  STEPS.
Total reward:  325.893310113306
Time for 1 rollout: 4.60 s



####################### Performing MPC rollout # 11
done step  0 , rew:  -0.43489244418443496
DONE TAKING  100  STEPS.
Total reward:  347.3091324784729
Time for 1 rollout: 4.62 s



####################### Performing MPC rollout # 12
done step  0 , rew:  -0.5906621481789223
DONE TAKING  100  STEPS.
Total reward:  363.6180204053489
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 13
done step  0 , rew:  -1.3592904302910993
DONE TAKING  100  STEPS.
Total reward:  70.20946611530039
Time for 1 rollout: 4.73 s



####################### Performing MPC rollout # 14
done step  0 , rew:  0.1850982637006059
DONE TAKING  100  STEPS.
Total reward:  407.04521890098005
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 15
done step  0 , rew:  -0.058057784382450184
DONE TAKING  100  STEPS.
Total reward:  378.4180636470143
Time for 1 rollout: 4.66 s



####################### Performing MPC rollout # 16
done step  0 , rew:  -1.396371568820562
DONE TAKING  100  STEPS.
Total reward:  382.4387195633125
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 17
done step  0 , rew:  0.1195741381113182
DONE TAKING  100  STEPS.
Total reward:  372.92329070826923
Time for 1 rollout: 4.67 s



####################### Performing MPC rollout # 18
done step  0 , rew:  -0.13927206449886634
DONE TAKING  100  STEPS.
Total reward:  380.5492878315676
Time for 1 rollout: 4.59 s



####################### Performing MPC rollout # 19
done step  0 , rew:  0.06436362101808295
DONE TAKING  100  STEPS.
Total reward:  325.3623093893035
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 20
done step  0 , rew:  -0.6049557537603834
DONE TAKING  100  STEPS.
Total reward:  379.6582501970037
Time for 1 rollout: 4.63 s



####################### Performing MPC rollout # 21
done step  0 , rew:  -0.1794563679956162
DONE TAKING  100  STEPS.
Total reward:  304.5803968395639
Time for 1 rollout: 4.27 s



####################### Performing MPC rollout # 22
done step  0 , rew:  -0.29285920591719117
DONE TAKING  100  STEPS.
Total reward:  342.36051399081407
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 23
done step  0 , rew:  -0.4055782553289671
DONE TAKING  100  STEPS.
Total reward:  371.53979680691236
Time for 1 rollout: 4.28 s



####################### Performing MPC rollout # 24
done step  0 , rew:  0.37685442533900637
DONE TAKING  100  STEPS.
Total reward:  372.8036771253963
Time for 1 rollout: 4.36 s



####################### Performing MPC rollout # 25
done step  0 , rew:  -0.34242991927123706
DONE TAKING  100  STEPS.
Total reward:  391.22918709833914
Time for 1 rollout: 4.58 s



####################### Performing MPC rollout # 26
done step  0 , rew:  -0.4257346077176005
DONE TAKING  100  STEPS.
Total reward:  359.6110608879068
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 27
done step  0 , rew:  -0.8141742830644294
DONE TAKING  100  STEPS.
Total reward:  355.68350514911094
Time for 1 rollout: 4.24 s



####################### Performing MPC rollout # 28
done step  0 , rew:  0.5517528304024616
DONE TAKING  100  STEPS.
Total reward:  405.2690179906313
Time for 1 rollout: 4.25 s



####################### Performing MPC rollout # 29
done step  0 , rew:  -0.8892455960460228
DONE TAKING  100  STEPS.
Total reward:  366.43610099953895
Time for 1 rollout: 4.24 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  100  steps.
Model saved at  /home/siddhant/vikash/pddm-torch/pddm/test_comp/cheetah/models/model_aggIter49.ckpt
