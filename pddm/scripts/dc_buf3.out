Added 1 configs from ../config/dclaw_turn.txt
create env called
--------------------------------- 
Simulation dt:  0.1
State space dimension:  (21,)
Action space dimension:  (9,) 
-----------------------------------
Beginning to do  200  random rollouts.
Completed rollout #  20
Completed rollout #  60
Completed rollout #  160
Completed rollout #  40
Completed rollout #  80
Completed rollout #  120
Completed rollout #  0
Completed rollout #  100
Completed rollout #  140
Completed rollout #  180
Performed  200  rollouts, each with  40  steps.
Beginning to do  20  random rollouts.
Completed rollout #  6
Completed rollout #  2
Completed rollout #  10
Completed rollout #  12
Completed rollout #  4
Completed rollout #  0
Completed rollout #  14
Completed rollout #  16
Completed rollout #  8
Completed rollout #  18
Performed  20  rollouts, each with  40  steps.


######################
Done getting data....
input size:  30
action size:  9
output size:  21
dataX dims:  (7800, 1, 21)
dataY dims:  (7800, 1, 9)
dataZ dims:  (7800, 21) 
######################

Iter: 0
Num of training on policy rollouts: 0
Num of val on policy rollouts: 0
Rand dataset shape (7800, 1, 21)

#####################################
Training the dynamics model..... iteration  0
#####################################

    amount of random data:  8000
    amount of onPol data:  0
Prob shape:  (7800,)

=== Epoch 0 ===
    train loss:  0.8119646867116292
    val rand:  0.5617175102233887
    val onPol:  0.5587881803512573

=== Epoch 10 ===
    train loss:  0.19723929862181347
    val rand:  0.23207788169384003
    val onPol:  0.2302699089050293

=== Epoch 20 ===
    train loss:  0.13065277636051179
    val rand:  0.17161127924919128
    val onPol:  0.16941116750240326

=== Epoch 30 ===
    train loss:  0.10541957517464956
    val rand:  0.15459725260734558
    val onPol:  0.1521614044904709

=== Epoch 39 ===
    train loss:  0.090394293765227
    val rand:  0.14404818415641785
    val onPol:  0.14093729853630066
Training duration: 3.72 s

#####################################
performing on-policy MPC rollouts... iter  0
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.249405951950756
DONE TAKING  40  STEPS.
Total reward:  -476.3244742599581
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.513503416395
DONE TAKING  40  STEPS.
Total reward:  -974.394192832649
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.254282710634236
DONE TAKING  40  STEPS.
Total reward:  -796.8043296819721
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.144174557215464
DONE TAKING  40  STEPS.
Total reward:  -508.594685360773
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -17.561217893621336
DONE TAKING  40  STEPS.
Total reward:  -370.18019744157664
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.161434337529045
DONE TAKING  40  STEPS.
Total reward:  -775.8495952268503
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.350932454816476
DONE TAKING  40  STEPS.
Total reward:  -664.9137000947051
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.649962446474365
DONE TAKING  40  STEPS.
Total reward:  -992.6841728352863
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.01222103798896
DONE TAKING  40  STEPS.
Total reward:  -540.2057017558316
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.499798453042526
DONE TAKING  40  STEPS.
Total reward:  -525.228518846503
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.680955541915424
DONE TAKING  40  STEPS.
Total reward:  -1069.223993270867
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.56785785044655
DONE TAKING  40  STEPS.
Total reward:  -693.9707044281057
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.521289549677732
DONE TAKING  40  STEPS.
Total reward:  -1070.3671180451818
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.048146253104413
DONE TAKING  40  STEPS.
Total reward:  -582.5635381104092
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.52265041303381
DONE TAKING  40  STEPS.
Total reward:  -637.8127497724328
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -21.903251063138434
DONE TAKING  40  STEPS.
Total reward:  -774.3775998008003
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -11.393082975780535
DONE TAKING  40  STEPS.
Total reward:  -403.28394215168123
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -15.442460745431493
DONE TAKING  40  STEPS.
Total reward:  -521.4851950124613
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.80113595033328
DONE TAKING  40  STEPS.
Total reward:  -915.6136546321704
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.524658173207527
DONE TAKING  40  STEPS.
Total reward:  -693.3478683262382
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.925433820599597
DONE TAKING  40  STEPS.
Total reward:  -723.8997533606079
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.043071493244017
DONE TAKING  40  STEPS.
Total reward:  -530.2017875574577
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.68393914869231
DONE TAKING  40  STEPS.
Total reward:  -1001.6347562149374
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.529439546137905
DONE TAKING  40  STEPS.
Total reward:  -830.9637602361923
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.956493907004567
DONE TAKING  40  STEPS.
Total reward:  -400.3795343360852
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -19.101457538103173
DONE TAKING  40  STEPS.
Total reward:  -997.3138896137507
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.848709769826165
DONE TAKING  40  STEPS.
Total reward:  -414.78034804799245
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.007836420455032
DONE TAKING  40  STEPS.
Total reward:  -1239.3927475082853
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.9555694067902
DONE TAKING  40  STEPS.
Total reward:  -1134.0791473991242
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -19.55256659171387
DONE TAKING  40  STEPS.
Total reward:  -600.6713932673279
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.458020686576905
DONE TAKING  40  STEPS.
Total reward:  -968.4736569869019
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.47160943996132
DONE TAKING  40  STEPS.
Total reward:  -344.5704781878521
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -15.623683435439899
DONE TAKING  40  STEPS.
Total reward:  -452.11281567318963
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.098616875145154
DONE TAKING  40  STEPS.
Total reward:  -744.6508438135879
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.359330225140283
DONE TAKING  40  STEPS.
Total reward:  -988.6802648457784
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.551482218910266
DONE TAKING  40  STEPS.
Total reward:  -919.6370734530248
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.23793894056697
DONE TAKING  40  STEPS.
Total reward:  -844.9653567784355
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -16.642360170883137
DONE TAKING  40  STEPS.
Total reward:  -546.2591686193342
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.702398643379993
DONE TAKING  40  STEPS.
Total reward:  -855.46202883322
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.5276272208416
DONE TAKING  40  STEPS.
Total reward:  -597.0315456937291
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 1
Num of training on policy rollouts: 36
Num of val on policy rollouts: 4
Rand dataset shape (7995, 1, 21)

#####################################
Training the dynamics model..... iteration  1
#####################################

    amount of random data:  8000
    amount of onPol data:  1476
Prob rand:  7995
On pol:  11520
Prob shape:  (19515,)

=== Epoch 0 ===
    train loss:  0.508628196622196
    val rand:  0.4234176576137543
    val onPol:  0.2164754718542099

=== Epoch 10 ===
    train loss:  0.12750987394859917
    val rand:  0.22200004756450653
    val onPol:  0.18425080180168152

=== Epoch 20 ===
    train loss:  0.08065567910671234
    val rand:  0.17774705588817596
    val onPol:  0.19815056025981903

=== Epoch 30 ===
    train loss:  0.06048416512969293
    val rand:  0.15893018245697021
    val onPol:  0.20718447864055634

=== Epoch 39 ===
    train loss:  0.051381846399683705
    val rand:  0.14949215948581696
    val onPol:  0.21655747294425964
Training duration: 9.34 s

#####################################
performing on-policy MPC rollouts... iter  1
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.344126567461863
DONE TAKING  40  STEPS.
Total reward:  -801.4446340846328
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.164371735234266
DONE TAKING  40  STEPS.
Total reward:  -802.315023292271
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.565807607119794
DONE TAKING  40  STEPS.
Total reward:  -729.5998537502381
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -10.688440767551972
DONE TAKING  40  STEPS.
Total reward:  -396.67481784749396
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -12.493515793045189
DONE TAKING  40  STEPS.
Total reward:  -488.16597463292027
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.448908681880617
DONE TAKING  40  STEPS.
Total reward:  -548.2004638733382
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -31.220054598187197
DONE TAKING  40  STEPS.
Total reward:  -1221.3900455008936
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -13.709769031606589
DONE TAKING  40  STEPS.
Total reward:  -371.83120095094995
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.32011856183874
DONE TAKING  40  STEPS.
Total reward:  -1041.8764200273683
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.179054703781098
DONE TAKING  40  STEPS.
Total reward:  -793.7167461166065
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -18.271440396283932
DONE TAKING  40  STEPS.
Total reward:  -434.72579566150273
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.61198428726845
DONE TAKING  40  STEPS.
Total reward:  -689.2335761130176
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.743870300128847
DONE TAKING  40  STEPS.
Total reward:  -465.5289488329689
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -18.23143885199463
DONE TAKING  40  STEPS.
Total reward:  -556.5974969063668
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -12.469271419764386
DONE TAKING  40  STEPS.
Total reward:  -453.993083185605
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.6184902763691
DONE TAKING  40  STEPS.
Total reward:  -876.9297375238637
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.51215196346966
DONE TAKING  40  STEPS.
Total reward:  -1007.8679008945534
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.101116723533423
DONE TAKING  40  STEPS.
Total reward:  -597.3370138039645
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.09373856868672
DONE TAKING  40  STEPS.
Total reward:  -519.5606597423714
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.704496008748524
DONE TAKING  40  STEPS.
Total reward:  -473.6929668215031
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.429981400592858
DONE TAKING  40  STEPS.
Total reward:  -926.7167950415554
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.721540937642185
DONE TAKING  40  STEPS.
Total reward:  -939.82560265625
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.362283415769884
DONE TAKING  40  STEPS.
Total reward:  -905.5155977730847
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.77585050718483
DONE TAKING  40  STEPS.
Total reward:  -682.4890997813202
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.97447780978358
DONE TAKING  40  STEPS.
Total reward:  -562.1788621888223
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -22.62909332785351
DONE TAKING  40  STEPS.
Total reward:  -768.8278496330611
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -13.732138287562034
DONE TAKING  40  STEPS.
Total reward:  -374.25162683128144
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.60858726249651
DONE TAKING  40  STEPS.
Total reward:  -839.6925729018012
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.73075694708248
DONE TAKING  40  STEPS.
Total reward:  -569.7931455212646
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.977987620820166
DONE TAKING  40  STEPS.
Total reward:  -923.6458092455208
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.139600985325732
DONE TAKING  40  STEPS.
Total reward:  -1030.3897175236473
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.141135705796735
DONE TAKING  40  STEPS.
Total reward:  -905.0587031927797
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.02462252378935
DONE TAKING  40  STEPS.
Total reward:  -766.2746516348511
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.855393150982252
DONE TAKING  40  STEPS.
Total reward:  -505.1573659910823
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.86508293175877
DONE TAKING  40  STEPS.
Total reward:  -708.3476714037499
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.32385191588407
DONE TAKING  40  STEPS.
Total reward:  -687.649193033984
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.34950323770712
DONE TAKING  40  STEPS.
Total reward:  -701.8489251131622
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -14.980950897363062
DONE TAKING  40  STEPS.
Total reward:  -427.0186132268566
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.288357826811893
DONE TAKING  40  STEPS.
Total reward:  -1010.9816859383286
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -28.729782823917862
DONE TAKING  40  STEPS.
Total reward:  -935.9594254683846
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/font_manager.py:1320: UserWarning: findfont: Font family ['serif'] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 2
Num of training on policy rollouts: 72
Num of val on policy rollouts: 8
Rand dataset shape (8190, 1, 21)

#####################################
Training the dynamics model..... iteration  2
#####################################

    amount of random data:  8000
    amount of onPol data:  2952
Prob rand:  8190
On pol:  11520
Prob shape:  (19710,)

=== Epoch 0 ===
    train loss:  0.5207398133842569
    val rand:  0.4506957530975342
    val onPol:  0.24621492624282837

=== Epoch 10 ===
    train loss:  0.15785867760055944
    val rand:  0.2260071337223053
    val onPol:  0.2079756259918213

=== Epoch 20 ===
    train loss:  0.10860239969272363
    val rand:  0.19050514698028564
    val onPol:  0.2204807847738266

=== Epoch 30 ===
    train loss:  0.08666340810687918
    val rand:  0.16597390174865723
    val onPol:  0.22895976901054382

=== Epoch 39 ===
    train loss:  0.07241397351026535
    val rand:  0.15966713428497314
    val onPol:  0.23845317959785461
Training duration: 9.37 s

#####################################
performing on-policy MPC rollouts... iter  2
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.09429025629859
DONE TAKING  40  STEPS.
Total reward:  -913.0400949959572
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.448759762941705
DONE TAKING  40  STEPS.
Total reward:  -588.1368260593056
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.540681201707315
DONE TAKING  40  STEPS.
Total reward:  -523.8136071825302
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.45958810880355
DONE TAKING  40  STEPS.
Total reward:  -528.7612436698357
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.51105089996662
DONE TAKING  40  STEPS.
Total reward:  -877.6065884106073
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.330893280299463
DONE TAKING  40  STEPS.
Total reward:  -843.6407154309439
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.02761901269037
DONE TAKING  40  STEPS.
Total reward:  -995.911197287728
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.669007537058626
DONE TAKING  40  STEPS.
Total reward:  -525.5524197469381
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -31.113717521084165
DONE TAKING  40  STEPS.
Total reward:  -1027.1057849001086
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.82596050349444
DONE TAKING  40  STEPS.
Total reward:  -642.5845222046933
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.352966185863416
DONE TAKING  40  STEPS.
Total reward:  -505.23057686820204
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.15668617810794
DONE TAKING  40  STEPS.
Total reward:  -692.6216452291675
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -16.69175081738095
DONE TAKING  40  STEPS.
Total reward:  -460.70437951219765
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -16.02099012780879
DONE TAKING  40  STEPS.
Total reward:  -807.3809303626651
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.555153046107527
DONE TAKING  40  STEPS.
Total reward:  -812.1284557030045
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.249820644709743
DONE TAKING  40  STEPS.
Total reward:  -767.1497240730141
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.310324326717854
DONE TAKING  40  STEPS.
Total reward:  -598.9954338072033
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.51083027860851
DONE TAKING  40  STEPS.
Total reward:  -900.3375416250464
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.652570716594226
DONE TAKING  40  STEPS.
Total reward:  -689.1422509945955
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.872526918110545
DONE TAKING  40  STEPS.
Total reward:  -682.545337060007
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.841400873820156
DONE TAKING  40  STEPS.
Total reward:  -482.6944623251747
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.610536570939686
DONE TAKING  40  STEPS.
Total reward:  -989.1580508471756
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -12.149095348638092
DONE TAKING  40  STEPS.
Total reward:  -426.3717391616812
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -30.187203520167962
DONE TAKING  40  STEPS.
Total reward:  -1108.4025037790718
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.343685142259986
DONE TAKING  40  STEPS.
Total reward:  -745.5358228768072
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.335681116172708
DONE TAKING  40  STEPS.
Total reward:  -865.9328969887824
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -18.807183879719023
DONE TAKING  40  STEPS.
Total reward:  -690.4358135090423
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.044823289919115
DONE TAKING  40  STEPS.
Total reward:  -694.9913460913657
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.884637217131
DONE TAKING  40  STEPS.
Total reward:  -741.654296809444
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.444176139906073
DONE TAKING  40  STEPS.
Total reward:  -731.8890239762521
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -29.83596312918621
DONE TAKING  40  STEPS.
Total reward:  -970.2423694144385
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.280228750646366
DONE TAKING  40  STEPS.
Total reward:  -884.4398375122549
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -28.7869766426474
DONE TAKING  40  STEPS.
Total reward:  -939.9901695785314
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.73855488467806
DONE TAKING  40  STEPS.
Total reward:  -1015.2347710694909
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.519102666138114
DONE TAKING  40  STEPS.
Total reward:  -993.0429264211953
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -14.000892380695532
DONE TAKING  40  STEPS.
Total reward:  -541.5646325282522
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -18.154979206589296
DONE TAKING  40  STEPS.
Total reward:  -672.0224236843133
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.356701656951522
DONE TAKING  40  STEPS.
Total reward:  -1059.2146444826515
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -17.69414859865412
DONE TAKING  40  STEPS.
Total reward:  -733.3150094839219
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -12.845600326963673
DONE TAKING  40  STEPS.
Total reward:  -463.6376544924134
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 3
Num of training on policy rollouts: 108
Num of val on policy rollouts: 12
Rand dataset shape (8385, 1, 21)

#####################################
Training the dynamics model..... iteration  3
#####################################

    amount of random data:  8000
    amount of onPol data:  4428
Prob rand:  8385
On pol:  8640
Prob shape:  (17025,)

=== Epoch 0 ===
    train loss:  0.5891020198663076
    val rand:  0.45702990889549255
    val onPol:  0.2829667329788208

=== Epoch 10 ===
    train loss:  0.19017337985111005
    val rand:  0.23092138767242432
    val onPol:  0.2303391695022583

=== Epoch 20 ===
    train loss:  0.1423113224181262
    val rand:  0.18328770995140076
    val onPol:  0.23505476117134094

=== Epoch 30 ===
    train loss:  0.11525333740494469
    val rand:  0.1674797534942627
    val onPol:  0.24126407504081726

=== Epoch 39 ===
    train loss:  0.10040417832858635
    val rand:  0.1574259102344513
    val onPol:  0.24534186720848083
Training duration: 8.05 s

#####################################
performing on-policy MPC rollouts... iter  3
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -14.482271004371707
DONE TAKING  40  STEPS.
Total reward:  -253.48632094662506
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.98551921013657
DONE TAKING  40  STEPS.
Total reward:  -698.2851544689704
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.992669872578002
DONE TAKING  40  STEPS.
Total reward:  -326.38468790676575
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.730251118880012
DONE TAKING  40  STEPS.
Total reward:  -998.0208460248994
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -11.9462205707907
DONE TAKING  40  STEPS.
Total reward:  -350.8569217247372
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.470162266604166
DONE TAKING  40  STEPS.
Total reward:  -995.0404277206904
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.05921703345343
DONE TAKING  40  STEPS.
Total reward:  -1095.2233009615907
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.414520735724366
DONE TAKING  40  STEPS.
Total reward:  -425.99296826096685
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.950057337574496
DONE TAKING  40  STEPS.
Total reward:  -780.786142481266
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.45769011674973
DONE TAKING  40  STEPS.
Total reward:  -947.6179047117084
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.26861026004186
DONE TAKING  40  STEPS.
Total reward:  -696.0193826692545
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.297616155167002
DONE TAKING  40  STEPS.
Total reward:  -634.486682313823
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -30.102211099524865
DONE TAKING  40  STEPS.
Total reward:  -687.5182983903103
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -19.747954432303644
DONE TAKING  40  STEPS.
Total reward:  -485.588346527388
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.316426809374015
DONE TAKING  40  STEPS.
Total reward:  -813.6429910434767
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.872497500276115
DONE TAKING  40  STEPS.
Total reward:  -521.23894035933
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.498860463901316
DONE TAKING  40  STEPS.
Total reward:  -445.00380924260895
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.078765105020825
DONE TAKING  40  STEPS.
Total reward:  -790.8612934745279
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -20.506693009960564
DONE TAKING  40  STEPS.
Total reward:  -561.8424443886457
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.61624584397449
DONE TAKING  40  STEPS.
Total reward:  -686.4923646775376
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.68028601487725
DONE TAKING  40  STEPS.
Total reward:  -495.7816081057537
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.855351613033044
DONE TAKING  40  STEPS.
Total reward:  -354.6245177522371
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.910214373098796
DONE TAKING  40  STEPS.
Total reward:  -423.5766782855916
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.363242882128898
DONE TAKING  40  STEPS.
Total reward:  -884.5526473894973
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -17.062886922922928
DONE TAKING  40  STEPS.
Total reward:  -575.0117006438893
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.45410805327723
DONE TAKING  40  STEPS.
Total reward:  -810.8052297960784
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -20.761832199618336
DONE TAKING  40  STEPS.
Total reward:  -739.830270946304
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.943175159337777
DONE TAKING  40  STEPS.
Total reward:  -711.008737783458
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.156840400209656
DONE TAKING  40  STEPS.
Total reward:  -855.9588821386336
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.04648666265868
DONE TAKING  40  STEPS.
Total reward:  -521.2652850872842
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -12.940521675256736
DONE TAKING  40  STEPS.
Total reward:  -485.0255182196206
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.297535751874605
DONE TAKING  40  STEPS.
Total reward:  -898.7935900973291
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -15.970209994819252
DONE TAKING  40  STEPS.
Total reward:  -540.99658625629
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.55946915104564
DONE TAKING  40  STEPS.
Total reward:  -826.1093000359109
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.676615974022965
DONE TAKING  40  STEPS.
Total reward:  -521.8319052088569
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -13.899962672805714
DONE TAKING  40  STEPS.
Total reward:  -373.15137699732657
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.28114114725755
DONE TAKING  40  STEPS.
Total reward:  -849.4431537561819
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -20.793645708198234
DONE TAKING  40  STEPS.
Total reward:  -616.6754771734812
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.313236969316513
DONE TAKING  40  STEPS.
Total reward:  -979.7351818189694
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.000575122296585
DONE TAKING  40  STEPS.
Total reward:  -856.330756246581
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 4
Num of training on policy rollouts: 144
Num of val on policy rollouts: 16
Rand dataset shape (8580, 1, 21)

#####################################
Training the dynamics model..... iteration  4
#####################################

    amount of random data:  8000
    amount of onPol data:  5904
Prob rand:  8580
On pol:  11520
Prob shape:  (20100,)

=== Epoch 0 ===
    train loss:  0.56332377745555
    val rand:  0.45120367407798767
    val onPol:  0.26944130659103394

=== Epoch 10 ===
    train loss:  0.19600600539109644
    val rand:  0.23193739354610443
    val onPol:  0.22462908923625946

=== Epoch 20 ===
    train loss:  0.1489633199496147
    val rand:  0.1895679533481598
    val onPol:  0.22544614970684052

=== Epoch 30 ===
    train loss:  0.12154841346618457
    val rand:  0.17530493438243866
    val onPol:  0.23332351446151733

=== Epoch 39 ===
    train loss:  0.10555702581619605
    val rand:  0.16393211483955383
    val onPol:  0.23793081939220428
Training duration: 9.75 s

#####################################
performing on-policy MPC rollouts... iter  4
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -13.311107942713857
DONE TAKING  40  STEPS.
Total reward:  -375.9747484684959
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -16.580935121314692
DONE TAKING  40  STEPS.
Total reward:  -275.9372804219816
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.4429446193354
DONE TAKING  40  STEPS.
Total reward:  -571.1991462401675
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.51935286962486
DONE TAKING  40  STEPS.
Total reward:  -704.7616622117893
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.04477172808046
DONE TAKING  40  STEPS.
Total reward:  -889.0746804063336
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.872381848225096
DONE TAKING  40  STEPS.
Total reward:  -743.8269669508321
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.484054854076902
DONE TAKING  40  STEPS.
Total reward:  -689.3814939733328
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.750232150942377
DONE TAKING  40  STEPS.
Total reward:  -527.4954922135888
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.250769189778303
DONE TAKING  40  STEPS.
Total reward:  -367.71506663857207
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.031992209801665
DONE TAKING  40  STEPS.
Total reward:  -1112.9615952443994
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.922819214002114
DONE TAKING  40  STEPS.
Total reward:  -473.9058053802261
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.448007785236896
DONE TAKING  40  STEPS.
Total reward:  -937.4828831699974
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.75742019392687
DONE TAKING  40  STEPS.
Total reward:  -621.3241975131574
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.088858593608972
DONE TAKING  40  STEPS.
Total reward:  -746.8884700974288
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.933666085552467
DONE TAKING  40  STEPS.
Total reward:  -758.1252685665038
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -14.089196870582104
DONE TAKING  40  STEPS.
Total reward:  -453.5199911809639
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.201170009568266
DONE TAKING  40  STEPS.
Total reward:  -846.5769777431403
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.807003236707235
DONE TAKING  40  STEPS.
Total reward:  -1037.81573003767
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.630814141183002
DONE TAKING  40  STEPS.
Total reward:  -741.1002974217548
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.908233804261688
DONE TAKING  40  STEPS.
Total reward:  -752.124089573126
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -21.288324722483235
DONE TAKING  40  STEPS.
Total reward:  -749.3676175870512
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.718800879469477
DONE TAKING  40  STEPS.
Total reward:  -602.0801334242005
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.456414185905825
DONE TAKING  40  STEPS.
Total reward:  -762.102046696227
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.775377030509553
DONE TAKING  40  STEPS.
Total reward:  -872.5480444880866
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.24453706648638
DONE TAKING  40  STEPS.
Total reward:  -587.5572151457089
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.00165913054298
DONE TAKING  40  STEPS.
Total reward:  -451.1420844296531
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.628354635271574
DONE TAKING  40  STEPS.
Total reward:  -899.3150954650151
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.892128671733836
DONE TAKING  40  STEPS.
Total reward:  -1089.8403223360585
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.588967507254388
DONE TAKING  40  STEPS.
Total reward:  -694.5007451695019
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.269667307657308
DONE TAKING  40  STEPS.
Total reward:  -384.39986939882385
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.904948535150936
DONE TAKING  40  STEPS.
Total reward:  -920.0125434401602
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.415552240848292
DONE TAKING  40  STEPS.
Total reward:  -913.0414161951002
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.41678076646665
DONE TAKING  40  STEPS.
Total reward:  -520.8683677687883
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.73136904437884
DONE TAKING  40  STEPS.
Total reward:  -397.31744000267963
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.427652562956915
DONE TAKING  40  STEPS.
Total reward:  -1079.533950754404
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.15957116272904
DONE TAKING  40  STEPS.
Total reward:  -433.9375147171861
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.201335016203515
DONE TAKING  40  STEPS.
Total reward:  -693.0693307638845
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -17.784524888924466
DONE TAKING  40  STEPS.
Total reward:  -502.06531131228024
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.282316675668508
DONE TAKING  40  STEPS.
Total reward:  -899.6994933931228
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.271292153881785
DONE TAKING  40  STEPS.
Total reward:  -551.0578031232633
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 5
Num of training on policy rollouts: 180
Num of val on policy rollouts: 20
Rand dataset shape (8775, 1, 21)

#####################################
Training the dynamics model..... iteration  5
#####################################

    amount of random data:  8000
    amount of onPol data:  7380
Prob rand:  8775
On pol:  14400
Prob shape:  (23175,)

=== Epoch 0 ===
    train loss:  0.5390526049666935
    val rand:  0.4484209418296814
    val onPol:  0.2757412791252136

=== Epoch 10 ===
    train loss:  0.2035982625352012
    val rand:  0.2387876808643341
    val onPol:  0.23305144906044006

=== Epoch 20 ===
    train loss:  0.15432401266362933
    val rand:  0.19446337223052979
    val onPol:  0.23617546260356903

=== Epoch 30 ===
    train loss:  0.12679189774725172
    val rand:  0.17753934860229492
    val onPol:  0.2407577484846115

=== Epoch 39 ===
    train loss:  0.10965027941597832
    val rand:  0.16871359944343567
    val onPol:  0.24572908878326416
Training duration: 11.26 s

#####################################
performing on-policy MPC rollouts... iter  5
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.768744605435813
DONE TAKING  40  STEPS.
Total reward:  -708.0142509495847
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.299775165777135
DONE TAKING  40  STEPS.
Total reward:  -614.4032911272798
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.17445147015669
DONE TAKING  40  STEPS.
Total reward:  -411.6537141938144
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.506278673302592
DONE TAKING  40  STEPS.
Total reward:  -1018.0657265235911
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.012566799786788
DONE TAKING  40  STEPS.
Total reward:  -480.2885069400734
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -16.679056329176717
DONE TAKING  40  STEPS.
Total reward:  -392.10155714472694
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.328469345466956
DONE TAKING  40  STEPS.
Total reward:  -584.3775643404596
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.730651384406016
DONE TAKING  40  STEPS.
Total reward:  -905.7785559202581
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -25.391182420474788
DONE TAKING  40  STEPS.
Total reward:  -566.1074780224864
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.97220081372602
DONE TAKING  40  STEPS.
Total reward:  -909.3200661473415
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -15.486853742290073
DONE TAKING  40  STEPS.
Total reward:  -262.9576773723927
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.09552531286306
DONE TAKING  40  STEPS.
Total reward:  -715.6009153443088
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.615373808144415
DONE TAKING  40  STEPS.
Total reward:  -899.8704298555435
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.952832633069995
DONE TAKING  40  STEPS.
Total reward:  -390.2682904570451
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.783275399633993
DONE TAKING  40  STEPS.
Total reward:  -738.0132512904672
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -31.011248691199068
DONE TAKING  40  STEPS.
Total reward:  -742.2484757224271
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.757575881773505
DONE TAKING  40  STEPS.
Total reward:  -573.677319908208
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.470428836392255
DONE TAKING  40  STEPS.
Total reward:  -898.8015420219951
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.584375809548426
DONE TAKING  40  STEPS.
Total reward:  -534.0162059363267
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.385232828616118
DONE TAKING  40  STEPS.
Total reward:  -327.4619483134849
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.18662115456072
DONE TAKING  40  STEPS.
Total reward:  -615.1625913801996
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.421586293998946
DONE TAKING  40  STEPS.
Total reward:  -789.149699921773
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.58348449747335
DONE TAKING  40  STEPS.
Total reward:  -816.6792403874824
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.24599124076462
DONE TAKING  40  STEPS.
Total reward:  -616.8842757013566
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.95437769268586
DONE TAKING  40  STEPS.
Total reward:  -852.2477742729662
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -19.35732977012335
DONE TAKING  40  STEPS.
Total reward:  -365.51001280324607
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.58466617819965
DONE TAKING  40  STEPS.
Total reward:  -913.7838625783637
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -31.15800515327154
DONE TAKING  40  STEPS.
Total reward:  -691.3705777582337
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.46253030376953
DONE TAKING  40  STEPS.
Total reward:  -862.3887039838474
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.7161016504241
DONE TAKING  40  STEPS.
Total reward:  -1005.966634260984
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.942419888044537
DONE TAKING  40  STEPS.
Total reward:  -1147.7548993778357
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.35958401804966
DONE TAKING  40  STEPS.
Total reward:  -908.8850839454466
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -28.92018283249248
DONE TAKING  40  STEPS.
Total reward:  -1059.622352749127
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.42217780891623
DONE TAKING  40  STEPS.
Total reward:  -783.4589859298568
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -15.946596772207178
DONE TAKING  40  STEPS.
Total reward:  -306.56979131429694
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.348861038983927
DONE TAKING  40  STEPS.
Total reward:  -1126.624251074313
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.21015909025862
DONE TAKING  40  STEPS.
Total reward:  -556.2254344979947
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.319329916808197
DONE TAKING  40  STEPS.
Total reward:  -769.859539653319
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.181796199235738
DONE TAKING  40  STEPS.
Total reward:  -639.6484090952205
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.316154014419343
DONE TAKING  40  STEPS.
Total reward:  -575.0950867741333
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 6
Num of training on policy rollouts: 216
Num of val on policy rollouts: 24
Rand dataset shape (8970, 1, 21)

#####################################
Training the dynamics model..... iteration  6
#####################################

    amount of random data:  8000
    amount of onPol data:  8856
Prob rand:  8970
On pol:  17280
Prob shape:  (26250,)

=== Epoch 0 ===
    train loss:  0.5200177027898676
    val rand:  0.44706329703330994
    val onPol:  0.2725892961025238

=== Epoch 10 ===
    train loss:  0.2058726946512858
    val rand:  0.24189257621765137
    val onPol:  0.23045717179775238

=== Epoch 20 ===
    train loss:  0.15901698581143922
    val rand:  0.1963919997215271
    val onPol:  0.23415391147136688

=== Epoch 30 ===
    train loss:  0.12914540443350286
    val rand:  0.1876879632472992
    val onPol:  0.23650404810905457

=== Epoch 39 ===
    train loss:  0.11111192273743012
    val rand:  0.1785731315612793
    val onPol:  0.24139925837516785
Training duration: 12.96 s

#####################################
performing on-policy MPC rollouts... iter  6
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.809929132808236
DONE TAKING  40  STEPS.
Total reward:  -1072.989709018444
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.35484550809369
DONE TAKING  40  STEPS.
Total reward:  -937.0924956719841
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.52903870187739
DONE TAKING  40  STEPS.
Total reward:  -725.1332518872484
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.85306222134638
DONE TAKING  40  STEPS.
Total reward:  -588.2881351907914
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.012773838212606
DONE TAKING  40  STEPS.
Total reward:  -979.3091925208422
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -28.952659788133527
DONE TAKING  40  STEPS.
Total reward:  -771.996116900986
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.661709393743468
DONE TAKING  40  STEPS.
Total reward:  -752.6611099623564
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -14.328096374807394
DONE TAKING  40  STEPS.
Total reward:  -444.9951367724089
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.843060184888806
DONE TAKING  40  STEPS.
Total reward:  -265.5173235539269
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -16.55213545198126
DONE TAKING  40  STEPS.
Total reward:  -370.3348492426664
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.13785052654129
DONE TAKING  40  STEPS.
Total reward:  -764.1604298225111
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.254721647520732
DONE TAKING  40  STEPS.
Total reward:  -943.6493423278974
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.71324179661098
DONE TAKING  40  STEPS.
Total reward:  -739.785602146261
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.73827675288771
DONE TAKING  40  STEPS.
Total reward:  -437.8065254690873
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.501355305484633
DONE TAKING  40  STEPS.
Total reward:  -739.0367313858225
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -21.769220171827357
DONE TAKING  40  STEPS.
Total reward:  -366.6893564137248
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.51476898129624
DONE TAKING  40  STEPS.
Total reward:  -549.1235139174894
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.05945685468245
DONE TAKING  40  STEPS.
Total reward:  -949.0920748946951
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.39471442987481
DONE TAKING  40  STEPS.
Total reward:  -662.8463122430844
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -19.45983851212563
DONE TAKING  40  STEPS.
Total reward:  -379.4979112832118
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -22.759876646647257
DONE TAKING  40  STEPS.
Total reward:  -457.7806158533567
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -31.384192722852458
DONE TAKING  40  STEPS.
Total reward:  -809.0667090422018
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.859805496455266
DONE TAKING  40  STEPS.
Total reward:  -343.65931123956994
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -14.644634903956186
DONE TAKING  40  STEPS.
Total reward:  -485.011419014029
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.98358404932325
DONE TAKING  40  STEPS.
Total reward:  -440.1130323594162
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.220036552915545
DONE TAKING  40  STEPS.
Total reward:  -623.7120389273963
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.149582436857408
DONE TAKING  40  STEPS.
Total reward:  -530.7924750076563
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.39765973397544
DONE TAKING  40  STEPS.
Total reward:  -642.5348435970116
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.229960166600307
DONE TAKING  40  STEPS.
Total reward:  -856.1898176966143
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.138339279152877
DONE TAKING  40  STEPS.
Total reward:  -772.6547458950099
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -12.695851081126525
DONE TAKING  40  STEPS.
Total reward:  -359.60792896625173
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.788291326017653
DONE TAKING  40  STEPS.
Total reward:  -1006.9180595986929
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -12.777962042865749
DONE TAKING  40  STEPS.
Total reward:  -364.1410121272232
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.909861798951702
DONE TAKING  40  STEPS.
Total reward:  -313.41325190107705
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.826914645901265
DONE TAKING  40  STEPS.
Total reward:  -495.28243600339135
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.64464561455614
DONE TAKING  40  STEPS.
Total reward:  -602.3594766956245
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -23.90179119129815
DONE TAKING  40  STEPS.
Total reward:  -937.7227557589756
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.850725730040335
DONE TAKING  40  STEPS.
Total reward:  -459.35572188214917
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.68409893277504
DONE TAKING  40  STEPS.
Total reward:  -303.5595276660812
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -14.039737008885634
DONE TAKING  40  STEPS.
Total reward:  -485.6606021710863
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 7
Num of training on policy rollouts: 252
Num of val on policy rollouts: 28
Rand dataset shape (9165, 1, 21)

#####################################
Training the dynamics model..... iteration  7
#####################################

    amount of random data:  8000
    amount of onPol data:  10332
Prob rand:  9165
On pol:  10080
Prob shape:  (19245,)

=== Epoch 0 ===
    train loss:  0.6186976287816022
    val rand:  0.4773598611354828
    val onPol:  0.34243908524513245

=== Epoch 10 ===
    train loss:  0.22840040640251055
    val rand:  0.24217233061790466
    val onPol:  0.27747792750597

=== Epoch 20 ===
    train loss:  0.18388428438354182
    val rand:  0.19361788034439087
    val onPol:  0.27913032472133636

=== Epoch 30 ===
    train loss:  0.15777092849886096
    val rand:  0.17551931738853455
    val onPol:  0.2806580364704132

=== Epoch 39 ===
    train loss:  0.1428915886460124
    val rand:  0.16614101827144623
    val onPol:  0.28076203167438507
Training duration: 9.13 s

#####################################
performing on-policy MPC rollouts... iter  7
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.119655716204036
DONE TAKING  40  STEPS.
Total reward:  -619.4487737477889
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.489579339801608
DONE TAKING  40  STEPS.
Total reward:  -754.1560444395303
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.281308785378313
DONE TAKING  40  STEPS.
Total reward:  -689.9789821461513
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -28.881183001536744
DONE TAKING  40  STEPS.
Total reward:  -743.6402593713458
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.296304968316527
DONE TAKING  40  STEPS.
Total reward:  -618.900956892308
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -24.143455148752363
DONE TAKING  40  STEPS.
Total reward:  -646.816531774963
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.009481291816293
DONE TAKING  40  STEPS.
Total reward:  -766.9544093916785
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -10.24523110309475
DONE TAKING  40  STEPS.
Total reward:  -363.5077174340238
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.09554122977903
DONE TAKING  40  STEPS.
Total reward:  -774.3611653532349
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.243914335058687
DONE TAKING  40  STEPS.
Total reward:  -922.7789278901662
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.932408122607168
DONE TAKING  40  STEPS.
Total reward:  -924.3885084377106
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.25082203763809
DONE TAKING  40  STEPS.
Total reward:  -603.2443023055962
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -16.439350625780193
DONE TAKING  40  STEPS.
Total reward:  -429.33833939268413
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -18.646923036954107
DONE TAKING  40  STEPS.
Total reward:  -386.1420908819121
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.575086617588225
DONE TAKING  40  STEPS.
Total reward:  -470.4651343948661
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.262450093037195
DONE TAKING  40  STEPS.
Total reward:  -509.97042848530083
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.651146879682255
DONE TAKING  40  STEPS.
Total reward:  -765.6736963088204
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -10.685177172952367
DONE TAKING  40  STEPS.
Total reward:  -358.61376498209995
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.207131289242255
DONE TAKING  40  STEPS.
Total reward:  -477.2339221166478
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -28.301819512607523
DONE TAKING  40  STEPS.
Total reward:  -540.5253593312632
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.35710156803288
DONE TAKING  40  STEPS.
Total reward:  -599.1018737732077
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.574172765508997
DONE TAKING  40  STEPS.
Total reward:  -275.31306029216023
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.16794626016818
DONE TAKING  40  STEPS.
Total reward:  -729.4872704182989
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.980831026629005
DONE TAKING  40  STEPS.
Total reward:  -548.8596309560355
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.54012793259203
DONE TAKING  40  STEPS.
Total reward:  -915.9713547784613
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -15.797582971019066
DONE TAKING  40  STEPS.
Total reward:  -401.45861476805067
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.667483532584782
DONE TAKING  40  STEPS.
Total reward:  -1166.639162151816
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.501137345168317
DONE TAKING  40  STEPS.
Total reward:  -515.405679334686
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.837904947264953
DONE TAKING  40  STEPS.
Total reward:  -768.6839191052495
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.57517710689606
DONE TAKING  40  STEPS.
Total reward:  -808.6742772137311
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.96830926536896
DONE TAKING  40  STEPS.
Total reward:  -843.3901238422626
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -11.639094881382821
DONE TAKING  40  STEPS.
Total reward:  -441.45168148076215
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.34478545482091
DONE TAKING  40  STEPS.
Total reward:  -845.2010508142605
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.535152351965944
DONE TAKING  40  STEPS.
Total reward:  -804.6999378111982
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.919874750441572
DONE TAKING  40  STEPS.
Total reward:  -567.9995109963653
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.04609406341465
DONE TAKING  40  STEPS.
Total reward:  -988.0060843140187
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -17.140724855737734
DONE TAKING  40  STEPS.
Total reward:  -265.76300649172066
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.00744131754653
DONE TAKING  40  STEPS.
Total reward:  -653.4800153805055
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.21496353274234
DONE TAKING  40  STEPS.
Total reward:  -492.043984611841
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -11.975809007509381
DONE TAKING  40  STEPS.
Total reward:  -561.1107409442146
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 8
Num of training on policy rollouts: 288
Num of val on policy rollouts: 32
Rand dataset shape (9360, 1, 21)

#####################################
Training the dynamics model..... iteration  8
#####################################

    amount of random data:  8000
    amount of onPol data:  11808
Prob rand:  9360
On pol:  11520
Prob shape:  (20880,)

=== Epoch 0 ===
    train loss:  0.6122194632887841
    val rand:  0.48581379652023315
    val onPol:  0.34258662164211273

=== Epoch 10 ===
    train loss:  0.2332579057663679
    val rand:  0.25040072202682495
    val onPol:  0.2847834527492523

=== Epoch 20 ===
    train loss:  0.18924745246768
    val rand:  0.2048310935497284
    val onPol:  0.28571418672800064

=== Epoch 30 ===
    train loss:  0.15998032838106155
    val rand:  0.17943650484085083
    val onPol:  0.28598616272211075

=== Epoch 39 ===
    train loss:  0.14653067886829377
    val rand:  0.16985806822776794
    val onPol:  0.2907359451055527
Training duration: 9.92 s

#####################################
performing on-policy MPC rollouts... iter  8
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.571444985113242
DONE TAKING  40  STEPS.
Total reward:  -1029.9217513025444
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.855152262439077
DONE TAKING  40  STEPS.
Total reward:  -547.4768965469061
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.27910238188182
DONE TAKING  40  STEPS.
Total reward:  -544.7630466499662
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -16.351066905461604
DONE TAKING  40  STEPS.
Total reward:  -490.9935814799789
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.09130454081189
DONE TAKING  40  STEPS.
Total reward:  -551.9550687709649
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.083078836574312
DONE TAKING  40  STEPS.
Total reward:  -863.6934719746808
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.57275646496516
DONE TAKING  40  STEPS.
Total reward:  -857.2137779030661
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.487054233103173
DONE TAKING  40  STEPS.
Total reward:  -662.9829954840665
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -31.07495693719588
DONE TAKING  40  STEPS.
Total reward:  -764.5466526801063
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.0203515485991
DONE TAKING  40  STEPS.
Total reward:  -908.5991408094508
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.969119748378597
DONE TAKING  40  STEPS.
Total reward:  -508.76520630999636
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.55077331810725
DONE TAKING  40  STEPS.
Total reward:  -342.7917326447509
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.085085368027848
DONE TAKING  40  STEPS.
Total reward:  -587.4702544794769
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.99935543673882
DONE TAKING  40  STEPS.
Total reward:  -791.6114261551022
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.081620945193833
DONE TAKING  40  STEPS.
Total reward:  -855.1892190871051
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.53178088263183
DONE TAKING  40  STEPS.
Total reward:  -742.0164805337257
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -23.802085765738
DONE TAKING  40  STEPS.
Total reward:  -717.7278762816738
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.085538726810672
DONE TAKING  40  STEPS.
Total reward:  -359.9468182651065
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -24.01524684468501
DONE TAKING  40  STEPS.
Total reward:  -780.4671369631105
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.107289631882928
DONE TAKING  40  STEPS.
Total reward:  -372.765430560676
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.122343818703534
DONE TAKING  40  STEPS.
Total reward:  -685.2528095122599
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.145798912228113
DONE TAKING  40  STEPS.
Total reward:  -767.0351548767106
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.51579855730943
DONE TAKING  40  STEPS.
Total reward:  -892.135760309487
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.3876185185789
DONE TAKING  40  STEPS.
Total reward:  -552.0115513860351
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -12.909158133163158
DONE TAKING  40  STEPS.
Total reward:  -391.79942332804404
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.180151513029962
DONE TAKING  40  STEPS.
Total reward:  -438.18522135280085
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.756203193076834
DONE TAKING  40  STEPS.
Total reward:  -506.4713328652232
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -22.604688652803368
DONE TAKING  40  STEPS.
Total reward:  -643.0652128042295
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -14.084188978032081
DONE TAKING  40  STEPS.
Total reward:  -376.9631625428278
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.456304606244935
DONE TAKING  40  STEPS.
Total reward:  -725.2858168335761
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.68701713647444
DONE TAKING  40  STEPS.
Total reward:  -894.4683944707408
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.244458216173765
DONE TAKING  40  STEPS.
Total reward:  -640.3989469718296
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.057367064949972
DONE TAKING  40  STEPS.
Total reward:  -749.8029602273836
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -17.222179794667717
DONE TAKING  40  STEPS.
Total reward:  -584.6071781902069
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.60688737599079
DONE TAKING  40  STEPS.
Total reward:  -494.10985204037297
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.732480003407996
DONE TAKING  40  STEPS.
Total reward:  -694.6640431025379
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.016861448490747
DONE TAKING  40  STEPS.
Total reward:  -402.75575136459105
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -12.522158581116498
DONE TAKING  40  STEPS.
Total reward:  -421.3972670821939
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.2123312117255
DONE TAKING  40  STEPS.
Total reward:  -359.63169661727875
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.560249308848135
DONE TAKING  40  STEPS.
Total reward:  -675.7007437089894
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 9
Num of training on policy rollouts: 324
Num of val on policy rollouts: 36
Rand dataset shape (9555, 1, 21)

#####################################
Training the dynamics model..... iteration  9
#####################################

    amount of random data:  8000
    amount of onPol data:  13284
Prob rand:  9555
On pol:  12960
Prob shape:  (22515,)

=== Epoch 0 ===
    train loss:  0.5857092578743779
    val rand:  0.5035360455513
    val onPol:  0.34921829402446747

=== Epoch 10 ===
    train loss:  0.23416261409604272
    val rand:  0.263329416513443
    val onPol:  0.29814504086971283

=== Epoch 20 ===
    train loss:  0.18781079629132913
    val rand:  0.20664700865745544
    val onPol:  0.2916647493839264

=== Epoch 30 ===
    train loss:  0.16171285302139993
    val rand:  0.18836373090744019
    val onPol:  0.2931238263845444

=== Epoch 39 ===
    train loss:  0.14779889999434007
    val rand:  0.17492656409740448
    val onPol:  0.2931702584028244
Training duration: 10.78 s

#####################################
performing on-policy MPC rollouts... iter  9
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.18091610920886
DONE TAKING  40  STEPS.
Total reward:  -781.0032583157756
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.465201497434265
DONE TAKING  40  STEPS.
Total reward:  -573.046356130385
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.578591100210865
DONE TAKING  40  STEPS.
Total reward:  -866.4426302148349
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -22.773711453230476
DONE TAKING  40  STEPS.
Total reward:  -919.031234529601
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.59926984325841
DONE TAKING  40  STEPS.
Total reward:  -302.2678947084736
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -14.192436744599322
DONE TAKING  40  STEPS.
Total reward:  -154.03297878356472
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.67024633260133
DONE TAKING  40  STEPS.
Total reward:  -803.7348340260722
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.761762493563857
DONE TAKING  40  STEPS.
Total reward:  -682.4133273499
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.30567830642254
DONE TAKING  40  STEPS.
Total reward:  -400.9972020974424
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.120503305812118
DONE TAKING  40  STEPS.
Total reward:  -348.7172016596588
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.78461139803825
DONE TAKING  40  STEPS.
Total reward:  -664.6231203311243
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -16.315147755519877
DONE TAKING  40  STEPS.
Total reward:  -356.30741301054945
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.89395545069825
DONE TAKING  40  STEPS.
Total reward:  -738.5454603166332
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.190693194818582
DONE TAKING  40  STEPS.
Total reward:  -618.066513604125
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.107642739984954
DONE TAKING  40  STEPS.
Total reward:  -511.1061320704986
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.47395212205063
DONE TAKING  40  STEPS.
Total reward:  -662.8054341613888
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -21.48932893734637
DONE TAKING  40  STEPS.
Total reward:  -407.3962697411891
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -15.36909569332388
DONE TAKING  40  STEPS.
Total reward:  -350.1399839147382
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.60304098012513
DONE TAKING  40  STEPS.
Total reward:  -674.2736011947749
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.714228956333862
DONE TAKING  40  STEPS.
Total reward:  -605.1451728552439
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.849697982973755
DONE TAKING  40  STEPS.
Total reward:  -713.245224373787
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.28013908464432
DONE TAKING  40  STEPS.
Total reward:  -730.3653237207433
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.34161019191963
DONE TAKING  40  STEPS.
Total reward:  -424.9303874714124
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.827686374646934
DONE TAKING  40  STEPS.
Total reward:  -882.6663870238816
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.50428449426814
DONE TAKING  40  STEPS.
Total reward:  -845.0741327893027
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.374330211384503
DONE TAKING  40  STEPS.
Total reward:  -900.7297002069608
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.304885835990653
DONE TAKING  40  STEPS.
Total reward:  -546.7091204163758
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -12.423243680374721
DONE TAKING  40  STEPS.
Total reward:  -381.0393174414647
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.937135176918051
DONE TAKING  40  STEPS.
Total reward:  -466.0487120209996
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -15.774854181669076
DONE TAKING  40  STEPS.
Total reward:  -357.63221240849794
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -14.865845254301604
DONE TAKING  40  STEPS.
Total reward:  -483.88038866222956
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.292854312401772
DONE TAKING  40  STEPS.
Total reward:  -895.5781996740827
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -19.752718180216007
DONE TAKING  40  STEPS.
Total reward:  -612.6410517810813
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -17.468850581135907
DONE TAKING  40  STEPS.
Total reward:  -480.023809863573
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.288576993526704
DONE TAKING  40  STEPS.
Total reward:  -639.6391703648502
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.189578561804627
DONE TAKING  40  STEPS.
Total reward:  -1014.2621096729557
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.1168096236503
DONE TAKING  40  STEPS.
Total reward:  -752.7767646351751
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.22679058698688
DONE TAKING  40  STEPS.
Total reward:  -860.5680703330077
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.473466889325337
DONE TAKING  40  STEPS.
Total reward:  -549.4264808137518
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.076015612821216
DONE TAKING  40  STEPS.
Total reward:  -385.58511178868673
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 10
Num of training on policy rollouts: 360
Num of val on policy rollouts: 40
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  10
#####################################

    amount of random data:  8000
    amount of onPol data:  14760
Prob rand:  390
On pol:  14400
Prob shape:  (14790,)

=== Epoch 0 ===
    train loss:  0.6473614796996117
    val rand:  0
    val onPol:  0.43127646048863727

=== Epoch 10 ===
    train loss:  0.27143007091113497
    val rand:  0
    val onPol:  0.3324880401293437

=== Epoch 20 ===
    train loss:  0.23166470868246897
    val rand:  0
    val onPol:  0.3260410229365031

=== Epoch 30 ===
    train loss:  0.2030035044465746
    val rand:  0
    val onPol:  0.32788628339767456

=== Epoch 39 ===
    train loss:  0.1848706565797329
    val rand:  0
    val onPol:  0.33231887221336365
Training duration: 7.03 s

#####################################
performing on-policy MPC rollouts... iter  10
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.44563801529691
DONE TAKING  40  STEPS.
Total reward:  -688.0094187129283
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.669605524684265
DONE TAKING  40  STEPS.
Total reward:  -781.9032772949722
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.56609319199462
DONE TAKING  40  STEPS.
Total reward:  -1063.2766995722827
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -18.9284868449181
DONE TAKING  40  STEPS.
Total reward:  -529.4408388645985
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.332052919912037
DONE TAKING  40  STEPS.
Total reward:  -992.2446967142566
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.795891598027005
DONE TAKING  40  STEPS.
Total reward:  -741.9975809070991
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.616222246439989
DONE TAKING  40  STEPS.
Total reward:  -459.02678948899296
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.33169664974099
DONE TAKING  40  STEPS.
Total reward:  -556.8263235861027
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.54246235112433
DONE TAKING  40  STEPS.
Total reward:  -906.3562916345053
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.09109808692484
DONE TAKING  40  STEPS.
Total reward:  -481.44019130659717
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.553513436206146
DONE TAKING  40  STEPS.
Total reward:  -430.07357591545184
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.242906291944728
DONE TAKING  40  STEPS.
Total reward:  -279.78367986654865
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.74221196109801
DONE TAKING  40  STEPS.
Total reward:  -596.8777468501485
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.943116325993458
DONE TAKING  40  STEPS.
Total reward:  -612.2788876631909
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.46823811967404
DONE TAKING  40  STEPS.
Total reward:  -445.55592307341715
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -10.480111721214572
DONE TAKING  40  STEPS.
Total reward:  -370.883615363392
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.178830414474504
DONE TAKING  40  STEPS.
Total reward:  -904.3452191286315
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.658700586627994
DONE TAKING  40  STEPS.
Total reward:  -456.33174803816735
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.349304551593992
DONE TAKING  40  STEPS.
Total reward:  -369.9668220276011
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.2702612522587
DONE TAKING  40  STEPS.
Total reward:  -661.2819287793408
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.747460969425312
DONE TAKING  40  STEPS.
Total reward:  -530.8774132819699
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -31.20592775319356
DONE TAKING  40  STEPS.
Total reward:  -1144.158130575244
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -15.793339026782789
DONE TAKING  40  STEPS.
Total reward:  -363.81956354678914
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.485403428733914
DONE TAKING  40  STEPS.
Total reward:  -397.8247697697985
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -12.797845182078671
DONE TAKING  40  STEPS.
Total reward:  -410.4428312445839
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.21533401121581
DONE TAKING  40  STEPS.
Total reward:  -745.1145116822
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.482895240339346
DONE TAKING  40  STEPS.
Total reward:  -895.302673367071
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.210778353299013
DONE TAKING  40  STEPS.
Total reward:  -632.0535836942703
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.509540403988797
DONE TAKING  40  STEPS.
Total reward:  -1050.4464240422947
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.399572459819694
DONE TAKING  40  STEPS.
Total reward:  -667.0098845250066
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.94030558896974
DONE TAKING  40  STEPS.
Total reward:  -672.6087491573464
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -21.433501445622557
DONE TAKING  40  STEPS.
Total reward:  -619.0595157869942
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.88215338383461
DONE TAKING  40  STEPS.
Total reward:  -301.0481480693107
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.748709883434508
DONE TAKING  40  STEPS.
Total reward:  -879.1999808868774
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.858510652960902
DONE TAKING  40  STEPS.
Total reward:  -468.4369915185358
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.32516670622376
DONE TAKING  40  STEPS.
Total reward:  -818.3122643130062
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.821374593711342
DONE TAKING  40  STEPS.
Total reward:  -378.9253151965742
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.354705494404914
DONE TAKING  40  STEPS.
Total reward:  -519.3736145185478
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -12.81327801538212
DONE TAKING  40  STEPS.
Total reward:  -401.78250222870395
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.918384507466776
DONE TAKING  40  STEPS.
Total reward:  -655.7551080376476
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 11
Num of training on policy rollouts: 396
Num of val on policy rollouts: 44
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  11
#####################################

    amount of random data:  8000
    amount of onPol data:  16236
Prob rand:  390
On pol:  15840
Prob shape:  (16230,)

=== Epoch 0 ===
    train loss:  0.6370271992298865
    val rand:  0
    val onPol:  0.43916990359624225

=== Epoch 10 ===
    train loss:  0.2651250227805107
    val rand:  0
    val onPol:  0.34122108419736225

=== Epoch 20 ===
    train loss:  0.23018576493186335
    val rand:  0
    val onPol:  0.3373660643895467

=== Epoch 30 ===
    train loss:  0.20182732372514664
    val rand:  0
    val onPol:  0.33347875873247784

=== Epoch 39 ===
    train loss:  0.1844587460640938
    val rand:  0
    val onPol:  0.3377012213071187
Training duration: 7.72 s

#####################################
performing on-policy MPC rollouts... iter  11
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.44298540134319
DONE TAKING  40  STEPS.
Total reward:  -668.4528462138046
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -10.420019739922939
DONE TAKING  40  STEPS.
Total reward:  -358.7109179104495
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.048995371664528
DONE TAKING  40  STEPS.
Total reward:  -419.98566393105887
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -11.533929014261961
DONE TAKING  40  STEPS.
Total reward:  -430.51943693997924
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.982343218446168
DONE TAKING  40  STEPS.
Total reward:  -471.65051494914957
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -19.573699435217634
DONE TAKING  40  STEPS.
Total reward:  -358.1242988116272
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.179327326094423
DONE TAKING  40  STEPS.
Total reward:  -839.5973960824952
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.08237472979148
DONE TAKING  40  STEPS.
Total reward:  -804.9933540634808
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.45691028280118
DONE TAKING  40  STEPS.
Total reward:  -533.6493048095822
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.24547662020108
DONE TAKING  40  STEPS.
Total reward:  -1052.1407331718656
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.541167120768723
DONE TAKING  40  STEPS.
Total reward:  -796.7073429302483
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.454951568938196
DONE TAKING  40  STEPS.
Total reward:  -526.7902474004051
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.94062964373079
DONE TAKING  40  STEPS.
Total reward:  -541.3216610967323
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.44467253180219
DONE TAKING  40  STEPS.
Total reward:  -877.7765273976993
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.90157267116662
DONE TAKING  40  STEPS.
Total reward:  -392.6200544486324
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.695368444405336
DONE TAKING  40  STEPS.
Total reward:  -638.0862505210456
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.38065907471067
DONE TAKING  40  STEPS.
Total reward:  -915.1546128313028
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -10.80688926352341
DONE TAKING  40  STEPS.
Total reward:  -504.4583549970552
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.486779036059147
DONE TAKING  40  STEPS.
Total reward:  -943.6444455499417
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.41617492126742
DONE TAKING  40  STEPS.
Total reward:  -564.8757806281476
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -20.894610496247772
DONE TAKING  40  STEPS.
Total reward:  -664.8048844873467
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.43537155957397
DONE TAKING  40  STEPS.
Total reward:  -593.5157914633842
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.81837181097095
DONE TAKING  40  STEPS.
Total reward:  -1064.8456648546753
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.139657150343965
DONE TAKING  40  STEPS.
Total reward:  -309.81333758732336
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.784887862662526
DONE TAKING  40  STEPS.
Total reward:  -795.0496468568825
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.50894704103149
DONE TAKING  40  STEPS.
Total reward:  -848.0759373585943
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.735823388320526
DONE TAKING  40  STEPS.
Total reward:  -665.9672324992827
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.05714037232582
DONE TAKING  40  STEPS.
Total reward:  -979.1554416643289
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.179653350500228
DONE TAKING  40  STEPS.
Total reward:  -492.9916030165994
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.63579442029133
DONE TAKING  40  STEPS.
Total reward:  -799.2523399980047
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -16.631176969447438
DONE TAKING  40  STEPS.
Total reward:  -851.9803164724901
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.901602465744094
DONE TAKING  40  STEPS.
Total reward:  -1057.6039641795549
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.74637085813451
DONE TAKING  40  STEPS.
Total reward:  -1001.5157599943047
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.713116446418127
DONE TAKING  40  STEPS.
Total reward:  -819.1391914719457
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.843610545277574
DONE TAKING  40  STEPS.
Total reward:  -354.4871446678718
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.69620687383233
DONE TAKING  40  STEPS.
Total reward:  -889.4829382760261
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -16.869981988279253
DONE TAKING  40  STEPS.
Total reward:  -717.2036384014963
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.547983039984192
DONE TAKING  40  STEPS.
Total reward:  -612.3563845982344
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.736322283542105
DONE TAKING  40  STEPS.
Total reward:  -1043.948364646872
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.52522006581423
DONE TAKING  40  STEPS.
Total reward:  -694.4564891479805
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
/home/siddhant/anaconda3/envs/pddm-gpu-env/lib/python3.6/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 12
Num of training on policy rollouts: 432
Num of val on policy rollouts: 48
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  12
#####################################

    amount of random data:  8000
    amount of onPol data:  17712
Prob rand:  390
On pol:  17280
Prob shape:  (17670,)

=== Epoch 0 ===
    train loss:  0.6211626196608824
    val rand:  0
    val onPol:  0.45169442892074585

=== Epoch 10 ===
    train loss:  0.2635728541542502
    val rand:  0
    val onPol:  0.35197121898333233

=== Epoch 20 ===
    train loss:  0.2253105649176766
    val rand:  0
    val onPol:  0.34576042493184406

=== Epoch 30 ===
    train loss:  0.20114065268460443
    val rand:  0
    val onPol:  0.34675513704617816

=== Epoch 39 ===
    train loss:  0.18387903316932566
    val rand:  0
    val onPol:  0.35355592767397565
Training duration: 8.50 s

#####################################
performing on-policy MPC rollouts... iter  12
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.029757146136753
DONE TAKING  40  STEPS.
Total reward:  -303.98753321596865
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -15.367540853590903
DONE TAKING  40  STEPS.
Total reward:  -500.33449208516424
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.40841625059414
DONE TAKING  40  STEPS.
Total reward:  -660.8947426890484
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.590377083316646
DONE TAKING  40  STEPS.
Total reward:  -716.6068011020994
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -31.41412982470442
DONE TAKING  40  STEPS.
Total reward:  -875.880197461097
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.066318337134955
DONE TAKING  40  STEPS.
Total reward:  -445.8995181303374
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.38008444170478
DONE TAKING  40  STEPS.
Total reward:  -778.1561397669805
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.93782503835056
DONE TAKING  40  STEPS.
Total reward:  -738.6432105040634
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.566638952822128
DONE TAKING  40  STEPS.
Total reward:  -657.6883326156486
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.180450654487583
DONE TAKING  40  STEPS.
Total reward:  -548.6063509870723
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.598921604222387
DONE TAKING  40  STEPS.
Total reward:  -544.7497083892739
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.319013667844445
DONE TAKING  40  STEPS.
Total reward:  -642.2141122616536
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.386079164619243
DONE TAKING  40  STEPS.
Total reward:  -351.87456981010536
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.2935997070568
DONE TAKING  40  STEPS.
Total reward:  -5.12587952666122
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.461632722349236
DONE TAKING  40  STEPS.
Total reward:  -849.0683337734342
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -15.5841948693529
DONE TAKING  40  STEPS.
Total reward:  -406.65403481513823
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.431500699151897
DONE TAKING  40  STEPS.
Total reward:  -938.6687981224968
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.0184663271844
DONE TAKING  40  STEPS.
Total reward:  -441.8051704674758
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.998614821585008
DONE TAKING  40  STEPS.
Total reward:  -461.99862133249536
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -14.572246068774685
DONE TAKING  40  STEPS.
Total reward:  -456.94184507360274
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.574045756659384
DONE TAKING  40  STEPS.
Total reward:  -806.5194447990275
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.463918876974414
DONE TAKING  40  STEPS.
Total reward:  -569.3609303913032
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.57097507766003
DONE TAKING  40  STEPS.
Total reward:  -687.2542342161805
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.118768200585556
DONE TAKING  40  STEPS.
Total reward:  -428.78655455768705
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -24.69471442963725
DONE TAKING  40  STEPS.
Total reward:  -588.1283104477023
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -31.38495281370623
DONE TAKING  40  STEPS.
Total reward:  -907.9822995826821
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.496676524313894
DONE TAKING  40  STEPS.
Total reward:  -1063.6034445711177
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.50238204400295
DONE TAKING  40  STEPS.
Total reward:  -690.912959057941
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.786574129081792
DONE TAKING  40  STEPS.
Total reward:  -700.474912384255
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.564217045271157
DONE TAKING  40  STEPS.
Total reward:  -831.6338126223416
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.812146532473122
DONE TAKING  40  STEPS.
Total reward:  -849.7059361937808
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.34289945300795
DONE TAKING  40  STEPS.
Total reward:  -811.3160570721454
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.726710010624963
DONE TAKING  40  STEPS.
Total reward:  -729.4989198370662
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.4837611984918
DONE TAKING  40  STEPS.
Total reward:  -971.6414651544358
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.28145913758764
DONE TAKING  40  STEPS.
Total reward:  -1093.9089294323544
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -12.99628866740322
DONE TAKING  40  STEPS.
Total reward:  -344.8339770752889
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.88246998895994
DONE TAKING  40  STEPS.
Total reward:  -726.8727930040401
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.209483640061226
DONE TAKING  40  STEPS.
Total reward:  -904.412500695174
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.35559457803494
DONE TAKING  40  STEPS.
Total reward:  -582.874627496395
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.142229959434815
DONE TAKING  40  STEPS.
Total reward:  -724.6481266169316
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 13
Num of training on policy rollouts: 468
Num of val on policy rollouts: 52
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  13
#####################################

    amount of random data:  8000
    amount of onPol data:  19188
Prob rand:  390
On pol:  18720
Prob shape:  (19110,)

=== Epoch 0 ===
    train loss:  0.591618392918561
    val rand:  0
    val onPol:  0.40597791969776154

=== Epoch 10 ===
    train loss:  0.26230655570287964
    val rand:  0
    val onPol:  0.31789859384298325

=== Epoch 20 ===
    train loss:  0.22469731923696157
    val rand:  0
    val onPol:  0.31190572679042816

=== Epoch 30 ===
    train loss:  0.2023614749715135
    val rand:  0
    val onPol:  0.3137648031115532

=== Epoch 39 ===
    train loss:  0.18240216253577052
    val rand:  0
    val onPol:  0.3173657953739166
Training duration: 9.39 s

#####################################
performing on-policy MPC rollouts... iter  13
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -21.574217895688417
DONE TAKING  40  STEPS.
Total reward:  -500.79511012665904
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.160954183042232
DONE TAKING  40  STEPS.
Total reward:  -824.0047829365361
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -16.297699225267714
DONE TAKING  40  STEPS.
Total reward:  -237.79284734253076
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.85843455737999
DONE TAKING  40  STEPS.
Total reward:  -323.9716700354826
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -14.055588609151858
DONE TAKING  40  STEPS.
Total reward:  -329.88228433472227
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.440296156270943
DONE TAKING  40  STEPS.
Total reward:  -1017.756885459811
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.623160294403323
DONE TAKING  40  STEPS.
Total reward:  -687.2719806626515
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.59942815655057
DONE TAKING  40  STEPS.
Total reward:  -461.9251452489803
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.605915855235537
DONE TAKING  40  STEPS.
Total reward:  -1145.2597837536507
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.21286925948311
DONE TAKING  40  STEPS.
Total reward:  -895.467849347774
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -15.53487275257722
DONE TAKING  40  STEPS.
Total reward:  -384.12525659799053
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -11.466936128068696
DONE TAKING  40  STEPS.
Total reward:  -349.46810893303604
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.535399168759827
DONE TAKING  40  STEPS.
Total reward:  -744.0338867681176
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -31.218405337238913
DONE TAKING  40  STEPS.
Total reward:  -827.9999807243249
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.802550461255503
DONE TAKING  40  STEPS.
Total reward:  -914.3799739456937
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.23097549837577
DONE TAKING  40  STEPS.
Total reward:  -536.0589897981362
Time for 1 rollout: 0.89 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.556625042143402
DONE TAKING  40  STEPS.
Total reward:  -1134.0461764271483
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -16.596709538192776
DONE TAKING  40  STEPS.
Total reward:  -477.07142504568066
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.99310128536861
DONE TAKING  40  STEPS.
Total reward:  -737.0020498803523
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.030991883159373
DONE TAKING  40  STEPS.
Total reward:  -806.8382573327586
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.561350858979885
DONE TAKING  40  STEPS.
Total reward:  -1030.1292207492363
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.02027379478013
DONE TAKING  40  STEPS.
Total reward:  -815.4027885157358
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.33444705230837
DONE TAKING  40  STEPS.
Total reward:  -887.0537668905328
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.29743604203508
DONE TAKING  40  STEPS.
Total reward:  -155.84006364397146
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.175582500487273
DONE TAKING  40  STEPS.
Total reward:  -664.9033421118744
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.5572957718735
DONE TAKING  40  STEPS.
Total reward:  -677.764959183863
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -17.16861273025647
DONE TAKING  40  STEPS.
Total reward:  -627.7031936360592
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.973707430504827
DONE TAKING  40  STEPS.
Total reward:  -952.4747441227408
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.816833335458707
DONE TAKING  40  STEPS.
Total reward:  -300.7591143783331
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.28497342031428
DONE TAKING  40  STEPS.
Total reward:  -572.8047968484412
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.877195680004707
DONE TAKING  40  STEPS.
Total reward:  -880.2913425261488
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -17.576905696732187
DONE TAKING  40  STEPS.
Total reward:  -380.6650409481507
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.623335027809496
DONE TAKING  40  STEPS.
Total reward:  -498.9695527063088
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.40319901574155
DONE TAKING  40  STEPS.
Total reward:  -490.7537532052849
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.703614243482214
DONE TAKING  40  STEPS.
Total reward:  -767.421413579987
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.701076902531614
DONE TAKING  40  STEPS.
Total reward:  -582.114377412133
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.603972575762526
DONE TAKING  40  STEPS.
Total reward:  -205.909822115354
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.371483577750457
DONE TAKING  40  STEPS.
Total reward:  -704.6508706672371
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.45156042668744
DONE TAKING  40  STEPS.
Total reward:  -1135.3415658604486
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.433843127422207
DONE TAKING  40  STEPS.
Total reward:  -775.9590722703134
Time for 1 rollout: 0.91 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 14
Num of training on policy rollouts: 504
Num of val on policy rollouts: 56
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  14
#####################################

    amount of random data:  8000
    amount of onPol data:  20664
Prob rand:  390
On pol:  20160
Prob shape:  (20550,)

=== Epoch 0 ===
    train loss:  0.5789666853845119
    val rand:  0
    val onPol:  0.4067470505833626

=== Epoch 10 ===
    train loss:  0.2626378647983074
    val rand:  0
    val onPol:  0.3234786093235016

=== Epoch 20 ===
    train loss:  0.22441637068986892
    val rand:  0
    val onPol:  0.31650494411587715

=== Epoch 30 ===
    train loss:  0.20133327282965183
    val rand:  0
    val onPol:  0.31915147975087166

=== Epoch 39 ===
    train loss:  0.17932396046817303
    val rand:  0
    val onPol:  0.32345759868621826
Training duration: 10.04 s

#####################################
performing on-policy MPC rollouts... iter  14
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.637003041235396
DONE TAKING  40  STEPS.
Total reward:  -1057.2247220271538
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.43125716232136
DONE TAKING  40  STEPS.
Total reward:  -591.1081981861487
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.148807220876385
DONE TAKING  40  STEPS.
Total reward:  -650.252513345545
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.328755386956832
DONE TAKING  40  STEPS.
Total reward:  -604.5241514386399
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.02320750827335
DONE TAKING  40  STEPS.
Total reward:  -466.49450552579117
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.586435862296273
DONE TAKING  40  STEPS.
Total reward:  -656.3106579091865
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.297580594145025
DONE TAKING  40  STEPS.
Total reward:  -331.6812783465995
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.82227901198798
DONE TAKING  40  STEPS.
Total reward:  -450.70016468224276
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.23736035734205
DONE TAKING  40  STEPS.
Total reward:  -808.6170155469097
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.966332487725797
DONE TAKING  40  STEPS.
Total reward:  -719.0975794709593
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.58817173189153
DONE TAKING  40  STEPS.
Total reward:  -777.6591911757927
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.31161488135954
DONE TAKING  40  STEPS.
Total reward:  -833.1968093450411
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.94092445903995
DONE TAKING  40  STEPS.
Total reward:  -1012.3724034180906
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.247950648876596
DONE TAKING  40  STEPS.
Total reward:  -963.5880324612648
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -18.292110709620403
DONE TAKING  40  STEPS.
Total reward:  -297.3918208184249
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.79478149524106
DONE TAKING  40  STEPS.
Total reward:  -357.47542023307824
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.027904440728204
DONE TAKING  40  STEPS.
Total reward:  -664.2738681455646
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.940020698019488
DONE TAKING  40  STEPS.
Total reward:  -959.5548735098522
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.21307023890478
DONE TAKING  40  STEPS.
Total reward:  -893.1126415861618
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.916150785067085
DONE TAKING  40  STEPS.
Total reward:  -755.6658265257736
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.864685084028963
DONE TAKING  40  STEPS.
Total reward:  -1053.554972505923
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.49552192789104
DONE TAKING  40  STEPS.
Total reward:  -839.7603726727403
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.349338407380074
DONE TAKING  40  STEPS.
Total reward:  -863.4960178630052
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.255610166061096
DONE TAKING  40  STEPS.
Total reward:  -608.9993164962906
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.085748248140675
DONE TAKING  40  STEPS.
Total reward:  -928.87011259751
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.09878402747295
DONE TAKING  40  STEPS.
Total reward:  -596.1327838751145
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -13.965504459273719
DONE TAKING  40  STEPS.
Total reward:  -502.38902538182447
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.042442336977114
DONE TAKING  40  STEPS.
Total reward:  -618.4485146234655
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.027956142364857
DONE TAKING  40  STEPS.
Total reward:  -999.8543762207081
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.434599527360888
DONE TAKING  40  STEPS.
Total reward:  -658.1450558145845
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.428982599443476
DONE TAKING  40  STEPS.
Total reward:  -444.9453128723345
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -16.53655673017546
DONE TAKING  40  STEPS.
Total reward:  -529.5960613345726
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.602624591446194
DONE TAKING  40  STEPS.
Total reward:  -589.661857655445
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -16.336011515750652
DONE TAKING  40  STEPS.
Total reward:  -441.31991372641
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.093585029522714
DONE TAKING  40  STEPS.
Total reward:  -967.3301897907687
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.09890470331255
DONE TAKING  40  STEPS.
Total reward:  -918.5368829216703
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.856550470709937
DONE TAKING  40  STEPS.
Total reward:  -624.9098163996083
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -26.126907771038308
DONE TAKING  40  STEPS.
Total reward:  -848.8818557115411
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -11.23824479953238
DONE TAKING  40  STEPS.
Total reward:  -355.6775980326013
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -18.246337450243818
DONE TAKING  40  STEPS.
Total reward:  -314.3854494074151
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 15
Num of training on policy rollouts: 540
Num of val on policy rollouts: 60
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  15
#####################################

    amount of random data:  8000
    amount of onPol data:  22140
Prob rand:  390
On pol:  21600
Prob shape:  (21990,)

=== Epoch 0 ===
    train loss:  0.5726818875187919
    val rand:  0
    val onPol:  0.41494591534137726

=== Epoch 10 ===
    train loss:  0.26164235706840244
    val rand:  0
    val onPol:  0.3308321088552475

=== Epoch 20 ===
    train loss:  0.22887251064890907
    val rand:  0
    val onPol:  0.32039933279156685

=== Epoch 30 ===
    train loss:  0.20101772603534518
    val rand:  0
    val onPol:  0.32341858372092247

=== Epoch 39 ===
    train loss:  0.18389854793037688
    val rand:  0
    val onPol:  0.3261622041463852
Training duration: 10.57 s

#####################################
performing on-policy MPC rollouts... iter  15
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -14.255031747741914
DONE TAKING  40  STEPS.
Total reward:  -334.20278963158233
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -20.6824967542842
DONE TAKING  40  STEPS.
Total reward:  -335.9951556496839
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.8306573832284
DONE TAKING  40  STEPS.
Total reward:  -680.7713610608389
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.456992309807667
DONE TAKING  40  STEPS.
Total reward:  -956.5832392211131
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.035105920446618
DONE TAKING  40  STEPS.
Total reward:  -512.279014452998
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.308079563087503
DONE TAKING  40  STEPS.
Total reward:  -570.8201806123279
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.302116021504645
DONE TAKING  40  STEPS.
Total reward:  -702.9516325841593
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.522119565097892
DONE TAKING  40  STEPS.
Total reward:  -1056.9670757207732
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -19.88852000473076
DONE TAKING  40  STEPS.
Total reward:  -612.1578460789121
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.898187424330718
DONE TAKING  40  STEPS.
Total reward:  -657.1192610317858
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.471786956496153
DONE TAKING  40  STEPS.
Total reward:  -342.086195783317
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.146516332477233
DONE TAKING  40  STEPS.
Total reward:  -485.8796140995829
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -17.708888962904098
DONE TAKING  40  STEPS.
Total reward:  -629.4615282435448
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -22.94056749986098
DONE TAKING  40  STEPS.
Total reward:  -796.9633143885013
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -12.878366626232921
DONE TAKING  40  STEPS.
Total reward:  -336.46522983518145
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -17.116115489755007
DONE TAKING  40  STEPS.
Total reward:  -418.507641141165
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.91350246553064
DONE TAKING  40  STEPS.
Total reward:  -836.2273163694655
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.83216900155155
DONE TAKING  40  STEPS.
Total reward:  -690.9874449827087
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -15.289834142891937
DONE TAKING  40  STEPS.
Total reward:  -287.2737394760815
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.76866914069984
DONE TAKING  40  STEPS.
Total reward:  -697.0381496397061
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.94402492914353
DONE TAKING  40  STEPS.
Total reward:  -636.028802826053
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.47109227614373
DONE TAKING  40  STEPS.
Total reward:  -413.486025921754
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.602929423877594
DONE TAKING  40  STEPS.
Total reward:  -635.9328396798546
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -20.876957974806103
DONE TAKING  40  STEPS.
Total reward:  -397.19282406856485
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.74904414067509
DONE TAKING  40  STEPS.
Total reward:  -741.9412058720854
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.15999172089085
DONE TAKING  40  STEPS.
Total reward:  -841.5898451244017
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.90746290094061
DONE TAKING  40  STEPS.
Total reward:  -612.0786843541487
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.749227280120845
DONE TAKING  40  STEPS.
Total reward:  -423.61052192274957
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.12447092084476
DONE TAKING  40  STEPS.
Total reward:  -1043.831444789617
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.04908973299132
DONE TAKING  40  STEPS.
Total reward:  -905.0144211977
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.95304363307336
DONE TAKING  40  STEPS.
Total reward:  -705.2483158401247
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.090030586990483
DONE TAKING  40  STEPS.
Total reward:  -683.9985276805654
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -16.57210047997602
DONE TAKING  40  STEPS.
Total reward:  -359.98855576377514
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -25.348985748045468
DONE TAKING  40  STEPS.
Total reward:  -701.7758101500837
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.128518193921234
DONE TAKING  40  STEPS.
Total reward:  -622.5172642906948
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.30515832256068
DONE TAKING  40  STEPS.
Total reward:  -654.1755077384826
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.43071437043121
DONE TAKING  40  STEPS.
Total reward:  -663.7575105119839
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.82797029079091
DONE TAKING  40  STEPS.
Total reward:  -507.0781968279868
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.460628634736
DONE TAKING  40  STEPS.
Total reward:  -931.3964863314434
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.58088006453944
DONE TAKING  40  STEPS.
Total reward:  -386.2973053894549
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 16
Num of training on policy rollouts: 576
Num of val on policy rollouts: 64
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  16
#####################################

    amount of random data:  8000
    amount of onPol data:  23616
Prob rand:  390
On pol:  23040
Prob shape:  (23430,)

=== Epoch 0 ===
    train loss:  0.5601485007339053
    val rand:  0
    val onPol:  0.4007243275642395

=== Epoch 10 ===
    train loss:  0.2624893920289146
    val rand:  0
    val onPol:  0.32299302220344545

=== Epoch 20 ===
    train loss:  0.22632904284530217
    val rand:  0
    val onPol:  0.31565675139427185

=== Epoch 30 ===
    train loss:  0.20438443356090122
    val rand:  0
    val onPol:  0.3150353580713272

=== Epoch 39 ===
    train loss:  0.182469399438964
    val rand:  0
    val onPol:  0.31944856941699984
Training duration: 11.35 s

#####################################
performing on-policy MPC rollouts... iter  16
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.219078138853266
DONE TAKING  40  STEPS.
Total reward:  -740.0731206201275
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -18.41120670026384
DONE TAKING  40  STEPS.
Total reward:  -387.1833147251164
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.62149861523049
DONE TAKING  40  STEPS.
Total reward:  -551.8876714752406
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -31.407649077385273
DONE TAKING  40  STEPS.
Total reward:  -598.9840156362156
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.29105074401659
DONE TAKING  40  STEPS.
Total reward:  -607.1294491335298
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.2444360348984
DONE TAKING  40  STEPS.
Total reward:  -641.501759899059
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.42473401478133
DONE TAKING  40  STEPS.
Total reward:  -898.3671436171087
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -23.26166987629884
DONE TAKING  40  STEPS.
Total reward:  -553.3640668089788
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -25.157574319976625
DONE TAKING  40  STEPS.
Total reward:  -774.8862400011626
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -16.927464574868118
DONE TAKING  40  STEPS.
Total reward:  -440.99526654461135
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.28588425504093
DONE TAKING  40  STEPS.
Total reward:  -591.6054218310989
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.38124393807312
DONE TAKING  40  STEPS.
Total reward:  -374.676667504565
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -11.306109238849867
DONE TAKING  40  STEPS.
Total reward:  -316.4030883303878
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.805702946320473
DONE TAKING  40  STEPS.
Total reward:  -549.9541625134691
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.167034574146413
DONE TAKING  40  STEPS.
Total reward:  -760.0668318313237
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.947543507227945
DONE TAKING  40  STEPS.
Total reward:  -537.1791773294245
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.97456018804089
DONE TAKING  40  STEPS.
Total reward:  -693.1498449018936
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.330217064512244
DONE TAKING  40  STEPS.
Total reward:  -538.5705226286079
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.04996149539613
DONE TAKING  40  STEPS.
Total reward:  -653.6106589024602
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.43794828026281
DONE TAKING  40  STEPS.
Total reward:  -741.775969041641
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -18.169804711317294
DONE TAKING  40  STEPS.
Total reward:  -517.7937530585579
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.825531527919832
DONE TAKING  40  STEPS.
Total reward:  -439.5794563393678
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.73519012490631
DONE TAKING  40  STEPS.
Total reward:  -760.4727331466888
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.07663443320074
DONE TAKING  40  STEPS.
Total reward:  -1021.9523484885939
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.710706522411208
DONE TAKING  40  STEPS.
Total reward:  -359.3133333367576
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.406026199270933
DONE TAKING  40  STEPS.
Total reward:  -512.7910446379075
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.283573285490228
DONE TAKING  40  STEPS.
Total reward:  -485.5995799323836
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -23.32983620799766
DONE TAKING  40  STEPS.
Total reward:  -427.231498385512
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -16.581478959496092
DONE TAKING  40  STEPS.
Total reward:  -390.0504323166589
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -17.111680120832553
DONE TAKING  40  STEPS.
Total reward:  -684.4672048333025
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.58747619999057
DONE TAKING  40  STEPS.
Total reward:  -699.1304405483992
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.723522160681945
DONE TAKING  40  STEPS.
Total reward:  -878.4206869844251
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.318627748509673
DONE TAKING  40  STEPS.
Total reward:  -589.6992913053169
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -19.17335973610168
DONE TAKING  40  STEPS.
Total reward:  -553.8055731540013
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.712043946063076
DONE TAKING  40  STEPS.
Total reward:  -711.6125699410319
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -28.67623352271771
DONE TAKING  40  STEPS.
Total reward:  -855.711286760925
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.99638384929542
DONE TAKING  40  STEPS.
Total reward:  -1013.5216830934233
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.110677523510102
DONE TAKING  40  STEPS.
Total reward:  -589.1735351628431
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.584578621820285
DONE TAKING  40  STEPS.
Total reward:  -505.25383759280356
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.52551687577216
DONE TAKING  40  STEPS.
Total reward:  -445.79113796456676
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 17
Num of training on policy rollouts: 612
Num of val on policy rollouts: 68
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  17
#####################################

    amount of random data:  8000
    amount of onPol data:  25092
Prob rand:  390
On pol:  24480
Prob shape:  (24870,)

=== Epoch 0 ===
    train loss:  0.5535566173493862
    val rand:  0
    val onPol:  0.398811811208725

=== Epoch 10 ===
    train loss:  0.25980192174514133
    val rand:  0
    val onPol:  0.32315145134925843

=== Epoch 20 ===
    train loss:  0.226056390752395
    val rand:  0
    val onPol:  0.31656758189201356

=== Epoch 30 ===
    train loss:  0.2017233306542039
    val rand:  0
    val onPol:  0.32131269574165344

=== Epoch 39 ===
    train loss:  0.18266825129588446
    val rand:  0
    val onPol:  0.3217048436403275
Training duration: 12.08 s

#####################################
performing on-policy MPC rollouts... iter  17
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -12.652599994057883
DONE TAKING  40  STEPS.
Total reward:  -351.0382083615458
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.072039475138762
DONE TAKING  40  STEPS.
Total reward:  -609.1474540618076
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -11.72406458882698
DONE TAKING  40  STEPS.
Total reward:  -405.5556818658848
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.366570187473798
DONE TAKING  40  STEPS.
Total reward:  -461.41379426442
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -19.75993167577578
DONE TAKING  40  STEPS.
Total reward:  -674.1543862542799
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.135913507269358
DONE TAKING  40  STEPS.
Total reward:  -858.1143088464337
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.237396132332528
DONE TAKING  40  STEPS.
Total reward:  -260.0139993148533
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.343125195284987
DONE TAKING  40  STEPS.
Total reward:  -733.7781289599009
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -24.755358467470572
DONE TAKING  40  STEPS.
Total reward:  -595.7821641411739
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.173177261989412
DONE TAKING  40  STEPS.
Total reward:  -974.4423209797827
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -18.300273354273266
DONE TAKING  40  STEPS.
Total reward:  -353.26448167665245
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.18305792481323
DONE TAKING  40  STEPS.
Total reward:  -720.1876700696228
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.317205601716953
DONE TAKING  40  STEPS.
Total reward:  -464.4925280596831
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -29.835882365238344
DONE TAKING  40  STEPS.
Total reward:  -748.7640420242456
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.874477441587203
DONE TAKING  40  STEPS.
Total reward:  -773.4919906688816
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.621942487940185
DONE TAKING  40  STEPS.
Total reward:  -537.5727997813767
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.668956173813775
DONE TAKING  40  STEPS.
Total reward:  -494.2817898045964
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.478938513892594
DONE TAKING  40  STEPS.
Total reward:  -450.9226978298614
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.598933044971545
DONE TAKING  40  STEPS.
Total reward:  -757.5139579729148
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.797281159337935
DONE TAKING  40  STEPS.
Total reward:  -712.6191558821668
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -30.481739719708756
DONE TAKING  40  STEPS.
Total reward:  -925.0835653265244
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.63723672119128
DONE TAKING  40  STEPS.
Total reward:  -724.1169345892982
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.742930936167824
DONE TAKING  40  STEPS.
Total reward:  -619.8378936274331
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -13.081980709015554
DONE TAKING  40  STEPS.
Total reward:  -247.2976675917391
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.823042483634186
DONE TAKING  40  STEPS.
Total reward:  -694.6718017072326
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.524681100237608
DONE TAKING  40  STEPS.
Total reward:  -816.4718958122767
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.28841913412639
DONE TAKING  40  STEPS.
Total reward:  -805.9502106944759
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -16.948290969367473
DONE TAKING  40  STEPS.
Total reward:  -602.659443121124
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.781412457865855
DONE TAKING  40  STEPS.
Total reward:  -898.8349890259116
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.386560257504698
DONE TAKING  40  STEPS.
Total reward:  -537.6357922361195
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.009267307485324
DONE TAKING  40  STEPS.
Total reward:  -464.511128467042
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.69101070854345
DONE TAKING  40  STEPS.
Total reward:  -720.5749228236591
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -29.65152879989969
DONE TAKING  40  STEPS.
Total reward:  -853.5857018523068
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.82200165362578
DONE TAKING  40  STEPS.
Total reward:  -864.8513381352111
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.577129781200274
DONE TAKING  40  STEPS.
Total reward:  -659.9722671826852
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.539528695711812
DONE TAKING  40  STEPS.
Total reward:  -609.1727483916344
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.20482417016409
DONE TAKING  40  STEPS.
Total reward:  -569.8745813774664
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.645682749734533
DONE TAKING  40  STEPS.
Total reward:  -776.1322557035924
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.45119615958513
DONE TAKING  40  STEPS.
Total reward:  -351.7818900723153
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.804053253939525
DONE TAKING  40  STEPS.
Total reward:  -600.3026910444173
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 18
Num of training on policy rollouts: 648
Num of val on policy rollouts: 72
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  18
#####################################

    amount of random data:  8000
    amount of onPol data:  26568
Prob rand:  390
On pol:  25920
Prob shape:  (26310,)

=== Epoch 0 ===
    train loss:  0.5417321891176934
    val rand:  0
    val onPol:  0.4097192049026489

=== Epoch 10 ===
    train loss:  0.26210148135821026
    val rand:  0
    val onPol:  0.33443085551261903

=== Epoch 20 ===
    train loss:  0.22386480809426776
    val rand:  0
    val onPol:  0.3256607472896576

=== Epoch 30 ===
    train loss:  0.20039216560475967
    val rand:  0
    val onPol:  0.3295554041862488

=== Epoch 39 ===
    train loss:  0.18390987755036822
    val rand:  0
    val onPol:  0.3336372494697571
Training duration: 12.95 s

#####################################
performing on-policy MPC rollouts... iter  18
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.788447742465994
DONE TAKING  40  STEPS.
Total reward:  -790.3126437315611
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.851592660199167
DONE TAKING  40  STEPS.
Total reward:  -634.698481556379
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.1962102113248
DONE TAKING  40  STEPS.
Total reward:  -670.3259834135046
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -19.921521755719652
DONE TAKING  40  STEPS.
Total reward:  -624.5859218055652
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.564604565717957
DONE TAKING  40  STEPS.
Total reward:  -679.3210014261203
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.498088081005818
DONE TAKING  40  STEPS.
Total reward:  -641.3267210704855
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.203391970117522
DONE TAKING  40  STEPS.
Total reward:  -675.7533443856911
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.618432473058142
DONE TAKING  40  STEPS.
Total reward:  -60.873810849210784
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.66661659705171
DONE TAKING  40  STEPS.
Total reward:  -699.0521721057921
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.07633935548748
DONE TAKING  40  STEPS.
Total reward:  -598.1478209662939
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.86973890742716
DONE TAKING  40  STEPS.
Total reward:  -469.58761697162475
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.234782105343477
DONE TAKING  40  STEPS.
Total reward:  -725.30309609905
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.38572658851404
DONE TAKING  40  STEPS.
Total reward:  -310.6220773783641
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -25.683872123387314
DONE TAKING  40  STEPS.
Total reward:  -915.7665525644753
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -16.727229184854494
DONE TAKING  40  STEPS.
Total reward:  -532.8181615567157
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.76324653593631
DONE TAKING  40  STEPS.
Total reward:  -712.6029093828117
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -31.093216024790774
DONE TAKING  40  STEPS.
Total reward:  -766.2288251409603
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.294784590290448
DONE TAKING  40  STEPS.
Total reward:  -529.1331557094173
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.805362338233333
DONE TAKING  40  STEPS.
Total reward:  -829.3983872721807
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.708951287717504
DONE TAKING  40  STEPS.
Total reward:  -750.2406203038064
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.832976031788707
DONE TAKING  40  STEPS.
Total reward:  -870.9113490946727
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -15.687063045159917
DONE TAKING  40  STEPS.
Total reward:  -474.00613184023797
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.730896726412915
DONE TAKING  40  STEPS.
Total reward:  -555.9278882132367
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -31.350228172550118
DONE TAKING  40  STEPS.
Total reward:  -758.9281931360696
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -26.440221253558555
DONE TAKING  40  STEPS.
Total reward:  -797.622118719787
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -13.10583899524839
DONE TAKING  40  STEPS.
Total reward:  -438.11120661512604
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -15.499355896040942
DONE TAKING  40  STEPS.
Total reward:  -516.8566879622566
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.735855330951292
DONE TAKING  40  STEPS.
Total reward:  -543.5007224979702
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.29916104323066
DONE TAKING  40  STEPS.
Total reward:  -487.24740458564725
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.575609393942315
DONE TAKING  40  STEPS.
Total reward:  -368.85362729403
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.983343249119724
DONE TAKING  40  STEPS.
Total reward:  -458.78724570868496
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.954852474656953
DONE TAKING  40  STEPS.
Total reward:  -916.5006289515537
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.46602466941922
DONE TAKING  40  STEPS.
Total reward:  -637.9719569886712
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.828714130631326
DONE TAKING  40  STEPS.
Total reward:  -780.4920261222798
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.26474794871013
DONE TAKING  40  STEPS.
Total reward:  -874.901991779273
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -27.988765926739127
DONE TAKING  40  STEPS.
Total reward:  -941.7643563686441
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -26.442467496925683
DONE TAKING  40  STEPS.
Total reward:  -686.1954870524213
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.161077952032013
DONE TAKING  40  STEPS.
Total reward:  -513.2150493249213
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.833538715299962
DONE TAKING  40  STEPS.
Total reward:  -566.0335638303785
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -22.84020173101694
DONE TAKING  40  STEPS.
Total reward:  -506.79591222672406
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 19
Num of training on policy rollouts: 684
Num of val on policy rollouts: 76
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  19
#####################################

    amount of random data:  8000
    amount of onPol data:  28044
Prob rand:  390
On pol:  27360
Prob shape:  (27750,)

=== Epoch 0 ===
    train loss:  0.5283954138005221
    val rand:  0
    val onPol:  0.40812588930130006

=== Epoch 10 ===
    train loss:  0.2551587439245648
    val rand:  0
    val onPol:  0.33398973643779756

=== Epoch 20 ===
    train loss:  0.22085173041732223
    val rand:  0
    val onPol:  0.32938754856586455

=== Epoch 30 ===
    train loss:  0.1998673125549599
    val rand:  0
    val onPol:  0.33290246725082395

=== Epoch 39 ===
    train loss:  0.18060607821853072
    val rand:  0
    val onPol:  0.3388495683670044
Training duration: 13.69 s

#####################################
performing on-policy MPC rollouts... iter  19
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -24.64631063775603
DONE TAKING  40  STEPS.
Total reward:  -651.8159997241057
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.680170192767324
DONE TAKING  40  STEPS.
Total reward:  -584.3665577408519
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.95055104146339
DONE TAKING  40  STEPS.
Total reward:  -920.0481854018876
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.004799016758334
DONE TAKING  40  STEPS.
Total reward:  -786.0722693016396
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.750946005547164
DONE TAKING  40  STEPS.
Total reward:  -513.2058434830565
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.271699288645276
DONE TAKING  40  STEPS.
Total reward:  -835.3144184491094
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -18.063564475394394
DONE TAKING  40  STEPS.
Total reward:  -402.5803581773886
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.94627071687829
DONE TAKING  40  STEPS.
Total reward:  -846.7135416242114
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.00719933581125
DONE TAKING  40  STEPS.
Total reward:  -538.3658168218857
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.166695549467452
DONE TAKING  40  STEPS.
Total reward:  -820.2525592273901
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.910637706152578
DONE TAKING  40  STEPS.
Total reward:  -715.1444844819141
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.56611750321619
DONE TAKING  40  STEPS.
Total reward:  -632.0858202392466
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.053384396599768
DONE TAKING  40  STEPS.
Total reward:  -792.8178556500676
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.581396111717865
DONE TAKING  40  STEPS.
Total reward:  -743.5531675961065
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.43650470981335
DONE TAKING  40  STEPS.
Total reward:  -538.3037420340771
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.18485581288491
DONE TAKING  40  STEPS.
Total reward:  -424.46462236242064
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -25.124771003667014
DONE TAKING  40  STEPS.
Total reward:  -932.7850554257568
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.524531310124196
DONE TAKING  40  STEPS.
Total reward:  -690.7300988045429
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.259793832476692
DONE TAKING  40  STEPS.
Total reward:  -573.6887688508447
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -11.951765115106689
DONE TAKING  40  STEPS.
Total reward:  -116.56072328401171
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.037777114684422
DONE TAKING  40  STEPS.
Total reward:  -503.58482619103864
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.803129880418382
DONE TAKING  40  STEPS.
Total reward:  -680.6265328754823
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -12.971236400649389
DONE TAKING  40  STEPS.
Total reward:  -486.1863246500871
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -17.893691039595133
DONE TAKING  40  STEPS.
Total reward:  -383.47144504687947
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.922985921756524
DONE TAKING  40  STEPS.
Total reward:  -739.1500131285769
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -31.34742438063741
DONE TAKING  40  STEPS.
Total reward:  -875.5344613966363
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.66539277541785
DONE TAKING  40  STEPS.
Total reward:  -553.9762524030621
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -18.0792619397255
DONE TAKING  40  STEPS.
Total reward:  -687.5491230770904
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.683906693638473
DONE TAKING  40  STEPS.
Total reward:  -386.3270916565682
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.55171215048621
DONE TAKING  40  STEPS.
Total reward:  -901.6850148220451
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -15.854448496298685
DONE TAKING  40  STEPS.
Total reward:  -472.29394692281977
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.720678845181947
DONE TAKING  40  STEPS.
Total reward:  -660.3916161166459
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -24.499261778072036
DONE TAKING  40  STEPS.
Total reward:  -757.9812324766266
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.33055654454253
DONE TAKING  40  STEPS.
Total reward:  -764.3033059837762
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.753529797872588
DONE TAKING  40  STEPS.
Total reward:  -760.4527414550854
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.24275358072873
DONE TAKING  40  STEPS.
Total reward:  -885.814780356674
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.26577342710638
DONE TAKING  40  STEPS.
Total reward:  -889.645846381059
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.00378616639137
DONE TAKING  40  STEPS.
Total reward:  -820.9395798905873
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -13.045155218386657
DONE TAKING  40  STEPS.
Total reward:  -327.68259264860944
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -9.932830683959502
DONE TAKING  40  STEPS.
Total reward:  -297.7935363259275
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 20
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  20
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5259303696322859
    val rand:  0
    val onPol:  0.3910289754470189

=== Epoch 10 ===
    train loss:  0.252088918236264
    val rand:  0
    val onPol:  0.31643813600142795

=== Epoch 20 ===
    train loss:  0.22161578635374704
    val rand:  0
    val onPol:  0.3103489503264427

=== Epoch 30 ===
    train loss:  0.19782068332036337
    val rand:  0
    val onPol:  0.3142193630337715

=== Epoch 39 ===
    train loss:  0.17661456763744354
    val rand:  0
    val onPol:  0.3180323814352353
Training duration: 14.37 s

#####################################
performing on-policy MPC rollouts... iter  20
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.910682029857462
DONE TAKING  40  STEPS.
Total reward:  -296.2901147597792
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.92176670527172
DONE TAKING  40  STEPS.
Total reward:  -493.1506612254474
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.472649177619818
DONE TAKING  40  STEPS.
Total reward:  -553.013377266992
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.539923780538935
DONE TAKING  40  STEPS.
Total reward:  -844.9699192990826
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.306162285559747
DONE TAKING  40  STEPS.
Total reward:  -942.7792473450135
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.90152878073851
DONE TAKING  40  STEPS.
Total reward:  -639.5433371303743
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.201911925813675
DONE TAKING  40  STEPS.
Total reward:  -546.7538707086221
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -23.601149523680643
DONE TAKING  40  STEPS.
Total reward:  -806.5154166038384
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.905282519372047
DONE TAKING  40  STEPS.
Total reward:  -1182.9110965998284
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.824827268832145
DONE TAKING  40  STEPS.
Total reward:  -968.6735199352347
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -28.809581901822135
DONE TAKING  40  STEPS.
Total reward:  -890.3192243024819
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -31.40507000722124
DONE TAKING  40  STEPS.
Total reward:  -702.3272159941326
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.579247340284187
DONE TAKING  40  STEPS.
Total reward:  -832.0147244401192
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.025344355213242
DONE TAKING  40  STEPS.
Total reward:  -838.7116334239258
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -11.296213666345423
DONE TAKING  40  STEPS.
Total reward:  -367.5168644136876
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.413435647754675
DONE TAKING  40  STEPS.
Total reward:  -1027.1530775663387
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.97360747339649
DONE TAKING  40  STEPS.
Total reward:  -547.9351513093101
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.433234455128243
DONE TAKING  40  STEPS.
Total reward:  -956.1357666700605
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -11.993810162361864
DONE TAKING  40  STEPS.
Total reward:  -421.94523028127094
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.467377208621663
DONE TAKING  40  STEPS.
Total reward:  -424.1893222939852
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.311774044705096
DONE TAKING  40  STEPS.
Total reward:  -460.0664390896961
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -16.145795253441445
DONE TAKING  40  STEPS.
Total reward:  -606.2538159249538
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.69262443251283
DONE TAKING  40  STEPS.
Total reward:  -736.6738298883856
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.801488152427886
DONE TAKING  40  STEPS.
Total reward:  -448.68408200789304
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.715537775760865
DONE TAKING  40  STEPS.
Total reward:  -492.88504157768364
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.13332862059821
DONE TAKING  40  STEPS.
Total reward:  -669.8590917427811
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -25.618724235725942
DONE TAKING  40  STEPS.
Total reward:  -1010.6659101512718
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.777780168003375
DONE TAKING  40  STEPS.
Total reward:  -702.8287460863074
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.609077067795578
DONE TAKING  40  STEPS.
Total reward:  -639.3980304798245
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.99381641524717
DONE TAKING  40  STEPS.
Total reward:  -883.8838105434426
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.536655752628697
DONE TAKING  40  STEPS.
Total reward:  -746.5195307667691
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.15137103157341
DONE TAKING  40  STEPS.
Total reward:  -537.3124634493604
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.57367995406124
DONE TAKING  40  STEPS.
Total reward:  -932.2825929392149
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.27556027448771
DONE TAKING  40  STEPS.
Total reward:  -883.4909529645744
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.379434967867414
DONE TAKING  40  STEPS.
Total reward:  -558.2620140578923
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -14.89659846310201
DONE TAKING  40  STEPS.
Total reward:  -305.5739424711289
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.387956742880483
DONE TAKING  40  STEPS.
Total reward:  -741.8151610024712
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -10.892723850402016
DONE TAKING  40  STEPS.
Total reward:  -263.9869466767968
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.647464743997237
DONE TAKING  40  STEPS.
Total reward:  -640.9377339071971
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.98678061942268
DONE TAKING  40  STEPS.
Total reward:  -765.8801491866824
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 21
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  21
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5258761592078627
    val rand:  0
    val onPol:  0.3915669620037079

=== Epoch 10 ===
    train loss:  0.2549091214150713
    val rand:  0
    val onPol:  0.3157581140597661

=== Epoch 20 ===
    train loss:  0.2220461541100552
    val rand:  0
    val onPol:  0.31188302487134933

=== Epoch 30 ===
    train loss:  0.1987801999376531
    val rand:  0
    val onPol:  0.31292792161305744

=== Epoch 39 ===
    train loss:  0.17908566275186705
    val rand:  0
    val onPol:  0.31860826909542084
Training duration: 14.37 s

#####################################
performing on-policy MPC rollouts... iter  21
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.909157105102828
DONE TAKING  40  STEPS.
Total reward:  -901.765582117729
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -24.68662105918134
DONE TAKING  40  STEPS.
Total reward:  -534.6661781057276
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.617625736196004
DONE TAKING  40  STEPS.
Total reward:  -738.8511680284869
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.840622867062322
DONE TAKING  40  STEPS.
Total reward:  -392.073348683891
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.936515071089712
DONE TAKING  40  STEPS.
Total reward:  -386.203807476276
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.645055636113042
DONE TAKING  40  STEPS.
Total reward:  -448.16100787790543
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.33539119828721
DONE TAKING  40  STEPS.
Total reward:  -641.8122295312044
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -11.11607118393758
DONE TAKING  40  STEPS.
Total reward:  -301.14290608828856
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.36469324580957
DONE TAKING  40  STEPS.
Total reward:  -552.1697963338037
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.969430149338063
DONE TAKING  40  STEPS.
Total reward:  -669.2215348804177
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.327124269296966
DONE TAKING  40  STEPS.
Total reward:  -329.344197513108
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -16.097601035671026
DONE TAKING  40  STEPS.
Total reward:  -447.45035593159344
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.609191247063237
DONE TAKING  40  STEPS.
Total reward:  -975.6089910969632
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.607749298756
DONE TAKING  40  STEPS.
Total reward:  -796.5307332589305
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.420552996327178
DONE TAKING  40  STEPS.
Total reward:  -470.3288084305918
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -15.967278881389731
DONE TAKING  40  STEPS.
Total reward:  -298.3615547117324
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.735510826143297
DONE TAKING  40  STEPS.
Total reward:  -607.5133324587144
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -15.835926430568986
DONE TAKING  40  STEPS.
Total reward:  -351.15796154004164
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.56120698492351
DONE TAKING  40  STEPS.
Total reward:  -297.05139533405185
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.322242528602295
DONE TAKING  40  STEPS.
Total reward:  -743.9909872201331
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.815609891753653
DONE TAKING  40  STEPS.
Total reward:  -703.3168954971812
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.64783969501678
DONE TAKING  40  STEPS.
Total reward:  -788.4660005722428
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.775571541289906
DONE TAKING  40  STEPS.
Total reward:  -669.3866182972216
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.476373812157973
DONE TAKING  40  STEPS.
Total reward:  -1055.4543967302304
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.86104007087421
DONE TAKING  40  STEPS.
Total reward:  -819.6680922072507
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -13.134444200902568
DONE TAKING  40  STEPS.
Total reward:  -375.3396451568571
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.777707214760845
DONE TAKING  40  STEPS.
Total reward:  -826.4430931832092
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.715108668862836
DONE TAKING  40  STEPS.
Total reward:  -873.0811495471223
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.872393576748454
DONE TAKING  40  STEPS.
Total reward:  -725.5634309032257
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.935327746267
DONE TAKING  40  STEPS.
Total reward:  -521.2767777344859
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.316933900787696
DONE TAKING  40  STEPS.
Total reward:  -579.7726549945344
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.65395958173239
DONE TAKING  40  STEPS.
Total reward:  -895.3235671262825
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.09753469545469
DONE TAKING  40  STEPS.
Total reward:  -709.8428952871744
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -21.189976549494908
DONE TAKING  40  STEPS.
Total reward:  -634.9539670092296
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.165209182275714
DONE TAKING  40  STEPS.
Total reward:  -544.2148212727863
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.031323403066324
DONE TAKING  40  STEPS.
Total reward:  -913.4174010577092
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.296624573871632
DONE TAKING  40  STEPS.
Total reward:  -490.5377643554436
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.026632185621715
DONE TAKING  40  STEPS.
Total reward:  -374.2710195752015
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.689595488110925
DONE TAKING  40  STEPS.
Total reward:  -729.4029236676204
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.538040940474588
DONE TAKING  40  STEPS.
Total reward:  -458.3230485112399
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 22
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  22
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5196997178228278
    val rand:  0
    val onPol:  0.393897866209348

=== Epoch 10 ===
    train loss:  0.25263704830094386
    val rand:  0
    val onPol:  0.3223237519462903

=== Epoch 20 ===
    train loss:  0.2221236861588662
    val rand:  0
    val onPol:  0.3174366081754367

=== Epoch 30 ===
    train loss:  0.1984791154401344
    val rand:  0
    val onPol:  0.3178054615855217

=== Epoch 39 ===
    train loss:  0.17937274303352624
    val rand:  0
    val onPol:  0.3225494399666786
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  22
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -13.229225246678888
DONE TAKING  40  STEPS.
Total reward:  -260.85908314784706
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -15.252546983281729
DONE TAKING  40  STEPS.
Total reward:  -430.237273347716
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.356489846347948
DONE TAKING  40  STEPS.
Total reward:  -418.62761579854913
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.14130244716781
DONE TAKING  40  STEPS.
Total reward:  -790.715523407661
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.48362642271921
DONE TAKING  40  STEPS.
Total reward:  -602.4771737195355
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -14.898685929298825
DONE TAKING  40  STEPS.
Total reward:  -565.9290803974952
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -31.139390440794518
DONE TAKING  40  STEPS.
Total reward:  -714.6816094090068
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -24.782448481422197
DONE TAKING  40  STEPS.
Total reward:  -918.7160914258075
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.291673024515205
DONE TAKING  40  STEPS.
Total reward:  -710.3031746395757
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.08049020261043
DONE TAKING  40  STEPS.
Total reward:  -749.9987957902687
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -19.6734609209191
DONE TAKING  40  STEPS.
Total reward:  -676.0370648167619
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.39824540919807
DONE TAKING  40  STEPS.
Total reward:  -721.2841422191051
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.318412042601647
DONE TAKING  40  STEPS.
Total reward:  -1115.0487780470332
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.22260506515955
DONE TAKING  40  STEPS.
Total reward:  -466.01541580446013
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.801715872446795
DONE TAKING  40  STEPS.
Total reward:  -491.5107499801681
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.051571633648408
DONE TAKING  40  STEPS.
Total reward:  -508.7464067368323
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.517393303487793
DONE TAKING  40  STEPS.
Total reward:  -606.2379731774394
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.327343021896255
DONE TAKING  40  STEPS.
Total reward:  -896.843827403271
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -17.04103575985938
DONE TAKING  40  STEPS.
Total reward:  -411.83902218172085
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -20.85719004124193
DONE TAKING  40  STEPS.
Total reward:  -370.15852732804615
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -8.837415491823817
DONE TAKING  40  STEPS.
Total reward:  -328.68678597414225
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -13.54692232720925
DONE TAKING  40  STEPS.
Total reward:  -439.2554212120784
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.275822333984955
DONE TAKING  40  STEPS.
Total reward:  -416.2798841505133
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.5199683181715
DONE TAKING  40  STEPS.
Total reward:  -654.6870394311119
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.632741604227615
DONE TAKING  40  STEPS.
Total reward:  -671.3008678283355
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.435540069926844
DONE TAKING  40  STEPS.
Total reward:  -563.6357499671213
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.686394846552183
DONE TAKING  40  STEPS.
Total reward:  -853.888662096574
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.87926378267291
DONE TAKING  40  STEPS.
Total reward:  -543.0890327478929
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.968883676491892
DONE TAKING  40  STEPS.
Total reward:  -538.0957249458875
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.93374443247187
DONE TAKING  40  STEPS.
Total reward:  -759.2887493781287
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.613415449754733
DONE TAKING  40  STEPS.
Total reward:  -782.5793910297201
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -31.092193750437424
DONE TAKING  40  STEPS.
Total reward:  -780.6233396020394
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.663006324816244
DONE TAKING  40  STEPS.
Total reward:  -350.47217813717003
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -24.719579735659984
DONE TAKING  40  STEPS.
Total reward:  -928.2106332978376
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.251162447787983
DONE TAKING  40  STEPS.
Total reward:  -479.712184255294
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.134086890488025
DONE TAKING  40  STEPS.
Total reward:  -673.8058872091618
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -13.102083407685257
DONE TAKING  40  STEPS.
Total reward:  -471.4900805463539
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.267701732175134
DONE TAKING  40  STEPS.
Total reward:  -827.50919084688
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.838380620636258
DONE TAKING  40  STEPS.
Total reward:  -748.7851937229093
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.523746775303096
DONE TAKING  40  STEPS.
Total reward:  -905.3484048395708
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 23
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  23
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5191855770454072
    val rand:  0
    val onPol:  0.392959862947464

=== Epoch 10 ===
    train loss:  0.2517575579777099
    val rand:  0
    val onPol:  0.31953179836273193

=== Epoch 20 ===
    train loss:  0.21704979502318197
    val rand:  0
    val onPol:  0.31688549866278964

=== Epoch 30 ===
    train loss:  0.19190149636645065
    val rand:  0
    val onPol:  0.31733670085668564

=== Epoch 39 ===
    train loss:  0.17778093746879645
    val rand:  0
    val onPol:  0.3240099524458249
Training duration: 14.38 s

#####################################
performing on-policy MPC rollouts... iter  23
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.801900443408304
DONE TAKING  40  STEPS.
Total reward:  -597.887410782809
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.732688069473653
DONE TAKING  40  STEPS.
Total reward:  -878.4198614778711
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.39458849675336
DONE TAKING  40  STEPS.
Total reward:  -845.780927911266
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.42519025745741
DONE TAKING  40  STEPS.
Total reward:  -1063.5382755360995
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -17.617958745153203
DONE TAKING  40  STEPS.
Total reward:  -384.67280820548996
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.73024990262321
DONE TAKING  40  STEPS.
Total reward:  -522.6909022232002
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.94477337376043
DONE TAKING  40  STEPS.
Total reward:  -761.4075881086126
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -10.832648775271121
DONE TAKING  40  STEPS.
Total reward:  -229.5467619171817
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.75475710489345
DONE TAKING  40  STEPS.
Total reward:  -655.4344366289847
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.691917401587652
DONE TAKING  40  STEPS.
Total reward:  -699.3866672200618
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.755335972124207
DONE TAKING  40  STEPS.
Total reward:  -600.8004918359684
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.649246799182258
DONE TAKING  40  STEPS.
Total reward:  -1033.6384120527175
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.47347735404428
DONE TAKING  40  STEPS.
Total reward:  -584.7785290274674
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.171133939884147
DONE TAKING  40  STEPS.
Total reward:  -629.3744183253385
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.478439450355527
DONE TAKING  40  STEPS.
Total reward:  -551.9660960572872
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.168147123813235
DONE TAKING  40  STEPS.
Total reward:  -447.72622201118645
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.603445787685303
DONE TAKING  40  STEPS.
Total reward:  -911.871288412873
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -11.270051877878931
DONE TAKING  40  STEPS.
Total reward:  -289.8991748420627
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.71179111569076
DONE TAKING  40  STEPS.
Total reward:  -1007.2154061427244
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.149514871616343
DONE TAKING  40  STEPS.
Total reward:  -724.2233606063307
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.517808020780432
DONE TAKING  40  STEPS.
Total reward:  -1063.4402265150204
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.42324138367833
DONE TAKING  40  STEPS.
Total reward:  -379.70122879387804
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -27.250821382335015
DONE TAKING  40  STEPS.
Total reward:  -629.8150849837522
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -12.02486101998061
DONE TAKING  40  STEPS.
Total reward:  -435.50112097752645
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.564091245358043
DONE TAKING  40  STEPS.
Total reward:  -394.6192636967817
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.157652528935456
DONE TAKING  40  STEPS.
Total reward:  -512.5567551923747
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -14.839023053500433
DONE TAKING  40  STEPS.
Total reward:  -449.389095872018
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.903797610781652
DONE TAKING  40  STEPS.
Total reward:  -715.1229061673512
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.331013735853308
DONE TAKING  40  STEPS.
Total reward:  -586.5667744735781
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.507285322948164
DONE TAKING  40  STEPS.
Total reward:  -853.0489642647142
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.1466198954379
DONE TAKING  40  STEPS.
Total reward:  -836.2395578662188
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.43777280809303
DONE TAKING  40  STEPS.
Total reward:  -745.4321451686593
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.065456535297976
DONE TAKING  40  STEPS.
Total reward:  -582.4915644181024
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.493101364397408
DONE TAKING  40  STEPS.
Total reward:  -648.5218647889809
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.932463910796482
DONE TAKING  40  STEPS.
Total reward:  -790.0651572303315
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -25.369176687076596
DONE TAKING  40  STEPS.
Total reward:  -649.2611980175164
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.90476740403437
DONE TAKING  40  STEPS.
Total reward:  -955.8244423143793
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -19.136628931913616
DONE TAKING  40  STEPS.
Total reward:  -416.7487022528291
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -10.304489075220323
DONE TAKING  40  STEPS.
Total reward:  -272.2291925699656
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.68126618187094
DONE TAKING  40  STEPS.
Total reward:  -875.7652678748948
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 24
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  24
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5118386677482671
    val rand:  0
    val onPol:  0.40374402701854706

=== Epoch 10 ===
    train loss:  0.24904251255487142
    val rand:  0
    val onPol:  0.3320830538868904

=== Epoch 20 ===
    train loss:  0.21356504371291712
    val rand:  0
    val onPol:  0.32358144720395404

=== Epoch 30 ===
    train loss:  0.1903618022538068
    val rand:  0
    val onPol:  0.3262874335050583

=== Epoch 39 ===
    train loss:  0.1768496990726705
    val rand:  0
    val onPol:  0.3319156343738238
Training duration: 14.44 s

#####################################
performing on-policy MPC rollouts... iter  24
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.18733486491499
DONE TAKING  40  STEPS.
Total reward:  -520.9847461297263
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.894694512615303
DONE TAKING  40  STEPS.
Total reward:  -699.0804900317196
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.16785950285701
DONE TAKING  40  STEPS.
Total reward:  -524.579260656655
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.395213145123215
DONE TAKING  40  STEPS.
Total reward:  -643.2939697053779
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -19.434668779663397
DONE TAKING  40  STEPS.
Total reward:  -359.9865875920151
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.450072353387764
DONE TAKING  40  STEPS.
Total reward:  -749.2560001342365
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.185673891055153
DONE TAKING  40  STEPS.
Total reward:  -269.74150387205987
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.87943426606984
DONE TAKING  40  STEPS.
Total reward:  -718.9533503071432
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.84329407955344
DONE TAKING  40  STEPS.
Total reward:  -599.1023963396152
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -23.635677377782464
DONE TAKING  40  STEPS.
Total reward:  -619.1837875368399
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -23.0843136145695
DONE TAKING  40  STEPS.
Total reward:  -749.7747927608535
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.837644260581207
DONE TAKING  40  STEPS.
Total reward:  -637.0510113939611
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.604003458446698
DONE TAKING  40  STEPS.
Total reward:  -835.3552989260654
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.260502567426315
DONE TAKING  40  STEPS.
Total reward:  -523.5450511858054
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.360021741694087
DONE TAKING  40  STEPS.
Total reward:  -716.0839693521717
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.305061745539057
DONE TAKING  40  STEPS.
Total reward:  -414.30594028126075
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.849440804138954
DONE TAKING  40  STEPS.
Total reward:  -992.9662404315297
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.69818138795752
DONE TAKING  40  STEPS.
Total reward:  -443.8163566542961
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.208721246695227
DONE TAKING  40  STEPS.
Total reward:  -572.9306595392186
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.225124410102932
DONE TAKING  40  STEPS.
Total reward:  -782.2637610403665
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.867222433523676
DONE TAKING  40  STEPS.
Total reward:  -863.2681348768785
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.691982466063024
DONE TAKING  40  STEPS.
Total reward:  -768.9521744263959
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -18.14154667139438
DONE TAKING  40  STEPS.
Total reward:  -534.990599091709
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.526330088884322
DONE TAKING  40  STEPS.
Total reward:  -503.41995700291614
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.33318739511244
DONE TAKING  40  STEPS.
Total reward:  -588.5057028408293
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.89486316866344
DONE TAKING  40  STEPS.
Total reward:  -732.2182217130603
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.324144449730824
DONE TAKING  40  STEPS.
Total reward:  -880.1625017150709
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.133595002493042
DONE TAKING  40  STEPS.
Total reward:  -816.5015817746373
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -16.591361881889156
DONE TAKING  40  STEPS.
Total reward:  -499.5977959407696
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -14.876400378143263
DONE TAKING  40  STEPS.
Total reward:  -255.29524671292262
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.24973440169512
DONE TAKING  40  STEPS.
Total reward:  -769.2561554670884
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.34855526489466
DONE TAKING  40  STEPS.
Total reward:  -752.3411867188253
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.30399725864216
DONE TAKING  40  STEPS.
Total reward:  -601.5839679724731
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.34999671632979
DONE TAKING  40  STEPS.
Total reward:  -785.5694297428889
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.162250765345476
DONE TAKING  40  STEPS.
Total reward:  -392.1897184220848
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.729765173380425
DONE TAKING  40  STEPS.
Total reward:  -491.6420227945207
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.118815479938235
DONE TAKING  40  STEPS.
Total reward:  -378.4776914780092
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.91444049112468
DONE TAKING  40  STEPS.
Total reward:  -694.6825366766769
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.995606067667385
DONE TAKING  40  STEPS.
Total reward:  -647.8814556989012
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.49401640968067
DONE TAKING  40  STEPS.
Total reward:  -1067.529497672766
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 25
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  25
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.500368065478509
    val rand:  0
    val onPol:  0.39629338184992474

=== Epoch 10 ===
    train loss:  0.2430818088744816
    val rand:  0
    val onPol:  0.32013388226429623

=== Epoch 20 ===
    train loss:  0.20909180583661063
    val rand:  0
    val onPol:  0.313834269841512

=== Epoch 30 ===
    train loss:  0.18527990396608385
    val rand:  0
    val onPol:  0.3170645385980606

=== Epoch 39 ===
    train loss:  0.17112987815288075
    val rand:  0
    val onPol:  0.3210655053456624
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  25
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -9.340080151163008
DONE TAKING  40  STEPS.
Total reward:  -318.83048045795033
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.281275329935173
DONE TAKING  40  STEPS.
Total reward:  -697.023518591395
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.675845823187455
DONE TAKING  40  STEPS.
Total reward:  -459.8619628664436
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -13.564633473280555
DONE TAKING  40  STEPS.
Total reward:  -291.1428030880242
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.649982049948914
DONE TAKING  40  STEPS.
Total reward:  -864.4013358501534
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.384468159953144
DONE TAKING  40  STEPS.
Total reward:  -297.965724039334
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -14.777202633556655
DONE TAKING  40  STEPS.
Total reward:  -279.2689685865148
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.613828241913474
DONE TAKING  40  STEPS.
Total reward:  -768.8800186245145
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.77838384912061
DONE TAKING  40  STEPS.
Total reward:  -611.7333797448782
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -19.667600511190912
DONE TAKING  40  STEPS.
Total reward:  -488.0770365924526
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.98172745565801
DONE TAKING  40  STEPS.
Total reward:  -468.27079663913815
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.189474890845986
DONE TAKING  40  STEPS.
Total reward:  -492.5517577216119
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.81422236316968
DONE TAKING  40  STEPS.
Total reward:  -646.6030281839087
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -20.98212032453859
DONE TAKING  40  STEPS.
Total reward:  -775.797098764716
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.595168523401234
DONE TAKING  40  STEPS.
Total reward:  -524.3642051667827
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.86204897040774
DONE TAKING  40  STEPS.
Total reward:  -543.1030862751629
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.63664820598046
DONE TAKING  40  STEPS.
Total reward:  -554.5028570111947
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.36106190730161
DONE TAKING  40  STEPS.
Total reward:  -931.4628511448577
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.878209294525213
DONE TAKING  40  STEPS.
Total reward:  -771.1127065108196
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.393211500518532
DONE TAKING  40  STEPS.
Total reward:  -797.5982113366636
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.101184392021022
DONE TAKING  40  STEPS.
Total reward:  -394.07848446804684
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.67318319833972
DONE TAKING  40  STEPS.
Total reward:  -628.1483182335637
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.59826551693999
DONE TAKING  40  STEPS.
Total reward:  -676.2375738701288
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.024168991809454
DONE TAKING  40  STEPS.
Total reward:  -626.5266054283543
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -14.492748839488044
DONE TAKING  40  STEPS.
Total reward:  -559.90834816233
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -18.74580292370617
DONE TAKING  40  STEPS.
Total reward:  -696.7038211678883
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.280286948360175
DONE TAKING  40  STEPS.
Total reward:  -794.4552116802927
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -22.23730824686998
DONE TAKING  40  STEPS.
Total reward:  -456.6456862240872
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.33087145765117
DONE TAKING  40  STEPS.
Total reward:  -760.2062170766413
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.621928684957993
DONE TAKING  40  STEPS.
Total reward:  -908.1138269584251
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.04582700415859
DONE TAKING  40  STEPS.
Total reward:  -842.9789984277402
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.795642255182006
DONE TAKING  40  STEPS.
Total reward:  -781.6731360818136
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.263969079707223
DONE TAKING  40  STEPS.
Total reward:  -991.5335481952822
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -12.641750184952391
DONE TAKING  40  STEPS.
Total reward:  -365.57562832674114
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.337989256589125
DONE TAKING  40  STEPS.
Total reward:  -841.2736247219924
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.134479864245456
DONE TAKING  40  STEPS.
Total reward:  -372.45836626264554
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.674238451295007
DONE TAKING  40  STEPS.
Total reward:  -395.6234879619076
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.273169071163935
DONE TAKING  40  STEPS.
Total reward:  -460.76335994927257
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.08670820548896
DONE TAKING  40  STEPS.
Total reward:  -342.77759918684825
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.449204538849408
DONE TAKING  40  STEPS.
Total reward:  -832.1704288262969
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 26
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  26
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5010634179700885
    val rand:  0
    val onPol:  0.383990411957105

=== Epoch 10 ===
    train loss:  0.2402438437729551
    val rand:  0
    val onPol:  0.31101343284050625

=== Epoch 20 ===
    train loss:  0.20451481169775912
    val rand:  0
    val onPol:  0.3054070274035136

=== Epoch 30 ===
    train loss:  0.18355406585492587
    val rand:  0
    val onPol:  0.3070352052648862

=== Epoch 39 ===
    train loss:  0.1684658307778208
    val rand:  0
    val onPol:  0.31002946694691974
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  26
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.762384179312864
DONE TAKING  40  STEPS.
Total reward:  -719.1795416797358
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.537554493374355
DONE TAKING  40  STEPS.
Total reward:  -897.0240706962614
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.33881858923168
DONE TAKING  40  STEPS.
Total reward:  -386.16342732069484
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.12919088354162
DONE TAKING  40  STEPS.
Total reward:  -1073.72768686962
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.563478803601143
DONE TAKING  40  STEPS.
Total reward:  -465.43427454317236
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.028361823079045
DONE TAKING  40  STEPS.
Total reward:  -637.1716219694863
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.450854662044577
DONE TAKING  40  STEPS.
Total reward:  -383.24888687394196
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.74297094080972
DONE TAKING  40  STEPS.
Total reward:  -457.44510354444395
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.205988586619174
DONE TAKING  40  STEPS.
Total reward:  -359.13880472295466
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.098619388048387
DONE TAKING  40  STEPS.
Total reward:  -509.2268650371455
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.899764693616124
DONE TAKING  40  STEPS.
Total reward:  -959.4438842515509
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.46926814837501
DONE TAKING  40  STEPS.
Total reward:  -577.776985677507
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -15.81922902358018
DONE TAKING  40  STEPS.
Total reward:  -534.431768207943
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.837225747199064
DONE TAKING  40  STEPS.
Total reward:  -831.615930684159
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.91941119623581
DONE TAKING  40  STEPS.
Total reward:  -419.2947710311335
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -31.205597265895047
DONE TAKING  40  STEPS.
Total reward:  -637.1975408248381
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.81307829589028
DONE TAKING  40  STEPS.
Total reward:  -675.4548706574451
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.390194936942667
DONE TAKING  40  STEPS.
Total reward:  -7.134848565397137
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.118233272177036
DONE TAKING  40  STEPS.
Total reward:  -669.5825979576202
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.655197970565915
DONE TAKING  40  STEPS.
Total reward:  -604.3986922186239
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.30358468747635
DONE TAKING  40  STEPS.
Total reward:  -773.0316168812334
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.375709776417132
DONE TAKING  40  STEPS.
Total reward:  -882.1112234931687
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.549929161241014
DONE TAKING  40  STEPS.
Total reward:  -539.0284248753157
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.394446879542937
DONE TAKING  40  STEPS.
Total reward:  -889.6045809385475
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -20.064236012176483
DONE TAKING  40  STEPS.
Total reward:  -171.1467268597029
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.42353389413016
DONE TAKING  40  STEPS.
Total reward:  -925.6817747596573
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.763684746398404
DONE TAKING  40  STEPS.
Total reward:  -537.5568634714786
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.435456047146644
DONE TAKING  40  STEPS.
Total reward:  -1115.3931558660408
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.535142266579435
DONE TAKING  40  STEPS.
Total reward:  -798.9035329615003
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.012109617708603
DONE TAKING  40  STEPS.
Total reward:  -1030.0607807926804
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.429147840045424
DONE TAKING  40  STEPS.
Total reward:  -1116.2507651837843
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.054067853226023
DONE TAKING  40  STEPS.
Total reward:  -791.2335609463963
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -16.25415200408442
DONE TAKING  40  STEPS.
Total reward:  -515.6060575301443
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.32722792605444
DONE TAKING  40  STEPS.
Total reward:  -632.8749790235091
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.545233851170245
DONE TAKING  40  STEPS.
Total reward:  -801.923350505364
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.62823214134235
DONE TAKING  40  STEPS.
Total reward:  -776.5922337178317
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.546152864720113
DONE TAKING  40  STEPS.
Total reward:  -707.5721556474435
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.47243122669105
DONE TAKING  40  STEPS.
Total reward:  -397.1205054411068
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.512339594131703
DONE TAKING  40  STEPS.
Total reward:  -862.6054984551997
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -16.30989035963581
DONE TAKING  40  STEPS.
Total reward:  -363.77718553133366
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 27
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  27
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4928456403707203
    val rand:  0
    val onPol:  0.36583564182122547

=== Epoch 10 ===
    train loss:  0.2326916861429549
    val rand:  0
    val onPol:  0.2931062653660774

=== Epoch 20 ===
    train loss:  0.2018806309553615
    val rand:  0
    val onPol:  0.28546294818321866

=== Epoch 30 ===
    train loss:  0.17904116056467356
    val rand:  0
    val onPol:  0.28673536082108814

=== Epoch 39 ===
    train loss:  0.16684266480437496
    val rand:  0
    val onPol:  0.28999854624271393
Training duration: 14.43 s

#####################################
performing on-policy MPC rollouts... iter  27
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -27.20284736063817
DONE TAKING  40  STEPS.
Total reward:  -922.3011800343531
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.48377255044953
DONE TAKING  40  STEPS.
Total reward:  -519.0556861596436
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -28.50370535965636
DONE TAKING  40  STEPS.
Total reward:  -625.2671376156129
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.267374485716047
DONE TAKING  40  STEPS.
Total reward:  -750.2794063765657
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -12.996887348015992
DONE TAKING  40  STEPS.
Total reward:  -309.0031658209955
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -17.76809727188336
DONE TAKING  40  STEPS.
Total reward:  -270.10040465340535
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.093110855513498
DONE TAKING  40  STEPS.
Total reward:  -548.3210972263331
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.745905877735943
DONE TAKING  40  STEPS.
Total reward:  -616.9559780778043
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.016088516179135
DONE TAKING  40  STEPS.
Total reward:  -609.8031974832461
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.166475422089967
DONE TAKING  40  STEPS.
Total reward:  -808.6227350523382
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -19.68186835823751
DONE TAKING  40  STEPS.
Total reward:  -462.99212869701785
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.252170119395938
DONE TAKING  40  STEPS.
Total reward:  -831.7481736005593
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.381702928761609
DONE TAKING  40  STEPS.
Total reward:  -399.64247506787217
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -10.301110428257997
DONE TAKING  40  STEPS.
Total reward:  -227.79619743627683
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -31.123067903281484
DONE TAKING  40  STEPS.
Total reward:  -767.6198867195336
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.978262283377248
DONE TAKING  40  STEPS.
Total reward:  -417.3849742222375
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.106502317261885
DONE TAKING  40  STEPS.
Total reward:  -801.4968288780159
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -31.298193534613038
DONE TAKING  40  STEPS.
Total reward:  -872.3290158116681
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.319700925621596
DONE TAKING  40  STEPS.
Total reward:  -744.9077047708302
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.153710735464344
DONE TAKING  40  STEPS.
Total reward:  -463.8191476810841
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.433618288793152
DONE TAKING  40  STEPS.
Total reward:  -971.6641179512317
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -30.485059287378146
DONE TAKING  40  STEPS.
Total reward:  -827.7069346790847
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.036147830678658
DONE TAKING  40  STEPS.
Total reward:  -306.2426216824391
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.659861910008328
DONE TAKING  40  STEPS.
Total reward:  -667.2133615977269
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.015881651234533
DONE TAKING  40  STEPS.
Total reward:  -648.9023929621015
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.829914098759684
DONE TAKING  40  STEPS.
Total reward:  -1007.4846975436009
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.756990632702866
DONE TAKING  40  STEPS.
Total reward:  -810.5061041650075
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.458907897262108
DONE TAKING  40  STEPS.
Total reward:  -993.3398859101721
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.17724480426495
DONE TAKING  40  STEPS.
Total reward:  -608.8973808357779
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -11.380030828157466
DONE TAKING  40  STEPS.
Total reward:  -306.4018776656409
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -24.700165981854813
DONE TAKING  40  STEPS.
Total reward:  -611.5366368232718
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.683961170218687
DONE TAKING  40  STEPS.
Total reward:  -799.2199316430319
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.02644265670704
DONE TAKING  40  STEPS.
Total reward:  -302.11272489719954
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.563478686401268
DONE TAKING  40  STEPS.
Total reward:  -792.9922056897393
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.419408339509353
DONE TAKING  40  STEPS.
Total reward:  -725.4189992337522
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.40558194414979
DONE TAKING  40  STEPS.
Total reward:  -351.46826265245284
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.962776933049547
DONE TAKING  40  STEPS.
Total reward:  -288.767724070511
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -12.773815852087964
DONE TAKING  40  STEPS.
Total reward:  -200.46196761133996
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.467303420626134
DONE TAKING  40  STEPS.
Total reward:  -504.48329174185557
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.783969150590245
DONE TAKING  40  STEPS.
Total reward:  -1111.3554144955108
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 28
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  28
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48924841012871056
    val rand:  0
    val onPol:  0.35371161500612897

=== Epoch 10 ===
    train loss:  0.23273365879267977
    val rand:  0
    val onPol:  0.28085996210575104

=== Epoch 20 ===
    train loss:  0.1991162101427714
    val rand:  0
    val onPol:  0.27421805759270984

=== Epoch 30 ===
    train loss:  0.1785867951418224
    val rand:  0
    val onPol:  0.27510444323221844

=== Epoch 39 ===
    train loss:  0.16594609095339188
    val rand:  0
    val onPol:  0.2795187210043271
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  28
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.82393682734558
DONE TAKING  40  STEPS.
Total reward:  -1003.6491323548139
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.747544863313205
DONE TAKING  40  STEPS.
Total reward:  -810.5446029714511
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.007058988550796
DONE TAKING  40  STEPS.
Total reward:  -814.5075567410952
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.979686818497406
DONE TAKING  40  STEPS.
Total reward:  -735.8833734207341
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.01957575993519
DONE TAKING  40  STEPS.
Total reward:  -627.1477244980238
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.15622940568524
DONE TAKING  40  STEPS.
Total reward:  -765.9430435731936
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.741179376367889
DONE TAKING  40  STEPS.
Total reward:  -212.77214877825463
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.83981478108499
DONE TAKING  40  STEPS.
Total reward:  -750.9796037566712
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -13.222809305835515
DONE TAKING  40  STEPS.
Total reward:  -327.8207130857028
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.535543410277924
DONE TAKING  40  STEPS.
Total reward:  -581.1075786813059
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -30.5700322566064
DONE TAKING  40  STEPS.
Total reward:  -996.1138757161349
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -20.600692746045695
DONE TAKING  40  STEPS.
Total reward:  -591.3695071336347
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.581507161949585
DONE TAKING  40  STEPS.
Total reward:  -454.1414914042124
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.38701452205337
DONE TAKING  40  STEPS.
Total reward:  -769.4863550808828
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -11.893958161542422
DONE TAKING  40  STEPS.
Total reward:  -247.02113859982143
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -31.158721949763954
DONE TAKING  40  STEPS.
Total reward:  -890.4799558395731
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -10.07889160625487
DONE TAKING  40  STEPS.
Total reward:  -308.12104118605265
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.48060586604338
DONE TAKING  40  STEPS.
Total reward:  -465.74784269704713
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.569965507211524
DONE TAKING  40  STEPS.
Total reward:  -334.4562358294003
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.4315906071134
DONE TAKING  40  STEPS.
Total reward:  -528.6318654289038
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.777654802496016
DONE TAKING  40  STEPS.
Total reward:  -360.4671561045503
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -15.603428143581208
DONE TAKING  40  STEPS.
Total reward:  -441.43922720556594
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.554450458108974
DONE TAKING  40  STEPS.
Total reward:  -565.0773808181656
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.642975404206794
DONE TAKING  40  STEPS.
Total reward:  -520.1829431654622
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -23.500903520875873
DONE TAKING  40  STEPS.
Total reward:  -793.6153605232956
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.27651168292017
DONE TAKING  40  STEPS.
Total reward:  -442.71403123369214
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.624163843878105
DONE TAKING  40  STEPS.
Total reward:  -658.3081337868663
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.788971440434103
DONE TAKING  40  STEPS.
Total reward:  -911.5118685880337
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.84779195164043
DONE TAKING  40  STEPS.
Total reward:  -565.5115086174296
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.1852008145089
DONE TAKING  40  STEPS.
Total reward:  -351.6046053715205
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.706517051604
DONE TAKING  40  STEPS.
Total reward:  -260.642222343434
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.00979024923636
DONE TAKING  40  STEPS.
Total reward:  -936.2375799806838
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.328676313157665
DONE TAKING  40  STEPS.
Total reward:  -877.4558071333722
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.077048032486225
DONE TAKING  40  STEPS.
Total reward:  -336.91951105793225
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.243296040531405
DONE TAKING  40  STEPS.
Total reward:  -964.7248711190689
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.621729775487104
DONE TAKING  40  STEPS.
Total reward:  -995.4126932242034
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.331646946838777
DONE TAKING  40  STEPS.
Total reward:  -478.76158535711045
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.466295294078122
DONE TAKING  40  STEPS.
Total reward:  -535.4314825336827
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.407444476289253
DONE TAKING  40  STEPS.
Total reward:  -761.8753784250833
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.749767161644282
DONE TAKING  40  STEPS.
Total reward:  -614.9838022102645
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 29
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  29
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49032398953772427
    val rand:  0
    val onPol:  0.3653033872445424

=== Epoch 10 ===
    train loss:  0.22970936957158541
    val rand:  0
    val onPol:  0.2920032665133476

=== Epoch 20 ===
    train loss:  0.19863367629678627
    val rand:  0
    val onPol:  0.28295131027698517

=== Epoch 30 ===
    train loss:  0.1775411526884949
    val rand:  0
    val onPol:  0.2828260312477748

=== Epoch 39 ===
    train loss:  0.16323724049225188
    val rand:  0
    val onPol:  0.28492119659980136
Training duration: 14.16 s

#####################################
performing on-policy MPC rollouts... iter  29
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.368931500615815
DONE TAKING  40  STEPS.
Total reward:  -770.3412948399606
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.70663790604987
DONE TAKING  40  STEPS.
Total reward:  -232.99433650468822
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.86981122786704
DONE TAKING  40  STEPS.
Total reward:  -535.6706328823885
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.104714077481894
DONE TAKING  40  STEPS.
Total reward:  -791.4652038269986
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.565766029595185
DONE TAKING  40  STEPS.
Total reward:  -564.0532748016085
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.02297109793367
DONE TAKING  40  STEPS.
Total reward:  -484.8471641706695
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.852398931108546
DONE TAKING  40  STEPS.
Total reward:  -800.1472164000735
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.795839991190597
DONE TAKING  40  STEPS.
Total reward:  -821.9995886955877
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.762518877142853
DONE TAKING  40  STEPS.
Total reward:  -1012.0908541302789
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -12.507685568543724
DONE TAKING  40  STEPS.
Total reward:  -285.40473339196643
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.978211612512617
DONE TAKING  40  STEPS.
Total reward:  -1104.2212138003754
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.580307211440584
DONE TAKING  40  STEPS.
Total reward:  -1015.4960105824987
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -17.616440510919738
DONE TAKING  40  STEPS.
Total reward:  -301.56347168432103
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -18.727001081863047
DONE TAKING  40  STEPS.
Total reward:  -563.8488819808682
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.863639549029983
DONE TAKING  40  STEPS.
Total reward:  -448.70719669433834
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -19.708783382114245
DONE TAKING  40  STEPS.
Total reward:  -323.94645812918355
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.073557873976952
DONE TAKING  40  STEPS.
Total reward:  -825.7811373146924
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.102986979638796
DONE TAKING  40  STEPS.
Total reward:  -705.9537155557175
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.331577585626945
DONE TAKING  40  STEPS.
Total reward:  -819.3636085866927
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.99421647842229
DONE TAKING  40  STEPS.
Total reward:  -637.2261344231691
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.71798327406851
DONE TAKING  40  STEPS.
Total reward:  -583.1180000992622
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.388506034377563
DONE TAKING  40  STEPS.
Total reward:  -598.8944584469205
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.85804940435829
DONE TAKING  40  STEPS.
Total reward:  -628.8501052735567
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.62574166170064
DONE TAKING  40  STEPS.
Total reward:  -447.6766046876876
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -14.04227016167483
DONE TAKING  40  STEPS.
Total reward:  -425.4284126930544
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.511226051989297
DONE TAKING  40  STEPS.
Total reward:  -303.11231895445144
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.42702337574793
DONE TAKING  40  STEPS.
Total reward:  -816.9924314718796
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.078951387440043
DONE TAKING  40  STEPS.
Total reward:  -426.80013726258477
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.41922130221052
DONE TAKING  40  STEPS.
Total reward:  -546.7779035533727
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.995854425258663
DONE TAKING  40  STEPS.
Total reward:  -768.3235285249278
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.33261595650145
DONE TAKING  40  STEPS.
Total reward:  -530.6423991818732
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.763661529854183
DONE TAKING  40  STEPS.
Total reward:  -694.6279515649929
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.817348241937985
DONE TAKING  40  STEPS.
Total reward:  -292.6238660163811
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -15.669518441544028
DONE TAKING  40  STEPS.
Total reward:  -346.3739642281585
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.564289118329082
DONE TAKING  40  STEPS.
Total reward:  -666.4402515847596
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -20.67532144455289
DONE TAKING  40  STEPS.
Total reward:  -602.3215204609866
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -31.16969627328355
DONE TAKING  40  STEPS.
Total reward:  -836.0749779894836
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.406908229157047
DONE TAKING  40  STEPS.
Total reward:  -665.8236904755912
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.457454195921137
DONE TAKING  40  STEPS.
Total reward:  -641.2482446645078
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.03665988307842
DONE TAKING  40  STEPS.
Total reward:  -241.2957306190681
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 30
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  30
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5006085942711747
    val rand:  0
    val onPol:  0.3721863428751628

=== Epoch 10 ===
    train loss:  0.2278616446674916
    val rand:  0
    val onPol:  0.29244887828826904

=== Epoch 20 ===
    train loss:  0.1979083910323026
    val rand:  0
    val onPol:  0.2865908195575078

=== Epoch 30 ===
    train loss:  0.1789477177356419
    val rand:  0
    val onPol:  0.28491247196992237

=== Epoch 39 ===
    train loss:  0.1630960825765342
    val rand:  0
    val onPol:  0.29049212982257205
Training duration: 14.15 s

#####################################
performing on-policy MPC rollouts... iter  30
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.03847230014624
DONE TAKING  40  STEPS.
Total reward:  -800.890876433848
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.48429356770871
DONE TAKING  40  STEPS.
Total reward:  -547.7819507493637
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.431465958284031
DONE TAKING  40  STEPS.
Total reward:  -246.91379092950547
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.914697410149913
DONE TAKING  40  STEPS.
Total reward:  -399.28935808262713
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -14.408374404657323
DONE TAKING  40  STEPS.
Total reward:  -329.66402008157525
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.144232506411836
DONE TAKING  40  STEPS.
Total reward:  -302.80081130707384
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.3271496480776
DONE TAKING  40  STEPS.
Total reward:  -554.4348290875151
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.532282996362966
DONE TAKING  40  STEPS.
Total reward:  -174.20357415535747
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.78576823451825
DONE TAKING  40  STEPS.
Total reward:  -648.6111372803316
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.60974464010171
DONE TAKING  40  STEPS.
Total reward:  -813.6401451093424
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.395784349659863
DONE TAKING  40  STEPS.
Total reward:  -461.5282593298882
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.61484219454609
DONE TAKING  40  STEPS.
Total reward:  -873.9435370226938
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -30.051877001148988
DONE TAKING  40  STEPS.
Total reward:  -715.7334287298329
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.74757041220195
DONE TAKING  40  STEPS.
Total reward:  -691.5407007434387
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.878571436696955
DONE TAKING  40  STEPS.
Total reward:  -466.6423136570253
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.832784911849107
DONE TAKING  40  STEPS.
Total reward:  -701.6173166161075
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.95844717956183
DONE TAKING  40  STEPS.
Total reward:  -648.6889520337944
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -22.752659135586892
DONE TAKING  40  STEPS.
Total reward:  -764.6788847333313
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.460129882094215
DONE TAKING  40  STEPS.
Total reward:  -421.8492132860882
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.605741308765595
DONE TAKING  40  STEPS.
Total reward:  -647.2541827028645
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -15.543202746732248
DONE TAKING  40  STEPS.
Total reward:  -19.558720080821203
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -9.538093963825727
DONE TAKING  40  STEPS.
Total reward:  208.92020701376603
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -31.149251215053862
DONE TAKING  40  STEPS.
Total reward:  -666.7383894213525
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.251089821812029
DONE TAKING  40  STEPS.
Total reward:  -249.66674746564416
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.677723705285022
DONE TAKING  40  STEPS.
Total reward:  -198.07759752033957
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -13.825256265556822
DONE TAKING  40  STEPS.
Total reward:  -382.14704810465423
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -15.238921437909717
DONE TAKING  40  STEPS.
Total reward:  -318.82113769221024
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -11.009753970879895
DONE TAKING  40  STEPS.
Total reward:  -372.0611968215785
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.339294699344304
DONE TAKING  40  STEPS.
Total reward:  -608.4278384861749
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.120348241429767
DONE TAKING  40  STEPS.
Total reward:  -912.9301950833245
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.26142083438739
DONE TAKING  40  STEPS.
Total reward:  -620.6035145813115
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -30.205473640923085
DONE TAKING  40  STEPS.
Total reward:  -790.4024929969174
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.567844623854228
DONE TAKING  40  STEPS.
Total reward:  -885.0911692479201
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -13.853528108095635
DONE TAKING  40  STEPS.
Total reward:  -363.6907750596022
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.823655926590376
DONE TAKING  40  STEPS.
Total reward:  -729.2831422149842
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.57079108704468
DONE TAKING  40  STEPS.
Total reward:  -915.3426221499819
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.294253594500226
DONE TAKING  40  STEPS.
Total reward:  -832.0989142932633
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -14.468600439601431
DONE TAKING  40  STEPS.
Total reward:  -296.67684762833744
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.095504067102535
DONE TAKING  40  STEPS.
Total reward:  -875.8561130461727
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.719820157259242
DONE TAKING  40  STEPS.
Total reward:  -455.47639758410014
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 31
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  31
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49169686488937914
    val rand:  0
    val onPol:  0.369595542550087

=== Epoch 10 ===
    train loss:  0.232606195566947
    val rand:  0
    val onPol:  0.2955162251989047

=== Epoch 20 ===
    train loss:  0.19995619069065965
    val rand:  0
    val onPol:  0.28743159274260205

=== Epoch 30 ===
    train loss:  0.18029323716958365
    val rand:  0
    val onPol:  0.2895559296011925

=== Epoch 39 ===
    train loss:  0.16365130585536622
    val rand:  0
    val onPol:  0.29131989429394406
Training duration: 14.38 s

#####################################
performing on-policy MPC rollouts... iter  31
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.199727964842875
DONE TAKING  40  STEPS.
Total reward:  -539.4623649489289
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.229749442169208
DONE TAKING  40  STEPS.
Total reward:  -505.25188360073173
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.374971144067736
DONE TAKING  40  STEPS.
Total reward:  -795.0341981489701
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.056068264804253
DONE TAKING  40  STEPS.
Total reward:  -691.0538513384005
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -17.25114295903815
DONE TAKING  40  STEPS.
Total reward:  -311.3214395355631
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -17.978507051960673
DONE TAKING  40  STEPS.
Total reward:  -390.0998102231636
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -14.144449038379875
DONE TAKING  40  STEPS.
Total reward:  -330.6493056515739
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.55173783273149
DONE TAKING  40  STEPS.
Total reward:  -334.58739436662995
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.95225842023614
DONE TAKING  40  STEPS.
Total reward:  -896.9787056743328
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -29.084073950229595
DONE TAKING  40  STEPS.
Total reward:  -1022.4026051519979
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -13.506692478691653
DONE TAKING  40  STEPS.
Total reward:  -283.4689378517686
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.756853769285293
DONE TAKING  40  STEPS.
Total reward:  -530.9333890308143
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.486999638100023
DONE TAKING  40  STEPS.
Total reward:  -924.7618986557605
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.44548434512975
DONE TAKING  40  STEPS.
Total reward:  -762.3323387383541
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -10.260241940891643
DONE TAKING  40  STEPS.
Total reward:  -336.1051963220977
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.579546655926723
DONE TAKING  40  STEPS.
Total reward:  -355.4888691743409
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -12.338711149231628
DONE TAKING  40  STEPS.
Total reward:  -68.60530824407894
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -12.391445619200013
DONE TAKING  40  STEPS.
Total reward:  -310.40596230734485
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.42213108427167
DONE TAKING  40  STEPS.
Total reward:  -310.5768080041092
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.17023992406279
DONE TAKING  40  STEPS.
Total reward:  -329.2474016032666
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.654373497071417
DONE TAKING  40  STEPS.
Total reward:  -470.0131570302712
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -28.197453636122717
DONE TAKING  40  STEPS.
Total reward:  -603.3106461972103
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -14.107016706495529
DONE TAKING  40  STEPS.
Total reward:  -402.56937304289664
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -14.979530514646445
DONE TAKING  40  STEPS.
Total reward:  -328.0122508922546
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -14.872110793583717
DONE TAKING  40  STEPS.
Total reward:  -478.1636727029865
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.329731244152118
DONE TAKING  40  STEPS.
Total reward:  -448.0260201541989
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.74812021091808
DONE TAKING  40  STEPS.
Total reward:  -894.343328889143
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.708232541354715
DONE TAKING  40  STEPS.
Total reward:  -594.5620741196435
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.867903875192333
DONE TAKING  40  STEPS.
Total reward:  -685.8578053501983
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.494581278713767
DONE TAKING  40  STEPS.
Total reward:  -759.6167246338032
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.10408687739195
DONE TAKING  40  STEPS.
Total reward:  -784.4732750537031
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.362641943459366
DONE TAKING  40  STEPS.
Total reward:  -830.9085629864979
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.72805382452295
DONE TAKING  40  STEPS.
Total reward:  -965.5547889514603
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.960657478219446
DONE TAKING  40  STEPS.
Total reward:  -464.96171807788505
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.07989424807322
DONE TAKING  40  STEPS.
Total reward:  -306.8990920279996
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.045512841013245
DONE TAKING  40  STEPS.
Total reward:  -868.8009035840626
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.65392595371832
DONE TAKING  40  STEPS.
Total reward:  -513.6174752744049
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.353458797215417
DONE TAKING  40  STEPS.
Total reward:  -587.0556500348571
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.12887983324547
DONE TAKING  40  STEPS.
Total reward:  -628.426035449566
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.496449281894055
DONE TAKING  40  STEPS.
Total reward:  -451.06059324524114
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 32
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  32
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4830516869561714
    val rand:  0
    val onPol:  0.3728715628385544

=== Epoch 10 ===
    train loss:  0.2316849589870687
    val rand:  0
    val onPol:  0.2984785884618759

=== Epoch 20 ===
    train loss:  0.19574818537946334
    val rand:  0
    val onPol:  0.28933042536179227

=== Epoch 30 ===
    train loss:  0.17691118257087574
    val rand:  0
    val onPol:  0.293155940870444

=== Epoch 39 ===
    train loss:  0.16106233288321578
    val rand:  0
    val onPol:  0.29340696334838867
Training duration: 14.18 s

#####################################
performing on-policy MPC rollouts... iter  32
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.612911027368796
DONE TAKING  40  STEPS.
Total reward:  -668.3373178285386
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.47255104664375
DONE TAKING  40  STEPS.
Total reward:  -539.9436334664914
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.74495950467449
DONE TAKING  40  STEPS.
Total reward:  -819.877889712152
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.9614145813906
DONE TAKING  40  STEPS.
Total reward:  -908.755127255381
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.87506680819151
DONE TAKING  40  STEPS.
Total reward:  -426.18701737499475
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -19.506336784769967
DONE TAKING  40  STEPS.
Total reward:  -594.1606237275951
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -22.413735006879424
DONE TAKING  40  STEPS.
Total reward:  -565.2530216074459
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.087455696401406
DONE TAKING  40  STEPS.
Total reward:  -581.4718335009181
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -31.382279206190518
DONE TAKING  40  STEPS.
Total reward:  -817.6212420673811
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.090337211593152
DONE TAKING  40  STEPS.
Total reward:  -324.9756839563401
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.734766408182868
DONE TAKING  40  STEPS.
Total reward:  -795.8064591780549
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.911966899432038
DONE TAKING  40  STEPS.
Total reward:  -716.6403009094644
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.163999082144837
DONE TAKING  40  STEPS.
Total reward:  -410.48698860446615
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.355187010565643
DONE TAKING  40  STEPS.
Total reward:  -780.0295152910811
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.14353703931333
DONE TAKING  40  STEPS.
Total reward:  112.39516816867211
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -15.216987986314338
DONE TAKING  40  STEPS.
Total reward:  -536.3097697815458
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.780371756361376
DONE TAKING  40  STEPS.
Total reward:  -799.1221558934515
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -16.483738515408824
DONE TAKING  40  STEPS.
Total reward:  -283.9977640732156
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.89797024290771
DONE TAKING  40  STEPS.
Total reward:  -396.8235629702581
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -13.496198878940957
DONE TAKING  40  STEPS.
Total reward:  -271.72889968110564
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.786147610767262
DONE TAKING  40  STEPS.
Total reward:  -343.0770201569833
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -16.167294126704647
DONE TAKING  40  STEPS.
Total reward:  -375.7426774771606
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.666268348274826
DONE TAKING  40  STEPS.
Total reward:  -786.3403951022245
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.673634873430977
DONE TAKING  40  STEPS.
Total reward:  -306.81132073715764
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.10138721052802
DONE TAKING  40  STEPS.
Total reward:  -348.2497034505365
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.609497906829773
DONE TAKING  40  STEPS.
Total reward:  -958.0519852216198
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.62823941719262
DONE TAKING  40  STEPS.
Total reward:  -366.64449532945855
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -14.07109958788392
DONE TAKING  40  STEPS.
Total reward:  -500.94694870028826
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.007568374726052
DONE TAKING  40  STEPS.
Total reward:  -642.8693619452422
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -11.59149381081685
DONE TAKING  40  STEPS.
Total reward:  -342.7909955257201
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -17.994049582472353
DONE TAKING  40  STEPS.
Total reward:  -618.4951008079576
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -14.853176789367195
DONE TAKING  40  STEPS.
Total reward:  -179.01331136893378
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.459850305331273
DONE TAKING  40  STEPS.
Total reward:  -581.0658058731537
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.635834674572873
DONE TAKING  40  STEPS.
Total reward:  -279.8612289026192
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.451784724223153
DONE TAKING  40  STEPS.
Total reward:  -575.8801185634524
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.293568931774637
DONE TAKING  40  STEPS.
Total reward:  -509.1140130697475
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.81366964718752
DONE TAKING  40  STEPS.
Total reward:  -445.31074049687567
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -27.17509172828301
DONE TAKING  40  STEPS.
Total reward:  -853.3712938546082
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -12.929347600559025
DONE TAKING  40  STEPS.
Total reward:  -615.8150586573767
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.8447561124081
DONE TAKING  40  STEPS.
Total reward:  -313.15934256144254
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 33
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  33
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4888509606060229
    val rand:  0
    val onPol:  0.38155461351076764

=== Epoch 10 ===
    train loss:  0.23014747861184573
    val rand:  0
    val onPol:  0.30420278012752533

=== Epoch 20 ===
    train loss:  0.19833494931982273
    val rand:  0
    val onPol:  0.2978706583380699

=== Epoch 30 ===
    train loss:  0.1764894601022988
    val rand:  0
    val onPol:  0.29999231298764545

=== Epoch 39 ===
    train loss:  0.16483350542553685
    val rand:  0
    val onPol:  0.3037598604957263
Training duration: 14.19 s

#####################################
performing on-policy MPC rollouts... iter  33
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.540350893769467
DONE TAKING  40  STEPS.
Total reward:  -607.6085915487267
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.76738099526841
DONE TAKING  40  STEPS.
Total reward:  -292.1369016599496
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.051572721765435
DONE TAKING  40  STEPS.
Total reward:  -606.3337416664283
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -29.45157713830539
DONE TAKING  40  STEPS.
Total reward:  -685.8236587216986
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.15888320571455
DONE TAKING  40  STEPS.
Total reward:  -314.32608881028443
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.14723418083296
DONE TAKING  40  STEPS.
Total reward:  -532.8651464523163
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.72869985860467
DONE TAKING  40  STEPS.
Total reward:  -644.1742639804421
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.62715131875059
DONE TAKING  40  STEPS.
Total reward:  -407.44964206005443
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.236978702644777
DONE TAKING  40  STEPS.
Total reward:  -507.00337625957934
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -24.54396269552663
DONE TAKING  40  STEPS.
Total reward:  -985.8056227777856
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.268528066270477
DONE TAKING  40  STEPS.
Total reward:  -243.53249573170814
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.24351523192348
DONE TAKING  40  STEPS.
Total reward:  -885.7331048056982
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.869463329616746
DONE TAKING  40  STEPS.
Total reward:  -673.9051005171509
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.805440189404628
DONE TAKING  40  STEPS.
Total reward:  -648.4523065680004
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.387233534640128
DONE TAKING  40  STEPS.
Total reward:  -589.4159413102846
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -12.240039741082672
DONE TAKING  40  STEPS.
Total reward:  -327.57726725586724
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.513800450730013
DONE TAKING  40  STEPS.
Total reward:  -1057.131523526181
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.198922747826856
DONE TAKING  40  STEPS.
Total reward:  -670.543547337383
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -18.138736530198955
DONE TAKING  40  STEPS.
Total reward:  -447.73347707815776
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.062008880650275
DONE TAKING  40  STEPS.
Total reward:  -489.01331094967605
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -28.537900948619658
DONE TAKING  40  STEPS.
Total reward:  -850.0677481958209
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.453618415548522
DONE TAKING  40  STEPS.
Total reward:  -800.375603261913
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.00416454406667
DONE TAKING  40  STEPS.
Total reward:  -358.2561293638454
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.55391810110558
DONE TAKING  40  STEPS.
Total reward:  -391.98412684715095
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -14.73677182988367
DONE TAKING  40  STEPS.
Total reward:  -441.49478632126045
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.941578263794481
DONE TAKING  40  STEPS.
Total reward:  -291.73688968442434
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.577595111503932
DONE TAKING  40  STEPS.
Total reward:  -895.7760293606742
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.96097713831049
DONE TAKING  40  STEPS.
Total reward:  -609.0533003747969
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.266584318628446
DONE TAKING  40  STEPS.
Total reward:  -604.1190652877711
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.709451675046992
DONE TAKING  40  STEPS.
Total reward:  -515.4075693625102
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.263153395023263
DONE TAKING  40  STEPS.
Total reward:  -858.9913484526534
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.99499722456154
DONE TAKING  40  STEPS.
Total reward:  -508.4994763953541
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.391378329143965
DONE TAKING  40  STEPS.
Total reward:  -892.8536162356897
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.605591260243653
DONE TAKING  40  STEPS.
Total reward:  -579.8684055123643
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -18.17877934817797
DONE TAKING  40  STEPS.
Total reward:  -476.8812265658614
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.634966775903592
DONE TAKING  40  STEPS.
Total reward:  -277.067330111476
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.388706961248324
DONE TAKING  40  STEPS.
Total reward:  -568.0472156937697
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.450034788711363
DONE TAKING  40  STEPS.
Total reward:  -740.7427980826185
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.067590684640702
DONE TAKING  40  STEPS.
Total reward:  -824.2933998067012
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -17.743680757338453
DONE TAKING  40  STEPS.
Total reward:  -632.2092796088781
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 34
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  34
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4801668221490425
    val rand:  0
    val onPol:  0.358736793200175

=== Epoch 10 ===
    train loss:  0.22686124475378738
    val rand:  0
    val onPol:  0.2879897803068161

=== Epoch 20 ===
    train loss:  0.19617166853787607
    val rand:  0
    val onPol:  0.28486139327287674

=== Epoch 30 ===
    train loss:  0.1764550763264037
    val rand:  0
    val onPol:  0.2821863691012065

=== Epoch 39 ===
    train loss:  0.16266252701742606
    val rand:  0
    val onPol:  0.28801818440357846
Training duration: 14.14 s

#####################################
performing on-policy MPC rollouts... iter  34
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.141422059152177
DONE TAKING  40  STEPS.
Total reward:  -485.113819143638
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -12.873405257329281
DONE TAKING  40  STEPS.
Total reward:  -472.02862476926447
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.17304084726147
DONE TAKING  40  STEPS.
Total reward:  -623.0956278541038
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.637951806206978
DONE TAKING  40  STEPS.
Total reward:  -868.0980642991741
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.386512326862412
DONE TAKING  40  STEPS.
Total reward:  -997.6464498528917
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.79421702580247
DONE TAKING  40  STEPS.
Total reward:  -1003.1191825723525
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.275340484812624
DONE TAKING  40  STEPS.
Total reward:  -511.5965208719322
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.8878920135391
DONE TAKING  40  STEPS.
Total reward:  -802.9969873338944
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -15.035776017607336
DONE TAKING  40  STEPS.
Total reward:  -599.6783550467708
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.17782481655057
DONE TAKING  40  STEPS.
Total reward:  -657.1599207551549
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.06508696278831
DONE TAKING  40  STEPS.
Total reward:  -324.14266930465106
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.75514566795218
DONE TAKING  40  STEPS.
Total reward:  -311.4707696509857
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -20.140303761311323
DONE TAKING  40  STEPS.
Total reward:  -523.5734825910814
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -31.103420264352533
DONE TAKING  40  STEPS.
Total reward:  -676.75591366988
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.80586409165369
DONE TAKING  40  STEPS.
Total reward:  -1123.421413366479
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.49250682153582
DONE TAKING  40  STEPS.
Total reward:  -1036.0186506725104
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.717776192992428
DONE TAKING  40  STEPS.
Total reward:  -626.1656930037188
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.50588034687042
DONE TAKING  40  STEPS.
Total reward:  -817.4607564605413
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.126337193473418
DONE TAKING  40  STEPS.
Total reward:  -820.6060862601947
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.647738672996994
DONE TAKING  40  STEPS.
Total reward:  -489.2496514378907
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -20.10832236458053
DONE TAKING  40  STEPS.
Total reward:  -230.3154938761423
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.480834224898786
DONE TAKING  40  STEPS.
Total reward:  -901.4036257585742
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.906255070850012
DONE TAKING  40  STEPS.
Total reward:  -297.84583311242494
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.990723251112044
DONE TAKING  40  STEPS.
Total reward:  -726.9997479884227
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -24.739533988795948
DONE TAKING  40  STEPS.
Total reward:  -453.2380284440155
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.820047080363594
DONE TAKING  40  STEPS.
Total reward:  -534.6556508428259
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.04831541510213
DONE TAKING  40  STEPS.
Total reward:  -602.2111364252002
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.56359720814234
DONE TAKING  40  STEPS.
Total reward:  -599.8274932359332
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.447154172157518
DONE TAKING  40  STEPS.
Total reward:  -484.89724198560214
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.202754323024934
DONE TAKING  40  STEPS.
Total reward:  -439.4625110906783
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.379456695930948
DONE TAKING  40  STEPS.
Total reward:  -389.032844193803
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -20.860435085947586
DONE TAKING  40  STEPS.
Total reward:  -787.3070210149529
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.980022527952265
DONE TAKING  40  STEPS.
Total reward:  -853.9492056222175
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.802141536758697
DONE TAKING  40  STEPS.
Total reward:  -811.9641181586054
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -31.270304980447307
DONE TAKING  40  STEPS.
Total reward:  -739.3480109048897
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -17.904105264397877
DONE TAKING  40  STEPS.
Total reward:  -656.8090401500534
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.695422048613668
DONE TAKING  40  STEPS.
Total reward:  -448.8197046872209
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -21.438404384331644
DONE TAKING  40  STEPS.
Total reward:  -473.0251174733995
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.899155426986525
DONE TAKING  40  STEPS.
Total reward:  -618.71286692862
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.73939307394773
DONE TAKING  40  STEPS.
Total reward:  -475.3394640018749
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 35
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  35
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48080117869795413
    val rand:  0
    val onPol:  0.36022935807704926

=== Epoch 10 ===
    train loss:  0.22112343107399188
    val rand:  0
    val onPol:  0.2912773018081983

=== Epoch 20 ===
    train loss:  0.1952636307268812
    val rand:  0
    val onPol:  0.2853401005268097

=== Epoch 30 ===
    train loss:  0.17423430869453832
    val rand:  0
    val onPol:  0.28410882502794266

=== Epoch 39 ===
    train loss:  0.15995989922891585
    val rand:  0
    val onPol:  0.2854530910650889
Training duration: 14.11 s

#####################################
performing on-policy MPC rollouts... iter  35
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.513999010681434
DONE TAKING  40  STEPS.
Total reward:  -806.8405022787839
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.776548584583615
DONE TAKING  40  STEPS.
Total reward:  -681.9054975919452
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.67815391321148
DONE TAKING  40  STEPS.
Total reward:  -555.0513424436442
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.036838925732958
DONE TAKING  40  STEPS.
Total reward:  -634.556361296685
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.29842627855078
DONE TAKING  40  STEPS.
Total reward:  -657.7444180080546
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.968375239082988
DONE TAKING  40  STEPS.
Total reward:  -650.6886931406576
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -24.20332005020005
DONE TAKING  40  STEPS.
Total reward:  -484.93129329007706
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.002005589531517
DONE TAKING  40  STEPS.
Total reward:  -1019.1806405127576
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -11.379272133156618
DONE TAKING  40  STEPS.
Total reward:  -185.58018668178264
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -11.315181406958054
DONE TAKING  40  STEPS.
Total reward:  -430.32677469404143
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.908014661218544
DONE TAKING  40  STEPS.
Total reward:  -532.1571299806805
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.167535110346726
DONE TAKING  40  STEPS.
Total reward:  -722.0955253372641
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.588131678525905
DONE TAKING  40  STEPS.
Total reward:  -624.8985248641177
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.576691304195172
DONE TAKING  40  STEPS.
Total reward:  -839.3835206999714
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -13.900450964409366
DONE TAKING  40  STEPS.
Total reward:  -209.33116717925213
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.239244951148898
DONE TAKING  40  STEPS.
Total reward:  -381.51687296592365
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.129700807000464
DONE TAKING  40  STEPS.
Total reward:  -591.0250699712826
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.024329368191516
DONE TAKING  40  STEPS.
Total reward:  -568.69391159092
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.883689393774517
DONE TAKING  40  STEPS.
Total reward:  -719.2198899094965
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -21.040525954565137
DONE TAKING  40  STEPS.
Total reward:  -378.45720994090414
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -16.33044483926899
DONE TAKING  40  STEPS.
Total reward:  -574.6086215978979
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.210338673108186
DONE TAKING  40  STEPS.
Total reward:  -397.23977360739156
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.7062469839651
DONE TAKING  40  STEPS.
Total reward:  -381.26748561604376
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.10572199430182
DONE TAKING  40  STEPS.
Total reward:  -490.0895274189983
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.125070538105955
DONE TAKING  40  STEPS.
Total reward:  -948.2074061731059
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.425555098957073
DONE TAKING  40  STEPS.
Total reward:  -441.524793343104
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.730071605469945
DONE TAKING  40  STEPS.
Total reward:  -306.75110300495584
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.293675764383977
DONE TAKING  40  STEPS.
Total reward:  -726.1301233038572
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.16960658039143
DONE TAKING  40  STEPS.
Total reward:  -869.3077525439859
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -14.257124960556558
DONE TAKING  40  STEPS.
Total reward:  -406.0769788269702
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.517443789684176
DONE TAKING  40  STEPS.
Total reward:  -766.4585424365196
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.515976298912598
DONE TAKING  40  STEPS.
Total reward:  -604.3347855352192
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.783747142558916
DONE TAKING  40  STEPS.
Total reward:  -909.7451273672405
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.68226423949737
DONE TAKING  40  STEPS.
Total reward:  -873.6815142676627
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.744827063869423
DONE TAKING  40  STEPS.
Total reward:  -362.47783819684236
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.991996990198157
DONE TAKING  40  STEPS.
Total reward:  -894.9023691150917
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.27010167901112
DONE TAKING  40  STEPS.
Total reward:  -362.2357442624933
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.282578759690182
DONE TAKING  40  STEPS.
Total reward:  -818.2854385258007
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.350672509185834
DONE TAKING  40  STEPS.
Total reward:  -804.0153976799088
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.939323166640587
DONE TAKING  40  STEPS.
Total reward:  -533.3189920644144
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 36
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  36
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47000873193406223
    val rand:  0
    val onPol:  0.3592090557018916

=== Epoch 10 ===
    train loss:  0.22421655085003167
    val rand:  0
    val onPol:  0.28699370721975964

=== Epoch 20 ===
    train loss:  0.19420249028164044
    val rand:  0
    val onPol:  0.28094518184661865

=== Epoch 30 ===
    train loss:  0.1728449427244956
    val rand:  0
    val onPol:  0.28025857359170914

=== Epoch 39 ===
    train loss:  0.1598265176279503
    val rand:  0
    val onPol:  0.2821077009042104
Training duration: 14.10 s

#####################################
performing on-policy MPC rollouts... iter  36
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -31.18611269596945
DONE TAKING  40  STEPS.
Total reward:  -714.3202398147928
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -22.104434076184564
DONE TAKING  40  STEPS.
Total reward:  -856.7536465154037
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.29450486571582
DONE TAKING  40  STEPS.
Total reward:  -527.8889194533206
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.151939086787134
DONE TAKING  40  STEPS.
Total reward:  -679.5062523819224
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -14.50371975473474
DONE TAKING  40  STEPS.
Total reward:  -270.1531114511262
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.47192167269428
DONE TAKING  40  STEPS.
Total reward:  -546.0615662209865
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.451634373653757
DONE TAKING  40  STEPS.
Total reward:  -712.837399433059
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.820377845272002
DONE TAKING  40  STEPS.
Total reward:  -408.43688604996163
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.20261545984682
DONE TAKING  40  STEPS.
Total reward:  -641.9938039688737
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -31.17441092416124
DONE TAKING  40  STEPS.
Total reward:  -728.1400855040166
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.274541803959227
DONE TAKING  40  STEPS.
Total reward:  -446.0297130180555
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.30685129924993
DONE TAKING  40  STEPS.
Total reward:  -548.1284879371328
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.709532671487597
DONE TAKING  40  STEPS.
Total reward:  -628.688656603071
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -19.153094245929566
DONE TAKING  40  STEPS.
Total reward:  -579.4843904617642
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.95254737167571
DONE TAKING  40  STEPS.
Total reward:  -669.1426154476945
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.50894963371961
DONE TAKING  40  STEPS.
Total reward:  -496.4994084843248
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.047451412263396
DONE TAKING  40  STEPS.
Total reward:  -377.5596503324404
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.188202094164197
DONE TAKING  40  STEPS.
Total reward:  -239.95480682471518
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.018899391459684
DONE TAKING  40  STEPS.
Total reward:  -442.6787441332227
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.517811406994145
DONE TAKING  40  STEPS.
Total reward:  -690.5317954795473
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.897332894729804
DONE TAKING  40  STEPS.
Total reward:  -407.61608247977614
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.59059426327144
DONE TAKING  40  STEPS.
Total reward:  -530.1400135962799
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.87916408426349
DONE TAKING  40  STEPS.
Total reward:  -587.0756674688238
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.97398022498446
DONE TAKING  40  STEPS.
Total reward:  -636.8333291947721
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.92839895608504
DONE TAKING  40  STEPS.
Total reward:  -612.0544774292132
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.633858644262656
DONE TAKING  40  STEPS.
Total reward:  -595.9193897163099
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -16.46275945772227
DONE TAKING  40  STEPS.
Total reward:  -284.4537871619087
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.38020257280733
DONE TAKING  40  STEPS.
Total reward:  -613.3443923389873
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.13632605235423
DONE TAKING  40  STEPS.
Total reward:  -799.4344033965285
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.689273003857874
DONE TAKING  40  STEPS.
Total reward:  -888.0782097285568
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -16.358042608093495
DONE TAKING  40  STEPS.
Total reward:  -220.91009337649575
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -18.147132951303796
DONE TAKING  40  STEPS.
Total reward:  -298.32866909814527
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -27.98329191622563
DONE TAKING  40  STEPS.
Total reward:  -769.7462157405582
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.320827080042253
DONE TAKING  40  STEPS.
Total reward:  -595.8723589871199
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.490970176992782
DONE TAKING  40  STEPS.
Total reward:  -821.7805987926374
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.033374379176728
DONE TAKING  40  STEPS.
Total reward:  -535.430932949909
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.507219982909696
DONE TAKING  40  STEPS.
Total reward:  -345.9498399225843
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.46957278191699
DONE TAKING  40  STEPS.
Total reward:  -418.6795734579247
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.62492365805319
DONE TAKING  40  STEPS.
Total reward:  -213.5092485806621
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -25.974748675983594
DONE TAKING  40  STEPS.
Total reward:  -790.3049752887135
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 37
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  37
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47768701273098324
    val rand:  0
    val onPol:  0.35269102950890857

=== Epoch 10 ===
    train loss:  0.22240746596403288
    val rand:  0
    val onPol:  0.27889955540498096

=== Epoch 20 ===
    train loss:  0.1928468997541227
    val rand:  0
    val onPol:  0.2728543281555176

=== Epoch 30 ===
    train loss:  0.17439848812002884
    val rand:  0
    val onPol:  0.2725020721554756

=== Epoch 39 ===
    train loss:  0.16021942177362608
    val rand:  0
    val onPol:  0.27586886783440906
Training duration: 14.17 s

#####################################
performing on-policy MPC rollouts... iter  37
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -13.326885614792886
DONE TAKING  40  STEPS.
Total reward:  -207.19145732785609
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -20.466518431159667
DONE TAKING  40  STEPS.
Total reward:  -346.7692433392027
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -22.228760113025743
DONE TAKING  40  STEPS.
Total reward:  -758.6333052632476
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -21.00952136371069
DONE TAKING  40  STEPS.
Total reward:  -441.13355910705087
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.940716911685715
DONE TAKING  40  STEPS.
Total reward:  -531.381487692929
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.42412502894645
DONE TAKING  40  STEPS.
Total reward:  -527.690914488295
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.81865901081651
DONE TAKING  40  STEPS.
Total reward:  -703.0382940497864
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.819959616814057
DONE TAKING  40  STEPS.
Total reward:  -819.623415799976
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.665812858940527
DONE TAKING  40  STEPS.
Total reward:  -485.221331956513
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -29.0266630402953
DONE TAKING  40  STEPS.
Total reward:  -958.1802814868785
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -18.225452845416154
DONE TAKING  40  STEPS.
Total reward:  -466.75491934838055
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -19.979578548663117
DONE TAKING  40  STEPS.
Total reward:  -932.3643799564554
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.9204353060986
DONE TAKING  40  STEPS.
Total reward:  -917.4176823206273
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.28288975047227
DONE TAKING  40  STEPS.
Total reward:  -820.5161033469492
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.96581528705159
DONE TAKING  40  STEPS.
Total reward:  -946.0126339633168
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.797526552568407
DONE TAKING  40  STEPS.
Total reward:  -449.36131862558454
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.751465013325255
DONE TAKING  40  STEPS.
Total reward:  -656.6724188430801
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.824128656960305
DONE TAKING  40  STEPS.
Total reward:  -389.72501601326223
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.8585635888728
DONE TAKING  40  STEPS.
Total reward:  -574.4426777486915
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.618431530333467
DONE TAKING  40  STEPS.
Total reward:  -375.99473602813873
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.909311006568515
DONE TAKING  40  STEPS.
Total reward:  -864.6122112509665
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.782237669064333
DONE TAKING  40  STEPS.
Total reward:  -288.6435028535856
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.855393387045268
DONE TAKING  40  STEPS.
Total reward:  -585.0090332958945
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -25.984148071268443
DONE TAKING  40  STEPS.
Total reward:  -798.0406907460774
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.085442124071875
DONE TAKING  40  STEPS.
Total reward:  -832.4596107585749
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -17.960975288093007
DONE TAKING  40  STEPS.
Total reward:  -350.9416700064147
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -30.948094042220063
DONE TAKING  40  STEPS.
Total reward:  -783.9999743754317
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -25.91588099330826
DONE TAKING  40  STEPS.
Total reward:  -825.1214778528606
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -9.997984962246711
DONE TAKING  40  STEPS.
Total reward:  -361.72636797361196
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.70414649102442
DONE TAKING  40  STEPS.
Total reward:  -609.376532032364
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -27.944635533301067
DONE TAKING  40  STEPS.
Total reward:  -731.1997806848956
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.522581016478
DONE TAKING  40  STEPS.
Total reward:  -441.966073654122
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.461504443763694
DONE TAKING  40  STEPS.
Total reward:  -753.2071941325144
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -23.88189499890943
DONE TAKING  40  STEPS.
Total reward:  -487.54803317113544
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.47974190034663
DONE TAKING  40  STEPS.
Total reward:  -521.8215376950751
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.231878643182316
DONE TAKING  40  STEPS.
Total reward:  -750.4685369300779
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.47110669238993
DONE TAKING  40  STEPS.
Total reward:  -629.519766802342
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.964886552283005
DONE TAKING  40  STEPS.
Total reward:  -861.7111504711094
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.519869378700953
DONE TAKING  40  STEPS.
Total reward:  -239.6937324428339
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.110705981162415
DONE TAKING  40  STEPS.
Total reward:  -504.94060600374536
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 38
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  38
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48864945664740445
    val rand:  0
    val onPol:  0.36527042587598163

=== Epoch 10 ===
    train loss:  0.22251641567338976
    val rand:  0
    val onPol:  0.29059937099615735

=== Epoch 20 ===
    train loss:  0.19315068554459958
    val rand:  0
    val onPol:  0.2842542926470439

=== Epoch 30 ===
    train loss:  0.17242191914926497
    val rand:  0
    val onPol:  0.28521441916624707

=== Epoch 39 ===
    train loss:  0.15903249670538985
    val rand:  0
    val onPol:  0.28707558413346607
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  38
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.145985850505415
DONE TAKING  40  STEPS.
Total reward:  -950.7261103243441
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.724797575695938
DONE TAKING  40  STEPS.
Total reward:  -938.6909146788316
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.234592981278176
DONE TAKING  40  STEPS.
Total reward:  -744.9537876498155
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.787781282872068
DONE TAKING  40  STEPS.
Total reward:  -565.2062913547651
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.340634373022333
DONE TAKING  40  STEPS.
Total reward:  -700.812497374156
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.769685698837318
DONE TAKING  40  STEPS.
Total reward:  -262.40798396557966
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.07271397819931
DONE TAKING  40  STEPS.
Total reward:  -506.2413576202791
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.275402484043006
DONE TAKING  40  STEPS.
Total reward:  -539.0527310090617
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.92067434247511
DONE TAKING  40  STEPS.
Total reward:  -588.291042938646
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.63056193336531
DONE TAKING  40  STEPS.
Total reward:  -874.1949508552389
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.243728100293737
DONE TAKING  40  STEPS.
Total reward:  -709.9517046424405
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.285925840008563
DONE TAKING  40  STEPS.
Total reward:  -538.8674191020051
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.457772139683595
DONE TAKING  40  STEPS.
Total reward:  -274.9243430201371
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.172653147422036
DONE TAKING  40  STEPS.
Total reward:  -390.21548825269963
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -14.387122338826527
DONE TAKING  40  STEPS.
Total reward:  -368.1208531290537
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.345649339026586
DONE TAKING  40  STEPS.
Total reward:  -268.51211698478744
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.901584891044195
DONE TAKING  40  STEPS.
Total reward:  -549.8980466188947
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.476960011031764
DONE TAKING  40  STEPS.
Total reward:  -585.701382120284
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.500474101886397
DONE TAKING  40  STEPS.
Total reward:  -414.92177219389333
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -10.66251232538308
DONE TAKING  40  STEPS.
Total reward:  -410.50477761262033
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.018121089690972
DONE TAKING  40  STEPS.
Total reward:  -725.2223952018587
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -18.565389476256474
DONE TAKING  40  STEPS.
Total reward:  -644.5002961847754
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -18.511053244960387
DONE TAKING  40  STEPS.
Total reward:  -279.3285343223072
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.704645349315477
DONE TAKING  40  STEPS.
Total reward:  -506.7502262745794
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.101074457792052
DONE TAKING  40  STEPS.
Total reward:  -759.8456784911396
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.128356237023958
DONE TAKING  40  STEPS.
Total reward:  -665.1706156407702
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.758324937685064
DONE TAKING  40  STEPS.
Total reward:  -731.8111894938986
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.20350504906706
DONE TAKING  40  STEPS.
Total reward:  -374.6834036641338
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -26.921655397585877
DONE TAKING  40  STEPS.
Total reward:  -434.6228510186595
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.243051522933385
DONE TAKING  40  STEPS.
Total reward:  -863.3997540663114
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.72830216540822
DONE TAKING  40  STEPS.
Total reward:  -530.9700563512222
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -23.93341755721469
DONE TAKING  40  STEPS.
Total reward:  -316.4987817972029
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.493498726244066
DONE TAKING  40  STEPS.
Total reward:  -596.1842829276676
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.120380263364545
DONE TAKING  40  STEPS.
Total reward:  -893.4976117441919
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -23.20540786070523
DONE TAKING  40  STEPS.
Total reward:  -662.5003076914142
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.098803022672183
DONE TAKING  40  STEPS.
Total reward:  -835.6458941130771
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.89938263778061
DONE TAKING  40  STEPS.
Total reward:  -771.2891947046008
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.958288373486432
DONE TAKING  40  STEPS.
Total reward:  -609.4206106774087
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.88404063163398
DONE TAKING  40  STEPS.
Total reward:  -379.94364472541395
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.74054648357683
DONE TAKING  40  STEPS.
Total reward:  -323.74800249894
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 39
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  39
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4867069966960372
    val rand:  0
    val onPol:  0.36871935427188873

=== Epoch 10 ===
    train loss:  0.2242975512094665
    val rand:  0
    val onPol:  0.29932957887649536

=== Epoch 20 ===
    train loss:  0.19602457865288384
    val rand:  0
    val onPol:  0.2942524204651515

=== Epoch 30 ===
    train loss:  0.17567833865943708
    val rand:  0
    val onPol:  0.2954287528991699

=== Epoch 39 ===
    train loss:  0.16185742041520906
    val rand:  0
    val onPol:  0.2988693316777547
Training duration: 14.50 s

#####################################
performing on-policy MPC rollouts... iter  39
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.097546400772274
DONE TAKING  40  STEPS.
Total reward:  -539.6665435155967
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.672045979499284
DONE TAKING  40  STEPS.
Total reward:  -916.7961711863475
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -16.30316999924507
DONE TAKING  40  STEPS.
Total reward:  -389.46373506392075
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.589238854412677
DONE TAKING  40  STEPS.
Total reward:  -532.4331568725285
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -15.259905197779764
DONE TAKING  40  STEPS.
Total reward:  -258.5976484170351
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.078458455204974
DONE TAKING  40  STEPS.
Total reward:  -552.1170795678645
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.77440761875208
DONE TAKING  40  STEPS.
Total reward:  -477.8539523777504
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.153586742446226
DONE TAKING  40  STEPS.
Total reward:  -623.5901821910963
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.803838822485808
DONE TAKING  40  STEPS.
Total reward:  -351.2537686373504
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -12.765443275207069
DONE TAKING  40  STEPS.
Total reward:  -297.9682408449593
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.98917273481225
DONE TAKING  40  STEPS.
Total reward:  -610.0608913302028
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -30.307861166910634
DONE TAKING  40  STEPS.
Total reward:  -878.2504291878492
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -17.666407004189246
DONE TAKING  40  STEPS.
Total reward:  -452.2323013137467
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -14.491408201931497
DONE TAKING  40  STEPS.
Total reward:  -409.36493047769727
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.086985811234035
DONE TAKING  40  STEPS.
Total reward:  -481.57157740333133
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.546102351868544
DONE TAKING  40  STEPS.
Total reward:  -615.9195273747165
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.29709615281936
DONE TAKING  40  STEPS.
Total reward:  -752.2522996262851
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.438666144140416
DONE TAKING  40  STEPS.
Total reward:  -615.1479037930288
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.33591973346478
DONE TAKING  40  STEPS.
Total reward:  -628.6768642980171
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.121823447452172
DONE TAKING  40  STEPS.
Total reward:  -959.4718548833456
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.199442962750155
DONE TAKING  40  STEPS.
Total reward:  -661.8922806155125
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.726667227441283
DONE TAKING  40  STEPS.
Total reward:  -881.816825113065
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.769643430199174
DONE TAKING  40  STEPS.
Total reward:  -893.812714408055
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -11.295037651493976
DONE TAKING  40  STEPS.
Total reward:  -260.61896741659524
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.969013633866506
DONE TAKING  40  STEPS.
Total reward:  -515.2129030966686
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.500154943475966
DONE TAKING  40  STEPS.
Total reward:  -1048.4757574208425
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.35934663518163
DONE TAKING  40  STEPS.
Total reward:  -706.4471206186396
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.614188705042174
DONE TAKING  40  STEPS.
Total reward:  -729.5427001890197
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -16.61373369266557
DONE TAKING  40  STEPS.
Total reward:  -420.4664598244325
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.050882685056646
DONE TAKING  40  STEPS.
Total reward:  -602.2027813177208
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.656021483342307
DONE TAKING  40  STEPS.
Total reward:  -479.5257252373709
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.8409846192279
DONE TAKING  40  STEPS.
Total reward:  -513.7009713842563
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.75521510562936
DONE TAKING  40  STEPS.
Total reward:  -568.1752602555191
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.566887536704712
DONE TAKING  40  STEPS.
Total reward:  -514.2622058503622
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.911931856461997
DONE TAKING  40  STEPS.
Total reward:  -468.8765096372989
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.635049008026
DONE TAKING  40  STEPS.
Total reward:  -745.3323239562892
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.33030657538934
DONE TAKING  40  STEPS.
Total reward:  -550.8960687812463
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -15.737662597939392
DONE TAKING  40  STEPS.
Total reward:  -382.1223801343212
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.980907349969073
DONE TAKING  40  STEPS.
Total reward:  -1036.9835604936384
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -16.320290894956045
DONE TAKING  40  STEPS.
Total reward:  -391.0090194226967
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 40
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  40
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48498659698586716
    val rand:  0
    val onPol:  0.3730025291442871

=== Epoch 10 ===
    train loss:  0.22568136427486152
    val rand:  0
    val onPol:  0.3037160436312358

=== Epoch 20 ===
    train loss:  0.19876147466793395
    val rand:  0
    val onPol:  0.29917026807864505

=== Epoch 30 ===
    train loss:  0.17598416015767215
    val rand:  0
    val onPol:  0.3004673073689143

=== Epoch 39 ===
    train loss:  0.16053589158936551
    val rand:  0
    val onPol:  0.30051860213279724
Training duration: 14.28 s

#####################################
performing on-policy MPC rollouts... iter  40
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.126297777043376
DONE TAKING  40  STEPS.
Total reward:  -564.0283785231043
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.760661055406203
DONE TAKING  40  STEPS.
Total reward:  -543.1057478600479
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.013488283782134
DONE TAKING  40  STEPS.
Total reward:  -855.3504753104631
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.51971717760449
DONE TAKING  40  STEPS.
Total reward:  -682.2976864206202
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -15.167584948038463
DONE TAKING  40  STEPS.
Total reward:  -451.63451169922246
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.881623193085623
DONE TAKING  40  STEPS.
Total reward:  -807.5346943154574
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -16.41727244104027
DONE TAKING  40  STEPS.
Total reward:  -359.65000660509793
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.0382432083775
DONE TAKING  40  STEPS.
Total reward:  -926.7005635307853
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.083673030627516
DONE TAKING  40  STEPS.
Total reward:  -865.380889181768
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.28452532305602
DONE TAKING  40  STEPS.
Total reward:  -1035.4435837568199
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.102266397246122
DONE TAKING  40  STEPS.
Total reward:  -726.8861315357201
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.844668591692788
DONE TAKING  40  STEPS.
Total reward:  -648.1042952030618
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.17200441304218
DONE TAKING  40  STEPS.
Total reward:  -669.7274963261547
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.837581082524757
DONE TAKING  40  STEPS.
Total reward:  -389.8867760778927
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.274562189200807
DONE TAKING  40  STEPS.
Total reward:  -500.57257614588474
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.649900540244833
DONE TAKING  40  STEPS.
Total reward:  -403.70931099312287
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -17.93227367938774
DONE TAKING  40  STEPS.
Total reward:  -290.389914227779
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.29552053697911
DONE TAKING  40  STEPS.
Total reward:  -625.6950590504626
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.84362161101742
DONE TAKING  40  STEPS.
Total reward:  -297.9577910459362
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.840641933336943
DONE TAKING  40  STEPS.
Total reward:  -513.2511441620819
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -13.303214882339107
DONE TAKING  40  STEPS.
Total reward:  -378.04965935503526
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.780075529183396
DONE TAKING  40  STEPS.
Total reward:  -987.5240162384514
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -23.25966452687883
DONE TAKING  40  STEPS.
Total reward:  -864.6795397422654
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.97751900003736
DONE TAKING  40  STEPS.
Total reward:  -992.9671797066069
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.38629026841241
DONE TAKING  40  STEPS.
Total reward:  -607.4111583022978
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.708628994686382
DONE TAKING  40  STEPS.
Total reward:  -843.1697121235209
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.456715800498507
DONE TAKING  40  STEPS.
Total reward:  -446.32224016450465
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.590467883759278
DONE TAKING  40  STEPS.
Total reward:  -273.7229313686055
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.018294417378346
DONE TAKING  40  STEPS.
Total reward:  -631.4402844869338
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.812969024672032
DONE TAKING  40  STEPS.
Total reward:  -603.40709594232
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -11.414476869120982
DONE TAKING  40  STEPS.
Total reward:  -224.46340672737296
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.4130195480967
DONE TAKING  40  STEPS.
Total reward:  -548.2059770733391
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.03441536432298
DONE TAKING  40  STEPS.
Total reward:  -760.0615445218748
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.12192372583251
DONE TAKING  40  STEPS.
Total reward:  -347.07917948413717
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.463779459543606
DONE TAKING  40  STEPS.
Total reward:  -795.8037861267148
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.336358580840106
DONE TAKING  40  STEPS.
Total reward:  -479.07311277058005
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -10.20108610496065
DONE TAKING  40  STEPS.
Total reward:  83.09379677998483
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.685109602017633
DONE TAKING  40  STEPS.
Total reward:  -531.2462209079982
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.838611126081158
DONE TAKING  40  STEPS.
Total reward:  -511.55109942837527
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.322333028569105
DONE TAKING  40  STEPS.
Total reward:  -522.8609252283472
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 41
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  41
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48041161790228726
    val rand:  0
    val onPol:  0.37303588291009265

=== Epoch 10 ===
    train loss:  0.2223998682017912
    val rand:  0
    val onPol:  0.3071443388859431

=== Epoch 20 ===
    train loss:  0.1955290988349078
    val rand:  0
    val onPol:  0.2982763946056366

=== Epoch 30 ===
    train loss:  0.1751354130213721
    val rand:  0
    val onPol:  0.3021966318289439

=== Epoch 39 ===
    train loss:  0.16166490159536662
    val rand:  0
    val onPol:  0.30413516114155453
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  41
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.042210991200694
DONE TAKING  40  STEPS.
Total reward:  -304.86141246121736
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.739198213448212
DONE TAKING  40  STEPS.
Total reward:  -335.22583301011656
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.767715924102227
DONE TAKING  40  STEPS.
Total reward:  -525.1293973580033
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -26.03564489668818
DONE TAKING  40  STEPS.
Total reward:  -572.0403664486455
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.445509110381945
DONE TAKING  40  STEPS.
Total reward:  -143.60734887794268
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.619612562408456
DONE TAKING  40  STEPS.
Total reward:  -356.3264954751479
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -14.564659533146497
DONE TAKING  40  STEPS.
Total reward:  -340.4282099825969
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.178947899457768
DONE TAKING  40  STEPS.
Total reward:  -729.5849421991193
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.79680918897604
DONE TAKING  40  STEPS.
Total reward:  -534.6810346572106
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.685046391050776
DONE TAKING  40  STEPS.
Total reward:  -822.76496343978
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.21964932872055
DONE TAKING  40  STEPS.
Total reward:  -769.0247079170904
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -17.810892776150762
DONE TAKING  40  STEPS.
Total reward:  -572.8991637589372
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -25.826504525456393
DONE TAKING  40  STEPS.
Total reward:  -849.7825870558357
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.80614059897824
DONE TAKING  40  STEPS.
Total reward:  -560.8410477621
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.871109724254264
DONE TAKING  40  STEPS.
Total reward:  -484.22951427347
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.463742210124856
DONE TAKING  40  STEPS.
Total reward:  -595.4384196570052
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.40508866539068
DONE TAKING  40  STEPS.
Total reward:  -138.8290569908193
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.26192326352686
DONE TAKING  40  STEPS.
Total reward:  -754.0800959830307
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.762070662702694
DONE TAKING  40  STEPS.
Total reward:  -789.3325513242731
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -15.727003577149492
DONE TAKING  40  STEPS.
Total reward:  -618.0758720814139
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -17.9229820687326
DONE TAKING  40  STEPS.
Total reward:  -306.16107736436305
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -16.164255889569183
DONE TAKING  40  STEPS.
Total reward:  -538.7806098783054
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -17.437642488498533
DONE TAKING  40  STEPS.
Total reward:  -597.4479908177104
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.449746278974036
DONE TAKING  40  STEPS.
Total reward:  -792.6169931876215
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.730353606763536
DONE TAKING  40  STEPS.
Total reward:  -705.7447545048635
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -20.030678857133978
DONE TAKING  40  STEPS.
Total reward:  -506.16300001728126
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.00679011872869
DONE TAKING  40  STEPS.
Total reward:  -767.5252215750135
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.226316126760764
DONE TAKING  40  STEPS.
Total reward:  -531.2248796402962
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.056621000019742
DONE TAKING  40  STEPS.
Total reward:  -715.9853005098474
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.86068854016893
DONE TAKING  40  STEPS.
Total reward:  -256.22240302766636
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -18.114967235138476
DONE TAKING  40  STEPS.
Total reward:  -277.8181204870506
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -19.295640780557527
DONE TAKING  40  STEPS.
Total reward:  -493.2190882132545
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -30.391753204194885
DONE TAKING  40  STEPS.
Total reward:  -598.8350670150854
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.207502452797208
DONE TAKING  40  STEPS.
Total reward:  -860.2567176727433
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.868928313546995
DONE TAKING  40  STEPS.
Total reward:  -605.0152334551253
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.321168959453534
DONE TAKING  40  STEPS.
Total reward:  -703.3795672161143
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.93788183715794
DONE TAKING  40  STEPS.
Total reward:  -247.454622686912
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -17.51653024916535
DONE TAKING  40  STEPS.
Total reward:  -144.549570335347
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -24.29512754553732
DONE TAKING  40  STEPS.
Total reward:  -549.7743474926103
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.320228177271634
DONE TAKING  40  STEPS.
Total reward:  -804.7156410933225
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 42
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  42
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4806457642923322
    val rand:  0
    val onPol:  0.3729654848575592

=== Epoch 10 ===
    train loss:  0.22258950508477396
    val rand:  0
    val onPol:  0.30114157994588214

=== Epoch 20 ===
    train loss:  0.1954622119665146
    val rand:  0
    val onPol:  0.2965565298994382

=== Epoch 30 ===
    train loss:  0.17541026441674484
    val rand:  0
    val onPol:  0.2976962625980377

=== Epoch 39 ===
    train loss:  0.16157885078798262
    val rand:  0
    val onPol:  0.30129479120175046
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  42
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.712365475294717
DONE TAKING  40  STEPS.
Total reward:  -609.8677941661863
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.185855177056222
DONE TAKING  40  STEPS.
Total reward:  -498.2992659933433
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.991684977454618
DONE TAKING  40  STEPS.
Total reward:  -461.38175091871153
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -11.074037794187607
DONE TAKING  40  STEPS.
Total reward:  -268.79025570663225
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.26637370823966
DONE TAKING  40  STEPS.
Total reward:  -548.9513811703144
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.815839278878666
DONE TAKING  40  STEPS.
Total reward:  -750.115421216144
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.673304060050828
DONE TAKING  40  STEPS.
Total reward:  -729.9642016817578
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -14.348732908368454
DONE TAKING  40  STEPS.
Total reward:  -297.3522762054003
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.507728611424646
DONE TAKING  40  STEPS.
Total reward:  -552.2867000547877
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -14.482297283766139
DONE TAKING  40  STEPS.
Total reward:  -347.51189032240075
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -29.430797017790667
DONE TAKING  40  STEPS.
Total reward:  -786.7411567317223
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.101555277098036
DONE TAKING  40  STEPS.
Total reward:  -279.86415428694846
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.82532122952306
DONE TAKING  40  STEPS.
Total reward:  -969.276266451427
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -19.86785804661483
DONE TAKING  40  STEPS.
Total reward:  -390.6024118928687
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.45017330889797
DONE TAKING  40  STEPS.
Total reward:  -349.2203385290534
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.074462293129784
DONE TAKING  40  STEPS.
Total reward:  -668.8737566224578
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -15.315579648260545
DONE TAKING  40  STEPS.
Total reward:  -311.4261692513028
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.124537228493754
DONE TAKING  40  STEPS.
Total reward:  -467.59561676884647
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.993810051781377
DONE TAKING  40  STEPS.
Total reward:  -492.31685086682967
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.3126261322587
DONE TAKING  40  STEPS.
Total reward:  -723.9696873452154
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -26.48030298624418
DONE TAKING  40  STEPS.
Total reward:  -857.0106539181413
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -16.42580483589388
DONE TAKING  40  STEPS.
Total reward:  -420.4238209516468
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.750800647666757
DONE TAKING  40  STEPS.
Total reward:  -827.5404475246253
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.55347662117851
DONE TAKING  40  STEPS.
Total reward:  -970.3294871695963
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.067365266803595
DONE TAKING  40  STEPS.
Total reward:  -866.63627649385
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.913501703658177
DONE TAKING  40  STEPS.
Total reward:  -896.7190755336206
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -27.117798135199198
DONE TAKING  40  STEPS.
Total reward:  -795.6786554806271
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.648404465607484
DONE TAKING  40  STEPS.
Total reward:  -279.4206129365414
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.621295481968925
DONE TAKING  40  STEPS.
Total reward:  -788.3470730797898
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.992008565838635
DONE TAKING  40  STEPS.
Total reward:  -692.2182420120963
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -28.10559660626291
DONE TAKING  40  STEPS.
Total reward:  -690.1902495642216
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.77652368461155
DONE TAKING  40  STEPS.
Total reward:  -610.6119170056253
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -29.483944700961455
DONE TAKING  40  STEPS.
Total reward:  -671.9993242188755
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -10.595405744457782
DONE TAKING  40  STEPS.
Total reward:  -319.99913717577107
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.386510674605123
DONE TAKING  40  STEPS.
Total reward:  -444.3127782053124
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.174113096754315
DONE TAKING  40  STEPS.
Total reward:  -542.5495305583763
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -15.327059471437128
DONE TAKING  40  STEPS.
Total reward:  -374.46354493213795
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -29.49004300704082
DONE TAKING  40  STEPS.
Total reward:  -850.5073416106787
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.209138700210907
DONE TAKING  40  STEPS.
Total reward:  -698.2627057595851
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.502203757225384
DONE TAKING  40  STEPS.
Total reward:  -792.8438852797552
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 43
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  43
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4870428981488211
    val rand:  0
    val onPol:  0.38303879896799725

=== Epoch 10 ===
    train loss:  0.22565934637136625
    val rand:  0
    val onPol:  0.31352060039838153

=== Epoch 20 ===
    train loss:  0.1978400127406706
    val rand:  0
    val onPol:  0.3081399028499921

=== Epoch 30 ===
    train loss:  0.17738686972542814
    val rand:  0
    val onPol:  0.3080594018101692

=== Epoch 39 ===
    train loss:  0.16306506045031965
    val rand:  0
    val onPol:  0.3109547446171443
Training duration: 14.38 s

#####################################
performing on-policy MPC rollouts... iter  43
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.69336884376213
DONE TAKING  40  STEPS.
Total reward:  -491.0207171742319
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.200267542605935
DONE TAKING  40  STEPS.
Total reward:  -846.5762063908222
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.99749917821569
DONE TAKING  40  STEPS.
Total reward:  -586.529912560742
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.22253684337199
DONE TAKING  40  STEPS.
Total reward:  -566.6470619581934
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.010706976690287
DONE TAKING  40  STEPS.
Total reward:  -862.7455399039166
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.243188091732982
DONE TAKING  40  STEPS.
Total reward:  -401.68848836218075
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.65313653097602
DONE TAKING  40  STEPS.
Total reward:  -686.0914012586745
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.858840859944458
DONE TAKING  40  STEPS.
Total reward:  -906.1857207531152
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.23649048371957
DONE TAKING  40  STEPS.
Total reward:  -710.3105556176015
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.141477015515775
DONE TAKING  40  STEPS.
Total reward:  -281.89500870148123
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.123451425101536
DONE TAKING  40  STEPS.
Total reward:  -726.7650368319573
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -15.402699166035617
DONE TAKING  40  STEPS.
Total reward:  -171.52946090193132
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.64019049861412
DONE TAKING  40  STEPS.
Total reward:  -563.0049357288402
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.998238994197916
DONE TAKING  40  STEPS.
Total reward:  -688.7226141521422
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -19.009388629288537
DONE TAKING  40  STEPS.
Total reward:  -418.66291235954003
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -11.36963062669986
DONE TAKING  40  STEPS.
Total reward:  -253.87699196567996
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.984563735376106
DONE TAKING  40  STEPS.
Total reward:  -774.4567755584766
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -20.5248345741553
DONE TAKING  40  STEPS.
Total reward:  -430.68986312190117
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.49891513221999
DONE TAKING  40  STEPS.
Total reward:  -458.149697872728
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -23.277402003500463
DONE TAKING  40  STEPS.
Total reward:  -316.65463292939637
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.803909328515452
DONE TAKING  40  STEPS.
Total reward:  -655.5458601852581
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.106566853989616
DONE TAKING  40  STEPS.
Total reward:  -536.6195042213683
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -24.343160958803903
DONE TAKING  40  STEPS.
Total reward:  -486.8852970816749
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.768489302519555
DONE TAKING  40  STEPS.
Total reward:  -557.4775927700432
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.482366053226713
DONE TAKING  40  STEPS.
Total reward:  -293.8214905611292
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.88815335392255
DONE TAKING  40  STEPS.
Total reward:  -736.4470003468117
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -17.6109899597755
DONE TAKING  40  STEPS.
Total reward:  -549.8912161109391
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -16.289524626384924
DONE TAKING  40  STEPS.
Total reward:  -443.90088246425034
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.415171430639283
DONE TAKING  40  STEPS.
Total reward:  -791.5372240844993
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.48263408514064
DONE TAKING  40  STEPS.
Total reward:  -752.2612188961583
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -11.953370392419151
DONE TAKING  40  STEPS.
Total reward:  -324.0609838250456
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.51215196905985
DONE TAKING  40  STEPS.
Total reward:  -563.5563616888822
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -11.072987633394142
DONE TAKING  40  STEPS.
Total reward:  -341.81966363295953
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -27.34843017551833
DONE TAKING  40  STEPS.
Total reward:  -988.9453444540441
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.94256712856175
DONE TAKING  40  STEPS.
Total reward:  -865.6853913715543
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -12.23521698562315
DONE TAKING  40  STEPS.
Total reward:  -410.5821310461314
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.208803037044603
DONE TAKING  40  STEPS.
Total reward:  -301.2354357897252
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -15.35878354046545
DONE TAKING  40  STEPS.
Total reward:  -661.6753267918651
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.647907703691494
DONE TAKING  40  STEPS.
Total reward:  -1036.2006246789272
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.062277767514306
DONE TAKING  40  STEPS.
Total reward:  -220.51154135308576
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 44
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  44
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.46947158899223596
    val rand:  0
    val onPol:  0.38636550803979236

=== Epoch 10 ===
    train loss:  0.22229024977014775
    val rand:  0
    val onPol:  0.31770315517981845

=== Epoch 20 ===
    train loss:  0.1940076317180667
    val rand:  0
    val onPol:  0.3132788712779681

=== Epoch 30 ===
    train loss:  0.17639657149189397
    val rand:  0
    val onPol:  0.3145180369416873

=== Epoch 39 ===
    train loss:  0.160981474738372
    val rand:  0
    val onPol:  0.3191191653410594
Training duration: 14.39 s

#####################################
performing on-policy MPC rollouts... iter  44
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -17.287881169414252
DONE TAKING  40  STEPS.
Total reward:  -545.9462152372619
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -16.026949648264498
DONE TAKING  40  STEPS.
Total reward:  -636.3592992386491
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.937231222780069
DONE TAKING  40  STEPS.
Total reward:  -416.3574191668839
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -31.08821450492163
DONE TAKING  40  STEPS.
Total reward:  -1037.3572721513056
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.701282121728568
DONE TAKING  40  STEPS.
Total reward:  -719.4733563102488
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.175267580668923
DONE TAKING  40  STEPS.
Total reward:  -352.8076630580157
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -21.409717599893206
DONE TAKING  40  STEPS.
Total reward:  -773.733590924299
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -8.765851094033877
DONE TAKING  40  STEPS.
Total reward:  -291.1537682571434
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.395784226587327
DONE TAKING  40  STEPS.
Total reward:  -672.6659469011701
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -22.315399124619013
DONE TAKING  40  STEPS.
Total reward:  -684.4327088362112
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -14.768687399625268
DONE TAKING  40  STEPS.
Total reward:  -484.9100224515165
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.47343304962399
DONE TAKING  40  STEPS.
Total reward:  -703.6663897349346
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.590087782718115
DONE TAKING  40  STEPS.
Total reward:  -718.943701461577
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.60491004097742
DONE TAKING  40  STEPS.
Total reward:  -778.6530862120776
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -29.927458592235272
DONE TAKING  40  STEPS.
Total reward:  -882.3132867657899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.236215632366594
DONE TAKING  40  STEPS.
Total reward:  -352.9313021185266
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.63397501604025
DONE TAKING  40  STEPS.
Total reward:  -248.64983152863948
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.617853416750705
DONE TAKING  40  STEPS.
Total reward:  -543.8731803323143
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.952726677638708
DONE TAKING  40  STEPS.
Total reward:  -352.46400666273854
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -14.753401758993743
DONE TAKING  40  STEPS.
Total reward:  -283.7947294436228
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -29.158232615743735
DONE TAKING  40  STEPS.
Total reward:  -1004.2897865135634
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.59348752197181
DONE TAKING  40  STEPS.
Total reward:  -726.0108146713242
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.246375215788746
DONE TAKING  40  STEPS.
Total reward:  -885.9124426856464
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.048531532660906
DONE TAKING  40  STEPS.
Total reward:  -432.78109508771144
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.49578468859982
DONE TAKING  40  STEPS.
Total reward:  -907.8940539293399
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -18.604800005890127
DONE TAKING  40  STEPS.
Total reward:  -691.6149409953881
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.626246934324154
DONE TAKING  40  STEPS.
Total reward:  -994.1742477384464
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -21.982123026180055
DONE TAKING  40  STEPS.
Total reward:  -749.3483471010663
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -24.40232754624541
DONE TAKING  40  STEPS.
Total reward:  -608.3951507843805
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -9.672846317071356
DONE TAKING  40  STEPS.
Total reward:  -386.0541273509769
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.49428176302572
DONE TAKING  40  STEPS.
Total reward:  -571.1364786399184
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.322989520488587
DONE TAKING  40  STEPS.
Total reward:  -463.22429548971365
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.50995222211022
DONE TAKING  40  STEPS.
Total reward:  -680.1046155264778
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.711005992667065
DONE TAKING  40  STEPS.
Total reward:  -764.740810124277
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.039474845186751
DONE TAKING  40  STEPS.
Total reward:  -99.45408996297192
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.201179130353175
DONE TAKING  40  STEPS.
Total reward:  -813.057540832051
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.216091416164154
DONE TAKING  40  STEPS.
Total reward:  -863.5508653851235
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -26.60587518462362
DONE TAKING  40  STEPS.
Total reward:  -781.521239731422
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -16.35245479885387
DONE TAKING  40  STEPS.
Total reward:  -264.6260260869995
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.89968575237684
DONE TAKING  40  STEPS.
Total reward:  -961.1599811769697
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 45
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  45
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4708730703906009
    val rand:  0
    val onPol:  0.3946399788061778

=== Epoch 10 ===
    train loss:  0.22168357539595218
    val rand:  0
    val onPol:  0.32736967007319134

=== Epoch 20 ===
    train loss:  0.19561586149951868
    val rand:  0
    val onPol:  0.3215229908625285

=== Epoch 30 ===
    train loss:  0.17453543763411672
    val rand:  0
    val onPol:  0.32465559244155884

=== Epoch 39 ===
    train loss:  0.16050631043158078
    val rand:  0
    val onPol:  0.3287801593542099
Training duration: 14.16 s

#####################################
performing on-policy MPC rollouts... iter  45
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.49729110178336
DONE TAKING  40  STEPS.
Total reward:  -596.0162077290402
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.16681722455307
DONE TAKING  40  STEPS.
Total reward:  -819.9315884780077
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.917907321165105
DONE TAKING  40  STEPS.
Total reward:  -518.3917194551257
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -14.141210425354341
DONE TAKING  40  STEPS.
Total reward:  -307.8738811278078
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -27.830390804951797
DONE TAKING  40  STEPS.
Total reward:  -413.39004309183724
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.17545673387788
DONE TAKING  40  STEPS.
Total reward:  -519.2307203889576
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -12.87763528823827
DONE TAKING  40  STEPS.
Total reward:  -365.1958241280221
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.28159236418844
DONE TAKING  40  STEPS.
Total reward:  -648.8669303089968
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -31.118417503684036
DONE TAKING  40  STEPS.
Total reward:  -759.020380707088
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.348583809539242
DONE TAKING  40  STEPS.
Total reward:  -359.98090276979474
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -15.457593815008387
DONE TAKING  40  STEPS.
Total reward:  -358.5497467067389
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.925761800938897
DONE TAKING  40  STEPS.
Total reward:  -860.5471598417955
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -16.09872221240767
DONE TAKING  40  STEPS.
Total reward:  -608.4922363382952
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.395107312348728
DONE TAKING  40  STEPS.
Total reward:  -647.0183278851619
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.291435365431475
DONE TAKING  40  STEPS.
Total reward:  -868.5244763902233
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -13.04936908112232
DONE TAKING  40  STEPS.
Total reward:  -393.7582001659158
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -11.837552755839777
DONE TAKING  40  STEPS.
Total reward:  -219.41476521628434
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.55247651499561
DONE TAKING  40  STEPS.
Total reward:  -810.511116713768
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.914395954445858
DONE TAKING  40  STEPS.
Total reward:  -477.1795753507692
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.87094204681182
DONE TAKING  40  STEPS.
Total reward:  -517.3040511060736
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -23.665005168769063
DONE TAKING  40  STEPS.
Total reward:  -749.3619692469204
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -19.250612902947168
DONE TAKING  40  STEPS.
Total reward:  -396.92062305669714
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.403939727043387
DONE TAKING  40  STEPS.
Total reward:  -880.865441207806
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.503627271113324
DONE TAKING  40  STEPS.
Total reward:  -798.910002861511
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -16.22520547623839
DONE TAKING  40  STEPS.
Total reward:  -426.6402167909702
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.90447787435067
DONE TAKING  40  STEPS.
Total reward:  -359.6030152228641
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.05859785246316
DONE TAKING  40  STEPS.
Total reward:  -767.0129359819707
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.953965152632513
DONE TAKING  40  STEPS.
Total reward:  -574.1902009911827
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.348395311627712
DONE TAKING  40  STEPS.
Total reward:  -539.4364707139051
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.80995764604891
DONE TAKING  40  STEPS.
Total reward:  -887.3103641809031
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.036804243845804
DONE TAKING  40  STEPS.
Total reward:  -585.1008989113251
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.883406470235375
DONE TAKING  40  STEPS.
Total reward:  -640.4416975132132
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.67027811735847
DONE TAKING  40  STEPS.
Total reward:  -673.6857120542688
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.299702411245075
DONE TAKING  40  STEPS.
Total reward:  -442.5282234011314
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.383725744770295
DONE TAKING  40  STEPS.
Total reward:  -357.08450912850867
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.374744455513216
DONE TAKING  40  STEPS.
Total reward:  -655.0410211003505
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.448904455886264
DONE TAKING  40  STEPS.
Total reward:  -533.5889733541443
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -27.445881551794717
DONE TAKING  40  STEPS.
Total reward:  -933.0278751429317
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -28.29689407258457
DONE TAKING  40  STEPS.
Total reward:  -601.1297188348772
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.203027612998206
DONE TAKING  40  STEPS.
Total reward:  -526.9663552591712
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 46
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  46
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4773280395750414
    val rand:  0
    val onPol:  0.3897377947966258

=== Epoch 10 ===
    train loss:  0.2252145548138702
    val rand:  0
    val onPol:  0.32488660017649335

=== Epoch 20 ===
    train loss:  0.19550366856549917
    val rand:  0
    val onPol:  0.32132741808891296

=== Epoch 30 ===
    train loss:  0.1740473778101436
    val rand:  0
    val onPol:  0.32015126943588257

=== Epoch 39 ===
    train loss:  0.1582515752106382
    val rand:  0
    val onPol:  0.3215331385533015
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  46
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -16.44562007122026
DONE TAKING  40  STEPS.
Total reward:  -255.97798548265266
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.733872707937238
DONE TAKING  40  STEPS.
Total reward:  -699.3480121611794
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -31.295515073790448
DONE TAKING  40  STEPS.
Total reward:  -689.4565034536774
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -20.995968013705806
DONE TAKING  40  STEPS.
Total reward:  -444.94310463093296
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.15731466731154
DONE TAKING  40  STEPS.
Total reward:  -625.1577031722524
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.15633130045848
DONE TAKING  40  STEPS.
Total reward:  -388.7586566502509
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.291801321595806
DONE TAKING  40  STEPS.
Total reward:  -781.0156202089469
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.50321373572161
DONE TAKING  40  STEPS.
Total reward:  -577.9871454152528
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.511479508865612
DONE TAKING  40  STEPS.
Total reward:  -402.4956833200261
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.72822185176645
DONE TAKING  40  STEPS.
Total reward:  -582.048538280836
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -22.021722579692202
DONE TAKING  40  STEPS.
Total reward:  -573.9727615767736
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.916816901606047
DONE TAKING  40  STEPS.
Total reward:  -646.3867450166049
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -16.341349920091346
DONE TAKING  40  STEPS.
Total reward:  -314.4051950011985
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.444138290828736
DONE TAKING  40  STEPS.
Total reward:  -449.0237719247052
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.180125129520917
DONE TAKING  40  STEPS.
Total reward:  -687.3962602532996
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.36231327088573
DONE TAKING  40  STEPS.
Total reward:  -531.0676005705824
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -16.15996378925033
DONE TAKING  40  STEPS.
Total reward:  -264.3008968106894
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.996891554318836
DONE TAKING  40  STEPS.
Total reward:  -532.0246241250123
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -26.871264056593063
DONE TAKING  40  STEPS.
Total reward:  -943.9866884070834
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.71308558814367
DONE TAKING  40  STEPS.
Total reward:  -680.9842543089113
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -26.115095871609356
DONE TAKING  40  STEPS.
Total reward:  -634.5263558033284
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.414953848316728
DONE TAKING  40  STEPS.
Total reward:  -546.2639390970083
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.615104925461303
DONE TAKING  40  STEPS.
Total reward:  -537.2129483006491
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.10272880547351
DONE TAKING  40  STEPS.
Total reward:  -948.0441213385348
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -18.951902799521722
DONE TAKING  40  STEPS.
Total reward:  -961.434750971795
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.17559359631648
DONE TAKING  40  STEPS.
Total reward:  -306.78436538672264
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -9.949938366917328
DONE TAKING  40  STEPS.
Total reward:  -263.0213088082462
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.900392739390558
DONE TAKING  40  STEPS.
Total reward:  -1114.3146887908324
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -13.25038765488626
DONE TAKING  40  STEPS.
Total reward:  -235.6897363054521
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.604527530493694
DONE TAKING  40  STEPS.
Total reward:  -983.7929641001431
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.600557358930057
DONE TAKING  40  STEPS.
Total reward:  -456.0644161768589
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -17.673796188923085
DONE TAKING  40  STEPS.
Total reward:  -226.07164085759558
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.25572328087409
DONE TAKING  40  STEPS.
Total reward:  -84.46762145495062
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.41994233178536
DONE TAKING  40  STEPS.
Total reward:  -500.2644909808808
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.20773514520249
DONE TAKING  40  STEPS.
Total reward:  -601.8749277050915
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.54769447128569
DONE TAKING  40  STEPS.
Total reward:  -770.5966811896764
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.348671185924502
DONE TAKING  40  STEPS.
Total reward:  -451.43966402916567
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.50288559218649
DONE TAKING  40  STEPS.
Total reward:  -539.9856147446213
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -31.333935641328253
DONE TAKING  40  STEPS.
Total reward:  -784.8691910786479
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.33374399481009
DONE TAKING  40  STEPS.
Total reward:  -837.5386130373803
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 47
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  47
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.46820756113320067
    val rand:  0
    val onPol:  0.38794204592704773

=== Epoch 10 ===
    train loss:  0.21895908368261238
    val rand:  0
    val onPol:  0.32326823969682056

=== Epoch 20 ===
    train loss:  0.19294288728320808
    val rand:  0
    val onPol:  0.317753829061985

=== Epoch 30 ===
    train loss:  0.17244489151134826
    val rand:  0
    val onPol:  0.3214905758698781

=== Epoch 39 ===
    train loss:  0.15899713075997537
    val rand:  0
    val onPol:  0.32309794922669727
Training duration: 14.42 s

#####################################
performing on-policy MPC rollouts... iter  47
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.655604372937045
DONE TAKING  40  STEPS.
Total reward:  -712.834882260995
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.036657739757448
DONE TAKING  40  STEPS.
Total reward:  -552.4544946308689
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -19.208924766616292
DONE TAKING  40  STEPS.
Total reward:  -298.8639839646524
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.630367732706464
DONE TAKING  40  STEPS.
Total reward:  -621.159136345856
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -14.844510290754478
DONE TAKING  40  STEPS.
Total reward:  -394.6966783324172
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.117783355163567
DONE TAKING  40  STEPS.
Total reward:  -690.2041276445315
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.579048630301237
DONE TAKING  40  STEPS.
Total reward:  -326.46243032663796
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.601377324058667
DONE TAKING  40  STEPS.
Total reward:  -475.94074204822505
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.121064672346154
DONE TAKING  40  STEPS.
Total reward:  -463.73264989239937
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.84605557060196
DONE TAKING  40  STEPS.
Total reward:  -300.23088231090173
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.294656123699546
DONE TAKING  40  STEPS.
Total reward:  -425.5230720832427
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.055746473450654
DONE TAKING  40  STEPS.
Total reward:  -861.0871081733433
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.448054018111602
DONE TAKING  40  STEPS.
Total reward:  -474.2343817946263
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.614708412544935
DONE TAKING  40  STEPS.
Total reward:  -1132.7838576881265
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.070945424003497
DONE TAKING  40  STEPS.
Total reward:  -889.567221448961
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.517790502931575
DONE TAKING  40  STEPS.
Total reward:  -754.5906794417305
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.084962101776355
DONE TAKING  40  STEPS.
Total reward:  -572.113386878698
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.649664872739393
DONE TAKING  40  STEPS.
Total reward:  -542.1333964332364
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.546554966198023
DONE TAKING  40  STEPS.
Total reward:  -313.9692475829771
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.952552145872975
DONE TAKING  40  STEPS.
Total reward:  -730.3947417162653
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.441155005541106
DONE TAKING  40  STEPS.
Total reward:  -599.0330330097728
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.354893258324577
DONE TAKING  40  STEPS.
Total reward:  -841.8877316881049
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.216742747329413
DONE TAKING  40  STEPS.
Total reward:  -666.5427111647871
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.080781376163465
DONE TAKING  40  STEPS.
Total reward:  -963.0424089142521
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.62179133830608
DONE TAKING  40  STEPS.
Total reward:  -692.8377180013475
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.074008715571424
DONE TAKING  40  STEPS.
Total reward:  -441.5975023431083
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.702347788421328
DONE TAKING  40  STEPS.
Total reward:  -403.30589042054606
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.58381312043607
DONE TAKING  40  STEPS.
Total reward:  -823.8491600464723
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.653616805272264
DONE TAKING  40  STEPS.
Total reward:  -609.8786896652998
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.30328325622806
DONE TAKING  40  STEPS.
Total reward:  -388.835759047672
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -11.982794313008426
DONE TAKING  40  STEPS.
Total reward:  -299.1750359622592
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -18.123088721931886
DONE TAKING  40  STEPS.
Total reward:  -481.93002675647335
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.510826527774594
DONE TAKING  40  STEPS.
Total reward:  -251.64112745239004
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -10.852263800968501
DONE TAKING  40  STEPS.
Total reward:  -240.47801949032404
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.323567458697188
DONE TAKING  40  STEPS.
Total reward:  -680.6187803796801
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.879246436327193
DONE TAKING  40  STEPS.
Total reward:  -406.6981813590909
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.899391504782194
DONE TAKING  40  STEPS.
Total reward:  -288.5211226558108
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.70407593460759
DONE TAKING  40  STEPS.
Total reward:  -779.6911064973568
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -23.984959526261967
DONE TAKING  40  STEPS.
Total reward:  -394.0638555029372
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.651022644707105
DONE TAKING  40  STEPS.
Total reward:  -480.5149351389504
Time for 1 rollout: 0.97 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 48
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  48
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47762791472568844
    val rand:  0
    val onPol:  0.38362596929073334

=== Epoch 10 ===
    train loss:  0.22287264204861826
    val rand:  0
    val onPol:  0.3145829637845357

=== Epoch 20 ===
    train loss:  0.19509507062142356
    val rand:  0
    val onPol:  0.3090967337290446

=== Epoch 30 ===
    train loss:  0.1755289675896628
    val rand:  0
    val onPol:  0.311023011803627

=== Epoch 39 ===
    train loss:  0.15838034189583963
    val rand:  0
    val onPol:  0.31219764053821564
Training duration: 14.23 s

#####################################
performing on-policy MPC rollouts... iter  48
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -24.516114148634735
DONE TAKING  40  STEPS.
Total reward:  -926.8405996193592
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -15.890010607993519
DONE TAKING  40  STEPS.
Total reward:  -427.7419545441116
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.82597197054641
DONE TAKING  40  STEPS.
Total reward:  -427.139838022575
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.0819081184341
DONE TAKING  40  STEPS.
Total reward:  -462.9193732491242
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.048987209235683
DONE TAKING  40  STEPS.
Total reward:  -356.19604960499504
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.05807656130704
DONE TAKING  40  STEPS.
Total reward:  -739.586180017066
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.36156431247861
DONE TAKING  40  STEPS.
Total reward:  -927.5205728970453
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.138073535279457
DONE TAKING  40  STEPS.
Total reward:  -420.57955665314137
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -27.20825012010042
DONE TAKING  40  STEPS.
Total reward:  -924.7685901743694
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.201935236092808
DONE TAKING  40  STEPS.
Total reward:  -613.0926245700487
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.97625755231794
DONE TAKING  40  STEPS.
Total reward:  -926.4359067884541
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.368478999252062
DONE TAKING  40  STEPS.
Total reward:  -762.3978517572023
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.03026537751435
DONE TAKING  40  STEPS.
Total reward:  -629.2531595611846
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.0720720010481
DONE TAKING  40  STEPS.
Total reward:  -345.7830092037014
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.537228112565128
DONE TAKING  40  STEPS.
Total reward:  -782.1369321609113
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -20.598283129364603
DONE TAKING  40  STEPS.
Total reward:  -206.27210252550327
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.74580135267209
DONE TAKING  40  STEPS.
Total reward:  -351.81546619702766
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.823944183219904
DONE TAKING  40  STEPS.
Total reward:  -509.08484343692265
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -14.510882725713623
DONE TAKING  40  STEPS.
Total reward:  -314.3341289366671
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -11.735390373137397
DONE TAKING  40  STEPS.
Total reward:  -263.9274369009191
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.414705299655328
DONE TAKING  40  STEPS.
Total reward:  -493.6268154407178
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.020334751999137
DONE TAKING  40  STEPS.
Total reward:  -515.0748771946111
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.30448759026301
DONE TAKING  40  STEPS.
Total reward:  -754.1613313876736
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -20.66204278417103
DONE TAKING  40  STEPS.
Total reward:  -703.6850651877271
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.298996453663957
DONE TAKING  40  STEPS.
Total reward:  -327.2028550757167
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.275778189379167
DONE TAKING  40  STEPS.
Total reward:  -1070.2778784697823
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.430908030605284
DONE TAKING  40  STEPS.
Total reward:  -413.33320614584954
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.395605919628782
DONE TAKING  40  STEPS.
Total reward:  -713.4193126346953
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.6496005423653
DONE TAKING  40  STEPS.
Total reward:  -705.7196477572845
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.513262673301625
DONE TAKING  40  STEPS.
Total reward:  -511.018472940234
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.53689693611601
DONE TAKING  40  STEPS.
Total reward:  -744.3508999700017
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.3254783967345
DONE TAKING  40  STEPS.
Total reward:  -918.6057331345756
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.400097728905457
DONE TAKING  40  STEPS.
Total reward:  -556.9295642865628
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.825348498826315
DONE TAKING  40  STEPS.
Total reward:  -700.4332624786987
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.214394410686705
DONE TAKING  40  STEPS.
Total reward:  -623.8460371460764
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.880748015112072
DONE TAKING  40  STEPS.
Total reward:  -707.0523024688667
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.9276340767414
DONE TAKING  40  STEPS.
Total reward:  -483.29905470253294
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.44019024989223
DONE TAKING  40  STEPS.
Total reward:  -609.0549672324983
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.31241907399793
DONE TAKING  40  STEPS.
Total reward:  -585.0240230590096
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.635282639393836
DONE TAKING  40  STEPS.
Total reward:  -434.6665997218944
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 49
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  49
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.46928701170703824
    val rand:  0
    val onPol:  0.38306938608487445

=== Epoch 10 ===
    train loss:  0.21772685176447817
    val rand:  0
    val onPol:  0.3146026556690534

=== Epoch 20 ===
    train loss:  0.19150548467510625
    val rand:  0
    val onPol:  0.30821982274452847

=== Epoch 30 ===
    train loss:  0.1699131322011613
    val rand:  0
    val onPol:  0.30889267722765607

=== Epoch 39 ===
    train loss:  0.15745643147251062
    val rand:  0
    val onPol:  0.3128018652399381
Training duration: 14.14 s

#####################################
performing on-policy MPC rollouts... iter  49
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.299012540438078
DONE TAKING  40  STEPS.
Total reward:  -258.594913390294
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -15.13051320720207
DONE TAKING  40  STEPS.
Total reward:  -270.59740304112995
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -19.666255063446158
DONE TAKING  40  STEPS.
Total reward:  -359.28000149974116
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.01435847422951
DONE TAKING  40  STEPS.
Total reward:  -958.8197743745192
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -31.38735326172407
DONE TAKING  40  STEPS.
Total reward:  -583.4661863530462
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.602824939198122
DONE TAKING  40  STEPS.
Total reward:  -763.2715321559937
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.726963529782886
DONE TAKING  40  STEPS.
Total reward:  -470.9807440166982
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.26311828601846
DONE TAKING  40  STEPS.
Total reward:  -524.8365267119367
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.109511044728333
DONE TAKING  40  STEPS.
Total reward:  -504.63733907343544
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -13.688663283584921
DONE TAKING  40  STEPS.
Total reward:  -330.7513752114569
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -17.80530932059788
DONE TAKING  40  STEPS.
Total reward:  -275.5663000161279
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.296362261494497
DONE TAKING  40  STEPS.
Total reward:  -644.9293034431994
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.097368093708333
DONE TAKING  40  STEPS.
Total reward:  -438.51252963951566
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.115177070906853
DONE TAKING  40  STEPS.
Total reward:  -452.21063712577404
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.207885325574736
DONE TAKING  40  STEPS.
Total reward:  -451.35443112297077
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.489296300970512
DONE TAKING  40  STEPS.
Total reward:  -537.2091120326095
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.515641021102976
DONE TAKING  40  STEPS.
Total reward:  -588.0111482692676
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.34506434759847
DONE TAKING  40  STEPS.
Total reward:  -840.3743648866672
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -27.008660152167153
DONE TAKING  40  STEPS.
Total reward:  -761.6080890009185
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -14.744451661749752
DONE TAKING  40  STEPS.
Total reward:  -415.1968080859891
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -17.288241493277894
DONE TAKING  40  STEPS.
Total reward:  -263.03016187829445
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.440692695499145
DONE TAKING  40  STEPS.
Total reward:  -917.7680024216899
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -13.264791823132516
DONE TAKING  40  STEPS.
Total reward:  -241.73832850880746
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.106082896817075
DONE TAKING  40  STEPS.
Total reward:  -518.8799428392264
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.034548478141044
DONE TAKING  40  STEPS.
Total reward:  -316.0079036279874
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.691400239688278
DONE TAKING  40  STEPS.
Total reward:  -885.6941413393243
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.495112676075806
DONE TAKING  40  STEPS.
Total reward:  -662.9491268196406
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -16.903930590230573
DONE TAKING  40  STEPS.
Total reward:  -307.4077640367277
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.119153909088148
DONE TAKING  40  STEPS.
Total reward:  -829.4077786740817
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.093497336254387
DONE TAKING  40  STEPS.
Total reward:  -845.9949055102612
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.78699378690003
DONE TAKING  40  STEPS.
Total reward:  -881.7927898315095
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.92909773480059
DONE TAKING  40  STEPS.
Total reward:  -898.8556369987452
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.06807948881253
DONE TAKING  40  STEPS.
Total reward:  -687.3066716732343
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.182208817741664
DONE TAKING  40  STEPS.
Total reward:  -946.8896975551172
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.421230181267426
DONE TAKING  40  STEPS.
Total reward:  -651.5503629633963
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.66546940023452
DONE TAKING  40  STEPS.
Total reward:  -100.4924598777917
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.84589449972613
DONE TAKING  40  STEPS.
Total reward:  -658.6158857477211
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.109574016348695
DONE TAKING  40  STEPS.
Total reward:  -614.0251990187259
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.360827766850946
DONE TAKING  40  STEPS.
Total reward:  -921.6633066146087
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.2880072073542
DONE TAKING  40  STEPS.
Total reward:  -726.3607299793069
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 50
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  50
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.45905209790196333
    val rand:  0
    val onPol:  0.3697808136542638

=== Epoch 10 ===
    train loss:  0.22033777676130595
    val rand:  0
    val onPol:  0.3069048424561818

=== Epoch 20 ===
    train loss:  0.19439610577466196
    val rand:  0
    val onPol:  0.3013665775458018

=== Epoch 30 ===
    train loss:  0.17030692754084603
    val rand:  0
    val onPol:  0.3030595580736796

=== Epoch 39 ===
    train loss:  0.15759296113984628
    val rand:  0
    val onPol:  0.30746421217918396
Training duration: 14.15 s

#####################################
performing on-policy MPC rollouts... iter  50
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.245194285059227
DONE TAKING  40  STEPS.
Total reward:  -570.0822577928942
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -21.837747357486705
DONE TAKING  40  STEPS.
Total reward:  -420.85065844079
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.232569584475513
DONE TAKING  40  STEPS.
Total reward:  -562.9053895880573
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -30.805927571110555
DONE TAKING  40  STEPS.
Total reward:  -977.9832249225254
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.27497872488714
DONE TAKING  40  STEPS.
Total reward:  -768.276991368155
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.374905794520306
DONE TAKING  40  STEPS.
Total reward:  -805.616549330598
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.088762059180695
DONE TAKING  40  STEPS.
Total reward:  -721.6230341265724
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.376955718907624
DONE TAKING  40  STEPS.
Total reward:  -844.9262821296152
Time for 1 rollout: 1.54 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.769608571405577
DONE TAKING  40  STEPS.
Total reward:  -808.1043812275968
Time for 1 rollout: 1.38 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.154932049313526
DONE TAKING  40  STEPS.
Total reward:  96.50947338516673
Time for 1 rollout: 1.41 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -19.19804598914284
DONE TAKING  40  STEPS.
Total reward:  -529.2282503976579
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -26.42927138728046
DONE TAKING  40  STEPS.
Total reward:  -870.2155772426128
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.865668617380695
DONE TAKING  40  STEPS.
Total reward:  -727.1218927249587
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.820148372107965
DONE TAKING  40  STEPS.
Total reward:  -588.988854205746
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -10.572285923082873
DONE TAKING  40  STEPS.
Total reward:  -254.09670549442876
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.33794928756705
DONE TAKING  40  STEPS.
Total reward:  -738.4756438988959
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.24505167109324
DONE TAKING  40  STEPS.
Total reward:  -516.4452928797695
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.1309010420861
DONE TAKING  40  STEPS.
Total reward:  -606.526807635243
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.023003539558715
DONE TAKING  40  STEPS.
Total reward:  -786.1640923526901
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -17.824000260330767
DONE TAKING  40  STEPS.
Total reward:  -509.1477959529345
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.63819766719812
DONE TAKING  40  STEPS.
Total reward:  -589.1619240274154
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.471403439718824
DONE TAKING  40  STEPS.
Total reward:  -434.8777700009195
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -18.819856010530902
DONE TAKING  40  STEPS.
Total reward:  -491.760183659087
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.082387876314975
DONE TAKING  40  STEPS.
Total reward:  -445.254983198707
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.558203263327282
DONE TAKING  40  STEPS.
Total reward:  -683.5069179173651
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.179046964719188
DONE TAKING  40  STEPS.
Total reward:  -725.2702577138825
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.881012439993828
DONE TAKING  40  STEPS.
Total reward:  -465.5906194082243
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -10.649961011150781
DONE TAKING  40  STEPS.
Total reward:  -275.6720399120558
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.52889161913653
DONE TAKING  40  STEPS.
Total reward:  266.09969833464976
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -31.29929890539708
DONE TAKING  40  STEPS.
Total reward:  -620.5772225771061
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.768226291855306
DONE TAKING  40  STEPS.
Total reward:  -1054.0383218607756
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.784127141514748
DONE TAKING  40  STEPS.
Total reward:  -701.6412268297214
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -28.283729740637334
DONE TAKING  40  STEPS.
Total reward:  -574.1726672954672
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.903404174352968
DONE TAKING  40  STEPS.
Total reward:  -940.646072265998
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.955586059364585
DONE TAKING  40  STEPS.
Total reward:  -635.5645680276816
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.642917518006875
DONE TAKING  40  STEPS.
Total reward:  -628.552731954975
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.196376868316012
DONE TAKING  40  STEPS.
Total reward:  -797.4341952853171
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.51486540576571
DONE TAKING  40  STEPS.
Total reward:  -483.8428877408349
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.11647454946
DONE TAKING  40  STEPS.
Total reward:  -539.7450565080541
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.80490692075194
DONE TAKING  40  STEPS.
Total reward:  -686.3122766059545
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 51
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  51
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47244495467135783
    val rand:  0
    val onPol:  0.36689228812853497

=== Epoch 10 ===
    train loss:  0.21608540206624752
    val rand:  0
    val onPol:  0.2977817431092262

=== Epoch 20 ===
    train loss:  0.19001040856043497
    val rand:  0
    val onPol:  0.29299390067656833

=== Epoch 30 ===
    train loss:  0.1714984892230285
    val rand:  0
    val onPol:  0.29279820372660953

=== Epoch 39 ===
    train loss:  0.15746248709528068
    val rand:  0
    val onPol:  0.29463011771440506
Training duration: 14.15 s

#####################################
performing on-policy MPC rollouts... iter  51
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -30.426952553894246
DONE TAKING  40  STEPS.
Total reward:  -837.4476848576221
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -22.0848056275172
DONE TAKING  40  STEPS.
Total reward:  -602.8686818174193
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.64616896372937
DONE TAKING  40  STEPS.
Total reward:  -917.2364222666915
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -21.878806092923938
DONE TAKING  40  STEPS.
Total reward:  -477.3570666961381
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.00048599824241
DONE TAKING  40  STEPS.
Total reward:  -445.0804681562998
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.769380697844703
DONE TAKING  40  STEPS.
Total reward:  -386.7832186961678
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -26.810697479320265
DONE TAKING  40  STEPS.
Total reward:  -817.2003195857981
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.96209236825017
DONE TAKING  40  STEPS.
Total reward:  -509.5090833711685
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -29.9627274964684
DONE TAKING  40  STEPS.
Total reward:  -777.9509711521872
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.134629804361378
DONE TAKING  40  STEPS.
Total reward:  -824.5963506872295
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.427100588095943
DONE TAKING  40  STEPS.
Total reward:  -438.33757595949504
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -26.83017244285116
DONE TAKING  40  STEPS.
Total reward:  -591.9844479131303
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.703058062938034
DONE TAKING  40  STEPS.
Total reward:  -824.6342535923501
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -31.11197735108329
DONE TAKING  40  STEPS.
Total reward:  -813.9514489934871
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.85050383483722
DONE TAKING  40  STEPS.
Total reward:  -911.8789691531254
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.32157411455854
DONE TAKING  40  STEPS.
Total reward:  -511.032630189223
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.74138192729317
DONE TAKING  40  STEPS.
Total reward:  -501.85660093170185
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -30.368422293645054
DONE TAKING  40  STEPS.
Total reward:  -668.1534900312807
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.215942591558452
DONE TAKING  40  STEPS.
Total reward:  -572.5741029842598
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.59631324826944
DONE TAKING  40  STEPS.
Total reward:  -854.2586823821586
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -22.06493858764344
DONE TAKING  40  STEPS.
Total reward:  -817.5340122507884
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.045464662223008
DONE TAKING  40  STEPS.
Total reward:  -309.119607340913
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.563124680859808
DONE TAKING  40  STEPS.
Total reward:  -339.67227168549965
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -15.590893624076134
DONE TAKING  40  STEPS.
Total reward:  -317.61745693384086
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -16.219713916439293
DONE TAKING  40  STEPS.
Total reward:  -290.14736161626945
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -31.21508249511617
DONE TAKING  40  STEPS.
Total reward:  -660.5015780781273
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.652961941187694
DONE TAKING  40  STEPS.
Total reward:  -1159.872923256361
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.620929603067943
DONE TAKING  40  STEPS.
Total reward:  -672.4188672020894
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.76215973291449
DONE TAKING  40  STEPS.
Total reward:  -347.40600164781796
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.71238735366925
DONE TAKING  40  STEPS.
Total reward:  -638.3474097266906
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -12.224224124724184
DONE TAKING  40  STEPS.
Total reward:  -249.33334159759568
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.2475548798729
DONE TAKING  40  STEPS.
Total reward:  -537.6011116249205
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.256498220996527
DONE TAKING  40  STEPS.
Total reward:  -951.8295184716176
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.064015482389888
DONE TAKING  40  STEPS.
Total reward:  -737.8981316215242
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -13.16342937462369
DONE TAKING  40  STEPS.
Total reward:  -491.5319157564456
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -20.530886044960578
DONE TAKING  40  STEPS.
Total reward:  -637.2903348452932
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.132457774345692
DONE TAKING  40  STEPS.
Total reward:  -563.1636840390448
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.1277920683811
DONE TAKING  40  STEPS.
Total reward:  -812.6710216651871
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.45305811293112
DONE TAKING  40  STEPS.
Total reward:  -716.305800289641
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.550320594148324
DONE TAKING  40  STEPS.
Total reward:  -539.4924705505478
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 52
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  52
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47331072573076216
    val rand:  0
    val onPol:  0.36390823125839233

=== Epoch 10 ===
    train loss:  0.2206468412227798
    val rand:  0
    val onPol:  0.2973869318763415

=== Epoch 20 ===
    train loss:  0.19004685967637783
    val rand:  0
    val onPol:  0.2908173104127248

=== Epoch 30 ===
    train loss:  0.1716859900114829
    val rand:  0
    val onPol:  0.29050913949807483

=== Epoch 39 ===
    train loss:  0.1567909722788292
    val rand:  0
    val onPol:  0.29395827651023865
Training duration: 14.16 s

#####################################
performing on-policy MPC rollouts... iter  52
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.573791061093175
DONE TAKING  40  STEPS.
Total reward:  -583.6409753452918
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.07604284552711
DONE TAKING  40  STEPS.
Total reward:  -857.4935006768554
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -13.959865369201822
DONE TAKING  40  STEPS.
Total reward:  -303.23471057391555
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.731718901842278
DONE TAKING  40  STEPS.
Total reward:  -1002.0323461803689
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.35186766169542
DONE TAKING  40  STEPS.
Total reward:  -838.3995648486938
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.503179462617457
DONE TAKING  40  STEPS.
Total reward:  -521.9886377880863
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.21512268015405
DONE TAKING  40  STEPS.
Total reward:  -311.14101011738103
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.93647868728784
DONE TAKING  40  STEPS.
Total reward:  -624.579413655814
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.52551289337516
DONE TAKING  40  STEPS.
Total reward:  -335.54892295619015
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.68385621321124
DONE TAKING  40  STEPS.
Total reward:  -431.6986589929638
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -14.64187222220156
DONE TAKING  40  STEPS.
Total reward:  -275.8410692481839
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.40798948428213
DONE TAKING  40  STEPS.
Total reward:  -553.1070351539655
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.374969651324246
DONE TAKING  40  STEPS.
Total reward:  -780.5500203792658
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.461367400528715
DONE TAKING  40  STEPS.
Total reward:  -758.1897590084026
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.241360430395563
DONE TAKING  40  STEPS.
Total reward:  -350.98468778852344
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.943534871508806
DONE TAKING  40  STEPS.
Total reward:  -710.2562601800794
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.736667172818812
DONE TAKING  40  STEPS.
Total reward:  -600.8330101267203
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.994458242598569
DONE TAKING  40  STEPS.
Total reward:  -392.3938845215771
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.409851304337824
DONE TAKING  40  STEPS.
Total reward:  -437.3703312191236
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -21.517836160315476
DONE TAKING  40  STEPS.
Total reward:  -444.84430248032527
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.517935481207537
DONE TAKING  40  STEPS.
Total reward:  -692.6692408407544
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -14.53140951122946
DONE TAKING  40  STEPS.
Total reward:  -267.55478102843927
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -21.31414816934437
DONE TAKING  40  STEPS.
Total reward:  -738.9552433109315
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -10.410232536894924
DONE TAKING  40  STEPS.
Total reward:  -358.60812938363364
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -17.86634515603368
DONE TAKING  40  STEPS.
Total reward:  -333.53668154510706
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.346988851129023
DONE TAKING  40  STEPS.
Total reward:  -997.537989733874
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.952504401657507
DONE TAKING  40  STEPS.
Total reward:  -541.7139561673893
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.134297578407423
DONE TAKING  40  STEPS.
Total reward:  -466.6175175105668
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -25.061105850132517
DONE TAKING  40  STEPS.
Total reward:  -385.9915753701824
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.23862300656529
DONE TAKING  40  STEPS.
Total reward:  -1050.3631452875518
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -27.16745440876116
DONE TAKING  40  STEPS.
Total reward:  -392.7755003427731
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -31.40940171166092
DONE TAKING  40  STEPS.
Total reward:  -1138.7833147018168
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.900286326019774
DONE TAKING  40  STEPS.
Total reward:  -709.7404371113358
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.93061485262263
DONE TAKING  40  STEPS.
Total reward:  -689.6038613562617
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.513299662032665
DONE TAKING  40  STEPS.
Total reward:  -879.5140807196343
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.792001936748573
DONE TAKING  40  STEPS.
Total reward:  -708.6975814294797
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.290372383955194
DONE TAKING  40  STEPS.
Total reward:  -493.868281454204
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.84285383291025
DONE TAKING  40  STEPS.
Total reward:  -299.4412012531304
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -31.21907149456319
DONE TAKING  40  STEPS.
Total reward:  -634.2935608877671
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.519460178419774
DONE TAKING  40  STEPS.
Total reward:  -268.5519501604771
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 53
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  53
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4672951823786685
    val rand:  0
    val onPol:  0.3636940022309621

=== Epoch 10 ===
    train loss:  0.21867485945684867
    val rand:  0
    val onPol:  0.29596184690793353

=== Epoch 20 ===
    train loss:  0.19054090610721655
    val rand:  0
    val onPol:  0.29079632461071014

=== Epoch 30 ===
    train loss:  0.17206406985458575
    val rand:  0
    val onPol:  0.29058003177245456

=== Epoch 39 ===
    train loss:  0.15728735139495448
    val rand:  0
    val onPol:  0.2923898746569951
Training duration: 14.17 s

#####################################
performing on-policy MPC rollouts... iter  53
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -18.276393341501148
DONE TAKING  40  STEPS.
Total reward:  -433.2861726234143
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.38294021800665
DONE TAKING  40  STEPS.
Total reward:  -540.2204869199986
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.489244763258533
DONE TAKING  40  STEPS.
Total reward:  -557.2044899690957
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -11.267445516926575
DONE TAKING  40  STEPS.
Total reward:  -262.37298748867676
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.268034870104913
DONE TAKING  40  STEPS.
Total reward:  -541.0045843622897
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.271318098236847
DONE TAKING  40  STEPS.
Total reward:  -691.7945210495687
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.401004356014823
DONE TAKING  40  STEPS.
Total reward:  -478.8959921750695
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.808204219790333
DONE TAKING  40  STEPS.
Total reward:  -602.2838155547921
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -24.859571332088564
DONE TAKING  40  STEPS.
Total reward:  -536.1985584513975
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.838933544833477
DONE TAKING  40  STEPS.
Total reward:  -765.1873955762601
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.40616924628257
DONE TAKING  40  STEPS.
Total reward:  -330.0855205155015
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.84229478009854
DONE TAKING  40  STEPS.
Total reward:  -1073.574056039805
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -27.605967959352324
DONE TAKING  40  STEPS.
Total reward:  -984.134310225134
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.24023014545723
DONE TAKING  40  STEPS.
Total reward:  -374.873013145265
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.10699453835873
DONE TAKING  40  STEPS.
Total reward:  -751.3136783844224
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.969204200438174
DONE TAKING  40  STEPS.
Total reward:  -727.8050503165043
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.54189109655307
DONE TAKING  40  STEPS.
Total reward:  -1125.12265712585
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -18.706821432599497
DONE TAKING  40  STEPS.
Total reward:  -618.9802814278786
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.43413469482864
DONE TAKING  40  STEPS.
Total reward:  -526.1040950699302
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -9.873507146962544
DONE TAKING  40  STEPS.
Total reward:  -501.7147689527584
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.315546879053304
DONE TAKING  40  STEPS.
Total reward:  -471.974101073802
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.664968842653373
DONE TAKING  40  STEPS.
Total reward:  -1071.0574172693273
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.93363110756019
DONE TAKING  40  STEPS.
Total reward:  -784.048631136963
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.960015676359955
DONE TAKING  40  STEPS.
Total reward:  -978.7435730930798
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -29.397999673161664
DONE TAKING  40  STEPS.
Total reward:  -662.5566891158562
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -11.959712234908388
DONE TAKING  40  STEPS.
Total reward:  -347.9501473647372
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.99857760274962
DONE TAKING  40  STEPS.
Total reward:  -548.5841741015181
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -25.41627617802529
DONE TAKING  40  STEPS.
Total reward:  -924.2946746747542
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -16.151035691594494
DONE TAKING  40  STEPS.
Total reward:  -338.5124070535944
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -23.232329712453392
DONE TAKING  40  STEPS.
Total reward:  -866.6816433670094
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.554922406445364
DONE TAKING  40  STEPS.
Total reward:  -868.8278558775597
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -25.40992262532346
DONE TAKING  40  STEPS.
Total reward:  -688.3025026752562
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.10986282495175
DONE TAKING  40  STEPS.
Total reward:  -530.4392760909589
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -31.114417206730195
DONE TAKING  40  STEPS.
Total reward:  -712.294285959432
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.76843593770703
DONE TAKING  40  STEPS.
Total reward:  -702.0325479476021
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.596478899502912
DONE TAKING  40  STEPS.
Total reward:  -769.9219682838609
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.08954098382718
DONE TAKING  40  STEPS.
Total reward:  -471.09640315048335
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -26.198422698168677
DONE TAKING  40  STEPS.
Total reward:  -553.7360441190102
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -22.141064029239264
DONE TAKING  40  STEPS.
Total reward:  -547.280297078565
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -17.945887960742553
DONE TAKING  40  STEPS.
Total reward:  -333.7011164922192
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 54
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  54
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4731037099110453
    val rand:  0
    val onPol:  0.3625624179840088

=== Epoch 10 ===
    train loss:  0.221054264327936
    val rand:  0
    val onPol:  0.29681798070669174

=== Epoch 20 ===
    train loss:  0.19382077246381527
    val rand:  0
    val onPol:  0.2912260368466377

=== Epoch 30 ===
    train loss:  0.17470244305175647
    val rand:  0
    val onPol:  0.29146742075681686

=== Epoch 39 ===
    train loss:  0.15691609706795007
    val rand:  0
    val onPol:  0.2938046356042226
Training duration: 14.56 s

#####################################
performing on-policy MPC rollouts... iter  54
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -18.863211210928544
DONE TAKING  40  STEPS.
Total reward:  -413.3817449754351
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -23.419850531739176
DONE TAKING  40  STEPS.
Total reward:  -541.4171701518261
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.418567345134516
DONE TAKING  40  STEPS.
Total reward:  -254.7604614056215
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.578359110089878
DONE TAKING  40  STEPS.
Total reward:  -433.78155595568603
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.668548096320528
DONE TAKING  40  STEPS.
Total reward:  -757.9342817022778
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -27.47379280303232
DONE TAKING  40  STEPS.
Total reward:  -869.7919639991358
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.168806805069153
DONE TAKING  40  STEPS.
Total reward:  -735.0043408178069
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -31.19443328020949
DONE TAKING  40  STEPS.
Total reward:  -793.1274859021933
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.076007840016576
DONE TAKING  40  STEPS.
Total reward:  -468.7548988348029
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -11.75413595948849
DONE TAKING  40  STEPS.
Total reward:  -267.42362504464745
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.79920749411118
DONE TAKING  40  STEPS.
Total reward:  -490.3966583572719
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -16.53761745797102
DONE TAKING  40  STEPS.
Total reward:  -274.7170159791069
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.426199433659285
DONE TAKING  40  STEPS.
Total reward:  -367.77887958424867
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.418199666877186
DONE TAKING  40  STEPS.
Total reward:  -797.5090654323019
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.078454930497486
DONE TAKING  40  STEPS.
Total reward:  -669.7599243448263
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.28459940222632
DONE TAKING  40  STEPS.
Total reward:  -496.8798918954492
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.277859382582506
DONE TAKING  40  STEPS.
Total reward:  -738.2771001190849
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.351832311078084
DONE TAKING  40  STEPS.
Total reward:  -842.5014483188274
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.94405998256637
DONE TAKING  40  STEPS.
Total reward:  -260.81873216197954
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -15.804486492951682
DONE TAKING  40  STEPS.
Total reward:  -452.4803330586672
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -12.83155118651152
DONE TAKING  40  STEPS.
Total reward:  -335.8419158450931
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.818596650209482
DONE TAKING  40  STEPS.
Total reward:  -1032.191977806135
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.481642823507944
DONE TAKING  40  STEPS.
Total reward:  -621.5944322574046
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.077766449855048
DONE TAKING  40  STEPS.
Total reward:  -905.2859985068776
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.09962877538848
DONE TAKING  40  STEPS.
Total reward:  -392.05488417071524
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.686061331055964
DONE TAKING  40  STEPS.
Total reward:  -549.6422380706863
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.891808903968993
DONE TAKING  40  STEPS.
Total reward:  -647.662763921422
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -20.13845516699927
DONE TAKING  40  STEPS.
Total reward:  -636.8175880351687
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.397973155082134
DONE TAKING  40  STEPS.
Total reward:  -691.7014604931659
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.68945621266608
DONE TAKING  40  STEPS.
Total reward:  -529.4804929487383
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.937117371420378
DONE TAKING  40  STEPS.
Total reward:  -758.1337174793972
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.18999279154924
DONE TAKING  40  STEPS.
Total reward:  -692.2101497514869
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.042389380817724
DONE TAKING  40  STEPS.
Total reward:  -572.5392996602411
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.65638897015665
DONE TAKING  40  STEPS.
Total reward:  -536.2337924071842
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.982498694393968
DONE TAKING  40  STEPS.
Total reward:  -827.7705892992652
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -31.015380338881005
DONE TAKING  40  STEPS.
Total reward:  -654.4881353384849
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -29.862547300924454
DONE TAKING  40  STEPS.
Total reward:  -749.8733868670676
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -19.260212483408537
DONE TAKING  40  STEPS.
Total reward:  -1001.2149911775329
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -19.341278524277683
DONE TAKING  40  STEPS.
Total reward:  -671.8424066949733
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -25.87840169921488
DONE TAKING  40  STEPS.
Total reward:  -965.3979823557991
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 55
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  55
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47472580064807024
    val rand:  0
    val onPol:  0.3640405833721161

=== Epoch 10 ===
    train loss:  0.22252686557016874
    val rand:  0
    val onPol:  0.2938092475136121

=== Epoch 20 ===
    train loss:  0.1915505277483087
    val rand:  0
    val onPol:  0.2875787541270256

=== Epoch 30 ===
    train loss:  0.17239965576874583
    val rand:  0
    val onPol:  0.2877529213825862

=== Epoch 39 ===
    train loss:  0.15819474270469264
    val rand:  0
    val onPol:  0.2922063892086347
Training duration: 14.27 s

#####################################
performing on-policy MPC rollouts... iter  55
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -17.413123716990636
DONE TAKING  40  STEPS.
Total reward:  -423.586767614693
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.765004430719305
DONE TAKING  40  STEPS.
Total reward:  -884.1187620697525
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.217479525822903
DONE TAKING  40  STEPS.
Total reward:  -617.7734855616607
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.95805896911427
DONE TAKING  40  STEPS.
Total reward:  -842.5217312145899
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -21.708956141803224
DONE TAKING  40  STEPS.
Total reward:  -674.1571241626796
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.601427460761535
DONE TAKING  40  STEPS.
Total reward:  -431.9497888796023
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.09833445477026
DONE TAKING  40  STEPS.
Total reward:  -841.3810953392612
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.966172363234442
DONE TAKING  40  STEPS.
Total reward:  -804.4693482263659
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -13.726651374923676
DONE TAKING  40  STEPS.
Total reward:  -541.5082498411128
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.325417632007596
DONE TAKING  40  STEPS.
Total reward:  -593.1369760768268
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.460347185816357
DONE TAKING  40  STEPS.
Total reward:  -304.89464296557315
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -15.749282664633157
DONE TAKING  40  STEPS.
Total reward:  -441.7120820689534
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.038274476390942
DONE TAKING  40  STEPS.
Total reward:  -956.2545276411763
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -19.046013839325745
DONE TAKING  40  STEPS.
Total reward:  -414.7235655051981
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -26.687459862746444
DONE TAKING  40  STEPS.
Total reward:  -561.4633182777939
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.978024851257583
DONE TAKING  40  STEPS.
Total reward:  -266.6703858159601
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.687385250309568
DONE TAKING  40  STEPS.
Total reward:  -474.7317084049299
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.492273560528837
DONE TAKING  40  STEPS.
Total reward:  -403.9816869110193
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -16.67262968412478
DONE TAKING  40  STEPS.
Total reward:  -399.97353781082694
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.802789227689672
DONE TAKING  40  STEPS.
Total reward:  -740.6043690042899
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.18813088327861
DONE TAKING  40  STEPS.
Total reward:  -394.1442788202616
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.671867346933183
DONE TAKING  40  STEPS.
Total reward:  -437.1952941481403
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.74537289688953
DONE TAKING  40  STEPS.
Total reward:  -295.26186159412765
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.187241726630223
DONE TAKING  40  STEPS.
Total reward:  -737.1363111358014
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -21.257711009552875
DONE TAKING  40  STEPS.
Total reward:  -445.35353870567826
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -31.294955443159623
DONE TAKING  40  STEPS.
Total reward:  -682.8394436694202
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.99614387423257
DONE TAKING  40  STEPS.
Total reward:  -411.0653786567448
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.954193219932286
DONE TAKING  40  STEPS.
Total reward:  -612.4569496349228
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.571371158434076
DONE TAKING  40  STEPS.
Total reward:  -458.16349036000565
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.81830623801082
DONE TAKING  40  STEPS.
Total reward:  -544.3394083110371
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -14.560198371873362
DONE TAKING  40  STEPS.
Total reward:  -543.6397432595788
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.31424912965391
DONE TAKING  40  STEPS.
Total reward:  -468.09650464538106
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.73472521115457
DONE TAKING  40  STEPS.
Total reward:  -406.14866625045113
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -13.544561230155248
DONE TAKING  40  STEPS.
Total reward:  -405.86673089331845
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -17.82255621090212
DONE TAKING  40  STEPS.
Total reward:  -620.6370801470588
Time for 1 rollout: 1.19 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.587602209454943
DONE TAKING  40  STEPS.
Total reward:  -370.23243205723065
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.179232986552066
DONE TAKING  40  STEPS.
Total reward:  -583.4786421226071
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -13.739007969418463
DONE TAKING  40  STEPS.
Total reward:  -310.258415262925
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.258699775319343
DONE TAKING  40  STEPS.
Total reward:  -290.27525880545824
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.498238774341072
DONE TAKING  40  STEPS.
Total reward:  -672.6034046110823
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 56
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  56
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4651450368396023
    val rand:  0
    val onPol:  0.36400369306405383

=== Epoch 10 ===
    train loss:  0.2207866475770348
    val rand:  0
    val onPol:  0.29846173028151196

=== Epoch 20 ===
    train loss:  0.1933169649881229
    val rand:  0
    val onPol:  0.2908242270350456

=== Epoch 30 ===
    train loss:  0.17408406603754611
    val rand:  0
    val onPol:  0.29145051042238873

=== Epoch 39 ===
    train loss:  0.15844163716885082
    val rand:  0
    val onPol:  0.2965308353304863
Training duration: 14.21 s

#####################################
performing on-policy MPC rollouts... iter  56
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -27.342974104559794
DONE TAKING  40  STEPS.
Total reward:  -891.247823959409
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.563314788387686
DONE TAKING  40  STEPS.
Total reward:  -616.8792815313451
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.803049967098758
DONE TAKING  40  STEPS.
Total reward:  -286.50086334859895
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -25.074024268661773
DONE TAKING  40  STEPS.
Total reward:  -449.3189996954441
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.013453570150357
DONE TAKING  40  STEPS.
Total reward:  -597.6853116699981
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.15190770330281
DONE TAKING  40  STEPS.
Total reward:  -315.0212349922145
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.986789729651047
DONE TAKING  40  STEPS.
Total reward:  -241.45061568858466
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.127187487885692
DONE TAKING  40  STEPS.
Total reward:  -859.4045980562108
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.910932322002104
DONE TAKING  40  STEPS.
Total reward:  -339.6017366077759
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -14.479995639345349
DONE TAKING  40  STEPS.
Total reward:  -256.11055372352075
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.740948379235366
DONE TAKING  40  STEPS.
Total reward:  -553.8689919166019
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.11643313815224
DONE TAKING  40  STEPS.
Total reward:  -503.644911318869
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -29.7584160094053
DONE TAKING  40  STEPS.
Total reward:  -787.241982185325
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -29.00623108244359
DONE TAKING  40  STEPS.
Total reward:  -671.7765675933775
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -28.634872118862837
DONE TAKING  40  STEPS.
Total reward:  -750.7369507606527
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.576047182730022
DONE TAKING  40  STEPS.
Total reward:  -451.4890270099962
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.339251169806914
DONE TAKING  40  STEPS.
Total reward:  -807.0970762375263
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.93017224985967
DONE TAKING  40  STEPS.
Total reward:  -866.1940307568493
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.396887088913775
DONE TAKING  40  STEPS.
Total reward:  -674.9208451386557
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -31.150347895020175
DONE TAKING  40  STEPS.
Total reward:  -783.5019221940663
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -27.673658465017475
DONE TAKING  40  STEPS.
Total reward:  -519.6109627313186
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.265345254016935
DONE TAKING  40  STEPS.
Total reward:  -567.7355806568328
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -29.62259192556293
DONE TAKING  40  STEPS.
Total reward:  -743.440189935091
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -16.773292859129825
DONE TAKING  40  STEPS.
Total reward:  23.63674266010074
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -26.9488805762612
DONE TAKING  40  STEPS.
Total reward:  -730.047270063862
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.420373239628496
DONE TAKING  40  STEPS.
Total reward:  -712.7436882046234
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.936660698502372
DONE TAKING  40  STEPS.
Total reward:  -705.8387497965501
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.25325956120727
DONE TAKING  40  STEPS.
Total reward:  -679.6093875708162
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.79541753376683
DONE TAKING  40  STEPS.
Total reward:  -945.8259428562138
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.983488307700696
DONE TAKING  40  STEPS.
Total reward:  -525.9873317259868
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -26.211407186858445
DONE TAKING  40  STEPS.
Total reward:  -616.7172225375255
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.53888989805208
DONE TAKING  40  STEPS.
Total reward:  -453.0034382886052
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.353569567009387
DONE TAKING  40  STEPS.
Total reward:  -461.50079092646286
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.404067457456808
DONE TAKING  40  STEPS.
Total reward:  -593.0383243327461
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -22.336164709343503
DONE TAKING  40  STEPS.
Total reward:  -351.5124941696449
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.977664738493612
DONE TAKING  40  STEPS.
Total reward:  -631.5091139070742
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.119968464907657
DONE TAKING  40  STEPS.
Total reward:  -729.7843057853484
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -16.286820923457984
DONE TAKING  40  STEPS.
Total reward:  -529.8995966243995
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.555561450829654
DONE TAKING  40  STEPS.
Total reward:  -580.3681176964737
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.561339888007577
DONE TAKING  40  STEPS.
Total reward:  -579.8161628089096
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 57
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  57
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4766433076900348
    val rand:  0
    val onPol:  0.3539133320252101

=== Epoch 10 ===
    train loss:  0.22301826168570602
    val rand:  0
    val onPol:  0.28730132182439166

=== Epoch 20 ===
    train loss:  0.1951389561096827
    val rand:  0
    val onPol:  0.28244300931692123

=== Epoch 30 ===
    train loss:  0.17172823062068537
    val rand:  0
    val onPol:  0.2832935154438019

=== Epoch 39 ===
    train loss:  0.15892278729823597
    val rand:  0
    val onPol:  0.28401588648557663
Training duration: 14.39 s

#####################################
performing on-policy MPC rollouts... iter  57
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.955647113982053
DONE TAKING  40  STEPS.
Total reward:  -928.7043213035556
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.02293609951594
DONE TAKING  40  STEPS.
Total reward:  -555.784499566632
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.838729614746725
DONE TAKING  40  STEPS.
Total reward:  -715.4834890824462
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.414019547623678
DONE TAKING  40  STEPS.
Total reward:  -327.2132081334671
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.626531646051532
DONE TAKING  40  STEPS.
Total reward:  -472.1578176966845
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.199805173191134
DONE TAKING  40  STEPS.
Total reward:  -180.93679211290385
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -13.255828809276533
DONE TAKING  40  STEPS.
Total reward:  -376.9940433045644
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -12.785216666852515
DONE TAKING  40  STEPS.
Total reward:  -361.32197659303506
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.27762033875673
DONE TAKING  40  STEPS.
Total reward:  -760.7811082208979
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -20.078795848757647
DONE TAKING  40  STEPS.
Total reward:  -550.3485076857072
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -17.58440746671766
DONE TAKING  40  STEPS.
Total reward:  -283.82014576424854
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -17.00544554604474
DONE TAKING  40  STEPS.
Total reward:  -525.7617162898771
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -9.660240850304566
DONE TAKING  40  STEPS.
Total reward:  -233.46082016718444
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.204045473865957
DONE TAKING  40  STEPS.
Total reward:  -633.1755413942764
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -22.319298089682313
DONE TAKING  40  STEPS.
Total reward:  -772.4403264601477
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -14.444034354833706
DONE TAKING  40  STEPS.
Total reward:  -202.18391342886233
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -13.693516101784017
DONE TAKING  40  STEPS.
Total reward:  -251.65081735823568
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -19.659642010061155
DONE TAKING  40  STEPS.
Total reward:  -627.978146695821
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.64075151371091
DONE TAKING  40  STEPS.
Total reward:  -1005.5409098042666
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.911891370626265
DONE TAKING  40  STEPS.
Total reward:  -196.73725587368097
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.886360129831985
DONE TAKING  40  STEPS.
Total reward:  -269.256087728057
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.256569990932277
DONE TAKING  40  STEPS.
Total reward:  -380.0856373317293
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.047638171301706
DONE TAKING  40  STEPS.
Total reward:  -523.7982697557399
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -31.246607481214372
DONE TAKING  40  STEPS.
Total reward:  -1024.9950315166902
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -12.069764748582719
DONE TAKING  40  STEPS.
Total reward:  64.67155205495888
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -10.93429714530243
DONE TAKING  40  STEPS.
Total reward:  -211.2050089211224
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.54997711268191
DONE TAKING  40  STEPS.
Total reward:  -860.1875494130226
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.308577467757083
DONE TAKING  40  STEPS.
Total reward:  -906.0608899146039
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.82757096328814
DONE TAKING  40  STEPS.
Total reward:  -893.2196403986899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.444019419381434
DONE TAKING  40  STEPS.
Total reward:  -508.93553357370416
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -12.147999672926652
DONE TAKING  40  STEPS.
Total reward:  -500.455291645839
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -18.015653892870915
DONE TAKING  40  STEPS.
Total reward:  -389.3133253346997
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -9.984685555337391
DONE TAKING  40  STEPS.
Total reward:  -287.229661053062
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.567090963528642
DONE TAKING  40  STEPS.
Total reward:  -833.3845826729843
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.44299331053588
DONE TAKING  40  STEPS.
Total reward:  -467.68022442958556
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.429080881002925
DONE TAKING  40  STEPS.
Total reward:  -708.8071976462174
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.440354467734666
DONE TAKING  40  STEPS.
Total reward:  -457.10518560412896
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.14320809413812
DONE TAKING  40  STEPS.
Total reward:  -644.3361734364802
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.538811202903142
DONE TAKING  40  STEPS.
Total reward:  -495.0410684599384
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.066331948059688
DONE TAKING  40  STEPS.
Total reward:  -787.4153428325087
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 58
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  58
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.479057370570668
    val rand:  0
    val onPol:  0.3409912685553233

=== Epoch 10 ===
    train loss:  0.22711119866162016
    val rand:  0
    val onPol:  0.27702297767003375

=== Epoch 20 ===
    train loss:  0.19548276406631135
    val rand:  0
    val onPol:  0.26971857498089474

=== Epoch 30 ===
    train loss:  0.1738231553320299
    val rand:  0
    val onPol:  0.2733341455459595

=== Epoch 39 ===
    train loss:  0.16015592034448656
    val rand:  0
    val onPol:  0.2764889895915985
Training duration: 14.25 s

#####################################
performing on-policy MPC rollouts... iter  58
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.911894047597073
DONE TAKING  40  STEPS.
Total reward:  -461.1374095763696
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.91590929393968
DONE TAKING  40  STEPS.
Total reward:  -926.9428681485865
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.423683558637272
DONE TAKING  40  STEPS.
Total reward:  -593.1941999982182
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.615730956930683
DONE TAKING  40  STEPS.
Total reward:  -469.6400896265459
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -11.95550384460784
DONE TAKING  40  STEPS.
Total reward:  -336.9180804976041
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.92898656494394
DONE TAKING  40  STEPS.
Total reward:  -580.6136091271778
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.313345371952675
DONE TAKING  40  STEPS.
Total reward:  -958.2775222227309
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.11143817443311
DONE TAKING  40  STEPS.
Total reward:  -442.40888710071636
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.472523283669418
DONE TAKING  40  STEPS.
Total reward:  -721.9287666577432
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.401752869515626
DONE TAKING  40  STEPS.
Total reward:  -308.75081819804404
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.760873712253446
DONE TAKING  40  STEPS.
Total reward:  -597.9927908119822
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.414795862640297
DONE TAKING  40  STEPS.
Total reward:  -916.9650134351372
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.383099730660945
DONE TAKING  40  STEPS.
Total reward:  -936.2675520048964
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.130662741319682
DONE TAKING  40  STEPS.
Total reward:  -597.5708960143454
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.75576736075264
DONE TAKING  40  STEPS.
Total reward:  -744.7614620627938
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.718914501406097
DONE TAKING  40  STEPS.
Total reward:  116.86149851357096
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.71209638416948
DONE TAKING  40  STEPS.
Total reward:  -845.5529053830036
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.808503529613127
DONE TAKING  40  STEPS.
Total reward:  -401.996310200153
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.435913625389034
DONE TAKING  40  STEPS.
Total reward:  -774.7981707906954
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.304369826131147
DONE TAKING  40  STEPS.
Total reward:  -777.612821345012
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.634569647787316
DONE TAKING  40  STEPS.
Total reward:  -923.5141106344732
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.77084997343625
DONE TAKING  40  STEPS.
Total reward:  -662.0680617904944
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -11.960025485905978
DONE TAKING  40  STEPS.
Total reward:  -295.9812097453352
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.84786414017702
DONE TAKING  40  STEPS.
Total reward:  -848.3437879615534
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.832104742861922
DONE TAKING  40  STEPS.
Total reward:  -664.6075387809175
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.655133825533913
DONE TAKING  40  STEPS.
Total reward:  -583.7278067274082
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.555558627145786
DONE TAKING  40  STEPS.
Total reward:  -590.2048626320023
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.609546359295727
DONE TAKING  40  STEPS.
Total reward:  -899.6665401697825
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.0577572703975
DONE TAKING  40  STEPS.
Total reward:  -951.2997153366412
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -24.24215995170121
DONE TAKING  40  STEPS.
Total reward:  -751.4682995527412
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.596783178762642
DONE TAKING  40  STEPS.
Total reward:  -663.3796181787076
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -21.190560596192203
DONE TAKING  40  STEPS.
Total reward:  -385.1824994406013
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.607693525057794
DONE TAKING  40  STEPS.
Total reward:  -622.1675837414491
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.015934295632782
DONE TAKING  40  STEPS.
Total reward:  -630.9444811897255
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.63236895476487
DONE TAKING  40  STEPS.
Total reward:  -791.2875553902419
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -23.213547693347493
DONE TAKING  40  STEPS.
Total reward:  -617.963228542859
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.654408755447257
DONE TAKING  40  STEPS.
Total reward:  -674.9147581564335
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.06730852728579
DONE TAKING  40  STEPS.
Total reward:  -565.4616904404811
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.865154350563653
DONE TAKING  40  STEPS.
Total reward:  -859.720655532937
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.423901649129093
DONE TAKING  40  STEPS.
Total reward:  -338.32299840688916
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 59
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  59
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47153821796701667
    val rand:  0
    val onPol:  0.3413753459850947

=== Epoch 10 ===
    train loss:  0.22383427829073185
    val rand:  0
    val onPol:  0.28313469886779785

=== Epoch 20 ===
    train loss:  0.19628442510178215
    val rand:  0
    val onPol:  0.27450744559367496

=== Epoch 30 ===
    train loss:  0.17445111144007297
    val rand:  0
    val onPol:  0.27696210394303006

=== Epoch 39 ===
    train loss:  0.160024563994324
    val rand:  0
    val onPol:  0.28075239559014636
Training duration: 14.19 s

#####################################
performing on-policy MPC rollouts... iter  59
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -23.396114338267534
DONE TAKING  40  STEPS.
Total reward:  -289.704642078006
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.48535182866761
DONE TAKING  40  STEPS.
Total reward:  -294.9969217167972
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.65698628549427
DONE TAKING  40  STEPS.
Total reward:  -310.30024702220334
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.619021267921454
DONE TAKING  40  STEPS.
Total reward:  -957.9365553208996
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.8855107611222
DONE TAKING  40  STEPS.
Total reward:  -845.3866092041741
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -21.471390373620064
DONE TAKING  40  STEPS.
Total reward:  -456.38419879306866
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.037807897786912
DONE TAKING  40  STEPS.
Total reward:  -732.4999775360366
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.447543237340494
DONE TAKING  40  STEPS.
Total reward:  -527.9191501559571
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.289328182181578
DONE TAKING  40  STEPS.
Total reward:  -369.3938614837608
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.696246890875152
DONE TAKING  40  STEPS.
Total reward:  -629.3325016598768
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -27.71119729449505
DONE TAKING  40  STEPS.
Total reward:  -973.4586617400711
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.19778854302614
DONE TAKING  40  STEPS.
Total reward:  -660.4151632825449
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.853771794092268
DONE TAKING  40  STEPS.
Total reward:  -417.25712474097435
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -18.933686339545424
DONE TAKING  40  STEPS.
Total reward:  -377.81337665015707
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -31.232616239677338
DONE TAKING  40  STEPS.
Total reward:  -940.4726374124766
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.217544511429228
DONE TAKING  40  STEPS.
Total reward:  -433.7658342504181
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.879476055451846
DONE TAKING  40  STEPS.
Total reward:  -541.9644434571695
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.949472722845766
DONE TAKING  40  STEPS.
Total reward:  -1199.5474877076206
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.28562046915237
DONE TAKING  40  STEPS.
Total reward:  -636.5852221226573
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.270275998172934
DONE TAKING  40  STEPS.
Total reward:  -653.6266242611605
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -14.404746159718309
DONE TAKING  40  STEPS.
Total reward:  -497.77919616667157
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -13.395289052509709
DONE TAKING  40  STEPS.
Total reward:  -326.1168622984949
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.161639366692285
DONE TAKING  40  STEPS.
Total reward:  -379.5318547753214
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.667799544794782
DONE TAKING  40  STEPS.
Total reward:  -866.2105690155179
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.118036565476366
DONE TAKING  40  STEPS.
Total reward:  -849.2594788765184
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.905443574680298
DONE TAKING  40  STEPS.
Total reward:  -409.4995227172338
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.678198439820903
DONE TAKING  40  STEPS.
Total reward:  -267.05186875897374
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.30728176842053
DONE TAKING  40  STEPS.
Total reward:  -822.051578910312
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -16.714688563296562
DONE TAKING  40  STEPS.
Total reward:  -527.9420173279937
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.048429795587083
DONE TAKING  40  STEPS.
Total reward:  46.337570663148725
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -19.98713363394441
DONE TAKING  40  STEPS.
Total reward:  -328.03743123740117
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -28.810322694936534
DONE TAKING  40  STEPS.
Total reward:  -719.6392888856044
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -20.788991510476826
DONE TAKING  40  STEPS.
Total reward:  -656.1759823054373
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -20.72710293544395
DONE TAKING  40  STEPS.
Total reward:  -553.4086374709066
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.470364832101772
DONE TAKING  40  STEPS.
Total reward:  -953.6244171984463
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.189474886288984
DONE TAKING  40  STEPS.
Total reward:  -560.4257316575417
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.679148293819853
DONE TAKING  40  STEPS.
Total reward:  -517.298001297162
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -31.251189589899123
DONE TAKING  40  STEPS.
Total reward:  -699.8888874803389
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.684998009345982
DONE TAKING  40  STEPS.
Total reward:  -525.1857815108332
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.086113057472677
DONE TAKING  40  STEPS.
Total reward:  -581.4342057672019
Time for 1 rollout: 0.97 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 60
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  60
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4851239977175729
    val rand:  0
    val onPol:  0.3425540377696355

=== Epoch 10 ===
    train loss:  0.22479343492733805
    val rand:  0
    val onPol:  0.28078867743412655

=== Epoch 20 ===
    train loss:  0.19687958793681964
    val rand:  0
    val onPol:  0.27575796097517014

=== Epoch 30 ===
    train loss:  0.17310515778106556
    val rand:  0
    val onPol:  0.27753589550654095

=== Epoch 39 ===
    train loss:  0.16094451907433963
    val rand:  0
    val onPol:  0.2823800668120384
Training duration: 14.33 s

#####################################
performing on-policy MPC rollouts... iter  60
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.4352139910147
DONE TAKING  40  STEPS.
Total reward:  -592.4866276282983
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.612877042860763
DONE TAKING  40  STEPS.
Total reward:  -362.10467886051725
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.364810571500996
DONE TAKING  40  STEPS.
Total reward:  -837.4118544139359
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.44466047407039
DONE TAKING  40  STEPS.
Total reward:  -682.7305829215638
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -26.864015179302125
DONE TAKING  40  STEPS.
Total reward:  -577.5376965775428
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.856267166255734
DONE TAKING  40  STEPS.
Total reward:  -412.012519538462
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.099824694432716
DONE TAKING  40  STEPS.
Total reward:  -761.3170852626405
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.42572234205714
DONE TAKING  40  STEPS.
Total reward:  -570.6031290408002
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.46016521503678
DONE TAKING  40  STEPS.
Total reward:  -519.1692068260783
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.091254098174257
DONE TAKING  40  STEPS.
Total reward:  -599.8809438844237
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.322643486741537
DONE TAKING  40  STEPS.
Total reward:  -57.712616484064554
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.997174219135943
DONE TAKING  40  STEPS.
Total reward:  -663.5687347243367
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -15.829025556089773
DONE TAKING  40  STEPS.
Total reward:  -333.4654197754579
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -27.459634171597575
DONE TAKING  40  STEPS.
Total reward:  -449.53608823844394
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -20.365903279444467
DONE TAKING  40  STEPS.
Total reward:  -405.883777720866
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.48682353080796
DONE TAKING  40  STEPS.
Total reward:  -704.7721786026752
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.312040749344753
DONE TAKING  40  STEPS.
Total reward:  -690.3152034774774
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -14.546143073493038
DONE TAKING  40  STEPS.
Total reward:  -350.74688988346855
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.143474478567335
DONE TAKING  40  STEPS.
Total reward:  -551.8576072669596
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.072225171774303
DONE TAKING  40  STEPS.
Total reward:  -506.1235219604325
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -16.028871419017992
DONE TAKING  40  STEPS.
Total reward:  -571.8520228521975
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.198369779167574
DONE TAKING  40  STEPS.
Total reward:  -1100.2669560158038
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -8.858211404789794
DONE TAKING  40  STEPS.
Total reward:  -206.60798077302906
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.25021246184946
DONE TAKING  40  STEPS.
Total reward:  -897.2357555990637
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.44563432487919
DONE TAKING  40  STEPS.
Total reward:  -981.9278827283014
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.387546541075935
DONE TAKING  40  STEPS.
Total reward:  -850.575634668366
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.110235040393736
DONE TAKING  40  STEPS.
Total reward:  -481.0815954689279
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.11975256366401
DONE TAKING  40  STEPS.
Total reward:  -443.33235036174074
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.25192934409617
DONE TAKING  40  STEPS.
Total reward:  -667.3434752241717
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.370923421807
DONE TAKING  40  STEPS.
Total reward:  -555.749411521154
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.164914626423812
DONE TAKING  40  STEPS.
Total reward:  -779.8105032228
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.31608342323456
DONE TAKING  40  STEPS.
Total reward:  -732.6205203989733
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.503684606561123
DONE TAKING  40  STEPS.
Total reward:  -392.64054409933834
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.8252261509059
DONE TAKING  40  STEPS.
Total reward:  -529.473342531653
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -12.320559545176925
DONE TAKING  40  STEPS.
Total reward:  -263.19072952959795
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.73677517524651
DONE TAKING  40  STEPS.
Total reward:  -650.0057395720527
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.48413863037978
DONE TAKING  40  STEPS.
Total reward:  -814.0858128058844
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.794849610808257
DONE TAKING  40  STEPS.
Total reward:  -869.47583357558
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -30.48009513547067
DONE TAKING  40  STEPS.
Total reward:  -737.0913538755236
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.709072995481694
DONE TAKING  40  STEPS.
Total reward:  -375.6205718693659
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 61
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  61
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4675308366616567
    val rand:  0
    val onPol:  0.3295872112115224

=== Epoch 10 ===
    train loss:  0.22426196671368784
    val rand:  0
    val onPol:  0.2693152775367101

=== Epoch 20 ===
    train loss:  0.19281091449553506
    val rand:  0
    val onPol:  0.26145654171705246

=== Epoch 30 ===
    train loss:  0.17414035791890664
    val rand:  0
    val onPol:  0.2631373554468155

=== Epoch 39 ===
    train loss:  0.15852001858384987
    val rand:  0
    val onPol:  0.2658714751402537
Training duration: 14.19 s

#####################################
performing on-policy MPC rollouts... iter  61
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.433860603299323
DONE TAKING  40  STEPS.
Total reward:  -614.5064291359625
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.00220395736626
DONE TAKING  40  STEPS.
Total reward:  -624.1351800192334
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -27.3499096215367
DONE TAKING  40  STEPS.
Total reward:  -844.5740634752158
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.557533814015358
DONE TAKING  40  STEPS.
Total reward:  -790.8506226024624
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.87324146135249
DONE TAKING  40  STEPS.
Total reward:  -730.0473034164976
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -18.91810634929851
DONE TAKING  40  STEPS.
Total reward:  -366.71118265692616
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -29.61794415785809
DONE TAKING  40  STEPS.
Total reward:  -714.4653104784277
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -21.484264495794445
DONE TAKING  40  STEPS.
Total reward:  -575.8571639592325
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.09605083121458
DONE TAKING  40  STEPS.
Total reward:  -824.1664380346446
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -29.96286983709824
DONE TAKING  40  STEPS.
Total reward:  -730.0685084455263
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -12.258414612136729
DONE TAKING  40  STEPS.
Total reward:  -340.05306924990987
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -19.379738677602553
DONE TAKING  40  STEPS.
Total reward:  -476.7815278832321
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.515793897681583
DONE TAKING  40  STEPS.
Total reward:  -901.4864313589453
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.15949004555147
DONE TAKING  40  STEPS.
Total reward:  -774.189100394861
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.468986214716598
DONE TAKING  40  STEPS.
Total reward:  -1027.4300087666081
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.000731642961128
DONE TAKING  40  STEPS.
Total reward:  -870.5821997045023
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.391587966545885
DONE TAKING  40  STEPS.
Total reward:  -718.0040639800255
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -22.140167672882953
DONE TAKING  40  STEPS.
Total reward:  -334.597582833347
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.947780616002404
DONE TAKING  40  STEPS.
Total reward:  -909.3629327749327
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.594288641959306
DONE TAKING  40  STEPS.
Total reward:  -817.3755945312789
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -24.798012343516014
DONE TAKING  40  STEPS.
Total reward:  -882.76449794743
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.028024376443675
DONE TAKING  40  STEPS.
Total reward:  -490.0783519049094
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.489708857958735
DONE TAKING  40  STEPS.
Total reward:  -779.6794595354262
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.490792348502755
DONE TAKING  40  STEPS.
Total reward:  -791.8551265205916
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.25830713889422
DONE TAKING  40  STEPS.
Total reward:  -1076.5267456661923
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.80286421958605
DONE TAKING  40  STEPS.
Total reward:  -632.9338550038774
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -31.36487990242081
DONE TAKING  40  STEPS.
Total reward:  -696.747432416073
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.123371438195303
DONE TAKING  40  STEPS.
Total reward:  -682.9468084900165
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.255144822338423
DONE TAKING  40  STEPS.
Total reward:  -446.529224554783
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.82919915183848
DONE TAKING  40  STEPS.
Total reward:  -817.3357144943029
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.590096853558407
DONE TAKING  40  STEPS.
Total reward:  -785.683745100383
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -16.276181001701534
DONE TAKING  40  STEPS.
Total reward:  -347.36325356915694
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -18.14853282834774
DONE TAKING  40  STEPS.
Total reward:  -549.1273776190171
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.2943292318693
DONE TAKING  40  STEPS.
Total reward:  -621.5419144387834
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -12.994721053978314
DONE TAKING  40  STEPS.
Total reward:  -494.43476794020484
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.92368229421038
DONE TAKING  40  STEPS.
Total reward:  -834.9201617492004
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -31.316891215557902
DONE TAKING  40  STEPS.
Total reward:  -896.4200729816561
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.401459739475264
DONE TAKING  40  STEPS.
Total reward:  -790.8947969918836
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.608707904316756
DONE TAKING  40  STEPS.
Total reward:  -749.2294326774172
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.19145223300703
DONE TAKING  40  STEPS.
Total reward:  -606.0922591638422
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 62
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  62
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4822405006801873
    val rand:  0
    val onPol:  0.31530778110027313

=== Epoch 10 ===
    train loss:  0.22197250106878447
    val rand:  0
    val onPol:  0.25312010447184247

=== Epoch 20 ===
    train loss:  0.19535764633563527
    val rand:  0
    val onPol:  0.24905379364887872

=== Epoch 30 ===
    train loss:  0.17485785353602024
    val rand:  0
    val onPol:  0.2468514839808146

=== Epoch 39 ===
    train loss:  0.16074571013450623
    val rand:  0
    val onPol:  0.2533777157465617
Training duration: 14.36 s

#####################################
performing on-policy MPC rollouts... iter  62
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.52738918956751
DONE TAKING  40  STEPS.
Total reward:  -431.15445037629166
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.697950226295763
DONE TAKING  40  STEPS.
Total reward:  -745.2671744445519
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.0544453393427
DONE TAKING  40  STEPS.
Total reward:  -985.8503538754966
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.54986494067316
DONE TAKING  40  STEPS.
Total reward:  -635.7325862385702
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.656651473055106
DONE TAKING  40  STEPS.
Total reward:  -516.0948415377887
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.35221308379318
DONE TAKING  40  STEPS.
Total reward:  -1062.2467448955051
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.953700536505806
DONE TAKING  40  STEPS.
Total reward:  -617.1313593823326
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.029946067399516
DONE TAKING  40  STEPS.
Total reward:  -407.68479462498544
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -21.642823950178283
DONE TAKING  40  STEPS.
Total reward:  -427.19298607422166
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -13.306204814906382
DONE TAKING  40  STEPS.
Total reward:  -287.99376051031004
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.755107169929442
DONE TAKING  40  STEPS.
Total reward:  -530.4042860821223
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.802884136008654
DONE TAKING  40  STEPS.
Total reward:  -532.367476978135
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.234855055284065
DONE TAKING  40  STEPS.
Total reward:  -442.07092421896664
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -10.46224890130748
DONE TAKING  40  STEPS.
Total reward:  -297.30964404873635
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.863358401728668
DONE TAKING  40  STEPS.
Total reward:  -714.9201521231377
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.242772549397895
DONE TAKING  40  STEPS.
Total reward:  -439.6849875804255
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.502909872617142
DONE TAKING  40  STEPS.
Total reward:  -504.641122212918
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.36125643762207
DONE TAKING  40  STEPS.
Total reward:  -706.8109622251067
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.88158745270291
DONE TAKING  40  STEPS.
Total reward:  -677.0495440865524
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.204579352362956
DONE TAKING  40  STEPS.
Total reward:  -625.9856653084411
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -16.435809779273725
DONE TAKING  40  STEPS.
Total reward:  -519.6182372748452
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.685973424840498
DONE TAKING  40  STEPS.
Total reward:  -630.594176382745
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -18.286311629496048
DONE TAKING  40  STEPS.
Total reward:  -295.1887150171325
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -24.25959226197291
DONE TAKING  40  STEPS.
Total reward:  -423.4850794202039
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.54496296585335
DONE TAKING  40  STEPS.
Total reward:  -662.4404296349736
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.506410412014603
DONE TAKING  40  STEPS.
Total reward:  -822.3922099156123
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.350706344751917
DONE TAKING  40  STEPS.
Total reward:  -777.4548252183027
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.502234137445924
DONE TAKING  40  STEPS.
Total reward:  -1050.89858575512
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.871209078694108
DONE TAKING  40  STEPS.
Total reward:  -862.5208560034896
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.28776866196585
DONE TAKING  40  STEPS.
Total reward:  -615.4121614688623
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -13.391781758993522
DONE TAKING  40  STEPS.
Total reward:  -353.71694058563946
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.837870460804982
DONE TAKING  40  STEPS.
Total reward:  -451.8693465949211
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.205410826945656
DONE TAKING  40  STEPS.
Total reward:  -682.621220421488
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.32209875992526
DONE TAKING  40  STEPS.
Total reward:  -436.6251953783847
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.271416023601034
DONE TAKING  40  STEPS.
Total reward:  -539.3987156767404
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.870141122461483
DONE TAKING  40  STEPS.
Total reward:  -609.4505019844822
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.74074317536879
DONE TAKING  40  STEPS.
Total reward:  -621.4165073836418
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -22.208615246364513
DONE TAKING  40  STEPS.
Total reward:  -589.8602819963592
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -17.199971807511638
DONE TAKING  40  STEPS.
Total reward:  -574.7931953329598
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.24499797462624
DONE TAKING  40  STEPS.
Total reward:  -874.684079515428
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 63
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  63
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4767529729165529
    val rand:  0
    val onPol:  0.3225945830345154

=== Epoch 10 ===
    train loss:  0.22250403411555708
    val rand:  0
    val onPol:  0.25990346322457

=== Epoch 20 ===
    train loss:  0.1952328059756965
    val rand:  0
    val onPol:  0.25447216381629306

=== Epoch 30 ===
    train loss:  0.17412786577877246
    val rand:  0
    val onPol:  0.2565763220191002

=== Epoch 39 ===
    train loss:  0.15938828807128103
    val rand:  0
    val onPol:  0.2575380702813466
Training duration: 14.39 s

#####################################
performing on-policy MPC rollouts... iter  63
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.462782311733793
DONE TAKING  40  STEPS.
Total reward:  -970.0970319495285
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.253858921514933
DONE TAKING  40  STEPS.
Total reward:  -669.0250309212308
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.669882022834166
DONE TAKING  40  STEPS.
Total reward:  -976.2054860591194
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.59819114926749
DONE TAKING  40  STEPS.
Total reward:  -610.6777090485066
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.105382523053244
DONE TAKING  40  STEPS.
Total reward:  -360.71439263420825
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.762051407070558
DONE TAKING  40  STEPS.
Total reward:  -480.56930145579753
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.019094542795596
DONE TAKING  40  STEPS.
Total reward:  -589.39641433813
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.756815656997663
DONE TAKING  40  STEPS.
Total reward:  -244.0801984635135
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.79747570040344
DONE TAKING  40  STEPS.
Total reward:  -789.8185208264767
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -11.579642959448122
DONE TAKING  40  STEPS.
Total reward:  -309.8498026746447
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.02430238511349
DONE TAKING  40  STEPS.
Total reward:  -572.3593010457123
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.25156371423823
DONE TAKING  40  STEPS.
Total reward:  -385.46147971217914
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.54999251980492
DONE TAKING  40  STEPS.
Total reward:  -543.1522472521208
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.05891345221813
DONE TAKING  40  STEPS.
Total reward:  -796.7316412019493
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.957723943615402
DONE TAKING  40  STEPS.
Total reward:  -576.8626358598723
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -26.684171732444163
DONE TAKING  40  STEPS.
Total reward:  -494.0440733555116
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -22.71548187006634
DONE TAKING  40  STEPS.
Total reward:  -562.536892015932
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.105723883775
DONE TAKING  40  STEPS.
Total reward:  -1065.4383168047873
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.99427453159515
DONE TAKING  40  STEPS.
Total reward:  -646.5841774361734
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.171658483963935
DONE TAKING  40  STEPS.
Total reward:  -764.6699733699567
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -14.799754681860687
DONE TAKING  40  STEPS.
Total reward:  -557.5118207670082
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.362261262176496
DONE TAKING  40  STEPS.
Total reward:  -571.894359659309
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.310573387858298
DONE TAKING  40  STEPS.
Total reward:  -573.9545195924954
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.030271502629148
DONE TAKING  40  STEPS.
Total reward:  -585.2307570516194
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.029625967192022
DONE TAKING  40  STEPS.
Total reward:  -694.9303051767633
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.281721076450584
DONE TAKING  40  STEPS.
Total reward:  -716.4635252136857
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.371388479757883
DONE TAKING  40  STEPS.
Total reward:  -611.3106034098612
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.117616451966644
DONE TAKING  40  STEPS.
Total reward:  -444.095915600765
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.741260197181965
DONE TAKING  40  STEPS.
Total reward:  -322.469510659066
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.942858799783572
DONE TAKING  40  STEPS.
Total reward:  -945.4093176488215
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -20.5667920522965
DONE TAKING  40  STEPS.
Total reward:  -454.96939666636126
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.471437072909197
DONE TAKING  40  STEPS.
Total reward:  -757.7862250542522
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.61088423772248
DONE TAKING  40  STEPS.
Total reward:  -365.3385573679681
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -17.72825227668328
DONE TAKING  40  STEPS.
Total reward:  -700.7690204256695
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.486213564264034
DONE TAKING  40  STEPS.
Total reward:  -596.2640522774974
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.47039567632304
DONE TAKING  40  STEPS.
Total reward:  -745.588736562206
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.154039564521085
DONE TAKING  40  STEPS.
Total reward:  -360.8834998015891
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.389863847965543
DONE TAKING  40  STEPS.
Total reward:  -469.42610376022617
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.93330773113716
DONE TAKING  40  STEPS.
Total reward:  -513.6178050184109
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.992472809010957
DONE TAKING  40  STEPS.
Total reward:  -171.82184611852512
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 64
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  64
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.46470379045135096
    val rand:  0
    val onPol:  0.3021824260552724

=== Epoch 10 ===
    train loss:  0.22246622071977248
    val rand:  0
    val onPol:  0.24228413899739584

=== Epoch 20 ===
    train loss:  0.1924607458344677
    val rand:  0
    val onPol:  0.2389815424879392

=== Epoch 30 ===
    train loss:  0.17333825612277315
    val rand:  0
    val onPol:  0.2361984501282374

=== Epoch 39 ===
    train loss:  0.15707292263967948
    val rand:  0
    val onPol:  0.23906767865022024
Training duration: 14.35 s

#####################################
performing on-policy MPC rollouts... iter  64
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.788821933972986
DONE TAKING  40  STEPS.
Total reward:  -785.5666704989247
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -9.915785719997977
DONE TAKING  40  STEPS.
Total reward:  -300.4106895168253
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.10020874438264
DONE TAKING  40  STEPS.
Total reward:  -580.5323631508508
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.533117978038668
DONE TAKING  40  STEPS.
Total reward:  -476.28872765804687
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.703766230910123
DONE TAKING  40  STEPS.
Total reward:  -887.2163070327756
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.203033478813538
DONE TAKING  40  STEPS.
Total reward:  -673.3646260980778
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -16.28716370033211
DONE TAKING  40  STEPS.
Total reward:  -110.33231722247194
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.895766092738096
DONE TAKING  40  STEPS.
Total reward:  -1040.5187000932697
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -14.624618149166611
DONE TAKING  40  STEPS.
Total reward:  -356.76357187898816
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -23.97853694900832
DONE TAKING  40  STEPS.
Total reward:  -393.51387022334626
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -14.313266105006907
DONE TAKING  40  STEPS.
Total reward:  -306.9758020836801
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -26.25450282097556
DONE TAKING  40  STEPS.
Total reward:  -579.0172376123604
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -10.3928593453875
DONE TAKING  40  STEPS.
Total reward:  -305.07570635021904
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -31.09022090835644
DONE TAKING  40  STEPS.
Total reward:  -504.0417690432689
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.404638434219677
DONE TAKING  40  STEPS.
Total reward:  -339.72888987817777
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.17257085861101
DONE TAKING  40  STEPS.
Total reward:  -392.80643340208974
Time for 1 rollout: 0.89 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.561088146256516
DONE TAKING  40  STEPS.
Total reward:  -797.0880057239162
Time for 1 rollout: 0.88 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.287846863967086
DONE TAKING  40  STEPS.
Total reward:  -728.2628549145793
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -22.270756418075575
DONE TAKING  40  STEPS.
Total reward:  -757.9281579625003
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.372683137448607
DONE TAKING  40  STEPS.
Total reward:  -427.35257332993126
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.173989222015308
DONE TAKING  40  STEPS.
Total reward:  197.2910179995976
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.867108177528163
DONE TAKING  40  STEPS.
Total reward:  -570.3609157245938
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.006286919458788
DONE TAKING  40  STEPS.
Total reward:  -488.87020268816246
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.53424000878829
DONE TAKING  40  STEPS.
Total reward:  -846.6969753885219
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.737351719590986
DONE TAKING  40  STEPS.
Total reward:  -637.7286424273724
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.195149285537187
DONE TAKING  40  STEPS.
Total reward:  -657.0298206431929
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -25.943277883870564
DONE TAKING  40  STEPS.
Total reward:  -709.8866602477028
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.095631472405678
DONE TAKING  40  STEPS.
Total reward:  -645.1212209928802
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.10945844796419
DONE TAKING  40  STEPS.
Total reward:  -333.4625805129844
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -16.56871850961712
DONE TAKING  40  STEPS.
Total reward:  -326.67338264859313
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.80095844516341
DONE TAKING  40  STEPS.
Total reward:  -852.4046924625236
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.382899570341912
DONE TAKING  40  STEPS.
Total reward:  -684.5813782762552
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.46488036436901
DONE TAKING  40  STEPS.
Total reward:  339.0933531499391
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.128363821035542
DONE TAKING  40  STEPS.
Total reward:  -418.94028101285335
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -21.75221894695386
DONE TAKING  40  STEPS.
Total reward:  -76.05852527545738
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.800990948212764
DONE TAKING  40  STEPS.
Total reward:  -593.5920482720365
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -24.018463553327685
DONE TAKING  40  STEPS.
Total reward:  -459.7669437029718
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.407567083925784
DONE TAKING  40  STEPS.
Total reward:  -651.7849992324468
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -14.15675883796708
DONE TAKING  40  STEPS.
Total reward:  -204.41475037088415
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.993717544730814
DONE TAKING  40  STEPS.
Total reward:  -436.7741287444753
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 65
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  65
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4765491516966569
    val rand:  0
    val onPol:  0.30610935389995575

=== Epoch 10 ===
    train loss:  0.22460874496844777
    val rand:  0
    val onPol:  0.242243692278862

=== Epoch 20 ===
    train loss:  0.19715897477509683
    val rand:  0
    val onPol:  0.2377998208006223

=== Epoch 30 ===
    train loss:  0.17602184806999407
    val rand:  0
    val onPol:  0.23893088599046072

=== Epoch 39 ===
    train loss:  0.16116820328068315
    val rand:  0
    val onPol:  0.24031135936578116
Training duration: 14.09 s

#####################################
performing on-policy MPC rollouts... iter  65
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.465655183727478
DONE TAKING  40  STEPS.
Total reward:  -588.8793718067554
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -11.781934591022278
DONE TAKING  40  STEPS.
Total reward:  -308.4476029899427
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.425181336604513
DONE TAKING  40  STEPS.
Total reward:  -548.0286827700253
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.961957674378898
DONE TAKING  40  STEPS.
Total reward:  -435.7528008762995
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -16.782173179482076
DONE TAKING  40  STEPS.
Total reward:  -466.3828554863525
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.878491449455858
DONE TAKING  40  STEPS.
Total reward:  -577.6636275144606
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.968088552096802
DONE TAKING  40  STEPS.
Total reward:  -240.94571222646462
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.03838924364559
DONE TAKING  40  STEPS.
Total reward:  -761.8651160720688
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -23.51274054539257
DONE TAKING  40  STEPS.
Total reward:  -343.8484214830815
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.821232391124447
DONE TAKING  40  STEPS.
Total reward:  -458.82920700694586
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.354001119659173
DONE TAKING  40  STEPS.
Total reward:  -1041.4687093139084
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.791825641424353
DONE TAKING  40  STEPS.
Total reward:  -269.0540832025842
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.49981875342763
DONE TAKING  40  STEPS.
Total reward:  -620.1917899050815
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.278372896557727
DONE TAKING  40  STEPS.
Total reward:  -372.5315185122785
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.49741303522456
DONE TAKING  40  STEPS.
Total reward:  -470.3716485360255
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.81009812588228
DONE TAKING  40  STEPS.
Total reward:  -698.8143649331568
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -11.564052615624309
DONE TAKING  40  STEPS.
Total reward:  -140.74983965947297
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -21.70617187234881
DONE TAKING  40  STEPS.
Total reward:  -707.5461325729246
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -17.239271326181203
DONE TAKING  40  STEPS.
Total reward:  -447.5955682998134
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.506406363066462
DONE TAKING  40  STEPS.
Total reward:  -547.1681095876893
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.2804292538286
DONE TAKING  40  STEPS.
Total reward:  -986.8402444029871
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -24.064631288476814
DONE TAKING  40  STEPS.
Total reward:  -567.2391828053616
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.945643865965774
DONE TAKING  40  STEPS.
Total reward:  -447.71609583351454
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.366671592402753
DONE TAKING  40  STEPS.
Total reward:  -784.215460195255
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.990165882740545
DONE TAKING  40  STEPS.
Total reward:  -771.548329508091
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -24.30557523750089
DONE TAKING  40  STEPS.
Total reward:  -548.1988963909146
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.928190317473724
DONE TAKING  40  STEPS.
Total reward:  -361.81473791654406
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.337721512052568
DONE TAKING  40  STEPS.
Total reward:  -860.6454036609126
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -17.902476463546076
DONE TAKING  40  STEPS.
Total reward:  -593.858871284175
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -17.88498682740898
DONE TAKING  40  STEPS.
Total reward:  -459.81688937842813
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.553494193834517
DONE TAKING  40  STEPS.
Total reward:  -783.7416519736099
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.56086968581287
DONE TAKING  40  STEPS.
Total reward:  -755.4540962367021
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -11.70474689570833
DONE TAKING  40  STEPS.
Total reward:  -275.18299910401373
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -14.519730108885105
DONE TAKING  40  STEPS.
Total reward:  -380.1998955160872
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -22.719583898289603
DONE TAKING  40  STEPS.
Total reward:  -804.3626092164452
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -16.136612815594297
DONE TAKING  40  STEPS.
Total reward:  -145.58876341117357
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -29.898179348263017
DONE TAKING  40  STEPS.
Total reward:  -753.2485273500056
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.018705021157565
DONE TAKING  40  STEPS.
Total reward:  -871.2093213261484
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.237331755484497
DONE TAKING  40  STEPS.
Total reward:  -444.72547735723
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.159267190437987
DONE TAKING  40  STEPS.
Total reward:  -422.16877357164236
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 66
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  66
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48363917700031345
    val rand:  0
    val onPol:  0.32176486154397327

=== Epoch 10 ===
    train loss:  0.23142415938670174
    val rand:  0
    val onPol:  0.25779686868190765

=== Epoch 20 ===
    train loss:  0.1986821960461767
    val rand:  0
    val onPol:  0.2540149117509524

=== Epoch 30 ===
    train loss:  0.1783058551842706
    val rand:  0
    val onPol:  0.2529015342394511

=== Epoch 39 ===
    train loss:  0.16558216433776052
    val rand:  0
    val onPol:  0.2548175926009814
Training duration: 14.13 s

#####################################
performing on-policy MPC rollouts... iter  66
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.51671485238701
DONE TAKING  40  STEPS.
Total reward:  -489.1729139895182
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.708526474487048
DONE TAKING  40  STEPS.
Total reward:  -928.2991759800665
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.062904191348508
DONE TAKING  40  STEPS.
Total reward:  -516.0812418839789
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -12.253597491539676
DONE TAKING  40  STEPS.
Total reward:  -420.88449323168595
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.24186626398093
DONE TAKING  40  STEPS.
Total reward:  -626.6131873171032
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.486150409897434
DONE TAKING  40  STEPS.
Total reward:  -279.8891718863536
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.78029425931502
DONE TAKING  40  STEPS.
Total reward:  -482.92714221832216
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.78156071949231
DONE TAKING  40  STEPS.
Total reward:  -634.8548895570435
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.952862742523074
DONE TAKING  40  STEPS.
Total reward:  -474.27357106502893
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.477489146117932
DONE TAKING  40  STEPS.
Total reward:  -725.165796639766
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.866935936713062
DONE TAKING  40  STEPS.
Total reward:  -582.7150366905788
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -21.177102984615402
DONE TAKING  40  STEPS.
Total reward:  -488.2608348102401
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.470541599429588
DONE TAKING  40  STEPS.
Total reward:  -650.447552770167
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.00727537602674
DONE TAKING  40  STEPS.
Total reward:  -489.0529265184873
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.509628277378765
DONE TAKING  40  STEPS.
Total reward:  -328.2486267502147
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -18.50904445568275
DONE TAKING  40  STEPS.
Total reward:  -355.50335149390077
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.51169735518848
DONE TAKING  40  STEPS.
Total reward:  -532.5781908587817
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.866933749380742
DONE TAKING  40  STEPS.
Total reward:  -610.8554748093169
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.405291931606172
DONE TAKING  40  STEPS.
Total reward:  -563.4965792685828
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.8271414139641
DONE TAKING  40  STEPS.
Total reward:  -782.3909859586971
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.492619740187859
DONE TAKING  40  STEPS.
Total reward:  259.8269372461033
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.457024530220647
DONE TAKING  40  STEPS.
Total reward:  -661.5583794705498
Time for 1 rollout: 1.23 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.3537796312649
DONE TAKING  40  STEPS.
Total reward:  -1069.2021786251626
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.388176204940606
DONE TAKING  40  STEPS.
Total reward:  -492.34979238244915
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.736236014770242
DONE TAKING  40  STEPS.
Total reward:  -234.05570222080746
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.709664640912457
DONE TAKING  40  STEPS.
Total reward:  -483.00189187437223
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.622536840894753
DONE TAKING  40  STEPS.
Total reward:  -659.7959372359212
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.99031814622097
DONE TAKING  40  STEPS.
Total reward:  -1048.4632716652127
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.194020155141818
DONE TAKING  40  STEPS.
Total reward:  -707.3089892498014
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.977849213664804
DONE TAKING  40  STEPS.
Total reward:  -616.5851455138053
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -18.92582290518535
DONE TAKING  40  STEPS.
Total reward:  -441.48972814631423
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.136434423021342
DONE TAKING  40  STEPS.
Total reward:  -951.6311695207582
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.0817737828705
DONE TAKING  40  STEPS.
Total reward:  -260.5689619211485
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -15.480452523418752
DONE TAKING  40  STEPS.
Total reward:  -392.9374219224085
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.602058141162306
DONE TAKING  40  STEPS.
Total reward:  -696.5523711673846
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.964940417979687
DONE TAKING  40  STEPS.
Total reward:  -812.3699875315863
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.798718115067544
DONE TAKING  40  STEPS.
Total reward:  -298.92369719355804
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.154296547567412
DONE TAKING  40  STEPS.
Total reward:  -845.2078855133121
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.268134951794277
DONE TAKING  40  STEPS.
Total reward:  -605.500072662961
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.142472442769506
DONE TAKING  40  STEPS.
Total reward:  -397.5623428475023
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 67
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  67
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48555973851889894
    val rand:  0
    val onPol:  0.33045728504657745

=== Epoch 10 ===
    train loss:  0.22781954496576076
    val rand:  0
    val onPol:  0.26836007088422775

=== Epoch 20 ===
    train loss:  0.19932558322161958
    val rand:  0
    val onPol:  0.26392606149117154

=== Epoch 30 ===
    train loss:  0.17783544277935698
    val rand:  0
    val onPol:  0.26413552711407345

=== Epoch 39 ===
    train loss:  0.1632880845613647
    val rand:  0
    val onPol:  0.26720424989859265
Training duration: 14.20 s

#####################################
performing on-policy MPC rollouts... iter  67
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.991150496331525
DONE TAKING  40  STEPS.
Total reward:  -1014.964274429857
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.199797434974478
DONE TAKING  40  STEPS.
Total reward:  -928.3266440474833
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.803131176269865
DONE TAKING  40  STEPS.
Total reward:  -515.5558842580593
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -26.10402389438103
DONE TAKING  40  STEPS.
Total reward:  -652.5078578348937
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -28.705402750249828
DONE TAKING  40  STEPS.
Total reward:  -571.8042689112717
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -18.488958156273192
DONE TAKING  40  STEPS.
Total reward:  -759.7709296041521
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.15903748369961
DONE TAKING  40  STEPS.
Total reward:  -685.7967496150239
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -25.8116375889246
DONE TAKING  40  STEPS.
Total reward:  -1067.2794471773475
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.858416752915293
DONE TAKING  40  STEPS.
Total reward:  -279.150798363108
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.08770824904765
DONE TAKING  40  STEPS.
Total reward:  -488.32636405630046
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -31.134423963972438
DONE TAKING  40  STEPS.
Total reward:  -688.4748660658944
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -19.36465472866325
DONE TAKING  40  STEPS.
Total reward:  -482.9023836936708
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -19.3229099169479
DONE TAKING  40  STEPS.
Total reward:  -492.06134988024905
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.075749890291736
DONE TAKING  40  STEPS.
Total reward:  -352.7405224718069
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -16.333864569447776
DONE TAKING  40  STEPS.
Total reward:  -373.9860142476369
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.975452151364806
DONE TAKING  40  STEPS.
Total reward:  -678.7690525171242
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.401135106617666
DONE TAKING  40  STEPS.
Total reward:  -818.4472618008393
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.606419466680432
DONE TAKING  40  STEPS.
Total reward:  -713.3296247683639
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.169059873645985
DONE TAKING  40  STEPS.
Total reward:  -573.3247389608704
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.240819560815673
DONE TAKING  40  STEPS.
Total reward:  -828.197596998104
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.463621522187275
DONE TAKING  40  STEPS.
Total reward:  -604.8147180481806
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.962319303363657
DONE TAKING  40  STEPS.
Total reward:  -443.9398420128716
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -31.33191705494479
DONE TAKING  40  STEPS.
Total reward:  -745.9144522348499
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.699174807687292
DONE TAKING  40  STEPS.
Total reward:  -524.2015913902383
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -22.136085671391413
DONE TAKING  40  STEPS.
Total reward:  -662.109806138302
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.37562120060622
DONE TAKING  40  STEPS.
Total reward:  -811.6356764503691
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -16.23169977395507
DONE TAKING  40  STEPS.
Total reward:  -344.35538379292706
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.513409945185067
DONE TAKING  40  STEPS.
Total reward:  -541.9393724568549
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.62954586556696
DONE TAKING  40  STEPS.
Total reward:  -422.4653556622503
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.741574603522494
DONE TAKING  40  STEPS.
Total reward:  -562.611496164426
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.962827389196452
DONE TAKING  40  STEPS.
Total reward:  -367.26646638599
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.733172712907276
DONE TAKING  40  STEPS.
Total reward:  -510.78450664530766
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.194987320246227
DONE TAKING  40  STEPS.
Total reward:  -726.3984978841622
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -31.173731594168068
DONE TAKING  40  STEPS.
Total reward:  -903.7971453568252
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.474496659084874
DONE TAKING  40  STEPS.
Total reward:  -795.664138440447
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -15.100314943062587
DONE TAKING  40  STEPS.
Total reward:  -407.3416012608874
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.762185303962212
DONE TAKING  40  STEPS.
Total reward:  -352.86362872481027
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.99376062709146
DONE TAKING  40  STEPS.
Total reward:  -973.9822079067205
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.766313910466458
DONE TAKING  40  STEPS.
Total reward:  -715.3070324385899
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.649444753894741
DONE TAKING  40  STEPS.
Total reward:  -370.0464762100422
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 68
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  68
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47654636596378525
    val rand:  0
    val onPol:  0.32724272708098096

=== Epoch 10 ===
    train loss:  0.22658492389478183
    val rand:  0
    val onPol:  0.2646404256423314

=== Epoch 20 ===
    train loss:  0.1976492109528759
    val rand:  0
    val onPol:  0.2615875229239464

=== Epoch 30 ===
    train loss:  0.17531443844761765
    val rand:  0
    val onPol:  0.26269358148177463

=== Epoch 39 ===
    train loss:  0.16285060189272227
    val rand:  0
    val onPol:  0.265407457947731
Training duration: 14.15 s

#####################################
performing on-policy MPC rollouts... iter  68
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -27.12658042675834
DONE TAKING  40  STEPS.
Total reward:  -672.6646743842167
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -12.342962758341653
DONE TAKING  40  STEPS.
Total reward:  -343.04056475602596
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.207440332046122
DONE TAKING  40  STEPS.
Total reward:  -460.2683455628983
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.871979801926635
DONE TAKING  40  STEPS.
Total reward:  -850.8178913361041
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -31.076178189509044
DONE TAKING  40  STEPS.
Total reward:  -701.935701124533
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -11.824349115360793
DONE TAKING  40  STEPS.
Total reward:  -260.43511281405137
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.926243934175936
DONE TAKING  40  STEPS.
Total reward:  -850.2965825447732
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.92351839161805
DONE TAKING  40  STEPS.
Total reward:  -367.1967703427536
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -14.867883006669292
DONE TAKING  40  STEPS.
Total reward:  -438.07235501379074
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -12.970496927022758
DONE TAKING  40  STEPS.
Total reward:  -358.269878774262
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.632454836756356
DONE TAKING  40  STEPS.
Total reward:  -471.87689034055364
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.13086131102146
DONE TAKING  40  STEPS.
Total reward:  -368.77604297399245
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -21.64310900814027
DONE TAKING  40  STEPS.
Total reward:  -756.4264923826678
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -12.975842390013801
DONE TAKING  40  STEPS.
Total reward:  -129.40039452172311
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -31.015022949830474
DONE TAKING  40  STEPS.
Total reward:  -225.15510620210725
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -30.840878238661542
DONE TAKING  40  STEPS.
Total reward:  -1124.9140577284975
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.86040170196515
DONE TAKING  40  STEPS.
Total reward:  -952.0969290847625
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -11.90781343265024
DONE TAKING  40  STEPS.
Total reward:  -335.35645282374924
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -12.505250551899856
DONE TAKING  40  STEPS.
Total reward:  -377.4468775183855
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.731188820344567
DONE TAKING  40  STEPS.
Total reward:  -934.0734551855279
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -9.928845709518066
DONE TAKING  40  STEPS.
Total reward:  55.45180441535131
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.185651449284624
DONE TAKING  40  STEPS.
Total reward:  -329.0055315115749
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -11.070924513065483
DONE TAKING  40  STEPS.
Total reward:  -156.01696957842827
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -30.63405780319172
DONE TAKING  40  STEPS.
Total reward:  -844.5654173469907
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.563514437608035
DONE TAKING  40  STEPS.
Total reward:  -404.7826942058437
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.316351662201345
DONE TAKING  40  STEPS.
Total reward:  -710.3833062937675
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -14.347800860210107
DONE TAKING  40  STEPS.
Total reward:  -520.1799781658785
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -17.64273342302978
DONE TAKING  40  STEPS.
Total reward:  -321.09989248462523
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -17.93260503545184
DONE TAKING  40  STEPS.
Total reward:  -321.1652679895495
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.934548786582646
DONE TAKING  40  STEPS.
Total reward:  -738.8470562167872
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -29.67776737800808
DONE TAKING  40  STEPS.
Total reward:  -987.6256393582565
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.504928277991315
DONE TAKING  40  STEPS.
Total reward:  -648.5684442620832
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.469413742131017
DONE TAKING  40  STEPS.
Total reward:  -608.1683453623399
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -12.978869920319887
DONE TAKING  40  STEPS.
Total reward:  -390.7381953576963
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -17.101784525549434
DONE TAKING  40  STEPS.
Total reward:  -503.12336084671455
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -13.489307999742799
DONE TAKING  40  STEPS.
Total reward:  -106.33117282686331
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.528023862696585
DONE TAKING  40  STEPS.
Total reward:  -1107.0250951491507
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -16.52548670610486
DONE TAKING  40  STEPS.
Total reward:  -402.22264584403507
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.636492066761285
DONE TAKING  40  STEPS.
Total reward:  -493.4210442048246
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.264589448623866
DONE TAKING  40  STEPS.
Total reward:  -323.5666873643853
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 69
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  69
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48365842198070724
    val rand:  0
    val onPol:  0.33104131122430164

=== Epoch 10 ===
    train loss:  0.22969721283829003
    val rand:  0
    val onPol:  0.26982169846693677

=== Epoch 20 ===
    train loss:  0.19974439734952493
    val rand:  0
    val onPol:  0.2659008353948593

=== Epoch 30 ===
    train loss:  0.1774011050399981
    val rand:  0
    val onPol:  0.2674352476994197

=== Epoch 39 ===
    train loss:  0.16342581834709435
    val rand:  0
    val onPol:  0.27002867062886554
Training duration: 14.26 s

#####################################
performing on-policy MPC rollouts... iter  69
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -27.43885125362331
DONE TAKING  40  STEPS.
Total reward:  -880.4242823570669
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.90395601192486
DONE TAKING  40  STEPS.
Total reward:  -854.4663660923217
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.420402173820243
DONE TAKING  40  STEPS.
Total reward:  -641.7405810310069
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.98932359706273
DONE TAKING  40  STEPS.
Total reward:  -1021.8079389489084
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -18.300116578225108
DONE TAKING  40  STEPS.
Total reward:  -680.231880056688
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.80123778248212
DONE TAKING  40  STEPS.
Total reward:  -857.1812588259031
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -18.119569459765025
DONE TAKING  40  STEPS.
Total reward:  -360.1654788886075
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -17.818663047799088
DONE TAKING  40  STEPS.
Total reward:  -654.9523985365727
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -29.59875312220913
DONE TAKING  40  STEPS.
Total reward:  -666.0826228563768
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.61783024539094
DONE TAKING  40  STEPS.
Total reward:  -668.5436232837332
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -24.891964425119625
DONE TAKING  40  STEPS.
Total reward:  -512.5198899618202
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -27.06771981260699
DONE TAKING  40  STEPS.
Total reward:  -1031.7269718660816
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -15.247713881854093
DONE TAKING  40  STEPS.
Total reward:  -324.39600157402265
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.863786413982506
DONE TAKING  40  STEPS.
Total reward:  -358.5366805065054
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -30.5631416163807
DONE TAKING  40  STEPS.
Total reward:  -825.9101938868148
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -30.50619242178511
DONE TAKING  40  STEPS.
Total reward:  -687.3859777426451
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.704394556449074
DONE TAKING  40  STEPS.
Total reward:  -532.2780049214585
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.892097169347327
DONE TAKING  40  STEPS.
Total reward:  -650.373450139723
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.57266348349232
DONE TAKING  40  STEPS.
Total reward:  -725.8903430270551
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -21.28298588892673
DONE TAKING  40  STEPS.
Total reward:  -354.9639606263513
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.404941209995535
DONE TAKING  40  STEPS.
Total reward:  -738.962530970638
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.7597018877871
DONE TAKING  40  STEPS.
Total reward:  -842.3982569734632
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.166984344249137
DONE TAKING  40  STEPS.
Total reward:  -672.2411864561955
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.375403836695384
DONE TAKING  40  STEPS.
Total reward:  -900.6279862388509
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -12.707428758194595
DONE TAKING  40  STEPS.
Total reward:  -367.0275796281239
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.689739888607882
DONE TAKING  40  STEPS.
Total reward:  -454.5508863213103
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.848716362828736
DONE TAKING  40  STEPS.
Total reward:  -715.8452028598887
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.908814488600402
DONE TAKING  40  STEPS.
Total reward:  -336.251783785067
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.825320103080948
DONE TAKING  40  STEPS.
Total reward:  -871.8281142664308
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.258878009618687
DONE TAKING  40  STEPS.
Total reward:  -663.9273946562212
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.063654825534453
DONE TAKING  40  STEPS.
Total reward:  -710.8644270704995
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -15.920830223684735
DONE TAKING  40  STEPS.
Total reward:  -500.8966765907066
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.22781065851217
DONE TAKING  40  STEPS.
Total reward:  -653.1383260133267
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -30.16877302514431
DONE TAKING  40  STEPS.
Total reward:  -624.3637144595581
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.507378311736108
DONE TAKING  40  STEPS.
Total reward:  -614.078152570514
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.72288361327692
DONE TAKING  40  STEPS.
Total reward:  -726.5481816535353
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -15.958916953566504
DONE TAKING  40  STEPS.
Total reward:  -393.673728621464
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -26.236948323967493
DONE TAKING  40  STEPS.
Total reward:  -743.7369848496098
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -24.53800995054206
DONE TAKING  40  STEPS.
Total reward:  -378.78133741906277
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -28.72938205108302
DONE TAKING  40  STEPS.
Total reward:  -1034.6322845288425
Time for 1 rollout: 0.98 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 70
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  70
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4840266396079147
    val rand:  0
    val onPol:  0.3440035581588745

=== Epoch 10 ===
    train loss:  0.23275442055442877
    val rand:  0
    val onPol:  0.2777765020728111

=== Epoch 20 ===
    train loss:  0.19958168137491794
    val rand:  0
    val onPol:  0.27185193200906116

=== Epoch 30 ===
    train loss:  0.17773367333830448
    val rand:  0
    val onPol:  0.274562989672025

=== Epoch 39 ===
    train loss:  0.16121502769620796
    val rand:  0
    val onPol:  0.2768944005171458
Training duration: 14.19 s

#####################################
performing on-policy MPC rollouts... iter  70
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.03422437311429
DONE TAKING  40  STEPS.
Total reward:  -473.1422080779915
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.91913505446001
DONE TAKING  40  STEPS.
Total reward:  -652.0006816365935
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -26.764748884976616
DONE TAKING  40  STEPS.
Total reward:  -690.9276218429591
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.278763404729624
DONE TAKING  40  STEPS.
Total reward:  -330.226207321025
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.234881706169062
DONE TAKING  40  STEPS.
Total reward:  -642.927353612934
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -31.101597104156014
DONE TAKING  40  STEPS.
Total reward:  -637.8832049066697
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.815093469950895
DONE TAKING  40  STEPS.
Total reward:  -706.2262372258072
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.872080901937426
DONE TAKING  40  STEPS.
Total reward:  -360.0455567764672
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.26638259202973
DONE TAKING  40  STEPS.
Total reward:  -475.06796741373734
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.30377757385552
DONE TAKING  40  STEPS.
Total reward:  -509.9122000312349
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.117799285524324
DONE TAKING  40  STEPS.
Total reward:  -771.6159701343938
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.95664325068908
DONE TAKING  40  STEPS.
Total reward:  -661.853784120184
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.68620782955048
DONE TAKING  40  STEPS.
Total reward:  -360.8665311650156
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.07574955118003
DONE TAKING  40  STEPS.
Total reward:  -835.737106676156
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.317924409421767
DONE TAKING  40  STEPS.
Total reward:  -737.0751418126101
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.61737230220006
DONE TAKING  40  STEPS.
Total reward:  -549.7150099460122
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.491475524434325
DONE TAKING  40  STEPS.
Total reward:  -315.25531127929975
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -14.10008718679158
DONE TAKING  40  STEPS.
Total reward:  -220.92708458621274
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -25.083649370276152
DONE TAKING  40  STEPS.
Total reward:  79.594114507405
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -17.463334598580484
DONE TAKING  40  STEPS.
Total reward:  -391.7821929615389
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.41109974135243
DONE TAKING  40  STEPS.
Total reward:  -575.003501666748
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.504967076381234
DONE TAKING  40  STEPS.
Total reward:  -828.6004206959311
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.670098139489955
DONE TAKING  40  STEPS.
Total reward:  -655.6706063478736
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -31.20393582804889
DONE TAKING  40  STEPS.
Total reward:  -700.8749141130627
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.516053285897605
DONE TAKING  40  STEPS.
Total reward:  -655.8991459436702
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.91081944979466
DONE TAKING  40  STEPS.
Total reward:  -541.9468720133884
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.272175559690613
DONE TAKING  40  STEPS.
Total reward:  -453.3178086762535
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.987863495082966
DONE TAKING  40  STEPS.
Total reward:  -644.0896192341455
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.49029267555132
DONE TAKING  40  STEPS.
Total reward:  -552.2607135642176
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.606947612367584
DONE TAKING  40  STEPS.
Total reward:  -299.31369862275943
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.887503045742896
DONE TAKING  40  STEPS.
Total reward:  -784.1075300910485
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.319253216219508
DONE TAKING  40  STEPS.
Total reward:  -968.7633195162365
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.10889554815904
DONE TAKING  40  STEPS.
Total reward:  -795.5760825563677
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -21.65687442173447
DONE TAKING  40  STEPS.
Total reward:  -581.2012607127083
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -29.150858625754307
DONE TAKING  40  STEPS.
Total reward:  -961.8529298507416
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.105506864159338
DONE TAKING  40  STEPS.
Total reward:  -539.4894661373576
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.24931779778348
DONE TAKING  40  STEPS.
Total reward:  -381.02029720801323
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.4426865400982
DONE TAKING  40  STEPS.
Total reward:  -743.3394294332496
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -18.762607330876467
DONE TAKING  40  STEPS.
Total reward:  -669.475552532614
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.907334790899906
DONE TAKING  40  STEPS.
Total reward:  -326.96809226317447
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 71
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  71
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48075093773373384
    val rand:  0
    val onPol:  0.34405430654684704

=== Epoch 10 ===
    train loss:  0.22992241539453206
    val rand:  0
    val onPol:  0.27808499584595364

=== Epoch 20 ===
    train loss:  0.1990680129904496
    val rand:  0
    val onPol:  0.2724689841270447

=== Epoch 30 ===
    train loss:  0.17938100428957687
    val rand:  0
    val onPol:  0.27284933626651764

=== Epoch 39 ===
    train loss:  0.16550681936113457
    val rand:  0
    val onPol:  0.27790534496307373
Training duration: 14.24 s

#####################################
performing on-policy MPC rollouts... iter  71
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -30.20140755696415
DONE TAKING  40  STEPS.
Total reward:  -551.879555173256
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.444390980175918
DONE TAKING  40  STEPS.
Total reward:  -747.2151166218196
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.165999453140127
DONE TAKING  40  STEPS.
Total reward:  -282.9760174588901
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.343010950149274
DONE TAKING  40  STEPS.
Total reward:  -605.322217204823
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.23664145486927
DONE TAKING  40  STEPS.
Total reward:  -319.4298454139103
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.253185659943867
DONE TAKING  40  STEPS.
Total reward:  -820.4806875293441
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -31.3984326579628
DONE TAKING  40  STEPS.
Total reward:  -764.3765345193917
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -10.317537418691924
DONE TAKING  40  STEPS.
Total reward:  -344.0590546670569
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.86159096930883
DONE TAKING  40  STEPS.
Total reward:  -882.4655993649192
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.410682192262662
DONE TAKING  40  STEPS.
Total reward:  -756.2439898329809
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.58870372602283
DONE TAKING  40  STEPS.
Total reward:  -894.6383144770091
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.040171341934236
DONE TAKING  40  STEPS.
Total reward:  -814.5719015051438
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -17.187258707429333
DONE TAKING  40  STEPS.
Total reward:  -312.8774297798522
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.044932971059328
DONE TAKING  40  STEPS.
Total reward:  -533.1987815660692
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.78738508640234
DONE TAKING  40  STEPS.
Total reward:  -200.31786764098055
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.987854889526652
DONE TAKING  40  STEPS.
Total reward:  -491.8405545940376
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.48947861267014
DONE TAKING  40  STEPS.
Total reward:  -638.2209133039898
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.185088826825698
DONE TAKING  40  STEPS.
Total reward:  -313.2417976527766
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.069874091647222
DONE TAKING  40  STEPS.
Total reward:  -267.6426199326243
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.22332995608938
DONE TAKING  40  STEPS.
Total reward:  -494.23519470284754
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -26.418096595539325
DONE TAKING  40  STEPS.
Total reward:  -777.2273327684085
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.71414232587054
DONE TAKING  40  STEPS.
Total reward:  -745.706010020682
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.929091088130832
DONE TAKING  40  STEPS.
Total reward:  -692.0251731770984
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.824368327716673
DONE TAKING  40  STEPS.
Total reward:  -212.16239218608308
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.791129214721735
DONE TAKING  40  STEPS.
Total reward:  -802.956116434175
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.79573750200764
DONE TAKING  40  STEPS.
Total reward:  -379.6069501770525
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -14.887835061988115
DONE TAKING  40  STEPS.
Total reward:  -362.4027901229787
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -21.331002737542182
DONE TAKING  40  STEPS.
Total reward:  -746.4869716874658
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.907256333261476
DONE TAKING  40  STEPS.
Total reward:  -752.0173273686477
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.791001810725326
DONE TAKING  40  STEPS.
Total reward:  -582.5712621349409
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -12.872406210783243
DONE TAKING  40  STEPS.
Total reward:  -398.4619842276072
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.844468570816858
DONE TAKING  40  STEPS.
Total reward:  -389.1387977677069
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -11.631224480734495
DONE TAKING  40  STEPS.
Total reward:  -453.3685318975936
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.278640634702025
DONE TAKING  40  STEPS.
Total reward:  -455.00064265813944
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.182365753594926
DONE TAKING  40  STEPS.
Total reward:  -578.802968829252
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.687076104737464
DONE TAKING  40  STEPS.
Total reward:  -879.6484044161106
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.792645306911083
DONE TAKING  40  STEPS.
Total reward:  -628.9598473479881
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.451537726695886
DONE TAKING  40  STEPS.
Total reward:  -649.8707492220638
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -17.058493084428015
DONE TAKING  40  STEPS.
Total reward:  -285.16891604376417
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.692975569830097
DONE TAKING  40  STEPS.
Total reward:  -501.0002584959577
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 72
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  72
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.47562606606567115
    val rand:  0
    val onPol:  0.34342174232006073

=== Epoch 10 ===
    train loss:  0.23410061707622126
    val rand:  0
    val onPol:  0.277618204553922

=== Epoch 20 ===
    train loss:  0.20122946537377542
    val rand:  0
    val onPol:  0.27202394356330234

=== Epoch 30 ===
    train loss:  0.17943140315382103
    val rand:  0
    val onPol:  0.2736722355087598

=== Epoch 39 ===
    train loss:  0.16454157468519712
    val rand:  0
    val onPol:  0.27775953710079193
Training duration: 14.31 s

#####################################
performing on-policy MPC rollouts... iter  72
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.558198713039232
DONE TAKING  40  STEPS.
Total reward:  -457.1112611428505
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -14.688272763172648
DONE TAKING  40  STEPS.
Total reward:  -397.0580286375406
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.30726317843381
DONE TAKING  40  STEPS.
Total reward:  -631.0151353369334
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.657320010572697
DONE TAKING  40  STEPS.
Total reward:  -846.3383293076827
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.10336232346725
DONE TAKING  40  STEPS.
Total reward:  -339.59207800892364
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.673221853595845
DONE TAKING  40  STEPS.
Total reward:  -454.8220555636456
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.602002390448284
DONE TAKING  40  STEPS.
Total reward:  -612.2526526393467
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.87820511826048
DONE TAKING  40  STEPS.
Total reward:  -442.1808630987187
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -19.945292441750805
DONE TAKING  40  STEPS.
Total reward:  -560.5190076563766
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -21.9849990406926
DONE TAKING  40  STEPS.
Total reward:  -839.739621039372
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.98248855964161
DONE TAKING  40  STEPS.
Total reward:  -619.0737324320467
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -18.553903918355893
DONE TAKING  40  STEPS.
Total reward:  -395.492937225449
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -22.247699585646615
DONE TAKING  40  STEPS.
Total reward:  -794.6603691112454
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.792331427594817
DONE TAKING  40  STEPS.
Total reward:  -433.9502210273416
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.217704264671738
DONE TAKING  40  STEPS.
Total reward:  -722.1533709177664
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -17.32293866661658
DONE TAKING  40  STEPS.
Total reward:  -408.01940947576844
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.2694414046342
DONE TAKING  40  STEPS.
Total reward:  -690.2320946072302
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.224860854837242
DONE TAKING  40  STEPS.
Total reward:  -705.4340542959364
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.84765789821249
DONE TAKING  40  STEPS.
Total reward:  -701.7811782839854
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -24.33624567758235
DONE TAKING  40  STEPS.
Total reward:  -512.6361333236331
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -9.394118904111284
DONE TAKING  40  STEPS.
Total reward:  -306.0004598621751
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.804537082976523
DONE TAKING  40  STEPS.
Total reward:  -741.8095070710539
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.510192881734337
DONE TAKING  40  STEPS.
Total reward:  -460.93757364339547
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -15.114098543657942
DONE TAKING  40  STEPS.
Total reward:  -358.8388427367051
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.36245630349609
DONE TAKING  40  STEPS.
Total reward:  -781.3310372154885
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.363257310360193
DONE TAKING  40  STEPS.
Total reward:  -439.20125060310517
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.32896852774852
DONE TAKING  40  STEPS.
Total reward:  -342.3555477537447
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.31575989917418
DONE TAKING  40  STEPS.
Total reward:  -609.2009323010363
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.481187243112064
DONE TAKING  40  STEPS.
Total reward:  -708.4404751135154
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.550110160585554
DONE TAKING  40  STEPS.
Total reward:  -967.2638613007495
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -20.713131981577106
DONE TAKING  40  STEPS.
Total reward:  161.66103098079776
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -29.564683390831586
DONE TAKING  40  STEPS.
Total reward:  -677.1913268224533
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.410274610956968
DONE TAKING  40  STEPS.
Total reward:  -673.6777073311297
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.816989021928045
DONE TAKING  40  STEPS.
Total reward:  -476.456798128556
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.947306221710505
DONE TAKING  40  STEPS.
Total reward:  -752.7017568659303
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.88367542751252
DONE TAKING  40  STEPS.
Total reward:  -280.26296986378406
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -18.056024412294164
DONE TAKING  40  STEPS.
Total reward:  -466.67915008163624
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.387465490907807
DONE TAKING  40  STEPS.
Total reward:  -465.78204606815575
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -17.475758691977504
DONE TAKING  40  STEPS.
Total reward:  -418.05619660321935
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -19.443221788025824
DONE TAKING  40  STEPS.
Total reward:  -529.9025922570071
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 73
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  73
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48463923000452813
    val rand:  0
    val onPol:  0.34444155792395276

=== Epoch 10 ===
    train loss:  0.23559344912830152
    val rand:  0
    val onPol:  0.28114691625038785

=== Epoch 20 ===
    train loss:  0.20152428693938673
    val rand:  0
    val onPol:  0.27515267332394916

=== Epoch 30 ===
    train loss:  0.17944127504240004
    val rand:  0
    val onPol:  0.2757653295993805

=== Epoch 39 ===
    train loss:  0.1638087732227225
    val rand:  0
    val onPol:  0.27816199014584225
Training duration: 14.43 s

#####################################
performing on-policy MPC rollouts... iter  73
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.105366825588312
DONE TAKING  40  STEPS.
Total reward:  -392.82722731834315
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -27.66461673132007
DONE TAKING  40  STEPS.
Total reward:  -722.9989544267518
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -16.21950554273541
DONE TAKING  40  STEPS.
Total reward:  -288.6887790494122
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.778200206092492
DONE TAKING  40  STEPS.
Total reward:  -988.4684669510495
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.219324669752552
DONE TAKING  40  STEPS.
Total reward:  -715.8482410023834
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.87080022849571
DONE TAKING  40  STEPS.
Total reward:  -691.8904775923266
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -12.900067841260034
DONE TAKING  40  STEPS.
Total reward:  -256.6738967922161
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -19.423593274425144
DONE TAKING  40  STEPS.
Total reward:  -488.78235174108136
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -20.527326520887787
DONE TAKING  40  STEPS.
Total reward:  -512.6993897358514
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -16.67792006657726
DONE TAKING  40  STEPS.
Total reward:  -571.1341365283715
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.760824556061525
DONE TAKING  40  STEPS.
Total reward:  -621.7985488487495
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.323174383613598
DONE TAKING  40  STEPS.
Total reward:  -974.1118089148534
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -30.664409579719035
DONE TAKING  40  STEPS.
Total reward:  -734.8626477939705
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -9.868173722450619
DONE TAKING  40  STEPS.
Total reward:  -229.38675209170074
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.300841507392736
DONE TAKING  40  STEPS.
Total reward:  -460.2638724876413
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -22.150489512725954
DONE TAKING  40  STEPS.
Total reward:  -367.71227386750365
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.023318953261814
DONE TAKING  40  STEPS.
Total reward:  -674.2951277977871
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -12.510297408535017
DONE TAKING  40  STEPS.
Total reward:  -153.3895138403916
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.568324761834468
DONE TAKING  40  STEPS.
Total reward:  -445.7251223811343
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.362224445498857
DONE TAKING  40  STEPS.
Total reward:  -663.0375454796955
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -19.342837649348578
DONE TAKING  40  STEPS.
Total reward:  -367.0361551850788
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.52826950089706
DONE TAKING  40  STEPS.
Total reward:  -630.4308093367162
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.878451603491403
DONE TAKING  40  STEPS.
Total reward:  -584.8849961436782
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.90655414957208
DONE TAKING  40  STEPS.
Total reward:  -851.6424862227373
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.361819188127512
DONE TAKING  40  STEPS.
Total reward:  -432.32822623984885
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.749475953643547
DONE TAKING  40  STEPS.
Total reward:  -761.8679173316199
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.021989522506622
DONE TAKING  40  STEPS.
Total reward:  -921.0795276027831
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.76467561002801
DONE TAKING  40  STEPS.
Total reward:  -1179.7999679802938
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.041000255406896
DONE TAKING  40  STEPS.
Total reward:  -558.370346108004
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -27.22832121908985
DONE TAKING  40  STEPS.
Total reward:  -841.0132629628936
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -13.50851260830121
DONE TAKING  40  STEPS.
Total reward:  -447.91373489365867
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.922629599965244
DONE TAKING  40  STEPS.
Total reward:  -360.4769972326617
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -17.288316489513438
DONE TAKING  40  STEPS.
Total reward:  -485.72411093036044
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -25.570309786015194
DONE TAKING  40  STEPS.
Total reward:  -378.3512371286057
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -27.62727145539285
DONE TAKING  40  STEPS.
Total reward:  -3.9878953133666855
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -16.67964562996336
DONE TAKING  40  STEPS.
Total reward:  -304.6839627294563
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.44221273425483
DONE TAKING  40  STEPS.
Total reward:  -642.5444014426872
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -29.771677584494537
DONE TAKING  40  STEPS.
Total reward:  -618.5755211937637
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.363839195673542
DONE TAKING  40  STEPS.
Total reward:  -470.8856265708097
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.69624772184196
DONE TAKING  40  STEPS.
Total reward:  -234.05679643140465
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 74
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  74
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48597382348880436
    val rand:  0
    val onPol:  0.34100253383318585

=== Epoch 10 ===
    train loss:  0.23220289773062655
    val rand:  0
    val onPol:  0.2766711860895157

=== Epoch 20 ===
    train loss:  0.20252381003739542
    val rand:  0
    val onPol:  0.2723289728164673

=== Epoch 30 ===
    train loss:  0.17978640449674507
    val rand:  0
    val onPol:  0.27126552909612656

=== Epoch 39 ===
    train loss:  0.16450162205779761
    val rand:  0
    val onPol:  0.2782006139556567
Training duration: 14.37 s

#####################################
performing on-policy MPC rollouts... iter  74
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -29.449099318222977
DONE TAKING  40  STEPS.
Total reward:  -930.554819349521
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -30.9693522705383
DONE TAKING  40  STEPS.
Total reward:  -882.1542874747455
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.509240191903828
DONE TAKING  40  STEPS.
Total reward:  -618.3526587666527
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.917893824468152
DONE TAKING  40  STEPS.
Total reward:  -717.8733740236979
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.386748983304088
DONE TAKING  40  STEPS.
Total reward:  -566.364306579203
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -14.836922456753943
DONE TAKING  40  STEPS.
Total reward:  -407.8678342037819
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -25.110512224051188
DONE TAKING  40  STEPS.
Total reward:  -609.4437244658088
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.620625414533137
DONE TAKING  40  STEPS.
Total reward:  -716.8002245745657
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.26469037869487
DONE TAKING  40  STEPS.
Total reward:  -462.7562534252328
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -19.014243855173707
DONE TAKING  40  STEPS.
Total reward:  -611.6999019851429
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.67696426660865
DONE TAKING  40  STEPS.
Total reward:  -684.5639862423646
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.397879273194047
DONE TAKING  40  STEPS.
Total reward:  -855.4947850385159
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -25.810935687968197
DONE TAKING  40  STEPS.
Total reward:  -854.51644859682
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -23.291987932780835
DONE TAKING  40  STEPS.
Total reward:  -399.7589181659606
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.867031741213623
DONE TAKING  40  STEPS.
Total reward:  -485.7991150219429
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.82500114232863
DONE TAKING  40  STEPS.
Total reward:  -878.9025042058054
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.48290691629619
DONE TAKING  40  STEPS.
Total reward:  -774.5130615289687
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.836282066814327
DONE TAKING  40  STEPS.
Total reward:  -519.6561566641857
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -29.977886068442558
DONE TAKING  40  STEPS.
Total reward:  -812.2689739548896
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.810539693773197
DONE TAKING  40  STEPS.
Total reward:  -738.5808585814327
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.402944834752184
DONE TAKING  40  STEPS.
Total reward:  -782.6503620763403
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.069428712173035
DONE TAKING  40  STEPS.
Total reward:  -374.1183214917754
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.31557177147363
DONE TAKING  40  STEPS.
Total reward:  -985.8367290420604
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.993846092091218
DONE TAKING  40  STEPS.
Total reward:  -544.5338458496882
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.127270217015916
DONE TAKING  40  STEPS.
Total reward:  -825.8266407037106
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.742899063952652
DONE TAKING  40  STEPS.
Total reward:  -627.6042573233157
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.975628701426896
DONE TAKING  40  STEPS.
Total reward:  -684.5538376432851
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.292718536279516
DONE TAKING  40  STEPS.
Total reward:  -707.9493932329322
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.228626354463398
DONE TAKING  40  STEPS.
Total reward:  -729.4964858533955
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.61298965115056
DONE TAKING  40  STEPS.
Total reward:  -680.9340692570361
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.203297219032393
DONE TAKING  40  STEPS.
Total reward:  -691.4402375768042
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -11.844955918775034
DONE TAKING  40  STEPS.
Total reward:  -355.30157491257273
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.868662381056293
DONE TAKING  40  STEPS.
Total reward:  -813.8566072832821
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.737362850664365
DONE TAKING  40  STEPS.
Total reward:  -922.4662671740514
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.309294716241062
DONE TAKING  40  STEPS.
Total reward:  -497.0905002495108
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.219116627233912
DONE TAKING  40  STEPS.
Total reward:  -204.61645779258905
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -31.136353487034626
DONE TAKING  40  STEPS.
Total reward:  -656.822852686279
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.537154290961965
DONE TAKING  40  STEPS.
Total reward:  -201.12523666868097
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -17.488680376833443
DONE TAKING  40  STEPS.
Total reward:  -519.7241284146976
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.78293509652821
DONE TAKING  40  STEPS.
Total reward:  -587.9990407246808
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 75
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  75
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49025057230079383
    val rand:  0
    val onPol:  0.3363381276528041

=== Epoch 10 ===
    train loss:  0.2323821121663378
    val rand:  0
    val onPol:  0.27450717488924664

=== Epoch 20 ===
    train loss:  0.2022722737308134
    val rand:  0
    val onPol:  0.2701142107446988

=== Epoch 30 ===
    train loss:  0.18271695861690923
    val rand:  0
    val onPol:  0.2698098023732503

=== Epoch 39 ===
    train loss:  0.16655852946273067
    val rand:  0
    val onPol:  0.2765391568342845
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  75
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.092098622430555
DONE TAKING  40  STEPS.
Total reward:  -563.2521450150798
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.676724133825036
DONE TAKING  40  STEPS.
Total reward:  -507.6378021932145
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.511184491834591
DONE TAKING  40  STEPS.
Total reward:  -264.55968548253185
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.996907553909324
DONE TAKING  40  STEPS.
Total reward:  -1027.8691336959412
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -16.291388449355484
DONE TAKING  40  STEPS.
Total reward:  -346.6670871357222
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.361847712159417
DONE TAKING  40  STEPS.
Total reward:  -218.43744204549668
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.60584246553529
DONE TAKING  40  STEPS.
Total reward:  -656.372999736751
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.84582440239481
DONE TAKING  40  STEPS.
Total reward:  -595.7136007831682
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.699358529487288
DONE TAKING  40  STEPS.
Total reward:  -978.1917335057112
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -11.184091959968228
DONE TAKING  40  STEPS.
Total reward:  -402.0724911377396
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -25.382967338099117
DONE TAKING  40  STEPS.
Total reward:  -625.27661428143
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -19.66211122142382
DONE TAKING  40  STEPS.
Total reward:  -451.2223946870752
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.92304574820431
DONE TAKING  40  STEPS.
Total reward:  -685.9977308769381
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -18.582664679549097
DONE TAKING  40  STEPS.
Total reward:  341.9304453045484
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.589505832574126
DONE TAKING  40  STEPS.
Total reward:  -636.7750465644094
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.095850856159537
DONE TAKING  40  STEPS.
Total reward:  -459.5110310390224
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.386908532320952
DONE TAKING  40  STEPS.
Total reward:  -521.4608001224933
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -20.783852812968036
DONE TAKING  40  STEPS.
Total reward:  -930.2873438098426
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.733717455021196
DONE TAKING  40  STEPS.
Total reward:  -548.8677791758723
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.6984930307816
DONE TAKING  40  STEPS.
Total reward:  -485.64578899650445
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.97844702367336
DONE TAKING  40  STEPS.
Total reward:  -756.4199937796104
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.72962274106186
DONE TAKING  40  STEPS.
Total reward:  -774.7676308019763
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.180105048528404
DONE TAKING  40  STEPS.
Total reward:  -509.31551035824305
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.214540097555783
DONE TAKING  40  STEPS.
Total reward:  -480.4747862116601
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.48980846833861
DONE TAKING  40  STEPS.
Total reward:  -506.7534055040953
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -26.121399974493748
DONE TAKING  40  STEPS.
Total reward:  -636.3210856108649
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.930045975238816
DONE TAKING  40  STEPS.
Total reward:  -650.7982581157137
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -16.3843830023026
DONE TAKING  40  STEPS.
Total reward:  -481.7475355732892
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.976575845979013
DONE TAKING  40  STEPS.
Total reward:  -1149.0723314578372
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -19.986751397085577
DONE TAKING  40  STEPS.
Total reward:  -413.2405876992968
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.54996717321297
DONE TAKING  40  STEPS.
Total reward:  -247.13004644230173
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.847314681665157
DONE TAKING  40  STEPS.
Total reward:  -875.7222444577413
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.155398646113866
DONE TAKING  40  STEPS.
Total reward:  -340.4123750303236
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.104089318189043
DONE TAKING  40  STEPS.
Total reward:  -719.5470846302438
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.905518098509358
DONE TAKING  40  STEPS.
Total reward:  -763.6938265246027
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.309678641842105
DONE TAKING  40  STEPS.
Total reward:  -791.7488839440476
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.101074127456656
DONE TAKING  40  STEPS.
Total reward:  -646.7933016443232
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.280887493445103
DONE TAKING  40  STEPS.
Total reward:  -975.9016464567948
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.817790251733797
DONE TAKING  40  STEPS.
Total reward:  -703.6854768583648
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.638421366765737
DONE TAKING  40  STEPS.
Total reward:  -827.0387969429717
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 76
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  76
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48341795279268635
    val rand:  0
    val onPol:  0.33880334595839184

=== Epoch 10 ===
    train loss:  0.23765912495161357
    val rand:  0
    val onPol:  0.2754105602701505

=== Epoch 20 ===
    train loss:  0.2031337681569551
    val rand:  0
    val onPol:  0.2710681955019633

=== Epoch 30 ===
    train loss:  0.18277715251111148
    val rand:  0
    val onPol:  0.2757007951537768

=== Epoch 39 ===
    train loss:  0.16542127545465501
    val rand:  0
    val onPol:  0.27795323729515076
Training duration: 14.37 s

#####################################
performing on-policy MPC rollouts... iter  76
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.058321233694024
DONE TAKING  40  STEPS.
Total reward:  -449.0640874243108
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -29.253651780808685
DONE TAKING  40  STEPS.
Total reward:  -744.0278853655896
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -27.518792960713068
DONE TAKING  40  STEPS.
Total reward:  -775.2968358690913
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.633050906496152
DONE TAKING  40  STEPS.
Total reward:  -288.0158887458846
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.727615799490348
DONE TAKING  40  STEPS.
Total reward:  -847.6350436251018
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.710066670962966
DONE TAKING  40  STEPS.
Total reward:  -363.34938585249193
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -19.140557547143857
DONE TAKING  40  STEPS.
Total reward:  -276.8247120427633
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -24.838463658163057
DONE TAKING  40  STEPS.
Total reward:  -750.3961356650216
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.957521034768035
DONE TAKING  40  STEPS.
Total reward:  -430.720339650877
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.481493626391753
DONE TAKING  40  STEPS.
Total reward:  -602.7882598082087
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -11.959500594510502
DONE TAKING  40  STEPS.
Total reward:  38.43113480454593
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.234376636458293
DONE TAKING  40  STEPS.
Total reward:  -849.873448824314
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.933487508409435
DONE TAKING  40  STEPS.
Total reward:  -585.4782716961722
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -10.837464127896762
DONE TAKING  40  STEPS.
Total reward:  -435.53016285916294
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -11.87051145939659
DONE TAKING  40  STEPS.
Total reward:  -344.9210386545507
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.534061237927336
DONE TAKING  40  STEPS.
Total reward:  -1041.916115576257
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.677203181158443
DONE TAKING  40  STEPS.
Total reward:  -379.62188355441486
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.228881764063352
DONE TAKING  40  STEPS.
Total reward:  -380.1149308792667
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.673051991775168
DONE TAKING  40  STEPS.
Total reward:  -704.1872592143818
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.479421884050804
DONE TAKING  40  STEPS.
Total reward:  -743.8429586839943
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.73620586204641
DONE TAKING  40  STEPS.
Total reward:  -715.5912223001651
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -13.212939848360769
DONE TAKING  40  STEPS.
Total reward:  -200.10296161038968
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -16.83500337316667
DONE TAKING  40  STEPS.
Total reward:  -354.62884134251243
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.49995907985549
DONE TAKING  40  STEPS.
Total reward:  -368.38710191945216
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.1812626285083
DONE TAKING  40  STEPS.
Total reward:  -510.8429798203067
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -16.723560977157607
DONE TAKING  40  STEPS.
Total reward:  -439.48737579157836
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.794621820741988
DONE TAKING  40  STEPS.
Total reward:  -316.86422828150967
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.002446396492982
DONE TAKING  40  STEPS.
Total reward:  -303.3961250453853
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -30.083012533940767
DONE TAKING  40  STEPS.
Total reward:  -703.2678228748804
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.14460066898932
DONE TAKING  40  STEPS.
Total reward:  -288.30754600934756
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.772393929053145
DONE TAKING  40  STEPS.
Total reward:  -678.4866362235933
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -11.702495827451
DONE TAKING  40  STEPS.
Total reward:  -395.09133584020327
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -30.936314279423975
DONE TAKING  40  STEPS.
Total reward:  -672.1612589826105
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.008826083445506
DONE TAKING  40  STEPS.
Total reward:  -801.1358558547125
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.050283489778288
DONE TAKING  40  STEPS.
Total reward:  -573.6465983310961
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.81008526083309
DONE TAKING  40  STEPS.
Total reward:  -584.0479540545878
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.228611702570277
DONE TAKING  40  STEPS.
Total reward:  -793.0281656686415
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.662031965221328
DONE TAKING  40  STEPS.
Total reward:  -308.9532720751611
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.79814942898141
DONE TAKING  40  STEPS.
Total reward:  -791.2442175251654
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.81886454623502
DONE TAKING  40  STEPS.
Total reward:  -782.2953404516832
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 77
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  77
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48483609787204807
    val rand:  0
    val onPol:  0.3499028633038203

=== Epoch 10 ===
    train loss:  0.23999033371607462
    val rand:  0
    val onPol:  0.2836142455538114

=== Epoch 20 ===
    train loss:  0.20600602762740955
    val rand:  0
    val onPol:  0.27944810688495636

=== Epoch 30 ===
    train loss:  0.18390403060536636
    val rand:  0
    val onPol:  0.2809198747078578

=== Epoch 39 ===
    train loss:  0.1680542609670706
    val rand:  0
    val onPol:  0.28665202607711154
Training duration: 14.33 s

#####################################
performing on-policy MPC rollouts... iter  77
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -22.36715865721778
DONE TAKING  40  STEPS.
Total reward:  -710.3721551902643
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -26.213985642893157
DONE TAKING  40  STEPS.
Total reward:  -409.30672090190717
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -18.884761334389527
DONE TAKING  40  STEPS.
Total reward:  -244.2083674810449
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -11.890969608877274
DONE TAKING  40  STEPS.
Total reward:  171.0102558878246
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -16.85344157356773
DONE TAKING  40  STEPS.
Total reward:  -415.1664785346653
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.16703856012945
DONE TAKING  40  STEPS.
Total reward:  -513.3781818963026
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -25.106714147233383
DONE TAKING  40  STEPS.
Total reward:  -539.0784946914439
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.983850602615767
DONE TAKING  40  STEPS.
Total reward:  -300.20768215983276
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.86888700964774
DONE TAKING  40  STEPS.
Total reward:  -684.2247333238145
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -25.775117846768506
DONE TAKING  40  STEPS.
Total reward:  -663.747345026364
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -19.385711649728577
DONE TAKING  40  STEPS.
Total reward:  -729.8873588382683
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.059755640401647
DONE TAKING  40  STEPS.
Total reward:  -610.3708047022358
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.75715030263695
DONE TAKING  40  STEPS.
Total reward:  -742.1024063925869
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.075103980617076
DONE TAKING  40  STEPS.
Total reward:  -827.4972225922425
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -31.222932489245935
DONE TAKING  40  STEPS.
Total reward:  -1094.258851521205
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.742732326442862
DONE TAKING  40  STEPS.
Total reward:  -311.55373014802086
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.9265514976109
DONE TAKING  40  STEPS.
Total reward:  -830.3226215196668
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.663305155341828
DONE TAKING  40  STEPS.
Total reward:  -823.144739308092
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -11.273180472970775
DONE TAKING  40  STEPS.
Total reward:  -439.7253855087588
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -19.983820917919726
DONE TAKING  40  STEPS.
Total reward:  -715.4553830485988
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.15295217593975
DONE TAKING  40  STEPS.
Total reward:  -714.2651602155013
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.778718626995666
DONE TAKING  40  STEPS.
Total reward:  -920.0059760521281
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.20074362883858
DONE TAKING  40  STEPS.
Total reward:  -1057.3700004057403
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.84146986899882
DONE TAKING  40  STEPS.
Total reward:  -331.90978891534456
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.033972671755752
DONE TAKING  40  STEPS.
Total reward:  -328.47429140195476
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -19.011994301793912
DONE TAKING  40  STEPS.
Total reward:  -308.56747733209903
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -24.75646355545512
DONE TAKING  40  STEPS.
Total reward:  -749.8660840896873
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.061327653073146
DONE TAKING  40  STEPS.
Total reward:  -554.0896713933639
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -9.870911292483411
DONE TAKING  40  STEPS.
Total reward:  -334.2141534683243
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -12.017139403456687
DONE TAKING  40  STEPS.
Total reward:  -299.82949941486277
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.92138336962114
DONE TAKING  40  STEPS.
Total reward:  -255.73719796274452
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.10712798952888
DONE TAKING  40  STEPS.
Total reward:  -774.3285176248525
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -28.83994386851096
DONE TAKING  40  STEPS.
Total reward:  -785.1776813935176
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.113368420223075
DONE TAKING  40  STEPS.
Total reward:  -669.4545442399473
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.216962693479704
DONE TAKING  40  STEPS.
Total reward:  -627.9039916318575
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.685350919624685
DONE TAKING  40  STEPS.
Total reward:  -1098.8124447015794
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -11.455259480042875
DONE TAKING  40  STEPS.
Total reward:  56.36982049043175
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -31.023770212116418
DONE TAKING  40  STEPS.
Total reward:  -1103.327607017504
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -20.300767280637405
DONE TAKING  40  STEPS.
Total reward:  -321.7506430230127
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -26.754525072927557
DONE TAKING  40  STEPS.
Total reward:  -552.6179882201975
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 78
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  78
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48245993465708015
    val rand:  0
    val onPol:  0.357753723859787

=== Epoch 10 ===
    train loss:  0.23347591752545876
    val rand:  0
    val onPol:  0.28867445637782413

=== Epoch 20 ===
    train loss:  0.20464449807217247
    val rand:  0
    val onPol:  0.28391772508621216

=== Epoch 30 ===
    train loss:  0.18324524451766097
    val rand:  0
    val onPol:  0.2853296125928561

=== Epoch 39 ===
    train loss:  0.16370336763691484
    val rand:  0
    val onPol:  0.2911836306254069
Training duration: 14.29 s

#####################################
performing on-policy MPC rollouts... iter  78
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -16.360881048672624
DONE TAKING  40  STEPS.
Total reward:  -367.5448817729994
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.841864198952518
DONE TAKING  40  STEPS.
Total reward:  -384.5733318840568
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -15.236393456545677
DONE TAKING  40  STEPS.
Total reward:  -554.2879027442341
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.17793811200142
DONE TAKING  40  STEPS.
Total reward:  -689.6285703431041
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.563959818781278
DONE TAKING  40  STEPS.
Total reward:  -455.33068788708397
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.094888660326838
DONE TAKING  40  STEPS.
Total reward:  -607.0756993985116
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -21.213921566279346
DONE TAKING  40  STEPS.
Total reward:  -465.6926809297278
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.129611600307477
DONE TAKING  40  STEPS.
Total reward:  -643.8664106024044
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -18.160935979705304
DONE TAKING  40  STEPS.
Total reward:  -344.3267418637404
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.918556856523914
DONE TAKING  40  STEPS.
Total reward:  -905.4426121714479
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -13.103683635666679
DONE TAKING  40  STEPS.
Total reward:  -255.19970946544373
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.306585208903083
DONE TAKING  40  STEPS.
Total reward:  -231.26612676439314
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.15306736958219
DONE TAKING  40  STEPS.
Total reward:  -600.5334364423015
Time for 1 rollout: 1.18 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.578003677648383
DONE TAKING  40  STEPS.
Total reward:  -437.27375133372857
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -20.434818897333148
DONE TAKING  40  STEPS.
Total reward:  -448.57900720497395
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -18.537199667710887
DONE TAKING  40  STEPS.
Total reward:  -205.85347411162823
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.685115009903726
DONE TAKING  40  STEPS.
Total reward:  -984.0081887005831
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.0690377789575
DONE TAKING  40  STEPS.
Total reward:  -395.32956219573384
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.66563810907993
DONE TAKING  40  STEPS.
Total reward:  -843.0013523844206
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -29.24626236785715
DONE TAKING  40  STEPS.
Total reward:  -1023.7425862139512
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.75617500102761
DONE TAKING  40  STEPS.
Total reward:  -656.0891862201223
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.529833101308714
DONE TAKING  40  STEPS.
Total reward:  -687.6852404082896
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.58293389673773
DONE TAKING  40  STEPS.
Total reward:  -407.0191246972901
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.201789644095832
DONE TAKING  40  STEPS.
Total reward:  -546.0513057126897
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -14.951040028947054
DONE TAKING  40  STEPS.
Total reward:  -228.43353593238444
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -25.806116536541793
DONE TAKING  40  STEPS.
Total reward:  -834.3545504381377
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.149640205233936
DONE TAKING  40  STEPS.
Total reward:  -628.87650994292
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.028669638447976
DONE TAKING  40  STEPS.
Total reward:  -590.1391095195704
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -31.277169590650637
DONE TAKING  40  STEPS.
Total reward:  -920.3342466273488
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.076561206368183
DONE TAKING  40  STEPS.
Total reward:  151.40542381597106
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -14.085770447094736
DONE TAKING  40  STEPS.
Total reward:  -516.9969815367964
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -12.863489592536563
DONE TAKING  40  STEPS.
Total reward:  -246.07992462855123
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.318035067755723
DONE TAKING  40  STEPS.
Total reward:  -523.381570484309
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -27.425240472046685
DONE TAKING  40  STEPS.
Total reward:  -1058.4914062462697
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -28.735939837120114
DONE TAKING  40  STEPS.
Total reward:  -809.8323969573834
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.03564076997501
DONE TAKING  40  STEPS.
Total reward:  -645.3618844297847
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.264996107399956
DONE TAKING  40  STEPS.
Total reward:  -812.7115393433431
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.103246732189735
DONE TAKING  40  STEPS.
Total reward:  -908.7179111037518
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -14.567757135857038
DONE TAKING  40  STEPS.
Total reward:  -569.4823985452014
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -26.760203572332376
DONE TAKING  40  STEPS.
Total reward:  -661.3954145356188
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 79
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  79
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4898468752702077
    val rand:  0
    val onPol:  0.3614790290594101

=== Epoch 10 ===
    train loss:  0.23685721687057562
    val rand:  0
    val onPol:  0.2900218740105629

=== Epoch 20 ===
    train loss:  0.20563373361763201
    val rand:  0
    val onPol:  0.284112386405468

=== Epoch 30 ===
    train loss:  0.18236835823770156
    val rand:  0
    val onPol:  0.287521094083786

=== Epoch 39 ===
    train loss:  0.16764768016965767
    val rand:  0
    val onPol:  0.29001881182193756
Training duration: 14.18 s

#####################################
performing on-policy MPC rollouts... iter  79
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -17.65176694979248
DONE TAKING  40  STEPS.
Total reward:  -392.48519461082515
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -24.292909290933324
DONE TAKING  40  STEPS.
Total reward:  -325.12564438501755
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.45843354915585
DONE TAKING  40  STEPS.
Total reward:  -268.87083680429356
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -11.184330127209552
DONE TAKING  40  STEPS.
Total reward:  -308.84470702146746
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.20246846247904
DONE TAKING  40  STEPS.
Total reward:  -233.7077032053511
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -13.762248183519997
DONE TAKING  40  STEPS.
Total reward:  -238.38873808665204
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -16.228968652152354
DONE TAKING  40  STEPS.
Total reward:  -290.1544870017995
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -19.277270404962913
DONE TAKING  40  STEPS.
Total reward:  -441.6720499888679
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -19.364345580784807
DONE TAKING  40  STEPS.
Total reward:  -596.3290478783421
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -17.38489428122087
DONE TAKING  40  STEPS.
Total reward:  -523.9585061076398
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -23.21888061485084
DONE TAKING  40  STEPS.
Total reward:  -784.9065419781433
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -29.497253054081455
DONE TAKING  40  STEPS.
Total reward:  -658.3709540497631
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.452089248426585
DONE TAKING  40  STEPS.
Total reward:  -495.9520926474162
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -28.266073916592394
DONE TAKING  40  STEPS.
Total reward:  -709.5389051309763
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.796264538604404
DONE TAKING  40  STEPS.
Total reward:  -414.38802464764865
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -27.473796429474792
DONE TAKING  40  STEPS.
Total reward:  -416.26508609934774
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.206227896161252
DONE TAKING  40  STEPS.
Total reward:  -497.74151733817087
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -28.329297775837688
DONE TAKING  40  STEPS.
Total reward:  -559.2578594846569
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.41785254539845
DONE TAKING  40  STEPS.
Total reward:  -497.0501542579838
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.940662604415287
DONE TAKING  40  STEPS.
Total reward:  -739.0856612964708
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.36066668286825
DONE TAKING  40  STEPS.
Total reward:  -1026.6423821494457
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -26.118322469506356
DONE TAKING  40  STEPS.
Total reward:  -627.4761619930562
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -27.617170809835002
DONE TAKING  40  STEPS.
Total reward:  -1088.605488988857
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -18.562182866351563
DONE TAKING  40  STEPS.
Total reward:  -272.8300603705494
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.91960072733026
DONE TAKING  40  STEPS.
Total reward:  -730.2601487032869
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.308465607685292
DONE TAKING  40  STEPS.
Total reward:  -751.5649484352817
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -29.07456983684053
DONE TAKING  40  STEPS.
Total reward:  -710.0111071749768
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -22.376267883562978
DONE TAKING  40  STEPS.
Total reward:  -576.6531980580493
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.885110478735733
DONE TAKING  40  STEPS.
Total reward:  -793.2721856088026
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -13.151907922151773
DONE TAKING  40  STEPS.
Total reward:  -346.0916669659804
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.019565847029156
DONE TAKING  40  STEPS.
Total reward:  -337.7040889913981
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.606516121845587
DONE TAKING  40  STEPS.
Total reward:  -720.2453507813556
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.67443296091267
DONE TAKING  40  STEPS.
Total reward:  -329.26173578986464
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.849759456264643
DONE TAKING  40  STEPS.
Total reward:  -639.1883045392653
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.394783268137765
DONE TAKING  40  STEPS.
Total reward:  -264.45172804128094
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -23.87878961750797
DONE TAKING  40  STEPS.
Total reward:  -880.2852874724653
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -30.79260010791867
DONE TAKING  40  STEPS.
Total reward:  -606.283952515863
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.97938951515301
DONE TAKING  40  STEPS.
Total reward:  -808.9933603682863
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -25.678496718683974
DONE TAKING  40  STEPS.
Total reward:  -818.1602867109289
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -18.434486991239957
DONE TAKING  40  STEPS.
Total reward:  -304.6323609516435
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 80
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  80
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49672906911164
    val rand:  0
    val onPol:  0.3629932701587677

=== Epoch 10 ===
    train loss:  0.23798444344286332
    val rand:  0
    val onPol:  0.2924550473690033

=== Epoch 20 ===
    train loss:  0.20713889441992106
    val rand:  0
    val onPol:  0.2906326825420062

=== Epoch 30 ===
    train loss:  0.1857374584988544
    val rand:  0
    val onPol:  0.29023754348357517

=== Epoch 39 ===
    train loss:  0.16754332733781716
    val rand:  0
    val onPol:  0.29499028623104095
Training duration: 14.38 s

#####################################
performing on-policy MPC rollouts... iter  80
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -30.55478947245211
DONE TAKING  40  STEPS.
Total reward:  -805.4946322323922
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.169241986338648
DONE TAKING  40  STEPS.
Total reward:  -792.4848341160548
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.757040478953535
DONE TAKING  40  STEPS.
Total reward:  -556.7069601510367
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -18.08848718814099
DONE TAKING  40  STEPS.
Total reward:  -403.08265690128974
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.363537387696862
DONE TAKING  40  STEPS.
Total reward:  -762.2869514563973
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.474202995809108
DONE TAKING  40  STEPS.
Total reward:  -791.2845553802438
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.481441602600192
DONE TAKING  40  STEPS.
Total reward:  -520.9710474868374
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -20.89712789736973
DONE TAKING  40  STEPS.
Total reward:  -788.7615365247846
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.170628406601395
DONE TAKING  40  STEPS.
Total reward:  -844.060600445461
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.363680736751473
DONE TAKING  40  STEPS.
Total reward:  -784.4573447499239
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.20075676354095
DONE TAKING  40  STEPS.
Total reward:  -689.9613478001862
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -31.20346570366317
DONE TAKING  40  STEPS.
Total reward:  -757.8098215722683
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.18856375951279
DONE TAKING  40  STEPS.
Total reward:  -922.1924211291899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -25.01726540924281
DONE TAKING  40  STEPS.
Total reward:  -415.7576514393158
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -30.291193009167525
DONE TAKING  40  STEPS.
Total reward:  -606.8048415565974
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -15.622787668017832
DONE TAKING  40  STEPS.
Total reward:  -265.03734794088774
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.128951236697958
DONE TAKING  40  STEPS.
Total reward:  -682.055291050991
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.80849643021816
DONE TAKING  40  STEPS.
Total reward:  -707.6072705893608
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.14126367895718
DONE TAKING  40  STEPS.
Total reward:  -667.0618765634276
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.43984692680943
DONE TAKING  40  STEPS.
Total reward:  -571.339354702161
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.64601092531457
DONE TAKING  40  STEPS.
Total reward:  -827.9708360550107
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -21.940868289273006
DONE TAKING  40  STEPS.
Total reward:  -755.8944527962967
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -25.088214523211082
DONE TAKING  40  STEPS.
Total reward:  -821.7060281209873
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -11.709621151296705
DONE TAKING  40  STEPS.
Total reward:  -251.6963145391235
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.864216348030716
DONE TAKING  40  STEPS.
Total reward:  -904.8457540839514
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.540872283046987
DONE TAKING  40  STEPS.
Total reward:  -780.1138816370052
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -17.999396288398305
DONE TAKING  40  STEPS.
Total reward:  -589.9965947036146
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -20.881181829554855
DONE TAKING  40  STEPS.
Total reward:  -612.2545744930853
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.829276836459513
DONE TAKING  40  STEPS.
Total reward:  -705.8335395986791
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -15.095191022079192
DONE TAKING  40  STEPS.
Total reward:  -406.8340450746125
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.888345800356742
DONE TAKING  40  STEPS.
Total reward:  -510.8853866526795
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.291410609024048
DONE TAKING  40  STEPS.
Total reward:  -743.7885386016079
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.467340444930482
DONE TAKING  40  STEPS.
Total reward:  -864.2698145131695
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -13.8552303504656
DONE TAKING  40  STEPS.
Total reward:  -286.54108046466496
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.042427071849488
DONE TAKING  40  STEPS.
Total reward:  -461.8087821471726
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.53280790466189
DONE TAKING  40  STEPS.
Total reward:  -625.3952207501841
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -16.68052099739518
DONE TAKING  40  STEPS.
Total reward:  -384.9924660045696
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.048760675990334
DONE TAKING  40  STEPS.
Total reward:  -735.0344166908643
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.163679662428944
DONE TAKING  40  STEPS.
Total reward:  -735.8137294493008
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -17.090471431827012
DONE TAKING  40  STEPS.
Total reward:  -486.264216297068
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 81
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  81
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49645922215361343
    val rand:  0
    val onPol:  0.3678874025742213

=== Epoch 10 ===
    train loss:  0.24111300916002507
    val rand:  0
    val onPol:  0.2969907174507777

=== Epoch 20 ===
    train loss:  0.20736543808067054
    val rand:  0
    val onPol:  0.29293224960565567

=== Epoch 30 ===
    train loss:  0.18442317712725254
    val rand:  0
    val onPol:  0.29716332753499347

=== Epoch 39 ===
    train loss:  0.16870197261634626
    val rand:  0
    val onPol:  0.30020170907179516
Training duration: 14.33 s

#####################################
performing on-policy MPC rollouts... iter  81
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.138441111610724
DONE TAKING  40  STEPS.
Total reward:  -369.4545103219293
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.376626814740362
DONE TAKING  40  STEPS.
Total reward:  -618.1343379011942
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.02145603391702
DONE TAKING  40  STEPS.
Total reward:  -670.1255375534806
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.466551683912478
DONE TAKING  40  STEPS.
Total reward:  -267.55516591935265
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.643263341191954
DONE TAKING  40  STEPS.
Total reward:  -275.6210105778249
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -16.22100672481813
DONE TAKING  40  STEPS.
Total reward:  -523.7773993845861
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.556662045221284
DONE TAKING  40  STEPS.
Total reward:  -921.1747198481359
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -25.877397887059324
DONE TAKING  40  STEPS.
Total reward:  -657.0805883330402
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.718606754855905
DONE TAKING  40  STEPS.
Total reward:  -703.3922717330172
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.634451226327513
DONE TAKING  40  STEPS.
Total reward:  -455.64722473484386
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -31.306668866312783
DONE TAKING  40  STEPS.
Total reward:  -883.014428358697
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.06937113282015
DONE TAKING  40  STEPS.
Total reward:  -330.948587364604
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -31.091927422230803
DONE TAKING  40  STEPS.
Total reward:  -795.3131378158832
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -18.67015238844691
DONE TAKING  40  STEPS.
Total reward:  -404.2492522520866
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.045592642869764
DONE TAKING  40  STEPS.
Total reward:  -637.5726687031486
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -26.16281124800605
DONE TAKING  40  STEPS.
Total reward:  -671.5641248768045
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -17.403306961074634
DONE TAKING  40  STEPS.
Total reward:  -355.50948584717383
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -11.473544423008335
DONE TAKING  40  STEPS.
Total reward:  -447.4648107893525
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.54844523460922
DONE TAKING  40  STEPS.
Total reward:  -342.41351512062397
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -16.872395028359207
DONE TAKING  40  STEPS.
Total reward:  40.46260606203312
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -30.049319218055082
DONE TAKING  40  STEPS.
Total reward:  -585.9258868497121
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.40524880774835
DONE TAKING  40  STEPS.
Total reward:  -885.4010826109004
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.626876544644144
DONE TAKING  40  STEPS.
Total reward:  -779.1022903861033
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.031615878270173
DONE TAKING  40  STEPS.
Total reward:  -844.0989730975898
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.042184009162078
DONE TAKING  40  STEPS.
Total reward:  -695.322010316867
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.070255749024685
DONE TAKING  40  STEPS.
Total reward:  -562.9018808097799
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.14681769267726
DONE TAKING  40  STEPS.
Total reward:  -432.7697377598139
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -9.881882790271925
DONE TAKING  40  STEPS.
Total reward:  -357.55155723677154
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -18.30555650694801
DONE TAKING  40  STEPS.
Total reward:  -419.5613274687052
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.418194692342126
DONE TAKING  40  STEPS.
Total reward:  -625.165945495742
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -16.10820173272373
DONE TAKING  40  STEPS.
Total reward:  -316.44395512611317
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.587437631877098
DONE TAKING  40  STEPS.
Total reward:  -940.1084093240074
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.91902230315408
DONE TAKING  40  STEPS.
Total reward:  -449.3434349066407
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -18.403263209741382
DONE TAKING  40  STEPS.
Total reward:  -386.2035451516602
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.080973158332135
DONE TAKING  40  STEPS.
Total reward:  -1082.4480308789987
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -27.6113145121934
DONE TAKING  40  STEPS.
Total reward:  -763.0842912348108
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -20.450905871628244
DONE TAKING  40  STEPS.
Total reward:  -583.274436132101
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.394488456206567
DONE TAKING  40  STEPS.
Total reward:  -552.0281388412192
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -12.930759367034579
DONE TAKING  40  STEPS.
Total reward:  -412.7202094793265
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -13.36681767714749
DONE TAKING  40  STEPS.
Total reward:  -316.9188016528613
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 82
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  82
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.492652133891457
    val rand:  0
    val onPol:  0.3634376923243205

=== Epoch 10 ===
    train loss:  0.24001801615221457
    val rand:  0
    val onPol:  0.2932105263074239

=== Epoch 20 ===
    train loss:  0.2055223944940065
    val rand:  0
    val onPol:  0.286773053308328

=== Epoch 30 ===
    train loss:  0.18328767805768734
    val rand:  0
    val onPol:  0.29002921531597775

=== Epoch 39 ===
    train loss:  0.16702244574563546
    val rand:  0
    val onPol:  0.29400039960940677
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  82
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -16.0782324189464
DONE TAKING  40  STEPS.
Total reward:  -304.6439894541487
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -25.49652607864065
DONE TAKING  40  STEPS.
Total reward:  -557.5728535226142
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -12.442606622852406
DONE TAKING  40  STEPS.
Total reward:  -298.21905977247735
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.031634512209905
DONE TAKING  40  STEPS.
Total reward:  -541.1105994002043
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -18.81490029576067
DONE TAKING  40  STEPS.
Total reward:  -613.7947083697347
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.758117237295707
DONE TAKING  40  STEPS.
Total reward:  -522.8371079080072
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -12.632050726108798
DONE TAKING  40  STEPS.
Total reward:  -420.6948564644059
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.557964817185624
DONE TAKING  40  STEPS.
Total reward:  -219.33186555028038
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.68187953054894
DONE TAKING  40  STEPS.
Total reward:  -521.8880620038215
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -24.258373165018703
DONE TAKING  40  STEPS.
Total reward:  -888.1992938639635
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.859905827281647
DONE TAKING  40  STEPS.
Total reward:  -812.2937571833636
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.59388208717608
DONE TAKING  40  STEPS.
Total reward:  -699.6534071821449
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -26.708881980373743
DONE TAKING  40  STEPS.
Total reward:  -1057.1273068209155
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.724112091461595
DONE TAKING  40  STEPS.
Total reward:  -647.6906889426756
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.784426243082503
DONE TAKING  40  STEPS.
Total reward:  -345.54798702685855
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.442280034763805
DONE TAKING  40  STEPS.
Total reward:  -33.08784258668796
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.48268069323629
DONE TAKING  40  STEPS.
Total reward:  -707.7982198661955
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -17.239770989241993
DONE TAKING  40  STEPS.
Total reward:  -478.5249748226581
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.44487861081374
DONE TAKING  40  STEPS.
Total reward:  -766.0732543186637
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.586730286594648
DONE TAKING  40  STEPS.
Total reward:  -319.1757525828605
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -26.290296365478323
DONE TAKING  40  STEPS.
Total reward:  -358.38022670696176
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.58470490890286
DONE TAKING  40  STEPS.
Total reward:  -925.7179852504092
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.636263042288817
DONE TAKING  40  STEPS.
Total reward:  -781.694002519098
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.939526147824527
DONE TAKING  40  STEPS.
Total reward:  -476.70460978985597
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.7274940287556
DONE TAKING  40  STEPS.
Total reward:  -536.439366082454
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.931066381308344
DONE TAKING  40  STEPS.
Total reward:  -142.34917293767197
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -11.435393835686385
DONE TAKING  40  STEPS.
Total reward:  -294.95129648772996
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.20712144801488
DONE TAKING  40  STEPS.
Total reward:  -764.4542373956344
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -27.817699271572266
DONE TAKING  40  STEPS.
Total reward:  -815.2166250427287
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.730379711186902
DONE TAKING  40  STEPS.
Total reward:  -643.6703642062635
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -22.423755402940234
DONE TAKING  40  STEPS.
Total reward:  -393.27812974995385
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.17663593249932
DONE TAKING  40  STEPS.
Total reward:  -458.33608414842075
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -20.17108797520435
DONE TAKING  40  STEPS.
Total reward:  -388.40022107105415
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.121051443759793
DONE TAKING  40  STEPS.
Total reward:  -661.0130901729261
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.852657906863186
DONE TAKING  40  STEPS.
Total reward:  -937.509116399668
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -15.205734030272282
DONE TAKING  40  STEPS.
Total reward:  -442.71735675617157
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.3159556467216
DONE TAKING  40  STEPS.
Total reward:  -734.793408899442
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.566934050264138
DONE TAKING  40  STEPS.
Total reward:  -929.3718868748745
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -10.54134984298431
DONE TAKING  40  STEPS.
Total reward:  -407.06006249311156
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -23.65271753512175
DONE TAKING  40  STEPS.
Total reward:  -706.2471366354307
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 83
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  83
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.481980001717283
    val rand:  0
    val onPol:  0.3575342843929927

=== Epoch 10 ===
    train loss:  0.23580805800463023
    val rand:  0
    val onPol:  0.29221269736687344

=== Epoch 20 ===
    train loss:  0.20274660017406732
    val rand:  0
    val onPol:  0.2845936715602875

=== Epoch 30 ===
    train loss:  0.18222907342408834
    val rand:  0
    val onPol:  0.2888367275396983

=== Epoch 39 ===
    train loss:  0.16475371938002736
    val rand:  0
    val onPol:  0.2939751421411832
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  83
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -9.647698185025614
DONE TAKING  40  STEPS.
Total reward:  -235.00383418268197
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -15.677859419804228
DONE TAKING  40  STEPS.
Total reward:  -503.69042865333597
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -20.993076581908092
DONE TAKING  40  STEPS.
Total reward:  -352.7324017114451
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.34784996126196
DONE TAKING  40  STEPS.
Total reward:  -401.3404188347448
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -17.088812761173816
DONE TAKING  40  STEPS.
Total reward:  -333.01585287400036
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -25.68332970293106
DONE TAKING  40  STEPS.
Total reward:  -542.7428910839789
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -18.00967046439258
DONE TAKING  40  STEPS.
Total reward:  -451.70850793279413
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.1073170618134
DONE TAKING  40  STEPS.
Total reward:  -811.4390229664408
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.455051366955495
DONE TAKING  40  STEPS.
Total reward:  -398.4936705993437
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -12.219495380566674
DONE TAKING  40  STEPS.
Total reward:  -309.1744412430098
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.25101082631924
DONE TAKING  40  STEPS.
Total reward:  -650.8640861505253
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.750561686065573
DONE TAKING  40  STEPS.
Total reward:  -780.3389787765519
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.00094254962387
DONE TAKING  40  STEPS.
Total reward:  -520.7610964833211
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.207035788500647
DONE TAKING  40  STEPS.
Total reward:  -641.9736546410929
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.962101873057886
DONE TAKING  40  STEPS.
Total reward:  -482.7489416670945
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.500526682034067
DONE TAKING  40  STEPS.
Total reward:  -672.4628202684712
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.600301960516145
DONE TAKING  40  STEPS.
Total reward:  -557.0826071665289
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.028009069883623
DONE TAKING  40  STEPS.
Total reward:  -555.4361388709256
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -14.075747557414175
DONE TAKING  40  STEPS.
Total reward:  -312.0162968470886
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -26.42809478360703
DONE TAKING  40  STEPS.
Total reward:  -681.0885280813055
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -19.7659556768104
DONE TAKING  40  STEPS.
Total reward:  -472.4327690681828
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.230077069107478
DONE TAKING  40  STEPS.
Total reward:  -234.3506662750413
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.98014902623543
DONE TAKING  40  STEPS.
Total reward:  -769.7537387135465
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -26.576330633650805
DONE TAKING  40  STEPS.
Total reward:  -737.5510905460093
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.255758802237054
DONE TAKING  40  STEPS.
Total reward:  -314.08011427519045
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.341421750835337
DONE TAKING  40  STEPS.
Total reward:  -689.5447701059838
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.746228716737498
DONE TAKING  40  STEPS.
Total reward:  -284.9428090615084
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.93809501897644
DONE TAKING  40  STEPS.
Total reward:  -1122.8467002678274
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -25.893890380497314
DONE TAKING  40  STEPS.
Total reward:  -465.48963508991386
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -28.62169011976027
DONE TAKING  40  STEPS.
Total reward:  -278.97815419949177
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -14.146676511485005
DONE TAKING  40  STEPS.
Total reward:  -390.84558822757754
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.830085813589704
DONE TAKING  40  STEPS.
Total reward:  -631.1534783620401
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -26.049518160772944
DONE TAKING  40  STEPS.
Total reward:  -665.672753946952
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.800609831827124
DONE TAKING  40  STEPS.
Total reward:  -623.6707301897374
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -14.251031762664574
DONE TAKING  40  STEPS.
Total reward:  -301.9612963027599
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -15.65355181905511
DONE TAKING  40  STEPS.
Total reward:  -454.4563753096064
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -17.46725675180508
DONE TAKING  40  STEPS.
Total reward:  -662.1666593814048
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -20.45745619584073
DONE TAKING  40  STEPS.
Total reward:  -259.9228647973125
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -14.95055846757635
DONE TAKING  40  STEPS.
Total reward:  -361.30063644338753
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -20.51055665560622
DONE TAKING  40  STEPS.
Total reward:  -244.85625504770016
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 84
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  84
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4951769767100351
    val rand:  0
    val onPol:  0.3431730469067891

=== Epoch 10 ===
    train loss:  0.23983931593727648
    val rand:  0
    val onPol:  0.2744099274277687

=== Epoch 20 ===
    train loss:  0.20577889524008097
    val rand:  0
    val onPol:  0.26907814542452496

=== Epoch 30 ===
    train loss:  0.1824568444699572
    val rand:  0
    val onPol:  0.270142840842406

=== Epoch 39 ===
    train loss:  0.1671334544294759
    val rand:  0
    val onPol:  0.2775434230764707
Training duration: 14.32 s

#####################################
performing on-policy MPC rollouts... iter  84
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -26.403615084273156
DONE TAKING  40  STEPS.
Total reward:  -1080.0838850491725
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.8988098781429
DONE TAKING  40  STEPS.
Total reward:  -670.0655438871626
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -21.343669808517852
DONE TAKING  40  STEPS.
Total reward:  -600.6086622407371
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -18.10506125171524
DONE TAKING  40  STEPS.
Total reward:  -616.7692282978537
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -22.179477155983918
DONE TAKING  40  STEPS.
Total reward:  -789.1554022305135
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.140180498125375
DONE TAKING  40  STEPS.
Total reward:  -496.0725272977336
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.260276797735926
DONE TAKING  40  STEPS.
Total reward:  -257.92358813919253
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -18.61994212413666
DONE TAKING  40  STEPS.
Total reward:  -606.5704818935408
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -16.941662010726702
DONE TAKING  40  STEPS.
Total reward:  -493.09227325747594
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -12.527028823385766
DONE TAKING  40  STEPS.
Total reward:  -394.36418392947536
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -17.298280185646895
DONE TAKING  40  STEPS.
Total reward:  -464.279620506979
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.47428784147358
DONE TAKING  40  STEPS.
Total reward:  -769.0567591554429
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -31.385682598461017
DONE TAKING  40  STEPS.
Total reward:  -849.7776159521719
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.44264900276209
DONE TAKING  40  STEPS.
Total reward:  -939.5911764886746
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -21.07039731530567
DONE TAKING  40  STEPS.
Total reward:  -364.66879870938726
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -12.441456200012539
DONE TAKING  40  STEPS.
Total reward:  -297.133183578529
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -25.008101327884592
DONE TAKING  40  STEPS.
Total reward:  -536.5882615821993
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.838996630180763
DONE TAKING  40  STEPS.
Total reward:  -755.3802276028077
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.646897511071593
DONE TAKING  40  STEPS.
Total reward:  -878.2770116677945
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.117899909723985
DONE TAKING  40  STEPS.
Total reward:  -690.925156542938
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.544588020275505
DONE TAKING  40  STEPS.
Total reward:  -696.734485745418
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.010178822164264
DONE TAKING  40  STEPS.
Total reward:  -524.4518590451365
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.908560186806335
DONE TAKING  40  STEPS.
Total reward:  -443.10785216332977
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -21.205833649068268
DONE TAKING  40  STEPS.
Total reward:  -822.2161247577384
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.30348639055748
DONE TAKING  40  STEPS.
Total reward:  -517.2722623445501
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.733499669166815
DONE TAKING  40  STEPS.
Total reward:  -502.2352082963936
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.994236819356438
DONE TAKING  40  STEPS.
Total reward:  -748.9317168007847
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -12.248126768851694
DONE TAKING  40  STEPS.
Total reward:  -292.56186198418453
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -14.572725965721784
DONE TAKING  40  STEPS.
Total reward:  -349.54617180461435
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.670067349342286
DONE TAKING  40  STEPS.
Total reward:  -314.1562954876968
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.41457376293114
DONE TAKING  40  STEPS.
Total reward:  -902.9210848620374
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.871060812178698
DONE TAKING  40  STEPS.
Total reward:  -332.25776215344223
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.89729557017297
DONE TAKING  40  STEPS.
Total reward:  -360.0837366911307
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.188961442561773
DONE TAKING  40  STEPS.
Total reward:  -1093.1953555231032
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -17.802678876490123
DONE TAKING  40  STEPS.
Total reward:  -354.3155198755951
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -17.562283638186344
DONE TAKING  40  STEPS.
Total reward:  -356.6238249129932
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -16.513404936305903
DONE TAKING  40  STEPS.
Total reward:  -549.4673174721806
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -17.570634116260493
DONE TAKING  40  STEPS.
Total reward:  -420.6363515383533
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.434231308448418
DONE TAKING  40  STEPS.
Total reward:  -732.0057086747566
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -21.069157479288954
DONE TAKING  40  STEPS.
Total reward:  -580.0510925203497
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 85
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  85
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48574062397605494
    val rand:  0
    val onPol:  0.34865594903628033

=== Epoch 10 ===
    train loss:  0.23776957131268686
    val rand:  0
    val onPol:  0.28420772155125934

=== Epoch 20 ===
    train loss:  0.2029137974768354
    val rand:  0
    val onPol:  0.27832838147878647

=== Epoch 30 ===
    train loss:  0.17927369292367967
    val rand:  0
    val onPol:  0.2814593513806661

=== Epoch 39 ===
    train loss:  0.1620406709742128
    val rand:  0
    val onPol:  0.28794198979934055
Training duration: 14.18 s

#####################################
performing on-policy MPC rollouts... iter  85
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.600392592985735
DONE TAKING  40  STEPS.
Total reward:  -534.480107745258
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -30.32763660101965
DONE TAKING  40  STEPS.
Total reward:  -643.0785482283084
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.92826251008937
DONE TAKING  40  STEPS.
Total reward:  -923.5819611636167
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.557798141245144
DONE TAKING  40  STEPS.
Total reward:  -833.2842479481149
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -18.56359587019297
DONE TAKING  40  STEPS.
Total reward:  -565.2784412068991
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.527841428320656
DONE TAKING  40  STEPS.
Total reward:  -949.8470127914667
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.917423222374033
DONE TAKING  40  STEPS.
Total reward:  -478.9736077932795
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -29.19240604577032
DONE TAKING  40  STEPS.
Total reward:  -911.5089987126079
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.687292857714148
DONE TAKING  40  STEPS.
Total reward:  -545.222908638554
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.172842688658328
DONE TAKING  40  STEPS.
Total reward:  -893.6538039656552
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.197862623518816
DONE TAKING  40  STEPS.
Total reward:  -162.8152959937921
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.019369618128877
DONE TAKING  40  STEPS.
Total reward:  -622.9774403732932
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -24.881196978860217
DONE TAKING  40  STEPS.
Total reward:  -901.9400915788419
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.83880360022462
DONE TAKING  40  STEPS.
Total reward:  -738.0945710353888
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -16.550720631681212
DONE TAKING  40  STEPS.
Total reward:  -460.32161575973475
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.69288629858876
DONE TAKING  40  STEPS.
Total reward:  -838.9980387195767
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.455854680420334
DONE TAKING  40  STEPS.
Total reward:  -753.9043289056287
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.611975037495
DONE TAKING  40  STEPS.
Total reward:  -520.5094449450273
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.426930102061633
DONE TAKING  40  STEPS.
Total reward:  -450.8423099839085
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.768224342478863
DONE TAKING  40  STEPS.
Total reward:  -674.0489681047372
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -19.848560143398633
DONE TAKING  40  STEPS.
Total reward:  -667.6269791225475
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -12.535887566119959
DONE TAKING  40  STEPS.
Total reward:  -414.31339673198363
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -24.998532738451967
DONE TAKING  40  STEPS.
Total reward:  -636.2178037556806
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -19.92840855704548
DONE TAKING  40  STEPS.
Total reward:  -336.0872442374501
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -26.757427228896198
DONE TAKING  40  STEPS.
Total reward:  -877.9430535909422
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -13.01354104231386
DONE TAKING  40  STEPS.
Total reward:  -291.59465045461945
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -22.59074173818842
DONE TAKING  40  STEPS.
Total reward:  -369.8487488161052
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.597492472992563
DONE TAKING  40  STEPS.
Total reward:  -673.7558780830583
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.794219627718768
DONE TAKING  40  STEPS.
Total reward:  -879.4294199080357
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.710261045141326
DONE TAKING  40  STEPS.
Total reward:  -787.396705352253
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.308702662950378
DONE TAKING  40  STEPS.
Total reward:  -766.7795897305817
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -31.304471902770512
DONE TAKING  40  STEPS.
Total reward:  -806.7526657313973
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -25.529606972495564
DONE TAKING  40  STEPS.
Total reward:  -544.9046830739015
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.33868821848151
DONE TAKING  40  STEPS.
Total reward:  -76.7726293274707
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.222664912981365
DONE TAKING  40  STEPS.
Total reward:  -674.969087090771
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.565893989888735
DONE TAKING  40  STEPS.
Total reward:  -1019.2896653868654
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -15.29065460713019
DONE TAKING  40  STEPS.
Total reward:  -344.69814054778476
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.985900832765143
DONE TAKING  40  STEPS.
Total reward:  -1011.8645394825558
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.729644555032422
DONE TAKING  40  STEPS.
Total reward:  -833.6024265913436
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.485021008064237
DONE TAKING  40  STEPS.
Total reward:  -824.6837494212771
Time for 1 rollout: 1.02 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 86
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  86
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4927984502231866
    val rand:  0
    val onPol:  0.3485114226738612

=== Epoch 10 ===
    train loss:  0.2364609251942551
    val rand:  0
    val onPol:  0.2771894633769989

=== Epoch 20 ===
    train loss:  0.20437905061663242
    val rand:  0
    val onPol:  0.272687961657842

=== Epoch 30 ===
    train loss:  0.18072637628045
    val rand:  0
    val onPol:  0.27604759732882184

=== Epoch 39 ===
    train loss:  0.16447075678591142
    val rand:  0
    val onPol:  0.27903540680805844
Training duration: 14.23 s

#####################################
performing on-policy MPC rollouts... iter  86
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -11.267749251751198
DONE TAKING  40  STEPS.
Total reward:  -348.6722059453082
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.95039933613375
DONE TAKING  40  STEPS.
Total reward:  -973.3806147953392
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.708207318983117
DONE TAKING  40  STEPS.
Total reward:  -979.5522551545829
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.384571415707864
DONE TAKING  40  STEPS.
Total reward:  -361.26813776707326
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.027048705433867
DONE TAKING  40  STEPS.
Total reward:  -1041.9074768858761
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -29.436193685915487
DONE TAKING  40  STEPS.
Total reward:  -895.1448228498539
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.42303138463371
DONE TAKING  40  STEPS.
Total reward:  -843.8858795244013
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -24.405717687117104
DONE TAKING  40  STEPS.
Total reward:  -992.4538251359751
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.545891677525418
DONE TAKING  40  STEPS.
Total reward:  -749.1587909827985
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.474577712524038
DONE TAKING  40  STEPS.
Total reward:  -649.4826964564692
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.9220339157736
DONE TAKING  40  STEPS.
Total reward:  -557.2373378825757
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.734931443005202
DONE TAKING  40  STEPS.
Total reward:  -519.0489771249986
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.22175554951089
DONE TAKING  40  STEPS.
Total reward:  -540.6907901502518
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.20184250979677
DONE TAKING  40  STEPS.
Total reward:  -858.5504063441962
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -17.020565573911362
DONE TAKING  40  STEPS.
Total reward:  -351.34403137095495
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.59446444558159
DONE TAKING  40  STEPS.
Total reward:  -493.4879741327757
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.249803933869917
DONE TAKING  40  STEPS.
Total reward:  -509.44630410230593
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.288215100124322
DONE TAKING  40  STEPS.
Total reward:  -524.7179249313997
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -19.73092741838721
DONE TAKING  40  STEPS.
Total reward:  -656.9539737213238
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.321708614682606
DONE TAKING  40  STEPS.
Total reward:  -392.55945505115045
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -15.826019388197349
DONE TAKING  40  STEPS.
Total reward:  -358.4301300341262
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.015901515821383
DONE TAKING  40  STEPS.
Total reward:  -724.3541960685418
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.155255406289402
DONE TAKING  40  STEPS.
Total reward:  -361.48022870963985
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.29223948085986
DONE TAKING  40  STEPS.
Total reward:  -255.3668024957371
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.344727168226484
DONE TAKING  40  STEPS.
Total reward:  -605.4002610102693
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -15.662215304675671
DONE TAKING  40  STEPS.
Total reward:  -325.7617372772182
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -12.059215866838217
DONE TAKING  40  STEPS.
Total reward:  -357.2221824289766
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -21.9255852484575
DONE TAKING  40  STEPS.
Total reward:  -401.3058726859542
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.52267447367339
DONE TAKING  40  STEPS.
Total reward:  -747.5570372950282
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.92791000911605
DONE TAKING  40  STEPS.
Total reward:  -230.95222263843414
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -9.961423633856166
DONE TAKING  40  STEPS.
Total reward:  -430.1639616697117
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -27.64402902596057
DONE TAKING  40  STEPS.
Total reward:  -829.887199737673
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.839793852526622
DONE TAKING  40  STEPS.
Total reward:  -576.7051063741854
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -18.015339606699357
DONE TAKING  40  STEPS.
Total reward:  -257.73304951449336
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.99184791728233
DONE TAKING  40  STEPS.
Total reward:  -723.259363814163
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -17.449154766131358
DONE TAKING  40  STEPS.
Total reward:  -566.2823798802608
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.653607566546476
DONE TAKING  40  STEPS.
Total reward:  -714.9850047942107
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.712054879419163
DONE TAKING  40  STEPS.
Total reward:  -541.0471795052831
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -25.787655979880697
DONE TAKING  40  STEPS.
Total reward:  -485.29888026944803
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -27.86772084637597
DONE TAKING  40  STEPS.
Total reward:  -652.6660705719721
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 87
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  87
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.491521790362241
    val rand:  0
    val onPol:  0.33952051897843677

=== Epoch 10 ===
    train loss:  0.23791417505657464
    val rand:  0
    val onPol:  0.2740529924631119

=== Epoch 20 ===
    train loss:  0.20429629165875285
    val rand:  0
    val onPol:  0.2690849353869756

=== Epoch 30 ===
    train loss:  0.17962254949829035
    val rand:  0
    val onPol:  0.27232295274734497

=== Epoch 39 ===
    train loss:  0.16359000404675803
    val rand:  0
    val onPol:  0.2777262181043625
Training duration: 14.25 s

#####################################
performing on-policy MPC rollouts... iter  87
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.88988430920356
DONE TAKING  40  STEPS.
Total reward:  -431.0728665385128
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.069136981514795
DONE TAKING  40  STEPS.
Total reward:  -908.7732741368822
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.651394475224793
DONE TAKING  40  STEPS.
Total reward:  -308.788793022273
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.372361283319652
DONE TAKING  40  STEPS.
Total reward:  -383.7510773937016
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -30.960668665253664
DONE TAKING  40  STEPS.
Total reward:  -930.9647671319212
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -13.119247809935285
DONE TAKING  40  STEPS.
Total reward:  185.4095597139172
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -16.699576970782427
DONE TAKING  40  STEPS.
Total reward:  -648.9590592278976
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.5875531149763
DONE TAKING  40  STEPS.
Total reward:  -571.7502893711754
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -13.456752302991832
DONE TAKING  40  STEPS.
Total reward:  -427.3577325792589
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.988521270100946
DONE TAKING  40  STEPS.
Total reward:  -606.4531807128218
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.388161409289577
DONE TAKING  40  STEPS.
Total reward:  -820.4178768425277
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -15.440272283011119
DONE TAKING  40  STEPS.
Total reward:  -425.12766901766724
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.958129457328905
DONE TAKING  40  STEPS.
Total reward:  -482.2131731080027
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -30.92527881703507
DONE TAKING  40  STEPS.
Total reward:  -749.6425958170909
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.393657653883043
DONE TAKING  40  STEPS.
Total reward:  -335.18294427997205
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -10.481560618756887
DONE TAKING  40  STEPS.
Total reward:  56.385285331929474
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.10594636219193
DONE TAKING  40  STEPS.
Total reward:  -869.4903454312895
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.024831121003036
DONE TAKING  40  STEPS.
Total reward:  -1029.1748797284558
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -26.445904252145105
DONE TAKING  40  STEPS.
Total reward:  -627.7724376020923
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.87764285235018
DONE TAKING  40  STEPS.
Total reward:  -590.1096044996813
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.561063437749933
DONE TAKING  40  STEPS.
Total reward:  -509.7438468768261
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -9.947474260588315
DONE TAKING  40  STEPS.
Total reward:  -392.01863846208624
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -19.301923408502624
DONE TAKING  40  STEPS.
Total reward:  -443.08563442353227
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.60547894546559
DONE TAKING  40  STEPS.
Total reward:  -729.8739561498636
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.54500896747498
DONE TAKING  40  STEPS.
Total reward:  -720.4005946038732
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.26032233336777
DONE TAKING  40  STEPS.
Total reward:  -468.18261836248683
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -12.069625399890924
DONE TAKING  40  STEPS.
Total reward:  -483.24628334622827
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -30.011129892671896
DONE TAKING  40  STEPS.
Total reward:  -659.4801007656442
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -23.35572150049604
DONE TAKING  40  STEPS.
Total reward:  -790.210390874088
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.09056800596758
DONE TAKING  40  STEPS.
Total reward:  -833.8475226706664
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.5387886337463
DONE TAKING  40  STEPS.
Total reward:  -445.61412509571596
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -16.058811053561463
DONE TAKING  40  STEPS.
Total reward:  -245.94887724998785
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -21.022308446160487
DONE TAKING  40  STEPS.
Total reward:  -331.18904771016895
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -13.636966467582512
DONE TAKING  40  STEPS.
Total reward:  -350.6839486076281
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -27.89937055454166
DONE TAKING  40  STEPS.
Total reward:  -850.3127680134231
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.084831399229525
DONE TAKING  40  STEPS.
Total reward:  -657.7020425780352
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.782932681516307
DONE TAKING  40  STEPS.
Total reward:  -278.79323908026544
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.135147315389922
DONE TAKING  40  STEPS.
Total reward:  -980.353905760642
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.858018069823984
DONE TAKING  40  STEPS.
Total reward:  -689.8477643755577
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.935884719423512
DONE TAKING  40  STEPS.
Total reward:  -182.28962360084185
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 88
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  88
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49409424056086626
    val rand:  0
    val onPol:  0.34271304806073505

=== Epoch 10 ===
    train loss:  0.23610266729405052
    val rand:  0
    val onPol:  0.2762150739630063

=== Epoch 20 ===
    train loss:  0.20234293111583643
    val rand:  0
    val onPol:  0.27271371831496555

=== Epoch 30 ===
    train loss:  0.17935232582845187
    val rand:  0
    val onPol:  0.27547989785671234

=== Epoch 39 ===
    train loss:  0.16496987640857697
    val rand:  0
    val onPol:  0.2805155689517657
Training duration: 14.26 s

#####################################
performing on-policy MPC rollouts... iter  88
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -15.098991444967027
DONE TAKING  40  STEPS.
Total reward:  -350.8881853421338
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -29.031207185385597
DONE TAKING  40  STEPS.
Total reward:  -603.122656751373
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -30.037444512299864
DONE TAKING  40  STEPS.
Total reward:  -818.7148506325958
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -21.429583683914974
DONE TAKING  40  STEPS.
Total reward:  -609.3568873871988
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.395488220654684
DONE TAKING  40  STEPS.
Total reward:  -677.4422039480854
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.943749956055015
DONE TAKING  40  STEPS.
Total reward:  -828.2938379195862
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.63824743875747
DONE TAKING  40  STEPS.
Total reward:  -310.7946352500363
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -25.788291556214077
DONE TAKING  40  STEPS.
Total reward:  -1027.0071727935472
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -25.733774407658856
DONE TAKING  40  STEPS.
Total reward:  -851.9489179159302
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -18.185300932822372
DONE TAKING  40  STEPS.
Total reward:  -365.4385537686715
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -14.637445058695661
DONE TAKING  40  STEPS.
Total reward:  -510.0898611312623
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -21.601805049427576
DONE TAKING  40  STEPS.
Total reward:  -383.8232671540721
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -19.959073566796146
DONE TAKING  40  STEPS.
Total reward:  -417.6303511434806
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.899331456037046
DONE TAKING  40  STEPS.
Total reward:  -578.2319572692701
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.1497273607563
DONE TAKING  40  STEPS.
Total reward:  -552.7333926755285
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -18.923674078563046
DONE TAKING  40  STEPS.
Total reward:  -687.3567810721975
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -30.319574860983643
DONE TAKING  40  STEPS.
Total reward:  -655.6266953906497
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -18.76305595981295
DONE TAKING  40  STEPS.
Total reward:  -386.7827371955881
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.303937334658078
DONE TAKING  40  STEPS.
Total reward:  -334.69173003522644
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -18.461259327679855
DONE TAKING  40  STEPS.
Total reward:  -481.98356661133886
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.20933295271886
DONE TAKING  40  STEPS.
Total reward:  -346.1268413442802
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -30.66444014261133
DONE TAKING  40  STEPS.
Total reward:  -850.3803754147664
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.10293486469486
DONE TAKING  40  STEPS.
Total reward:  -401.80953835202223
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.867333536461075
DONE TAKING  40  STEPS.
Total reward:  -757.0902655356055
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.661588080350896
DONE TAKING  40  STEPS.
Total reward:  -714.7060881906472
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.654294944307722
DONE TAKING  40  STEPS.
Total reward:  -770.7065874690016
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.047493118643136
DONE TAKING  40  STEPS.
Total reward:  -556.8686053978377
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.187046291722655
DONE TAKING  40  STEPS.
Total reward:  -723.8837486913201
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.189220803658486
DONE TAKING  40  STEPS.
Total reward:  -613.6958534010686
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -20.521916402610323
DONE TAKING  40  STEPS.
Total reward:  -837.834155410727
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -17.40495786029932
DONE TAKING  40  STEPS.
Total reward:  -428.2258531205843
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.431206386895795
DONE TAKING  40  STEPS.
Total reward:  -528.6013296395502
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -13.061930815956968
DONE TAKING  40  STEPS.
Total reward:  -268.7666436654088
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -24.479074241148993
DONE TAKING  40  STEPS.
Total reward:  -355.563826511242
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.694813500098086
DONE TAKING  40  STEPS.
Total reward:  -867.9579446116921
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -11.442254449831523
DONE TAKING  40  STEPS.
Total reward:  -396.4999923528337
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.92946422096109
DONE TAKING  40  STEPS.
Total reward:  -569.123415439066
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -10.520403997095693
DONE TAKING  40  STEPS.
Total reward:  -166.36930932365925
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -29.740988767091746
DONE TAKING  40  STEPS.
Total reward:  -796.7258297947012
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.178814109975544
DONE TAKING  40  STEPS.
Total reward:  -341.9483483895662
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 89
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  89
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4894713346372571
    val rand:  0
    val onPol:  0.3433932016293208

=== Epoch 10 ===
    train loss:  0.2363530467999609
    val rand:  0
    val onPol:  0.27857033411661786

=== Epoch 20 ===
    train loss:  0.2054862257158547
    val rand:  0
    val onPol:  0.273555984099706

=== Epoch 30 ===
    train loss:  0.17862228552500406
    val rand:  0
    val onPol:  0.2744356840848923

=== Epoch 39 ===
    train loss:  0.16366944318277793
    val rand:  0
    val onPol:  0.2793984164794286
Training duration: 14.21 s

#####################################
performing on-policy MPC rollouts... iter  89
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.919849719508107
DONE TAKING  40  STEPS.
Total reward:  -803.6415750462629
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -13.329044303448285
DONE TAKING  40  STEPS.
Total reward:  -449.7845603940354
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -16.228453206631293
DONE TAKING  40  STEPS.
Total reward:  -450.8247595818892
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -19.753044337705532
DONE TAKING  40  STEPS.
Total reward:  -298.19669354803176
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.122412783744796
DONE TAKING  40  STEPS.
Total reward:  -1048.4271046522674
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.75581643520807
DONE TAKING  40  STEPS.
Total reward:  -257.1779459419806
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.336906330615406
DONE TAKING  40  STEPS.
Total reward:  -1143.110803373576
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.68202808287538
DONE TAKING  40  STEPS.
Total reward:  -707.4645707295771
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -24.8651391865367
DONE TAKING  40  STEPS.
Total reward:  -610.6690256708218
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -24.106858409792167
DONE TAKING  40  STEPS.
Total reward:  -685.3726273859996
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.447870177525743
DONE TAKING  40  STEPS.
Total reward:  -474.96683072870644
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.01795172076126
DONE TAKING  40  STEPS.
Total reward:  -804.5193801067206
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -31.100308247208712
DONE TAKING  40  STEPS.
Total reward:  -949.9124206295369
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -27.347472428979458
DONE TAKING  40  STEPS.
Total reward:  -516.210979675359
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -15.35202660005224
DONE TAKING  40  STEPS.
Total reward:  -230.59916975139745
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -21.186828346189177
DONE TAKING  40  STEPS.
Total reward:  -310.02790688493695
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.153911250511545
DONE TAKING  40  STEPS.
Total reward:  -1184.0842203249445
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -27.86995676688978
DONE TAKING  40  STEPS.
Total reward:  -951.1528880717115
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -9.203039896500654
DONE TAKING  40  STEPS.
Total reward:  -204.08402481579822
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.37881865191681
DONE TAKING  40  STEPS.
Total reward:  -929.2094499141226
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.91470966823811
DONE TAKING  40  STEPS.
Total reward:  -622.6632792954597
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.23882368657561
DONE TAKING  40  STEPS.
Total reward:  -567.6645892970264
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -14.49617157459392
DONE TAKING  40  STEPS.
Total reward:  -342.59111884478654
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.57887089371501
DONE TAKING  40  STEPS.
Total reward:  -283.87345078037526
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.07765215134026
DONE TAKING  40  STEPS.
Total reward:  -418.4527889792448
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.256067681557084
DONE TAKING  40  STEPS.
Total reward:  -457.23397412803166
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.179898444873352
DONE TAKING  40  STEPS.
Total reward:  -692.0340441631699
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.082560718704002
DONE TAKING  40  STEPS.
Total reward:  -513.8776939924419
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.697888130690703
DONE TAKING  40  STEPS.
Total reward:  -80.37337574851736
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.139470053805397
DONE TAKING  40  STEPS.
Total reward:  -739.5054932699085
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.714526116621215
DONE TAKING  40  STEPS.
Total reward:  -492.22195268931506
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.25730023752097
DONE TAKING  40  STEPS.
Total reward:  -281.0683363610431
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -19.69649188571717
DONE TAKING  40  STEPS.
Total reward:  -553.6662183482972
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.05819341810579
DONE TAKING  40  STEPS.
Total reward:  -333.42671655316707
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -14.690218999895643
DONE TAKING  40  STEPS.
Total reward:  -293.0550221141391
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.763688283751236
DONE TAKING  40  STEPS.
Total reward:  -628.7091532440049
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -13.12303017060442
DONE TAKING  40  STEPS.
Total reward:  -266.5080579470585
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.3222604667145
DONE TAKING  40  STEPS.
Total reward:  -655.9812852637799
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -13.717926863766667
DONE TAKING  40  STEPS.
Total reward:  -413.9590161633791
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -27.59201763282313
DONE TAKING  40  STEPS.
Total reward:  -750.5182648323807
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 90
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  90
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4928467749503621
    val rand:  0
    val onPol:  0.36067458242177963

=== Epoch 10 ===
    train loss:  0.23564411020069792
    val rand:  0
    val onPol:  0.2890609602133433

=== Epoch 20 ===
    train loss:  0.20682657418543832
    val rand:  0
    val onPol:  0.28515922526518506

=== Epoch 30 ===
    train loss:  0.18083209531349048
    val rand:  0
    val onPol:  0.2885155851642291

=== Epoch 39 ===
    train loss:  0.16459430022197857
    val rand:  0
    val onPol:  0.29058270156383514
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  90
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -31.1640655981951
DONE TAKING  40  STEPS.
Total reward:  -807.4834615848811
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -19.693364308755722
DONE TAKING  40  STEPS.
Total reward:  -533.2871731469114
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -26.003945149673854
DONE TAKING  40  STEPS.
Total reward:  -840.8261899119678
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -12.306470454012242
DONE TAKING  40  STEPS.
Total reward:  -348.8375477999967
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.77787866804429
DONE TAKING  40  STEPS.
Total reward:  -369.83021618449834
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -31.15777170324078
DONE TAKING  40  STEPS.
Total reward:  -611.1857893063632
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.622831983462444
DONE TAKING  40  STEPS.
Total reward:  -644.021739165645
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -18.525275993792555
DONE TAKING  40  STEPS.
Total reward:  -404.351024019742
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -24.41838516137549
DONE TAKING  40  STEPS.
Total reward:  -666.4926563654549
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.252400923791555
DONE TAKING  40  STEPS.
Total reward:  -910.2916247749213
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -26.069720854505775
DONE TAKING  40  STEPS.
Total reward:  -942.5714017821716
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.861459129494968
DONE TAKING  40  STEPS.
Total reward:  -817.7911130846182
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.801995386376994
DONE TAKING  40  STEPS.
Total reward:  -559.7512909915063
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.169764079972545
DONE TAKING  40  STEPS.
Total reward:  -537.3200933023476
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -13.099815163416146
DONE TAKING  40  STEPS.
Total reward:  -335.6218170374108
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.905660995221215
DONE TAKING  40  STEPS.
Total reward:  -614.1499406465758
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.042492060631247
DONE TAKING  40  STEPS.
Total reward:  -287.73137378502895
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -14.100802368073904
DONE TAKING  40  STEPS.
Total reward:  -432.73732567380745
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -24.125634268481242
DONE TAKING  40  STEPS.
Total reward:  -803.148314279492
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.82639467100155
DONE TAKING  40  STEPS.
Total reward:  -912.6194848204223
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.791454064564412
DONE TAKING  40  STEPS.
Total reward:  -470.11085060928065
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -15.489084190095571
DONE TAKING  40  STEPS.
Total reward:  -393.2370468114227
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -17.48661258050679
DONE TAKING  40  STEPS.
Total reward:  -497.01268629791537
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -17.360998064518807
DONE TAKING  40  STEPS.
Total reward:  -654.1327504034722
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.921099852387307
DONE TAKING  40  STEPS.
Total reward:  -485.23614271750785
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.097319630907407
DONE TAKING  40  STEPS.
Total reward:  -840.9888107718338
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.40432852889632
DONE TAKING  40  STEPS.
Total reward:  -791.7161045440148
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.494829382069586
DONE TAKING  40  STEPS.
Total reward:  -675.8122281390772
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.796903729450584
DONE TAKING  40  STEPS.
Total reward:  -843.3934661680394
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.176184827275584
DONE TAKING  40  STEPS.
Total reward:  -732.7310203844497
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.202859624082805
DONE TAKING  40  STEPS.
Total reward:  -976.8400253611387
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.483685325010395
DONE TAKING  40  STEPS.
Total reward:  -626.1678133784278
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -31.022298960259114
DONE TAKING  40  STEPS.
Total reward:  -709.4074297222498
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -26.394320214889618
DONE TAKING  40  STEPS.
Total reward:  -686.2462207171423
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.878079324104093
DONE TAKING  40  STEPS.
Total reward:  -957.4831058927207
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.690342169172176
DONE TAKING  40  STEPS.
Total reward:  -837.2193841560082
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.885171180332165
DONE TAKING  40  STEPS.
Total reward:  -971.196337509696
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.71053260315866
DONE TAKING  40  STEPS.
Total reward:  -751.2414064519896
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.28258062213112
DONE TAKING  40  STEPS.
Total reward:  -538.5028198363489
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.169373698385385
DONE TAKING  40  STEPS.
Total reward:  -527.3381945201332
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 91
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  91
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4952719279548578
    val rand:  0
    val onPol:  0.3641758859157562

=== Epoch 10 ===
    train loss:  0.2357579297141025
    val rand:  0
    val onPol:  0.29317549367745716

=== Epoch 20 ===
    train loss:  0.20524345338344574
    val rand:  0
    val onPol:  0.2900641808907191

=== Epoch 30 ===
    train loss:  0.18433531569807152
    val rand:  0
    val onPol:  0.29397545009851456

=== Epoch 39 ===
    train loss:  0.164638128196984
    val rand:  0
    val onPol:  0.2986217687527339
Training duration: 14.24 s

#####################################
performing on-policy MPC rollouts... iter  91
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.512301760315765
DONE TAKING  40  STEPS.
Total reward:  -766.4354751907531
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -16.40730538426937
DONE TAKING  40  STEPS.
Total reward:  -382.5067540450491
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.160310191750714
DONE TAKING  40  STEPS.
Total reward:  -875.4714318954364
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.479270981188503
DONE TAKING  40  STEPS.
Total reward:  -614.5491310933885
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -16.02921252541226
DONE TAKING  40  STEPS.
Total reward:  -393.52554824986885
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -31.082257497126736
DONE TAKING  40  STEPS.
Total reward:  -707.9172195296583
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -29.744558883623604
DONE TAKING  40  STEPS.
Total reward:  -839.3874861354085
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.683407787727614
DONE TAKING  40  STEPS.
Total reward:  -970.7096983464128
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.06808989076879
DONE TAKING  40  STEPS.
Total reward:  -611.595329116275
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.404923127297366
DONE TAKING  40  STEPS.
Total reward:  -504.187376651931
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.9139957991227
DONE TAKING  40  STEPS.
Total reward:  -669.1949684004499
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -23.059647071962196
DONE TAKING  40  STEPS.
Total reward:  -640.367487849035
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.060090799191908
DONE TAKING  40  STEPS.
Total reward:  -477.8646280413172
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -22.12526984654659
DONE TAKING  40  STEPS.
Total reward:  -480.1010324879675
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -25.008295772064102
DONE TAKING  40  STEPS.
Total reward:  -321.95662410363997
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.79200873791293
DONE TAKING  40  STEPS.
Total reward:  -511.2413150667924
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -18.53185314359053
DONE TAKING  40  STEPS.
Total reward:  -690.9449795709938
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.105416771734138
DONE TAKING  40  STEPS.
Total reward:  -482.3419459829512
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.486770094880853
DONE TAKING  40  STEPS.
Total reward:  -200.8638120419603
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -16.560836713736528
DONE TAKING  40  STEPS.
Total reward:  -542.0344274681244
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.639752513935058
DONE TAKING  40  STEPS.
Total reward:  -657.1218909399659
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.612649036579825
DONE TAKING  40  STEPS.
Total reward:  -758.3071855901107
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.575813568403348
DONE TAKING  40  STEPS.
Total reward:  -467.37894213329014
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -19.20126836367954
DONE TAKING  40  STEPS.
Total reward:  -459.3328723363263
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.391936930430614
DONE TAKING  40  STEPS.
Total reward:  -687.866666754759
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.25208979881105
DONE TAKING  40  STEPS.
Total reward:  -578.9206382903724
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.454320740902425
DONE TAKING  40  STEPS.
Total reward:  -750.4784839831168
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -25.633500370308404
DONE TAKING  40  STEPS.
Total reward:  -372.93944948587097
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -16.452324559300685
DONE TAKING  40  STEPS.
Total reward:  -375.798421586037
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -25.29058463428344
DONE TAKING  40  STEPS.
Total reward:  -835.8333590136579
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.22462552578458
DONE TAKING  40  STEPS.
Total reward:  -412.7097207258295
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -26.921179322435744
DONE TAKING  40  STEPS.
Total reward:  -875.9106218372358
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.03907115451089
DONE TAKING  40  STEPS.
Total reward:  -225.88731241402536
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.95610846450466
DONE TAKING  40  STEPS.
Total reward:  -846.55177062181
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.886062111313596
DONE TAKING  40  STEPS.
Total reward:  -598.6116833672172
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -30.819775148844293
DONE TAKING  40  STEPS.
Total reward:  -1007.3128963445323
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.8121707307267
DONE TAKING  40  STEPS.
Total reward:  -672.2669522615691
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.5942699304731
DONE TAKING  40  STEPS.
Total reward:  -615.0403596018407
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.046603659000828
DONE TAKING  40  STEPS.
Total reward:  -300.40397025655676
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -22.458550382613453
DONE TAKING  40  STEPS.
Total reward:  -916.7230663262902
Time for 1 rollout: 1.03 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 92
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  92
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48968632074824553
    val rand:  0
    val onPol:  0.35559355715910596

=== Epoch 10 ===
    train loss:  0.23815515140692392
    val rand:  0
    val onPol:  0.2868613948424657

=== Epoch 20 ===
    train loss:  0.2044190455947006
    val rand:  0
    val onPol:  0.2835426578919093

=== Epoch 30 ===
    train loss:  0.18212862234366567
    val rand:  0
    val onPol:  0.2870618800322215

=== Epoch 39 ===
    train loss:  0.1643023205953732
    val rand:  0
    val onPol:  0.29200320442517597
Training duration: 14.32 s

#####################################
performing on-policy MPC rollouts... iter  92
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -10.366255148385273
DONE TAKING  40  STEPS.
Total reward:  -289.358828605856
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.463545197365228
DONE TAKING  40  STEPS.
Total reward:  -152.5238939795351
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -18.944470603861866
DONE TAKING  40  STEPS.
Total reward:  -20.030289400373455
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -28.60320861855842
DONE TAKING  40  STEPS.
Total reward:  -628.4845508874788
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.06372507707128
DONE TAKING  40  STEPS.
Total reward:  -915.8662070909361
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.185011772923833
DONE TAKING  40  STEPS.
Total reward:  -902.6141250499303
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.73869403348159
DONE TAKING  40  STEPS.
Total reward:  -512.9487744486162
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.578358533681595
DONE TAKING  40  STEPS.
Total reward:  -659.7338663795753
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -21.772307033201944
DONE TAKING  40  STEPS.
Total reward:  -531.1627016142478
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.056939332800482
DONE TAKING  40  STEPS.
Total reward:  -976.7715464973322
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -16.620079444036527
DONE TAKING  40  STEPS.
Total reward:  -484.27843788898485
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.750213995183252
DONE TAKING  40  STEPS.
Total reward:  -591.9262907122459
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -19.317660234923338
DONE TAKING  40  STEPS.
Total reward:  -956.6739394070602
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.523485442276844
DONE TAKING  40  STEPS.
Total reward:  -638.9148068714608
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.5194191355563
DONE TAKING  40  STEPS.
Total reward:  -106.82539937778319
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.365692123326983
DONE TAKING  40  STEPS.
Total reward:  -656.967237286261
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -21.269015632685896
DONE TAKING  40  STEPS.
Total reward:  -675.1115701742725
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.301777740905038
DONE TAKING  40  STEPS.
Total reward:  -221.85806146744005
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -17.81462024081037
DONE TAKING  40  STEPS.
Total reward:  6.3216193848053015
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.295949963504583
DONE TAKING  40  STEPS.
Total reward:  -932.4100972397533
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.703951849324824
DONE TAKING  40  STEPS.
Total reward:  -564.2059744014792
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.243850692291858
DONE TAKING  40  STEPS.
Total reward:  -821.970642235628
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.51253048536826
DONE TAKING  40  STEPS.
Total reward:  -632.541478133158
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.508413950116008
DONE TAKING  40  STEPS.
Total reward:  -772.9573844063967
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.165390038206862
DONE TAKING  40  STEPS.
Total reward:  -259.81425637822946
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.709084019957807
DONE TAKING  40  STEPS.
Total reward:  -359.5192203868594
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -17.360525286550306
DONE TAKING  40  STEPS.
Total reward:  -681.0791252959659
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.035571148333073
DONE TAKING  40  STEPS.
Total reward:  -639.261692567908
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -31.026619010089128
DONE TAKING  40  STEPS.
Total reward:  -755.9287879856035
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -11.49454937331772
DONE TAKING  40  STEPS.
Total reward:  -256.9024186012226
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.673843491058285
DONE TAKING  40  STEPS.
Total reward:  -300.73569493408
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.83521862224594
DONE TAKING  40  STEPS.
Total reward:  -588.3878793351182
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -22.215451256229287
DONE TAKING  40  STEPS.
Total reward:  -864.2098005232093
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.301440698004953
DONE TAKING  40  STEPS.
Total reward:  -722.0999948457863
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.319836290757113
DONE TAKING  40  STEPS.
Total reward:  49.3827152523974
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.85008441436793
DONE TAKING  40  STEPS.
Total reward:  -148.73345407684997
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.69986250625079
DONE TAKING  40  STEPS.
Total reward:  -792.6174070842325
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -24.337821109433534
DONE TAKING  40  STEPS.
Total reward:  -307.1304006973297
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -31.313555628083996
DONE TAKING  40  STEPS.
Total reward:  -643.015304991086
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -24.11927027678855
DONE TAKING  40  STEPS.
Total reward:  -415.87857050741655
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 93
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  93
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.48540804783503216
    val rand:  0
    val onPol:  0.35957121104002

=== Epoch 10 ===
    train loss:  0.24024421813195213
    val rand:  0
    val onPol:  0.2938939382632573

=== Epoch 20 ===
    train loss:  0.20558575031004453
    val rand:  0
    val onPol:  0.2905589739481608

=== Epoch 30 ===
    train loss:  0.18203884258604885
    val rand:  0
    val onPol:  0.2945181553562482

=== Epoch 39 ===
    train loss:  0.165923949657825
    val rand:  0
    val onPol:  0.2995705579717954
Training duration: 14.22 s

#####################################
performing on-policy MPC rollouts... iter  93
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -12.097212250660473
DONE TAKING  40  STEPS.
Total reward:  -310.8375770539632
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.651573812765886
DONE TAKING  40  STEPS.
Total reward:  -813.0115957295747
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -20.48601714733763
DONE TAKING  40  STEPS.
Total reward:  -229.09595584138586
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.81069131667459
DONE TAKING  40  STEPS.
Total reward:  -710.1647921538174
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -11.882645155274272
DONE TAKING  40  STEPS.
Total reward:  384.0266608711875
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -12.741699523627211
DONE TAKING  40  STEPS.
Total reward:  -444.27163271848593
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -11.596436289474184
DONE TAKING  40  STEPS.
Total reward:  -294.3215491010251
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -19.559670028138513
DONE TAKING  40  STEPS.
Total reward:  -433.2857923630602
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -13.318953563744337
DONE TAKING  40  STEPS.
Total reward:  -338.0686208736067
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -20.109301220792084
DONE TAKING  40  STEPS.
Total reward:  -675.6010197491652
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -29.38231550317751
DONE TAKING  40  STEPS.
Total reward:  -666.1034894584151
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -22.28169637481936
DONE TAKING  40  STEPS.
Total reward:  -651.4417068539531
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -26.893488223590566
DONE TAKING  40  STEPS.
Total reward:  -727.4835145557262
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -13.724900520738814
DONE TAKING  40  STEPS.
Total reward:  -329.05358644985955
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -24.490848748491246
DONE TAKING  40  STEPS.
Total reward:  -707.5380682835762
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -15.339490295605556
DONE TAKING  40  STEPS.
Total reward:  -358.9208338345692
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.34363453360873
DONE TAKING  40  STEPS.
Total reward:  -616.5337246901408
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.188281247685133
DONE TAKING  40  STEPS.
Total reward:  -471.85196970539846
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -29.416701008936844
DONE TAKING  40  STEPS.
Total reward:  -591.5499647409995
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.427252239111372
DONE TAKING  40  STEPS.
Total reward:  -508.3785318027714
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.47443380007499
DONE TAKING  40  STEPS.
Total reward:  -956.8046961677626
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.83617946014216
DONE TAKING  40  STEPS.
Total reward:  -539.6166068442116
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.3145230996612
DONE TAKING  40  STEPS.
Total reward:  -311.9515464225257
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -30.567847498614714
DONE TAKING  40  STEPS.
Total reward:  -880.8587431841806
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.40997105244601
DONE TAKING  40  STEPS.
Total reward:  -372.6368507276546
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -11.93062538644619
DONE TAKING  40  STEPS.
Total reward:  -317.1247270436688
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.310169723078815
DONE TAKING  40  STEPS.
Total reward:  -989.3145129629037
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.66072364865016
DONE TAKING  40  STEPS.
Total reward:  -531.4076191653875
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -17.922349436978507
DONE TAKING  40  STEPS.
Total reward:  -322.30943268072986
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -30.636831087406122
DONE TAKING  40  STEPS.
Total reward:  -1039.1136177982128
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.604703617561167
DONE TAKING  40  STEPS.
Total reward:  -811.5788711541593
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -20.866062967787474
DONE TAKING  40  STEPS.
Total reward:  -696.659820637735
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.636412554761609
DONE TAKING  40  STEPS.
Total reward:  -324.140658949847
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.38123818917386
DONE TAKING  40  STEPS.
Total reward:  -642.2121856831327
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -23.275463634308032
DONE TAKING  40  STEPS.
Total reward:  -728.4074962529932
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.09073350756945
DONE TAKING  40  STEPS.
Total reward:  -408.90186353079736
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -18.073647111331454
DONE TAKING  40  STEPS.
Total reward:  -535.9011316159624
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.82056004055126
DONE TAKING  40  STEPS.
Total reward:  -273.2142599117899
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.67439852383052
DONE TAKING  40  STEPS.
Total reward:  -109.64352021539926
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -15.30249264080288
DONE TAKING  40  STEPS.
Total reward:  -346.3990530081062
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 94
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  94
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5032723159120794
    val rand:  0
    val onPol:  0.36097294588883716

=== Epoch 10 ===
    train loss:  0.24219532624671333
    val rand:  0
    val onPol:  0.293662096063296

=== Epoch 20 ===
    train loss:  0.20732692955878743
    val rand:  0
    val onPol:  0.28848573317130405

=== Epoch 30 ===
    train loss:  0.18589264180576592
    val rand:  0
    val onPol:  0.2918030669291814

=== Epoch 39 ===
    train loss:  0.17044318036029213
    val rand:  0
    val onPol:  0.29757001499334973
Training duration: 14.07 s

#####################################
performing on-policy MPC rollouts... iter  94
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.848618823396855
DONE TAKING  40  STEPS.
Total reward:  -1095.4797964314398
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.109165756485755
DONE TAKING  40  STEPS.
Total reward:  -503.8374007558435
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.118872612769877
DONE TAKING  40  STEPS.
Total reward:  -602.0849635507932
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.947648732706117
DONE TAKING  40  STEPS.
Total reward:  -639.6214224725658
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.59811893658533
DONE TAKING  40  STEPS.
Total reward:  -953.2632640609924
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.06050770116932
DONE TAKING  40  STEPS.
Total reward:  -778.0793841455204
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -22.330969419496746
DONE TAKING  40  STEPS.
Total reward:  -755.2699176470327
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -31.33257683654635
DONE TAKING  40  STEPS.
Total reward:  -774.4275039259264
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.4126700833462
DONE TAKING  40  STEPS.
Total reward:  -547.4603186407459
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -12.141713052666487
DONE TAKING  40  STEPS.
Total reward:  113.09814964761176
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.105094714242973
DONE TAKING  40  STEPS.
Total reward:  -1132.107189927103
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.297324885021467
DONE TAKING  40  STEPS.
Total reward:  -23.58453205712236
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -11.280057419115415
DONE TAKING  40  STEPS.
Total reward:  -379.4989834100338
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.891592719804787
DONE TAKING  40  STEPS.
Total reward:  -414.76063421834476
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -19.340632927103528
DONE TAKING  40  STEPS.
Total reward:  -317.4731788904647
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.95220856018867
DONE TAKING  40  STEPS.
Total reward:  -290.4531131902497
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -27.584236346193332
DONE TAKING  40  STEPS.
Total reward:  -839.7925451538651
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -28.278177022167952
DONE TAKING  40  STEPS.
Total reward:  -577.1408741840689
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.93317297447622
DONE TAKING  40  STEPS.
Total reward:  -1018.1817998476134
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -24.741628872449873
DONE TAKING  40  STEPS.
Total reward:  -534.2474059889034
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.318347618359745
DONE TAKING  40  STEPS.
Total reward:  -992.2814289135799
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -11.897500856700907
DONE TAKING  40  STEPS.
Total reward:  -331.76668443887223
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -19.955987557832373
DONE TAKING  40  STEPS.
Total reward:  -432.84083412207656
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.038060791162863
DONE TAKING  40  STEPS.
Total reward:  37.32094385039271
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.407871916945453
DONE TAKING  40  STEPS.
Total reward:  -754.0143082948922
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -28.847250715053704
DONE TAKING  40  STEPS.
Total reward:  -772.255496593594
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -19.464540143782887
DONE TAKING  40  STEPS.
Total reward:  -314.89538592403915
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.404561017622626
DONE TAKING  40  STEPS.
Total reward:  -841.1839393377913
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.501089328069874
DONE TAKING  40  STEPS.
Total reward:  -228.52729834548464
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.997759649873476
DONE TAKING  40  STEPS.
Total reward:  -435.60444435050346
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.175126477448572
DONE TAKING  40  STEPS.
Total reward:  -811.6183811926693
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -13.99603823620036
DONE TAKING  40  STEPS.
Total reward:  -342.34841616246337
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.6503698206115
DONE TAKING  40  STEPS.
Total reward:  -572.4652805174173
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.06465257160865
DONE TAKING  40  STEPS.
Total reward:  -488.1837533104232
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.23006143168868
DONE TAKING  40  STEPS.
Total reward:  -665.3376892405066
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.82770698563754
DONE TAKING  40  STEPS.
Total reward:  -1022.6860357597403
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.653663553888546
DONE TAKING  40  STEPS.
Total reward:  -1054.223583694757
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -25.433661017561086
DONE TAKING  40  STEPS.
Total reward:  -808.0083287573739
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -20.585534081881534
DONE TAKING  40  STEPS.
Total reward:  -488.8817757505395
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.913146830385557
DONE TAKING  40  STEPS.
Total reward:  -463.5833337713617
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 95
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  95
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5000045383185671
    val rand:  0
    val onPol:  0.3514464447895686

=== Epoch 10 ===
    train loss:  0.24428341969063408
    val rand:  0
    val onPol:  0.28928014636039734

=== Epoch 20 ===
    train loss:  0.20930052065012747
    val rand:  0
    val onPol:  0.2877504949768384

=== Epoch 30 ===
    train loss:  0.18547047805367856
    val rand:  0
    val onPol:  0.2915066083272298

=== Epoch 39 ===
    train loss:  0.16876089520621718
    val rand:  0
    val onPol:  0.29632773250341415
Training duration: 14.43 s

#####################################
performing on-policy MPC rollouts... iter  95
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.164767713174506
DONE TAKING  40  STEPS.
Total reward:  -739.1304871411605
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.391841590352083
DONE TAKING  40  STEPS.
Total reward:  -663.9095518705087
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.994439194885278
DONE TAKING  40  STEPS.
Total reward:  -994.8931798810225
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -11.162735423684078
DONE TAKING  40  STEPS.
Total reward:  -311.43958018718627
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -23.645598747319198
DONE TAKING  40  STEPS.
Total reward:  -770.9086130236744
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.82601078171536
DONE TAKING  40  STEPS.
Total reward:  -607.9837540963367
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.72276611701333
DONE TAKING  40  STEPS.
Total reward:  -610.4360622934697
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -30.871620566116675
DONE TAKING  40  STEPS.
Total reward:  -808.2720953421634
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.329000087372957
DONE TAKING  40  STEPS.
Total reward:  -418.6974370590612
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.976296547654584
DONE TAKING  40  STEPS.
Total reward:  -337.9553622542751
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -17.88202249046283
DONE TAKING  40  STEPS.
Total reward:  -662.420005245707
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -14.835151644677733
DONE TAKING  40  STEPS.
Total reward:  -398.74965977950484
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.481357347887656
DONE TAKING  40  STEPS.
Total reward:  -644.0874991837031
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.508247352690983
DONE TAKING  40  STEPS.
Total reward:  -528.2266113110138
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -19.789989843328193
DONE TAKING  40  STEPS.
Total reward:  -326.6671425687507
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.797795321180367
DONE TAKING  40  STEPS.
Total reward:  -992.0361971124354
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -30.61340366789789
DONE TAKING  40  STEPS.
Total reward:  -1012.5828067757975
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -24.58321980537635
DONE TAKING  40  STEPS.
Total reward:  -736.1282679796169
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -28.91616912961535
DONE TAKING  40  STEPS.
Total reward:  -671.2801554032159
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.63727532448614
DONE TAKING  40  STEPS.
Total reward:  -556.5699873532509
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -18.581426515042484
DONE TAKING  40  STEPS.
Total reward:  -418.689176810524
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -16.61820143577231
DONE TAKING  40  STEPS.
Total reward:  -387.91746857906026
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.511671486824547
DONE TAKING  40  STEPS.
Total reward:  -651.3175146210224
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -22.590398259817555
DONE TAKING  40  STEPS.
Total reward:  -189.8667123660939
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -19.01293208580606
DONE TAKING  40  STEPS.
Total reward:  -550.3221768851545
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -19.198954751416466
DONE TAKING  40  STEPS.
Total reward:  -607.2851230150329
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.349462989476173
DONE TAKING  40  STEPS.
Total reward:  -700.7533513808802
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -30.785820836468197
DONE TAKING  40  STEPS.
Total reward:  -846.0176169797077
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.860741265598483
DONE TAKING  40  STEPS.
Total reward:  -372.7649876170886
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -20.850964171273674
DONE TAKING  40  STEPS.
Total reward:  -690.5662157282915
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -19.633545929033637
DONE TAKING  40  STEPS.
Total reward:  -262.7526012820254
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.13035757332256
DONE TAKING  40  STEPS.
Total reward:  -533.3331835083626
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.932345411923755
DONE TAKING  40  STEPS.
Total reward:  -524.2821941708725
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.224243791367925
DONE TAKING  40  STEPS.
Total reward:  -615.6274176770205
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -25.60603133527854
DONE TAKING  40  STEPS.
Total reward:  -663.163719696492
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.019137632407993
DONE TAKING  40  STEPS.
Total reward:  -963.1496371627542
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.610543138946014
DONE TAKING  40  STEPS.
Total reward:  -859.9795772967797
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -30.282640069438536
DONE TAKING  40  STEPS.
Total reward:  -766.1644562445658
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -23.24630633900653
DONE TAKING  40  STEPS.
Total reward:  -344.27842964275334
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.76160842836928
DONE TAKING  40  STEPS.
Total reward:  -794.9966290474576
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 96
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  96
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5090559532767848
    val rand:  0
    val onPol:  0.374589925010999

=== Epoch 10 ===
    train loss:  0.2464306947954914
    val rand:  0
    val onPol:  0.3099340796470642

=== Epoch 20 ===
    train loss:  0.2104257128217764
    val rand:  0
    val onPol:  0.30742014944553375

=== Epoch 30 ===
    train loss:  0.18563455709239893
    val rand:  0
    val onPol:  0.31128718207279843

=== Epoch 39 ===
    train loss:  0.16974675995216035
    val rand:  0
    val onPol:  0.31673847635587055
Training duration: 14.42 s

#####################################
performing on-policy MPC rollouts... iter  96
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -17.163531882676736
DONE TAKING  40  STEPS.
Total reward:  -409.21087333250944
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.89194751633714
DONE TAKING  40  STEPS.
Total reward:  -661.7138385933765
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.014150968702033
DONE TAKING  40  STEPS.
Total reward:  -887.8449585173275
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.39135279342358
DONE TAKING  40  STEPS.
Total reward:  -347.9500818841424
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -24.99340899431391
DONE TAKING  40  STEPS.
Total reward:  -914.2487200815915
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.60266415003548
DONE TAKING  40  STEPS.
Total reward:  -523.0508554575295
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -12.043242088953082
DONE TAKING  40  STEPS.
Total reward:  -402.82353263686673
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.23669496073623
DONE TAKING  40  STEPS.
Total reward:  -747.6867017218714
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.89474245468676
DONE TAKING  40  STEPS.
Total reward:  -899.6455710825625
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -16.59703907149659
DONE TAKING  40  STEPS.
Total reward:  -250.62265745630788
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -30.552763805702327
DONE TAKING  40  STEPS.
Total reward:  -610.5950674172263
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -9.944183564802614
DONE TAKING  40  STEPS.
Total reward:  -324.80455523836866
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.016423365329928
DONE TAKING  40  STEPS.
Total reward:  -615.1488123962398
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.439792256899544
DONE TAKING  40  STEPS.
Total reward:  -631.9473504497367
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -15.22585559119349
DONE TAKING  40  STEPS.
Total reward:  -429.3363555716779
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.83688536580502
DONE TAKING  40  STEPS.
Total reward:  -769.0195697566078
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -12.966933599040598
DONE TAKING  40  STEPS.
Total reward:  -447.1637368843719
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -17.709486996124866
DONE TAKING  40  STEPS.
Total reward:  -121.47189802395245
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.76452587973914
DONE TAKING  40  STEPS.
Total reward:  -674.8040540439553
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -22.03687232737527
DONE TAKING  40  STEPS.
Total reward:  395.38404863251344
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.01757919631439
DONE TAKING  40  STEPS.
Total reward:  -923.7030856708584
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -25.86544158437876
DONE TAKING  40  STEPS.
Total reward:  -432.8013450930097
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -11.682369262860826
DONE TAKING  40  STEPS.
Total reward:  -431.66244014502314
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -23.28059411807997
DONE TAKING  40  STEPS.
Total reward:  -550.5574316139085
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.863836394988994
DONE TAKING  40  STEPS.
Total reward:  -891.2002805373519
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.24034581135187
DONE TAKING  40  STEPS.
Total reward:  -474.53691789268765
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -17.699511946571395
DONE TAKING  40  STEPS.
Total reward:  -765.0466584982537
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.930134907924483
DONE TAKING  40  STEPS.
Total reward:  -779.6759587497132
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -22.425154729627153
DONE TAKING  40  STEPS.
Total reward:  -373.99619088055783
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.46228785592543
DONE TAKING  40  STEPS.
Total reward:  -655.3596406930055
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -16.565765095664442
DONE TAKING  40  STEPS.
Total reward:  -648.0167039273706
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.281896533680527
DONE TAKING  40  STEPS.
Total reward:  -268.8557613156282
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -14.720881338419908
DONE TAKING  40  STEPS.
Total reward:  -410.66919134206654
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.146285137020293
DONE TAKING  40  STEPS.
Total reward:  15.001575410600527
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.88753732337583
DONE TAKING  40  STEPS.
Total reward:  -231.11083322755118
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -23.930624104109206
DONE TAKING  40  STEPS.
Total reward:  -377.9531776482585
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.815044737995173
DONE TAKING  40  STEPS.
Total reward:  -582.1762931785788
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.098834842380843
DONE TAKING  40  STEPS.
Total reward:  -907.6522431741397
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -18.829345223508113
DONE TAKING  40  STEPS.
Total reward:  -398.36641074630245
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.35840738697328
DONE TAKING  40  STEPS.
Total reward:  -834.50464259942
Time for 1 rollout: 0.91 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 97
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  97
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49126925646213065
    val rand:  0
    val onPol:  0.37918708721796673

=== Epoch 10 ===
    train loss:  0.24220762336463258
    val rand:  0
    val onPol:  0.31408214072386426

=== Epoch 20 ===
    train loss:  0.2059420200816372
    val rand:  0
    val onPol:  0.310964231689771

=== Epoch 30 ===
    train loss:  0.18591169463960747
    val rand:  0
    val onPol:  0.31698767840862274

=== Epoch 39 ===
    train loss:  0.16841719913900943
    val rand:  0
    val onPol:  0.31957392146190006
Training duration: 14.44 s

#####################################
performing on-policy MPC rollouts... iter  97
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.378253282731407
DONE TAKING  40  STEPS.
Total reward:  -538.2345543226166
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -31.273825752611128
DONE TAKING  40  STEPS.
Total reward:  -679.8475913904311
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -17.889949859394044
DONE TAKING  40  STEPS.
Total reward:  -606.6099689418277
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -27.300008785918465
DONE TAKING  40  STEPS.
Total reward:  -642.501864185344
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -29.79676968474707
DONE TAKING  40  STEPS.
Total reward:  -838.3960372286422
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.962539775376282
DONE TAKING  40  STEPS.
Total reward:  -430.27675992463054
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.962018850967418
DONE TAKING  40  STEPS.
Total reward:  -726.1428030789629
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -22.23285761768122
DONE TAKING  40  STEPS.
Total reward:  -868.2826878608912
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.885991922489367
DONE TAKING  40  STEPS.
Total reward:  -716.5005385256022
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -10.223912977045073
DONE TAKING  40  STEPS.
Total reward:  -322.18365298857475
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.802489317828886
DONE TAKING  40  STEPS.
Total reward:  -794.3583509964293
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.31207011604505
DONE TAKING  40  STEPS.
Total reward:  -866.5285342954421
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -10.192704890224082
DONE TAKING  40  STEPS.
Total reward:  -337.1008843225569
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.84565745680072
DONE TAKING  40  STEPS.
Total reward:  -928.6704135144786
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.357124055551974
DONE TAKING  40  STEPS.
Total reward:  -752.7237298814423
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -26.197751008244442
DONE TAKING  40  STEPS.
Total reward:  -701.2417844746582
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.570168806191855
DONE TAKING  40  STEPS.
Total reward:  -819.1434142231659
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.91156447849294
DONE TAKING  40  STEPS.
Total reward:  -738.4674993800515
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -25.76605848211944
DONE TAKING  40  STEPS.
Total reward:  -913.6802167753121
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -18.497314088707924
DONE TAKING  40  STEPS.
Total reward:  -666.2295780296482
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.146090321276784
DONE TAKING  40  STEPS.
Total reward:  -362.85629755683783
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -17.60861397011921
DONE TAKING  40  STEPS.
Total reward:  -569.1631806643658
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.78416050273744
DONE TAKING  40  STEPS.
Total reward:  -420.35035707263
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -15.79888325658599
DONE TAKING  40  STEPS.
Total reward:  -575.2887887278546
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -18.820686891928712
DONE TAKING  40  STEPS.
Total reward:  -320.61756265597796
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -25.26842404930975
DONE TAKING  40  STEPS.
Total reward:  -961.7434555907045
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -21.20820853496092
DONE TAKING  40  STEPS.
Total reward:  -72.64724606810893
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.934381985711397
DONE TAKING  40  STEPS.
Total reward:  -983.8835482220591
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -19.665194430486284
DONE TAKING  40  STEPS.
Total reward:  -470.6768528697201
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.980636336126334
DONE TAKING  40  STEPS.
Total reward:  -469.56429986461586
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.668633182788184
DONE TAKING  40  STEPS.
Total reward:  -710.9418223344579
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -22.282354583902087
DONE TAKING  40  STEPS.
Total reward:  -677.9860720842981
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -20.23007994263514
DONE TAKING  40  STEPS.
Total reward:  -586.799579903106
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -20.77242383764108
DONE TAKING  40  STEPS.
Total reward:  -714.6974043941423
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -16.087501823818986
DONE TAKING  40  STEPS.
Total reward:  -402.2358032708988
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -13.354225114535712
DONE TAKING  40  STEPS.
Total reward:  -480.27035306425216
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.156485068520016
DONE TAKING  40  STEPS.
Total reward:  -772.745089501268
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.102234709377527
DONE TAKING  40  STEPS.
Total reward:  -794.0393864524614
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -10.236105045192595
DONE TAKING  40  STEPS.
Total reward:  -329.0144103986339
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.30487288693441
DONE TAKING  40  STEPS.
Total reward:  -933.0316758781709
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 98
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  98
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49752151756955865
    val rand:  0
    val onPol:  0.37176407873630524

=== Epoch 10 ===
    train loss:  0.24106773472668833
    val rand:  0
    val onPol:  0.30358855923016864

=== Epoch 20 ===
    train loss:  0.2112575400816767
    val rand:  0
    val onPol:  0.30266323933998746

=== Epoch 30 ===
    train loss:  0.18487666625725596
    val rand:  0
    val onPol:  0.30604563653469086

=== Epoch 39 ===
    train loss:  0.16950706928445583
    val rand:  0
    val onPol:  0.3113711004455884
Training duration: 14.30 s

#####################################
performing on-policy MPC rollouts... iter  98
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.468513508524623
DONE TAKING  40  STEPS.
Total reward:  -846.2888382224605
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.901576825334516
DONE TAKING  40  STEPS.
Total reward:  -719.6588193208652
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.490291739324153
DONE TAKING  40  STEPS.
Total reward:  10.782545129688122
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -15.82242754144254
DONE TAKING  40  STEPS.
Total reward:  -465.2503174108875
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -31.06514376338465
DONE TAKING  40  STEPS.
Total reward:  -750.2824496589078
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -13.49714512125534
DONE TAKING  40  STEPS.
Total reward:  -430.5104728250007
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -12.869355959723212
DONE TAKING  40  STEPS.
Total reward:  -115.90270309788772
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -15.543362850579435
DONE TAKING  40  STEPS.
Total reward:  -570.6981406684633
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.176932699399929
DONE TAKING  40  STEPS.
Total reward:  -326.23618660608713
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.205209276988594
DONE TAKING  40  STEPS.
Total reward:  -232.5221058280512
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -20.998870473944322
DONE TAKING  40  STEPS.
Total reward:  -791.4914969046534
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.356460280145555
DONE TAKING  40  STEPS.
Total reward:  -671.5767083824028
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.516104456115606
DONE TAKING  40  STEPS.
Total reward:  -427.0984305124191
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.176610239732724
DONE TAKING  40  STEPS.
Total reward:  -592.311087334378
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.23709748867147
DONE TAKING  40  STEPS.
Total reward:  -542.9300992122866
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.24784818041096
DONE TAKING  40  STEPS.
Total reward:  -513.9100111378023
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.347120327449552
DONE TAKING  40  STEPS.
Total reward:  -645.2422953006451
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.053270242471573
DONE TAKING  40  STEPS.
Total reward:  -758.267788305791
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -21.918573087996847
DONE TAKING  40  STEPS.
Total reward:  -284.7012751036157
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.356292574695416
DONE TAKING  40  STEPS.
Total reward:  -677.9383507627535
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.85469078555196
DONE TAKING  40  STEPS.
Total reward:  -467.291777968427
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -19.854656678814727
DONE TAKING  40  STEPS.
Total reward:  -388.7743359161716
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.093721455701964
DONE TAKING  40  STEPS.
Total reward:  -755.5156687245945
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -28.802996548825092
DONE TAKING  40  STEPS.
Total reward:  -909.2319002768673
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.117233468191067
DONE TAKING  40  STEPS.
Total reward:  -828.9358793611513
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.125647561860617
DONE TAKING  40  STEPS.
Total reward:  -685.226772156288
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -19.730302547627495
DONE TAKING  40  STEPS.
Total reward:  -574.4952562677537
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -12.393046898857518
DONE TAKING  40  STEPS.
Total reward:  -361.9566613643528
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -21.002259910536605
DONE TAKING  40  STEPS.
Total reward:  -570.0954820648062
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -16.42047749936958
DONE TAKING  40  STEPS.
Total reward:  -380.1973729543978
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -25.63758490650884
DONE TAKING  40  STEPS.
Total reward:  -500.4763634848701
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -31.019579259169127
DONE TAKING  40  STEPS.
Total reward:  -802.0677466231019
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.604734336579625
DONE TAKING  40  STEPS.
Total reward:  -574.8134034264623
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -23.81665971402596
DONE TAKING  40  STEPS.
Total reward:  -754.5465025832045
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.10971936474947
DONE TAKING  40  STEPS.
Total reward:  -470.4027656477248
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.281199127633776
DONE TAKING  40  STEPS.
Total reward:  -537.6673458733266
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -17.900825159756966
DONE TAKING  40  STEPS.
Total reward:  -640.5005380781885
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.16126799677846
DONE TAKING  40  STEPS.
Total reward:  -903.9691871530209
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -16.41174904992464
DONE TAKING  40  STEPS.
Total reward:  -532.2113866957467
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.608883782284536
DONE TAKING  40  STEPS.
Total reward:  -1030.1376837974985
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 99
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  99
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49509513012149875
    val rand:  0
    val onPol:  0.3615427439411481

=== Epoch 10 ===
    train loss:  0.24303846087372094
    val rand:  0
    val onPol:  0.2973518818616867

=== Epoch 20 ===
    train loss:  0.2080779326589484
    val rand:  0
    val onPol:  0.29409994184970856

=== Epoch 30 ===
    train loss:  0.18409367010258793
    val rand:  0
    val onPol:  0.2960524757703145

=== Epoch 39 ===
    train loss:  0.16957465546172962
    val rand:  0
    val onPol:  0.30067411810159683
Training duration: 14.43 s

#####################################
performing on-policy MPC rollouts... iter  99
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -16.5962423280727
DONE TAKING  40  STEPS.
Total reward:  -412.8505809591223
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.074056151367397
DONE TAKING  40  STEPS.
Total reward:  -414.15407439065297
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -19.20100194451736
DONE TAKING  40  STEPS.
Total reward:  -647.9058377697618
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -16.61723722300845
DONE TAKING  40  STEPS.
Total reward:  -585.8254835537965
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -15.74480154598784
DONE TAKING  40  STEPS.
Total reward:  -623.5582612864383
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.892911175713436
DONE TAKING  40  STEPS.
Total reward:  -441.4774888233895
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -30.106794581771894
DONE TAKING  40  STEPS.
Total reward:  -422.99754359234754
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.181310763024264
DONE TAKING  40  STEPS.
Total reward:  -421.24156555884906
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -12.286151175425207
DONE TAKING  40  STEPS.
Total reward:  -177.87747263793204
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -21.671599529683306
DONE TAKING  40  STEPS.
Total reward:  -604.1144948470761
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -13.105371660390936
DONE TAKING  40  STEPS.
Total reward:  -290.32579985181053
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -25.72383119509422
DONE TAKING  40  STEPS.
Total reward:  -883.5321976629717
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -23.67341883977929
DONE TAKING  40  STEPS.
Total reward:  -837.1230064666004
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.121799109986817
DONE TAKING  40  STEPS.
Total reward:  -601.978026289609
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.036533216124504
DONE TAKING  40  STEPS.
Total reward:  -364.7162283932473
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -31.14781781192741
DONE TAKING  40  STEPS.
Total reward:  -688.1661404940398
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -20.463803561836656
DONE TAKING  40  STEPS.
Total reward:  -726.2256745867417
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -13.663494695960043
DONE TAKING  40  STEPS.
Total reward:  -302.43589591884967
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.6811279879487
DONE TAKING  40  STEPS.
Total reward:  -847.0994599473194
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.53492290070144
DONE TAKING  40  STEPS.
Total reward:  -1004.1894271634117
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -21.06718724027504
DONE TAKING  40  STEPS.
Total reward:  -376.90719595106145
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.506942732814746
DONE TAKING  40  STEPS.
Total reward:  -502.96975919773683
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -13.655335720062737
DONE TAKING  40  STEPS.
Total reward:  -294.99622774250236
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.48154461845612
DONE TAKING  40  STEPS.
Total reward:  -790.8085894359007
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.727570223978066
DONE TAKING  40  STEPS.
Total reward:  -778.9862537585826
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -29.797157324785218
DONE TAKING  40  STEPS.
Total reward:  -962.688810969749
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.847011042682965
DONE TAKING  40  STEPS.
Total reward:  -361.7859706140931
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -23.540268282054257
DONE TAKING  40  STEPS.
Total reward:  -865.792076135918
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.842611407020705
DONE TAKING  40  STEPS.
Total reward:  -703.4334589597407
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.07430605880691
DONE TAKING  40  STEPS.
Total reward:  -417.8630317453236
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.86092743820985
DONE TAKING  40  STEPS.
Total reward:  -819.5959994825591
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.66254155061244
DONE TAKING  40  STEPS.
Total reward:  -493.7127152145269
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -28.573367022921655
DONE TAKING  40  STEPS.
Total reward:  -454.1919864948603
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.052944885499414
DONE TAKING  40  STEPS.
Total reward:  -808.7454419691719
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -24.607546606443933
DONE TAKING  40  STEPS.
Total reward:  -844.1115783079001
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -16.144209604496876
DONE TAKING  40  STEPS.
Total reward:  -447.0778794610487
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.89331638842534
DONE TAKING  40  STEPS.
Total reward:  -990.6920640824235
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -31.003379434138637
DONE TAKING  40  STEPS.
Total reward:  -751.8777413417495
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.849001355650245
DONE TAKING  40  STEPS.
Total reward:  -276.16520204222314
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.353086660729755
DONE TAKING  40  STEPS.
Total reward:  -949.8468541273909
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 100
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  100
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5042551311484554
    val rand:  0
    val onPol:  0.35919099549452466

=== Epoch 10 ===
    train loss:  0.2416351782648187
    val rand:  0
    val onPol:  0.29520871738592785

=== Epoch 20 ===
    train loss:  0.20857150591256327
    val rand:  0
    val onPol:  0.29177994777758914

=== Epoch 30 ===
    train loss:  0.1869249835348966
    val rand:  0
    val onPol:  0.29416900376478833

=== Epoch 39 ===
    train loss:  0.17223818757032094
    val rand:  0
    val onPol:  0.2997826288143794
Training duration: 14.38 s

#####################################
performing on-policy MPC rollouts... iter  100
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.368856817315354
DONE TAKING  40  STEPS.
Total reward:  -515.4869643937986
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -26.219130918590746
DONE TAKING  40  STEPS.
Total reward:  -999.6800202248053
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.302393389649303
DONE TAKING  40  STEPS.
Total reward:  -756.6302448644489
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.89547135100554
DONE TAKING  40  STEPS.
Total reward:  -972.4106923221477
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.018291250775178
DONE TAKING  40  STEPS.
Total reward:  -639.092866664646
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -9.264883544817135
DONE TAKING  40  STEPS.
Total reward:  -214.1642684466877
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.921593545081762
DONE TAKING  40  STEPS.
Total reward:  -666.2731938978261
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.019378220633286
DONE TAKING  40  STEPS.
Total reward:  -831.7791212996744
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -28.36579520557582
DONE TAKING  40  STEPS.
Total reward:  -916.7160640054024
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.891168672870776
DONE TAKING  40  STEPS.
Total reward:  -414.1949857967272
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.86265951914273
DONE TAKING  40  STEPS.
Total reward:  -890.1429042499802
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -13.575115504526158
DONE TAKING  40  STEPS.
Total reward:  -78.83972747806311
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.187630784106823
DONE TAKING  40  STEPS.
Total reward:  -728.5843438175837
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -29.773265278652307
DONE TAKING  40  STEPS.
Total reward:  -878.5372607456899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -28.500449991593186
DONE TAKING  40  STEPS.
Total reward:  -891.4440188954655
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.528942991019427
DONE TAKING  40  STEPS.
Total reward:  -1049.1119020260658
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -15.598996074950664
DONE TAKING  40  STEPS.
Total reward:  -548.4164885956542
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.01525313859885
DONE TAKING  40  STEPS.
Total reward:  -553.1127637317874
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.394177718107825
DONE TAKING  40  STEPS.
Total reward:  -349.16608638767696
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.478418484075846
DONE TAKING  40  STEPS.
Total reward:  -465.21803594534276
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -20.951544653517526
DONE TAKING  40  STEPS.
Total reward:  -521.4425170037093
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -11.40624351925984
DONE TAKING  40  STEPS.
Total reward:  -273.98622422320227
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -20.160733020208887
DONE TAKING  40  STEPS.
Total reward:  -608.3495221973559
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -31.12283449576652
DONE TAKING  40  STEPS.
Total reward:  -492.01619853817994
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -24.46722295515189
DONE TAKING  40  STEPS.
Total reward:  -868.4334058219911
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.615599196303172
DONE TAKING  40  STEPS.
Total reward:  -722.4739755757575
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -16.800072982487144
DONE TAKING  40  STEPS.
Total reward:  -312.97198873779956
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.14484290939252
DONE TAKING  40  STEPS.
Total reward:  -614.0866899726178
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.730705480487643
DONE TAKING  40  STEPS.
Total reward:  -872.9404110776122
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -16.292656050008777
DONE TAKING  40  STEPS.
Total reward:  -345.9840172847264
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.815403875182504
DONE TAKING  40  STEPS.
Total reward:  -147.47105965254877
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.046617388969032
DONE TAKING  40  STEPS.
Total reward:  -1019.862096981808
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.300334103167483
DONE TAKING  40  STEPS.
Total reward:  -767.1815257000513
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.508049736194664
DONE TAKING  40  STEPS.
Total reward:  -951.1016749290468
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -26.207875172166016
DONE TAKING  40  STEPS.
Total reward:  -1031.3686497271738
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.39804484767358
DONE TAKING  40  STEPS.
Total reward:  -599.7418785998059
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.276859544593044
DONE TAKING  40  STEPS.
Total reward:  -489.7346866790332
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.162236650456954
DONE TAKING  40  STEPS.
Total reward:  -715.8530892702989
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -24.218366513935816
DONE TAKING  40  STEPS.
Total reward:  -939.4877341894165
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.355681804521367
DONE TAKING  40  STEPS.
Total reward:  -1017.4206700771726
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 101
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  101
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4964511467699419
    val rand:  0
    val onPol:  0.36602037648359936

=== Epoch 10 ===
    train loss:  0.2430873037430278
    val rand:  0
    val onPol:  0.3025783374905586

=== Epoch 20 ===
    train loss:  0.2137869855290965
    val rand:  0
    val onPol:  0.2963327094912529

=== Epoch 30 ===
    train loss:  0.1880642936417931
    val rand:  0
    val onPol:  0.30016593883434933

=== Epoch 39 ===
    train loss:  0.16905832029225534
    val rand:  0
    val onPol:  0.30564090609550476
Training duration: 14.40 s

#####################################
performing on-policy MPC rollouts... iter  101
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -22.728221694150488
DONE TAKING  40  STEPS.
Total reward:  -502.65055040277446
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.061195030193563
DONE TAKING  40  STEPS.
Total reward:  -588.3563919190055
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.808687013699764
DONE TAKING  40  STEPS.
Total reward:  -365.97893788627954
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -25.45571498954775
DONE TAKING  40  STEPS.
Total reward:  -929.4973398453582
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -27.984897860781956
DONE TAKING  40  STEPS.
Total reward:  -612.2175800264637
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -26.099168932251896
DONE TAKING  40  STEPS.
Total reward:  -432.3761937659822
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -11.722911112720777
DONE TAKING  40  STEPS.
Total reward:  -256.04129840642656
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -31.001386519248307
DONE TAKING  40  STEPS.
Total reward:  -876.0413536797561
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -23.995211349385663
DONE TAKING  40  STEPS.
Total reward:  -629.5518468172645
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -25.298278222312955
DONE TAKING  40  STEPS.
Total reward:  -401.31468315253034
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.106173533119502
DONE TAKING  40  STEPS.
Total reward:  -648.9451181090687
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -19.52088606810924
DONE TAKING  40  STEPS.
Total reward:  -662.7022995124328
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.007202027428804
DONE TAKING  40  STEPS.
Total reward:  -618.980357715075
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.813660624974812
DONE TAKING  40  STEPS.
Total reward:  -851.0174553475407
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.87316371431815
DONE TAKING  40  STEPS.
Total reward:  -384.8717943092475
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -18.629164839906775
DONE TAKING  40  STEPS.
Total reward:  -271.9112595260573
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -26.918520657946885
DONE TAKING  40  STEPS.
Total reward:  -436.2507401002509
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.68291611843296
DONE TAKING  40  STEPS.
Total reward:  -356.6378165480681
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.328949713910102
DONE TAKING  40  STEPS.
Total reward:  -720.0921448720557
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.718180861150213
DONE TAKING  40  STEPS.
Total reward:  -551.0807156736624
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -29.67593242499553
DONE TAKING  40  STEPS.
Total reward:  -725.5968518481124
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -14.940144617539175
DONE TAKING  40  STEPS.
Total reward:  -484.7262736584666
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -22.618623685092736
DONE TAKING  40  STEPS.
Total reward:  -779.6468728108226
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -24.320296890034445
DONE TAKING  40  STEPS.
Total reward:  -622.7485976937832
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -17.25179800083534
DONE TAKING  40  STEPS.
Total reward:  -172.61034651147807
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.05436255376187
DONE TAKING  40  STEPS.
Total reward:  -501.27604877344237
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -26.326122045364713
DONE TAKING  40  STEPS.
Total reward:  -423.27846990584305
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -29.906869019933463
DONE TAKING  40  STEPS.
Total reward:  -637.1045242745668
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -28.788519800082515
DONE TAKING  40  STEPS.
Total reward:  -733.8808055534631
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -31.411457583527984
DONE TAKING  40  STEPS.
Total reward:  -723.7219791715715
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -26.76009329611068
DONE TAKING  40  STEPS.
Total reward:  -31.093333279739216
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.61407709796834
DONE TAKING  40  STEPS.
Total reward:  -987.2586857133559
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -18.59384099802286
DONE TAKING  40  STEPS.
Total reward:  -329.2072784042646
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -19.82948481610815
DONE TAKING  40  STEPS.
Total reward:  -744.1635982661402
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -19.625855866598457
DONE TAKING  40  STEPS.
Total reward:  -417.22663323718757
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -29.691092998617922
DONE TAKING  40  STEPS.
Total reward:  -753.6163978839228
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -25.72102662070097
DONE TAKING  40  STEPS.
Total reward:  -827.6092874210632
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -15.047706461237361
DONE TAKING  40  STEPS.
Total reward:  -433.74591835699607
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -27.70112958444008
DONE TAKING  40  STEPS.
Total reward:  -568.0774232038254
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.325360558616303
DONE TAKING  40  STEPS.
Total reward:  -381.5112905126343
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 102
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  102
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4934487253950353
    val rand:  0
    val onPol:  0.36791909237702686

=== Epoch 10 ===
    train loss:  0.24221880394115783
    val rand:  0
    val onPol:  0.30464501678943634

=== Epoch 20 ===
    train loss:  0.21017856190079137
    val rand:  0
    val onPol:  0.30119234323501587

=== Epoch 30 ===
    train loss:  0.18774613136785073
    val rand:  0
    val onPol:  0.306162769595782

=== Epoch 39 ===
    train loss:  0.16936109672512925
    val rand:  0
    val onPol:  0.3095883180697759
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  102
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -11.652880030244916
DONE TAKING  40  STEPS.
Total reward:  290.77077441492355
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.53378878555292
DONE TAKING  40  STEPS.
Total reward:  -485.56474402809584
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.178593056043308
DONE TAKING  40  STEPS.
Total reward:  -566.1335347661645
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.97231796059492
DONE TAKING  40  STEPS.
Total reward:  -608.3035572397002
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -17.022487032936013
DONE TAKING  40  STEPS.
Total reward:  35.46055383142325
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -23.397254064792005
DONE TAKING  40  STEPS.
Total reward:  -916.8906591656615
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -27.505613178540145
DONE TAKING  40  STEPS.
Total reward:  -455.7193932757078
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -21.277282998467957
DONE TAKING  40  STEPS.
Total reward:  -622.1966456138924
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -17.020338369103158
DONE TAKING  40  STEPS.
Total reward:  213.0849935069699
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.84459492869879
DONE TAKING  40  STEPS.
Total reward:  -856.7389495624941
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.78381090306189
DONE TAKING  40  STEPS.
Total reward:  -678.4208759132694
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.781425767090838
DONE TAKING  40  STEPS.
Total reward:  -260.9661262638985
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.39344272701288
DONE TAKING  40  STEPS.
Total reward:  -837.2000332582355
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.112471640176814
DONE TAKING  40  STEPS.
Total reward:  -514.9701034102522
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.25712659297922
DONE TAKING  40  STEPS.
Total reward:  -878.3398090622263
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -29.39024098282659
DONE TAKING  40  STEPS.
Total reward:  -759.2548069551981
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.059041467025793
DONE TAKING  40  STEPS.
Total reward:  -540.1741414414918
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -15.569403729332215
DONE TAKING  40  STEPS.
Total reward:  -305.85184306124796
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -19.469838128044742
DONE TAKING  40  STEPS.
Total reward:  -522.3054389080303
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.139662376260421
DONE TAKING  40  STEPS.
Total reward:  -839.0401761483491
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -25.361948114520082
DONE TAKING  40  STEPS.
Total reward:  -1055.8635393994525
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.359629144647748
DONE TAKING  40  STEPS.
Total reward:  -822.3061650275744
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.157157089210084
DONE TAKING  40  STEPS.
Total reward:  -85.47332410018099
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -17.27372151250345
DONE TAKING  40  STEPS.
Total reward:  -530.8433405948705
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -30.487606196994868
DONE TAKING  40  STEPS.
Total reward:  -578.726936555556
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -23.338229068885184
DONE TAKING  40  STEPS.
Total reward:  -417.5785445186046
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.143503115938575
DONE TAKING  40  STEPS.
Total reward:  -721.0700458555954
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.459615138495465
DONE TAKING  40  STEPS.
Total reward:  -906.9601219850041
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.0356865187533
DONE TAKING  40  STEPS.
Total reward:  -493.20474564713055
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -25.68788070921032
DONE TAKING  40  STEPS.
Total reward:  -584.0436118830436
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -22.995604303791577
DONE TAKING  40  STEPS.
Total reward:  -599.1857262758473
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.38644015288527
DONE TAKING  40  STEPS.
Total reward:  -321.00506286623505
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.754426329152714
DONE TAKING  40  STEPS.
Total reward:  -224.08970597240443
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -17.143272574231815
DONE TAKING  40  STEPS.
Total reward:  -830.4992490340793
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.268446636137327
DONE TAKING  40  STEPS.
Total reward:  -374.6409393673467
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -19.06476642072997
DONE TAKING  40  STEPS.
Total reward:  -603.8850250081045
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -28.563864374413477
DONE TAKING  40  STEPS.
Total reward:  -816.819497204606
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -21.924923528127298
DONE TAKING  40  STEPS.
Total reward:  -598.7146533719458
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -21.746078551105704
DONE TAKING  40  STEPS.
Total reward:  -469.92935900559536
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.503975423861498
DONE TAKING  40  STEPS.
Total reward:  -474.7610866548453
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 103
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  103
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49770993883149667
    val rand:  0
    val onPol:  0.36655108133951825

=== Epoch 10 ===
    train loss:  0.2468044768299973
    val rand:  0
    val onPol:  0.3029017249743144

=== Epoch 20 ===
    train loss:  0.21514909466107687
    val rand:  0
    val onPol:  0.29970672726631165

=== Epoch 30 ===
    train loss:  0.19120561240012185
    val rand:  0
    val onPol:  0.3027985692024231

=== Epoch 39 ===
    train loss:  0.1745754111754267
    val rand:  0
    val onPol:  0.307384192943573
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  103
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -16.462960205970965
DONE TAKING  40  STEPS.
Total reward:  -365.3781498658822
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -23.6776849245263
DONE TAKING  40  STEPS.
Total reward:  -719.1310084471555
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -29.675651366048356
DONE TAKING  40  STEPS.
Total reward:  -915.02203881824
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -14.326046292509725
DONE TAKING  40  STEPS.
Total reward:  -306.79151849656245
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -20.793878759020078
DONE TAKING  40  STEPS.
Total reward:  34.28002444926247
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.972311378332844
DONE TAKING  40  STEPS.
Total reward:  -899.742140959853
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.163843985397627
DONE TAKING  40  STEPS.
Total reward:  -605.5953354848825
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.164646974240696
DONE TAKING  40  STEPS.
Total reward:  32.9196442578575
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -15.686004335509088
DONE TAKING  40  STEPS.
Total reward:  -282.9895068939521
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -15.795236534490009
DONE TAKING  40  STEPS.
Total reward:  -546.3800139951929
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.10451349579378
DONE TAKING  40  STEPS.
Total reward:  -448.3767395344846
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -28.897975591565746
DONE TAKING  40  STEPS.
Total reward:  -571.3591901489633
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.745012638880535
DONE TAKING  40  STEPS.
Total reward:  -719.4160177497782
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -18.44478766949787
DONE TAKING  40  STEPS.
Total reward:  -402.83683672278437
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.36447627864089
DONE TAKING  40  STEPS.
Total reward:  -745.0208444571451
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.46251378118584
DONE TAKING  40  STEPS.
Total reward:  -442.70921056332196
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.041097738124265
DONE TAKING  40  STEPS.
Total reward:  -306.6505573744291
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.039153605041129
DONE TAKING  40  STEPS.
Total reward:  -320.33783321710507
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -16.221995049265043
DONE TAKING  40  STEPS.
Total reward:  -486.9059447978798
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.372249714223305
DONE TAKING  40  STEPS.
Total reward:  -81.77738636605807
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -13.133160590062765
DONE TAKING  40  STEPS.
Total reward:  -345.2826166336831
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -23.34089647108771
DONE TAKING  40  STEPS.
Total reward:  -774.6404182904369
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -29.66950162099076
DONE TAKING  40  STEPS.
Total reward:  -732.0689475349786
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -17.857054357342427
DONE TAKING  40  STEPS.
Total reward:  -361.9629023724036
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -23.94372135885343
DONE TAKING  40  STEPS.
Total reward:  -531.5885134790042
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -28.074540233467935
DONE TAKING  40  STEPS.
Total reward:  -395.60447246472506
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.607112103295727
DONE TAKING  40  STEPS.
Total reward:  -408.50116483594695
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.58549227964923
DONE TAKING  40  STEPS.
Total reward:  -750.5475004564532
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.75775329291877
DONE TAKING  40  STEPS.
Total reward:  -537.6409843016552
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.397117426681913
DONE TAKING  40  STEPS.
Total reward:  -583.5506199032043
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -13.79146362122369
DONE TAKING  40  STEPS.
Total reward:  -39.00327298971247
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.281058547441692
DONE TAKING  40  STEPS.
Total reward:  -478.39663200569044
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.55296380158829
DONE TAKING  40  STEPS.
Total reward:  -592.3842709729288
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.293726558194358
DONE TAKING  40  STEPS.
Total reward:  -318.2371269414917
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -31.26266401239318
DONE TAKING  40  STEPS.
Total reward:  -593.1197454839188
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -18.994540809143338
DONE TAKING  40  STEPS.
Total reward:  -231.39924227487958
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.66500813367629
DONE TAKING  40  STEPS.
Total reward:  -404.6583245821979
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.160117680976644
DONE TAKING  40  STEPS.
Total reward:  -488.6735020238798
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -17.608775478321313
DONE TAKING  40  STEPS.
Total reward:  -392.98704321353347
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -10.109782485922945
DONE TAKING  40  STEPS.
Total reward:  103.21986066404148
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 104
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  104
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49092367239165724
    val rand:  0
    val onPol:  0.34832533697287243

=== Epoch 10 ===
    train loss:  0.24691286970648849
    val rand:  0
    val onPol:  0.28664273768663406

=== Epoch 20 ===
    train loss:  0.21137653683361254
    val rand:  0
    val onPol:  0.2798154254754384

=== Epoch 30 ===
    train loss:  0.1872772584881699
    val rand:  0
    val onPol:  0.28311750292778015

=== Epoch 39 ===
    train loss:  0.17126101621410303
    val rand:  0
    val onPol:  0.28696976602077484
Training duration: 14.34 s

#####################################
performing on-policy MPC rollouts... iter  104
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -30.822112607769668
DONE TAKING  40  STEPS.
Total reward:  -787.8804448992536
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -16.27666146929669
DONE TAKING  40  STEPS.
Total reward:  -323.6140075956605
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -18.349532680802678
DONE TAKING  40  STEPS.
Total reward:  -517.8531573110893
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -31.356714219011725
DONE TAKING  40  STEPS.
Total reward:  -660.0143161083461
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -21.840789595738748
DONE TAKING  40  STEPS.
Total reward:  -442.0201982018432
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.31397957059899
DONE TAKING  40  STEPS.
Total reward:  -610.8606770321929
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -22.00776070958199
DONE TAKING  40  STEPS.
Total reward:  -870.9383587527794
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -20.939889830786193
DONE TAKING  40  STEPS.
Total reward:  -444.80236321967345
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -26.566474886121586
DONE TAKING  40  STEPS.
Total reward:  -461.9437884558314
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -26.453483885081063
DONE TAKING  40  STEPS.
Total reward:  -1065.6531744719719
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.12047876178765
DONE TAKING  40  STEPS.
Total reward:  -840.0118667919003
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -28.672864991526843
DONE TAKING  40  STEPS.
Total reward:  -1022.2771826903828
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -31.41412925987745
DONE TAKING  40  STEPS.
Total reward:  -627.7093052261022
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.120749188461534
DONE TAKING  40  STEPS.
Total reward:  -305.89585661018515
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -21.89862290966412
DONE TAKING  40  STEPS.
Total reward:  -693.4257665939556
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -24.286422738098636
DONE TAKING  40  STEPS.
Total reward:  -659.0546874407511
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -21.569830472677964
DONE TAKING  40  STEPS.
Total reward:  -406.7811328957676
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.253981632606063
DONE TAKING  40  STEPS.
Total reward:  -570.0135009705734
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.37399133626376
DONE TAKING  40  STEPS.
Total reward:  -732.741752063608
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.49844241198769
DONE TAKING  40  STEPS.
Total reward:  -866.6261669632137
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.922021505401585
DONE TAKING  40  STEPS.
Total reward:  354.3380721977134
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.86388061778047
DONE TAKING  40  STEPS.
Total reward:  -510.2992828841541
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -30.177926290664857
DONE TAKING  40  STEPS.
Total reward:  -639.357462651143
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -25.149560793468755
DONE TAKING  40  STEPS.
Total reward:  -510.0791347579323
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.543819715121053
DONE TAKING  40  STEPS.
Total reward:  -345.0661471626957
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.885511260388363
DONE TAKING  40  STEPS.
Total reward:  -621.3900830367041
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.08573751085924
DONE TAKING  40  STEPS.
Total reward:  -630.6205953709646
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.563362919596756
DONE TAKING  40  STEPS.
Total reward:  -913.2472765474495
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -13.138897206839859
DONE TAKING  40  STEPS.
Total reward:  -352.86673883844634
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -29.187151093781885
DONE TAKING  40  STEPS.
Total reward:  -941.213350116918
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.017968774942194
DONE TAKING  40  STEPS.
Total reward:  -544.9654924378871
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -27.00214911684109
DONE TAKING  40  STEPS.
Total reward:  -516.233048087423
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -21.62718837323338
DONE TAKING  40  STEPS.
Total reward:  -466.40131211614994
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.19146369281792
DONE TAKING  40  STEPS.
Total reward:  -706.2198929744968
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -28.346847051056464
DONE TAKING  40  STEPS.
Total reward:  -684.467870524729
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -18.73362958899409
DONE TAKING  40  STEPS.
Total reward:  -543.3880412755365
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -27.398050273931958
DONE TAKING  40  STEPS.
Total reward:  -355.75580979057554
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -22.187263029945825
DONE TAKING  40  STEPS.
Total reward:  -226.70518027016857
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.158934729763793
DONE TAKING  40  STEPS.
Total reward:  -781.0201639677417
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -11.176950445545778
DONE TAKING  40  STEPS.
Total reward:  -276.03461288414076
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 105
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  105
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49709628914531906
    val rand:  0
    val onPol:  0.3582296272118886

=== Epoch 10 ===
    train loss:  0.24783902942088612
    val rand:  0
    val onPol:  0.29338008165359497

=== Epoch 20 ===
    train loss:  0.21415463821929798
    val rand:  0
    val onPol:  0.28847693651914597

=== Epoch 30 ===
    train loss:  0.1906102310147202
    val rand:  0
    val onPol:  0.2895452330509822

=== Epoch 39 ===
    train loss:  0.1735240634073291
    val rand:  0
    val onPol:  0.29456761479377747
Training duration: 14.31 s

#####################################
performing on-policy MPC rollouts... iter  105
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.695359260987324
DONE TAKING  40  STEPS.
Total reward:  -467.66761252286386
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.021168490390743
DONE TAKING  40  STEPS.
Total reward:  178.00658708406252
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.261881263312397
DONE TAKING  40  STEPS.
Total reward:  -918.7949896063349
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -17.29351190147929
DONE TAKING  40  STEPS.
Total reward:  -484.88655255755896
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.53551395641377
DONE TAKING  40  STEPS.
Total reward:  -52.93449195687601
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.175098046997974
DONE TAKING  40  STEPS.
Total reward:  -588.6690312834396
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.2006008957518
DONE TAKING  40  STEPS.
Total reward:  -309.7137480793032
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.517560585391685
DONE TAKING  40  STEPS.
Total reward:  -761.7552671870785
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.253317803078787
DONE TAKING  40  STEPS.
Total reward:  -494.0183701728458
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -27.042451822471477
DONE TAKING  40  STEPS.
Total reward:  -1002.1908960613009
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.44825514521996
DONE TAKING  40  STEPS.
Total reward:  -136.6338497234649
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.240847075826007
DONE TAKING  40  STEPS.
Total reward:  -253.66908357668243
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -23.491170452232957
DONE TAKING  40  STEPS.
Total reward:  -842.9964089772565
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -31.20518283420865
DONE TAKING  40  STEPS.
Total reward:  -615.8734478615914
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -27.21263691814275
DONE TAKING  40  STEPS.
Total reward:  -760.3406216753056
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.58782007868058
DONE TAKING  40  STEPS.
Total reward:  -847.3246562490103
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -20.74770875996569
DONE TAKING  40  STEPS.
Total reward:  -767.8060176037121
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.6670647405616
DONE TAKING  40  STEPS.
Total reward:  -827.0825893956069
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -13.824005470931537
DONE TAKING  40  STEPS.
Total reward:  -314.33039694943903
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -12.328021518376664
DONE TAKING  40  STEPS.
Total reward:  -341.2556270526982
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -26.99417555552099
DONE TAKING  40  STEPS.
Total reward:  -520.2603418068474
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.591850209558068
DONE TAKING  40  STEPS.
Total reward:  -490.52271014753137
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.08677042267785
DONE TAKING  40  STEPS.
Total reward:  -590.9335649074679
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -13.820624961522466
DONE TAKING  40  STEPS.
Total reward:  -530.9430425089168
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.820004910924276
DONE TAKING  40  STEPS.
Total reward:  -551.3870502446061
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -22.60571432403777
DONE TAKING  40  STEPS.
Total reward:  -586.9553682546664
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.99097978883085
DONE TAKING  40  STEPS.
Total reward:  -804.2777308454486
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -26.393091044792335
DONE TAKING  40  STEPS.
Total reward:  -435.7448576247919
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.013707504071817
DONE TAKING  40  STEPS.
Total reward:  -483.8950273072192
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.383948748995795
DONE TAKING  40  STEPS.
Total reward:  -756.3450196758507
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -15.51128896091181
DONE TAKING  40  STEPS.
Total reward:  -427.3212398319471
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -28.909022893983515
DONE TAKING  40  STEPS.
Total reward:  -805.4671565302135
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -29.83929191570561
DONE TAKING  40  STEPS.
Total reward:  -910.2725107570107
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -29.328019017767804
DONE TAKING  40  STEPS.
Total reward:  -1044.7037457733745
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.38762127917679
DONE TAKING  40  STEPS.
Total reward:  -651.037620084359
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.62359821276185
DONE TAKING  40  STEPS.
Total reward:  -553.539984629211
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -13.106201707353105
DONE TAKING  40  STEPS.
Total reward:  -224.28110845890532
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.01935410216061
DONE TAKING  40  STEPS.
Total reward:  -934.8861665600169
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.983414640716546
DONE TAKING  40  STEPS.
Total reward:  -783.7464106575028
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.89754457201178
DONE TAKING  40  STEPS.
Total reward:  -562.7997853200241
Time for 1 rollout: 0.90 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 106
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  106
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4950262125124011
    val rand:  0
    val onPol:  0.37756572663784027

=== Epoch 10 ===
    train loss:  0.24951281359321192
    val rand:  0
    val onPol:  0.315308337410291

=== Epoch 20 ===
    train loss:  0.21398347041063143
    val rand:  0
    val onPol:  0.3081560159722964

=== Epoch 30 ===
    train loss:  0.18970458366368947
    val rand:  0
    val onPol:  0.30945488810539246

=== Epoch 39 ===
    train loss:  0.171965098956175
    val rand:  0
    val onPol:  0.31366199751694995
Training duration: 14.36 s

#####################################
performing on-policy MPC rollouts... iter  106
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.19895859853672
DONE TAKING  40  STEPS.
Total reward:  -595.1173489839894
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -26.380207345379283
DONE TAKING  40  STEPS.
Total reward:  -557.489187060419
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.55178379856889
DONE TAKING  40  STEPS.
Total reward:  -374.0023325414125
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -23.2231291908262
DONE TAKING  40  STEPS.
Total reward:  -567.2156417116294
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.335685879557023
DONE TAKING  40  STEPS.
Total reward:  -721.9574634147767
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -21.742107031418954
DONE TAKING  40  STEPS.
Total reward:  -657.1507275681865
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -14.968462471047484
DONE TAKING  40  STEPS.
Total reward:  -406.93103528736503
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.381366330454608
DONE TAKING  40  STEPS.
Total reward:  -504.6396562506397
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.576284085320072
DONE TAKING  40  STEPS.
Total reward:  -946.2122806673676
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.330424433316164
DONE TAKING  40  STEPS.
Total reward:  -580.9782762137831
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.90550122211802
DONE TAKING  40  STEPS.
Total reward:  -494.4760538252091
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -16.152033918639905
DONE TAKING  40  STEPS.
Total reward:  -288.6330818117673
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -25.926066636426203
DONE TAKING  40  STEPS.
Total reward:  -884.5978071963743
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -20.44862864312747
DONE TAKING  40  STEPS.
Total reward:  223.98731370546358
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.4445672701652
DONE TAKING  40  STEPS.
Total reward:  -767.9880472323179
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -27.520849344219055
DONE TAKING  40  STEPS.
Total reward:  -1070.8203952668127
Time for 1 rollout: 0.89 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -20.49860884260161
DONE TAKING  40  STEPS.
Total reward:  -572.7387774299945
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.940895977040906
DONE TAKING  40  STEPS.
Total reward:  -952.5690157037645
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -28.108914109622752
DONE TAKING  40  STEPS.
Total reward:  -606.9109260047569
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -22.50072680103719
DONE TAKING  40  STEPS.
Total reward:  -520.1067346193029
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.27136206765059
DONE TAKING  40  STEPS.
Total reward:  -592.0645804077374
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.74932195990857
DONE TAKING  40  STEPS.
Total reward:  -469.09765522414716
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.308202623814765
DONE TAKING  40  STEPS.
Total reward:  -613.463844986336
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -20.183610100257333
DONE TAKING  40  STEPS.
Total reward:  -567.1359688656306
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -16.797984722435093
DONE TAKING  40  STEPS.
Total reward:  -294.18253821136403
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.990484026463132
DONE TAKING  40  STEPS.
Total reward:  -373.6540222437598
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -21.21456483589503
DONE TAKING  40  STEPS.
Total reward:  -493.037556696317
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -18.08746571877986
DONE TAKING  40  STEPS.
Total reward:  -353.1614200116091
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.243371032165037
DONE TAKING  40  STEPS.
Total reward:  -866.3865411846034
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -15.242337007897603
DONE TAKING  40  STEPS.
Total reward:  -366.13740040007156
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.97821092012805
DONE TAKING  40  STEPS.
Total reward:  -525.1956178698555
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -15.912323954962059
DONE TAKING  40  STEPS.
Total reward:  -410.62759954021
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.839699867364555
DONE TAKING  40  STEPS.
Total reward:  -1043.2519169209545
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.475443735829465
DONE TAKING  40  STEPS.
Total reward:  -996.4438415289691
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.207981861984578
DONE TAKING  40  STEPS.
Total reward:  -463.12555080286046
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.040942322887656
DONE TAKING  40  STEPS.
Total reward:  51.32075570677811
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.718493607343646
DONE TAKING  40  STEPS.
Total reward:  -586.4164513956167
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -27.21688885898235
DONE TAKING  40  STEPS.
Total reward:  -650.6305809899198
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -26.517003990039395
DONE TAKING  40  STEPS.
Total reward:  -450.62650989101417
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -20.27913263180356
DONE TAKING  40  STEPS.
Total reward:  -251.3116792205484
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 107
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  107
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4990077986006151
    val rand:  0
    val onPol:  0.3763618717590968

=== Epoch 10 ===
    train loss:  0.2517135349804895
    val rand:  0
    val onPol:  0.31105170398950577

=== Epoch 20 ===
    train loss:  0.2136287046106238
    val rand:  0
    val onPol:  0.30699658890565235

=== Epoch 30 ===
    train loss:  0.18876674980448002
    val rand:  0
    val onPol:  0.30972282588481903

=== Epoch 39 ===
    train loss:  0.17234907939768673
    val rand:  0
    val onPol:  0.313626987238725
Training duration: 14.56 s

#####################################
performing on-policy MPC rollouts... iter  107
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -12.643329543483386
DONE TAKING  40  STEPS.
Total reward:  -350.62929260835614
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -9.714158241425455
DONE TAKING  40  STEPS.
Total reward:  -364.15271483415694
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -26.135111808836676
DONE TAKING  40  STEPS.
Total reward:  -854.4237262478869
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.47235418984087
DONE TAKING  40  STEPS.
Total reward:  -850.9144489083678
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -22.594423989125172
DONE TAKING  40  STEPS.
Total reward:  -519.9976064339274
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -30.02291718566188
DONE TAKING  40  STEPS.
Total reward:  -1117.490028554574
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -16.890907161997355
DONE TAKING  40  STEPS.
Total reward:  -160.02397079104128
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.358124006208296
DONE TAKING  40  STEPS.
Total reward:  37.71673199591835
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.875190506219326
DONE TAKING  40  STEPS.
Total reward:  -463.10723664477297
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.959998950344318
DONE TAKING  40  STEPS.
Total reward:  -399.5116798988152
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.24752868844565
DONE TAKING  40  STEPS.
Total reward:  -98.27702773771364
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.32619547321665
DONE TAKING  40  STEPS.
Total reward:  -1098.0645013270903
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.748057635996624
DONE TAKING  40  STEPS.
Total reward:  -1057.5591501800263
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -31.001756968105806
DONE TAKING  40  STEPS.
Total reward:  -859.5698583162957
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -12.948224910370643
DONE TAKING  40  STEPS.
Total reward:  -306.92440072642074
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.395662714014527
DONE TAKING  40  STEPS.
Total reward:  -413.6131326247803
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.859312583402474
DONE TAKING  40  STEPS.
Total reward:  -739.696322284191
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -12.716502841945236
DONE TAKING  40  STEPS.
Total reward:  -386.3524558412149
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -16.471218585769684
DONE TAKING  40  STEPS.
Total reward:  -320.48113062074543
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -17.206173277062714
DONE TAKING  40  STEPS.
Total reward:  -354.29185733060285
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.32685247017902
DONE TAKING  40  STEPS.
Total reward:  -423.8808026791584
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -29.193502996819415
DONE TAKING  40  STEPS.
Total reward:  -923.0239021485118
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -23.867971215691558
DONE TAKING  40  STEPS.
Total reward:  -434.3326452386314
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.575597511394484
DONE TAKING  40  STEPS.
Total reward:  -830.1779056998486
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -25.719507923921544
DONE TAKING  40  STEPS.
Total reward:  -724.7166240271857
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.758164969023294
DONE TAKING  40  STEPS.
Total reward:  -819.621153519078
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.99029234658728
DONE TAKING  40  STEPS.
Total reward:  -466.23973479886695
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.323085061457263
DONE TAKING  40  STEPS.
Total reward:  -408.9930186378301
Time for 1 rollout: 1.22 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.957548895430286
DONE TAKING  40  STEPS.
Total reward:  -540.2063609364922
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -21.816549830703032
DONE TAKING  40  STEPS.
Total reward:  -401.62870099696823
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -28.46736590640549
DONE TAKING  40  STEPS.
Total reward:  -1092.3780507860781
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -22.87782146075906
DONE TAKING  40  STEPS.
Total reward:  -726.1194477159894
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.349140657847986
DONE TAKING  40  STEPS.
Total reward:  -830.6043066305532
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -13.595318202326398
DONE TAKING  40  STEPS.
Total reward:  -393.70371292011396
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -16.124558080952283
DONE TAKING  40  STEPS.
Total reward:  -457.0017370997046
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -9.492683610768447
DONE TAKING  40  STEPS.
Total reward:  -92.18179503561362
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -19.72716509213488
DONE TAKING  40  STEPS.
Total reward:  -531.1197435149184
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.832879433134927
DONE TAKING  40  STEPS.
Total reward:  -660.9663109506238
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -16.86428982956944
DONE TAKING  40  STEPS.
Total reward:  -329.437210358129
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.78737719641419
DONE TAKING  40  STEPS.
Total reward:  -318.26604664786515
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 108
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  108
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5027104339055848
    val rand:  0
    val onPol:  0.37924916048844654

=== Epoch 10 ===
    train loss:  0.24803064737403602
    val rand:  0
    val onPol:  0.31121966739495593

=== Epoch 20 ===
    train loss:  0.21578555985500938
    val rand:  0
    val onPol:  0.30766164014736813

=== Epoch 30 ===
    train loss:  0.19207181271753812
    val rand:  0
    val onPol:  0.30848904699087143

=== Epoch 39 ===
    train loss:  0.1749011479448854
    val rand:  0
    val onPol:  0.3143325249354045
Training duration: 14.51 s

#####################################
performing on-policy MPC rollouts... iter  108
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -13.817602425686148
DONE TAKING  40  STEPS.
Total reward:  -266.53201116007045
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.905924448383594
DONE TAKING  40  STEPS.
Total reward:  -785.1278772944357
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -27.560756913611915
DONE TAKING  40  STEPS.
Total reward:  -856.529395714485
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.85420560357105
DONE TAKING  40  STEPS.
Total reward:  -536.4700609803975
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.725976156633607
DONE TAKING  40  STEPS.
Total reward:  -964.4177834872057
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -29.977945066603766
DONE TAKING  40  STEPS.
Total reward:  -679.7803978896693
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.205079452709604
DONE TAKING  40  STEPS.
Total reward:  -791.1003564720602
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -22.682634438450606
DONE TAKING  40  STEPS.
Total reward:  -297.20042861971234
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.022686356361923
DONE TAKING  40  STEPS.
Total reward:  -595.1355568145524
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -17.74599783584111
DONE TAKING  40  STEPS.
Total reward:  -727.0771002472071
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -16.019310716071594
DONE TAKING  40  STEPS.
Total reward:  355.26423887661343
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.631654021453514
DONE TAKING  40  STEPS.
Total reward:  -688.3304482032368
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -24.47885848075356
DONE TAKING  40  STEPS.
Total reward:  -478.9841260156101
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -19.77544604336519
DONE TAKING  40  STEPS.
Total reward:  156.85088946486138
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.86736063509706
DONE TAKING  40  STEPS.
Total reward:  -951.3251001493917
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.236500409417275
DONE TAKING  40  STEPS.
Total reward:  -501.77033239898276
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -20.78136011183771
DONE TAKING  40  STEPS.
Total reward:  -347.73811173162653
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.84734455391056
DONE TAKING  40  STEPS.
Total reward:  -310.2007591129729
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.524843213354934
DONE TAKING  40  STEPS.
Total reward:  -1020.2801536614934
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -9.840040797095517
DONE TAKING  40  STEPS.
Total reward:  438.00871288540924
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.51416872257711
DONE TAKING  40  STEPS.
Total reward:  -1077.5149234838696
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -25.22492949367358
DONE TAKING  40  STEPS.
Total reward:  -521.4701822063113
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -30.689396422913767
DONE TAKING  40  STEPS.
Total reward:  -791.6132825768561
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.11511648777923
DONE TAKING  40  STEPS.
Total reward:  -999.7299762730556
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -13.853500534982107
DONE TAKING  40  STEPS.
Total reward:  -422.65616605616424
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -17.402207543793796
DONE TAKING  40  STEPS.
Total reward:  -577.404429254502
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.93636182498548
DONE TAKING  40  STEPS.
Total reward:  -453.9474157056393
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.05453816736368
DONE TAKING  40  STEPS.
Total reward:  -862.8324079283981
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.22261946802565
DONE TAKING  40  STEPS.
Total reward:  -571.6334329464974
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.158920292700152
DONE TAKING  40  STEPS.
Total reward:  -697.8923318736294
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -20.52766322184
DONE TAKING  40  STEPS.
Total reward:  -470.49060542266903
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -10.168709860494111
DONE TAKING  40  STEPS.
Total reward:  179.40677120361238
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.46566939922141
DONE TAKING  40  STEPS.
Total reward:  -503.01642666715315
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -28.04826605182766
DONE TAKING  40  STEPS.
Total reward:  -1120.4970054548469
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.40559016154046
DONE TAKING  40  STEPS.
Total reward:  -655.20947457676
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.35028545897542
DONE TAKING  40  STEPS.
Total reward:  -482.8947842987284
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -26.925166289351786
DONE TAKING  40  STEPS.
Total reward:  -945.8172873469679
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.406035006793633
DONE TAKING  40  STEPS.
Total reward:  -736.6987433448312
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -19.169251347985853
DONE TAKING  40  STEPS.
Total reward:  -361.63377786861145
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -17.44201580204179
DONE TAKING  40  STEPS.
Total reward:  -400.63443830607315
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 109
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  109
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5109760478923195
    val rand:  0
    val onPol:  0.36585205296675366

=== Epoch 10 ===
    train loss:  0.2531294595254095
    val rand:  0
    val onPol:  0.30131254345178604

=== Epoch 20 ===
    train loss:  0.21683151104993986
    val rand:  0
    val onPol:  0.2985434979200363

=== Epoch 30 ===
    train loss:  0.19386695325374603
    val rand:  0
    val onPol:  0.29961111893256503

=== Epoch 39 ===
    train loss:  0.1749152698014912
    val rand:  0
    val onPol:  0.3052175318201383
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  109
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -29.27657408665641
DONE TAKING  40  STEPS.
Total reward:  -653.2258040401438
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -23.918991585937796
DONE TAKING  40  STEPS.
Total reward:  -342.4979588806534
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -29.87252790862588
DONE TAKING  40  STEPS.
Total reward:  -607.1116243799233
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.124525748272582
DONE TAKING  40  STEPS.
Total reward:  -743.8195937959872
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.336887867413367
DONE TAKING  40  STEPS.
Total reward:  -70.58755513939663
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.19069507244355
DONE TAKING  40  STEPS.
Total reward:  -508.92005666068286
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.48527519636487
DONE TAKING  40  STEPS.
Total reward:  -804.4281273357467
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -14.439946330075784
DONE TAKING  40  STEPS.
Total reward:  -501.22800041344163
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -14.702996413974974
DONE TAKING  40  STEPS.
Total reward:  -326.0422149738362
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.164339821778228
DONE TAKING  40  STEPS.
Total reward:  -531.7605656992398
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.526596160192604
DONE TAKING  40  STEPS.
Total reward:  -433.5648221812362
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -22.717687953921995
DONE TAKING  40  STEPS.
Total reward:  -654.7789352921556
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -29.423810413993724
DONE TAKING  40  STEPS.
Total reward:  -1077.9453369027062
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.549227034401113
DONE TAKING  40  STEPS.
Total reward:  -486.18891756671405
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -25.57202587833784
DONE TAKING  40  STEPS.
Total reward:  -957.7409071611704
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -28.608653471168314
DONE TAKING  40  STEPS.
Total reward:  -987.0585609909275
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.701101566839114
DONE TAKING  40  STEPS.
Total reward:  -606.0747781349343
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.70318333187842
DONE TAKING  40  STEPS.
Total reward:  -773.6842540997717
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -19.622089353162405
DONE TAKING  40  STEPS.
Total reward:  -432.0952026440293
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -15.91868547376625
DONE TAKING  40  STEPS.
Total reward:  -572.2983243974809
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -11.823745160360446
DONE TAKING  40  STEPS.
Total reward:  -66.78161972636767
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -20.60417179654341
DONE TAKING  40  STEPS.
Total reward:  -391.05752043607407
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.441301762829074
DONE TAKING  40  STEPS.
Total reward:  -578.257973939849
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -16.90920596298182
DONE TAKING  40  STEPS.
Total reward:  306.40099221873555
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -15.549479260866931
DONE TAKING  40  STEPS.
Total reward:  -456.3926033569961
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -31.30070166447414
DONE TAKING  40  STEPS.
Total reward:  -971.6689508548563
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -28.52092883027639
DONE TAKING  40  STEPS.
Total reward:  -866.3907972661593
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -18.16366474515176
DONE TAKING  40  STEPS.
Total reward:  -531.6654261106661
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.763091414675138
DONE TAKING  40  STEPS.
Total reward:  -957.1654037363704
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.1609906771752
DONE TAKING  40  STEPS.
Total reward:  -615.5144411613211
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.404955849995165
DONE TAKING  40  STEPS.
Total reward:  -994.9627101150435
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -23.939282008474226
DONE TAKING  40  STEPS.
Total reward:  -817.9260780201572
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -22.35846537067885
DONE TAKING  40  STEPS.
Total reward:  -542.5180056118318
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -25.51366069562031
DONE TAKING  40  STEPS.
Total reward:  -936.6521220980915
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -21.600625974600668
DONE TAKING  40  STEPS.
Total reward:  -513.5792521850336
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -22.26496039514844
DONE TAKING  40  STEPS.
Total reward:  -392.77776328463005
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -25.094201798978876
DONE TAKING  40  STEPS.
Total reward:  -521.4336365118206
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.56272080548158
DONE TAKING  40  STEPS.
Total reward:  -410.59030964135053
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -28.991337513777218
DONE TAKING  40  STEPS.
Total reward:  -760.6742799961896
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.32287886132605
DONE TAKING  40  STEPS.
Total reward:  -427.0806380698002
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  4
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 110
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  110
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5121896507447226
    val rand:  0
    val onPol:  0.3641871412595113

=== Epoch 10 ===
    train loss:  0.251344465895703
    val rand:  0
    val onPol:  0.29861778765916824

=== Epoch 20 ===
    train loss:  0.21457750938440623
    val rand:  0
    val onPol:  0.29231241593758267

=== Epoch 30 ===
    train loss:  0.19264969020559078
    val rand:  0
    val onPol:  0.29365309327840805

=== Epoch 39 ===
    train loss:  0.17396561409297742
    val rand:  0
    val onPol:  0.29883352667093277
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  110
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.728142938947162
DONE TAKING  40  STEPS.
Total reward:  -380.4424975062485
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.6136454099363
DONE TAKING  40  STEPS.
Total reward:  -822.4790247679554
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -23.440116535420465
DONE TAKING  40  STEPS.
Total reward:  -333.1121114343231
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -18.196849738210087
DONE TAKING  40  STEPS.
Total reward:  -487.1390698689606
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -24.207494121009205
DONE TAKING  40  STEPS.
Total reward:  -318.96128505214585
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -12.265145703821696
DONE TAKING  40  STEPS.
Total reward:  -390.9117832726468
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -12.784962604246694
DONE TAKING  40  STEPS.
Total reward:  -11.215586688214755
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.080603389605436
DONE TAKING  40  STEPS.
Total reward:  -1066.5452283234713
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.054487361743227
DONE TAKING  40  STEPS.
Total reward:  -611.0654069881265
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -20.21127035383905
DONE TAKING  40  STEPS.
Total reward:  -335.56746728304347
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.7965723243033
DONE TAKING  40  STEPS.
Total reward:  -546.5439986010904
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -16.71972229684661
DONE TAKING  40  STEPS.
Total reward:  -379.5678159994865
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -29.239691997832452
DONE TAKING  40  STEPS.
Total reward:  -956.1542205611644
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -28.618035752522204
DONE TAKING  40  STEPS.
Total reward:  -787.5628821296143
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -16.30221053951166
DONE TAKING  40  STEPS.
Total reward:  -347.4020832543389
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -25.50734805499935
DONE TAKING  40  STEPS.
Total reward:  -480.03966534702545
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.547080145899226
DONE TAKING  40  STEPS.
Total reward:  -367.4356326084113
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.55563256741263
DONE TAKING  40  STEPS.
Total reward:  -517.4713972200428
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -17.695461357557956
DONE TAKING  40  STEPS.
Total reward:  -551.1160545934222
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.648551890272117
DONE TAKING  40  STEPS.
Total reward:  -731.4544286533862
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -13.385282743305089
DONE TAKING  40  STEPS.
Total reward:  -87.50874862116257
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -31.301911208363112
DONE TAKING  40  STEPS.
Total reward:  -976.7030150619015
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.934900688841594
DONE TAKING  40  STEPS.
Total reward:  -352.97040524216226
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.931035522538238
DONE TAKING  40  STEPS.
Total reward:  -632.3486090777188
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -25.144237089110362
DONE TAKING  40  STEPS.
Total reward:  -513.2930514997862
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.256623841828823
DONE TAKING  40  STEPS.
Total reward:  -997.264205342399
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.164469534744498
DONE TAKING  40  STEPS.
Total reward:  -732.7082233586269
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -19.435384635842784
DONE TAKING  40  STEPS.
Total reward:  -98.68764873869111
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -13.430516214570067
DONE TAKING  40  STEPS.
Total reward:  -312.800777427773
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.854675088565166
DONE TAKING  40  STEPS.
Total reward:  -734.053400462342
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.033391550968204
DONE TAKING  40  STEPS.
Total reward:  -690.5743897656336
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.641217850541622
DONE TAKING  40  STEPS.
Total reward:  -790.1860278180341
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -26.635805745328213
DONE TAKING  40  STEPS.
Total reward:  -489.52439789346795
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.824432172917803
DONE TAKING  40  STEPS.
Total reward:  -963.2534870934822
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.777010427487873
DONE TAKING  40  STEPS.
Total reward:  -359.0097150878109
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -24.571116252251244
DONE TAKING  40  STEPS.
Total reward:  -490.2310510827736
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -21.226180476823984
DONE TAKING  40  STEPS.
Total reward:  -581.5984710895284
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.355899550616925
DONE TAKING  40  STEPS.
Total reward:  -830.745204380319
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.323534993617777
DONE TAKING  40  STEPS.
Total reward:  -446.56937182629264
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -16.47684894397418
DONE TAKING  40  STEPS.
Total reward:  -46.534656276961066
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 111
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  111
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5061869626505333
    val rand:  0
    val onPol:  0.3579484174648921

=== Epoch 10 ===
    train loss:  0.25319524658353704
    val rand:  0
    val onPol:  0.2935165911912918

=== Epoch 20 ===
    train loss:  0.21923506469057316
    val rand:  0
    val onPol:  0.2890310337146123

=== Epoch 30 ===
    train loss:  0.19407770534356436
    val rand:  0
    val onPol:  0.28907714784145355

=== Epoch 39 ===
    train loss:  0.1748894439977512
    val rand:  0
    val onPol:  0.2949400395154953
Training duration: 14.21 s

#####################################
performing on-policy MPC rollouts... iter  111
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -11.810727219350605
DONE TAKING  40  STEPS.
Total reward:  -302.85596096587807
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.798558690250385
DONE TAKING  40  STEPS.
Total reward:  -642.3456985959555
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.689600143846917
DONE TAKING  40  STEPS.
Total reward:  -624.6734096359127
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.13161156701144
DONE TAKING  40  STEPS.
Total reward:  -550.1895010144895
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.905304438242933
DONE TAKING  40  STEPS.
Total reward:  -685.8143045654436
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -15.527262687295813
DONE TAKING  40  STEPS.
Total reward:  -469.4270788827182
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.52600932125847
DONE TAKING  40  STEPS.
Total reward:  -769.3712190521312
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.68171289239547
DONE TAKING  40  STEPS.
Total reward:  -734.8316027112645
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -14.639425000004389
DONE TAKING  40  STEPS.
Total reward:  -185.8481215767336
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -18.774504165055024
DONE TAKING  40  STEPS.
Total reward:  -755.181898722681
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.135987375800642
DONE TAKING  40  STEPS.
Total reward:  -571.1361001314983
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.30438772287707
DONE TAKING  40  STEPS.
Total reward:  -874.1195633501782
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -14.317853532869458
DONE TAKING  40  STEPS.
Total reward:  -815.8547912274676
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.251845090057927
DONE TAKING  40  STEPS.
Total reward:  -212.53696094684767
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.612742279710034
DONE TAKING  40  STEPS.
Total reward:  237.5477440199376
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.501619466330546
DONE TAKING  40  STEPS.
Total reward:  -620.2827373029536
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.187762271337036
DONE TAKING  40  STEPS.
Total reward:  -1021.3704592383691
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -30.793841272993955
DONE TAKING  40  STEPS.
Total reward:  -522.8424335921501
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.545430770412725
DONE TAKING  40  STEPS.
Total reward:  -599.1244925069833
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.18663850983959
DONE TAKING  40  STEPS.
Total reward:  -419.274694860362
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -14.73380119467459
DONE TAKING  40  STEPS.
Total reward:  -391.0653238660474
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.076478399951988
DONE TAKING  40  STEPS.
Total reward:  -520.1110207781571
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.532836843453325
DONE TAKING  40  STEPS.
Total reward:  -265.94394785323436
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -17.49855964849954
DONE TAKING  40  STEPS.
Total reward:  -457.2891075061839
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -28.787965031369115
DONE TAKING  40  STEPS.
Total reward:  -760.8000662763168
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -30.74203555248402
DONE TAKING  40  STEPS.
Total reward:  -874.8770158232747
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -30.663349198449794
DONE TAKING  40  STEPS.
Total reward:  -736.3998420575278
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -31.099635717376962
DONE TAKING  40  STEPS.
Total reward:  -774.347288993541
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -18.295566971659674
DONE TAKING  40  STEPS.
Total reward:  -316.6453468978011
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -20.426643739054704
DONE TAKING  40  STEPS.
Total reward:  -216.18442352576565
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -18.86305572208848
DONE TAKING  40  STEPS.
Total reward:  -620.9027394121372
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -29.245840269589117
DONE TAKING  40  STEPS.
Total reward:  -657.688394632848
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -23.834035887669597
DONE TAKING  40  STEPS.
Total reward:  -722.2236999533529
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -16.32780367041478
DONE TAKING  40  STEPS.
Total reward:  -463.12913202817697
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -15.006778609065003
DONE TAKING  40  STEPS.
Total reward:  -443.0136563216474
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -25.651810126725376
DONE TAKING  40  STEPS.
Total reward:  -514.7603524123718
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -13.879710303520369
DONE TAKING  40  STEPS.
Total reward:  -452.9796397448927
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -28.583683790717494
DONE TAKING  40  STEPS.
Total reward:  -717.8172042657018
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -29.837031269178894
DONE TAKING  40  STEPS.
Total reward:  -1167.6056435085698
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.67502131272384
DONE TAKING  40  STEPS.
Total reward:  -103.02901504145595
Time for 1 rollout: 1.08 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 112
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  112
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5019612066578447
    val rand:  0
    val onPol:  0.35977089405059814

=== Epoch 10 ===
    train loss:  0.2507362935626716
    val rand:  0
    val onPol:  0.2936953728397687

=== Epoch 20 ===
    train loss:  0.21788079252368525
    val rand:  0
    val onPol:  0.28804080933332443

=== Epoch 30 ===
    train loss:  0.19208407402038574
    val rand:  0
    val onPol:  0.29033688455820084

=== Epoch 39 ===
    train loss:  0.17505717277526855
    val rand:  0
    val onPol:  0.29462185750404996
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  112
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -13.483438841420039
DONE TAKING  40  STEPS.
Total reward:  382.58825424764467
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -24.497513076629993
DONE TAKING  40  STEPS.
Total reward:  -941.2443337783543
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.114142831402596
DONE TAKING  40  STEPS.
Total reward:  -535.6106569413719
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -17.32560623797196
DONE TAKING  40  STEPS.
Total reward:  -351.79966647577504
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -15.513276681860226
DONE TAKING  40  STEPS.
Total reward:  -461.0784372485586
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -25.45189704188988
DONE TAKING  40  STEPS.
Total reward:  -596.30611906025
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.93658654948861
DONE TAKING  40  STEPS.
Total reward:  -758.2060345347819
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -28.28545708051266
DONE TAKING  40  STEPS.
Total reward:  -554.4204028187548
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -25.595489030151445
DONE TAKING  40  STEPS.
Total reward:  -191.0366261983708
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.582429996585244
DONE TAKING  40  STEPS.
Total reward:  -789.5764858023157
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -23.756669448242462
DONE TAKING  40  STEPS.
Total reward:  -574.7172073565193
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -27.314845471876513
DONE TAKING  40  STEPS.
Total reward:  -882.9090782810457
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -23.979689182312455
DONE TAKING  40  STEPS.
Total reward:  -774.7058657001495
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -30.076257392494202
DONE TAKING  40  STEPS.
Total reward:  -997.3352827866208
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.157372584801294
DONE TAKING  40  STEPS.
Total reward:  -692.9801166592569
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.141510199540814
DONE TAKING  40  STEPS.
Total reward:  -768.4195969319815
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.49593238076591
DONE TAKING  40  STEPS.
Total reward:  -395.2389852262796
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -31.212371188342534
DONE TAKING  40  STEPS.
Total reward:  -733.496367007707
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -28.562089310857882
DONE TAKING  40  STEPS.
Total reward:  -600.1277548978545
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -20.813439715957294
DONE TAKING  40  STEPS.
Total reward:  -563.6812156258296
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.518120217986024
DONE TAKING  40  STEPS.
Total reward:  -332.8910372656035
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -21.13959327701645
DONE TAKING  40  STEPS.
Total reward:  -551.941478485877
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.835732455159373
DONE TAKING  40  STEPS.
Total reward:  55.08814078644457
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -20.85436224903325
DONE TAKING  40  STEPS.
Total reward:  -707.13885134096
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -22.523285095683597
DONE TAKING  40  STEPS.
Total reward:  -701.0476652980124
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.122618823953008
DONE TAKING  40  STEPS.
Total reward:  -994.787256504628
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -20.36820911229162
DONE TAKING  40  STEPS.
Total reward:  -547.3180316614867
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -29.379916089845626
DONE TAKING  40  STEPS.
Total reward:  -555.607387654766
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -23.17059614313251
DONE TAKING  40  STEPS.
Total reward:  -715.1263011577933
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -24.553563211010818
DONE TAKING  40  STEPS.
Total reward:  -697.7994452365433
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.49590711701383
DONE TAKING  40  STEPS.
Total reward:  -300.9973300185195
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.567703258873664
DONE TAKING  40  STEPS.
Total reward:  -495.01265818788283
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -19.837718576257547
DONE TAKING  40  STEPS.
Total reward:  -329.41080131782155
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.947654532188878
DONE TAKING  40  STEPS.
Total reward:  -859.4337908635526
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.54280307750065
DONE TAKING  40  STEPS.
Total reward:  -635.4993187254404
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -20.3777421834452
DONE TAKING  40  STEPS.
Total reward:  -312.46061049683294
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.932717864690254
DONE TAKING  40  STEPS.
Total reward:  -628.6569780986785
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.510054277368383
DONE TAKING  40  STEPS.
Total reward:  -494.3427256519357
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -27.77846758450233
DONE TAKING  40  STEPS.
Total reward:  -564.8955579384682
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.344947570412437
DONE TAKING  40  STEPS.
Total reward:  -416.3722037120927
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 113
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  113
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5109362173498723
    val rand:  0
    val onPol:  0.370905376970768

=== Epoch 10 ===
    train loss:  0.2517576303921248
    val rand:  0
    val onPol:  0.304493007560571

=== Epoch 20 ===
    train loss:  0.2174913404803527
    val rand:  0
    val onPol:  0.30124254028002423

=== Epoch 30 ===
    train loss:  0.19522981110372042
    val rand:  0
    val onPol:  0.30152976512908936

=== Epoch 39 ===
    train loss:  0.17393034173731217
    val rand:  0
    val onPol:  0.3060084680716197
Training duration: 14.24 s

#####################################
performing on-policy MPC rollouts... iter  113
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -24.6632181514018
DONE TAKING  40  STEPS.
Total reward:  -862.5877016293196
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.895424243720527
DONE TAKING  40  STEPS.
Total reward:  -519.1825936870888
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -17.716576829166716
DONE TAKING  40  STEPS.
Total reward:  -337.5935606595772
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.080931201322322
DONE TAKING  40  STEPS.
Total reward:  -676.4564732200201
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -9.672224624045727
DONE TAKING  40  STEPS.
Total reward:  -290.8730274320889
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.253063586216488
DONE TAKING  40  STEPS.
Total reward:  -833.3002226719225
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -12.70880425981748
DONE TAKING  40  STEPS.
Total reward:  -345.2304628075433
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -30.290837758408724
DONE TAKING  40  STEPS.
Total reward:  -198.4308525937134
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.944048531510614
DONE TAKING  40  STEPS.
Total reward:  -951.1098720496822
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -15.359835937473246
DONE TAKING  40  STEPS.
Total reward:  -352.8631128226732
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -18.232817999104377
DONE TAKING  40  STEPS.
Total reward:  -435.09847588437833
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -28.101630453610454
DONE TAKING  40  STEPS.
Total reward:  -737.9348405989871
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -18.560402685152873
DONE TAKING  40  STEPS.
Total reward:  -376.98595612881036
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.72530457390502
DONE TAKING  40  STEPS.
Total reward:  -792.3279467047873
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -21.550274830588087
DONE TAKING  40  STEPS.
Total reward:  -589.4723740961934
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -27.24669100893803
DONE TAKING  40  STEPS.
Total reward:  -922.3407798320098
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.74679380105139
DONE TAKING  40  STEPS.
Total reward:  -910.9877998544065
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -29.218867644701156
DONE TAKING  40  STEPS.
Total reward:  -752.3419074559883
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.66689365043574
DONE TAKING  40  STEPS.
Total reward:  -827.0480539160914
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.663883142743153
DONE TAKING  40  STEPS.
Total reward:  -274.832938923139
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.69905344622507
DONE TAKING  40  STEPS.
Total reward:  -1052.2868015114077
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.79440536214468
DONE TAKING  40  STEPS.
Total reward:  -531.6139564511839
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -31.018955619822208
DONE TAKING  40  STEPS.
Total reward:  -552.7376529078043
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.281913001792454
DONE TAKING  40  STEPS.
Total reward:  -508.22395580964303
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -26.55883932662354
DONE TAKING  40  STEPS.
Total reward:  -497.4024596896203
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -21.533164388325325
DONE TAKING  40  STEPS.
Total reward:  -417.07581831167056
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.158159588355787
DONE TAKING  40  STEPS.
Total reward:  -887.609428610331
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.972080722239696
DONE TAKING  40  STEPS.
Total reward:  -844.9525418507014
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.105647282052956
DONE TAKING  40  STEPS.
Total reward:  -689.8349122727842
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -22.40665870156092
DONE TAKING  40  STEPS.
Total reward:  -424.677193687588
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.331620085420717
DONE TAKING  40  STEPS.
Total reward:  -702.0123895638844
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.209511550800986
DONE TAKING  40  STEPS.
Total reward:  -309.02903985048727
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.405160458284705
DONE TAKING  40  STEPS.
Total reward:  -901.2719824931334
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.293872658149095
DONE TAKING  40  STEPS.
Total reward:  -309.81617584741565
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.493009608462664
DONE TAKING  40  STEPS.
Total reward:  -877.7625575434577
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -21.563992147590668
DONE TAKING  40  STEPS.
Total reward:  -777.5808173748436
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.90413658435907
DONE TAKING  40  STEPS.
Total reward:  -288.94224049595044
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.1482620068114
DONE TAKING  40  STEPS.
Total reward:  -701.9391294026293
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.806552875422895
DONE TAKING  40  STEPS.
Total reward:  -706.2541102914869
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -27.732492178108778
DONE TAKING  40  STEPS.
Total reward:  -918.2654345202546
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 114
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  114
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5022058696077581
    val rand:  0
    val onPol:  0.3838673233985901

=== Epoch 10 ===
    train loss:  0.24980794991317548
    val rand:  0
    val onPol:  0.3168814803163211

=== Epoch 20 ===
    train loss:  0.21600228391195597
    val rand:  0
    val onPol:  0.3143801763653755

=== Epoch 30 ===
    train loss:  0.19058810279034732
    val rand:  0
    val onPol:  0.31305978695551556

=== Epoch 39 ===
    train loss:  0.17610722492661393
    val rand:  0
    val onPol:  0.3208800007899602
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  114
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -10.207165727777097
DONE TAKING  40  STEPS.
Total reward:  -192.50260020025232
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.325391869968612
DONE TAKING  40  STEPS.
Total reward:  -465.50903853563693
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.530122480536395
DONE TAKING  40  STEPS.
Total reward:  -742.9228928480134
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -14.46640204457186
DONE TAKING  40  STEPS.
Total reward:  -385.1609835206241
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -30.599027906705146
DONE TAKING  40  STEPS.
Total reward:  -538.2026632897507
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -11.730933035083561
DONE TAKING  40  STEPS.
Total reward:  -326.44566056001594
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -20.73510122333497
DONE TAKING  40  STEPS.
Total reward:  -624.9407354698295
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.23279839180828
DONE TAKING  40  STEPS.
Total reward:  -814.5067461149703
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.658749247832496
DONE TAKING  40  STEPS.
Total reward:  -542.3092582366125
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -14.763315520276748
DONE TAKING  40  STEPS.
Total reward:  -29.88611351560207
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.844716982519547
DONE TAKING  40  STEPS.
Total reward:  -595.9680647345048
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.429669498874414
DONE TAKING  40  STEPS.
Total reward:  -305.15400302360723
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -21.986491052399558
DONE TAKING  40  STEPS.
Total reward:  -639.5467140484202
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -23.55128056099627
DONE TAKING  40  STEPS.
Total reward:  -586.1641221745316
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -14.808241229705441
DONE TAKING  40  STEPS.
Total reward:  -417.16560971693053
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -19.81478233375116
DONE TAKING  40  STEPS.
Total reward:  -336.4471910436856
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -23.48739867305855
DONE TAKING  40  STEPS.
Total reward:  -444.18240221906507
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.8679820320546
DONE TAKING  40  STEPS.
Total reward:  -760.0560390167676
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -30.214706828043347
DONE TAKING  40  STEPS.
Total reward:  -637.307552968864
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -16.559827725164403
DONE TAKING  40  STEPS.
Total reward:  -90.94711829723344
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -15.764134345804992
DONE TAKING  40  STEPS.
Total reward:  97.85067186587025
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.861331447604318
DONE TAKING  40  STEPS.
Total reward:  -1135.9950677806505
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -28.825525018771053
DONE TAKING  40  STEPS.
Total reward:  -570.0997907338716
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -11.529776495560174
DONE TAKING  40  STEPS.
Total reward:  -9.686957283748043
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.11380184649917
DONE TAKING  40  STEPS.
Total reward:  -853.6935962054567
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -15.607944301443704
DONE TAKING  40  STEPS.
Total reward:  -406.7252757182379
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -18.773776997406266
DONE TAKING  40  STEPS.
Total reward:  -786.6077403004726
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.90371164276764
DONE TAKING  40  STEPS.
Total reward:  -754.8241601569702
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -19.332029453838313
DONE TAKING  40  STEPS.
Total reward:  -266.92486246199104
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -26.545514382392298
DONE TAKING  40  STEPS.
Total reward:  -596.9544631829602
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.00402288335592
DONE TAKING  40  STEPS.
Total reward:  -486.943258195664
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.370362335455432
DONE TAKING  40  STEPS.
Total reward:  -700.9349702728987
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -17.18302621259881
DONE TAKING  40  STEPS.
Total reward:  -499.38274823776953
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -27.68860921251669
DONE TAKING  40  STEPS.
Total reward:  -441.5736559076437
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -16.4538363604917
DONE TAKING  40  STEPS.
Total reward:  -453.1747244481825
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.64711009867211
DONE TAKING  40  STEPS.
Total reward:  -427.41975570981515
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.14505616039728
DONE TAKING  40  STEPS.
Total reward:  -874.3477937893434
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.006923198357185
DONE TAKING  40  STEPS.
Total reward:  -300.81444902645256
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.948328134012918
DONE TAKING  40  STEPS.
Total reward:  -336.81219258210115
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -12.10802839725833
DONE TAKING  40  STEPS.
Total reward:  -80.44061271913637
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 115
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  115
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5101953499149858
    val rand:  0
    val onPol:  0.3753071626027425

=== Epoch 10 ===
    train loss:  0.24722181940287874
    val rand:  0
    val onPol:  0.30726975699265796

=== Epoch 20 ===
    train loss:  0.21628816451942712
    val rand:  0
    val onPol:  0.30293527493874234

=== Epoch 30 ===
    train loss:  0.19200990937258067
    val rand:  0
    val onPol:  0.3061828340093295

=== Epoch 39 ===
    train loss:  0.17617288310276835
    val rand:  0
    val onPol:  0.31026772906382877
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  115
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -30.540373362029282
DONE TAKING  40  STEPS.
Total reward:  -839.1920442241457
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.01045281056567
DONE TAKING  40  STEPS.
Total reward:  -330.1112764206953
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -21.943635103908036
DONE TAKING  40  STEPS.
Total reward:  -681.7435599294719
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -13.032774910873712
DONE TAKING  40  STEPS.
Total reward:  -357.91684915879597
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.106368884079124
DONE TAKING  40  STEPS.
Total reward:  -364.74799277738526
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.22249938383377
DONE TAKING  40  STEPS.
Total reward:  -357.1089490658209
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.074167002114027
DONE TAKING  40  STEPS.
Total reward:  -786.5766732423897
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.165846719839692
DONE TAKING  40  STEPS.
Total reward:  -646.9763526136227
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -30.883539676127132
DONE TAKING  40  STEPS.
Total reward:  -668.0861527847312
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -18.374272414711097
DONE TAKING  40  STEPS.
Total reward:  -204.1851786506768
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.673846099729882
DONE TAKING  40  STEPS.
Total reward:  -523.5222964632815
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -15.498826210065001
DONE TAKING  40  STEPS.
Total reward:  -242.5363036916054
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -10.372235138347452
DONE TAKING  40  STEPS.
Total reward:  -248.41307724408418
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -18.597241917798183
DONE TAKING  40  STEPS.
Total reward:  -566.813101287261
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.224050946851175
DONE TAKING  40  STEPS.
Total reward:  -895.6309804061707
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -17.33356479724899
DONE TAKING  40  STEPS.
Total reward:  -338.05923770022207
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -28.172694986697056
DONE TAKING  40  STEPS.
Total reward:  -940.0162849492622
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -21.372191846369386
DONE TAKING  40  STEPS.
Total reward:  -456.4429119416758
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.228718306417612
DONE TAKING  40  STEPS.
Total reward:  -582.6207462904046
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.177714555549787
DONE TAKING  40  STEPS.
Total reward:  -94.9450093153103
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.688025857393885
DONE TAKING  40  STEPS.
Total reward:  -605.8996734631415
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.855125909559177
DONE TAKING  40  STEPS.
Total reward:  -888.9573678859227
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -10.226604675819523
DONE TAKING  40  STEPS.
Total reward:  -303.99163767004495
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.64983825473636
DONE TAKING  40  STEPS.
Total reward:  -762.4857723660426
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -28.913291801087947
DONE TAKING  40  STEPS.
Total reward:  -937.0430485060219
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -13.622581523733803
DONE TAKING  40  STEPS.
Total reward:  -338.0072124315572
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -27.58573931475691
DONE TAKING  40  STEPS.
Total reward:  -709.3482843211477
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.247918104790905
DONE TAKING  40  STEPS.
Total reward:  -528.5255089549854
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -26.281078279622136
DONE TAKING  40  STEPS.
Total reward:  -713.1127579582059
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.562410216288683
DONE TAKING  40  STEPS.
Total reward:  -707.0876129887945
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -21.795879126821642
DONE TAKING  40  STEPS.
Total reward:  -422.2741809670901
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -21.94787753616517
DONE TAKING  40  STEPS.
Total reward:  -631.0999161280585
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -21.141562155055222
DONE TAKING  40  STEPS.
Total reward:  -543.2613271675289
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -15.337386393563044
DONE TAKING  40  STEPS.
Total reward:  -287.28033852137935
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.791059246819344
DONE TAKING  40  STEPS.
Total reward:  -953.8091645938608
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -29.32768172822625
DONE TAKING  40  STEPS.
Total reward:  -698.5668748476661
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -20.192226823531605
DONE TAKING  40  STEPS.
Total reward:  -313.57723393537975
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -10.797198425368865
DONE TAKING  40  STEPS.
Total reward:  -355.3600730681649
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -29.027201734567765
DONE TAKING  40  STEPS.
Total reward:  -788.6400212296562
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.037938790409246
DONE TAKING  40  STEPS.
Total reward:  -643.3045597453447
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 116
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  116
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5026973130410177
    val rand:  0
    val onPol:  0.3668049027522405

=== Epoch 10 ===
    train loss:  0.24853103882388064
    val rand:  0
    val onPol:  0.2992146511872609

=== Epoch 20 ===
    train loss:  0.21516102264847672
    val rand:  0
    val onPol:  0.2936150481303533

=== Epoch 30 ===
    train loss:  0.1894606631575969
    val rand:  0
    val onPol:  0.2958006461461385

=== Epoch 39 ===
    train loss:  0.17480262042137615
    val rand:  0
    val onPol:  0.29936765879392624
Training duration: 14.29 s

#####################################
performing on-policy MPC rollouts... iter  116
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -18.006586963372868
DONE TAKING  40  STEPS.
Total reward:  -339.8808864954565
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.582321815294783
DONE TAKING  40  STEPS.
Total reward:  -617.8800776448338
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.10808539819976
DONE TAKING  40  STEPS.
Total reward:  -524.4529039705935
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.267018892953494
DONE TAKING  40  STEPS.
Total reward:  -750.1889511927303
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -25.523402789380963
DONE TAKING  40  STEPS.
Total reward:  -291.481059640714
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -20.181900575553513
DONE TAKING  40  STEPS.
Total reward:  -786.366292072289
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -24.52944303226433
DONE TAKING  40  STEPS.
Total reward:  -74.52072318240063
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -26.567852621736165
DONE TAKING  40  STEPS.
Total reward:  -941.763014135258
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.84813652928648
DONE TAKING  40  STEPS.
Total reward:  -561.3020019726631
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.019418315901277
DONE TAKING  40  STEPS.
Total reward:  -603.2271570648089
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -21.123758509109372
DONE TAKING  40  STEPS.
Total reward:  -210.4701497365873
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -15.780320296376225
DONE TAKING  40  STEPS.
Total reward:  -452.59744056127545
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -20.225015923906057
DONE TAKING  40  STEPS.
Total reward:  -419.76587798252007
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.251082688481535
DONE TAKING  40  STEPS.
Total reward:  -523.4960718305098
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -24.075487501981986
DONE TAKING  40  STEPS.
Total reward:  -827.4898372935897
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.883517875849556
DONE TAKING  40  STEPS.
Total reward:  -198.79512239162628
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.319842775098856
DONE TAKING  40  STEPS.
Total reward:  -688.7648858416957
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -19.82079480108366
DONE TAKING  40  STEPS.
Total reward:  -490.6780964062566
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.986259954605504
DONE TAKING  40  STEPS.
Total reward:  -441.6735578531507
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -25.566599575783417
DONE TAKING  40  STEPS.
Total reward:  -492.993705291883
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.250231607552656
DONE TAKING  40  STEPS.
Total reward:  -515.941460400368
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.925603217630282
DONE TAKING  40  STEPS.
Total reward:  -816.2403190813797
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -25.928157053208736
DONE TAKING  40  STEPS.
Total reward:  -632.7714598059599
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -28.508628844421505
DONE TAKING  40  STEPS.
Total reward:  -648.7334952468481
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -27.52519184638102
DONE TAKING  40  STEPS.
Total reward:  -872.0359328814037
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -29.154982408937148
DONE TAKING  40  STEPS.
Total reward:  -423.4922779512507
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.893732326273252
DONE TAKING  40  STEPS.
Total reward:  -573.5678617550935
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -30.54774218978752
DONE TAKING  40  STEPS.
Total reward:  -1070.607407559932
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.45168201398956
DONE TAKING  40  STEPS.
Total reward:  -694.0154799949057
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.956691100797578
DONE TAKING  40  STEPS.
Total reward:  -648.5620922458899
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -29.136623112850245
DONE TAKING  40  STEPS.
Total reward:  -931.6815768118794
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -18.406768517221842
DONE TAKING  40  STEPS.
Total reward:  -383.77484510664476
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.115825180832253
DONE TAKING  40  STEPS.
Total reward:  -999.3307751684257
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.82474650039859
DONE TAKING  40  STEPS.
Total reward:  -750.2629338865169
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -28.19725358419322
DONE TAKING  40  STEPS.
Total reward:  -1045.8567294903557
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -23.60284116299729
DONE TAKING  40  STEPS.
Total reward:  -735.0408611865507
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.662956269892284
DONE TAKING  40  STEPS.
Total reward:  -429.22614704147486
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -13.402815159629673
DONE TAKING  40  STEPS.
Total reward:  -287.0303939628318
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -14.337207235991817
DONE TAKING  40  STEPS.
Total reward:  -452.42873437041294
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.49797081421383
DONE TAKING  40  STEPS.
Total reward:  -988.3852390386716
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 117
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  117
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.4971898140614493
    val rand:  0
    val onPol:  0.35140565037727356

=== Epoch 10 ===
    train loss:  0.24770859589702204
    val rand:  0
    val onPol:  0.29052136838436127

=== Epoch 20 ===
    train loss:  0.21377566116943694
    val rand:  0
    val onPol:  0.28790275752544403

=== Epoch 30 ===
    train loss:  0.189208329769603
    val rand:  0
    val onPol:  0.2894262472788493

=== Epoch 39 ===
    train loss:  0.17442184974227035
    val rand:  0
    val onPol:  0.293654203414917
Training duration: 14.25 s

#####################################
performing on-policy MPC rollouts... iter  117
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -27.18523326721945
DONE TAKING  40  STEPS.
Total reward:  -600.0808987523585
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -29.595438263821233
DONE TAKING  40  STEPS.
Total reward:  -1035.518796733203
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.21152337897508
DONE TAKING  40  STEPS.
Total reward:  -807.7346985307427
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -24.09667029810574
DONE TAKING  40  STEPS.
Total reward:  -824.6184941920561
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.137042183891907
DONE TAKING  40  STEPS.
Total reward:  -967.9406848397061
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -28.907739846661386
DONE TAKING  40  STEPS.
Total reward:  -942.355553673155
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.3637493802642
DONE TAKING  40  STEPS.
Total reward:  -534.1583067809235
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -10.760091356534309
DONE TAKING  40  STEPS.
Total reward:  -387.2896799049145
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.43443813007688
DONE TAKING  40  STEPS.
Total reward:  -799.3882210865014
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -13.497365175024916
DONE TAKING  40  STEPS.
Total reward:  -474.7548756864208
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -11.994154066887024
DONE TAKING  40  STEPS.
Total reward:  270.38428933406396
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -11.92099002545103
DONE TAKING  40  STEPS.
Total reward:  -269.3572477396519
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -30.17498270026245
DONE TAKING  40  STEPS.
Total reward:  -942.321894812439
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -24.60005808565361
DONE TAKING  40  STEPS.
Total reward:  -651.2789899775927
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -24.720950966127546
DONE TAKING  40  STEPS.
Total reward:  -654.8482044337221
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.597843737156904
DONE TAKING  40  STEPS.
Total reward:  -862.1235802966218
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.736136213095342
DONE TAKING  40  STEPS.
Total reward:  -766.7313554775257
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.616006813992882
DONE TAKING  40  STEPS.
Total reward:  -711.1615457904168
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.133744746613658
DONE TAKING  40  STEPS.
Total reward:  -357.81622283273924
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.197423319200205
DONE TAKING  40  STEPS.
Total reward:  -716.3233844554769
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.32408680486366
DONE TAKING  40  STEPS.
Total reward:  -884.9846958578274
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -18.607422988789665
DONE TAKING  40  STEPS.
Total reward:  -319.0616805537376
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -17.382649514334304
DONE TAKING  40  STEPS.
Total reward:  -670.7646740635657
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.61751102382666
DONE TAKING  40  STEPS.
Total reward:  -413.15925511663823
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -31.252074142935204
DONE TAKING  40  STEPS.
Total reward:  -631.9012708543119
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -23.037788899018178
DONE TAKING  40  STEPS.
Total reward:  -486.81109110811985
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.58321902802669
DONE TAKING  40  STEPS.
Total reward:  -495.2610656395719
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.81451186734566
DONE TAKING  40  STEPS.
Total reward:  -898.7321260447231
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.161190368040522
DONE TAKING  40  STEPS.
Total reward:  -569.9367513176845
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -22.831659344454998
DONE TAKING  40  STEPS.
Total reward:  -531.071129401542
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -31.414279725355485
DONE TAKING  40  STEPS.
Total reward:  -882.6550460118672
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.020134680709283
DONE TAKING  40  STEPS.
Total reward:  -522.9000352856601
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -13.484452156654756
DONE TAKING  40  STEPS.
Total reward:  -535.920657430712
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -19.215691442929494
DONE TAKING  40  STEPS.
Total reward:  -404.8770167161567
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -20.759052052530027
DONE TAKING  40  STEPS.
Total reward:  -499.3882421143433
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -31.347113499137883
DONE TAKING  40  STEPS.
Total reward:  -839.488593244935
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.964845532616174
DONE TAKING  40  STEPS.
Total reward:  -443.40401032699026
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -21.675849691357094
DONE TAKING  40  STEPS.
Total reward:  -422.7120252713233
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.046343760154583
DONE TAKING  40  STEPS.
Total reward:  -454.8165476609624
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -23.24122744635885
DONE TAKING  40  STEPS.
Total reward:  -693.1006495074973
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 118
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  118
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.513661136229833
    val rand:  0
    val onPol:  0.37039609253406525

=== Epoch 10 ===
    train loss:  0.2497636244485253
    val rand:  0
    val onPol:  0.3003888229529063

=== Epoch 20 ===
    train loss:  0.21337080237112546
    val rand:  0
    val onPol:  0.29560206085443497

=== Epoch 30 ===
    train loss:  0.19150136777183466
    val rand:  0
    val onPol:  0.2989261746406555

=== Epoch 39 ===
    train loss:  0.17236739919896713
    val rand:  0
    val onPol:  0.30149490137894946
Training duration: 14.10 s

#####################################
performing on-policy MPC rollouts... iter  118
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -25.01777728085573
DONE TAKING  40  STEPS.
Total reward:  -366.70885176002804
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -18.718835236484406
DONE TAKING  40  STEPS.
Total reward:  -405.46705284498466
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.53908595923113
DONE TAKING  40  STEPS.
Total reward:  -994.7026570107369
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.788360214727756
DONE TAKING  40  STEPS.
Total reward:  -924.63488630773
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -25.177194431982585
DONE TAKING  40  STEPS.
Total reward:  -770.694344645293
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.192675201382304
DONE TAKING  40  STEPS.
Total reward:  -1053.06737154665
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -23.019526229914575
DONE TAKING  40  STEPS.
Total reward:  -759.0099604608416
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.377572170966225
DONE TAKING  40  STEPS.
Total reward:  -963.4356379358027
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -16.428842688874653
DONE TAKING  40  STEPS.
Total reward:  -417.1006575904438
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -15.553248660436845
DONE TAKING  40  STEPS.
Total reward:  -540.9197179852346
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.034442636098554
DONE TAKING  40  STEPS.
Total reward:  -311.3515097864441
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.07668572566058
DONE TAKING  40  STEPS.
Total reward:  -135.33443556995903
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -28.67744291997571
DONE TAKING  40  STEPS.
Total reward:  -841.0022726275766
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.532933010031037
DONE TAKING  40  STEPS.
Total reward:  -348.06484880469793
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -27.50982241888519
DONE TAKING  40  STEPS.
Total reward:  -580.2133271638777
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -25.891415312072155
DONE TAKING  40  STEPS.
Total reward:  -608.5035534639509
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.353268247397201
DONE TAKING  40  STEPS.
Total reward:  -156.40098522764066
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -17.20574890376707
DONE TAKING  40  STEPS.
Total reward:  -18.16627023765362
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -13.06106079771375
DONE TAKING  40  STEPS.
Total reward:  -381.44871161965426
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.390294943881973
DONE TAKING  40  STEPS.
Total reward:  -280.1860244062579
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.091345702331303
DONE TAKING  40  STEPS.
Total reward:  -969.0144747340862
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -12.560695104702171
DONE TAKING  40  STEPS.
Total reward:  -113.58289904825783
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -10.479733892735636
DONE TAKING  40  STEPS.
Total reward:  -388.7759205598357
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -24.55317656101159
DONE TAKING  40  STEPS.
Total reward:  -775.1260357350966
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.625957940317583
DONE TAKING  40  STEPS.
Total reward:  -536.895689142552
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -10.30366223577822
DONE TAKING  40  STEPS.
Total reward:  267.65608036718436
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -25.48840039085098
DONE TAKING  40  STEPS.
Total reward:  -777.8519381589928
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -19.73261137917824
DONE TAKING  40  STEPS.
Total reward:  -384.147865625444
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.589579277397313
DONE TAKING  40  STEPS.
Total reward:  -626.2391502984748
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.717386494446004
DONE TAKING  40  STEPS.
Total reward:  -352.4237153042058
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -19.778579165738666
DONE TAKING  40  STEPS.
Total reward:  51.37307713342829
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -29.96037456910805
DONE TAKING  40  STEPS.
Total reward:  -951.6942357200306
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -31.345404025151787
DONE TAKING  40  STEPS.
Total reward:  -818.357202554047
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -12.172120330604006
DONE TAKING  40  STEPS.
Total reward:  -305.8325986354463
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.266347147909133
DONE TAKING  40  STEPS.
Total reward:  -432.2074970820097
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.088434815196635
DONE TAKING  40  STEPS.
Total reward:  -581.0786038407314
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -19.77589575025194
DONE TAKING  40  STEPS.
Total reward:  -141.69065703681133
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -30.708262561368585
DONE TAKING  40  STEPS.
Total reward:  -752.82333982643
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -22.9936034952755
DONE TAKING  40  STEPS.
Total reward:  27.513039787145082
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -20.320577384449567
DONE TAKING  40  STEPS.
Total reward:  -192.688838347513
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 119
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  119
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5038656681253199
    val rand:  0
    val onPol:  0.3855070620775223

=== Epoch 10 ===
    train loss:  0.24982156696026786
    val rand:  0
    val onPol:  0.31490594148635864

=== Epoch 20 ===
    train loss:  0.21843967259975902
    val rand:  0
    val onPol:  0.31120845427115756

=== Epoch 30 ===
    train loss:  0.19397457388409398
    val rand:  0
    val onPol:  0.31391197939713794

=== Epoch 39 ===
    train loss:  0.17564487117424346
    val rand:  0
    val onPol:  0.3185076614220937
Training duration: 14.44 s

#####################################
performing on-policy MPC rollouts... iter  119
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -28.44679766030678
DONE TAKING  40  STEPS.
Total reward:  -398.4814894068077
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -13.55231191044021
DONE TAKING  40  STEPS.
Total reward:  -526.8253759939744
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -28.626000033080917
DONE TAKING  40  STEPS.
Total reward:  -914.312247736232
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -25.417431567761845
DONE TAKING  40  STEPS.
Total reward:  -895.9640726728736
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.149813354979162
DONE TAKING  40  STEPS.
Total reward:  420.75801663564533
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.101556072242015
DONE TAKING  40  STEPS.
Total reward:  -583.8001518926654
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.95585592354381
DONE TAKING  40  STEPS.
Total reward:  -557.7195099570383
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -17.39021930868517
DONE TAKING  40  STEPS.
Total reward:  -488.24964268364937
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -18.846540313953923
DONE TAKING  40  STEPS.
Total reward:  -362.569290331633
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.093337154762793
DONE TAKING  40  STEPS.
Total reward:  -926.1362418159674
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.963385382056416
DONE TAKING  40  STEPS.
Total reward:  -440.7857006717895
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.998053495566438
DONE TAKING  40  STEPS.
Total reward:  -839.4271553375469
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -12.251379354529554
DONE TAKING  40  STEPS.
Total reward:  -129.19911354270448
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -23.07446060620192
DONE TAKING  40  STEPS.
Total reward:  -787.0149961081206
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -28.383483661150365
DONE TAKING  40  STEPS.
Total reward:  -908.6144107292034
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -24.61024158234281
DONE TAKING  40  STEPS.
Total reward:  -799.422591159847
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.085584573451516
DONE TAKING  40  STEPS.
Total reward:  -106.10870801832903
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.706079081619986
DONE TAKING  40  STEPS.
Total reward:  189.29894797482407
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.104610226380252
DONE TAKING  40  STEPS.
Total reward:  -867.879644835296
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.885534032248863
DONE TAKING  40  STEPS.
Total reward:  -818.6370050765229
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -16.10727144018664
DONE TAKING  40  STEPS.
Total reward:  -258.5882473787458
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -18.105212263202127
DONE TAKING  40  STEPS.
Total reward:  -482.8514675402085
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.688871056261185
DONE TAKING  40  STEPS.
Total reward:  -713.4900934550378
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -19.927894870419593
DONE TAKING  40  STEPS.
Total reward:  126.02984074198078
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.872047603705997
DONE TAKING  40  STEPS.
Total reward:  -963.8524300864871
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.72374605007274
DONE TAKING  40  STEPS.
Total reward:  -724.7678011731497
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -23.836222594699144
DONE TAKING  40  STEPS.
Total reward:  -707.9703736985573
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -20.302408464279505
DONE TAKING  40  STEPS.
Total reward:  -293.8170297312122
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -30.506557480449143
DONE TAKING  40  STEPS.
Total reward:  -834.0600125900302
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -26.551361990808495
DONE TAKING  40  STEPS.
Total reward:  -391.22075318294304
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.787120721936134
DONE TAKING  40  STEPS.
Total reward:  -616.4075369444552
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -28.555793820088553
DONE TAKING  40  STEPS.
Total reward:  -834.2824291771575
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -17.10467204899337
DONE TAKING  40  STEPS.
Total reward:  46.893041510224734
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -14.025313144530536
DONE TAKING  40  STEPS.
Total reward:  -321.7867282494921
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.963611550187323
DONE TAKING  40  STEPS.
Total reward:  -575.1699901017818
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.79431751142614
DONE TAKING  40  STEPS.
Total reward:  -634.1764852172957
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.92106765291942
DONE TAKING  40  STEPS.
Total reward:  -935.0479280700076
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -31.115321382003
DONE TAKING  40  STEPS.
Total reward:  -849.4266257985763
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -30.257592181577287
DONE TAKING  40  STEPS.
Total reward:  -107.93321344441942
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -15.865109334228958
DONE TAKING  40  STEPS.
Total reward:  -284.47299721614695
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 120
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  120
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5121674485373915
    val rand:  0
    val onPol:  0.3959812819957733

=== Epoch 10 ===
    train loss:  0.25707948992126867
    val rand:  0
    val onPol:  0.3272835463285446

=== Epoch 20 ===
    train loss:  0.21964281718981893
    val rand:  0
    val onPol:  0.32532136390606564

=== Epoch 30 ===
    train loss:  0.195466086268425
    val rand:  0
    val onPol:  0.3250939945379893

=== Epoch 39 ===
    train loss:  0.17930719230258674
    val rand:  0
    val onPol:  0.33043842514355976
Training duration: 14.33 s

#####################################
performing on-policy MPC rollouts... iter  120
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.66792843324192
DONE TAKING  40  STEPS.
Total reward:  -692.4940460253829
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -19.036142569188854
DONE TAKING  40  STEPS.
Total reward:  -606.075566533008
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.003197529498973
DONE TAKING  40  STEPS.
Total reward:  -860.5644467062154
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.65366628442898
DONE TAKING  40  STEPS.
Total reward:  -390.7343340577693
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.07901874443796
DONE TAKING  40  STEPS.
Total reward:  -52.45858391701638
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -26.6712112373899
DONE TAKING  40  STEPS.
Total reward:  -46.754970479717265
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -28.91982397015434
DONE TAKING  40  STEPS.
Total reward:  -911.3466433003244
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -20.005944627004865
DONE TAKING  40  STEPS.
Total reward:  -598.1822430042691
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.45091948236898
DONE TAKING  40  STEPS.
Total reward:  -701.3681539359096
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -28.466962838370012
DONE TAKING  40  STEPS.
Total reward:  -1191.5755302714267
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.175968741699492
DONE TAKING  40  STEPS.
Total reward:  -397.1074286262358
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -24.112720217075708
DONE TAKING  40  STEPS.
Total reward:  -556.1790279984139
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.832211414758376
DONE TAKING  40  STEPS.
Total reward:  -536.9586046463309
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.29529723241154
DONE TAKING  40  STEPS.
Total reward:  -472.51779547027667
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -18.887625938528032
DONE TAKING  40  STEPS.
Total reward:  -436.85983873181067
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -23.347774640834125
DONE TAKING  40  STEPS.
Total reward:  -339.74669462185597
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -9.758764145929707
DONE TAKING  40  STEPS.
Total reward:  -65.8379528497509
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.080784710691315
DONE TAKING  40  STEPS.
Total reward:  -337.9464700643931
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -15.487434572465997
DONE TAKING  40  STEPS.
Total reward:  -334.2872426967793
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -29.775160402919305
DONE TAKING  40  STEPS.
Total reward:  -627.0154519327749
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -23.260100102631064
DONE TAKING  40  STEPS.
Total reward:  -613.0874207672265
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.731488327762797
DONE TAKING  40  STEPS.
Total reward:  -185.93900783848906
Time for 1 rollout: 1.11 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.685646031949346
DONE TAKING  40  STEPS.
Total reward:  251.38215364631714
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.299555557589645
DONE TAKING  40  STEPS.
Total reward:  -909.3026433348058
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -31.378882675172548
DONE TAKING  40  STEPS.
Total reward:  -884.1081090847869
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -22.382029499071365
DONE TAKING  40  STEPS.
Total reward:  -599.3339201750327
Time for 1 rollout: 1.15 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -29.35544371174709
DONE TAKING  40  STEPS.
Total reward:  -703.6908353133365
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.226312358979662
DONE TAKING  40  STEPS.
Total reward:  25.711718646495086
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -22.941700777065176
DONE TAKING  40  STEPS.
Total reward:  -125.58468968971509
Time for 1 rollout: 1.14 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.78503649221501
DONE TAKING  40  STEPS.
Total reward:  -186.0646537169366
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.22225272212163
DONE TAKING  40  STEPS.
Total reward:  -344.1692860700874
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.330771082925626
DONE TAKING  40  STEPS.
Total reward:  -789.223024053969
Time for 1 rollout: 1.10 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.669334349436816
DONE TAKING  40  STEPS.
Total reward:  -531.4454610903227
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.225540014259963
DONE TAKING  40  STEPS.
Total reward:  -699.495790088737
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -29.894088648134222
DONE TAKING  40  STEPS.
Total reward:  -1023.4269887638118
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.496118272458247
DONE TAKING  40  STEPS.
Total reward:  -718.299626727887
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.594075356377033
DONE TAKING  40  STEPS.
Total reward:  -332.44402653497457
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.643302419224625
DONE TAKING  40  STEPS.
Total reward:  -483.7362919026548
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.379998115345764
DONE TAKING  40  STEPS.
Total reward:  -783.9462140651233
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -19.733681100564468
DONE TAKING  40  STEPS.
Total reward:  -396.77014868924135
Time for 1 rollout: 1.02 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 121
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  121
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.49408455376039473
    val rand:  0
    val onPol:  0.4036768227815628

=== Epoch 10 ===
    train loss:  0.2525596707536463
    val rand:  0
    val onPol:  0.3340025842189789

=== Epoch 20 ===
    train loss:  0.217131101509981
    val rand:  0
    val onPol:  0.33305758982896805

=== Epoch 30 ===
    train loss:  0.19061195144527837
    val rand:  0
    val onPol:  0.3308177938063939

=== Epoch 39 ===
    train loss:  0.1746255815551992
    val rand:  0
    val onPol:  0.3358607242504756
Training duration: 14.15 s

#####################################
performing on-policy MPC rollouts... iter  121
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -31.256792052326293
DONE TAKING  40  STEPS.
Total reward:  -789.371974747603
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.083323968570383
DONE TAKING  40  STEPS.
Total reward:  -183.33161212250985
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -25.45756817718237
DONE TAKING  40  STEPS.
Total reward:  -545.3942305131337
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -31.002322182851536
DONE TAKING  40  STEPS.
Total reward:  -736.122791205019
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -29.99985857761189
DONE TAKING  40  STEPS.
Total reward:  -906.0633879636484
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -16.063598148034306
DONE TAKING  40  STEPS.
Total reward:  -331.92650959562667
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -17.785415928103504
DONE TAKING  40  STEPS.
Total reward:  -313.7748634688237
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -16.761759153602227
DONE TAKING  40  STEPS.
Total reward:  -379.5789063461918
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -17.291427435836763
DONE TAKING  40  STEPS.
Total reward:  -577.4605777236411
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -18.75488743486337
DONE TAKING  40  STEPS.
Total reward:  -288.82408073953155
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.709045064319323
DONE TAKING  40  STEPS.
Total reward:  -231.4216973272755
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -23.829110638101575
DONE TAKING  40  STEPS.
Total reward:  -782.5654417322824
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.39530778077181
DONE TAKING  40  STEPS.
Total reward:  -479.02139126845435
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -20.12016222304977
DONE TAKING  40  STEPS.
Total reward:  -355.8486026264497
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -22.898309445221635
DONE TAKING  40  STEPS.
Total reward:  -665.5614837475138
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -25.37214097842891
DONE TAKING  40  STEPS.
Total reward:  -479.7204812933215
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.33765533982371
DONE TAKING  40  STEPS.
Total reward:  -919.6942204683062
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -12.63122582375402
DONE TAKING  40  STEPS.
Total reward:  -426.12713049233923
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -22.293931319708573
DONE TAKING  40  STEPS.
Total reward:  -860.455406612221
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -22.826378815738146
DONE TAKING  40  STEPS.
Total reward:  -832.9584343511244
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.804827596607936
DONE TAKING  40  STEPS.
Total reward:  -860.4962878048681
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -29.947175003878044
DONE TAKING  40  STEPS.
Total reward:  -677.1379147023807
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -22.0509197042569
DONE TAKING  40  STEPS.
Total reward:  -722.95719801464
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -21.004825903927475
DONE TAKING  40  STEPS.
Total reward:  -688.7240090244212
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -11.551150481719358
DONE TAKING  40  STEPS.
Total reward:  -290.25872385453425
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.9197475449694
DONE TAKING  40  STEPS.
Total reward:  328.21170047219425
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -16.277720250162847
DONE TAKING  40  STEPS.
Total reward:  -446.2415181176991
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -27.118316517135348
DONE TAKING  40  STEPS.
Total reward:  -783.6562059660579
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -24.87622531259227
DONE TAKING  40  STEPS.
Total reward:  -469.7053907639878
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -22.235441774430427
DONE TAKING  40  STEPS.
Total reward:  48.483366520201
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -23.018777883360976
DONE TAKING  40  STEPS.
Total reward:  -308.69024997955785
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -26.71939942654305
DONE TAKING  40  STEPS.
Total reward:  -529.9169701262448
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.75180604686935
DONE TAKING  40  STEPS.
Total reward:  322.6790208028336
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -25.78295136551688
DONE TAKING  40  STEPS.
Total reward:  -662.1169648096874
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.997010789399873
DONE TAKING  40  STEPS.
Total reward:  -821.5978048856804
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.591564833656246
DONE TAKING  40  STEPS.
Total reward:  -935.943906314235
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -23.439984978148757
DONE TAKING  40  STEPS.
Total reward:  -699.8046228709997
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -29.5039406111568
DONE TAKING  40  STEPS.
Total reward:  -1046.2496031069238
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.78997599156547
DONE TAKING  40  STEPS.
Total reward:  -841.5615669442844
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -26.905573326952528
DONE TAKING  40  STEPS.
Total reward:  -432.3341791743394
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 122
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  122
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5097543811588957
    val rand:  0
    val onPol:  0.4024096628030141

=== Epoch 10 ===
    train loss:  0.25624012868655355
    val rand:  0
    val onPol:  0.3323744783798854

=== Epoch 20 ===
    train loss:  0.22217303645192532
    val rand:  0
    val onPol:  0.3291998008886973

=== Epoch 30 ===
    train loss:  0.1980862277641631
    val rand:  0
    val onPol:  0.3284340774019559

=== Epoch 39 ===
    train loss:  0.17941080635054069
    val rand:  0
    val onPol:  0.3347368836402893
Training duration: 7.39 s

#####################################
performing on-policy MPC rollouts... iter  122
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.96136947095043
DONE TAKING  40  STEPS.
Total reward:  -512.4412731770392
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -19.630595375658885
DONE TAKING  40  STEPS.
Total reward:  -523.1888477880692
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -20.100829740187763
DONE TAKING  40  STEPS.
Total reward:  -649.5634754578485
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -13.448634223270655
DONE TAKING  40  STEPS.
Total reward:  -404.67453626235545
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.000899147373836
DONE TAKING  40  STEPS.
Total reward:  -388.41799886883325
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -15.232255461179577
DONE TAKING  40  STEPS.
Total reward:  -536.6712521793081
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.712914449792343
DONE TAKING  40  STEPS.
Total reward:  -236.79063956994523
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -29.717086451898417
DONE TAKING  40  STEPS.
Total reward:  -629.2440555235338
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.18419646487864
DONE TAKING  40  STEPS.
Total reward:  -423.48988251712314
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.129018647778246
DONE TAKING  40  STEPS.
Total reward:  -884.1685137895175
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.728319604781678
DONE TAKING  40  STEPS.
Total reward:  -871.2600366380954
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -16.975561386324674
DONE TAKING  40  STEPS.
Total reward:  -37.26043328532691
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -15.807372622910394
DONE TAKING  40  STEPS.
Total reward:  -259.0114421209431
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -18.102041642281797
DONE TAKING  40  STEPS.
Total reward:  -625.8956609848681
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -13.022123821770439
DONE TAKING  40  STEPS.
Total reward:  -83.83465423197809
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.547543121714625
DONE TAKING  40  STEPS.
Total reward:  -422.4119959984585
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.569352104079492
DONE TAKING  40  STEPS.
Total reward:  -399.2369545476246
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -27.682367039181358
DONE TAKING  40  STEPS.
Total reward:  -735.2094945132062
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -25.355224238815616
DONE TAKING  40  STEPS.
Total reward:  -857.2155923342985
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -28.204886016895784
DONE TAKING  40  STEPS.
Total reward:  -580.8966993326263
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.271277343696152
DONE TAKING  40  STEPS.
Total reward:  -550.48224839918
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -17.289660603529228
DONE TAKING  40  STEPS.
Total reward:  -599.7747735349986
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.440986369039017
DONE TAKING  40  STEPS.
Total reward:  -535.2647706066899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -18.135265482649288
DONE TAKING  40  STEPS.
Total reward:  -592.8146477814399
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.251997297129012
DONE TAKING  40  STEPS.
Total reward:  -680.2441772389628
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.704482140215482
DONE TAKING  40  STEPS.
Total reward:  -500.91745763863054
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -26.473586645689803
DONE TAKING  40  STEPS.
Total reward:  -738.7335350038517
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -24.393112686073568
DONE TAKING  40  STEPS.
Total reward:  -638.1262255340575
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.250327571705277
DONE TAKING  40  STEPS.
Total reward:  -756.2931583535469
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.56708383397711
DONE TAKING  40  STEPS.
Total reward:  -776.1328167637091
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.585498312309124
DONE TAKING  40  STEPS.
Total reward:  -485.33228004644747
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -19.341214758562273
DONE TAKING  40  STEPS.
Total reward:  -659.7761450072212
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -28.743069709695853
DONE TAKING  40  STEPS.
Total reward:  -951.0787032331758
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.247315524073557
DONE TAKING  40  STEPS.
Total reward:  -816.6500727388318
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.307103109914003
DONE TAKING  40  STEPS.
Total reward:  -440.846499514895
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.46919316046416
DONE TAKING  40  STEPS.
Total reward:  -488.1637865521501
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.082364953549927
DONE TAKING  40  STEPS.
Total reward:  -780.7105076498889
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.70308457102621
DONE TAKING  40  STEPS.
Total reward:  -864.5594027964961
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.863451427141328
DONE TAKING  40  STEPS.
Total reward:  -656.5301510526234
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.801946198795754
DONE TAKING  40  STEPS.
Total reward:  -625.01335002949
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 123
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  123
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5134227134679493
    val rand:  0
    val onPol:  0.41233932475248974

=== Epoch 10 ===
    train loss:  0.25675489661986367
    val rand:  0
    val onPol:  0.34200943013032276

=== Epoch 20 ===
    train loss:  0.2215806651010848
    val rand:  0
    val onPol:  0.33655107021331787

=== Epoch 30 ===
    train loss:  0.19919676006885997
    val rand:  0
    val onPol:  0.3390930965542793

=== Epoch 39 ===
    train loss:  0.1803619215885798
    val rand:  0
    val onPol:  0.34419679641723633
Training duration: 7.37 s

#####################################
performing on-policy MPC rollouts... iter  123
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.393926019168887
DONE TAKING  40  STEPS.
Total reward:  -388.34926223391886
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.820247411342017
DONE TAKING  40  STEPS.
Total reward:  -465.6554799463918
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -25.88472840127022
DONE TAKING  40  STEPS.
Total reward:  -700.8812423607449
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -29.846070380811348
DONE TAKING  40  STEPS.
Total reward:  -656.2107105510712
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -14.597373220452683
DONE TAKING  40  STEPS.
Total reward:  -448.17199595809086
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -20.433159777601343
DONE TAKING  40  STEPS.
Total reward:  -518.074510161891
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -25.82117513186855
DONE TAKING  40  STEPS.
Total reward:  -458.4918381999726
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.46127090975458
DONE TAKING  40  STEPS.
Total reward:  -940.2269388315436
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.923722833200472
DONE TAKING  40  STEPS.
Total reward:  -342.22955616341756
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -16.281224262306118
DONE TAKING  40  STEPS.
Total reward:  -455.7172114822031
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -16.334492123487337
DONE TAKING  40  STEPS.
Total reward:  137.70640104714718
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -25.472256245106443
DONE TAKING  40  STEPS.
Total reward:  -611.3373270725174
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -27.733535473116653
DONE TAKING  40  STEPS.
Total reward:  -538.0325995472367
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.069494737624645
DONE TAKING  40  STEPS.
Total reward:  -548.8529058570181
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.390283213416478
DONE TAKING  40  STEPS.
Total reward:  -607.6789003393089
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -17.49713513618287
DONE TAKING  40  STEPS.
Total reward:  -512.882435890298
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -22.03678130429795
DONE TAKING  40  STEPS.
Total reward:  -505.1279384333815
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -21.31883082047251
DONE TAKING  40  STEPS.
Total reward:  -536.250207487507
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.19348738897999
DONE TAKING  40  STEPS.
Total reward:  -775.4854999116543
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.34246456359599
DONE TAKING  40  STEPS.
Total reward:  -794.3291745325838
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -28.445463184648084
DONE TAKING  40  STEPS.
Total reward:  -695.9900429140206
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -22.360029969405804
DONE TAKING  40  STEPS.
Total reward:  -714.4971419382535
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.562962739300787
DONE TAKING  40  STEPS.
Total reward:  -929.4226868326926
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.181583062851455
DONE TAKING  40  STEPS.
Total reward:  -795.8221753171526
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -26.84794238838203
DONE TAKING  40  STEPS.
Total reward:  -1043.3712974281207
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.222207125375505
DONE TAKING  40  STEPS.
Total reward:  -531.5803288976273
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.027203455677206
DONE TAKING  40  STEPS.
Total reward:  -893.3425743575682
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -12.506962007098046
DONE TAKING  40  STEPS.
Total reward:  -266.9525101885612
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -23.670439072103342
DONE TAKING  40  STEPS.
Total reward:  -672.6230519189077
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -21.25512151597856
DONE TAKING  40  STEPS.
Total reward:  -160.3537229316919
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -27.94580202758743
DONE TAKING  40  STEPS.
Total reward:  -750.834750709099
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -30.785277953578056
DONE TAKING  40  STEPS.
Total reward:  -842.6758444102064
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.0140939092376
DONE TAKING  40  STEPS.
Total reward:  -672.9868302682647
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -29.088546160587914
DONE TAKING  40  STEPS.
Total reward:  -916.4196806318432
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -17.199176066300517
DONE TAKING  40  STEPS.
Total reward:  -345.9041619974172
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -25.315959308450452
DONE TAKING  40  STEPS.
Total reward:  -605.0754472437683
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -24.669425776853533
DONE TAKING  40  STEPS.
Total reward:  158.61952454970483
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.020299409616946
DONE TAKING  40  STEPS.
Total reward:  -731.9179971171275
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -14.63635207268991
DONE TAKING  40  STEPS.
Total reward:  -364.3831412534095
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -18.69631530310951
DONE TAKING  40  STEPS.
Total reward:  -743.5526175838509
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 124
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  124
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5068451809255701
    val rand:  0
    val onPol:  0.413687805334727

=== Epoch 10 ===
    train loss:  0.26006830261464703
    val rand:  0
    val onPol:  0.34611718356609344

=== Epoch 20 ===
    train loss:  0.22195833267872794
    val rand:  0
    val onPol:  0.3406248837709427

=== Epoch 30 ===
    train loss:  0.1965620475902892
    val rand:  0
    val onPol:  0.3431479682524999

=== Epoch 39 ===
    train loss:  0.18007776062739522
    val rand:  0
    val onPol:  0.34860671559969586
Training duration: 7.37 s

#####################################
performing on-policy MPC rollouts... iter  124
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -21.95965554550181
DONE TAKING  40  STEPS.
Total reward:  -614.9876741542864
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.069724849763503
DONE TAKING  40  STEPS.
Total reward:  -655.7170445015934
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -25.96908852030055
DONE TAKING  40  STEPS.
Total reward:  -877.3291011251722
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -27.25234802826504
DONE TAKING  40  STEPS.
Total reward:  -716.461094855998
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -17.056833480719963
DONE TAKING  40  STEPS.
Total reward:  -499.79550230152466
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -27.274386779643393
DONE TAKING  40  STEPS.
Total reward:  -509.6598067262496
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.26657430679716
DONE TAKING  40  STEPS.
Total reward:  -712.3920660510637
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -26.367358067206407
DONE TAKING  40  STEPS.
Total reward:  -723.6643996008576
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -30.854662729879404
DONE TAKING  40  STEPS.
Total reward:  -748.6842699217744
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -26.840221031456736
DONE TAKING  40  STEPS.
Total reward:  -563.2406015961164
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -24.525934002547398
DONE TAKING  40  STEPS.
Total reward:  -262.69721164109626
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -27.55115632976402
DONE TAKING  40  STEPS.
Total reward:  -445.522580062751
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -11.773330506136492
DONE TAKING  40  STEPS.
Total reward:  -81.73449152462845
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -17.096397508381152
DONE TAKING  40  STEPS.
Total reward:  -431.3934314852733
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -15.49193109339037
DONE TAKING  40  STEPS.
Total reward:  -321.4506020501898
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -21.293315857004767
DONE TAKING  40  STEPS.
Total reward:  -397.08095175423597
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -17.824834967737093
DONE TAKING  40  STEPS.
Total reward:  -487.552307627665
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -23.237334050004733
DONE TAKING  40  STEPS.
Total reward:  -542.1430252306618
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -14.81621777416241
DONE TAKING  40  STEPS.
Total reward:  -363.5429854056701
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -21.092849703793878
DONE TAKING  40  STEPS.
Total reward:  -451.88336164928677
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -18.34303821283675
DONE TAKING  40  STEPS.
Total reward:  -612.850513991899
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.16945522324078
DONE TAKING  40  STEPS.
Total reward:  -278.8448020167724
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -13.368622935287577
DONE TAKING  40  STEPS.
Total reward:  -309.9325373583416
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -26.953716387355357
DONE TAKING  40  STEPS.
Total reward:  -484.00314473158886
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.76961031553652
DONE TAKING  40  STEPS.
Total reward:  -300.6648828716116
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -14.473570482397678
DONE TAKING  40  STEPS.
Total reward:  -456.2596204291701
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -27.963877492841092
DONE TAKING  40  STEPS.
Total reward:  -930.5859990007806
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -22.101816540231695
DONE TAKING  40  STEPS.
Total reward:  -665.6171149324438
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.017546280778543
DONE TAKING  40  STEPS.
Total reward:  -556.3396336424099
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.730940806758618
DONE TAKING  40  STEPS.
Total reward:  -834.2486010850752
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -21.449007748654942
DONE TAKING  40  STEPS.
Total reward:  -570.060100722881
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -12.762236896818662
DONE TAKING  40  STEPS.
Total reward:  -418.03445695291765
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.29504138934339
DONE TAKING  40  STEPS.
Total reward:  -368.6720893224508
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -31.113574075450508
DONE TAKING  40  STEPS.
Total reward:  -640.7868884876584
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -21.560790875681924
DONE TAKING  40  STEPS.
Total reward:  -388.5449002386795
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.054233465958458
DONE TAKING  40  STEPS.
Total reward:  -276.18443340078045
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.319445378838072
DONE TAKING  40  STEPS.
Total reward:  -352.10063289524163
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -15.742174209928672
DONE TAKING  40  STEPS.
Total reward:  41.81713716372053
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -19.8766908371122
DONE TAKING  40  STEPS.
Total reward:  -536.2793967196823
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -29.550943750706587
DONE TAKING  40  STEPS.
Total reward:  -0.846879395300487
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 125
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  125
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5017001231511434
    val rand:  0
    val onPol:  0.3950650890668233

=== Epoch 10 ===
    train loss:  0.2541587980169999
    val rand:  0
    val onPol:  0.3253518765171369

=== Epoch 20 ===
    train loss:  0.21990724430795303
    val rand:  0
    val onPol:  0.3212361733118693

=== Epoch 30 ===
    train loss:  0.1952817667471735
    val rand:  0
    val onPol:  0.32413898408412933

=== Epoch 39 ===
    train loss:  0.17732444797691546
    val rand:  0
    val onPol:  0.3299480453133583
Training duration: 7.37 s

#####################################
performing on-policy MPC rollouts... iter  125
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -17.62871626346476
DONE TAKING  40  STEPS.
Total reward:  44.80198082216081
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.649937257786874
DONE TAKING  40  STEPS.
Total reward:  -567.6935904412173
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.686232133892183
DONE TAKING  40  STEPS.
Total reward:  -418.31811936520063
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -30.645871034804205
DONE TAKING  40  STEPS.
Total reward:  -853.6473680219457
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -26.40940610951875
DONE TAKING  40  STEPS.
Total reward:  -822.9344299239838
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -17.287690165065214
DONE TAKING  40  STEPS.
Total reward:  -360.6955282461897
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.471497679790573
DONE TAKING  40  STEPS.
Total reward:  -571.1535784333885
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.40931748310785
DONE TAKING  40  STEPS.
Total reward:  -730.1006506410527
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -22.232521127119796
DONE TAKING  40  STEPS.
Total reward:  -381.9812266217638
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -29.220439423138437
DONE TAKING  40  STEPS.
Total reward:  -709.4639983074228
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -27.80813422815646
DONE TAKING  40  STEPS.
Total reward:  -119.14746752099437
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -24.265243393215297
DONE TAKING  40  STEPS.
Total reward:  -1008.7136882632994
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -28.94737841208103
DONE TAKING  40  STEPS.
Total reward:  -677.6145397279181
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -17.234698580437957
DONE TAKING  40  STEPS.
Total reward:  -524.430583756193
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -17.3662909667528
DONE TAKING  40  STEPS.
Total reward:  277.15527741580587
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.94772336579851
DONE TAKING  40  STEPS.
Total reward:  -469.63400837104984
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -19.633413505868134
DONE TAKING  40  STEPS.
Total reward:  -354.572703424863
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -19.655869141999325
DONE TAKING  40  STEPS.
Total reward:  -395.7506392304241
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -23.926191097368147
DONE TAKING  40  STEPS.
Total reward:  -691.4618880328994
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -30.609793374984907
DONE TAKING  40  STEPS.
Total reward:  -886.9504898327127
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.804725139210944
DONE TAKING  40  STEPS.
Total reward:  -890.6526997779224
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -24.609627537822245
DONE TAKING  40  STEPS.
Total reward:  -413.9821712840083
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -28.209424826297198
DONE TAKING  40  STEPS.
Total reward:  -735.4495088387425
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -27.26224556779541
DONE TAKING  40  STEPS.
Total reward:  -490.6759256739759
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.72418646105962
DONE TAKING  40  STEPS.
Total reward:  -341.2977218686357
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -18.576013471998007
DONE TAKING  40  STEPS.
Total reward:  -337.37201987759795
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -28.500030258055958
DONE TAKING  40  STEPS.
Total reward:  -129.22569824167644
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -18.70962427134348
DONE TAKING  40  STEPS.
Total reward:  -516.645506010925
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -26.479534923944243
DONE TAKING  40  STEPS.
Total reward:  -808.1355009452741
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.169058402260525
DONE TAKING  40  STEPS.
Total reward:  -704.3990302861157
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -23.170113247933067
DONE TAKING  40  STEPS.
Total reward:  -700.1464698500168
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -30.379324815892353
DONE TAKING  40  STEPS.
Total reward:  -632.2129816634879
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -25.92560815768624
DONE TAKING  40  STEPS.
Total reward:  -981.7947684007116
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -11.667451389677531
DONE TAKING  40  STEPS.
Total reward:  -271.7372312037663
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -25.579358088569187
DONE TAKING  40  STEPS.
Total reward:  -637.2956423744008
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.09796522066521
DONE TAKING  40  STEPS.
Total reward:  -582.1786733554592
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.534552926119915
DONE TAKING  40  STEPS.
Total reward:  -576.6471561766002
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -25.33583452233752
DONE TAKING  40  STEPS.
Total reward:  -441.67104092687555
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -15.045366859396207
DONE TAKING  40  STEPS.
Total reward:  -338.1229428639293
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.69720963101207
DONE TAKING  40  STEPS.
Total reward:  -361.7221608467803
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 126
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  126
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5113801401958131
    val rand:  0
    val onPol:  0.4075868179400762

=== Epoch 10 ===
    train loss:  0.25822275798571737
    val rand:  0
    val onPol:  0.33737972378730774

=== Epoch 20 ===
    train loss:  0.2222687196836137
    val rand:  0
    val onPol:  0.33267463743686676

=== Epoch 30 ===
    train loss:  0.19748998263425993
    val rand:  0
    val onPol:  0.3348078777392705

=== Epoch 39 ===
    train loss:  0.18013971076722732
    val rand:  0
    val onPol:  0.34094761312007904
Training duration: 18.73 s

#####################################
performing on-policy MPC rollouts... iter  126
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -20.38337361865316
DONE TAKING  40  STEPS.
Total reward:  -313.32931843391407
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -27.346793219490664
DONE TAKING  40  STEPS.
Total reward:  -766.4528852152376
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -11.627246095909733
DONE TAKING  40  STEPS.
Total reward:  8.121744522521105
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.90886451892792
DONE TAKING  40  STEPS.
Total reward:  -1037.808485347774
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -14.504750944144849
DONE TAKING  40  STEPS.
Total reward:  -353.02019079485314
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -22.228676784308483
DONE TAKING  40  STEPS.
Total reward:  146.74293483122818
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -30.562982493514724
DONE TAKING  40  STEPS.
Total reward:  -941.2015478350511
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -27.27841830441305
DONE TAKING  40  STEPS.
Total reward:  -950.8459136937659
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -28.169663156229884
DONE TAKING  40  STEPS.
Total reward:  -1011.8082192646409
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -24.378950936936796
DONE TAKING  40  STEPS.
Total reward:  -575.6361015254905
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -15.062567932731302
DONE TAKING  40  STEPS.
Total reward:  -329.45442102055097
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -13.953535981527397
DONE TAKING  40  STEPS.
Total reward:  -534.3983804906832
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.172454563108715
DONE TAKING  40  STEPS.
Total reward:  -796.110415287253
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -12.784679735117395
DONE TAKING  40  STEPS.
Total reward:  -109.09504331609884
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.541784329275647
DONE TAKING  40  STEPS.
Total reward:  -449.12307174457294
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -23.297122746091176
DONE TAKING  40  STEPS.
Total reward:  -685.4083726035675
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -25.86033092588925
DONE TAKING  40  STEPS.
Total reward:  -537.0350751517519
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.858077995330483
DONE TAKING  40  STEPS.
Total reward:  -292.1707685308032
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.04484207155033
DONE TAKING  40  STEPS.
Total reward:  -919.9798921997533
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -23.86723411671599
DONE TAKING  40  STEPS.
Total reward:  -736.0284501119856
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -24.692583823593335
DONE TAKING  40  STEPS.
Total reward:  -869.5050934455544
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -11.82230049822648
DONE TAKING  40  STEPS.
Total reward:  -422.08329533763686
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -31.015903445075654
DONE TAKING  40  STEPS.
Total reward:  -883.5823001464827
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -21.683959673269698
DONE TAKING  40  STEPS.
Total reward:  -383.5540157701307
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -21.93281837880811
DONE TAKING  40  STEPS.
Total reward:  -764.3132158858073
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -28.863139457863856
DONE TAKING  40  STEPS.
Total reward:  -537.2375660847978
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.399648176554933
DONE TAKING  40  STEPS.
Total reward:  152.13882851859526
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -24.959625380225596
DONE TAKING  40  STEPS.
Total reward:  -542.9992855024248
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -11.862355648630565
DONE TAKING  40  STEPS.
Total reward:  -184.75912089669643
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -28.43783804391545
DONE TAKING  40  STEPS.
Total reward:  -678.2098149974609
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -14.594183047444671
DONE TAKING  40  STEPS.
Total reward:  -304.9161820830259
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -24.03515279103388
DONE TAKING  40  STEPS.
Total reward:  -32.46714622665347
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -27.946430105800395
DONE TAKING  40  STEPS.
Total reward:  -339.38818110537375
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.124443494334677
DONE TAKING  40  STEPS.
Total reward:  -317.25272219812155
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -16.076977824466756
DONE TAKING  40  STEPS.
Total reward:  -242.87494205589158
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -11.880744250580943
DONE TAKING  40  STEPS.
Total reward:  -434.37625269591075
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.72474464747831
DONE TAKING  40  STEPS.
Total reward:  -244.1299350453994
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -19.623490160144495
DONE TAKING  40  STEPS.
Total reward:  -391.9532206869395
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.52918518390463
DONE TAKING  40  STEPS.
Total reward:  -936.1182005925192
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -15.73792500990146
DONE TAKING  40  STEPS.
Total reward:  -472.7035869915383
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 127
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  127
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5138454013749173
    val rand:  0
    val onPol:  0.40813128153483075

=== Epoch 10 ===
    train loss:  0.258297602335612
    val rand:  0
    val onPol:  0.3368708863854408

=== Epoch 20 ===
    train loss:  0.22420795627853327
    val rand:  0
    val onPol:  0.3322096988558769

=== Epoch 30 ===
    train loss:  0.20069899579934908
    val rand:  0
    val onPol:  0.33300605913003284

=== Epoch 39 ===
    train loss:  0.18352286386908145
    val rand:  0
    val onPol:  0.33901282399892807
Training duration: 18.81 s

#####################################
performing on-policy MPC rollouts... iter  127
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -19.821568900682735
DONE TAKING  40  STEPS.
Total reward:  -669.054355014782
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.183138119137148
DONE TAKING  40  STEPS.
Total reward:  -627.8176534991837
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -15.942140685706923
DONE TAKING  40  STEPS.
Total reward:  -272.496294568985
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -15.540714045209539
DONE TAKING  40  STEPS.
Total reward:  -684.620722265746
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.16561962284284
DONE TAKING  40  STEPS.
Total reward:  -527.4124683824812
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -12.156304542777834
DONE TAKING  40  STEPS.
Total reward:  129.39696770900508
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -31.03841804144536
DONE TAKING  40  STEPS.
Total reward:  -573.5679881076958
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -15.494215075400696
DONE TAKING  40  STEPS.
Total reward:  -446.1101130134126
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -22.145800664003463
DONE TAKING  40  STEPS.
Total reward:  -679.1796189336186
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.6481834582813
DONE TAKING  40  STEPS.
Total reward:  -857.3398328057117
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.88493791667488
DONE TAKING  40  STEPS.
Total reward:  -388.26641556031166
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -22.47938328987268
DONE TAKING  40  STEPS.
Total reward:  -336.930568990706
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -22.754299398078814
DONE TAKING  40  STEPS.
Total reward:  -524.3024592418171
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.577641197706061
DONE TAKING  40  STEPS.
Total reward:  -234.7622719989658
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -23.961513215696083
DONE TAKING  40  STEPS.
Total reward:  -407.74655687907926
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -29.36437445349316
DONE TAKING  40  STEPS.
Total reward:  -754.2101361083998
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -29.361357536251987
DONE TAKING  40  STEPS.
Total reward:  -784.0357173439434
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -23.39711552229705
DONE TAKING  40  STEPS.
Total reward:  -506.977451443952
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.727285277216204
DONE TAKING  40  STEPS.
Total reward:  -528.3013619442279
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -26.65281775771364
DONE TAKING  40  STEPS.
Total reward:  -734.8824963609513
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -21.527455465580978
DONE TAKING  40  STEPS.
Total reward:  -611.8477140958189
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -13.574144326436599
DONE TAKING  40  STEPS.
Total reward:  -238.22190169769965
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -25.95189411845024
DONE TAKING  40  STEPS.
Total reward:  -359.114671190437
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -12.402422887745237
DONE TAKING  40  STEPS.
Total reward:  394.39843696818116
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -22.17490588528353
DONE TAKING  40  STEPS.
Total reward:  -595.9353256479607
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -20.567852564924678
DONE TAKING  40  STEPS.
Total reward:  -304.56994592493226
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -20.561321992181902
DONE TAKING  40  STEPS.
Total reward:  -741.1116240866334
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -28.760170150963713
DONE TAKING  40  STEPS.
Total reward:  -1065.3431226283747
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -14.502195776327554
DONE TAKING  40  STEPS.
Total reward:  14.526930018378202
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -29.576070668001226
DONE TAKING  40  STEPS.
Total reward:  -697.6294201857244
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.24512341408716
DONE TAKING  40  STEPS.
Total reward:  -928.9455066604509
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -19.29827953738821
DONE TAKING  40  STEPS.
Total reward:  -152.07944217861564
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.315652456643175
DONE TAKING  40  STEPS.
Total reward:  -284.364806969712
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.219762569008125
DONE TAKING  40  STEPS.
Total reward:  -368.4124669260161
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -25.44084022165517
DONE TAKING  40  STEPS.
Total reward:  -92.16745778058085
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -28.34421978615477
DONE TAKING  40  STEPS.
Total reward:  -922.2858655494756
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -30.542214889721553
DONE TAKING  40  STEPS.
Total reward:  -349.0471159249239
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -25.714538224290266
DONE TAKING  40  STEPS.
Total reward:  -553.9060902847554
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -23.62043312735893
DONE TAKING  40  STEPS.
Total reward:  -711.1856541356005
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -13.995209300640916
DONE TAKING  40  STEPS.
Total reward:  -419.96806437644585
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 128
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  128
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5019997713858622
    val rand:  0
    val onPol:  0.39763104418913525

=== Epoch 10 ===
    train loss:  0.2610720793406169
    val rand:  0
    val onPol:  0.3298608139157295

=== Epoch 20 ===
    train loss:  0.2229457008734084
    val rand:  0
    val onPol:  0.3235123927394549

=== Epoch 30 ===
    train loss:  0.19754422207673392
    val rand:  0
    val onPol:  0.32635750869909924

=== Epoch 39 ===
    train loss:  0.17969228301131934
    val rand:  0
    val onPol:  0.33272958795229596
Training duration: 18.82 s

#####################################
performing on-policy MPC rollouts... iter  128
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -11.77227428774492
DONE TAKING  40  STEPS.
Total reward:  -346.75634965227533
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -28.998946889628225
DONE TAKING  40  STEPS.
Total reward:  -705.5721363184734
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -16.54807163829122
DONE TAKING  40  STEPS.
Total reward:  -545.4405697301555
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.270102735239057
DONE TAKING  40  STEPS.
Total reward:  -694.3428533568234
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.550684906722584
DONE TAKING  40  STEPS.
Total reward:  -154.44460142081786
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -21.247987252355173
DONE TAKING  40  STEPS.
Total reward:  -709.3896076571409
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -26.58900027188227
DONE TAKING  40  STEPS.
Total reward:  -600.1033562667925
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -28.97082271588561
DONE TAKING  40  STEPS.
Total reward:  -1083.4762101878453
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -16.752504342960638
DONE TAKING  40  STEPS.
Total reward:  -96.61772382613331
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -28.761259585609213
DONE TAKING  40  STEPS.
Total reward:  -1134.4954419184871
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.51611543677091
DONE TAKING  40  STEPS.
Total reward:  -433.3334275315429
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -24.08795992406814
DONE TAKING  40  STEPS.
Total reward:  -455.3669198546639
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -17.743100420642218
DONE TAKING  40  STEPS.
Total reward:  -379.8663134926934
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -21.837587891918886
DONE TAKING  40  STEPS.
Total reward:  -318.5368292925602
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -23.72849893006518
DONE TAKING  40  STEPS.
Total reward:  -732.8905627863345
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -20.874919028865975
DONE TAKING  40  STEPS.
Total reward:  202.00355729885905
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -15.965193000295653
DONE TAKING  40  STEPS.
Total reward:  -301.55879993206986
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -16.80111433117859
DONE TAKING  40  STEPS.
Total reward:  -649.8969802574272
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.280091746860535
DONE TAKING  40  STEPS.
Total reward:  -468.7329553417492
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.369057389406606
DONE TAKING  40  STEPS.
Total reward:  -376.73853156215415
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -18.79654208159173
DONE TAKING  40  STEPS.
Total reward:  -644.6165523233992
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -24.2263854435898
DONE TAKING  40  STEPS.
Total reward:  -618.9585687396267
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -23.47851428560425
DONE TAKING  40  STEPS.
Total reward:  -420.21787286195337
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.700265338434466
DONE TAKING  40  STEPS.
Total reward:  2.1465268210997785
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.240524377108454
DONE TAKING  40  STEPS.
Total reward:  -678.9439999744145
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -19.348659190329577
DONE TAKING  40  STEPS.
Total reward:  -392.36518065275556
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -19.148634544918767
DONE TAKING  40  STEPS.
Total reward:  -357.24134793834344
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -27.672965143288508
DONE TAKING  40  STEPS.
Total reward:  -636.7422969532554
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.655281518499788
DONE TAKING  40  STEPS.
Total reward:  -616.8853942996952
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -17.7993039780893
DONE TAKING  40  STEPS.
Total reward:  -524.6189094698506
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -18.132190054825404
DONE TAKING  40  STEPS.
Total reward:  -188.31332174300223
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.303719491694057
DONE TAKING  40  STEPS.
Total reward:  -721.5145910375297
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -29.615233920847427
DONE TAKING  40  STEPS.
Total reward:  -479.5363286210232
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -25.768839447238683
DONE TAKING  40  STEPS.
Total reward:  -680.8440373083278
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -24.584861604921336
DONE TAKING  40  STEPS.
Total reward:  -966.0937018783497
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -14.778425078334488
DONE TAKING  40  STEPS.
Total reward:  -326.1785756074534
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -14.185792964039717
DONE TAKING  40  STEPS.
Total reward:  -300.0741979679013
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.71989047457777
DONE TAKING  40  STEPS.
Total reward:  -858.3556709553736
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -9.51948038457023
DONE TAKING  40  STEPS.
Total reward:  -209.86680029822926
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.45511594112439
DONE TAKING  40  STEPS.
Total reward:  -669.8257790557814
Time for 1 rollout: 0.91 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 129
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  129
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5102312507336599
    val rand:  0
    val onPol:  0.3996262848377228

=== Epoch 10 ===
    train loss:  0.26060498858753006
    val rand:  0
    val onPol:  0.3332978884379069

=== Epoch 20 ===
    train loss:  0.2244847992010284
    val rand:  0
    val onPol:  0.32746930917104083

=== Epoch 30 ===
    train loss:  0.20001264125631565
    val rand:  0
    val onPol:  0.329614778359731

=== Epoch 39 ===
    train loss:  0.18303794426876202
    val rand:  0
    val onPol:  0.33405954639116925
Training duration: 15.34 s

#####################################
performing on-policy MPC rollouts... iter  129
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -9.039431921715375
DONE TAKING  40  STEPS.
Total reward:  -488.58467276676635
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -22.421044847048634
DONE TAKING  40  STEPS.
Total reward:  -216.72671721990326
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.85358216685123
DONE TAKING  40  STEPS.
Total reward:  -798.7337752646251
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -29.25657952147796
DONE TAKING  40  STEPS.
Total reward:  -134.22482086126269
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -21.318691812052826
DONE TAKING  40  STEPS.
Total reward:  -368.2719629062539
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -20.766768851993902
DONE TAKING  40  STEPS.
Total reward:  -175.40913291189992
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.152385925893498
DONE TAKING  40  STEPS.
Total reward:  -458.4634631117733
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.645500492493234
DONE TAKING  40  STEPS.
Total reward:  -862.0223234827808
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -11.320953956181173
DONE TAKING  40  STEPS.
Total reward:  -183.34085275713875
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -27.43463086648662
DONE TAKING  40  STEPS.
Total reward:  -641.2439057694238
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -14.878599703951291
DONE TAKING  40  STEPS.
Total reward:  296.1315715036422
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -30.110870812862668
DONE TAKING  40  STEPS.
Total reward:  -946.271685637618
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -16.211822658644383
DONE TAKING  40  STEPS.
Total reward:  -153.73296581709533
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -26.06825835135766
DONE TAKING  40  STEPS.
Total reward:  -479.9055253252126
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -16.52824055073761
DONE TAKING  40  STEPS.
Total reward:  -392.01979245725886
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -30.639128466972902
DONE TAKING  40  STEPS.
Total reward:  -629.39210854429
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -19.02490320177977
DONE TAKING  40  STEPS.
Total reward:  -705.5208095244651
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -25.68164300601799
DONE TAKING  40  STEPS.
Total reward:  -628.960743418246
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -31.042713209139627
DONE TAKING  40  STEPS.
Total reward:  -677.8469589255828
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -25.438750865451887
DONE TAKING  40  STEPS.
Total reward:  -509.1754232441083
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.85116465626234
DONE TAKING  40  STEPS.
Total reward:  -600.9424959964459
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.957665239073343
DONE TAKING  40  STEPS.
Total reward:  -508.87466332031875
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -19.812840770689252
DONE TAKING  40  STEPS.
Total reward:  -337.6489390480632
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.780122070247735
DONE TAKING  40  STEPS.
Total reward:  -380.6023590592715
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.369971669464444
DONE TAKING  40  STEPS.
Total reward:  -595.5048484887899
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -25.407934295249504
DONE TAKING  40  STEPS.
Total reward:  -577.5585694472684
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -23.629644999337273
DONE TAKING  40  STEPS.
Total reward:  -491.61167433870776
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -12.15713780391063
DONE TAKING  40  STEPS.
Total reward:  -485.4791464063103
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -26.376268658962303
DONE TAKING  40  STEPS.
Total reward:  -722.1559605259015
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.217187652785892
DONE TAKING  40  STEPS.
Total reward:  -710.023878472373
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -24.993360549057634
DONE TAKING  40  STEPS.
Total reward:  -594.5129805061451
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -18.43282066480834
DONE TAKING  40  STEPS.
Total reward:  -558.3952776204254
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -24.053122382529107
DONE TAKING  40  STEPS.
Total reward:  -682.1066262976374
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -28.931651318885972
DONE TAKING  40  STEPS.
Total reward:  -940.7974313244803
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -23.970934413374366
DONE TAKING  40  STEPS.
Total reward:  -503.47220102520987
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -29.63579217068535
DONE TAKING  40  STEPS.
Total reward:  -693.4835735334765
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -22.707955769135964
DONE TAKING  40  STEPS.
Total reward:  -699.2017582588705
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -22.32163316158955
DONE TAKING  40  STEPS.
Total reward:  -572.4068275909974
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -21.419545075465937
DONE TAKING  40  STEPS.
Total reward:  -381.39081610964155
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -13.122996938484263
DONE TAKING  40  STEPS.
Total reward:  -298.059673648326
Time for 1 rollout: 0.93 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 130
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  130
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5149819751580557
    val rand:  0
    val onPol:  0.4156765242417653

=== Epoch 10 ===
    train loss:  0.2590855807065964
    val rand:  0
    val onPol:  0.34604329864184064

=== Epoch 20 ===
    train loss:  0.2245205998943563
    val rand:  0
    val onPol:  0.3408636450767517

=== Epoch 30 ===
    train loss:  0.19926827440136358
    val rand:  0
    val onPol:  0.34264908234278363

=== Epoch 39 ===
    train loss:  0.18142211698649222
    val rand:  0
    val onPol:  0.35086871683597565
Training duration: 14.50 s

#####################################
performing on-policy MPC rollouts... iter  130
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -19.56918772543002
DONE TAKING  40  STEPS.
Total reward:  -527.4218883785564
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.253546782959884
DONE TAKING  40  STEPS.
Total reward:  -456.4582731012486
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -26.886709468445428
DONE TAKING  40  STEPS.
Total reward:  -396.88910205436866
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.58730497914736
DONE TAKING  40  STEPS.
Total reward:  -186.49334648625955
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.934703080752392
DONE TAKING  40  STEPS.
Total reward:  -785.1521355920521
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -25.976015761456758
DONE TAKING  40  STEPS.
Total reward:  -946.3270963904606
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.21673084467297
DONE TAKING  40  STEPS.
Total reward:  -436.93100928442976
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -8.83560600023533
DONE TAKING  40  STEPS.
Total reward:  -34.75335830623491
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.78592728764828
DONE TAKING  40  STEPS.
Total reward:  -647.2424147607198
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.707476068474175
DONE TAKING  40  STEPS.
Total reward:  -635.6241681906469
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -20.16080351203446
DONE TAKING  40  STEPS.
Total reward:  -316.27498976020996
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -18.503985533772745
DONE TAKING  40  STEPS.
Total reward:  -340.1020338559213
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -21.477454675260308
DONE TAKING  40  STEPS.
Total reward:  -542.1846985174939
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -20.40471916211598
DONE TAKING  40  STEPS.
Total reward:  -313.9091285125326
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -15.750193437776037
DONE TAKING  40  STEPS.
Total reward:  -375.14676286743395
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -19.562503013972794
DONE TAKING  40  STEPS.
Total reward:  -73.44898917929515
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -26.168955658095605
DONE TAKING  40  STEPS.
Total reward:  -1019.0856671291943
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -25.691030325252832
DONE TAKING  40  STEPS.
Total reward:  -616.482925922311
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -21.608346660476148
DONE TAKING  40  STEPS.
Total reward:  -356.28913531124516
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -25.5487734515135
DONE TAKING  40  STEPS.
Total reward:  -720.2381284007893
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -14.107137626226915
DONE TAKING  40  STEPS.
Total reward:  -434.6188028396273
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.18479018890957
DONE TAKING  40  STEPS.
Total reward:  -875.1202662667456
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -26.404621553816476
DONE TAKING  40  STEPS.
Total reward:  -849.6172714643249
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -14.670230227697418
DONE TAKING  40  STEPS.
Total reward:  -399.1590382205913
Time for 1 rollout: 0.90 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -27.730679005141504
DONE TAKING  40  STEPS.
Total reward:  -566.6938824929542
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -21.170060818463345
DONE TAKING  40  STEPS.
Total reward:  148.91758395781093
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.464632751140655
DONE TAKING  40  STEPS.
Total reward:  -445.08164799251864
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -13.752730180633282
DONE TAKING  40  STEPS.
Total reward:  -437.9612554115564
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -18.105050339886112
DONE TAKING  40  STEPS.
Total reward:  -447.02176266361204
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -27.864732078916468
DONE TAKING  40  STEPS.
Total reward:  -317.0856389091085
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.240523346301302
DONE TAKING  40  STEPS.
Total reward:  -695.2963991305207
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -15.05111184670524
DONE TAKING  40  STEPS.
Total reward:  -369.57346129402197
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -16.140864852252292
DONE TAKING  40  STEPS.
Total reward:  -287.6965855922745
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -22.13165398363813
DONE TAKING  40  STEPS.
Total reward:  -533.9647013440282
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.50178678578179
DONE TAKING  40  STEPS.
Total reward:  -456.1709786233602
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -19.195944368924582
DONE TAKING  40  STEPS.
Total reward:  -494.4366396025502
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -29.070347719777875
DONE TAKING  40  STEPS.
Total reward:  -82.50254264936935
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -17.362957510939548
DONE TAKING  40  STEPS.
Total reward:  -487.62551460050076
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.71436450110166
DONE TAKING  40  STEPS.
Total reward:  -783.4832133631733
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -16.626005928812667
DONE TAKING  40  STEPS.
Total reward:  -333.5303016063544
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 131
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  131
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5029068500326391
    val rand:  0
    val onPol:  0.40387091040611267

=== Epoch 10 ===
    train loss:  0.26032185240795735
    val rand:  0
    val onPol:  0.3399273604154587

=== Epoch 20 ===
    train loss:  0.22479542174883055
    val rand:  0
    val onPol:  0.3354452848434448

=== Epoch 30 ===
    train loss:  0.19924555954180265
    val rand:  0
    val onPol:  0.33592859903971356

=== Epoch 39 ===
    train loss:  0.18149125366880184
    val rand:  0
    val onPol:  0.34488801658153534
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  131
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.004943594252733
DONE TAKING  40  STEPS.
Total reward:  -631.4870900753965
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -17.15928133702104
DONE TAKING  40  STEPS.
Total reward:  -263.5469410046766
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -30.03007457550412
DONE TAKING  40  STEPS.
Total reward:  -925.2609789488951
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -20.181336897043643
DONE TAKING  40  STEPS.
Total reward:  -735.44234651012
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -20.478810508850334
DONE TAKING  40  STEPS.
Total reward:  -482.13299009588445
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -17.6329709429517
DONE TAKING  40  STEPS.
Total reward:  -507.7584120229494
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -17.546735286374883
DONE TAKING  40  STEPS.
Total reward:  -324.9001477298589
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -15.82297985588533
DONE TAKING  40  STEPS.
Total reward:  -393.17224739611123
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.037421867237583
DONE TAKING  40  STEPS.
Total reward:  -613.2329598940219
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -31.337247473206485
DONE TAKING  40  STEPS.
Total reward:  -694.2736249104978
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.71734000035579
DONE TAKING  40  STEPS.
Total reward:  -710.5864507907376
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -29.348155570749455
DONE TAKING  40  STEPS.
Total reward:  -751.4471479823067
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -12.113026300606894
DONE TAKING  40  STEPS.
Total reward:  -676.0994281180979
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -16.681704283360883
DONE TAKING  40  STEPS.
Total reward:  27.046033624687823
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -14.931498368707185
DONE TAKING  40  STEPS.
Total reward:  -381.8157980846646
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.781806016780045
DONE TAKING  40  STEPS.
Total reward:  -692.6587345086278
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -23.051882396512077
DONE TAKING  40  STEPS.
Total reward:  -505.20488740411247
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -29.19236524864217
DONE TAKING  40  STEPS.
Total reward:  -703.0166379542226
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -23.922214370947763
DONE TAKING  40  STEPS.
Total reward:  -820.743807291098
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.00002222413829
DONE TAKING  40  STEPS.
Total reward:  -844.2196079666934
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -11.090763325612459
DONE TAKING  40  STEPS.
Total reward:  -343.6069293656454
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.25589597523261
DONE TAKING  40  STEPS.
Total reward:  -401.77444944850794
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -16.98878791407379
DONE TAKING  40  STEPS.
Total reward:  -482.03433951829044
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -29.05171511334924
DONE TAKING  40  STEPS.
Total reward:  -873.6924602173247
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.411417948761553
DONE TAKING  40  STEPS.
Total reward:  -722.2308030902923
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.55273254762915
DONE TAKING  40  STEPS.
Total reward:  -1000.7284118773343
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.137334029454962
DONE TAKING  40  STEPS.
Total reward:  199.92444469470982
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -26.96639096323964
DONE TAKING  40  STEPS.
Total reward:  -869.0156578212002
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.918363624053722
DONE TAKING  40  STEPS.
Total reward:  -742.7885756773636
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -27.53042720668903
DONE TAKING  40  STEPS.
Total reward:  -955.7278968497329
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -18.676634983647222
DONE TAKING  40  STEPS.
Total reward:  -334.1680431547735
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -9.946471374588251
DONE TAKING  40  STEPS.
Total reward:  -320.3915026317649
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -17.656471363049896
DONE TAKING  40  STEPS.
Total reward:  -358.9998021378972
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -15.037734302282125
DONE TAKING  40  STEPS.
Total reward:  -361.5877249243539
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -19.72555856708364
DONE TAKING  40  STEPS.
Total reward:  -612.714613182217
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -19.198218916182505
DONE TAKING  40  STEPS.
Total reward:  -655.8696033770932
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -28.94532277898155
DONE TAKING  40  STEPS.
Total reward:  -703.7223487419766
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -16.763682186895213
DONE TAKING  40  STEPS.
Total reward:  -393.15542256872914
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -27.57669087614471
DONE TAKING  40  STEPS.
Total reward:  -834.9158045784241
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.26438536233882
DONE TAKING  40  STEPS.
Total reward:  -741.4802268224721
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 132
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  132
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5124831215331429
    val rand:  0
    val onPol:  0.39418503642082214

=== Epoch 10 ===
    train loss:  0.2657880296832637
    val rand:  0
    val onPol:  0.3309122522672017

=== Epoch 20 ===
    train loss:  0.22987637760346397
    val rand:  0
    val onPol:  0.32348357141017914

=== Epoch 30 ===
    train loss:  0.2031701120891069
    val rand:  0
    val onPol:  0.32582519948482513

=== Epoch 39 ===
    train loss:  0.1846318987377903
    val rand:  0
    val onPol:  0.3322233706712723
Training duration: 14.49 s

#####################################
performing on-policy MPC rollouts... iter  132
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -26.373858486904055
DONE TAKING  40  STEPS.
Total reward:  -167.06992887008343
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -18.8959672988711
DONE TAKING  40  STEPS.
Total reward:  -451.760100380289
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -24.057272176947905
DONE TAKING  40  STEPS.
Total reward:  -202.48478173185222
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.89053655342498
DONE TAKING  40  STEPS.
Total reward:  -479.6009724727423
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -19.910187895345693
DONE TAKING  40  STEPS.
Total reward:  49.27117297255229
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -28.843332195389056
DONE TAKING  40  STEPS.
Total reward:  -361.3034053731226
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -12.459700725175512
DONE TAKING  40  STEPS.
Total reward:  -335.2346471127217
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -27.09420939371041
DONE TAKING  40  STEPS.
Total reward:  -618.6672324850098
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -30.00724420854509
DONE TAKING  40  STEPS.
Total reward:  -752.1391946535806
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -22.359767865753017
DONE TAKING  40  STEPS.
Total reward:  -336.0971843164377
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -12.73398123704554
DONE TAKING  40  STEPS.
Total reward:  -410.4327118302588
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -17.200104444113524
DONE TAKING  40  STEPS.
Total reward:  -373.0147505382828
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -20.311939387745
DONE TAKING  40  STEPS.
Total reward:  -729.6654752835672
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -15.521615650062115
DONE TAKING  40  STEPS.
Total reward:  -575.535824111709
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -16.85779994161708
DONE TAKING  40  STEPS.
Total reward:  -283.5322660475825
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -10.118787784449845
DONE TAKING  40  STEPS.
Total reward:  -278.9866775494812
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -29.890419104769606
DONE TAKING  40  STEPS.
Total reward:  -909.933975250384
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -20.46766032356755
DONE TAKING  40  STEPS.
Total reward:  -14.801577560452401
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -24.836780514756633
DONE TAKING  40  STEPS.
Total reward:  -91.32211395748081
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -27.194364599859313
DONE TAKING  40  STEPS.
Total reward:  -312.46610895509
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -28.80418960478867
DONE TAKING  40  STEPS.
Total reward:  -1005.0831150876535
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -28.744195147473903
DONE TAKING  40  STEPS.
Total reward:  -796.048042730189
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.22337086447572
DONE TAKING  40  STEPS.
Total reward:  -704.2165295450349
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -22.71985508431324
DONE TAKING  40  STEPS.
Total reward:  -296.56943077076943
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -27.90842001543912
DONE TAKING  40  STEPS.
Total reward:  -581.0277447136477
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.948413588085938
DONE TAKING  40  STEPS.
Total reward:  -156.69946962573258
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -20.496814188362052
DONE TAKING  40  STEPS.
Total reward:  -478.0101919525245
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.491594627910303
DONE TAKING  40  STEPS.
Total reward:  -670.5527208102908
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -28.888377552728898
DONE TAKING  40  STEPS.
Total reward:  -40.72433837264489
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -30.69419959905151
DONE TAKING  40  STEPS.
Total reward:  -806.4919089526637
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -31.347234890630958
DONE TAKING  40  STEPS.
Total reward:  -721.3625848246654
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.757263424442073
DONE TAKING  40  STEPS.
Total reward:  -554.5688018674496
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.316187498438346
DONE TAKING  40  STEPS.
Total reward:  -799.3706146673386
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -22.77504234592279
DONE TAKING  40  STEPS.
Total reward:  -369.1534194403786
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.716955191632866
DONE TAKING  40  STEPS.
Total reward:  -705.8789948777527
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -24.055836024816717
DONE TAKING  40  STEPS.
Total reward:  -156.47117467040673
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -24.843996449829262
DONE TAKING  40  STEPS.
Total reward:  -330.9189932094231
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.485922024475396
DONE TAKING  40  STEPS.
Total reward:  -447.61780526644634
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -19.638553708561822
DONE TAKING  40  STEPS.
Total reward:  32.620881913664576
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -19.75579111894596
DONE TAKING  40  STEPS.
Total reward:  -339.8978065260835
Time for 1 rollout: 0.92 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 133
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  133
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5169067110931664
    val rand:  0
    val onPol:  0.40443294246991474

=== Epoch 10 ===
    train loss:  0.26711746579722356
    val rand:  0
    val onPol:  0.3371201778451602

=== Epoch 20 ===
    train loss:  0.2305744123040584
    val rand:  0
    val onPol:  0.3285410702228546

=== Epoch 30 ===
    train loss:  0.20431038136022134
    val rand:  0
    val onPol:  0.3334099352359772

=== Epoch 39 ===
    train loss:  0.18180250206537413
    val rand:  0
    val onPol:  0.3364569346110026
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  133
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.897313371250338
DONE TAKING  40  STEPS.
Total reward:  -811.0034847762902
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -25.310237345338955
DONE TAKING  40  STEPS.
Total reward:  -575.2955255002618
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.231786810592627
DONE TAKING  40  STEPS.
Total reward:  -713.4256718628384
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -26.791127674034104
DONE TAKING  40  STEPS.
Total reward:  -637.6263798051641
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.050807027692937
DONE TAKING  40  STEPS.
Total reward:  -531.1921910203761
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -28.278641691430924
DONE TAKING  40  STEPS.
Total reward:  -1045.5499518700767
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -23.54756016919689
DONE TAKING  40  STEPS.
Total reward:  120.3894555339598
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -30.921817414900442
DONE TAKING  40  STEPS.
Total reward:  -932.7068467497501
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -28.442399058708723
DONE TAKING  40  STEPS.
Total reward:  -371.67127233418864
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -16.49800479973002
DONE TAKING  40  STEPS.
Total reward:  -264.32160948342624
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -21.56502477592193
DONE TAKING  40  STEPS.
Total reward:  -728.4004497158451
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -13.931845855516194
DONE TAKING  40  STEPS.
Total reward:  -417.04748015693104
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.407548615192578
DONE TAKING  40  STEPS.
Total reward:  -437.2736594172895
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -19.79797847454961
DONE TAKING  40  STEPS.
Total reward:  -181.54180036773187
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -27.032132941847536
DONE TAKING  40  STEPS.
Total reward:  -848.3234957698184
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.23462741521468
DONE TAKING  40  STEPS.
Total reward:  -627.7525209435423
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -22.669035370688917
DONE TAKING  40  STEPS.
Total reward:  -300.91954958669857
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -28.724766310795793
DONE TAKING  40  STEPS.
Total reward:  -746.6901727319278
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -23.364564147555495
DONE TAKING  40  STEPS.
Total reward:  -790.0773904714151
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -19.224564717433047
DONE TAKING  40  STEPS.
Total reward:  -418.5284851238438
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.39361145023076
DONE TAKING  40  STEPS.
Total reward:  -68.56509528216019
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.58038913653904
DONE TAKING  40  STEPS.
Total reward:  -334.09091871100804
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -15.479691014256804
DONE TAKING  40  STEPS.
Total reward:  -64.41206550040606
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -18.42415743211366
DONE TAKING  40  STEPS.
Total reward:  -438.03397540684387
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -20.145896102393017
DONE TAKING  40  STEPS.
Total reward:  -175.00059117174877
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -19.402025103241396
DONE TAKING  40  STEPS.
Total reward:  -547.7551336707461
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -15.800090965442603
DONE TAKING  40  STEPS.
Total reward:  -332.4825028599329
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -28.23135433945268
DONE TAKING  40  STEPS.
Total reward:  -921.8254919118045
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -20.96648308395546
DONE TAKING  40  STEPS.
Total reward:  -407.2620377277153
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -23.169772101196195
DONE TAKING  40  STEPS.
Total reward:  -686.9628364855655
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -26.458151668721147
DONE TAKING  40  STEPS.
Total reward:  -897.777391304074
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -20.330162101522802
DONE TAKING  40  STEPS.
Total reward:  -357.4242306722777
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.99064891014507
DONE TAKING  40  STEPS.
Total reward:  -633.9764679059815
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -26.059193364374067
DONE TAKING  40  STEPS.
Total reward:  -848.469154701652
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -18.934245599492776
DONE TAKING  40  STEPS.
Total reward:  -360.88747220131177
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -26.45065971548348
DONE TAKING  40  STEPS.
Total reward:  -285.4637297265661
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -30.553956336769442
DONE TAKING  40  STEPS.
Total reward:  -784.3697598332496
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -28.03661263137865
DONE TAKING  40  STEPS.
Total reward:  -410.0530516425539
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -14.765743313665013
DONE TAKING  40  STEPS.
Total reward:  -512.4228568051993
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.112515262300022
DONE TAKING  40  STEPS.
Total reward:  -400.0621369058167
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 134
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  134
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.506993850072225
    val rand:  0
    val onPol:  0.4025097042322159

=== Epoch 10 ===
    train loss:  0.26593612003744693
    val rand:  0
    val onPol:  0.3360096365213394

=== Epoch 20 ===
    train loss:  0.22915096267273552
    val rand:  0
    val onPol:  0.3310592820247014

=== Epoch 30 ===
    train loss:  0.2021805484566772
    val rand:  0
    val onPol:  0.33438041309515637

=== Epoch 39 ===
    train loss:  0.18615190083520455
    val rand:  0
    val onPol:  0.3401658932367961
Training duration: 14.45 s

#####################################
performing on-policy MPC rollouts... iter  134
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -22.63385255910353
DONE TAKING  40  STEPS.
Total reward:  -355.3674509513253
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -30.10013686900523
DONE TAKING  40  STEPS.
Total reward:  -821.8482256608154
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -22.164509599801406
DONE TAKING  40  STEPS.
Total reward:  -453.9255666154258
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -30.057238931132233
DONE TAKING  40  STEPS.
Total reward:  -577.8790877529483
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.717712268959026
DONE TAKING  40  STEPS.
Total reward:  -954.7393506734772
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -15.193329959073427
DONE TAKING  40  STEPS.
Total reward:  -178.0866977292153
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -27.14615812742793
DONE TAKING  40  STEPS.
Total reward:  -661.1975745174938
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.55412908431262
DONE TAKING  40  STEPS.
Total reward:  -37.59935814461
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -27.979752788341052
DONE TAKING  40  STEPS.
Total reward:  -1002.9659351842602
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.6182494989072
DONE TAKING  40  STEPS.
Total reward:  -704.0383017826732
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -25.129932419891816
DONE TAKING  40  STEPS.
Total reward:  -1078.9110145251677
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -23.15432034046054
DONE TAKING  40  STEPS.
Total reward:  -567.9974543442105
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.821861498183665
DONE TAKING  40  STEPS.
Total reward:  -238.00115669655779
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -10.119540504702895
DONE TAKING  40  STEPS.
Total reward:  -274.6708011551033
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.16819090363225
DONE TAKING  40  STEPS.
Total reward:  -813.8752223466487
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -15.599565019679202
DONE TAKING  40  STEPS.
Total reward:  144.9140917838866
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -10.78778762670365
DONE TAKING  40  STEPS.
Total reward:  -347.7474806882606
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.172763525644175
DONE TAKING  40  STEPS.
Total reward:  -106.15004978527001
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -29.352460480494514
DONE TAKING  40  STEPS.
Total reward:  -968.5402608698035
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -21.41998057600067
DONE TAKING  40  STEPS.
Total reward:  -237.9463109654454
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.518762623728534
DONE TAKING  40  STEPS.
Total reward:  -740.9211997767687
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -27.821583940105423
DONE TAKING  40  STEPS.
Total reward:  -852.6572798039307
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -26.86116095900457
DONE TAKING  40  STEPS.
Total reward:  -616.666089447747
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.50032043183063
DONE TAKING  40  STEPS.
Total reward:  -639.7961395945898
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.720165012317775
DONE TAKING  40  STEPS.
Total reward:  -749.2609704765517
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -22.792078591522127
DONE TAKING  40  STEPS.
Total reward:  -573.1054550906225
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -19.758756802771266
DONE TAKING  40  STEPS.
Total reward:  -666.7245382606868
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -23.81302644997693
DONE TAKING  40  STEPS.
Total reward:  -503.7664190492783
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -19.012941076603
DONE TAKING  40  STEPS.
Total reward:  -624.5503140818861
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -10.5285200731543
DONE TAKING  40  STEPS.
Total reward:  -371.7079307030016
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.467621652077845
DONE TAKING  40  STEPS.
Total reward:  -919.8834956125978
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -24.134420612276962
DONE TAKING  40  STEPS.
Total reward:  -1026.648655413653
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -9.87650588585732
DONE TAKING  40  STEPS.
Total reward:  -68.02353433398211
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -20.909656041958286
DONE TAKING  40  STEPS.
Total reward:  -641.5681343810023
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -20.446709210276723
DONE TAKING  40  STEPS.
Total reward:  -87.91363207358906
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -18.627202788257083
DONE TAKING  40  STEPS.
Total reward:  -529.6361413057572
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -22.0579212465675
DONE TAKING  40  STEPS.
Total reward:  -719.6878058493962
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -9.75279277199313
DONE TAKING  40  STEPS.
Total reward:  -326.57012259601464
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.497357149569815
DONE TAKING  40  STEPS.
Total reward:  -416.689616664094
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -28.492212652605104
DONE TAKING  40  STEPS.
Total reward:  -523.7842088918992
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 135
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  135
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5117959040298796
    val rand:  0
    val onPol:  0.4019903192917506

=== Epoch 10 ===
    train loss:  0.27013029158115387
    val rand:  0
    val onPol:  0.33768584827582043

=== Epoch 20 ===
    train loss:  0.23133309603783123
    val rand:  0
    val onPol:  0.3336460590362549

=== Epoch 30 ===
    train loss:  0.20571958861852946
    val rand:  0
    val onPol:  0.33649834990501404

=== Epoch 39 ===
    train loss:  0.18756220241387686
    val rand:  0
    val onPol:  0.3422495126724243
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  135
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -14.102621675999565
DONE TAKING  40  STEPS.
Total reward:  -308.8295008333155
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.86294179728649
DONE TAKING  40  STEPS.
Total reward:  -702.8268438665914
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -30.50228711801667
DONE TAKING  40  STEPS.
Total reward:  -735.2543304089667
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -24.844233579404438
DONE TAKING  40  STEPS.
Total reward:  -412.5118064024282
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -24.795949718661163
DONE TAKING  40  STEPS.
Total reward:  -770.9753231546165
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -23.885203401955803
DONE TAKING  40  STEPS.
Total reward:  -571.8327623919091
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -26.764379543161812
DONE TAKING  40  STEPS.
Total reward:  -715.3303985316122
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.81647224107535
DONE TAKING  40  STEPS.
Total reward:  -832.1226992233472
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -19.60834976801775
DONE TAKING  40  STEPS.
Total reward:  -385.13311619478833
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -25.218197884749532
DONE TAKING  40  STEPS.
Total reward:  -983.5977257952934
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -19.643643412433324
DONE TAKING  40  STEPS.
Total reward:  -215.16213298601104
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -21.261880565911852
DONE TAKING  40  STEPS.
Total reward:  -518.9385338334458
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -19.029941347012485
DONE TAKING  40  STEPS.
Total reward:  -346.45890896738774
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.329641353410814
DONE TAKING  40  STEPS.
Total reward:  -874.7541934257063
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -18.934896488111107
DONE TAKING  40  STEPS.
Total reward:  -362.08095997432883
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -16.681365814367506
DONE TAKING  40  STEPS.
Total reward:  -399.41063750307757
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -18.116743711190768
DONE TAKING  40  STEPS.
Total reward:  -419.7327979953268
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -24.61596398329263
DONE TAKING  40  STEPS.
Total reward:  -478.9189175016533
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -26.053956693939853
DONE TAKING  40  STEPS.
Total reward:  -700.277770030007
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -27.993823783185668
DONE TAKING  40  STEPS.
Total reward:  -563.8623994370977
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -25.149220161284326
DONE TAKING  40  STEPS.
Total reward:  -378.6735119650169
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -27.833985841157865
DONE TAKING  40  STEPS.
Total reward:  -710.1964885127442
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -23.801758545517973
DONE TAKING  40  STEPS.
Total reward:  -832.2373214595316
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -14.251149691612877
DONE TAKING  40  STEPS.
Total reward:  -536.7805097009451
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -28.973132098927955
DONE TAKING  40  STEPS.
Total reward:  -876.4228270427615
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.869182938374255
DONE TAKING  40  STEPS.
Total reward:  -677.9302291639201
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -31.400689629891172
DONE TAKING  40  STEPS.
Total reward:  -891.059523300861
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -11.40424123153795
DONE TAKING  40  STEPS.
Total reward:  253.30754404904854
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -20.87231459402238
DONE TAKING  40  STEPS.
Total reward:  -739.9688026043212
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.96074080132584
DONE TAKING  40  STEPS.
Total reward:  -405.6958022642833
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -23.27728200390557
DONE TAKING  40  STEPS.
Total reward:  -436.40145081275057
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -25.980888634907856
DONE TAKING  40  STEPS.
Total reward:  -909.4683733814293
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.627568247304023
DONE TAKING  40  STEPS.
Total reward:  -531.8443742686239
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -23.046969793939027
DONE TAKING  40  STEPS.
Total reward:  -833.7769583664982
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.009360341879585
DONE TAKING  40  STEPS.
Total reward:  -525.6907042908633
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -26.00986626078925
DONE TAKING  40  STEPS.
Total reward:  -533.0214370956811
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -29.234222313283706
DONE TAKING  40  STEPS.
Total reward:  -1057.147343655915
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -23.32885258425234
DONE TAKING  40  STEPS.
Total reward:  -481.45717469937745
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.324105406202335
DONE TAKING  40  STEPS.
Total reward:  -973.972650253343
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -19.00431688680328
DONE TAKING  40  STEPS.
Total reward:  -633.5588238454378
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  4
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 136
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  136
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5186887801739207
    val rand:  0
    val onPol:  0.41205396751562756

=== Epoch 10 ===
    train loss:  0.27318530385954337
    val rand:  0
    val onPol:  0.3446531593799591

=== Epoch 20 ===
    train loss:  0.23175433016659922
    val rand:  0
    val onPol:  0.34113435447216034

=== Epoch 30 ===
    train loss:  0.20227582883416562
    val rand:  0
    val onPol:  0.3426940937836965

=== Epoch 39 ===
    train loss:  0.1865641244670801
    val rand:  0
    val onPol:  0.34933899343013763
Training duration: 14.04 s

#####################################
performing on-policy MPC rollouts... iter  136
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -19.132027536647254
DONE TAKING  40  STEPS.
Total reward:  96.71717288261176
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -27.824736334068973
DONE TAKING  40  STEPS.
Total reward:  -583.0824327955648
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -8.042027617134496
DONE TAKING  40  STEPS.
Total reward:  -240.99565659328292
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -20.101481699383946
DONE TAKING  40  STEPS.
Total reward:  -324.8846849432517
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -15.813440327626074
DONE TAKING  40  STEPS.
Total reward:  -616.6219200260541
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -23.84512908372426
DONE TAKING  40  STEPS.
Total reward:  -643.3509974292708
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -27.051856797419575
DONE TAKING  40  STEPS.
Total reward:  -534.8656166480047
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 7
Model selected:  2
done step  0 , rew:  -29.539732310666672
DONE TAKING  40  STEPS.
Total reward:  -678.8067154014612
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -18.03042849438252
DONE TAKING  40  STEPS.
Total reward:  -295.6296892245999
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -22.187408611579606
DONE TAKING  40  STEPS.
Total reward:  -463.50461527623355
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -22.26817527689701
DONE TAKING  40  STEPS.
Total reward:  -494.7862007658624
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -12.448692877513327
DONE TAKING  40  STEPS.
Total reward:  138.16174326755166
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -20.31674778080546
DONE TAKING  40  STEPS.
Total reward:  -290.4533598711612
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -18.133862363071053
DONE TAKING  40  STEPS.
Total reward:  -643.1492554661369
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.742071579516605
DONE TAKING  40  STEPS.
Total reward:  -677.5685812025281
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -22.461315405478153
DONE TAKING  40  STEPS.
Total reward:  -349.0332555880469
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.689035517779093
DONE TAKING  40  STEPS.
Total reward:  -68.75994876240611
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -24.25070052758602
DONE TAKING  40  STEPS.
Total reward:  -282.4174190930945
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -27.47286958020687
DONE TAKING  40  STEPS.
Total reward:  -892.7151223865469
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -26.483782296038363
DONE TAKING  40  STEPS.
Total reward:  -453.9193753644921
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.027013966492394
DONE TAKING  40  STEPS.
Total reward:  -510.04551205441834
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -11.253848095157597
DONE TAKING  40  STEPS.
Total reward:  76.0826568372419
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -29.739363238226304
DONE TAKING  40  STEPS.
Total reward:  -1075.7011346447978
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -29.485763581408968
DONE TAKING  40  STEPS.
Total reward:  -421.6961440818786
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.76246591232897
DONE TAKING  40  STEPS.
Total reward:  -259.92309285113237
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.73685173493697
DONE TAKING  40  STEPS.
Total reward:  -31.311589755937124
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -25.128002848717035
DONE TAKING  40  STEPS.
Total reward:  -740.5347808283133
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -18.083326774342506
DONE TAKING  40  STEPS.
Total reward:  -773.9028000029247
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -29.24688957086039
DONE TAKING  40  STEPS.
Total reward:  -16.00450991404497
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -14.329636601174847
DONE TAKING  40  STEPS.
Total reward:  -509.9434278486376
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -30.24102510693744
DONE TAKING  40  STEPS.
Total reward:  -321.1047348741765
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.07798195809025
DONE TAKING  40  STEPS.
Total reward:  -455.9987690508114
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -26.97610411598451
DONE TAKING  40  STEPS.
Total reward:  -480.6773785941529
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -30.120678306175552
DONE TAKING  40  STEPS.
Total reward:  -1157.5111750991184
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -14.106471438412134
DONE TAKING  40  STEPS.
Total reward:  322.8331014468073
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -12.285318964584569
DONE TAKING  40  STEPS.
Total reward:  -257.6921105290375
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.18061811533777
DONE TAKING  40  STEPS.
Total reward:  -319.0817496648491
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.854763815146256
DONE TAKING  40  STEPS.
Total reward:  -989.5143468034158
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -30.853152603971836
DONE TAKING  40  STEPS.
Total reward:  -454.0541290746516
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.330250197522428
DONE TAKING  40  STEPS.
Total reward:  -626.3737725872276
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Completed rollout #  2
Performed  5  rollouts, each with  40  steps.
Iter: 137
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  137
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.51470278647908
    val rand:  0
    val onPol:  0.40760381023089093

=== Epoch 10 ===
    train loss:  0.26944422199015033
    val rand:  0
    val onPol:  0.33958087861537933

=== Epoch 20 ===
    train loss:  0.2318268159502431
    val rand:  0
    val onPol:  0.3349827726682027

=== Epoch 30 ===
    train loss:  0.205307369169436
    val rand:  0
    val onPol:  0.3372465918461482

=== Epoch 39 ===
    train loss:  0.1858966834189599
    val rand:  0
    val onPol:  0.3415375351905823
Training duration: 14.16 s

#####################################
performing on-policy MPC rollouts... iter  137
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -29.63584793089261
DONE TAKING  40  STEPS.
Total reward:  -228.61801001428924
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -21.597917562217983
DONE TAKING  40  STEPS.
Total reward:  -623.5649290579199
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -24.772261955588174
DONE TAKING  40  STEPS.
Total reward:  -609.5245747580265
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -24.485223037322193
DONE TAKING  40  STEPS.
Total reward:  -836.4755490610264
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -31.11088419714313
DONE TAKING  40  STEPS.
Total reward:  -554.2515597101694
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -22.489592557905116
DONE TAKING  40  STEPS.
Total reward:  -398.9803265999916
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -31.312633305278005
DONE TAKING  40  STEPS.
Total reward:  -684.3583932015528
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -15.525416999109583
DONE TAKING  40  STEPS.
Total reward:  -489.1987225388145
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -26.508631725777867
DONE TAKING  40  STEPS.
Total reward:  -610.8945953044246
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -30.40128451428491
DONE TAKING  40  STEPS.
Total reward:  -919.5791409312919
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -21.78786183802204
DONE TAKING  40  STEPS.
Total reward:  -309.53981093628914
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -17.19166367972535
DONE TAKING  40  STEPS.
Total reward:  -355.5901682058273
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -26.453358673147633
DONE TAKING  40  STEPS.
Total reward:  -234.6153972347554
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -31.01997675150411
DONE TAKING  40  STEPS.
Total reward:  -858.1775030062089
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -22.26638480833956
DONE TAKING  40  STEPS.
Total reward:  -682.9358065126282
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -23.85163506249321
DONE TAKING  40  STEPS.
Total reward:  -118.48494081468455
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -27.948971380607645
DONE TAKING  40  STEPS.
Total reward:  -992.1093814834664
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -26.8569774251856
DONE TAKING  40  STEPS.
Total reward:  -678.6558140476595
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -14.353347450732393
DONE TAKING  40  STEPS.
Total reward:  -67.42318461004311
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -19.345621575529076
DONE TAKING  40  STEPS.
Total reward:  261.11396213137823
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -30.09163387621018
DONE TAKING  40  STEPS.
Total reward:  -779.3357679168614
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -27.164505991701247
DONE TAKING  40  STEPS.
Total reward:  -454.9394724107981
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.665684713998086
DONE TAKING  40  STEPS.
Total reward:  -400.51217063989657
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -23.613716235488127
DONE TAKING  40  STEPS.
Total reward:  -877.5073658086212
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -18.21926720417826
DONE TAKING  40  STEPS.
Total reward:  106.7965927278126
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.85160150509774
DONE TAKING  40  STEPS.
Total reward:  -659.9726682219216
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -22.14871920691366
DONE TAKING  40  STEPS.
Total reward:  -392.2549500764208
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -19.26027993780825
DONE TAKING  40  STEPS.
Total reward:  -681.1749585237502
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -28.762715115404912
DONE TAKING  40  STEPS.
Total reward:  -803.229195530148
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -23.977828253204162
DONE TAKING  40  STEPS.
Total reward:  -637.7225778035253
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -30.291712102707002
DONE TAKING  40  STEPS.
Total reward:  -252.5041468651729
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -24.692640244480376
DONE TAKING  40  STEPS.
Total reward:  -390.9332203730631
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -22.8225941432849
DONE TAKING  40  STEPS.
Total reward:  -500.61142392200696
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -18.573885551767866
DONE TAKING  40  STEPS.
Total reward:  -398.31530733654665
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -20.9207671965931
DONE TAKING  40  STEPS.
Total reward:  -606.5111102061096
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 35
Model selected:  2
done step  0 , rew:  -15.03379371790102
DONE TAKING  40  STEPS.
Total reward:  -482.65214634529656
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -14.643912569375491
DONE TAKING  40  STEPS.
Total reward:  -256.1279498500607
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -23.769395675754904
DONE TAKING  40  STEPS.
Total reward:  -741.8956868185007
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -21.989183124361645
DONE TAKING  40  STEPS.
Total reward:  -797.9595122736454
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -30.48368501546745
DONE TAKING  40  STEPS.
Total reward:  -560.2722458680672
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  0
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 138
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  138
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5123813758816635
    val rand:  0
    val onPol:  0.40362265209356946

=== Epoch 10 ===
    train loss:  0.2722264719113969
    val rand:  0
    val onPol:  0.3394787659247716

=== Epoch 20 ===
    train loss:  0.2319557888988863
    val rand:  0
    val onPol:  0.3307931174834569

=== Epoch 30 ===
    train loss:  0.204910266294814
    val rand:  0
    val onPol:  0.33777032295862836

=== Epoch 39 ===
    train loss:  0.1871666895192966
    val rand:  0
    val onPol:  0.34119294583797455
Training duration: 14.23 s

#####################################
performing on-policy MPC rollouts... iter  138
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -20.743328811600303
DONE TAKING  40  STEPS.
Total reward:  -752.4657257451852
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -20.44701093380133
DONE TAKING  40  STEPS.
Total reward:  -343.0947051973683
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -24.521812523679642
DONE TAKING  40  STEPS.
Total reward:  -545.7710594406584
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -13.38854736665015
DONE TAKING  40  STEPS.
Total reward:  -473.881642003069
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.01079811399098
DONE TAKING  40  STEPS.
Total reward:  -1034.6280880545935
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -30.10193702080697
DONE TAKING  40  STEPS.
Total reward:  -752.5940032504088
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -30.537420838702666
DONE TAKING  40  STEPS.
Total reward:  -784.0558300096553
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.983330425388544
DONE TAKING  40  STEPS.
Total reward:  -533.9688238070476
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -16.365793597355196
DONE TAKING  40  STEPS.
Total reward:  -288.34427670347435
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -28.711226465896576
DONE TAKING  40  STEPS.
Total reward:  -910.3984931627516
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -27.346222077004537
DONE TAKING  40  STEPS.
Total reward:  -958.7645909809705
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.77953558586942
DONE TAKING  40  STEPS.
Total reward:  -21.986377459920753
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -12.11862778549169
DONE TAKING  40  STEPS.
Total reward:  106.01819615334503
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -28.644675988460477
DONE TAKING  40  STEPS.
Total reward:  -720.1405774676051
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -12.604188555564
DONE TAKING  40  STEPS.
Total reward:  -69.33850700601181
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -17.382155568509518
DONE TAKING  40  STEPS.
Total reward:  -371.7090087568257
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.263346485699966
DONE TAKING  40  STEPS.
Total reward:  -978.2195366622495
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.899520135783128
DONE TAKING  40  STEPS.
Total reward:  -501.1596370641729
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.47802686101857
DONE TAKING  40  STEPS.
Total reward:  -803.6020360693872
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -20.952653023188915
DONE TAKING  40  STEPS.
Total reward:  -2.7573685947431223
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -24.23475042688889
DONE TAKING  40  STEPS.
Total reward:  -504.92053151896664
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -22.835662439990102
DONE TAKING  40  STEPS.
Total reward:  -461.4494315555683
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.25187402909065
DONE TAKING  40  STEPS.
Total reward:  -407.6778692062753
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -18.571362822127124
DONE TAKING  40  STEPS.
Total reward:  186.3012684095692
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.458545642007078
DONE TAKING  40  STEPS.
Total reward:  -599.6868525601953
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -14.972797271464875
DONE TAKING  40  STEPS.
Total reward:  -571.4925602924693
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -24.894978754589175
DONE TAKING  40  STEPS.
Total reward:  -519.2075620751212
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  1
done step  0 , rew:  -13.815878573151101
DONE TAKING  40  STEPS.
Total reward:  -395.82555652174693
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -12.117965888934927
DONE TAKING  40  STEPS.
Total reward:  -355.44362387635607
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -21.616193678585883
DONE TAKING  40  STEPS.
Total reward:  -494.7375540795991
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -30.331596495977568
DONE TAKING  40  STEPS.
Total reward:  -723.9825152262332
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -29.487876920615015
DONE TAKING  40  STEPS.
Total reward:  -900.969831602088
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -18.085757204706802
DONE TAKING  40  STEPS.
Total reward:  -620.3648671942925
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -15.932245709818309
DONE TAKING  40  STEPS.
Total reward:  -447.91711403317544
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -24.9895375958665
DONE TAKING  40  STEPS.
Total reward:  -932.4970395454525
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -27.414072315529054
DONE TAKING  40  STEPS.
Total reward:  -270.42883625476105
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -28.919781338659867
DONE TAKING  40  STEPS.
Total reward:  -647.467680343001
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -27.93362599904785
DONE TAKING  40  STEPS.
Total reward:  -595.4254411436963
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.061971889026374
DONE TAKING  40  STEPS.
Total reward:  -759.9776367736602
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -31.18782845523878
DONE TAKING  40  STEPS.
Total reward:  -740.0513346819777
Time for 1 rollout: 0.96 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 139
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  139
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5169270357541871
    val rand:  0
    val onPol:  0.40321118136247

=== Epoch 10 ===
    train loss:  0.27358749012152356
    val rand:  0
    val onPol:  0.3341804693142573

=== Epoch 20 ===
    train loss:  0.23447373875400476
    val rand:  0
    val onPol:  0.3267773340145747

=== Epoch 30 ===
    train loss:  0.20694994821883084
    val rand:  0
    val onPol:  0.332203005750974

=== Epoch 39 ===
    train loss:  0.18598322125903347
    val rand:  0
    val onPol:  0.33842256168524426
Training duration: 14.24 s

#####################################
performing on-policy MPC rollouts... iter  139
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -26.74816566789601
DONE TAKING  40  STEPS.
Total reward:  -881.7747119051095
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -28.21816461177316
DONE TAKING  40  STEPS.
Total reward:  -612.8168148412318
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -14.32015129847142
DONE TAKING  40  STEPS.
Total reward:  -380.4536249253407
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.980379853058754
DONE TAKING  40  STEPS.
Total reward:  -586.2764801599135
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -23.228592774309057
DONE TAKING  40  STEPS.
Total reward:  -845.917006495193
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -16.910092906326323
DONE TAKING  40  STEPS.
Total reward:  -384.76513178226895
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -28.62683331171357
DONE TAKING  40  STEPS.
Total reward:  -989.3024932993699
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.15510437981842
DONE TAKING  40  STEPS.
Total reward:  -126.98596968774623
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -21.707350823127335
DONE TAKING  40  STEPS.
Total reward:  -393.5944479771217
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -19.70582718929102
DONE TAKING  40  STEPS.
Total reward:  -475.3775531463578
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -12.645400753104287
DONE TAKING  40  STEPS.
Total reward:  -331.45933781978397
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -20.277055953344384
DONE TAKING  40  STEPS.
Total reward:  -793.3240635926857
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -28.19708316909502
DONE TAKING  40  STEPS.
Total reward:  -1023.3722201318549
Time for 1 rollout: 1.12 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -30.233194231486422
DONE TAKING  40  STEPS.
Total reward:  -686.626687144125
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -11.465144774585907
DONE TAKING  40  STEPS.
Total reward:  92.96117620749419
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -14.522512293558114
DONE TAKING  40  STEPS.
Total reward:  -431.36563912586735
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -24.913457116352838
DONE TAKING  40  STEPS.
Total reward:  -689.3604086037537
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  2
done step  0 , rew:  -26.982921014625887
DONE TAKING  40  STEPS.
Total reward:  -607.2913809342126
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -30.32613424240918
DONE TAKING  40  STEPS.
Total reward:  -562.3989149235515
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -13.521922595806304
DONE TAKING  40  STEPS.
Total reward:  -491.70009863247793
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -22.393707589224476
DONE TAKING  40  STEPS.
Total reward:  -663.4959536345167
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -19.233955652451076
DONE TAKING  40  STEPS.
Total reward:  -244.1882890764164
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -30.192254773910584
DONE TAKING  40  STEPS.
Total reward:  -713.7943749399026
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -23.379397240357473
DONE TAKING  40  STEPS.
Total reward:  -726.6362453960395
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -19.19567589813395
DONE TAKING  40  STEPS.
Total reward:  -240.2406175093152
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -26.580586961213804
DONE TAKING  40  STEPS.
Total reward:  -721.5754185912856
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -23.01569703225411
DONE TAKING  40  STEPS.
Total reward:  -665.876530491321
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -31.363428126425926
DONE TAKING  40  STEPS.
Total reward:  -822.6579753827372
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -22.616952739450102
DONE TAKING  40  STEPS.
Total reward:  -674.6838513569603
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -13.944970074295053
DONE TAKING  40  STEPS.
Total reward:  -260.5918880795743
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -28.396306789618198
DONE TAKING  40  STEPS.
Total reward:  -883.0858392241375
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.48070372107059
DONE TAKING  40  STEPS.
Total reward:  -604.616049447597
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -21.471985975167087
DONE TAKING  40  STEPS.
Total reward:  -828.2408588239995
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -18.143641061618734
DONE TAKING  40  STEPS.
Total reward:  -825.7322110720745
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -30.794315632357453
DONE TAKING  40  STEPS.
Total reward:  -605.1884891863948
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -25.9122554259144
DONE TAKING  40  STEPS.
Total reward:  -505.68419977081675
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -20.388114213112196
DONE TAKING  40  STEPS.
Total reward:  -407.6171748259184
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -28.8948642154757
DONE TAKING  40  STEPS.
Total reward:  -1031.2501559936604
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -20.861919101730912
DONE TAKING  40  STEPS.
Total reward:  -24.90102763290937
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -29.338244365251647
DONE TAKING  40  STEPS.
Total reward:  -802.4280947222439
Time for 1 rollout: 1.04 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  1
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 140
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  140
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5122374379843996
    val rand:  0
    val onPol:  0.3933190057675044

=== Epoch 10 ===
    train loss:  0.2693897689643659
    val rand:  0
    val onPol:  0.32935425639152527

=== Epoch 20 ===
    train loss:  0.2342980687032666
    val rand:  0
    val onPol:  0.32432085772355396

=== Epoch 30 ===
    train loss:  0.20584439237912497
    val rand:  0
    val onPol:  0.3271373560031255

=== Epoch 39 ===
    train loss:  0.18588856934455403
    val rand:  0
    val onPol:  0.3324088354905446
Training duration: 14.41 s

#####################################
performing on-policy MPC rollouts... iter  140
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -20.046025419258168
DONE TAKING  40  STEPS.
Total reward:  -413.234013665274
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.877751432555144
DONE TAKING  40  STEPS.
Total reward:  -520.7029681917079
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -19.66957044579097
DONE TAKING  40  STEPS.
Total reward:  -402.3664877791534
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -28.43168055676707
DONE TAKING  40  STEPS.
Total reward:  -876.3536004193297
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.600480594050957
DONE TAKING  40  STEPS.
Total reward:  -837.6021773108565
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -22.686497695438618
DONE TAKING  40  STEPS.
Total reward:  -343.860606960535
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -24.13899362839592
DONE TAKING  40  STEPS.
Total reward:  -901.1985451019048
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -16.191061058820235
DONE TAKING  40  STEPS.
Total reward:  206.15399201452945
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -19.931879698192244
DONE TAKING  40  STEPS.
Total reward:  -438.49693436441447
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -30.992305760682875
DONE TAKING  40  STEPS.
Total reward:  -793.5990464511714
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -29.309785357345554
DONE TAKING  40  STEPS.
Total reward:  -592.9743579545752
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -13.693626901969315
DONE TAKING  40  STEPS.
Total reward:  -467.04005075010895
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -13.21337667673237
DONE TAKING  40  STEPS.
Total reward:  -352.6162574359651
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -22.30110465610826
DONE TAKING  40  STEPS.
Total reward:  -263.91389776894215
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -16.960419559172976
DONE TAKING  40  STEPS.
Total reward:  -494.0351892923705
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -29.39926111363878
DONE TAKING  40  STEPS.
Total reward:  -858.2262599980629
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -28.63836575687701
DONE TAKING  40  STEPS.
Total reward:  -879.0764973034642
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -26.38899815433914
DONE TAKING  40  STEPS.
Total reward:  -683.2360567299108
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -30.98626681844731
DONE TAKING  40  STEPS.
Total reward:  -1002.8608729957825
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -27.29006290144771
DONE TAKING  40  STEPS.
Total reward:  -752.5270545025505
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -27.988461669012445
DONE TAKING  40  STEPS.
Total reward:  -1066.1598471398402
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -17.462265872719364
DONE TAKING  40  STEPS.
Total reward:  -526.9830357688395
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -27.675881505097088
DONE TAKING  40  STEPS.
Total reward:  -758.6158257342983
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -28.08922726941518
DONE TAKING  40  STEPS.
Total reward:  -995.3107637027938
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -20.342013079761756
DONE TAKING  40  STEPS.
Total reward:  -117.90660132426837
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -30.407374546437484
DONE TAKING  40  STEPS.
Total reward:  -767.4959537885019
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -28.24479884540812
DONE TAKING  40  STEPS.
Total reward:  -866.7028331836635
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.75746798793993
DONE TAKING  40  STEPS.
Total reward:  -1088.0723414142649
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -29.560929986706093
DONE TAKING  40  STEPS.
Total reward:  -898.0744816049772
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -25.070817358187256
DONE TAKING  40  STEPS.
Total reward:  -579.3869366694281
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -25.80678941031518
DONE TAKING  40  STEPS.
Total reward:  -902.7503089739326
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.54559295572305
DONE TAKING  40  STEPS.
Total reward:  -213.3192859626821
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.04763044454242
DONE TAKING  40  STEPS.
Total reward:  -624.5069740792165
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -26.194274353656436
DONE TAKING  40  STEPS.
Total reward:  -556.7768936969048
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -26.350029991461042
DONE TAKING  40  STEPS.
Total reward:  -180.60861504160647
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.204166984599162
DONE TAKING  40  STEPS.
Total reward:  -654.5753337366131
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -27.90470168344177
DONE TAKING  40  STEPS.
Total reward:  -862.8333712810945
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -18.868322819844686
DONE TAKING  40  STEPS.
Total reward:  -590.5964502946586
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  0
done step  0 , rew:  -22.890168773232624
DONE TAKING  40  STEPS.
Total reward:  -474.29169732255224
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -24.010226141738038
DONE TAKING  40  STEPS.
Total reward:  -114.01361739607742
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  1
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 141
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  141
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5167776340978187
    val rand:  0
    val onPol:  0.401413232088089

=== Epoch 10 ===
    train loss:  0.2746768640844445
    val rand:  0
    val onPol:  0.33796998858451843

=== Epoch 20 ===
    train loss:  0.23378951612271762
    val rand:  0
    val onPol:  0.32897137602170307

=== Epoch 30 ===
    train loss:  0.20703506051448353
    val rand:  0
    val onPol:  0.3333553671836853

=== Epoch 39 ===
    train loss:  0.18737960070894474
    val rand:  0
    val onPol:  0.33798135817050934
Training duration: 14.18 s

#####################################
performing on-policy MPC rollouts... iter  141
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -17.199645891611944
DONE TAKING  40  STEPS.
Total reward:  -371.9884926838233
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -13.998154921720968
DONE TAKING  40  STEPS.
Total reward:  -356.0340449017567
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -21.878054710298457
DONE TAKING  40  STEPS.
Total reward:  -614.1330506680772
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -23.68465032862268
DONE TAKING  40  STEPS.
Total reward:  -636.6795893238489
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -28.673603956115954
DONE TAKING  40  STEPS.
Total reward:  -1055.8644881789853
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -19.892332068505894
DONE TAKING  40  STEPS.
Total reward:  -727.6952165439563
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -15.303140125712247
DONE TAKING  40  STEPS.
Total reward:  -605.6500308307965
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.0642865417716
DONE TAKING  40  STEPS.
Total reward:  -723.2468549025152
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -20.548895366059583
DONE TAKING  40  STEPS.
Total reward:  -579.2340042177774
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -8.73543027246567
DONE TAKING  40  STEPS.
Total reward:  -342.92696222823173
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -31.078306571150573
DONE TAKING  40  STEPS.
Total reward:  -723.1942804252072
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -21.772082005568247
DONE TAKING  40  STEPS.
Total reward:  -631.4633649058047
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -24.858273872862526
DONE TAKING  40  STEPS.
Total reward:  -507.76866009674325
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.639925845683294
DONE TAKING  40  STEPS.
Total reward:  -488.7493870498884
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -9.709266457976847
DONE TAKING  40  STEPS.
Total reward:  -316.22417954682385
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -11.286530715812518
DONE TAKING  40  STEPS.
Total reward:  -297.7305903618148
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -11.918577359912202
DONE TAKING  40  STEPS.
Total reward:  -194.95597734167796
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -10.006759144645978
DONE TAKING  40  STEPS.
Total reward:  -160.58541805439637
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -10.57272885821962
DONE TAKING  40  STEPS.
Total reward:  -329.4461589535109
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -21.45193323705216
DONE TAKING  40  STEPS.
Total reward:  -425.60719695918596
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -17.885932106881945
DONE TAKING  40  STEPS.
Total reward:  -253.62564350205844
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -28.672473812085578
DONE TAKING  40  STEPS.
Total reward:  -894.3245239127374
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -20.854401627598076
DONE TAKING  40  STEPS.
Total reward:  -643.5752454787942
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -18.815677498046554
DONE TAKING  40  STEPS.
Total reward:  -608.8172404183339
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -30.23773372860298
DONE TAKING  40  STEPS.
Total reward:  -674.7235205050243
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -27.530161580179904
DONE TAKING  40  STEPS.
Total reward:  -568.4061760299195
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.10990256324453
DONE TAKING  40  STEPS.
Total reward:  -599.6499524272203
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.8510635701636
DONE TAKING  40  STEPS.
Total reward:  -609.3663227375016
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -31.012296483684096
DONE TAKING  40  STEPS.
Total reward:  -851.879285985549
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -16.010134960979773
DONE TAKING  40  STEPS.
Total reward:  -248.62377954278085
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.57262865282674
DONE TAKING  40  STEPS.
Total reward:  -354.361210632741
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -25.474766890976145
DONE TAKING  40  STEPS.
Total reward:  -669.4691111094035
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -24.55901517809629
DONE TAKING  40  STEPS.
Total reward:  -525.8285021049054
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.373436661250757
DONE TAKING  40  STEPS.
Total reward:  -702.8993261391508
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.64803253846877
DONE TAKING  40  STEPS.
Total reward:  -472.06483572430244
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.484632412553346
DONE TAKING  40  STEPS.
Total reward:  -477.6865478171034
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.669252139117056
DONE TAKING  40  STEPS.
Total reward:  -543.134076230497
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -30.362385919217594
DONE TAKING  40  STEPS.
Total reward:  -669.3552799460622
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -19.283788023969382
DONE TAKING  40  STEPS.
Total reward:  -250.06339659558031
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.919742282019534
DONE TAKING  40  STEPS.
Total reward:  -367.6093855617596
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  3
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 142
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  142
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5154724398203063
    val rand:  0
    val onPol:  0.39785797397295636

=== Epoch 10 ===
    train loss:  0.27187504475576835
    val rand:  0
    val onPol:  0.33622369666894275

=== Epoch 20 ===
    train loss:  0.23292949769580573
    val rand:  0
    val onPol:  0.32581814130147296

=== Epoch 30 ===
    train loss:  0.20857992846714823
    val rand:  0
    val onPol:  0.32848459482192993

=== Epoch 39 ===
    train loss:  0.18982378040489398
    val rand:  0
    val onPol:  0.3363555669784546
Training duration: 14.07 s

#####################################
performing on-policy MPC rollouts... iter  142
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -12.265804882413802
DONE TAKING  40  STEPS.
Total reward:  -387.57044033451
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -21.362425168606876
DONE TAKING  40  STEPS.
Total reward:  -803.6593463216993
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -14.644936545171083
DONE TAKING  40  STEPS.
Total reward:  -456.0350496566031
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -29.016145696396425
DONE TAKING  40  STEPS.
Total reward:  -660.0924747105157
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -19.759802324291293
DONE TAKING  40  STEPS.
Total reward:  -512.3723653307326
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -26.824303227118335
DONE TAKING  40  STEPS.
Total reward:  -435.92851586164056
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -21.652354048162007
DONE TAKING  40  STEPS.
Total reward:  -216.93121489746022
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -26.088917388200596
DONE TAKING  40  STEPS.
Total reward:  -864.4454734985308
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.18702306242962
DONE TAKING  40  STEPS.
Total reward:  -576.9510434327215
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -26.800191682829496
DONE TAKING  40  STEPS.
Total reward:  -789.744899746848
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -20.858451121985272
DONE TAKING  40  STEPS.
Total reward:  -842.1844993857886
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -30.426948146604374
DONE TAKING  40  STEPS.
Total reward:  -798.5709226814857
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -20.40308031315728
DONE TAKING  40  STEPS.
Total reward:  -452.80769651837636
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -25.77636928140496
DONE TAKING  40  STEPS.
Total reward:  -939.855362971169
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  2
done step  0 , rew:  -26.93460253604308
DONE TAKING  40  STEPS.
Total reward:  -451.68197172863563
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -28.2739726231258
DONE TAKING  40  STEPS.
Total reward:  -577.0703754943386
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -26.253786286616986
DONE TAKING  40  STEPS.
Total reward:  -665.8450916045741
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -19.52996573591057
DONE TAKING  40  STEPS.
Total reward:  -616.5440424320046
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -20.796527799818882
DONE TAKING  40  STEPS.
Total reward:  -569.6638413123251
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -30.283253274410185
DONE TAKING  40  STEPS.
Total reward:  -964.651089051172
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.433767924992008
DONE TAKING  40  STEPS.
Total reward:  -871.8944943005672
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -23.05693323454352
DONE TAKING  40  STEPS.
Total reward:  -647.7980618282061
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -28.06773782047804
DONE TAKING  40  STEPS.
Total reward:  -741.0166080007793
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -25.428849277933097
DONE TAKING  40  STEPS.
Total reward:  -928.1687282423143
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -23.4138901588896
DONE TAKING  40  STEPS.
Total reward:  -754.36641772846
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -16.041229975729138
DONE TAKING  40  STEPS.
Total reward:  -430.1106580802414
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -24.990313161367755
DONE TAKING  40  STEPS.
Total reward:  -618.154662494517
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -24.582317914824262
DONE TAKING  40  STEPS.
Total reward:  -641.6748192803228
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -27.346504171304815
DONE TAKING  40  STEPS.
Total reward:  -919.7282925598489
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -29.4261914245308
DONE TAKING  40  STEPS.
Total reward:  -660.3267913559434
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -18.16270420940107
DONE TAKING  40  STEPS.
Total reward:  -472.7511389804848
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -19.58678375215588
DONE TAKING  40  STEPS.
Total reward:  -166.29591194817507
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -16.461013323918767
DONE TAKING  40  STEPS.
Total reward:  -545.2411691547777
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -13.728248679900792
DONE TAKING  40  STEPS.
Total reward:  -355.82854246466786
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -31.307844436896097
DONE TAKING  40  STEPS.
Total reward:  -1069.906739012729
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -26.277144878857335
DONE TAKING  40  STEPS.
Total reward:  -918.6983459471428
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -21.16493134619679
DONE TAKING  40  STEPS.
Total reward:  -683.2216493815159
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.617052317555817
DONE TAKING  40  STEPS.
Total reward:  -412.3266750309848
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -16.252788879381242
DONE TAKING  40  STEPS.
Total reward:  -626.1330274535599
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.678031512069833
DONE TAKING  40  STEPS.
Total reward:  -801.0039398753612
Time for 1 rollout: 0.99 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 143
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  143
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5189222656843955
    val rand:  0
    val onPol:  0.4091319690148036

=== Epoch 10 ===
    train loss:  0.2718573662272671
    val rand:  0
    val onPol:  0.34927866359551746

=== Epoch 20 ===
    train loss:  0.23519368731138998
    val rand:  0
    val onPol:  0.33803801238536835

=== Epoch 30 ===
    train loss:  0.20664426841233907
    val rand:  0
    val onPol:  0.3434220304091771

=== Epoch 39 ===
    train loss:  0.18967889955169276
    val rand:  0
    val onPol:  0.3476706345876058
Training duration: 14.11 s

#####################################
performing on-policy MPC rollouts... iter  143
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.940570737616895
DONE TAKING  40  STEPS.
Total reward:  -327.683586887251
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -13.89223434708458
DONE TAKING  40  STEPS.
Total reward:  -346.4464846711171
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -29.639273866761418
DONE TAKING  40  STEPS.
Total reward:  -726.230729752818
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -27.918182539646516
DONE TAKING  40  STEPS.
Total reward:  -563.2239098923721
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -25.66022862804019
DONE TAKING  40  STEPS.
Total reward:  39.44104782789565
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -27.837165406290474
DONE TAKING  40  STEPS.
Total reward:  -549.6410895189902
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 6
Model selected:  1
done step  0 , rew:  -28.469698689491274
DONE TAKING  40  STEPS.
Total reward:  -1061.7143833492173
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -18.89055297399038
DONE TAKING  40  STEPS.
Total reward:  -653.0108816485374
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -27.84170561565499
DONE TAKING  40  STEPS.
Total reward:  -1113.6682246261992
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -30.480981066473596
DONE TAKING  40  STEPS.
Total reward:  -629.6054524334529
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -26.996330480411604
DONE TAKING  40  STEPS.
Total reward:  -997.7846382934205
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -16.351559694395053
DONE TAKING  40  STEPS.
Total reward:  -479.6625993862457
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -10.24800700101068
DONE TAKING  40  STEPS.
Total reward:  202.39733104942596
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -26.65231160658405
DONE TAKING  40  STEPS.
Total reward:  -550.8851634756854
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -30.30287125501246
DONE TAKING  40  STEPS.
Total reward:  -978.089296173012
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -13.268507875045426
DONE TAKING  40  STEPS.
Total reward:  -323.66271620076566
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -24.521437069249185
DONE TAKING  40  STEPS.
Total reward:  -590.9993421621123
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -29.862651769513935
DONE TAKING  40  STEPS.
Total reward:  -939.2633302567161
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -18.932217781779542
DONE TAKING  40  STEPS.
Total reward:  -416.232905492666
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -29.29400306718224
DONE TAKING  40  STEPS.
Total reward:  -739.9519726491926
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -27.050946807895116
DONE TAKING  40  STEPS.
Total reward:  1.085645069398911
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -15.114274278932719
DONE TAKING  40  STEPS.
Total reward:  -101.29349300377488
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -15.458310962336025
DONE TAKING  40  STEPS.
Total reward:  -543.980081322203
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.509108841731752
DONE TAKING  40  STEPS.
Total reward:  -688.5439641693986
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -30.15863872246755
DONE TAKING  40  STEPS.
Total reward:  -716.6995621948804
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -21.150348129647796
DONE TAKING  40  STEPS.
Total reward:  -512.0738635116368
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 26
Model selected:  2
done step  0 , rew:  -30.272801704706886
DONE TAKING  40  STEPS.
Total reward:  -654.1459087180967
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -27.389942107536207
DONE TAKING  40  STEPS.
Total reward:  -773.9901904653997
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -24.305407898610657
DONE TAKING  40  STEPS.
Total reward:  -781.9490081305379
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -28.757537112573406
DONE TAKING  40  STEPS.
Total reward:  -882.2450900652184
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -14.639886993064678
DONE TAKING  40  STEPS.
Total reward:  -424.1224722601238
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -17.441668046399982
DONE TAKING  40  STEPS.
Total reward:  -345.7426665209071
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -9.53041337355039
DONE TAKING  40  STEPS.
Total reward:  -381.2165349420159
Time for 1 rollout: 1.08 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -21.362270565243556
DONE TAKING  40  STEPS.
Total reward:  -311.26697368467563
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.564668377516
DONE TAKING  40  STEPS.
Total reward:  -843.2174912038856
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -22.20598772468822
DONE TAKING  40  STEPS.
Total reward:  -841.5498181590203
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -26.961024355333926
DONE TAKING  40  STEPS.
Total reward:  -578.9810637379351
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.07717863152836
DONE TAKING  40  STEPS.
Total reward:  -652.8693542638158
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -19.83856198609091
DONE TAKING  40  STEPS.
Total reward:  -450.85543547288444
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -25.969176094703798
DONE TAKING  40  STEPS.
Total reward:  -930.8894324972039
Time for 1 rollout: 0.97 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  1
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 144
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  144
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5075151235388037
    val rand:  0
    val onPol:  0.40050836900870007

=== Epoch 10 ===
    train loss:  0.27216419682168125
    val rand:  0
    val onPol:  0.33442697674036026

=== Epoch 20 ===
    train loss:  0.23210749735957698
    val rand:  0
    val onPol:  0.32724543164173764

=== Epoch 30 ===
    train loss:  0.20558244434365056
    val rand:  0
    val onPol:  0.3290589476625125

=== Epoch 39 ===
    train loss:  0.1873467091405601
    val rand:  0
    val onPol:  0.33573461572329205
Training duration: 14.37 s

#####################################
performing on-policy MPC rollouts... iter  144
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -25.716883405832128
DONE TAKING  40  STEPS.
Total reward:  -445.9668231404379
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -24.13498722187846
DONE TAKING  40  STEPS.
Total reward:  -551.6930651052116
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 2
Model selected:  1
done step  0 , rew:  -14.944896181787385
DONE TAKING  40  STEPS.
Total reward:  -548.0106050606342
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 3
Model selected:  2
done step  0 , rew:  -16.577314085640236
DONE TAKING  40  STEPS.
Total reward:  -383.09745480046126
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -27.205341327849002
DONE TAKING  40  STEPS.
Total reward:  -741.6310821937892
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -13.551715916287588
DONE TAKING  40  STEPS.
Total reward:  -484.93274746648814
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -23.38306595554897
DONE TAKING  40  STEPS.
Total reward:  -857.5813214925453
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -19.05567179700832
DONE TAKING  40  STEPS.
Total reward:  -295.0759590843019
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -11.829624131077694
DONE TAKING  40  STEPS.
Total reward:  -437.8974340857929
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -17.704634859492177
DONE TAKING  40  STEPS.
Total reward:  -628.1575116148982
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -26.357988870523066
DONE TAKING  40  STEPS.
Total reward:  -741.3337359032826
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -25.68379385955292
DONE TAKING  40  STEPS.
Total reward:  -473.159872288897
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -18.575887608716656
DONE TAKING  40  STEPS.
Total reward:  -37.21215696381918
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -12.990941810208916
DONE TAKING  40  STEPS.
Total reward:  -442.1161136709925
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -21.3597107058973
DONE TAKING  40  STEPS.
Total reward:  -464.19223517865726
Time for 1 rollout: 1.07 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -18.900295088062013
DONE TAKING  40  STEPS.
Total reward:  -310.51538173632963
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -19.689087998582476
DONE TAKING  40  STEPS.
Total reward:  -256.5579530244335
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -30.110615345903756
DONE TAKING  40  STEPS.
Total reward:  -803.7868281536973
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.54703818742465
DONE TAKING  40  STEPS.
Total reward:  -973.4666875321143
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -28.913486371136795
DONE TAKING  40  STEPS.
Total reward:  -776.641759691925
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.383503902484
DONE TAKING  40  STEPS.
Total reward:  -520.6629155913173
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -22.709244012792897
DONE TAKING  40  STEPS.
Total reward:  -734.1345058647197
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.394253862041964
DONE TAKING  40  STEPS.
Total reward:  -683.0881150338839
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -22.733869367498443
DONE TAKING  40  STEPS.
Total reward:  -615.327369860046
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -29.965754802323264
DONE TAKING  40  STEPS.
Total reward:  -717.6723004696989
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -30.633898990481924
DONE TAKING  40  STEPS.
Total reward:  -806.0217361448125
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -21.528182598172492
DONE TAKING  40  STEPS.
Total reward:  -615.2315971495342
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -22.637320944541983
DONE TAKING  40  STEPS.
Total reward:  -458.641391509647
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -29.12983141663875
DONE TAKING  40  STEPS.
Total reward:  -1104.47214481185
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -24.881605224632533
DONE TAKING  40  STEPS.
Total reward:  -736.7361188537284
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 30
Model selected:  2
done step  0 , rew:  -21.303707103547133
DONE TAKING  40  STEPS.
Total reward:  -548.072038225285
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -27.782881840259282
DONE TAKING  40  STEPS.
Total reward:  -665.4718045574168
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -27.29272132911383
DONE TAKING  40  STEPS.
Total reward:  -726.0292027453287
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 33
Model selected:  0
done step  0 , rew:  -9.74870574401144
DONE TAKING  40  STEPS.
Total reward:  -331.08323962412294
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -12.781050967719265
DONE TAKING  40  STEPS.
Total reward:  -390.1570692689659
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -22.403915913269437
DONE TAKING  40  STEPS.
Total reward:  -654.6838755862046
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -23.82540451181667
DONE TAKING  40  STEPS.
Total reward:  -379.60389718638635
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 37
Model selected:  0
done step  0 , rew:  -18.833793882811783
DONE TAKING  40  STEPS.
Total reward:  -748.591627526081
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -28.553965222425518
DONE TAKING  40  STEPS.
Total reward:  -593.6532637133871
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -14.769992411213204
DONE TAKING  40  STEPS.
Total reward:  -461.4791535098545
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Completed rollout #  3
Performed  5  rollouts, each with  40  steps.
Iter: 145
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  145
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5177786203852871
    val rand:  0
    val onPol:  0.3821082313855489

=== Epoch 10 ===
    train loss:  0.2709705390428242
    val rand:  0
    val onPol:  0.32143889367580414

=== Epoch 20 ===
    train loss:  0.23494779488496614
    val rand:  0
    val onPol:  0.31502484778563183

=== Epoch 30 ===
    train loss:  0.20700617422137343
    val rand:  0
    val onPol:  0.31814125676949817

=== Epoch 39 ===
    train loss:  0.19006260628240151
    val rand:  0
    val onPol:  0.3236975222826004
Training duration: 14.48 s

#####################################
performing on-policy MPC rollouts... iter  145
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -28.34554570682605
DONE TAKING  40  STEPS.
Total reward:  -772.5808246060898
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -9.241634935738073
DONE TAKING  40  STEPS.
Total reward:  183.9261062763739
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -23.9510031021055
DONE TAKING  40  STEPS.
Total reward:  -135.97923439446973
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -23.78756375541679
DONE TAKING  40  STEPS.
Total reward:  -917.9855448266201
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -26.64722385140138
DONE TAKING  40  STEPS.
Total reward:  -773.3061421350855
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -11.514735381011025
DONE TAKING  40  STEPS.
Total reward:  -247.3377072905243
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -19.72765334943469
DONE TAKING  40  STEPS.
Total reward:  -322.8789782110637
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -21.248323853697244
DONE TAKING  40  STEPS.
Total reward:  -449.6411699017305
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 8
Model selected:  0
done step  0 , rew:  -23.868663390043395
DONE TAKING  40  STEPS.
Total reward:  -479.64825181931536
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -18.3901128828968
DONE TAKING  40  STEPS.
Total reward:  -442.32094275126093
Time for 1 rollout: 1.09 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -28.635827676492358
DONE TAKING  40  STEPS.
Total reward:  -652.5420980657307
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  2
done step  0 , rew:  -12.602390049012628
DONE TAKING  40  STEPS.
Total reward:  -314.0459131006427
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -22.803619936364854
DONE TAKING  40  STEPS.
Total reward:  -472.6174538038632
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -24.76062458273939
DONE TAKING  40  STEPS.
Total reward:  -516.3325725642729
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -29.63188916334729
DONE TAKING  40  STEPS.
Total reward:  -961.2261877834005
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -24.975638969454184
DONE TAKING  40  STEPS.
Total reward:  -650.5839554127557
Time for 1 rollout: 1.05 s



####################### Performing MPC rollout # 16
Model selected:  2
done step  0 , rew:  -24.625831956599864
DONE TAKING  40  STEPS.
Total reward:  -618.2538795788504
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -20.54381777563206
DONE TAKING  40  STEPS.
Total reward:  -641.1853593415
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -22.144371542463244
DONE TAKING  40  STEPS.
Total reward:  -891.072445607715
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -24.26691940700732
DONE TAKING  40  STEPS.
Total reward:  -737.3344447826582
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -23.979249952873644
DONE TAKING  40  STEPS.
Total reward:  -982.3123937077052
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  2
done step  0 , rew:  -29.840010126131318
DONE TAKING  40  STEPS.
Total reward:  -754.8364634885337
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 22
Model selected:  1
done step  0 , rew:  -21.963556886287602
DONE TAKING  40  STEPS.
Total reward:  -320.34481738173474
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -11.36698864813736
DONE TAKING  40  STEPS.
Total reward:  -401.4052192306835
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.287592920138742
DONE TAKING  40  STEPS.
Total reward:  -981.5898702493511
Time for 1 rollout: 1.06 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -23.301134801262904
DONE TAKING  40  STEPS.
Total reward:  -675.7073235932197
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 26
Model selected:  0
done step  0 , rew:  -29.333406213942045
DONE TAKING  40  STEPS.
Total reward:  -963.9655959754597
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -16.747993634007628
DONE TAKING  40  STEPS.
Total reward:  -647.352902723694
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -21.290671867696833
DONE TAKING  40  STEPS.
Total reward:  -352.04304117817054
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 29
Model selected:  1
done step  0 , rew:  -19.252161719077925
DONE TAKING  40  STEPS.
Total reward:  -87.74374309785904
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.440949049394135
DONE TAKING  40  STEPS.
Total reward:  -435.5443415514552
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -12.478615309699741
DONE TAKING  40  STEPS.
Total reward:  -198.16165776229354
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  0
done step  0 , rew:  -29.913178854730305
DONE TAKING  40  STEPS.
Total reward:  -965.9417121963553
Time for 1 rollout: 1.04 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.046973970454681
DONE TAKING  40  STEPS.
Total reward:  -492.31179359600804
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 34
Model selected:  0
done step  0 , rew:  -22.544025552598782
DONE TAKING  40  STEPS.
Total reward:  -268.97930177396984
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.800588901283543
DONE TAKING  40  STEPS.
Total reward:  -1095.7305642947551
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -12.614371237370554
DONE TAKING  40  STEPS.
Total reward:  -542.9586302133399
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -23.433863532813355
DONE TAKING  40  STEPS.
Total reward:  -794.2853331654389
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.243059811292333
DONE TAKING  40  STEPS.
Total reward:  -976.8157170805861
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -22.45898600014791
DONE TAKING  40  STEPS.
Total reward:  -256.12537418139357
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  4
Completed rollout #  0
Performed  5  rollouts, each with  40  steps.
Iter: 146
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  146
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5098434650061423
    val rand:  0
    val onPol:  0.3768264849980672

=== Epoch 10 ===
    train loss:  0.2740012987663871
    val rand:  0
    val onPol:  0.3186170309782028

=== Epoch 20 ===
    train loss:  0.23516567914109482
    val rand:  0
    val onPol:  0.3108084946870804

=== Epoch 30 ===
    train loss:  0.2065216329014092
    val rand:  0
    val onPol:  0.31091614564259845

=== Epoch 39 ===
    train loss:  0.18910597029485202
    val rand:  0
    val onPol:  0.3172855128844579
Training duration: 14.12 s

#####################################
performing on-policy MPC rollouts... iter  146
#####################################


####################### Performing MPC rollout # 0
Model selected:  0
done step  0 , rew:  -20.983174715751467
DONE TAKING  40  STEPS.
Total reward:  -555.4933071410446
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 1
Model selected:  0
done step  0 , rew:  -17.20608045729018
DONE TAKING  40  STEPS.
Total reward:  -390.08913941171005
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 2
Model selected:  2
done step  0 , rew:  -17.443009044557492
DONE TAKING  40  STEPS.
Total reward:  -634.4865985639714
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -26.243113059737926
DONE TAKING  40  STEPS.
Total reward:  -884.4818800851788
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -30.631484352664078
DONE TAKING  40  STEPS.
Total reward:  -713.8306725428715
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 5
Model selected:  2
done step  0 , rew:  -29.454126498168904
DONE TAKING  40  STEPS.
Total reward:  -888.0569830448884
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -29.588025330859317
DONE TAKING  40  STEPS.
Total reward:  -849.0805727677784
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -28.819522275487355
DONE TAKING  40  STEPS.
Total reward:  -918.8093818440744
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -22.181436449662357
DONE TAKING  40  STEPS.
Total reward:  -780.6016474817736
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -23.28252377261101
DONE TAKING  40  STEPS.
Total reward:  241.03207074941997
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -24.951377460746016
DONE TAKING  40  STEPS.
Total reward:  -592.6450627322541
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -20.348127550417736
DONE TAKING  40  STEPS.
Total reward:  -487.92751201174406
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 12
Model selected:  1
done step  0 , rew:  -11.610311793268838
DONE TAKING  40  STEPS.
Total reward:  -295.4765827064721
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 13
Model selected:  2
done step  0 , rew:  -16.620783007573703
DONE TAKING  40  STEPS.
Total reward:  -363.2310328434731
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -23.736533769458376
DONE TAKING  40  STEPS.
Total reward:  -735.9178188032413
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 15
Model selected:  0
done step  0 , rew:  -27.024033799464977
DONE TAKING  40  STEPS.
Total reward:  -774.4980985557481
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -13.100774193380413
DONE TAKING  40  STEPS.
Total reward:  -241.5378450455342
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -25.862935714690135
DONE TAKING  40  STEPS.
Total reward:  -309.07024578032036
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -21.44538235074359
DONE TAKING  40  STEPS.
Total reward:  -381.08772134275836
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 19
Model selected:  2
done step  0 , rew:  -16.570662805980195
DONE TAKING  40  STEPS.
Total reward:  -494.710147595448
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -29.526589687888396
DONE TAKING  40  STEPS.
Total reward:  -783.1768275276538
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -17.823254025625538
DONE TAKING  40  STEPS.
Total reward:  -682.4820806740676
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -21.0679517101347
DONE TAKING  40  STEPS.
Total reward:  -401.7882031397371
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -26.34972309908917
DONE TAKING  40  STEPS.
Total reward:  -544.1933456652737
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -21.136790633744404
DONE TAKING  40  STEPS.
Total reward:  -423.5166127998532
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 25
Model selected:  0
done step  0 , rew:  -24.93531673342829
DONE TAKING  40  STEPS.
Total reward:  -451.450314178681
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -26.836873367658256
DONE TAKING  40  STEPS.
Total reward:  -843.2954466231032
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -29.302036676595744
DONE TAKING  40  STEPS.
Total reward:  -712.8683739095603
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 28
Model selected:  1
done step  0 , rew:  -25.262748279332982
DONE TAKING  40  STEPS.
Total reward:  -643.0285278786668
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -31.199925798444056
DONE TAKING  40  STEPS.
Total reward:  -287.20989125117023
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -17.882535195883754
DONE TAKING  40  STEPS.
Total reward:  -285.7102694224886
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -23.60830455674485
DONE TAKING  40  STEPS.
Total reward:  -587.9969247033723
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -28.439817590043628
DONE TAKING  40  STEPS.
Total reward:  -773.2121985889104
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -24.70492901945802
DONE TAKING  40  STEPS.
Total reward:  -408.5263409153978
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -27.668503972862467
DONE TAKING  40  STEPS.
Total reward:  -587.8607483155071
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -24.646158422550805
DONE TAKING  40  STEPS.
Total reward:  -930.6852147660775
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -21.066575301345658
DONE TAKING  40  STEPS.
Total reward:  -445.95402990090463
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -15.598274071551078
DONE TAKING  40  STEPS.
Total reward:  -341.3226442100487
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -25.02925629590151
DONE TAKING  40  STEPS.
Total reward:  -885.8715059379372
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -23.21768136488955
DONE TAKING  40  STEPS.
Total reward:  -805.902206902821
Time for 1 rollout: 1.00 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Completed rollout #  3
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 147
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  147
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5129316768102479
    val rand:  0
    val onPol:  0.378381942709287

=== Epoch 10 ===
    train loss:  0.27286751855883684
    val rand:  0
    val onPol:  0.3156181996067365

=== Epoch 20 ===
    train loss:  0.23532825002544805
    val rand:  0
    val onPol:  0.3094518805543582

=== Epoch 30 ===
    train loss:  0.2065943194585934
    val rand:  0
    val onPol:  0.3091292877991994

=== Epoch 39 ===
    train loss:  0.18839824199676514
    val rand:  0
    val onPol:  0.3148535614212354
Training duration: 14.20 s

#####################################
performing on-policy MPC rollouts... iter  147
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -23.835095455576102
DONE TAKING  40  STEPS.
Total reward:  -293.4210955085538
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -24.43740737456495
DONE TAKING  40  STEPS.
Total reward:  -641.2916057101321
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -23.70773085898279
DONE TAKING  40  STEPS.
Total reward:  131.38357568695199
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -17.16165819042269
DONE TAKING  40  STEPS.
Total reward:  -431.9273882249233
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 4
Model selected:  0
done step  0 , rew:  -29.95921549124416
DONE TAKING  40  STEPS.
Total reward:  -699.9835173444642
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.742042109218275
DONE TAKING  40  STEPS.
Total reward:  -466.9406185970142
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -19.02420543124063
DONE TAKING  40  STEPS.
Total reward:  -486.22420360295916
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -22.806520649816058
DONE TAKING  40  STEPS.
Total reward:  -458.44426411312395
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -26.537387477233416
DONE TAKING  40  STEPS.
Total reward:  -528.2195211162272
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 9
Model selected:  1
done step  0 , rew:  -27.551477962418684
DONE TAKING  40  STEPS.
Total reward:  -710.3401000598453
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 10
Model selected:  0
done step  0 , rew:  -28.901000035690384
DONE TAKING  40  STEPS.
Total reward:  -862.0094560851262
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -19.814122849178723
DONE TAKING  40  STEPS.
Total reward:  -457.72933448776104
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.013445424702306
DONE TAKING  40  STEPS.
Total reward:  -388.56867227241963
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -17.936515816614218
DONE TAKING  40  STEPS.
Total reward:  -583.7433741656688
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -20.107546066107474
DONE TAKING  40  STEPS.
Total reward:  -371.18950878728975
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -21.992799508148906
DONE TAKING  40  STEPS.
Total reward:  -609.608581165149
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -29.398932113249806
DONE TAKING  40  STEPS.
Total reward:  -691.2774268756428
Time for 1 rollout: 1.03 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -13.9300331405666
DONE TAKING  40  STEPS.
Total reward:  279.299697775066
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 18
Model selected:  1
done step  0 , rew:  -13.542482425097615
DONE TAKING  40  STEPS.
Total reward:  -80.85464553671198
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -23.182693884458345
DONE TAKING  40  STEPS.
Total reward:  -737.1850000074988
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 20
Model selected:  2
done step  0 , rew:  -25.231919494958873
DONE TAKING  40  STEPS.
Total reward:  -549.8313058572364
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -30.745456122323752
DONE TAKING  40  STEPS.
Total reward:  -559.9947658696243
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -22.25450253233359
DONE TAKING  40  STEPS.
Total reward:  -295.33515312819566
Time for 1 rollout: 1.02 s



####################### Performing MPC rollout # 23
Model selected:  0
done step  0 , rew:  -27.24088930703416
DONE TAKING  40  STEPS.
Total reward:  -380.67571134405176
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 24
Model selected:  1
done step  0 , rew:  -12.661598690140735
DONE TAKING  40  STEPS.
Total reward:  -412.5439135281264
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -26.59592235234394
DONE TAKING  40  STEPS.
Total reward:  -253.00744786256294
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -22.8633460160368
DONE TAKING  40  STEPS.
Total reward:  -341.75817757794675
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -26.59282985388083
DONE TAKING  40  STEPS.
Total reward:  -1028.2612328801763
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -27.170929449177986
DONE TAKING  40  STEPS.
Total reward:  -648.6618527151977
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -16.28688723917336
DONE TAKING  40  STEPS.
Total reward:  -319.3472322385006
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -22.36336263972707
DONE TAKING  40  STEPS.
Total reward:  -452.64667274993315
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 31
Model selected:  2
done step  0 , rew:  -22.1882281750413
DONE TAKING  40  STEPS.
Total reward:  -700.9297301505628
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 32
Model selected:  1
done step  0 , rew:  -23.29073099789095
DONE TAKING  40  STEPS.
Total reward:  172.4514742322219
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -14.755882615436349
DONE TAKING  40  STEPS.
Total reward:  -291.9934726112719
Time for 1 rollout: 1.00 s



####################### Performing MPC rollout # 34
Model selected:  2
done step  0 , rew:  -30.65275992417139
DONE TAKING  40  STEPS.
Total reward:  -408.131800631252
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 35
Model selected:  0
done step  0 , rew:  -30.97081230036
DONE TAKING  40  STEPS.
Total reward:  -738.3635479108182
Time for 1 rollout: 1.01 s



####################### Performing MPC rollout # 36
Model selected:  2
done step  0 , rew:  -25.043713932033302
DONE TAKING  40  STEPS.
Total reward:  -431.0268404457548
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.234030184537456
DONE TAKING  40  STEPS.
Total reward:  -715.0115256335388
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -18.664857314648724
DONE TAKING  40  STEPS.
Total reward:  -723.1233337072732
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  1
done step  0 , rew:  -30.975531168589324
DONE TAKING  40  STEPS.
Total reward:  -673.1706539285939
Time for 1 rollout: 1.01 s


Beginning to do  5  random rollouts.
Completed rollout #  1
Completed rollout #  3
Completed rollout #  2
Completed rollout #  0
Completed rollout #  4
Performed  5  rollouts, each with  40  steps.
Iter: 148
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  148
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5185655538450208
    val rand:  0
    val onPol:  0.3730008850495021

=== Epoch 10 ===
    train loss:  0.27278657649692734
    val rand:  0
    val onPol:  0.31363728145758313

=== Epoch 20 ===
    train loss:  0.23278121362652696
    val rand:  0
    val onPol:  0.3056413158774376

=== Epoch 30 ===
    train loss:  0.20744406340415017
    val rand:  0
    val onPol:  0.30980273336172104

=== Epoch 39 ===
    train loss:  0.18653663836027445
    val rand:  0
    val onPol:  0.3138871019085248
Training duration: 14.42 s

#####################################
performing on-policy MPC rollouts... iter  148
#####################################


####################### Performing MPC rollout # 0
Model selected:  1
done step  0 , rew:  -23.972209929905233
DONE TAKING  40  STEPS.
Total reward:  -215.79538411764275
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 1
Model selected:  1
done step  0 , rew:  -25.443265301742052
DONE TAKING  40  STEPS.
Total reward:  -723.0645509429244
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -28.869719395580926
DONE TAKING  40  STEPS.
Total reward:  -785.7997959809879
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 3
Model selected:  0
done step  0 , rew:  -22.593822008812865
DONE TAKING  40  STEPS.
Total reward:  -449.84374395585786
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 4
Model selected:  1
done step  0 , rew:  -28.59769622304499
DONE TAKING  40  STEPS.
Total reward:  -517.7002557830283
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 5
Model selected:  1
done step  0 , rew:  -24.421687203647075
DONE TAKING  40  STEPS.
Total reward:  -115.08818421671369
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 6
Model selected:  0
done step  0 , rew:  -20.37382516708389
DONE TAKING  40  STEPS.
Total reward:  4.2850222200401085
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  1
done step  0 , rew:  -23.80360320299303
DONE TAKING  40  STEPS.
Total reward:  -666.9036386966983
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 8
Model selected:  2
done step  0 , rew:  -12.695231126469428
DONE TAKING  40  STEPS.
Total reward:  -344.6952683101546
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  0
done step  0 , rew:  -10.762735511626742
DONE TAKING  40  STEPS.
Total reward:  -322.9393766165073
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 10
Model selected:  2
done step  0 , rew:  -13.514419332650531
DONE TAKING  40  STEPS.
Total reward:  -458.2513882761256
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 11
Model selected:  0
done step  0 , rew:  -30.24416286971356
DONE TAKING  40  STEPS.
Total reward:  -738.6004844618461
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 12
Model selected:  2
done step  0 , rew:  -27.284383265804188
DONE TAKING  40  STEPS.
Total reward:  -472.4694672346662
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 13
Model selected:  1
done step  0 , rew:  -21.606765313087433
DONE TAKING  40  STEPS.
Total reward:  -671.3406472127019
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 14
Model selected:  0
done step  0 , rew:  -25.937536859961558
DONE TAKING  40  STEPS.
Total reward:  -454.04393563003447
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 15
Model selected:  2
done step  0 , rew:  -22.31054697950716
DONE TAKING  40  STEPS.
Total reward:  -706.9506310882466
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 16
Model selected:  1
done step  0 , rew:  -10.653329295411826
DONE TAKING  40  STEPS.
Total reward:  114.57687945607074
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 17
Model selected:  0
done step  0 , rew:  -15.111253085062854
DONE TAKING  40  STEPS.
Total reward:  -123.83174006075676
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  0
done step  0 , rew:  -27.579391587612967
DONE TAKING  40  STEPS.
Total reward:  -839.9244731486368
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 19
Model selected:  1
done step  0 , rew:  -30.546026089682705
DONE TAKING  40  STEPS.
Total reward:  -263.8946264783821
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  0
done step  0 , rew:  -15.023638688401892
DONE TAKING  40  STEPS.
Total reward:  -481.9170878586508
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 21
Model selected:  1
done step  0 , rew:  -26.86743105317167
DONE TAKING  40  STEPS.
Total reward:  -812.1611730038511
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 22
Model selected:  2
done step  0 , rew:  -24.319150037982887
DONE TAKING  40  STEPS.
Total reward:  -907.5369143810365
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 23
Model selected:  1
done step  0 , rew:  -29.99008352322949
DONE TAKING  40  STEPS.
Total reward:  -1061.9023687171136
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 24
Model selected:  2
done step  0 , rew:  -25.59158354918828
DONE TAKING  40  STEPS.
Total reward:  -168.46200679622834
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  1
done step  0 , rew:  -29.715651049584103
DONE TAKING  40  STEPS.
Total reward:  -819.0030114129087
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -13.49108526133872
DONE TAKING  40  STEPS.
Total reward:  -330.9493256876467
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 27
Model selected:  0
done step  0 , rew:  -17.344788968581476
DONE TAKING  40  STEPS.
Total reward:  -391.8853410320722
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 28
Model selected:  2
done step  0 , rew:  -11.396098869235
DONE TAKING  40  STEPS.
Total reward:  -147.00553346938432
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  2
done step  0 , rew:  -26.1359903057637
DONE TAKING  40  STEPS.
Total reward:  -221.37033729704902
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 30
Model selected:  1
done step  0 , rew:  -25.117033232701658
DONE TAKING  40  STEPS.
Total reward:  -962.0180302294793
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 31
Model selected:  1
done step  0 , rew:  -19.210364051691766
DONE TAKING  40  STEPS.
Total reward:  -123.27729620025893
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -23.612966726440373
DONE TAKING  40  STEPS.
Total reward:  -449.37405415585897
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  2
done step  0 , rew:  -16.185796999756086
DONE TAKING  40  STEPS.
Total reward:  -362.854456213317
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -30.634256629591224
DONE TAKING  40  STEPS.
Total reward:  -577.5706636864628
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -21.207644763191094
DONE TAKING  40  STEPS.
Total reward:  -704.1561833883162
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  1
done step  0 , rew:  -27.2482308062487
DONE TAKING  40  STEPS.
Total reward:  -267.58641632692087
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  2
done step  0 , rew:  -24.187413823827452
DONE TAKING  40  STEPS.
Total reward:  -812.3966403750759
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 38
Model selected:  1
done step  0 , rew:  -26.242323015086903
DONE TAKING  40  STEPS.
Total reward:  -592.7032563266932
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 39
Model selected:  2
done step  0 , rew:  -24.74368013025067
DONE TAKING  40  STEPS.
Total reward:  -657.9318856317035
Time for 1 rollout: 0.94 s


Beginning to do  5  random rollouts.
Completed rollout #  3
Completed rollout #  4
Completed rollout #  0
Completed rollout #  2
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
Iter: 149
Num of training on policy rollouts: 720
Num of val on policy rollouts: 80
Rand dataset shape (390, 1, 21)

#####################################
Training the dynamics model..... iteration  149
#####################################

    amount of random data:  8000
    amount of onPol data:  29520
Prob rand:  390
On pol:  28800
Prob shape:  (29190,)

=== Epoch 0 ===
    train loss:  0.5149061685068566
    val rand:  0
    val onPol:  0.37072864671548206

=== Epoch 10 ===
    train loss:  0.27285274288110567
    val rand:  0
    val onPol:  0.31064469118913013

=== Epoch 20 ===
    train loss:  0.23544191582161084
    val rand:  0
    val onPol:  0.30433716128269833

=== Epoch 30 ===
    train loss:  0.21097813363660844
    val rand:  0
    val onPol:  0.3060685694217682

=== Epoch 39 ===
    train loss:  0.18858156941438975
    val rand:  0
    val onPol:  0.31184308727582294
Training duration: 14.47 s

#####################################
performing on-policy MPC rollouts... iter  149
#####################################


####################### Performing MPC rollout # 0
Model selected:  2
done step  0 , rew:  -25.32084493880115
DONE TAKING  40  STEPS.
Total reward:  -622.6611502198048
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 1
Model selected:  2
done step  0 , rew:  -31.010205748774876
DONE TAKING  40  STEPS.
Total reward:  -816.4196137394215
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 2
Model selected:  0
done step  0 , rew:  -15.972054042106357
DONE TAKING  40  STEPS.
Total reward:  -437.13233835407976
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 3
Model selected:  1
done step  0 , rew:  -19.210062386533217
DONE TAKING  40  STEPS.
Total reward:  -590.4245133714376
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 4
Model selected:  2
done step  0 , rew:  -13.462364595710724
DONE TAKING  40  STEPS.
Total reward:  -482.1137957136747
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 5
Model selected:  0
done step  0 , rew:  -24.237072719355908
DONE TAKING  40  STEPS.
Total reward:  -903.3533859037456
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 6
Model selected:  2
done step  0 , rew:  -21.60073487339295
DONE TAKING  40  STEPS.
Total reward:  -881.0533499457563
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 7
Model selected:  0
done step  0 , rew:  -27.223760619272834
DONE TAKING  40  STEPS.
Total reward:  -996.0354339404353
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 8
Model selected:  1
done step  0 , rew:  -12.74133671198208
DONE TAKING  40  STEPS.
Total reward:  -296.3380354199368
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 9
Model selected:  2
done step  0 , rew:  -9.259301807336783
DONE TAKING  40  STEPS.
Total reward:  -298.4801783689408
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 10
Model selected:  1
done step  0 , rew:  -22.067889003281906
DONE TAKING  40  STEPS.
Total reward:  -695.2454031310552
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 11
Model selected:  1
done step  0 , rew:  -21.124055247207295
DONE TAKING  40  STEPS.
Total reward:  -578.9744262524596
Time for 1 rollout: 0.99 s



####################### Performing MPC rollout # 12
Model selected:  0
done step  0 , rew:  -14.817168965174792
DONE TAKING  40  STEPS.
Total reward:  -390.7244629460908
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 13
Model selected:  0
done step  0 , rew:  -24.13526942648163
DONE TAKING  40  STEPS.
Total reward:  -886.4195860104826
Time for 1 rollout: 0.92 s



####################### Performing MPC rollout # 14
Model selected:  1
done step  0 , rew:  -29.93889064722812
DONE TAKING  40  STEPS.
Total reward:  -625.9730252118023
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 15
Model selected:  1
done step  0 , rew:  -16.11136117327026
DONE TAKING  40  STEPS.
Total reward:  -424.63238324213535
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 16
Model selected:  0
done step  0 , rew:  -30.525311848899328
DONE TAKING  40  STEPS.
Total reward:  -709.1458131427923
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 17
Model selected:  1
done step  0 , rew:  -18.696192880326272
DONE TAKING  40  STEPS.
Total reward:  -550.164550304872
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 18
Model selected:  2
done step  0 , rew:  -20.55873212931464
DONE TAKING  40  STEPS.
Total reward:  -737.5627770185793
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 19
Model selected:  0
done step  0 , rew:  -15.001530855163686
DONE TAKING  40  STEPS.
Total reward:  -281.7766158105146
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 20
Model selected:  1
done step  0 , rew:  -22.683026542800278
DONE TAKING  40  STEPS.
Total reward:  -803.9448925875598
Time for 1 rollout: 0.91 s



####################### Performing MPC rollout # 21
Model selected:  0
done step  0 , rew:  -26.0411002714738
DONE TAKING  40  STEPS.
Total reward:  -816.3388355566037
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 22
Model selected:  0
done step  0 , rew:  -31.16435710833557
DONE TAKING  40  STEPS.
Total reward:  -680.0857467780596
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 23
Model selected:  2
done step  0 , rew:  -27.545986437533628
DONE TAKING  40  STEPS.
Total reward:  -960.689705751307
Time for 1 rollout: 0.93 s



####################### Performing MPC rollout # 24
Model selected:  0
done step  0 , rew:  -29.711284343131233
DONE TAKING  40  STEPS.
Total reward:  -827.3919834064965
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 25
Model selected:  2
done step  0 , rew:  -27.969667135831436
DONE TAKING  40  STEPS.
Total reward:  -843.6032966595051
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 26
Model selected:  1
done step  0 , rew:  -18.191146836993
DONE TAKING  40  STEPS.
Total reward:  -372.94394570236864
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 27
Model selected:  2
done step  0 , rew:  -18.825841025620054
DONE TAKING  40  STEPS.
Total reward:  -632.9300413468715
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 28
Model selected:  0
done step  0 , rew:  -30.564266760951053
DONE TAKING  40  STEPS.
Total reward:  -736.0119603145188
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 29
Model selected:  0
done step  0 , rew:  -19.416377297030415
DONE TAKING  40  STEPS.
Total reward:  -416.3989173027214
Time for 1 rollout: 0.97 s



####################### Performing MPC rollout # 30
Model selected:  0
done step  0 , rew:  -24.664870756647698
DONE TAKING  40  STEPS.
Total reward:  -442.7324655706996
Time for 1 rollout: 0.94 s



####################### Performing MPC rollout # 31
Model selected:  0
done step  0 , rew:  -26.79599410574734
DONE TAKING  40  STEPS.
Total reward:  -836.8988140361041
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 32
Model selected:  2
done step  0 , rew:  -30.929896160901716
DONE TAKING  40  STEPS.
Total reward:  -846.3360628339973
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 33
Model selected:  1
done step  0 , rew:  -30.62577298900536
DONE TAKING  40  STEPS.
Total reward:  -855.6517531228496
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 34
Model selected:  1
done step  0 , rew:  -13.308665596471227
DONE TAKING  40  STEPS.
Total reward:  -449.78412043553595
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 35
Model selected:  1
done step  0 , rew:  -30.08188120828133
DONE TAKING  40  STEPS.
Total reward:  -786.6858048689355
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 36
Model selected:  0
done step  0 , rew:  -16.423812987456255
DONE TAKING  40  STEPS.
Total reward:  -354.6511454232111
Time for 1 rollout: 0.95 s



####################### Performing MPC rollout # 37
Model selected:  1
done step  0 , rew:  -24.70973240746205
DONE TAKING  40  STEPS.
Total reward:  -828.2613623929444
Time for 1 rollout: 0.96 s



####################### Performing MPC rollout # 38
Model selected:  2
done step  0 , rew:  -26.860942726311965
DONE TAKING  40  STEPS.
Total reward:  -783.6597245690759
Time for 1 rollout: 0.98 s



####################### Performing MPC rollout # 39
Model selected:  0
done step  0 , rew:  -21.67515519350288
DONE TAKING  40  STEPS.
Total reward:  -463.44124823692005
Time for 1 rollout: 0.95 s


Beginning to do  5  random rollouts.
Completed rollout #  2
Completed rollout #  3
Completed rollout #  0
Completed rollout #  4
Completed rollout #  1
Performed  5  rollouts, each with  40  steps.
